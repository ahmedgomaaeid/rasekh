/*! s3drm 15-04-2022 */

function s3bubbleGlobals(){var n="https://s3bubbleapi.com",r={hasProp:function(e,t){for(var n in e)if(e.hasOwnProperty(n)){if(n===t&&""!==e[n]&&void 0!==e[n]&&null!==e[n]&&!1!==e[n])return e;if(e[n]instanceof Object&&r.hasProp(e[n],t))return e[n]}return null},extend:function(e,t){for(var n in t)"object"==typeof e[n]?r.extend(e[n],t[n]):e[n]=t[n];return e},setCookie:function(e,t,n){var r;if(n){var i=new Date;i.setTime(i.getTime()+24*n*60*60*1e3),r="; expires="+i.toGMTString()}else r="";document.cookie=e+"="+t+r+";path=/"},extractHostname:function(e){return(-1<e.indexOf("//")?e.split("/")[2]:e.split("/")[0]).split(":")[0].split("?")[0]},isScrolledIntoView:function(e){if(e.getBoundingClientRect()){var t=e.getBoundingClientRect().top,n=e.getBoundingClientRect().bottom;return t<window.innerHeight&&0<=n}},isURL:function(e){var t=document.createElement("a");return t.href=e,t.host&&t.host!=window.location.host},setFontSize:function(e){if(document.getElementById(e.id)){var t=document.getElementById(e.id).offsetWidth,n=9999,r=1,i=9999,a=1;if(e.hasOwnProperty("elements"))for(var o=e.elements,s=o.length-1;0<=s;s--)if(o[s].hasOwnProperty("fontRatio")&&o[s].hasOwnProperty("el")){var l=(n<t?n:t<r?r:t)/o[s].fontRatio,u=i<l?i:l<a?a:l;o[s].el.style.fontSize=Math.floor(u)+"px"}}},addScripts:function(){var e=document.createElement("script");e.type="text/javascript",e.defer=!0,e.src="https://imasdk.googleapis.com/js/sdkloader/ima3.js",document.head.appendChild(e);var t=document.createElement("script");t.type="text/javascript",t.defer=!0,t.src="https://www.google-analytics.com/analytics.js",document.head.appendChild(t);var n=document.createElement("script");n.type="text/javascript",n.defer=!0,n.src="https://www.gstatic.com/cv/js/sender/v1/cast_sender.js?loadCastFramework=1",document.head.appendChild(n);for(var r=document.getElementsByClassName("s3bubble"),i=0;i<r.length;i++)if(r[i].getAttribute("data-code")){var a={isDrm:!1,code:r[i].getAttribute("data-code"),type:r[i].getAttribute("data-type")?r[i].getAttribute("data-type"):"video",options:{}};r[i].getAttribute("data-woo")&&(a.woo=r[i].getAttribute("data-woo")),r[i].getAttribute("data-woo_memberships")&&(a.woo_memberships=r[i].getAttribute("data-woo_memberships")),r[i].getAttribute("data-teaser")&&(a.teaser=r[i].getAttribute("data-teaser")),r[i].getAttribute("data-is360")&&(a.is360=r[i].getAttribute("data-is360")),r[i].getAttribute("data-autoplay")&&(a.options.autoplay=r[i].getAttribute("data-autoplay")),r[i].getAttribute("data-preventAutoplay")&&(a.options.preventAutoplay=!0),r[i].getAttribute("data-muted")&&(a.options.muted=!0),r[i].getAttribute("data-width")&&(a.options.width=r[i].getAttribute("data-width")),r[i].getAttribute("data-height")&&(a.options.height=r[i].getAttribute("data-height")),r[i].getAttribute("data-poster")&&(s3bubble_drm_frontend_scripts.options.s3bubble_wordpress_poster=r[i].getAttribute("data-poster")),s3bubble(r[i]).video(a)}for(var o=document.getElementsByClassName("s3bv"),s=0;s<o.length;s++)if(o[s].getAttribute("data-code")){var l={isDrm:!1,code:o[s].getAttribute("data-code"),type:o[s].getAttribute("data-type")?o[s].getAttribute("data-type"):"video",options:{}};o[s].getAttribute("data-woo")&&(l.woo=o[s].getAttribute("data-woo")),o[s].getAttribute("data-woo_memberships")&&(l.woo_memberships=o[s].getAttribute("data-woo_memberships")),o[s].getAttribute("data-teaser")&&(l.teaser=o[s].getAttribute("data-teaser")),o[s].getAttribute("data-is360")&&(l.is360=o[s].getAttribute("data-is360")),o[s].getAttribute("data-autoplay")&&(l.options.autoplay=o[s].getAttribute("data-autoplay")),o[s].getAttribute("data-preventAutoplay")&&(l.options.preventAutoplay=!0),o[s].getAttribute("data-muted")&&(l.options.muted=!0),o[s].getAttribute("data-width")&&(l.options.width=o[s].getAttribute("data-width")),o[s].getAttribute("data-height")&&(l.options.height=o[s].getAttribute("data-height")),o[s].getAttribute("data-poster")&&(s3bubble_drm_frontend_scripts.options.s3bubble_wordpress_poster=o[s].getAttribute("data-poster")),s3bubble(o[s]).video(l)}for(var u=document.getElementsByClassName("s3bmedia"),c=0;c<u.length;c++)if(u[c].getAttribute("data-code")){var d={isDrm:!1,code:u[c].getAttribute("data-code"),type:u[c].getAttribute("data-type")?u[c].getAttribute("data-type"):"video",options:{}};u[c].getAttribute("data-woo")&&(d.woo=u[c].getAttribute("data-woo")),u[c].getAttribute("data-woo_memberships")&&(d.woo_memberships=u[c].getAttribute("data-woo_memberships")),u[c].getAttribute("data-teaser")&&(d.teaser=u[c].getAttribute("data-teaser")),u[c].getAttribute("data-is360")&&(d.is360=u[c].getAttribute("data-is360")),u[c].getAttribute("data-autoplay")&&(d.options.autoplay=u[c].getAttribute("data-autoplay")),u[c].getAttribute("data-preventAutoplay")&&(d.options.preventAutoplay=!0),u[c].getAttribute("data-muted")&&(d.options.muted=!0),u[c].getAttribute("data-width")&&(d.options.width=u[c].getAttribute("data-width")),u[c].getAttribute("data-height")&&(d.options.height=u[c].getAttribute("data-height")),u[c].getAttribute("data-poster")&&(s3bubble_drm_frontend_scripts.options.s3bubble_wordpress_poster=u[c].getAttribute("data-poster")),s3bubble(u[c]).video(d)}for(var h=document.getElementsByClassName("s3bdrm"),f=0;f<h.length;f++){var p={isDrm:!0,widevine:h[f].getAttribute("data-widevine"),playready:h[f].getAttribute("data-playready"),fairplay:h[f].getAttribute("data-fairplay"),assetid:h[f].getAttribute("data-assetid"),type:h[f].getAttribute("data-type")?h[f].getAttribute("data-type"):"video",options:{}};h[f].getAttribute("data-woo")&&(p.woo=h[f].getAttribute("data-woo")),h[f].getAttribute("data-woo_memberships")&&(p.woo_memberships=h[f].getAttribute("data-woo_memberships")),h[f].getAttribute("data-teaser")&&(p.teaser=h[f].getAttribute("data-teaser")),h[f].getAttribute("data-is360")&&(p.is360=h[f].getAttribute("data-is360")),h[f].getAttribute("data-autoplay")&&(p.options.autoplay=h[f].getAttribute("data-autoplay")),h[f].getAttribute("data-preventAutoplay")&&(p.options.preventAutoplay=!0),h[f].getAttribute("data-muted")&&(p.options.muted=!0),h[f].getAttribute("data-width")&&(p.options.width=h[f].getAttribute("data-width")),h[f].getAttribute("data-height")&&(p.options.height=h[f].getAttribute("data-height")),h[f].getAttribute("data-poster")&&(s3bubble_drm_frontend_scripts.options.s3bubble_wordpress_poster=h[f].getAttribute("data-poster")),s3bubble(h[f]).video(p)}},getData:function(e,i){e.location=location.host.indexOf("www.")&&location.host||location.host.replace("www.","");var t={"Content-Type":"application/x-www-form-urlencoded"};s3bubbleHelpers.hasProp(s3bubble_drm_frontend_scripts,"is_amp")&&(t["Amp-Iframe-Request"]=e.location),videojs.xhr({method:"POST",body:function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(0<t.length&&(t+="&"),t+=encodeURI(n+"="+e[n]));return t}(e),uri:n+"/api/"+e.uri,headers:t},function(e,t,n){var r=t.body?JSON.parse(t.body):{message:"Connectivity Error: Please check your internet connection!"};200===t.statusCode?r.error?i({error:!0,message:r.message}):i(r):i({error:!0,message:r.message+" Status: "+t.statusCode})})},getAjaxData:function(e,t,i){videojs.xhr({method:"POST",body:function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(0<t.length&&(t+="&"),t+=encodeURI(n+"="+e[n]));return t}(e),uri:t,headers:{"Content-Type":"application/x-www-form-urlencoded"}},function(e,t,n){var r=t.body?JSON.parse(t.body):{message:"Connectivity Error: Please check your internet connection!"};200===t.statusCode?r.error?i({error:!0,message:r.message}):i(r):i({error:!0,message:r.message+" Status: "+t.statusCode})})},getJson:function(e,i){videojs.xhr({method:"GET",uri:e.waveform,headers:{"Content-Type":"application/x-www-form-urlencoded"}},function(e,t,n){var r=t.body?JSON.parse(t.body):{message:"Connectivity Error: Please check your internet connection!"};200===t.statusCode?i(r):200!==t.statusCode&&i({error:!0,message:r.message+" Status: "+t.statusCode})})}};return r.swipedetect=function(e,t){var n=0,r=0;e.addEventListener("touchstart",function(e){n=e.screenX,e.screenY}),e.addEventListener("touchend",function(e){r=e.screenX,e.screenY,n<r&&t(!0)})},r.s3bubbleCleanFilename=function(t){if(""===t||void 0===t||!1===t)return null;try{return t=(t=(t=(t=decodeURIComponent(t)).replace(/\\/g,"")).replace(/\_/g," ")).replace(/\-/g," ")}catch(e){return t=(t=(t=t.replace(/\\/g,"")).replace(/\_/g," ")).replace(/\-/g," ")}},r.truncate=function(e,t){return e.length>t?e.substr(0,t-1)+"&hellip;":e},r.isAndroid=function(){return navigator.userAgent.match(/Android/i)},r.isBlackBerry=function(){return navigator.userAgent.match(/BlackBerry/i)},r.isIOS=function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},r.isOpera=function(){return navigator.userAgent.match(/Opera Mini/i)},r.isWindows=function(){return navigator.userAgent.match(/IEMobile/i)||navigator.userAgent.match(/WPDesktop/i)},r.isMobile=function(){return r.isAndroid()||r.isBlackBerry()||r.isIOS()||r.isOpera()||r.isWindows()},r.getExternalService=function(e){var t;return e.match(/(http:\/\/|https:\/\/|)(player.|www.)?(dailymotion\.com|vimeo\.com|youtu(be\.com|\.be|be\.googleapis\.com))\/(video\/|embed\/|watch\?v=|v\/)?([A-Za-z0-9._%-]*)(\&\S+)?/),-1<RegExp.$3.indexOf("youtu")?t="youtube":-1<RegExp.$3.indexOf("vimeo")?t="vimeo":-1<RegExp.$3.indexOf("dailymotion")&&(t="dailymotion"),{type:t,id:RegExp.$6}},r.s3bubbleRgbToHex=function(e){return-1!==e.indexOf("#")?e:(e=e.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i))&&4===e.length?"#"+("0"+parseInt(e[1],10).toString(16)).slice(-2)+("0"+parseInt(e[2],10).toString(16)).slice(-2)+("0"+parseInt(e[3],10).toString(16)).slice(-2):""},r}!function(e,t){"object"==typeof exports?module.exports=exports=t():"function"==typeof define&&define.amd?define([],t):e.CryptoJS=t()}(this,function(){var c,n,e,t,r,d,i,a,o,s,l,u,h,f,p,m,g,v,y,_,b,E,T,A,w,S,C,x,M,R,I,P,D,L,O,N,k,B,F,j,U,H,G,V,z,W,q,Y,K,X,Q,Z,J,$,ee,te,ne,re,ie,ae,oe,se,le,ue,ce,de,he,fe,pe,me,ge,ve,ye,_e,be,Ee,Te,Ae,we,Se,Ce,xe,Me,Re,Ie,Pe,De,Le,Oe,Ne,ke,Be,Fe,je=je||(c=Math,n=Object.create||function(e){var t;return Ue.prototype=e,t=new Ue,Ue.prototype=null,t},t=(e={}).lib={},r=t.Base={extend:function(e){var t=n(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),(t.init.prototype=t).$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},d=t.WordArray=r.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||a).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes,i=e.sigBytes;if(this.clamp(),r%4)for(var a=0;a<i;a++){var o=n[a>>>2]>>>24-a%4*8&255;t[r+a>>>2]|=o<<24-(r+a)%4*8}else for(a=0;a<i;a+=4)t[r+a>>>2]=n[a>>>2];return this.sigBytes+=i,this},clamp:function(){var e=this.words,t=this.sigBytes;e[t>>>2]&=4294967295<<32-t%4*8,e.length=c.ceil(t/4)},clone:function(){var e=r.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){function t(t){t=t;var n=987654321,r=4294967295;return function(){var e=((n=36969*(65535&n)+(n>>16)&r)<<16)+(t=18e3*(65535&t)+(t>>16)&r)&r;return e/=4294967296,(e+=.5)*(.5<c.random()?1:-1)}}for(var n,r=[],i=0;i<e;i+=4){var a=t(4294967296*(n||c.random()));n=987654071*a(),r.push(4294967296*a()|0)}return new d.init(r,e)}}),i=e.enc={},a=i.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i++){var a=t[i>>>2]>>>24-i%4*8&255;r.push((a>>>4).toString(16)),r.push((15&a).toString(16))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new d.init(n,t/2)}},o=i.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i++){var a=t[i>>>2]>>>24-i%4*8&255;r.push(String.fromCharCode(a))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new d.init(n,t)}},s=i.Utf8={stringify:function(e){try{return decodeURIComponent(escape(o.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return o.parse(unescape(encodeURIComponent(e)))}},l=t.BufferedBlockAlgorithm=r.extend({reset:function(){this._data=new d.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=s.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(e){var t=this._data,n=t.words,r=t.sigBytes,i=this.blockSize,a=r/(4*i),o=(a=e?c.ceil(a):c.max((0|a)-this._minBufferSize,0))*i,s=c.min(4*o,r);if(o){for(var l=0;l<o;l+=i)this._doProcessBlock(n,l);var u=n.splice(0,o);t.sigBytes-=s}return new d.init(u,s)},clone:function(){var e=r.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),t.Hasher=l.extend({cfg:r.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(n){return function(e,t){return new n.init(t).finalize(e)}},_createHmacHelper:function(n){return function(e,t){return new u.HMAC.init(n,t).finalize(e)}}}),u=e.algo={},e);function Ue(){}function He(e,t,n){return e^t^n}function Ge(e,t,n){return e&t|~e&n}function Ve(e,t,n){return(e|~t)^n}function ze(e,t,n){return e&n|t&~n}function We(e,t,n){return e^(t|~n)}function qe(e,t){return e<<t|e>>>32-t}function Ye(e,t,n,r){var i=this._iv;if(i){var a=i.slice(0);this._iv=void 0}else a=this._prevBlock;r.encryptBlock(a,0);for(var o=0;o<n;o++)e[t+o]^=a[o]}function Ke(e){if(255==(e>>24&255)){var t=e>>16&255,n=e>>8&255,r=255&e;255===t?(t=0,255===n?(n=0,255===r?r=0:++r):++n):++t,e=0,e+=t<<16,e+=n<<8,e+=r}else e+=1<<24;return e}function Xe(){for(var e=this._X,t=this._C,n=0;n<8;n++)xe[n]=t[n];t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<xe[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<xe[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<xe[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<xe[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<xe[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<xe[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<xe[6]>>>0?1:0)|0,this._b=t[7]>>>0<xe[7]>>>0?1:0;for(n=0;n<8;n++){var r=e[n]+t[n],i=65535&r,a=r>>>16,o=((i*i>>>17)+i*a>>>15)+a*a,s=((4294901760&r)*r|0)+((65535&r)*r|0);Me[n]=o^s}e[0]=Me[0]+(Me[7]<<16|Me[7]>>>16)+(Me[6]<<16|Me[6]>>>16)|0,e[1]=Me[1]+(Me[0]<<8|Me[0]>>>24)+Me[7]|0,e[2]=Me[2]+(Me[1]<<16|Me[1]>>>16)+(Me[0]<<16|Me[0]>>>16)|0,e[3]=Me[3]+(Me[2]<<8|Me[2]>>>24)+Me[1]|0,e[4]=Me[4]+(Me[3]<<16|Me[3]>>>16)+(Me[2]<<16|Me[2]>>>16)|0,e[5]=Me[5]+(Me[4]<<8|Me[4]>>>24)+Me[3]|0,e[6]=Me[6]+(Me[5]<<16|Me[5]>>>16)+(Me[4]<<16|Me[4]>>>16)|0,e[7]=Me[7]+(Me[6]<<8|Me[6]>>>24)+Me[5]|0}function Qe(){for(var e=this._X,t=this._C,n=0;n<8;n++)ke[n]=t[n];t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<ke[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<ke[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<ke[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<ke[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<ke[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<ke[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<ke[6]>>>0?1:0)|0,this._b=t[7]>>>0<ke[7]>>>0?1:0;for(n=0;n<8;n++){var r=e[n]+t[n],i=65535&r,a=r>>>16,o=((i*i>>>17)+i*a>>>15)+a*a,s=((4294901760&r)*r|0)+((65535&r)*r|0);Be[n]=o^s}e[0]=Be[0]+(Be[7]<<16|Be[7]>>>16)+(Be[6]<<16|Be[6]>>>16)|0,e[1]=Be[1]+(Be[0]<<8|Be[0]>>>24)+Be[7]|0,e[2]=Be[2]+(Be[1]<<16|Be[1]>>>16)+(Be[0]<<16|Be[0]>>>16)|0,e[3]=Be[3]+(Be[2]<<8|Be[2]>>>24)+Be[1]|0,e[4]=Be[4]+(Be[3]<<16|Be[3]>>>16)+(Be[2]<<16|Be[2]>>>16)|0,e[5]=Be[5]+(Be[4]<<8|Be[4]>>>24)+Be[3]|0,e[6]=Be[6]+(Be[5]<<16|Be[5]>>>16)+(Be[4]<<16|Be[4]>>>16)|0,e[7]=Be[7]+(Be[6]<<8|Be[6]>>>24)+Be[5]|0}return f=(h=je).lib.WordArray,h.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp();for(var i=[],a=0;a<n;a+=3)for(var o=(t[a>>>2]>>>24-a%4*8&255)<<16|(t[a+1>>>2]>>>24-(a+1)%4*8&255)<<8|t[a+2>>>2]>>>24-(a+2)%4*8&255,s=0;s<4&&a+.75*s<n;s++)i.push(r.charAt(o>>>6*(3-s)&63));var l=r.charAt(64);if(l)for(;i.length%4;)i.push(l);return i.join("")},parse:function(e){var t=e.length,n=this._map,r=this._reverseMap;if(!r){r=this._reverseMap=[];for(var i=0;i<n.length;i++)r[n.charCodeAt(i)]=i}var a=n.charAt(64);if(a){var o=e.indexOf(a);-1!==o&&(t=o)}return function(e,t,n){for(var r=[],i=0,a=0;a<t;a++)if(a%4){var o=n[e.charCodeAt(a-1)]<<a%4*2,s=n[e.charCodeAt(a)]>>>6-a%4*2;r[i>>>2]|=(o|s)<<24-i%4*8,i++}return f.create(r,i)}(e,t,r)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},function(c){var e=je,t=e.lib,n=t.WordArray,r=t.Hasher,i=e.algo,C=[];!function(){for(var e=0;e<64;e++)C[e]=4294967296*c.abs(c.sin(e+1))|0}();var a=i.MD5=r.extend({_doReset:function(){this._hash=new n.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var r=t+n,i=e[r];e[r]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8)}var a=this._hash.words,o=e[t+0],s=e[t+1],l=e[t+2],u=e[t+3],c=e[t+4],d=e[t+5],h=e[t+6],f=e[t+7],p=e[t+8],m=e[t+9],g=e[t+10],v=e[t+11],y=e[t+12],_=e[t+13],b=e[t+14],E=e[t+15],T=a[0],A=a[1],w=a[2],S=a[3];T=x(T,A,w,S,o,7,C[0]),S=x(S,T,A,w,s,12,C[1]),w=x(w,S,T,A,l,17,C[2]),A=x(A,w,S,T,u,22,C[3]),T=x(T,A,w,S,c,7,C[4]),S=x(S,T,A,w,d,12,C[5]),w=x(w,S,T,A,h,17,C[6]),A=x(A,w,S,T,f,22,C[7]),T=x(T,A,w,S,p,7,C[8]),S=x(S,T,A,w,m,12,C[9]),w=x(w,S,T,A,g,17,C[10]),A=x(A,w,S,T,v,22,C[11]),T=x(T,A,w,S,y,7,C[12]),S=x(S,T,A,w,_,12,C[13]),w=x(w,S,T,A,b,17,C[14]),T=M(T,A=x(A,w,S,T,E,22,C[15]),w,S,s,5,C[16]),S=M(S,T,A,w,h,9,C[17]),w=M(w,S,T,A,v,14,C[18]),A=M(A,w,S,T,o,20,C[19]),T=M(T,A,w,S,d,5,C[20]),S=M(S,T,A,w,g,9,C[21]),w=M(w,S,T,A,E,14,C[22]),A=M(A,w,S,T,c,20,C[23]),T=M(T,A,w,S,m,5,C[24]),S=M(S,T,A,w,b,9,C[25]),w=M(w,S,T,A,u,14,C[26]),A=M(A,w,S,T,p,20,C[27]),T=M(T,A,w,S,_,5,C[28]),S=M(S,T,A,w,l,9,C[29]),w=M(w,S,T,A,f,14,C[30]),T=R(T,A=M(A,w,S,T,y,20,C[31]),w,S,d,4,C[32]),S=R(S,T,A,w,p,11,C[33]),w=R(w,S,T,A,v,16,C[34]),A=R(A,w,S,T,b,23,C[35]),T=R(T,A,w,S,s,4,C[36]),S=R(S,T,A,w,c,11,C[37]),w=R(w,S,T,A,f,16,C[38]),A=R(A,w,S,T,g,23,C[39]),T=R(T,A,w,S,_,4,C[40]),S=R(S,T,A,w,o,11,C[41]),w=R(w,S,T,A,u,16,C[42]),A=R(A,w,S,T,h,23,C[43]),T=R(T,A,w,S,m,4,C[44]),S=R(S,T,A,w,y,11,C[45]),w=R(w,S,T,A,E,16,C[46]),T=I(T,A=R(A,w,S,T,l,23,C[47]),w,S,o,6,C[48]),S=I(S,T,A,w,f,10,C[49]),w=I(w,S,T,A,b,15,C[50]),A=I(A,w,S,T,d,21,C[51]),T=I(T,A,w,S,y,6,C[52]),S=I(S,T,A,w,u,10,C[53]),w=I(w,S,T,A,g,15,C[54]),A=I(A,w,S,T,s,21,C[55]),T=I(T,A,w,S,p,6,C[56]),S=I(S,T,A,w,E,10,C[57]),w=I(w,S,T,A,h,15,C[58]),A=I(A,w,S,T,_,21,C[59]),T=I(T,A,w,S,c,6,C[60]),S=I(S,T,A,w,v,10,C[61]),w=I(w,S,T,A,l,15,C[62]),A=I(A,w,S,T,m,21,C[63]),a[0]=a[0]+T|0,a[1]=a[1]+A|0,a[2]=a[2]+w|0,a[3]=a[3]+S|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;t[r>>>5]|=128<<24-r%32;var i=c.floor(n/4294967296),a=n;t[15+(64+r>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),t[14+(64+r>>>9<<4)]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),e.sigBytes=4*(t.length+1),this._process();for(var o=this._hash,s=o.words,l=0;l<4;l++){var u=s[l];s[l]=16711935&(u<<8|u>>>24)|4278255360&(u<<24|u>>>8)}return o},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});function x(e,t,n,r,i,a,o){var s=e+(t&n|~t&r)+i+o;return(s<<a|s>>>32-a)+t}function M(e,t,n,r,i,a,o){var s=e+(t&r|n&~r)+i+o;return(s<<a|s>>>32-a)+t}function R(e,t,n,r,i,a,o){var s=e+(t^n^r)+i+o;return(s<<a|s>>>32-a)+t}function I(e,t,n,r,i,a,o){var s=e+(n^(t|~r))+i+o;return(s<<a|s>>>32-a)+t}e.MD5=r._createHelper(a),e.HmacMD5=r._createHmacHelper(a)}(Math),m=(p=je).lib,g=m.WordArray,v=m.Hasher,y=p.algo,_=[],b=y.SHA1=v.extend({_doReset:function(){this._hash=new g.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],i=n[1],a=n[2],o=n[3],s=n[4],l=0;l<80;l++){if(l<16)_[l]=0|e[t+l];else{var u=_[l-3]^_[l-8]^_[l-14]^_[l-16];_[l]=u<<1|u>>>31}var c=(r<<5|r>>>27)+s+_[l];c+=l<20?1518500249+(i&a|~i&o):l<40?1859775393+(i^a^o):l<60?(i&a|i&o|a&o)-1894007588:(i^a^o)-899497514,s=o,o=a,a=i<<30|i>>>2,i=r,r=c}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+a|0,n[3]=n[3]+o|0,n[4]=n[4]+s|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[14+(64+r>>>9<<4)]=Math.floor(n/4294967296),t[15+(64+r>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=v.clone.call(this);return e._hash=this._hash.clone(),e}}),p.SHA1=v._createHelper(b),p.HmacSHA1=v._createHmacHelper(b),function(i){var e=je,t=e.lib,n=t.WordArray,r=t.Hasher,a=e.algo,o=[],_=[];!function(){function e(e){for(var t=i.sqrt(e),n=2;n<=t;n++)if(!(e%n))return!1;return!0}function t(e){return 4294967296*(e-(0|e))|0}for(var n=2,r=0;r<64;)e(n)&&(r<8&&(o[r]=t(i.pow(n,.5))),_[r]=t(i.pow(n,1/3)),r++),n++}();var b=[],s=a.SHA256=r.extend({_doReset:function(){this._hash=new n.init(o.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],i=n[1],a=n[2],o=n[3],s=n[4],l=n[5],u=n[6],c=n[7],d=0;d<64;d++){if(d<16)b[d]=0|e[t+d];else{var h=b[d-15],f=(h<<25|h>>>7)^(h<<14|h>>>18)^h>>>3,p=b[d-2],m=(p<<15|p>>>17)^(p<<13|p>>>19)^p>>>10;b[d]=f+b[d-7]+m+b[d-16]}var g=r&i^r&a^i&a,v=(r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22),y=c+((s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25))+(s&l^~s&u)+_[d]+b[d];c=u,u=l,l=s,s=o+y|0,o=a,a=i,i=r,r=y+(v+g)|0}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+a|0,n[3]=n[3]+o|0,n[4]=n[4]+s|0,n[5]=n[5]+l|0,n[6]=n[6]+u|0,n[7]=n[7]+c|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[14+(64+r>>>9<<4)]=i.floor(n/4294967296),t[15+(64+r>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});e.SHA256=r._createHelper(s),e.HmacSHA256=r._createHmacHelper(s)}(Math),function(){var e=je,i=e.lib.WordArray,t=e.enc;t.Utf16=t.Utf16BE={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i+=2){var a=t[i>>>2]>>>16-i%4*8&65535;r.push(String.fromCharCode(a))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>1]|=e.charCodeAt(r)<<16-r%2*16;return i.create(n,2*t)}};function o(e){return e<<8&4278255360|e>>>8&16711935}t.Utf16LE={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i+=2){var a=o(t[i>>>2]>>>16-i%4*8&65535);r.push(String.fromCharCode(a))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>1]|=o(e.charCodeAt(r)<<16-r%2*16);return i.create(n,2*t)}}}(),function(){if("function"==typeof ArrayBuffer){var e=je.lib.WordArray,i=e.init;(e.init=function(e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(e instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var t=e.byteLength,n=[],r=0;r<t;r++)n[r>>>2]|=e[r]<<24-r%4*8;i.call(this,n,t)}else i.apply(this,arguments)}).prototype=e}}(),Math,T=(E=je).lib,A=T.WordArray,w=T.Hasher,S=E.algo,C=A.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),x=A.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),M=A.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),R=A.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),I=A.create([0,1518500249,1859775393,2400959708,2840853838]),P=A.create([1352829926,1548603684,1836072691,2053994217,0]),D=S.RIPEMD160=w.extend({_doReset:function(){this._hash=A.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var r=t+n,i=e[r];e[r]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8)}var a,o,s,l,u,c,d,h,f,p,m,g=this._hash.words,v=I.words,y=P.words,_=C.words,b=x.words,E=M.words,T=R.words;c=a=g[0],d=o=g[1],h=s=g[2],f=l=g[3],p=u=g[4];for(n=0;n<80;n+=1)m=a+e[t+_[n]]|0,m+=n<16?He(o,s,l)+v[0]:n<32?Ge(o,s,l)+v[1]:n<48?Ve(o,s,l)+v[2]:n<64?ze(o,s,l)+v[3]:We(o,s,l)+v[4],m=(m=qe(m|=0,E[n]))+u|0,a=u,u=l,l=qe(s,10),s=o,o=m,m=c+e[t+b[n]]|0,m+=n<16?We(d,h,f)+y[0]:n<32?ze(d,h,f)+y[1]:n<48?Ve(d,h,f)+y[2]:n<64?Ge(d,h,f)+y[3]:He(d,h,f)+y[4],m=(m=qe(m|=0,T[n]))+p|0,c=p,p=f,f=qe(h,10),h=d,d=m;m=g[1]+s+f|0,g[1]=g[2]+l+p|0,g[2]=g[3]+u+c|0,g[3]=g[4]+a+d|0,g[4]=g[0]+o+h|0,g[0]=m},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;t[r>>>5]|=128<<24-r%32,t[14+(64+r>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),e.sigBytes=4*(t.length+1),this._process();for(var i=this._hash,a=i.words,o=0;o<5;o++){var s=a[o];a[o]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8)}return i},clone:function(){var e=w.clone.call(this);return e._hash=this._hash.clone(),e}}),E.RIPEMD160=w._createHelper(D),E.HmacRIPEMD160=w._createHmacHelper(D),O=(L=je).lib.Base,N=L.enc.Utf8,L.algo.HMAC=O.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=N.parse(t));var n=e.blockSize,r=4*n;t.sigBytes>r&&(t=e.finalize(t)),t.clamp();for(var i=this._oKey=t.clone(),a=this._iKey=t.clone(),o=i.words,s=a.words,l=0;l<n;l++)o[l]^=1549556828,s[l]^=909522486;i.sigBytes=a.sigBytes=r,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,n=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(n))}}),B=(k=je).lib,F=B.Base,j=B.WordArray,U=k.algo,H=U.SHA1,G=U.HMAC,V=U.PBKDF2=F.extend({cfg:F.extend({keySize:4,hasher:H,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=this.cfg,r=G.create(n.hasher,e),i=j.create(),a=j.create([1]),o=i.words,s=a.words,l=n.keySize,u=n.iterations;o.length<l;){var c=r.update(t).finalize(a);r.reset();for(var d=c.words,h=d.length,f=c,p=1;p<u;p++){f=r.finalize(f),r.reset();for(var m=f.words,g=0;g<h;g++)d[g]^=m[g]}i.concat(c),s[0]++}return i.sigBytes=4*l,i}}),k.PBKDF2=function(e,t,n){return V.create(n).compute(e,t)},W=(z=je).lib,q=W.Base,Y=W.WordArray,K=z.algo,X=K.MD5,Q=K.EvpKDF=q.extend({cfg:q.extend({keySize:4,hasher:X,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=this.cfg,r=n.hasher.create(),i=Y.create(),a=i.words,o=n.keySize,s=n.iterations;a.length<o;){l&&r.update(l);var l=r.update(e).finalize(t);r.reset();for(var u=1;u<s;u++)l=r.finalize(l),r.reset();i.concat(l)}return i.sigBytes=4*o,i}}),z.EvpKDF=function(e,t,n){return Q.create(n).compute(e,t)},J=(Z=je).lib.WordArray,$=Z.algo,ee=$.SHA256,te=$.SHA224=ee.extend({_doReset:function(){this._hash=new J.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=ee._doFinalize.call(this);return e.sigBytes-=4,e}}),Z.SHA224=ee._createHelper(te),Z.HmacSHA224=ee._createHmacHelper(te),re=(ne=je).lib,ie=re.Base,ae=re.WordArray,(oe=ne.x64={}).Word=ie.extend({init:function(e,t){this.high=e,this.low=t}}),oe.WordArray=ie.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:8*e.length},toX32:function(){for(var e=this.words,t=e.length,n=[],r=0;r<t;r++){var i=e[r];n.push(i.high),n.push(i.low)}return ae.create(n,this.sigBytes)},clone:function(){for(var e=ie.clone.call(this),t=e.words=this.words.slice(0),n=t.length,r=0;r<n;r++)t[r]=t[r].clone();return e}}),function(h){var e=je,t=e.lib,f=t.WordArray,r=t.Hasher,c=e.x64.Word,n=e.algo,R=[],I=[],P=[];!function(){for(var e=1,t=0,n=0;n<24;n++){R[e+5*t]=(n+1)*(n+2)/2%64;var r=(2*e+3*t)%5;e=t%5,t=r}for(e=0;e<5;e++)for(t=0;t<5;t++)I[e+5*t]=t+(2*e+3*t)%5*5;for(var i=1,a=0;a<24;a++){for(var o=0,s=0,l=0;l<7;l++){if(1&i){var u=(1<<l)-1;u<32?s^=1<<u:o^=1<<u-32}128&i?i=i<<1^113:i<<=1}P[a]=c.create(o,s)}}();var D=[];!function(){for(var e=0;e<25;e++)D[e]=c.create()}();var i=n.SHA3=r.extend({cfg:r.cfg.extend({outputLength:512}),_doReset:function(){for(var e=this._state=[],t=0;t<25;t++)e[t]=new c.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(e,t){for(var n=this._state,r=this.blockSize/2,i=0;i<r;i++){var a=e[t+2*i],o=e[t+2*i+1];a=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),o=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),(w=n[i]).high^=o,w.low^=a}for(var s=0;s<24;s++){for(var l=0;l<5;l++){for(var u=0,c=0,d=0;d<5;d++){u^=(w=n[l+5*d]).high,c^=w.low}var h=D[l];h.high=u,h.low=c}for(l=0;l<5;l++){var f=D[(l+4)%5],p=D[(l+1)%5],m=p.high,g=p.low;for(u=f.high^(m<<1|g>>>31),c=f.low^(g<<1|m>>>31),d=0;d<5;d++){(w=n[l+5*d]).high^=u,w.low^=c}}for(var v=1;v<25;v++){var y=(w=n[v]).high,_=w.low,b=R[v];if(b<32)u=y<<b|_>>>32-b,c=_<<b|y>>>32-b;else u=_<<b-32|y>>>64-b,c=y<<b-32|_>>>64-b;var E=D[I[v]];E.high=u,E.low=c}var T=D[0],A=n[0];T.high=A.high,T.low=A.low;for(l=0;l<5;l++)for(d=0;d<5;d++){var w=n[v=l+5*d],S=D[v],C=D[(l+1)%5+5*d],x=D[(l+2)%5+5*d];w.high=S.high^~C.high&x.high,w.low=S.low^~C.low&x.low}w=n[0];var M=P[s];w.high^=M.high,w.low^=M.low}},_doFinalize:function(){var e=this._data,t=e.words,n=(this._nDataBytes,8*e.sigBytes),r=32*this.blockSize;t[n>>>5]|=1<<24-n%32,t[(h.ceil((1+n)/r)*r>>>5)-1]|=128,e.sigBytes=4*t.length,this._process();for(var i=this._state,a=this.cfg.outputLength/8,o=a/8,s=[],l=0;l<o;l++){var u=i[l],c=u.high,d=u.low;c=16711935&(c<<8|c>>>24)|4278255360&(c<<24|c>>>8),d=16711935&(d<<8|d>>>24)|4278255360&(d<<24|d>>>8),s.push(d),s.push(c)}return new f.init(s,a)},clone:function(){for(var e=r.clone.call(this),t=e._state=this._state.slice(0),n=0;n<25;n++)t[n]=t[n].clone();return e}});e.SHA3=r._createHelper(i),e.HmacSHA3=r._createHmacHelper(i)}(Math),function(){var e=je,t=e.lib.Hasher,n=e.x64,r=n.Word,i=n.WordArray,a=e.algo;function o(){return r.create.apply(r,arguments)}var Ae=[o(1116352408,3609767458),o(1899447441,602891725),o(3049323471,3964484399),o(3921009573,2173295548),o(961987163,4081628472),o(1508970993,3053834265),o(2453635748,2937671579),o(2870763221,3664609560),o(3624381080,2734883394),o(310598401,1164996542),o(607225278,1323610764),o(1426881987,3590304994),o(1925078388,4068182383),o(2162078206,991336113),o(2614888103,633803317),o(3248222580,3479774868),o(3835390401,2666613458),o(4022224774,944711139),o(264347078,2341262773),o(604807628,2007800933),o(770255983,1495990901),o(1249150122,1856431235),o(1555081692,3175218132),o(1996064986,2198950837),o(2554220882,3999719339),o(2821834349,766784016),o(2952996808,2566594879),o(3210313671,3203337956),o(3336571891,1034457026),o(3584528711,2466948901),o(113926993,3758326383),o(338241895,168717936),o(666307205,1188179964),o(773529912,1546045734),o(1294757372,1522805485),o(1396182291,2643833823),o(1695183700,2343527390),o(1986661051,1014477480),o(2177026350,1206759142),o(2456956037,344077627),o(2730485921,1290863460),o(2820302411,3158454273),o(3259730800,3505952657),o(3345764771,106217008),o(3516065817,3606008344),o(3600352804,1432725776),o(4094571909,1467031594),o(275423344,851169720),o(430227734,3100823752),o(506948616,1363258195),o(659060556,3750685593),o(883997877,3785050280),o(958139571,3318307427),o(1322822218,3812723403),o(1537002063,2003034995),o(1747873779,3602036899),o(1955562222,1575990012),o(2024104815,1125592928),o(2227730452,2716904306),o(2361852424,442776044),o(2428436474,593698344),o(2756734187,3733110249),o(3204031479,2999351573),o(3329325298,3815920427),o(3391569614,3928383900),o(3515267271,566280711),o(3940187606,3454069534),o(4118630271,4000239992),o(116418474,1914138554),o(174292421,2731055270),o(289380356,3203993006),o(460393269,320620315),o(685471733,587496836),o(852142971,1086792851),o(1017036298,365543100),o(1126000580,2618297676),o(1288033470,3409855158),o(1501505948,4234509866),o(1607167915,987167468),o(1816402316,1246189591)],we=[];!function(){for(var e=0;e<80;e++)we[e]=o()}();var s=a.SHA512=t.extend({_doReset:function(){this._hash=new i.init([new r.init(1779033703,4089235720),new r.init(3144134277,2227873595),new r.init(1013904242,4271175723),new r.init(2773480762,1595750129),new r.init(1359893119,2917565137),new r.init(2600822924,725511199),new r.init(528734635,4215389547),new r.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],i=n[1],a=n[2],o=n[3],s=n[4],l=n[5],u=n[6],c=n[7],d=r.high,h=r.low,f=i.high,p=i.low,m=a.high,g=a.low,v=o.high,y=o.low,_=s.high,b=s.low,E=l.high,T=l.low,A=u.high,w=u.low,S=c.high,C=c.low,x=d,M=h,R=f,I=p,P=m,D=g,L=v,O=y,N=_,k=b,B=E,F=T,j=A,U=w,H=S,G=C,V=0;V<80;V++){var z=we[V];if(V<16)var W=z.high=0|e[t+2*V],q=z.low=0|e[t+2*V+1];else{var Y=we[V-15],K=Y.high,X=Y.low,Q=(K>>>1|X<<31)^(K>>>8|X<<24)^K>>>7,Z=(X>>>1|K<<31)^(X>>>8|K<<24)^(X>>>7|K<<25),J=we[V-2],$=J.high,ee=J.low,te=($>>>19|ee<<13)^($<<3|ee>>>29)^$>>>6,ne=(ee>>>19|$<<13)^(ee<<3|$>>>29)^(ee>>>6|$<<26),re=we[V-7],ie=re.high,ae=re.low,oe=we[V-16],se=oe.high,le=oe.low;W=(W=(W=Q+ie+((q=Z+ae)>>>0<Z>>>0?1:0))+te+((q=q+ne)>>>0<ne>>>0?1:0))+se+((q=q+le)>>>0<le>>>0?1:0);z.high=W,z.low=q}var ue,ce=N&B^~N&j,de=k&F^~k&U,he=x&R^x&P^R&P,fe=M&I^M&D^I&D,pe=(x>>>28|M<<4)^(x<<30|M>>>2)^(x<<25|M>>>7),me=(M>>>28|x<<4)^(M<<30|x>>>2)^(M<<25|x>>>7),ge=(N>>>14|k<<18)^(N>>>18|k<<14)^(N<<23|k>>>9),ve=(k>>>14|N<<18)^(k>>>18|N<<14)^(k<<23|N>>>9),ye=Ae[V],_e=ye.high,be=ye.low,Ee=H+ge+((ue=G+ve)>>>0<G>>>0?1:0),Te=me+fe;H=j,G=U,j=B,U=F,B=N,F=k,N=L+(Ee=(Ee=(Ee=Ee+ce+((ue=ue+de)>>>0<de>>>0?1:0))+_e+((ue=ue+be)>>>0<be>>>0?1:0))+W+((ue=ue+q)>>>0<q>>>0?1:0))+((k=O+ue|0)>>>0<O>>>0?1:0)|0,L=P,O=D,P=R,D=I,R=x,I=M,x=Ee+(pe+he+(Te>>>0<me>>>0?1:0))+((M=ue+Te|0)>>>0<ue>>>0?1:0)|0}h=r.low=h+M,r.high=d+x+(h>>>0<M>>>0?1:0),p=i.low=p+I,i.high=f+R+(p>>>0<I>>>0?1:0),g=a.low=g+D,a.high=m+P+(g>>>0<D>>>0?1:0),y=o.low=y+O,o.high=v+L+(y>>>0<O>>>0?1:0),b=s.low=b+k,s.high=_+N+(b>>>0<k>>>0?1:0),T=l.low=T+F,l.high=E+B+(T>>>0<F>>>0?1:0),w=u.low=w+U,u.high=A+j+(w>>>0<U>>>0?1:0),C=c.low=C+G,c.high=S+H+(C>>>0<G>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[30+(128+r>>>10<<5)]=Math.floor(n/4294967296),t[31+(128+r>>>10<<5)]=n,e.sigBytes=4*t.length,this._process(),this._hash.toX32()},clone:function(){var e=t.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32});e.SHA512=t._createHelper(s),e.HmacSHA512=t._createHmacHelper(s)}(),le=(se=je).x64,ue=le.Word,ce=le.WordArray,de=se.algo,he=de.SHA512,fe=de.SHA384=he.extend({_doReset:function(){this._hash=new ce.init([new ue.init(3418070365,3238371032),new ue.init(1654270250,914150663),new ue.init(2438529370,812702999),new ue.init(355462360,4144912697),new ue.init(1731405415,4290775857),new ue.init(2394180231,1750603025),new ue.init(3675008525,1694076839),new ue.init(1203062813,3204075428)])},_doFinalize:function(){var e=he._doFinalize.call(this);return e.sigBytes-=16,e}}),se.SHA384=he._createHelper(fe),se.HmacSHA384=he._createHmacHelper(fe),je.lib.Cipher||function(){var e=je,t=e.lib,n=t.Base,l=t.WordArray,r=t.BufferedBlockAlgorithm,i=e.enc,a=(i.Utf8,i.Base64),o=e.algo.EvpKDF,s=t.Cipher=r.extend({cfg:n.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){r.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(r){return{encrypt:function(e,t,n){return u(t).encrypt(r,e,t,n)},decrypt:function(e,t,n){return u(t).decrypt(r,e,t,n)}}}});function u(e){return"string"==typeof e?b:y}t.StreamCipher=s.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var c,d=e.mode={},h=t.BlockCipherMode=n.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),f=d.CBC=((c=h.extend()).Encryptor=c.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize;p.call(this,e,t,r),n.encryptBlock(e,t),this._prevBlock=e.slice(t,t+r)}}),c.Decryptor=c.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,i=e.slice(t,t+r);n.decryptBlock(e,t),p.call(this,e,t,r),this._prevBlock=i}}),c);function p(e,t,n){var r=this._iv;if(r){var i=r;this._iv=void 0}else i=this._prevBlock;for(var a=0;a<n;a++)e[t+a]^=i[a]}var m=(e.pad={}).Pkcs7={pad:function(e,t){for(var n=4*t,r=n-e.sigBytes%n,i=r<<24|r<<16|r<<8|r,a=[],o=0;o<r;o+=4)a.push(i);var s=l.create(a,r);e.concat(s)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},g=(t.BlockCipher=s.extend({cfg:s.cfg.extend({mode:f,padding:m}),reset:function(){s.reset.call(this);var e=this.cfg,t=e.iv,n=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var r=n.createEncryptor;else{r=n.createDecryptor;this._minBufferSize=1}this._mode&&this._mode.__creator==r?this._mode.init(this,t&&t.words):(this._mode=r.call(n,this,t&&t.words),this._mode.__creator=r)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else{t=this._process(!0);e.unpad(t)}return t},blockSize:4}),t.CipherParams=n.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}})),v=(e.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext,n=e.salt;if(n)var r=l.create([1398893684,1701076831]).concat(n).concat(t);else r=t;return r.toString(a)},parse:function(e){var t=a.parse(e),n=t.words;if(1398893684==n[0]&&1701076831==n[1]){var r=l.create(n.slice(2,4));n.splice(0,4),t.sigBytes-=16}return g.create({ciphertext:t,salt:r})}},y=t.SerializableCipher=n.extend({cfg:n.extend({format:v}),encrypt:function(e,t,n,r){r=this.cfg.extend(r);var i=e.createEncryptor(n,r),a=i.finalize(t),o=i.cfg;return g.create({ciphertext:a,key:n,iv:o.iv,algorithm:e,mode:o.mode,padding:o.padding,blockSize:e.blockSize,formatter:r.format})},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),e.createDecryptor(n,r).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),_=(e.kdf={}).OpenSSL={execute:function(e,t,n,r){r=r||l.random(8);var i=o.create({keySize:t+n}).compute(e,r),a=l.create(i.words.slice(t),4*n);return i.sigBytes=4*t,g.create({key:i,iv:a,salt:r})}},b=t.PasswordBasedCipher=y.extend({cfg:y.cfg.extend({kdf:_}),encrypt:function(e,t,n,r){var i=(r=this.cfg.extend(r)).kdf.execute(n,e.keySize,e.ivSize);r.iv=i.iv;var a=y.encrypt.call(this,e,t,i.key,r);return a.mixIn(i),a},decrypt:function(e,t,n,r){r=this.cfg.extend(r),t=this._parse(t,r.format);var i=r.kdf.execute(n,e.keySize,e.ivSize,t.salt);return r.iv=i.iv,y.decrypt.call(this,e,t,i.key,r)}})}(),je.mode.CFB=((pe=je.lib.BlockCipherMode.extend()).Encryptor=pe.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize;Ye.call(this,e,t,r,n),this._prevBlock=e.slice(t,t+r)}}),pe.Decryptor=pe.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,i=e.slice(t,t+r);Ye.call(this,e,t,r,n),this._prevBlock=i}}),pe),je.mode.ECB=((me=je.lib.BlockCipherMode.extend()).Encryptor=me.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),me.Decryptor=me.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),me),je.pad.AnsiX923={pad:function(e,t){var n=e.sigBytes,r=4*t,i=r-n%r,a=n+i-1;e.clamp(),e.words[a>>>2]|=i<<24-a%4*8,e.sigBytes+=i},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},je.pad.Iso10126={pad:function(e,t){var n=4*t,r=n-e.sigBytes%n;e.concat(je.lib.WordArray.random(r-1)).concat(je.lib.WordArray.create([r<<24],1))},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},je.pad.Iso97971={pad:function(e,t){e.concat(je.lib.WordArray.create([2147483648],1)),je.pad.ZeroPadding.pad(e,t)},unpad:function(e){je.pad.ZeroPadding.unpad(e),e.sigBytes--}},je.mode.OFB=(ge=je.lib.BlockCipherMode.extend(),ve=ge.Encryptor=ge.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,i=this._iv,a=this._keystream;i&&(a=this._keystream=i.slice(0),this._iv=void 0),n.encryptBlock(a,0);for(var o=0;o<r;o++)e[t+o]^=a[o]}}),ge.Decryptor=ve,ge),je.pad.NoPadding={pad:function(){},unpad:function(){}},_e=(ye=je).lib.CipherParams,be=ye.enc.Hex,ye.format.Hex={stringify:function(e){return e.ciphertext.toString(be)},parse:function(e){var t=be.parse(e);return _e.create({ciphertext:t})}},function(){var e=je,t=e.lib.BlockCipher,n=e.algo,u=[],c=[],d=[],h=[],f=[],p=[],m=[],g=[],v=[],y=[];!function(){for(var e=[],t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;var n=0,r=0;for(t=0;t<256;t++){var i=r^r<<1^r<<2^r<<3^r<<4;i=i>>>8^255&i^99,u[n]=i;var a=e[c[i]=n],o=e[a],s=e[o],l=257*e[i]^16843008*i;d[n]=l<<24|l>>>8,h[n]=l<<16|l>>>16,f[n]=l<<8|l>>>24,p[n]=l;l=16843009*s^65537*o^257*a^16843008*n;m[i]=l<<24|l>>>8,g[i]=l<<16|l>>>16,v[i]=l<<8|l>>>24,y[i]=l,n?(n=a^e[e[e[s^a]]],r^=e[e[r]]):n=r=1}}();var _=[0,1,2,4,8,16,32,64,128,27,54],r=n.AES=t.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var e=this._keyPriorReset=this._key,t=e.words,n=e.sigBytes/4,r=4*(1+(this._nRounds=6+n)),i=this._keySchedule=[],a=0;a<r;a++)if(a<n)i[a]=t[a];else{var o=i[a-1];a%n?6<n&&a%n==4&&(o=u[o>>>24]<<24|u[o>>>16&255]<<16|u[o>>>8&255]<<8|u[255&o]):(o=u[(o=o<<8|o>>>24)>>>24]<<24|u[o>>>16&255]<<16|u[o>>>8&255]<<8|u[255&o],o^=_[a/n|0]<<24),i[a]=i[a-n]^o}for(var s=this._invKeySchedule=[],l=0;l<r;l++){a=r-l;if(l%4)o=i[a];else o=i[a-4];s[l]=l<4||a<=4?o:m[u[o>>>24]]^g[u[o>>>16&255]]^v[u[o>>>8&255]]^y[u[255&o]]}}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,d,h,f,p,u)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,m,g,v,y,c);n=e[t+1];e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,r,i,a,o,s){for(var l=this._nRounds,u=e[t]^n[0],c=e[t+1]^n[1],d=e[t+2]^n[2],h=e[t+3]^n[3],f=4,p=1;p<l;p++){var m=r[u>>>24]^i[c>>>16&255]^a[d>>>8&255]^o[255&h]^n[f++],g=r[c>>>24]^i[d>>>16&255]^a[h>>>8&255]^o[255&u]^n[f++],v=r[d>>>24]^i[h>>>16&255]^a[u>>>8&255]^o[255&c]^n[f++],y=r[h>>>24]^i[u>>>16&255]^a[c>>>8&255]^o[255&d]^n[f++];u=m,c=g,d=v,h=y}m=(s[u>>>24]<<24|s[c>>>16&255]<<16|s[d>>>8&255]<<8|s[255&h])^n[f++],g=(s[c>>>24]<<24|s[d>>>16&255]<<16|s[h>>>8&255]<<8|s[255&u])^n[f++],v=(s[d>>>24]<<24|s[h>>>16&255]<<16|s[u>>>8&255]<<8|s[255&c])^n[f++],y=(s[h>>>24]<<24|s[u>>>16&255]<<16|s[c>>>8&255]<<8|s[255&d])^n[f++];e[t]=m,e[t+1]=g,e[t+2]=v,e[t+3]=y},keySize:8});e.AES=t._createHelper(r)}(),function(){var e=je,t=e.lib,n=t.WordArray,r=t.BlockCipher,i=e.algo,u=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],c=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],d=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],h=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],f=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],a=i.DES=r.extend({_doReset:function(){for(var e=this._key.words,t=[],n=0;n<56;n++){var r=u[n]-1;t[n]=e[r>>>5]>>>31-r%32&1}for(var i=this._subKeys=[],a=0;a<16;a++){var o=i[a]=[],s=d[a];for(n=0;n<24;n++)o[n/6|0]|=t[(c[n]-1+s)%28]<<31-n%6,o[4+(n/6|0)]|=t[28+(c[n+24]-1+s)%28]<<31-n%6;o[0]=o[0]<<1|o[0]>>>31;for(n=1;n<7;n++)o[n]=o[n]>>>4*(n-1)+3;o[7]=o[7]<<5|o[7]>>>27}var l=this._invSubKeys=[];for(n=0;n<16;n++)l[n]=i[15-n]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._subKeys)},decryptBlock:function(e,t){this._doCryptBlock(e,t,this._invSubKeys)},_doCryptBlock:function(e,t,n){this._lBlock=e[t],this._rBlock=e[t+1],p.call(this,4,252645135),p.call(this,16,65535),m.call(this,2,858993459),m.call(this,8,16711935),p.call(this,1,1431655765);for(var r=0;r<16;r++){for(var i=n[r],a=this._lBlock,o=this._rBlock,s=0,l=0;l<8;l++)s|=h[l][((o^i[l])&f[l])>>>0];this._lBlock=o,this._rBlock=a^s}var u=this._lBlock;this._lBlock=this._rBlock,this._rBlock=u,p.call(this,1,1431655765),m.call(this,8,16711935),m.call(this,2,858993459),p.call(this,16,65535),p.call(this,4,252645135),e[t]=this._lBlock,e[t+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});function p(e,t){var n=(this._lBlock>>>e^this._rBlock)&t;this._rBlock^=n,this._lBlock^=n<<e}function m(e,t){var n=(this._rBlock>>>e^this._lBlock)&t;this._lBlock^=n,this._rBlock^=n<<e}e.DES=r._createHelper(a);var o=i.TripleDES=r.extend({_doReset:function(){var e=this._key.words;this._des1=a.createEncryptor(n.create(e.slice(0,2))),this._des2=a.createEncryptor(n.create(e.slice(2,4))),this._des3=a.createEncryptor(n.create(e.slice(4,6)))},encryptBlock:function(e,t){this._des1.encryptBlock(e,t),this._des2.decryptBlock(e,t),this._des3.encryptBlock(e,t)},decryptBlock:function(e,t){this._des3.decryptBlock(e,t),this._des2.encryptBlock(e,t),this._des1.decryptBlock(e,t)},keySize:6,ivSize:2,blockSize:2});e.TripleDES=r._createHelper(o)}(),function(){var e=je,t=e.lib.StreamCipher,n=e.algo,r=n.RC4=t.extend({_doReset:function(){for(var e=this._key,t=e.words,n=e.sigBytes,r=this._S=[],i=0;i<256;i++)r[i]=i;i=0;for(var a=0;i<256;i++){var o=i%n,s=t[o>>>2]>>>24-o%4*8&255;a=(a+r[i]+s)%256;var l=r[i];r[i]=r[a],r[a]=l}this._i=this._j=0},_doProcessBlock:function(e,t){e[t]^=i.call(this)},keySize:8,ivSize:0});function i(){for(var e=this._S,t=this._i,n=this._j,r=0,i=0;i<4;i++){n=(n+e[t=(t+1)%256])%256;var a=e[t];e[t]=e[n],e[n]=a,r|=e[(e[t]+e[n])%256]<<24-8*i}return this._i=t,this._j=n,r}e.RC4=t._createHelper(r);var a=n.RC4Drop=r.extend({cfg:r.cfg.extend({drop:192}),_doReset:function(){r._doReset.call(this);for(var e=this.cfg.drop;0<e;e--)i.call(this)}});e.RC4Drop=t._createHelper(a)}(),je.mode.CTRGladman=(Ee=je.lib.BlockCipherMode.extend(),Te=Ee.Encryptor=Ee.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,i=this._iv,a=this._counter;i&&(a=this._counter=i.slice(0),this._iv=void 0),function(e){0===(e[0]=Ke(e[0]))&&(e[1]=Ke(e[1]))}(a);var o=a.slice(0);n.encryptBlock(o,0);for(var s=0;s<r;s++)e[t+s]^=o[s]}}),Ee.Decryptor=Te,Ee),we=(Ae=je).lib.StreamCipher,Se=Ae.algo,Ce=[],xe=[],Me=[],Re=Se.Rabbit=we.extend({_doReset:function(){for(var e=this._key.words,t=this.cfg.iv,n=0;n<4;n++)e[n]=16711935&(e[n]<<8|e[n]>>>24)|4278255360&(e[n]<<24|e[n]>>>8);var r=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],i=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];for(n=this._b=0;n<4;n++)Xe.call(this);for(n=0;n<8;n++)i[n]^=r[n+4&7];if(t){var a=t.words,o=a[0],s=a[1],l=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),u=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),c=l>>>16|4294901760&u,d=u<<16|65535&l;i[0]^=l,i[1]^=c,i[2]^=u,i[3]^=d,i[4]^=l,i[5]^=c,i[6]^=u,i[7]^=d;for(n=0;n<4;n++)Xe.call(this)}},_doProcessBlock:function(e,t){var n=this._X;Xe.call(this),Ce[0]=n[0]^n[5]>>>16^n[3]<<16,Ce[1]=n[2]^n[7]>>>16^n[5]<<16,Ce[2]=n[4]^n[1]>>>16^n[7]<<16,Ce[3]=n[6]^n[3]>>>16^n[1]<<16;for(var r=0;r<4;r++)Ce[r]=16711935&(Ce[r]<<8|Ce[r]>>>24)|4278255360&(Ce[r]<<24|Ce[r]>>>8),e[t+r]^=Ce[r]},blockSize:4,ivSize:2}),Ae.Rabbit=we._createHelper(Re),je.mode.CTR=(Ie=je.lib.BlockCipherMode.extend(),Pe=Ie.Encryptor=Ie.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,i=this._iv,a=this._counter;i&&(a=this._counter=i.slice(0),this._iv=void 0);var o=a.slice(0);n.encryptBlock(o,0),a[r-1]=a[r-1]+1|0;for(var s=0;s<r;s++)e[t+s]^=o[s]}}),Ie.Decryptor=Pe,Ie),Le=(De=je).lib.StreamCipher,Oe=De.algo,Ne=[],ke=[],Be=[],Fe=Oe.RabbitLegacy=Le.extend({_doReset:function(){for(var e=this._key.words,t=this.cfg.iv,n=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],r=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]],i=this._b=0;i<4;i++)Qe.call(this);for(i=0;i<8;i++)r[i]^=n[i+4&7];if(t){var a=t.words,o=a[0],s=a[1],l=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),u=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),c=l>>>16|4294901760&u,d=u<<16|65535&l;r[0]^=l,r[1]^=c,r[2]^=u,r[3]^=d,r[4]^=l,r[5]^=c,r[6]^=u,r[7]^=d;for(i=0;i<4;i++)Qe.call(this)}},_doProcessBlock:function(e,t){var n=this._X;Qe.call(this),Ne[0]=n[0]^n[5]>>>16^n[3]<<16,Ne[1]=n[2]^n[7]>>>16^n[5]<<16,Ne[2]=n[4]^n[1]>>>16^n[7]<<16,Ne[3]=n[6]^n[3]>>>16^n[1]<<16;for(var r=0;r<4;r++)Ne[r]=16711935&(Ne[r]<<8|Ne[r]>>>24)|4278255360&(Ne[r]<<24|Ne[r]>>>8),e[t+r]^=Ne[r]},blockSize:4,ivSize:2}),De.RabbitLegacy=Le._createHelper(Fe),je.pad.ZeroPadding={pad:function(e,t){var n=4*t;e.clamp(),e.sigBytes+=n-(e.sigBytes%n||n)},unpad:function(e){for(var t=e.words,n=e.sigBytes-1;!(t[n>>>2]>>>24-n%4*8&255);)n--;e.sigBytes=n+1}},je}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("global/window"),require("global/document")):"function"==typeof define&&define.amd?define(["global/window","global/document"],t):(e=e||self).videojs=t(e.window,e.document)}(this,function(y,d){y=y&&y.hasOwnProperty("default")?y.default:y,d=d&&d.hasOwnProperty("default")?d.default:d;var l=[],e=function(o,s){return function(e,t,n){var r=s.levels[t],i=new RegExp("^("+r+")$");if("log"!==e&&n.unshift(e.toUpperCase()+":"),n.unshift(o+":"),l&&l.push([].concat(n)),y.console){var a=y.console[e];a||"debug"!==e||(a=y.console.info||y.console.log),a&&r&&i.test(e)&&a[Array.isArray(n)?"apply":"call"](y.console,n)}}};var h=function t(n){function r(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];i("log",a,t)}var i,a="info";return i=e(n,r),r.createLogger=function(e){return t(n+": "+e)},r.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:a},r.level=function(e){if("string"==typeof e){if(!r.levels.hasOwnProperty(e))throw new Error('"'+e+'" in not a valid log level');a=e}return a},(r.history=function(){return l?[].concat(l):[]}).filter=function(t){return(l||[]).filter(function(e){return new RegExp(".*"+t+".*").test(e[0])})},r.history.clear=function(){l&&(l.length=0)},r.history.disable=function(){null!==l&&(l.length=0,l=null)},r.history.enable=function(){null===l&&(l=[])},r.error=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i("error",a,t)},r.warn=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i("warn",a,t)},r.debug=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i("debug",a,t)},r}("VIDEOJS"),f=h.createLogger,t=Object.prototype.toString,a=function(e){return o(e)?Object.keys(e):[]};function i(t,n){a(t).forEach(function(e){return n(t[e],e)})}function p(n){for(var e=arguments.length,t=new Array(1<e?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return Object.assign?Object.assign.apply(Object,[n].concat(t)):(t.forEach(function(e){e&&i(e,function(e,t){n[t]=e})}),n)}function o(e){return!!e&&"object"==typeof e}function s(e){return o(e)&&"[object Object]"===t.call(e)&&e.constructor===Object}function r(e,t){if(!e||!t)return"";if("function"!=typeof y.getComputedStyle)return"";var n=y.getComputedStyle(e);return n?n.getPropertyValue(t)||n[t]:""}function u(e){return"string"==typeof e&&/\S/.test(e)}function n(e){if(/\s/.test(e))throw new Error("class has illegal whitespace characters")}function c(){return d===y.document}function m(e){return o(e)&&1===e.nodeType}function g(){try{return y.parent!==y.self}catch(e){return!0}}function v(r){return function(e,t){if(!u(e))return d[r](null);u(t)&&(t=d.querySelector(t));var n=m(t)?t:d;return n[r]&&n[r](e)}}function _(e,n,t,r){void 0===e&&(e="div"),void 0===n&&(n={}),void 0===t&&(t={});var i=d.createElement(e);return Object.getOwnPropertyNames(n).forEach(function(e){var t=n[e];-1!==e.indexOf("aria-")||"role"===e||"type"===e?(h.warn("Setting attributes in the second argument of createEl()\nhas been deprecated. Use the third argument instead.\ncreateEl(type, properties, attributes). Attempting to set "+e+" to "+t+"."),i.setAttribute(e,t)):"textContent"===e?b(i,t):i[e]=t}),Object.getOwnPropertyNames(t).forEach(function(e){i.setAttribute(e,t[e])}),r&&j(i,r),i}function b(e,t){return void 0===e.textContent?e.innerText=t:e.textContent=t,e}function E(e,t){t.firstChild?t.insertBefore(e,t.firstChild):t.appendChild(e)}function T(e,t){return n(t),e.classList?e.classList.contains(t):function(e){return new RegExp("(^|\\s)"+e+"($|\\s)")}(t).test(e.className)}function A(e,t){return e.classList?e.classList.add(t):T(e,t)||(e.className=(e.className+" "+t).trim()),e}function w(e,t){return e.classList?e.classList.remove(t):(n(t),e.className=e.className.split(/\s+/).filter(function(e){return e!==t}).join(" ")),e}function S(e,t,n){var r=T(e,t);if("function"==typeof n&&(n=n(e,t)),"boolean"!=typeof n&&(n=!r),n!==r)return n?A(e,t):w(e,t),e}function C(n,r){Object.getOwnPropertyNames(r).forEach(function(e){var t=r[e];null==t||!1===t?n.removeAttribute(e):n.setAttribute(e,!0===t?"":t)})}function x(e){var t={},n=",autoplay,controls,playsinline,loop,muted,default,defaultMuted,";if(e&&e.attributes&&0<e.attributes.length)for(var r=e.attributes,i=r.length-1;0<=i;i--){var a=r[i].name,o=r[i].value;"boolean"!=typeof e[a]&&-1===n.indexOf(","+a+",")||(o=null!==o),t[a]=o}return t}function M(e,t){return e.getAttribute(t)}function R(e,t,n){e.setAttribute(t,n)}function I(e,t){e.removeAttribute(t)}function P(){d.body.focus(),d.onselectstart=function(){return!1}}function D(){d.onselectstart=function(){return!0}}function L(e){if(e&&e.getBoundingClientRect&&e.parentNode){var t=e.getBoundingClientRect(),n={};return["bottom","height","left","right","top","width"].forEach(function(e){void 0!==t[e]&&(n[e]=t[e])}),n.height||(n.height=parseFloat(r(e,"height"))),n.width||(n.width=parseFloat(r(e,"width"))),n}}function O(e){var t;if(e.getBoundingClientRect&&e.parentNode&&(t=e.getBoundingClientRect()),!t)return{left:0,top:0};var n=d.documentElement,r=d.body,i=n.clientLeft||r.clientLeft||0,a=y.pageXOffset||r.scrollLeft,o=t.left+a-i,s=n.clientTop||r.clientTop||0,l=y.pageYOffset||r.scrollTop,u=t.top+l-s;return{left:Math.round(o),top:Math.round(u)}}function N(e,t){var n={},r=O(e),i=e.offsetWidth,a=e.offsetHeight,o=r.top,s=r.left,l=t.pageY,u=t.pageX;return t.changedTouches&&(u=t.changedTouches[0].pageX,l=t.changedTouches[0].pageY),n.y=Math.max(0,Math.min(1,(o-l+a)/a)),n.x=Math.max(0,Math.min(1,(u-s)/i)),n}function k(e){return o(e)&&3===e.nodeType}function B(e){for(;e.firstChild;)e.removeChild(e.firstChild);return e}function F(e){return"function"==typeof e&&(e=e()),(Array.isArray(e)?e:[e]).map(function(e){return"function"==typeof e&&(e=e()),m(e)||k(e)?e:"string"==typeof e&&/\S/.test(e)?d.createTextNode(e):void 0}).filter(function(e){return e})}function j(t,e){return F(e).forEach(function(e){return t.appendChild(e)}),t}function U(e,t){return j(B(e),t)}function H(e){return void 0===e.button&&void 0===e.buttons||(0===e.button&&void 0===e.buttons||("mouseup"===e.type&&0===e.button&&0===e.buttons||0===e.button&&1===e.buttons))}var G,V=v("querySelector"),z=v("querySelectorAll"),W=Object.freeze({isReal:c,isEl:m,isInFrame:g,createEl:_,textContent:b,prependTo:E,hasClass:T,addClass:A,removeClass:w,toggleClass:S,setAttributes:C,getAttributes:x,getAttribute:M,setAttribute:R,removeAttribute:I,blockTextSelection:P,unblockTextSelection:D,getBoundingClientRect:L,findPosition:O,getPointerPosition:N,isTextNode:k,emptyEl:B,normalizeContent:F,appendContent:j,insertContent:U,isSingleLeftClick:H,$:V,$$:z}),q=!1,Y=function(){if(c()&&!1!==G.options.autoSetup){var e=Array.prototype.slice.call(d.getElementsByTagName("video")),t=Array.prototype.slice.call(d.getElementsByTagName("audio")),n=Array.prototype.slice.call(d.getElementsByTagName("video-js")),r=e.concat(t,n);if(r&&0<r.length)for(var i=0,a=r.length;i<a;i++){var o=r[i];if(!o||!o.getAttribute){K(1);break}void 0===o.player&&null!==o.getAttribute("data-setup")&&G(o)}else q||K(1)}};function K(e,t){t&&(G=t),y.setTimeout(Y,e)}function X(){q=!0,y.removeEventListener("load",X)}c()&&("complete"===d.readyState?X():y.addEventListener("load",X));function Q(e){var t=d.createElement("style");return t.className=e,t}function Z(e,t){e.styleSheet?e.styleSheet.cssText=t:e.textContent=t}var J,$=3;function ee(){return $++}y.WeakMap||(J=function(){function e(){this.vdata="vdata"+Math.floor(y.performance&&y.performance.now()||Date.now()),this.data={}}var t=e.prototype;return t.set=function(e,t){var n=e[this.vdata]||ee();return e[this.vdata]||(e[this.vdata]=n),this.data[n]=t,this},t.get=function(e){var t=e[this.vdata];if(t)return this.data[t];h("We have no data for this element",e)},t.has=function(e){return e[this.vdata]in this.data},t.delete=function(e){var t=e[this.vdata];t&&(delete this.data[t],delete e[this.vdata])},e}());var te=y.WeakMap?new WeakMap:new J;function ne(e,t){if(te.has(e)){var n=te.get(e);0===n.handlers[t].length&&(delete n.handlers[t],e.removeEventListener?e.removeEventListener(t,n.dispatcher,!1):e.detachEvent&&e.detachEvent("on"+t,n.dispatcher)),Object.getOwnPropertyNames(n.handlers).length<=0&&(delete n.handlers,delete n.dispatcher,delete n.disabled),0===Object.getOwnPropertyNames(n).length&&te.delete(e)}}function re(t,n,e,r){e.forEach(function(e){t(n,e,r)})}function ie(e){function t(){return!0}function n(){return!1}if(!e||!e.isPropagationStopped){var r=e||y.event;for(var i in e={},r)"layerX"!==i&&"layerY"!==i&&"keyLocation"!==i&&"webkitMovementX"!==i&&"webkitMovementY"!==i&&("returnValue"===i&&r.preventDefault||(e[i]=r[i]));if(e.target||(e.target=e.srcElement||d),e.relatedTarget||(e.relatedTarget=e.fromElement===e.target?e.toElement:e.fromElement),e.preventDefault=function(){r.preventDefault&&r.preventDefault(),e.returnValue=!1,r.returnValue=!1,e.defaultPrevented=!0},e.defaultPrevented=!1,e.stopPropagation=function(){r.stopPropagation&&r.stopPropagation(),e.cancelBubble=!0,r.cancelBubble=!0,e.isPropagationStopped=t},e.isPropagationStopped=n,e.stopImmediatePropagation=function(){r.stopImmediatePropagation&&r.stopImmediatePropagation(),e.isImmediatePropagationStopped=t,e.stopPropagation()},e.isImmediatePropagationStopped=n,null!==e.clientX&&void 0!==e.clientX){var a=d.documentElement,o=d.body;e.pageX=e.clientX+(a&&a.scrollLeft||o&&o.scrollLeft||0)-(a&&a.clientLeft||o&&o.clientLeft||0),e.pageY=e.clientY+(a&&a.scrollTop||o&&o.scrollTop||0)-(a&&a.clientTop||o&&o.clientTop||0)}e.which=e.charCode||e.keyCode,null!==e.button&&void 0!==e.button&&(e.button=1&e.button?0:4&e.button?1:2&e.button?2:0)}return e}var ae=!1;!function(){try{var e=Object.defineProperty({},"passive",{get:function(){ae=!0}});y.addEventListener("test",null,e),y.removeEventListener("test",null,e)}catch(e){}}();var oe=["touchstart","touchmove"];function se(o,e,t){if(Array.isArray(e))return re(se,o,e,t);te.has(o)||te.set(o,{});var s=te.get(o);if(s.handlers||(s.handlers={}),s.handlers[e]||(s.handlers[e]=[]),t.guid||(t.guid=ee()),s.handlers[e].push(t),s.dispatcher||(s.disabled=!1,s.dispatcher=function(e,t){if(!s.disabled){e=ie(e);var n=s.handlers[e.type];if(n)for(var r=n.slice(0),i=0,a=r.length;i<a&&!e.isImmediatePropagationStopped();i++)try{r[i].call(o,e,t)}catch(e){h.error(e)}}}),1===s.handlers[e].length)if(o.addEventListener){var n=!1;ae&&-1<oe.indexOf(e)&&(n={passive:!0}),o.addEventListener(e,s.dispatcher,n)}else o.attachEvent&&o.attachEvent("on"+e,s.dispatcher)}function le(e,t,n){if(te.has(e)){var r=te.get(e);if(r.handlers){if(Array.isArray(t))return re(le,e,t,n);function i(e,t){r.handlers[t]=[],ne(e,t)}if(void 0!==t){var a=r.handlers[t];if(a)if(n){if(n.guid)for(var o=0;o<a.length;o++)a[o].guid===n.guid&&a.splice(o--,1);ne(e,t)}else i(e,t)}else for(var s in r.handlers)Object.prototype.hasOwnProperty.call(r.handlers||{},s)&&i(e,s)}}}function ue(e,t,n){var r=te.has(e)?te.get(e):{},i=e.parentNode||e.ownerDocument;if("string"==typeof t?t={type:t,target:e}:t.target||(t.target=e),t=ie(t),r.dispatcher&&r.dispatcher.call(e,t,n),i&&!t.isPropagationStopped()&&!0===t.bubbles)ue.call(null,i,t,n);else if(!i&&!t.defaultPrevented&&t.target&&t.target[t.type]){te.has(t.target)||te.set(t.target,{});var a=te.get(t.target);t.target[t.type]&&(a.disabled=!0,"function"==typeof t.target[t.type]&&t.target[t.type](),a.disabled=!1)}return!t.defaultPrevented}function ce(e,t,n){if(Array.isArray(t))return re(ce,e,t,n);function r(){le(e,t,r),n.apply(this,arguments)}r.guid=n.guid=n.guid||ee(),se(e,t,r)}function de(e,t,n){function r(){le(e,t,r),n.apply(this,arguments)}r.guid=n.guid=n.guid||ee(),se(e,t,r)}function he(e,t,n){t.guid||(t.guid=ee());var r=t.bind(e);return r.guid=n?n+"_"+t.guid:t.guid,r}function fe(t,n){var r=y.performance.now();return function(){var e=y.performance.now();n<=e-r&&(t.apply(void 0,arguments),r=e)}}function pe(r,i,a,o){var s;function e(){var e=this,t=arguments,n=function(){n=s=null,a||r.apply(e,t)};!s&&a&&r.apply(e,t),o.clearTimeout(s),s=o.setTimeout(n,i)}return void 0===o&&(o=y),e.cancel=function(){o.clearTimeout(s),s=null},e}function me(){}var ge,ve=Object.freeze({fixEvent:ie,on:se,off:le,trigger:ue,one:ce,any:de});me.prototype.allowedEvents_={},me.prototype.addEventListener=me.prototype.on=function(e,t){var n=this.addEventListener;this.addEventListener=function(){},se(this,e,t),this.addEventListener=n},me.prototype.removeEventListener=me.prototype.off=function(e,t){le(this,e,t)},me.prototype.one=function(e,t){var n=this.addEventListener;this.addEventListener=function(){},ce(this,e,t),this.addEventListener=n},me.prototype.any=function(e,t){var n=this.addEventListener;this.addEventListener=function(){},de(this,e,t),this.addEventListener=n},me.prototype.dispatchEvent=me.prototype.trigger=function(e){var t=e.type||e;"string"==typeof e&&(e={type:t}),e=ie(e),this.allowedEvents_[t]&&this["on"+t]&&this["on"+t](e),ue(this,e)},me.prototype.queueTrigger=function(e){var t=this;ge=ge||new Map;var n=e.type||e,r=ge.get(this);r||(r=new Map,ge.set(this,r));var i=r.get(n);r.delete(n),y.clearTimeout(i);var a=y.setTimeout(function(){0===r.size&&(r=null,ge.delete(t)),t.trigger(e)},0);r.set(n,a)};function ye(e){return"string"==typeof e&&/\S/.test(e)||Array.isArray(e)&&!!e.length}function _e(e){if(!e.nodeName&&!we(e))throw new Error("Invalid target; must be a DOM node or evented object.")}function be(e){if(!ye(e))throw new Error("Invalid event type; must be a non-empty string or array.")}function Ee(e){if("function"!=typeof e)throw new Error("Invalid listener; must be a function.")}function Te(e,t){var n,r,i,a=t.length<3||t[0]===e||t[0]===e.eventBusEl_;return i=a?(n=e.eventBusEl_,3<=t.length&&t.shift(),r=t[0],t[1]):(n=t[0],r=t[1],t[2]),_e(n),be(r),Ee(i),{isTargetingSelf:a,target:n,type:r,listener:i=he(e,i)}}function Ae(e,t,n,r){_e(e),e.nodeName?ve[t](e,n,r):e[t](n,r)}var we=function(t){return t instanceof me||!!t.eventBusEl_&&["on","one","off","trigger"].every(function(e){return"function"==typeof t[e]})},Se={on:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=Te(this,n),a=i.isTargetingSelf,o=i.target,s=i.type,l=i.listener;if(Ae(o,"on",s,l),!a){function u(){return e.off(o,s,l)}u.guid=l.guid;function c(){return e.off("dispose",u)}c.guid=l.guid,Ae(this,"on","dispose",u),Ae(o,"on","dispose",c)}},one:function(){for(var r=this,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=Te(this,t),a=i.isTargetingSelf,o=i.target,s=i.type,l=i.listener;if(a)Ae(o,"one",s,l);else{function u(){r.off(o,s,u);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];l.apply(null,t)}u.guid=l.guid,Ae(o,"one",s,u)}},any:function(){for(var r=this,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=Te(this,t),a=i.isTargetingSelf,o=i.target,s=i.type,l=i.listener;if(a)Ae(o,"any",s,l);else{function u(){r.off(o,s,u);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];l.apply(null,t)}u.guid=l.guid,Ae(o,"any",s,u)}},off:function(e,t,n){if(!e||ye(e))le(this.eventBusEl_,e,t);else{var r=e,i=t;_e(r),be(i),Ee(n),n=he(this,n),this.off("dispose",n),r.nodeName?(le(r,i,n),le(r,"dispose",n)):we(r)&&(r.off(i,n),r.off("dispose",n))}},trigger:function(e,t){return ue(this.eventBusEl_,e,t)}};function Ce(e,t){void 0===t&&(t={});var n=t.eventBusKey;if(n){if(!e[n].nodeName)throw new Error('The eventBusKey "'+n+'" does not refer to an element.');e.eventBusEl_=e[n]}else e.eventBusEl_=_("span",{className:"vjs-event-bus"});return p(e,Se),e.eventedCallbacks&&e.eventedCallbacks.forEach(function(e){e()}),e.on("dispose",function(){e.off(),y.setTimeout(function(){e.eventBusEl_=null},0)}),e}var xe={state:{},setState:function(e){var n,r=this;return"function"==typeof e&&(e=e()),i(e,function(e,t){r.state[t]!==e&&((n=n||{})[t]={from:r.state[t],to:e}),r.state[t]=e}),n&&we(this)&&this.trigger({changes:n,type:"statechanged"}),n}};function Me(e,t){return p(e,xe),e.state=p({},e.state,t),"function"==typeof e.handleStateChanged&&we(e)&&e.on("statechanged",e.handleStateChanged),e}function Re(e){return"string"!=typeof e?e:e.replace(/./,function(e){return e.toLowerCase()})}function Ie(e){return"string"!=typeof e?e:e.replace(/./,function(e){return e.toUpperCase()})}function Pe(){for(var n={},e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.forEach(function(e){e&&i(e,function(e,t){s(e)?(s(n[t])||(n[t]={}),n[t]=Pe(n[t],e)):n[t]=e})}),n}var De=function(){function u(e,t,n){if(!e&&this.play?this.player_=e=this:this.player_=e,this.parentComponent_=null,this.options_=Pe({},this.options_),t=this.options_=Pe(this.options_,t),this.id_=t.id||t.el&&t.el.id,!this.id_){var r=e&&e.id&&e.id()||"no_player";this.id_=r+"_component_"+ee()}var i;this.name_=t.name||null,t.el?this.el_=t.el:!1!==t.createEl&&(this.el_=this.createEl()),!1!==t.evented&&Ce(this,{eventBusKey:this.el_?"el_":null}),Me(this,this.constructor.defaultState),this.children_=[],this.childIndex_={},this.childNameIndex_={},y.Set||(i=function(){function e(){this.set_={}}var t=e.prototype;return t.has=function(e){return e in this.set_},t.delete=function(e){var t=this.has(e);return delete this.set_[e],t},t.add=function(e){return this.set_[e]=1,this},t.forEach=function(e,t){for(var n in this.set_)e.call(t,n,n,this)},e}()),this.setTimeoutIds_=y.Set?new Set:new i,this.setIntervalIds_=y.Set?new Set:new i,this.rafIds_=y.Set?new Set:new i,(this.clearingTimersOnDispose_=!1)!==t.initChildren&&this.initChildren(),this.ready(n),!1!==t.reportTouchActivity&&this.enableTouchActivity()}var e=u.prototype;return e.dispose=function(){if(this.trigger({type:"dispose",bubbles:!1}),this.children_)for(var e=this.children_.length-1;0<=e;e--)this.children_[e].dispose&&this.children_[e].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.parentComponent_=null,this.el_&&(this.el_.parentNode&&this.el_.parentNode.removeChild(this.el_),te.has(this.el_)&&te.delete(this.el_),this.el_=null),this.player_=null},e.player=function(){return this.player_},e.options=function(e){return e&&(this.options_=Pe(this.options_,e)),this.options_},e.el=function(){return this.el_},e.createEl=function(e,t,n){return _(e,t,n)},e.localize=function(e,i,t){void 0===t&&(t=e);var n=this.player_.language&&this.player_.language(),r=this.player_.languages&&this.player_.languages(),a=r&&r[n],o=n&&n.split("-")[0],s=r&&r[o],l=t;return a&&a[e]?l=a[e]:s&&s[e]&&(l=s[e]),i&&(l=l.replace(/\{(\d+)\}/g,function(e,t){var n=i[t-1],r=n;return void 0===n&&(r=e),r})),l},e.contentEl=function(){return this.contentEl_||this.el_},e.id=function(){return this.id_},e.name=function(){return this.name_},e.children=function(){return this.children_},e.getChildById=function(e){return this.childIndex_[e]},e.getChild=function(e){if(e)return this.childNameIndex_[e]},e.addChild=function(e,t,n){var r,i;if(void 0===t&&(t={}),void 0===n&&(n=this.children_.length),"string"==typeof e){i=Ie(e);var a=t.componentClass||i;t.name=i;var o=u.getComponent(a);if(!o)throw new Error("Component "+a+" does not exist");if("function"!=typeof o)return null;r=new o(this.player_||this,t)}else r=e;if(r.parentComponent_&&r.parentComponent_.removeChild(r),this.children_.splice(n,0,r),r.parentComponent_=this,"function"==typeof r.id&&(this.childIndex_[r.id()]=r),(i=i||r.name&&Ie(r.name()))&&(this.childNameIndex_[i]=r,this.childNameIndex_[Re(i)]=r),"function"==typeof r.el&&r.el()){var s=this.contentEl().children[n]||null;this.contentEl().insertBefore(r.el(),s)}return r},e.removeChild=function(e){if("string"==typeof e&&(e=this.getChild(e)),e&&this.children_){for(var t=!1,n=this.children_.length-1;0<=n;n--)if(this.children_[n]===e){t=!0,this.children_.splice(n,1);break}if(t){e.parentComponent_=null,this.childIndex_[e.id()]=null,this.childNameIndex_[Ie(e.name())]=null,this.childNameIndex_[Re(e.name())]=null;var r=e.el();r&&r.parentNode===this.contentEl()&&this.contentEl().removeChild(e.el())}}},e.initChildren=function(){var i=this,r=this.options_.children;if(r){var e,a=this.options_,n=u.getComponent("Tech");(e=Array.isArray(r)?r:Object.keys(r)).concat(Object.keys(this.options_).filter(function(t){return!e.some(function(e){return"string"==typeof e?t===e:t===e.name})})).map(function(e){var t,n;return n="string"==typeof e?r[t=e]||i.options_[t]||{}:(t=e.name,e),{name:t,opts:n}}).filter(function(e){var t=u.getComponent(e.opts.componentClass||Ie(e.name));return t&&!n.isTech(t)}).forEach(function(e){var t=e.name,n=e.opts;if(void 0!==a[t]&&(n=a[t]),!1!==n){!0===n&&(n={}),n.playerOptions=i.options_.playerOptions;var r=i.addChild(t,n);r&&(i[t]=r)}})}},e.buildCSSClass=function(){return""},e.ready=function(e,t){if(void 0===t&&(t=!1),e)return this.isReady_?void(t?e.call(this):this.setTimeout(e,1)):(this.readyQueue_=this.readyQueue_||[],void this.readyQueue_.push(e))},e.triggerReady=function(){this.isReady_=!0,this.setTimeout(function(){var e=this.readyQueue_;this.readyQueue_=[],e&&0<e.length&&e.forEach(function(e){e.call(this)},this),this.trigger("ready")},1)},e.$=function(e,t){return V(e,t||this.contentEl())},e.$$=function(e,t){return z(e,t||this.contentEl())},e.hasClass=function(e){return T(this.el_,e)},e.addClass=function(e){A(this.el_,e)},e.removeClass=function(e){w(this.el_,e)},e.toggleClass=function(e,t){S(this.el_,e,t)},e.show=function(){this.removeClass("vjs-hidden")},e.hide=function(){this.addClass("vjs-hidden")},e.lockShowing=function(){this.addClass("vjs-lock-showing")},e.unlockShowing=function(){this.removeClass("vjs-lock-showing")},e.getAttribute=function(e){return M(this.el_,e)},e.setAttribute=function(e,t){R(this.el_,e,t)},e.removeAttribute=function(e){I(this.el_,e)},e.width=function(e,t){return this.dimension("width",e,t)},e.height=function(e,t){return this.dimension("height",e,t)},e.dimensions=function(e,t){this.width(e,!0),this.height(t)},e.dimension=function(e,t,n){if(void 0!==t)return null!==t&&t==t||(t=0),-1!==(""+t).indexOf("%")||-1!==(""+t).indexOf("px")?this.el_.style[e]=t:this.el_.style[e]="auto"===t?"":t+"px",void(n||this.trigger("componentresize"));if(!this.el_)return 0;var r=this.el_.style[e],i=r.indexOf("px");return-1!==i?parseInt(r.slice(0,i),10):parseInt(this.el_["offset"+Ie(e)],10)},e.currentDimension=function(e){var t=0;if("width"!==e&&"height"!==e)throw new Error("currentDimension only accepts width or height value");if(t=r(this.el_,e),0===(t=parseFloat(t))||isNaN(t)){var n="offset"+Ie(e);t=this.el_[n]}return t},e.currentDimensions=function(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}},e.currentWidth=function(){return this.currentDimension("width")},e.currentHeight=function(){return this.currentDimension("height")},e.focus=function(){this.el_.focus()},e.blur=function(){this.el_.blur()},e.handleKeyDown=function(e){this.player_&&(e.stopPropagation(),this.player_.handleKeyDown(e))},e.handleKeyPress=function(e){this.handleKeyDown(e)},e.emitTapEvents=function(){var r,t=0,i=null;this.on("touchstart",function(e){1===e.touches.length&&(i={pageX:e.touches[0].pageX,pageY:e.touches[0].pageY},t=y.performance.now(),r=!0)}),this.on("touchmove",function(e){if(1<e.touches.length)r=!1;else if(i){var t=e.touches[0].pageX-i.pageX,n=e.touches[0].pageY-i.pageY;10<Math.sqrt(t*t+n*n)&&(r=!1)}});function e(){r=!1}this.on("touchleave",e),this.on("touchcancel",e),this.on("touchend",function(e){!(i=null)===r&&y.performance.now()-t<200&&(e.preventDefault(),this.trigger("tap"))})},e.enableTouchActivity=function(){if(this.player()&&this.player().reportUserActivity){var e,t=he(this.player(),this.player().reportUserActivity);this.on("touchstart",function(){t(),this.clearInterval(e),e=this.setInterval(t,250)});function n(){t(),this.clearInterval(e)}this.on("touchmove",t),this.on("touchend",n),this.on("touchcancel",n)}},e.setTimeout=function(e,t){var n,r=this;return e=he(this,e),this.clearTimersOnDispose_(),n=y.setTimeout(function(){r.setTimeoutIds_.has(n)&&r.setTimeoutIds_.delete(n),e()},t),this.setTimeoutIds_.add(n),n},e.clearTimeout=function(e){return this.setTimeoutIds_.has(e)&&(this.setTimeoutIds_.delete(e),y.clearTimeout(e)),e},e.setInterval=function(e,t){e=he(this,e),this.clearTimersOnDispose_();var n=y.setInterval(e,t);return this.setIntervalIds_.add(n),n},e.clearInterval=function(e){return this.setIntervalIds_.has(e)&&(this.setIntervalIds_.delete(e),y.clearInterval(e)),e},e.requestAnimationFrame=function(e){var t,n=this;return this.supportsRaf_?(this.clearTimersOnDispose_(),e=he(this,e),t=y.requestAnimationFrame(function(){n.rafIds_.has(t)&&n.rafIds_.delete(t),e()}),this.rafIds_.add(t),t):this.setTimeout(e,1e3/60)},e.cancelAnimationFrame=function(e){return this.supportsRaf_?(this.rafIds_.has(e)&&(this.rafIds_.delete(e),y.cancelAnimationFrame(e)),e):this.clearTimeout(e)},e.clearTimersOnDispose_=function(){var r=this;this.clearingTimersOnDispose_||(this.clearingTimersOnDispose_=!0,this.one("dispose",function(){[["rafIds_","cancelAnimationFrame"],["setTimeoutIds_","clearTimeout"],["setIntervalIds_","clearInterval"]].forEach(function(e){var t=e[0],n=e[1];r[t].forEach(r[n],r)}),r.clearingTimersOnDispose_=!1}))},u.registerComponent=function(e,t){if("string"!=typeof e||!e)throw new Error('Illegal component name, "'+e+'"; must be a non-empty string.');var n,r=u.getComponent("Tech"),i=r&&r.isTech(t),a=u===t||u.prototype.isPrototypeOf(t.prototype);if(i||!a)throw n=i?"techs must be registered using Tech.registerTech()":"must be a Component subclass",new Error('Illegal component, "'+e+'"; '+n+".");e=Ie(e),u.components_||(u.components_={});var o=u.getComponent("Player");if("Player"===e&&o&&o.players){var s=o.players,l=Object.keys(s);if(s&&0<l.length&&l.map(function(e){return s[e]}).every(Boolean))throw new Error("Can not register Player component after player has been created.")}return u.components_[e]=t,u.components_[Re(e)]=t},u.getComponent=function(e){if(e&&u.components_)return u.components_[e]},u}();function Le(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}function Oe(e,t){return(Oe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ne(e,t,n){return(Ne=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&Oe(i,n.prototype),i}).apply(null,arguments)}function ke(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}De.prototype.supportsRaf_="function"==typeof y.requestAnimationFrame&&"function"==typeof y.cancelAnimationFrame,De.registerComponent("Component",De);var Be,Fe,je,Ue,He=y.navigator&&y.navigator.userAgent||"",Ge=/AppleWebKit\/([\d.]+)/i.exec(He),Ve=Ge?parseFloat(Ge.pop()):null,ze=/iPad/i.test(He),We=/iPhone/i.test(He)&&!ze,qe=/iPod/i.test(He),Ye=We||ze||qe,Ke=(Be=He.match(/OS (\d+)_/i))&&Be[1]?Be[1]:null,Xe=/Android/i.test(He),Qe=function(){var e=He.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!e)return null;var t=e[1]&&parseFloat(e[1]),n=e[2]&&parseFloat(e[2]);return t&&n?parseFloat(e[1]+"."+e[2]):t||null}(),Ze=Xe&&Qe<5&&Ve<537,Je=/Firefox/i.test(He),$e=/Edge/i.test(He),et=!$e&&(/Chrome/i.test(He)||/CriOS/i.test(He)),tt=(Fe=He.match(/(Chrome|CriOS)\/(\d+)/))&&Fe[2]?parseFloat(Fe[2]):null,nt=(je=/MSIE\s(\d+)\.\d/.exec(He),!(Ue=je&&parseFloat(je[1]))&&/Trident\/7.0/i.test(He)&&/rv:11.0/.test(He)&&(Ue=11),Ue),rt=/Safari/i.test(He)&&!et&&!Xe&&!$e,it=(rt||Ye)&&!et,at=/Windows/i.test(He),ot=c()&&("ontouchstart"in y||y.navigator.maxTouchPoints||y.DocumentTouch&&y.document instanceof y.DocumentTouch),st=Object.freeze({IS_IPAD:ze,IS_IPHONE:We,IS_IPOD:qe,IS_IOS:Ye,IOS_VERSION:Ke,IS_ANDROID:Xe,ANDROID_VERSION:Qe,IS_NATIVE_ANDROID:Ze,IS_FIREFOX:Je,IS_EDGE:$e,IS_CHROME:et,CHROME_VERSION:tt,IE_VERSION:nt,IS_SAFARI:rt,IS_ANY_SAFARI:it,IS_WINDOWS:at,TOUCH_ENABLED:ot});function lt(e,t,n,r){return function(e,t,n){if("number"!=typeof t||t<0||n<t)throw new Error("Failed to execute '"+e+"' on 'TimeRanges': The index provided ("+t+") is non-numeric or out of bounds (0-"+n+").")}(e,r,n.length-1),n[r][t]}function ut(e){return void 0===e||0===e.length?{length:0,start:function(){throw new Error("This TimeRanges object is empty")},end:function(){throw new Error("This TimeRanges object is empty")}}:{length:e.length,start:lt.bind(null,"start",0,e),end:lt.bind(null,"end",1,e)}}function ct(e,t){return Array.isArray(e)?ut(e):void 0===e||void 0===t?ut():ut([[e,t]])}function dt(e,t){var n,r,i=0;if(!t)return 0;e&&e.length||(e=ct(0,0));for(var a=0;a<e.length;a++)n=e.start(a),t<(r=e.end(a))&&(r=t),i+=r-n;return i/t}for(var ht,ft={prefixed:!0},pt=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror","fullscreen"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror","-moz-full-screen"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError","-ms-fullscreen"]],mt=pt[0],gt=0;gt<pt.length;gt++)if(pt[gt][1]in d){ht=pt[gt];break}if(ht){for(var vt=0;vt<ht.length;vt++)ft[mt[vt]]=ht[vt];ft.prefixed=ht[0]!==mt[0]}function yt(e){if(e instanceof yt)return e;"number"==typeof e?this.code=e:"string"==typeof e?this.message=e:o(e)&&("number"==typeof e.code&&(this.code=e.code),p(this,e)),this.message||(this.message=yt.defaultMessages[this.code]||"")}yt.prototype.code=0,yt.prototype.message="",yt.prototype.status=null,yt.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"],yt.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(var _t=0;_t<yt.errorTypes.length;_t++)yt[yt.errorTypes[_t]]=_t,yt.prototype[yt.errorTypes[_t]]=_t;var bt=function(e,t){var n,r=null;try{n=JSON.parse(e,t)}catch(e){r=e}return[r,n]};function Et(e){return null!=e&&"function"==typeof e.then}function Tt(e){Et(e)&&e.then(null,function(e){})}function At(r){return["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce(function(e,t,n){return r[t]&&(e[t]=r[t]),e},{cues:r.cues&&Array.prototype.map.call(r.cues,function(e){return{startTime:e.startTime,endTime:e.endTime,text:e.text,id:e.id}})})}var wt=function(e){var t=e.$$("track"),n=Array.prototype.map.call(t,function(e){return e.track});return Array.prototype.map.call(t,function(e){var t=At(e.track);return e.src&&(t.src=e.src),t}).concat(Array.prototype.filter.call(e.textTracks(),function(e){return-1===n.indexOf(e)}).map(At))},St=function(e,n){return e.forEach(function(e){var t=n.addRemoteTextTrack(e).track;!e.src&&e.cues&&e.cues.forEach(function(e){return t.addCue(e)})}),n.textTracks()};function Ct(e,t){return e(t={exports:{}},t.exports),t.exports}var xt=Ct(function(e,t){function n(e){if(e&&"object"==typeof e){var t=e.which||e.keyCode||e.charCode;t&&(e=t)}if("number"==typeof e)return o[e];var n,r=String(e);return(n=i[r.toLowerCase()])?n:(n=a[r.toLowerCase()])||(1===r.length?r.charCodeAt(0):void 0)}n.isEventKey=function(e,t){if(e&&"object"==typeof e){var n=e.which||e.keyCode||e.charCode;if(null==n)return!1;if("string"==typeof t){var r;if(r=i[t.toLowerCase()])return r===n;if(r=a[t.toLowerCase()])return r===n}else if("number"==typeof t)return t===n;return!1}};var i=(t=e.exports=n).code=t.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,command:91,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},a=t.aliases={windows:91,"⇧":16,"⌥":18,"⌃":17,"⌘":91,ctl:17,control:17,option:18,pause:19,break:19,caps:20,return:13,escape:27,spc:32,spacebar:32,pgup:33,pgdn:34,ins:45,del:46,cmd:91};for(r=97;r<123;r++)i[String.fromCharCode(r)]=r-32;for(var r=48;r<58;r++)i[r-48]=r;for(r=1;r<13;r++)i["f"+r]=r+111;for(r=0;r<10;r++)i["numpad "+r]=r+96;var o=t.names=t.title={};for(r in i)o[i[r]]=r;for(var s in a)i[s]=a[s]}),Mt=(xt.code,xt.codes,xt.aliases,xt.names,xt.title,"vjs-modal-dialog"),Rt=function(r){function e(e,t){var n;return(n=r.call(this,e,t)||this).opened_=n.hasBeenOpened_=n.hasBeenFilled_=!1,n.closeable(!n.options_.uncloseable),n.content(n.options_.content),n.contentEl_=_("div",{className:Mt+"-content"},{role:"document"}),n.descEl_=_("p",{className:Mt+"-description vjs-control-text",id:n.el().getAttribute("aria-describedby")}),b(n.descEl_,n.description()),n.el_.appendChild(n.descEl_),n.el_.appendChild(n.contentEl_),n}Le(e,r);var t=e.prototype;return t.createEl=function(){return r.prototype.createEl.call(this,"div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":this.id()+"_description","aria-hidden":"true","aria-label":this.label(),role:"dialog"})},t.dispose=function(){this.contentEl_=null,this.descEl_=null,this.previouslyActiveEl_=null,r.prototype.dispose.call(this)},t.buildCSSClass=function(){return Mt+" vjs-hidden "+r.prototype.buildCSSClass.call(this)},t.label=function(){return this.localize(this.options_.label||"Modal Window")},t.description=function(){var e=this.options_.description||this.localize("This is a modal window.");return this.closeable()&&(e+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")),e},t.open=function(){if(!this.opened_){var e=this.player();this.trigger("beforemodalopen"),this.opened_=!0,!this.options_.fillAlways&&(this.hasBeenOpened_||this.hasBeenFilled_)||this.fill(),this.wasPlaying_=!e.paused(),this.options_.pauseOnOpen&&this.wasPlaying_&&e.pause(),this.on("keydown",this.handleKeyDown),this.hadControls_=e.controls(),e.controls(!1),this.show(),this.conditionalFocus_(),this.el().setAttribute("aria-hidden","false"),this.trigger("modalopen"),this.hasBeenOpened_=!0}},t.opened=function(e){return"boolean"==typeof e&&this[e?"open":"close"](),this.opened_},t.close=function(){if(this.opened_){var e=this.player();this.trigger("beforemodalclose"),this.opened_=!1,this.wasPlaying_&&this.options_.pauseOnOpen&&e.play(),this.off("keydown",this.handleKeyDown),this.hadControls_&&e.controls(!0),this.hide(),this.el().setAttribute("aria-hidden","true"),this.trigger("modalclose"),this.conditionalBlur_(),this.options_.temporary&&this.dispose()}},t.closeable=function(e){if("boolean"==typeof e){var t=this.closeable_=!!e,n=this.getChild("closeButton");if(t&&!n){var r=this.contentEl_;this.contentEl_=this.el_,n=this.addChild("closeButton",{controlText:"Close Modal Dialog"}),this.contentEl_=r,this.on(n,"close",this.close)}!t&&n&&(this.off(n,"close",this.close),this.removeChild(n),n.dispose())}return this.closeable_},t.fill=function(){this.fillWith(this.content())},t.fillWith=function(e){var t=this.contentEl(),n=t.parentNode,r=t.nextSibling;this.trigger("beforemodalfill"),this.hasBeenFilled_=!0,n.removeChild(t),this.empty(),U(t,e),this.trigger("modalfill"),r?n.insertBefore(t,r):n.appendChild(t);var i=this.getChild("closeButton");i&&n.appendChild(i.el_)},t.empty=function(){this.trigger("beforemodalempty"),B(this.contentEl()),this.trigger("modalempty")},t.content=function(e){return void 0!==e&&(this.content_=e),this.content_},t.conditionalFocus_=function(){var e=d.activeElement,t=this.player_.el_;this.previouslyActiveEl_=null,!t.contains(e)&&t!==e||(this.previouslyActiveEl_=e,this.focus())},t.conditionalBlur_=function(){this.previouslyActiveEl_&&(this.previouslyActiveEl_.focus(),this.previouslyActiveEl_=null)},t.handleKeyDown=function(e){if(e.stopPropagation(),xt.isEventKey(e,"Escape")&&this.closeable())return e.preventDefault(),void this.close();if(xt.isEventKey(e,"Tab")){for(var t,n=this.focusableEls_(),r=this.el_.querySelector(":focus"),i=0;i<n.length;i++)if(r===n[i]){t=i;break}d.activeElement===this.el_&&(t=0),e.shiftKey&&0===t?(n[n.length-1].focus(),e.preventDefault()):e.shiftKey||t!==n.length-1||(n[0].focus(),e.preventDefault())}},t.focusableEls_=function(){var e=this.el_.querySelectorAll("*");return Array.prototype.filter.call(e,function(e){return(e instanceof y.HTMLAnchorElement||e instanceof y.HTMLAreaElement)&&e.hasAttribute("href")||(e instanceof y.HTMLInputElement||e instanceof y.HTMLSelectElement||e instanceof y.HTMLTextAreaElement||e instanceof y.HTMLButtonElement)&&!e.hasAttribute("disabled")||e instanceof y.HTMLIFrameElement||e instanceof y.HTMLObjectElement||e instanceof y.HTMLEmbedElement||e.hasAttribute("tabindex")&&-1!==e.getAttribute("tabindex")||e.hasAttribute("contenteditable")})},e}(De);Rt.prototype.options_={pauseOnOpen:!0,temporary:!0},De.registerComponent("ModalDialog",Rt);var It=function(r){function e(e){var t;void 0===e&&(e=[]),(t=r.call(this)||this).tracks_=[],Object.defineProperty(ke(t),"length",{get:function(){return this.tracks_.length}});for(var n=0;n<e.length;n++)t.addTrack(e[n]);return t}Le(e,r);var t=e.prototype;return t.addTrack=function(e){var t=this.tracks_.length;""+t in this||Object.defineProperty(this,t,{get:function(){return this.tracks_[t]}}),-1===this.tracks_.indexOf(e)&&(this.tracks_.push(e),this.trigger({track:e,type:"addtrack",target:this}))},t.removeTrack=function(e){for(var t,n=0,r=this.length;n<r;n++)if(this[n]===e){(t=this[n]).off&&t.off(),this.tracks_.splice(n,1);break}t&&this.trigger({track:t,type:"removetrack",target:this})},t.getTrackById=function(e){for(var t=null,n=0,r=this.length;n<r;n++){var i=this[n];if(i.id===e){t=i;break}}return t},e}(me);for(var Pt in It.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack"},It.prototype.allowedEvents_)It.prototype["on"+Pt]=null;function Dt(e,t){for(var n=0;n<e.length;n++)Object.keys(e[n]).length&&t.id!==e[n].id&&(e[n].enabled=!1)}function Lt(e,t){for(var n=0;n<e.length;n++)Object.keys(e[n]).length&&t.id!==e[n].id&&(e[n].selected=!1)}function Ot(e){var t=["protocol","hostname","port","pathname","search","hash","host"],n=d.createElement("a");n.href=e;var r,i=""===n.host&&"file:"!==n.protocol;i&&((r=d.createElement("div")).innerHTML='<a href="'+e+'"></a>',n=r.firstChild,r.setAttribute("style","display:none; position:absolute;"),d.body.appendChild(r));for(var a={},o=0;o<t.length;o++)a[t[o]]=n[t[o]];return"http:"===a.protocol&&(a.host=a.host.replace(/:80$/,"")),"https:"===a.protocol&&(a.host=a.host.replace(/:443$/,"")),a.protocol||(a.protocol=y.location.protocol),i&&d.body.removeChild(r),a}function Nt(e){if(!e.match(/^https?:\/\//)){var t=d.createElement("div");t.innerHTML='<a href="'+e+'">x</a>',e=t.firstChild.href}return e}function kt(e){if("string"==typeof e){var t=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/.exec(e);if(t)return t.pop().toLowerCase()}return""}function Bt(e){var t=y.location,n=Ot(e);return(":"===n.protocol?t.protocol:n.protocol)+n.host!==t.protocol+t.host}var Ft=function(r){function e(e){var t;void 0===e&&(e=[]);for(var n=e.length-1;0<=n;n--)if(e[n].enabled){Dt(e,e[n]);break}return(t=r.call(this,e)||this).changing_=!1,t}Le(e,r);var t=e.prototype;return t.addTrack=function(e){var t=this;e.enabled&&Dt(this,e),r.prototype.addTrack.call(this,e),e.addEventListener&&(e.enabledChange_=function(){t.changing_||(t.changing_=!0,Dt(t,e),t.changing_=!1,t.trigger("change"))},e.addEventListener("enabledchange",e.enabledChange_))},t.removeTrack=function(e){r.prototype.removeTrack.call(this,e),e.removeEventListener&&e.enabledChange_&&(e.removeEventListener("enabledchange",e.enabledChange_),e.enabledChange_=null)},e}(It),jt=function(r){function e(e){var t;void 0===e&&(e=[]);for(var n=e.length-1;0<=n;n--)if(e[n].selected){Lt(e,e[n]);break}return(t=r.call(this,e)||this).changing_=!1,Object.defineProperty(ke(t),"selectedIndex",{get:function(){for(var e=0;e<this.length;e++)if(this[e].selected)return e;return-1},set:function(){}}),t}Le(e,r);var t=e.prototype;return t.addTrack=function(e){var t=this;e.selected&&Lt(this,e),r.prototype.addTrack.call(this,e),e.addEventListener&&(e.selectedChange_=function(){t.changing_||(t.changing_=!0,Lt(t,e),t.changing_=!1,t.trigger("change"))},e.addEventListener("selectedchange",e.selectedChange_))},t.removeTrack=function(e){r.prototype.removeTrack.call(this,e),e.removeEventListener&&e.selectedChange_&&(e.removeEventListener("selectedchange",e.selectedChange_),e.selectedChange_=null)},e}(It),Ut=function(n){function e(){return n.apply(this,arguments)||this}Le(e,n);var t=e.prototype;return t.addTrack=function(e){var t=this;n.prototype.addTrack.call(this,e),this.queueChange_||(this.queueChange_=function(){return t.queueTrigger("change")}),this.triggerSelectedlanguagechange||(this.triggerSelectedlanguagechange_=function(){return t.trigger("selectedlanguagechange")}),e.addEventListener("modechange",this.queueChange_);-1===["metadata","chapters"].indexOf(e.kind)&&e.addEventListener("modechange",this.triggerSelectedlanguagechange_)},t.removeTrack=function(e){n.prototype.removeTrack.call(this,e),e.removeEventListener&&(this.queueChange_&&e.removeEventListener("modechange",this.queueChange_),this.selectedlanguagechange_&&e.removeEventListener("modechange",this.triggerSelectedlanguagechange_))},e}(It),Ht=function(){function e(e){void 0===e&&(e=[]),this.trackElements_=[],Object.defineProperty(this,"length",{get:function(){return this.trackElements_.length}});for(var t=0,n=e.length;t<n;t++)this.addTrackElement_(e[t])}var t=e.prototype;return t.addTrackElement_=function(e){var t=this.trackElements_.length;""+t in this||Object.defineProperty(this,t,{get:function(){return this.trackElements_[t]}}),-1===this.trackElements_.indexOf(e)&&this.trackElements_.push(e)},t.getTrackElementByTrack_=function(e){for(var t,n=0,r=this.trackElements_.length;n<r;n++)if(e===this.trackElements_[n].track){t=this.trackElements_[n];break}return t},t.removeTrackElement_=function(e){for(var t=0,n=this.trackElements_.length;t<n;t++)if(e===this.trackElements_[t]){this.trackElements_[t].track&&"function"==typeof this.trackElements_[t].track.off&&this.trackElements_[t].track.off(),"function"==typeof this.trackElements_[t].off&&this.trackElements_[t].off(),this.trackElements_.splice(t,1);break}},e}(),Gt=function(){function t(e){t.prototype.setCues_.call(this,e),Object.defineProperty(this,"length",{get:function(){return this.length_}})}var e=t.prototype;return e.setCues_=function(e){var t=this.length||0,n=0,r=e.length;this.cues_=e,this.length_=e.length;function i(e){""+e in this||Object.defineProperty(this,""+e,{get:function(){return this.cues_[e]}})}if(t<r)for(n=t;n<r;n++)i.call(this,n)},e.getCueById=function(e){for(var t=null,n=0,r=this.length;n<r;n++){var i=this[n];if(i.id===e){t=i;break}}return t},t}(),Vt={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},zt={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},Wt={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},qt={disabled:"disabled",hidden:"hidden",showing:"showing"},Yt=function(a){function e(e){var t;void 0===e&&(e={}),t=a.call(this)||this;function n(e){Object.defineProperty(ke(t),e,{get:function(){return r[e]},set:function(){}})}var r={id:e.id||"vjs_track_"+ee(),kind:e.kind||"",label:e.label||"",language:e.language||""};for(var i in r)n(i);return t}return Le(e,a),e}(me),Kt=Object.freeze({parseUrl:Ot,getAbsoluteURL:Nt,getFileExtension:kt,isCrossOrigin:Bt}),Xt=function(e){var t=Qt.call(e);return"[object Function]"===t||"function"==typeof e&&"[object RegExp]"!==t||"undefined"!=typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)},Qt=Object.prototype.toString;function Zt(e){var t=nn.call(e),n="[object Arguments]"===t;return n=n||"[object Array]"!==t&&null!==e&&"object"==typeof e&&"number"==typeof e.length&&0<=e.length&&"[object Function]"===nn.call(e.callee)}var Jt,$t=Array.prototype.slice,en=Object.prototype.toString,tn=Function.prototype.bind||function(t){var n=this;if("function"!=typeof n||"[object Function]"!==en.call(n))throw new TypeError("Function.prototype.bind called on incompatible "+n);for(var r,i=$t.call(arguments,1),e=Math.max(0,n.length-i.length),a=[],o=0;o<e;o++)a.push("$"+o);if(r=Function("binder","return function ("+a.join(",")+"){ return binder.apply(this,arguments); }")(function(){if(this instanceof r){var e=n.apply(this,i.concat($t.call(arguments)));return Object(e)===e?e:this}return n.apply(t,i.concat($t.call(arguments)))}),n.prototype){function s(){}s.prototype=n.prototype,r.prototype=new s,s.prototype=null}return r},nn=Object.prototype.toString;if(!Object.keys){function rn(e){var t=e.constructor;return t&&t.prototype===e}var an=Object.prototype.hasOwnProperty,on=Object.prototype.toString,sn=Zt,ln=Object.prototype.propertyIsEnumerable,un=!ln.call({toString:null},"toString"),cn=ln.call(function(){},"prototype"),dn=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],hn={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},fn=function(){if("undefined"==typeof window)return!1;for(var e in window)try{if(!hn["$"+e]&&an.call(window,e)&&null!==window[e]&&"object"==typeof window[e])try{rn(window[e])}catch(e){return!0}}catch(e){return!0}return!1}();Jt=function(e){var t=null!==e&&"object"==typeof e,n="[object Function]"===on.call(e),r=sn(e),i=t&&"[object String]"===on.call(e),a=[];if(!t&&!n&&!r)throw new TypeError("Object.keys called on a non-object");var o=cn&&n;if(i&&0<e.length&&!an.call(e,0))for(var s=0;s<e.length;++s)a.push(String(s));if(r&&0<e.length)for(var l=0;l<e.length;++l)a.push(String(l));else for(var u in e)o&&"prototype"===u||!an.call(e,u)||a.push(String(u));if(un)for(var c=function(e){if("undefined"==typeof window||!fn)return rn(e);try{return rn(e)}catch(e){return!1}}(e),d=0;d<dn.length;++d)c&&"constructor"===dn[d]||!an.call(e,dn[d])||a.push(dn[d]);return a}}var pn=Jt,mn=Array.prototype.slice,gn=Object.keys,vn=gn?function(e){return gn(e)}:pn,yn=Object.keys;vn.shim=function(){Object.keys?function(){var e=Object.keys(arguments);return e&&e.length===arguments.length}(1,2)||(Object.keys=function(e){return Zt(e)?yn(mn.call(e)):yn(e)}):Object.keys=vn;return Object.keys||vn};function _n(e,t,n,r){t in e&&(!function(e){return"function"==typeof e&&"[object Function]"===An.call(e)}(r)||!r())||(Cn?Sn(e,t,{configurable:!0,enumerable:!1,value:n,writable:!0}):e[t]=n)}function bn(e,t,n){var r=2<arguments.length?n:{},i=En(t);Tn&&(i=wn.call(i,Object.getOwnPropertySymbols(t)));for(var a=0;a<i.length;a+=1)_n(e,i[a],t[i[a]],r[i[a]])}var En=vn,Tn="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),An=Object.prototype.toString,wn=Array.prototype.concat,Sn=Object.defineProperty,Cn=Sn&&function(){var e={};try{for(var t in Sn(e,"x",{enumerable:!1,value:e}),e)return!1;return e.x===e}catch(e){return!1}}();bn.supportsDescriptors=!!Cn;function xn(e,t){if(1<arguments.length&&"boolean"!=typeof t)throw new TypeError('"allowMissing" argument must be a boolean');var n="$ "+e;if(!(n in Hn))throw new SyntaxError("intrinsic "+e+" does not exist!");if(void 0===Hn[n]&&!t)throw new TypeError("intrinsic "+e+" exists, but is not available. Please file an issue!");return Hn[n]}function Mn(e,t,n,r){var i=Wn[t];if("function"!=typeof i)throw new zn("unknown record type: "+t);if(!i(e,r))throw new Vn(n+" must be a "+t);console.log(i(e,r),r)}function Rn(e){return 0<=e?1:-1}function In(e){try{var t=Xn.call(e);return Qn.test(t)}catch(e){return!1}}function Pn(e){if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;if("function"==typeof e&&!e.prototype)return!0;if(Jn)return function(e){try{return!In(e)&&(Xn.call(e),!0)}catch(e){return!1}}(e);if(In(e))return!1;var t=Zn.call(e);return"[object Function]"===t||"[object GeneratorFunction]"===t}function Dn(e){return null===e||"function"!=typeof e&&"object"!=typeof e}function Ln(){var e=ir.ToString(ir.CheckObjectCoercible(this));return ar(ar(e,or,""),sr,"")}function On(){return String.prototype.trim&&"​"==="​".trim()?String.prototype.trim:Ln}var Nn,kn=bn,Bn=Object.getOwnPropertyDescriptor?function(){return Object.getOwnPropertyDescriptor(arguments,"callee").get}():function(){throw new TypeError},Fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator,jn=Object.getPrototypeOf||function(e){return e.__proto__},Un="undefined"==typeof Uint8Array?Nn:jn(Uint8Array),Hn={"$ %Array%":Array,"$ %ArrayBuffer%":"undefined"==typeof ArrayBuffer?Nn:ArrayBuffer,"$ %ArrayBufferPrototype%":"undefined"==typeof ArrayBuffer?Nn:ArrayBuffer.prototype,"$ %ArrayIteratorPrototype%":Fn?jn([][Symbol.iterator]()):Nn,"$ %ArrayPrototype%":Array.prototype,"$ %ArrayProto_entries%":Array.prototype.entries,"$ %ArrayProto_forEach%":Array.prototype.forEach,"$ %ArrayProto_keys%":Array.prototype.keys,"$ %ArrayProto_values%":Array.prototype.values,"$ %AsyncFromSyncIteratorPrototype%":Nn,"$ %AsyncFunction%":void 0,"$ %AsyncFunctionPrototype%":Nn,"$ %AsyncGenerator%":Nn,"$ %AsyncGeneratorFunction%":void 0,"$ %AsyncGeneratorPrototype%":Nn,"$ %AsyncIteratorPrototype%":Nn,"$ %Atomics%":"undefined"==typeof Atomics?Nn:Atomics,"$ %Boolean%":Boolean,"$ %BooleanPrototype%":Boolean.prototype,"$ %DataView%":"undefined"==typeof DataView?Nn:DataView,"$ %DataViewPrototype%":"undefined"==typeof DataView?Nn:DataView.prototype,"$ %Date%":Date,"$ %DatePrototype%":Date.prototype,"$ %decodeURI%":decodeURI,"$ %decodeURIComponent%":decodeURIComponent,"$ %encodeURI%":encodeURI,"$ %encodeURIComponent%":encodeURIComponent,"$ %Error%":Error,"$ %ErrorPrototype%":Error.prototype,"$ %eval%":eval,"$ %EvalError%":EvalError,"$ %EvalErrorPrototype%":EvalError.prototype,"$ %Float32Array%":"undefined"==typeof Float32Array?Nn:Float32Array,"$ %Float32ArrayPrototype%":"undefined"==typeof Float32Array?Nn:Float32Array.prototype,"$ %Float64Array%":"undefined"==typeof Float64Array?Nn:Float64Array,"$ %Float64ArrayPrototype%":"undefined"==typeof Float64Array?Nn:Float64Array.prototype,"$ %Function%":Function,"$ %FunctionPrototype%":Function.prototype,"$ %Generator%":Nn,"$ %GeneratorFunction%":void 0,"$ %GeneratorPrototype%":Nn,"$ %Int8Array%":"undefined"==typeof Int8Array?Nn:Int8Array,"$ %Int8ArrayPrototype%":"undefined"==typeof Int8Array?Nn:Int8Array.prototype,"$ %Int16Array%":"undefined"==typeof Int16Array?Nn:Int16Array,"$ %Int16ArrayPrototype%":"undefined"==typeof Int16Array?Nn:Int8Array.prototype,"$ %Int32Array%":"undefined"==typeof Int32Array?Nn:Int32Array,"$ %Int32ArrayPrototype%":"undefined"==typeof Int32Array?Nn:Int32Array.prototype,"$ %isFinite%":isFinite,"$ %isNaN%":isNaN,"$ %IteratorPrototype%":Fn?jn(jn([][Symbol.iterator]())):Nn,"$ %JSON%":JSON,"$ %JSONParse%":JSON.parse,"$ %Map%":"undefined"==typeof Map?Nn:Map,"$ %MapIteratorPrototype%":"undefined"!=typeof Map&&Fn?jn((new Map)[Symbol.iterator]()):Nn,"$ %MapPrototype%":"undefined"==typeof Map?Nn:Map.prototype,"$ %Math%":Math,"$ %Number%":Number,"$ %NumberPrototype%":Number.prototype,"$ %Object%":Object,"$ %ObjectPrototype%":Object.prototype,"$ %ObjProto_toString%":Object.prototype.toString,"$ %ObjProto_valueOf%":Object.prototype.valueOf,"$ %parseFloat%":parseFloat,"$ %parseInt%":parseInt,"$ %Promise%":"undefined"==typeof Promise?Nn:Promise,"$ %PromisePrototype%":"undefined"==typeof Promise?Nn:Promise.prototype,"$ %PromiseProto_then%":"undefined"==typeof Promise?Nn:Promise.prototype.then,"$ %Promise_all%":"undefined"==typeof Promise?Nn:Promise.all,"$ %Promise_reject%":"undefined"==typeof Promise?Nn:Promise.reject,"$ %Promise_resolve%":"undefined"==typeof Promise?Nn:Promise.resolve,"$ %Proxy%":"undefined"==typeof Proxy?Nn:Proxy,"$ %RangeError%":RangeError,"$ %RangeErrorPrototype%":RangeError.prototype,"$ %ReferenceError%":ReferenceError,"$ %ReferenceErrorPrototype%":ReferenceError.prototype,"$ %Reflect%":"undefined"==typeof Reflect?Nn:Reflect,"$ %RegExp%":RegExp,"$ %RegExpPrototype%":RegExp.prototype,"$ %Set%":"undefined"==typeof Set?Nn:Set,"$ %SetIteratorPrototype%":"undefined"!=typeof Set&&Fn?jn((new Set)[Symbol.iterator]()):Nn,"$ %SetPrototype%":"undefined"==typeof Set?Nn:Set.prototype,"$ %SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?Nn:SharedArrayBuffer,"$ %SharedArrayBufferPrototype%":"undefined"==typeof SharedArrayBuffer?Nn:SharedArrayBuffer.prototype,"$ %String%":String,"$ %StringIteratorPrototype%":Fn?jn(""[Symbol.iterator]()):Nn,"$ %StringPrototype%":String.prototype,"$ %Symbol%":Fn?Symbol:Nn,"$ %SymbolPrototype%":Fn?Symbol.prototype:Nn,"$ %SyntaxError%":SyntaxError,"$ %SyntaxErrorPrototype%":SyntaxError.prototype,"$ %ThrowTypeError%":Bn,"$ %TypedArray%":Un,"$ %TypedArrayPrototype%":Un?Un.prototype:Nn,"$ %TypeError%":TypeError,"$ %TypeErrorPrototype%":TypeError.prototype,"$ %Uint8Array%":"undefined"==typeof Uint8Array?Nn:Uint8Array,"$ %Uint8ArrayPrototype%":"undefined"==typeof Uint8Array?Nn:Uint8Array.prototype,"$ %Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?Nn:Uint8ClampedArray,"$ %Uint8ClampedArrayPrototype%":"undefined"==typeof Uint8ClampedArray?Nn:Uint8ClampedArray.prototype,"$ %Uint16Array%":"undefined"==typeof Uint16Array?Nn:Uint16Array,"$ %Uint16ArrayPrototype%":"undefined"==typeof Uint16Array?Nn:Uint16Array.prototype,"$ %Uint32Array%":"undefined"==typeof Uint32Array?Nn:Uint32Array,"$ %Uint32ArrayPrototype%":"undefined"==typeof Uint32Array?Nn:Uint32Array.prototype,"$ %URIError%":URIError,"$ %URIErrorPrototype%":URIError.prototype,"$ %WeakMap%":"undefined"==typeof WeakMap?Nn:WeakMap,"$ %WeakMapPrototype%":"undefined"==typeof WeakMap?Nn:WeakMap.prototype,"$ %WeakSet%":"undefined"==typeof WeakSet?Nn:WeakSet,"$ %WeakSetPrototype%":"undefined"==typeof WeakSet?Nn:WeakSet.prototype},Gn=tn.call(Function.call,Object.prototype.hasOwnProperty),Vn=xn("%TypeError%"),zn=xn("%SyntaxError%"),Wn={"Property Descriptor":function(e,t){if("Object"!==e.Type(t))return!1;var n={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};for(var r in t)if(Gn(t,r)&&!n[r])return!1;var i=Gn(t,"[[Value]]"),a=Gn(t,"[[Get]]")||Gn(t,"[[Set]]");if(i&&a)throw new Vn("Property Descriptors may not be both accessor and data descriptors");return!0}},qn=Number.isNaN||function(e){return e!=e},Yn=Number.isNaN||function(e){return e!=e},Kn=Number.isFinite||function(e){return"number"==typeof e&&!Yn(e)&&e!==1/0&&e!==-1/0},Xn=Function.prototype.toString,Qn=/^\s*class\b/,Zn=Object.prototype.toString,Jn="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,$n=Object.prototype.toString,er=function(e,t){var n;if((n=1<arguments.length?t:"[object Date]"===$n.call(e)?String:Number)!==String&&n!==Number)throw new TypeError("invalid [[DefaultValue]] hint supplied");var r,i,a=n===String?["toString","valueOf"]:["valueOf","toString"];for(i=0;i<a.length;++i)if(Pn(e[a[i]])&&(r=e[a[i]](),Dn(r)))return r;throw new TypeError("No default value")},tr=xn("%Object%"),nr=xn("%TypeError%"),rr=xn("%String%"),ir={ToPrimitive:function(e,t){return Dn(e)?e:1<arguments.length?er(e,t):er(e)},ToBoolean:function(e){return!!e},ToNumber:function(e){return+e},ToInteger:function(e){var t=this.ToNumber(e);return qn(t)?0:0!==t&&Kn(t)?Rn(t)*Math.floor(Math.abs(t)):t},ToInt32:function(e){return this.ToNumber(e)>>0},ToUint32:function(e){return this.ToNumber(e)>>>0},ToUint16:function(e){var t=this.ToNumber(e);return qn(t)||0===t||!Kn(t)?0:function(e,t){var n=e%t;return Math.floor(0<=n?n:n+t)}(Rn(t)*Math.floor(Math.abs(t)),65536)},ToString:function(e){return rr(e)},ToObject:function(e){return this.CheckObjectCoercible(e),tr(e)},CheckObjectCoercible:function(e,t){if(null==e)throw new nr(t||"Cannot call method on "+e);return e},IsCallable:Pn,SameValue:function(e,t){return e===t?0!==e||1/e==1/t:qn(e)&&qn(t)},Type:function(e){return null===e?"Null":void 0===e?"Undefined":"function"==typeof e||"object"==typeof e?"Object":"number"==typeof e?"Number":"boolean"==typeof e?"Boolean":"string"==typeof e?"String":void 0},IsPropertyDescriptor:function(e){if("Object"!==this.Type(e))return!1;var t={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};for(var n in e)if(Gn(e,n)&&!t[n])return!1;var r=Gn(e,"[[Value]]"),i=Gn(e,"[[Get]]")||Gn(e,"[[Set]]");if(r&&i)throw new nr("Property Descriptors may not be both accessor and data descriptors");return!0},IsAccessorDescriptor:function(e){return void 0!==e&&(Mn(this,"Property Descriptor","Desc",e),!(!Gn(e,"[[Get]]")&&!Gn(e,"[[Set]]")))},IsDataDescriptor:function(e){return void 0!==e&&(Mn(this,"Property Descriptor","Desc",e),!(!Gn(e,"[[Value]]")&&!Gn(e,"[[Writable]]")))},IsGenericDescriptor:function(e){return void 0!==e&&(Mn(this,"Property Descriptor","Desc",e),!this.IsAccessorDescriptor(e)&&!this.IsDataDescriptor(e))},FromPropertyDescriptor:function(e){if(void 0===e)return e;if(Mn(this,"Property Descriptor","Desc",e),this.IsDataDescriptor(e))return{value:e["[[Value]]"],writable:!!e["[[Writable]]"],enumerable:!!e["[[Enumerable]]"],configurable:!!e["[[Configurable]]"]};if(this.IsAccessorDescriptor(e))return{get:e["[[Get]]"],set:e["[[Set]]"],enumerable:!!e["[[Enumerable]]"],configurable:!!e["[[Configurable]]"]};throw new nr("FromPropertyDescriptor must be called with a fully populated Property Descriptor")},ToPropertyDescriptor:function(e){if("Object"!==this.Type(e))throw new nr("ToPropertyDescriptor requires an object");var t={};if(Gn(e,"enumerable")&&(t["[[Enumerable]]"]=this.ToBoolean(e.enumerable)),Gn(e,"configurable")&&(t["[[Configurable]]"]=this.ToBoolean(e.configurable)),Gn(e,"value")&&(t["[[Value]]"]=e.value),Gn(e,"writable")&&(t["[[Writable]]"]=this.ToBoolean(e.writable)),Gn(e,"get")){var n=e.get;if(void 0!==n&&!this.IsCallable(n))throw new TypeError("getter must be a function");t["[[Get]]"]=n}if(Gn(e,"set")){var r=e.set;if(void 0!==r&&!this.IsCallable(r))throw new nr("setter must be a function");t["[[Set]]"]=r}if((Gn(t,"[[Get]]")||Gn(t,"[[Set]]"))&&(Gn(t,"[[Value]]")||Gn(t,"[[Writable]]")))throw new nr("Invalid property descriptor. Cannot both specify accessors and a value or writable attribute");return t}},ar=tn.call(Function.call,String.prototype.replace),or=/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/,sr=/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+$/,lr=tn.call(Function.call,On());kn(lr,{getPolyfill:On,implementation:Ln,shim:function(){var e=On();return kn(String.prototype,{trim:e},{trim:function(){return String.prototype.trim!==e}}),e}});var ur=lr,cr=Object.prototype.toString,dr=Object.prototype.hasOwnProperty,hr=function(e,t,n){if(!Pn(t))throw new TypeError("iterator must be a function");var r;3<=arguments.length&&(r=n),"[object Array]"===cr.call(e)?function(e,t,n){for(var r=0,i=e.length;r<i;r++)dr.call(e,r)&&(null==n?t(e[r],r,e):t.call(n,e[r],r,e))}(e,t,r):"string"==typeof e?function(e,t,n){for(var r=0,i=e.length;r<i;r++)null==n?t(e.charAt(r),r,e):t.call(n,e.charAt(r),r,e)}(e,t,r):function(e,t,n){for(var r in e)dr.call(e,r)&&(null==n?t(e[r],r,e):t.call(n,e[r],r,e))}(e,t,r)},fr=function(e){if(!e)return{};var i={};return hr(ur(e).split("\n"),function(e){var t=e.indexOf(":"),n=ur(e.slice(0,t)).toLowerCase(),r=ur(e.slice(t+1));void 0===i[n]?i[n]=r:!function(e){return"[object Array]"===Object.prototype.toString.call(e)}(i[n])?i[n]=[i[n],r]:i[n].push(r)}),i},pr=function(){for(var e={},t=0;t<arguments.length;t++){var n=arguments[t];for(var r in n)mr.call(n,r)&&(e[r]=n[r])}return e},mr=Object.prototype.hasOwnProperty;var gr=yr;function vr(e,t,n){var r=e;return Xt(t)?(n=t,"string"==typeof e&&(r={uri:e})):r=pr(t,{uri:e}),r.callback=n,r}function yr(e,t,n){return _r(t=vr(e,t,n))}function _r(r){if(void 0===r.callback)throw new Error("callback argument missing");var i=!1,a=function(e,t,n){i||(i=!0,r.callback(e,t,n))};function o(){var e=void 0;if(e=u.response?u.response:u.responseText||function(e){if("document"===e.responseType)return e.responseXML;var t=e.responseXML&&"parsererror"===e.responseXML.documentElement.nodeName;return""!==e.responseType||t?null:e.responseXML}(u),m)try{e=JSON.parse(e)}catch(e){}return e}function t(e){return clearTimeout(l),e instanceof Error||(e=new Error(""+(e||"Unknown XMLHttpRequest Error"))),e.statusCode=0,a(e,g)}function e(){if(!s){var e;clearTimeout(l),e=r.useXDR&&void 0===u.status?200:1223===u.status?204:u.status;var t=g,n=null;return 0!==e?(t={body:o(),statusCode:e,method:d,headers:{},url:c,rawRequest:u},u.getAllResponseHeaders&&(t.headers=fr(u.getAllResponseHeaders()))):n=new Error("Internal XMLHttpRequest Error"),a(n,t,t.body)}}var n,s,l,u=r.xhr||null,c=(u=u||(r.cors||r.useXDR?new yr.XDomainRequest:new yr.XMLHttpRequest)).url=r.uri||r.url,d=u.method=r.method||"GET",h=r.body||r.data,f=u.headers=r.headers||{},p=!!r.sync,m=!1,g={body:void 0,headers:{},statusCode:0,method:d,url:c,rawRequest:u};if("json"in r&&!1!==r.json&&(m=!0,f.accept||f.Accept||(f.Accept="application/json"),"GET"!==d&&"HEAD"!==d&&(f["content-type"]||f["Content-Type"]||(f["Content-Type"]="application/json"),h=JSON.stringify(!0===r.json?h:r.json))),u.onreadystatechange=function(){4===u.readyState&&setTimeout(e,0)},u.onload=e,u.onerror=t,u.onprogress=function(){},u.onabort=function(){s=!0},u.ontimeout=t,u.open(d,c,!p,r.username,r.password),p||(u.withCredentials=!!r.withCredentials),!p&&0<r.timeout&&(l=setTimeout(function(){if(!s){s=!0,u.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",t(e)}},r.timeout)),u.setRequestHeader)for(n in f)f.hasOwnProperty(n)&&u.setRequestHeader(n,f[n]);else if(r.headers&&!function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}(r.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in r&&(u.responseType=r.responseType),"beforeSend"in r&&"function"==typeof r.beforeSend&&r.beforeSend(u),u.send(h||null),u}yr.XMLHttpRequest=y.XMLHttpRequest||function(){},yr.XDomainRequest="withCredentials"in new yr.XMLHttpRequest?yr.XMLHttpRequest:y.XDomainRequest,function(e,t){for(var n=0;n<e.length;n++)t(e[n])}(["get","put","post","patch","head","delete"],function(r){yr["delete"===r?"del":r]=function(e,t,n){return(t=vr(e,t,n)).method=r.toUpperCase(),_r(t)}});function br(e,t){var n=new y.WebVTT.Parser(y,y.vttjs,y.WebVTT.StringDecoder()),r=[];n.oncue=function(e){t.addCue(e)},n.onparsingerror=function(e){r.push(e)},n.onflush=function(){t.trigger({type:"loadeddata",target:t})},n.parse(e),0<r.length&&(y.console&&y.console.groupCollapsed&&y.console.groupCollapsed("Text Track parsing errors for "+t.src),r.forEach(function(e){return h.error(e)}),y.console&&y.console.groupEnd&&y.console.groupEnd()),n.flush()}var Er=function(u){function e(e){var t;if(void 0===e&&(e={}),!e.tech)throw new Error("A tech was not provided.");var n=Pe(e,{kind:Wt[e.kind]||"subtitles",language:e.language||e.srclang||""}),r=qt[n.mode]||"disabled",i=n.default;"metadata"!==n.kind&&"chapters"!==n.kind||(r="hidden"),(t=u.call(this,n)||this).tech_=n.tech,t.cues_=[],t.activeCues_=[];var a=new Gt(t.cues_),o=new Gt(t.activeCues_),s=!1,l=he(ke(t),function(){this.activeCues=this.activeCues,s&&(this.trigger("cuechange"),s=!1)});return"disabled"!==r&&t.tech_.ready(function(){t.tech_.on("timeupdate",l)},!0),Object.defineProperties(ke(t),{default:{get:function(){return i},set:function(){}},mode:{get:function(){return r},set:function(e){var t=this;qt[e]&&("disabled"!==(r=e)?this.tech_.ready(function(){t.tech_.on("timeupdate",l)},!0):this.tech_.off("timeupdate",l),this.trigger("modechange"))}},cues:{get:function(){return this.loaded_?a:null},set:function(){}},activeCues:{get:function(){if(!this.loaded_)return null;if(0===this.cues.length)return o;for(var e=this.tech_.currentTime(),t=[],n=0,r=this.cues.length;n<r;n++){var i=this.cues[n];i.startTime<=e&&i.endTime>=e?t.push(i):i.startTime===i.endTime&&i.startTime<=e&&i.startTime+.5>=e&&t.push(i)}if(s=!1,t.length!==this.activeCues_.length)s=!0;else for(var a=0;a<t.length;a++)-1===this.activeCues_.indexOf(t[a])&&(s=!0);return this.activeCues_=t,o.setCues_(this.activeCues_),o},set:function(){}}}),n.src?(t.src=n.src,function(e,r){var t={uri:e},n=Bt(e);n&&(t.cors=n),gr(t,he(this,function(e,t,n){if(e)return h.error(e,t);r.loaded_=!0,"function"!=typeof y.WebVTT?r.tech_&&r.tech_.any(["vttjsloaded","vttjserror"],function(e){if("vttjserror"!==e.type)return br(n,r);h.error("vttjs failed to load, stopping trying to process "+r.src)}):br(n,r)}))}(n.src,ke(t))):t.loaded_=!0,t}Le(e,u);var t=e.prototype;return t.addCue=function(e){var t=e;if(y.vttjs&&!(e instanceof y.vttjs.VTTCue)){for(var n in t=new y.vttjs.VTTCue(e.startTime,e.endTime,e.text),e)n in t||(t[n]=e[n]);t.id=e.id,t.originalCue_=e}for(var r=this.tech_.textTracks(),i=0;i<r.length;i++)r[i]!==this&&r[i].removeCue(t);this.cues_.push(t),this.cues.setCues_(this.cues_)},t.removeCue=function(e){for(var t=this.cues_.length;t--;){var n=this.cues_[t];if(n===e||n.originalCue_&&n.originalCue_===e){this.cues_.splice(t,1),this.cues.setCues_(this.cues_);break}}},e}(Yt);Er.prototype.allowedEvents_={cuechange:"cuechange"};var Tr=function(i){function e(e){var t;void 0===e&&(e={});var n=Pe(e,{kind:zt[e.kind]||""});t=i.call(this,n)||this;var r=!1;return Object.defineProperty(ke(t),"enabled",{get:function(){return r},set:function(e){"boolean"==typeof e&&e!==r&&(r=e,this.trigger("enabledchange"))}}),n.enabled&&(t.enabled=n.enabled),t.loaded_=!0,t}return Le(e,i),e}(Yt),Ar=function(i){function e(e){var t;void 0===e&&(e={});var n=Pe(e,{kind:Vt[e.kind]||""});t=i.call(this,n)||this;var r=!1;return Object.defineProperty(ke(t),"selected",{get:function(){return r},set:function(e){"boolean"==typeof e&&e!==r&&(r=e,this.trigger("selectedchange"))}}),n.selected&&(t.selected=n.selected),t}return Le(e,i),e}(Yt),wr=function(i){function e(e){var t,n;void 0===e&&(e={}),t=i.call(this)||this;var r=new Er(e);return t.kind=r.kind,t.src=r.src,t.srclang=r.language,t.label=r.label,t.default=r.default,Object.defineProperties(ke(t),{readyState:{get:function(){return n}},track:{get:function(){return r}}}),n=0,r.addEventListener("loadeddata",function(){n=2,t.trigger({type:"load",target:ke(t)})}),t}return Le(e,i),e}(me);wr.prototype.allowedEvents_={load:"load"},wr.NONE=0,wr.LOADING=1,wr.LOADED=2,wr.ERROR=3;var Sr={audio:{ListClass:Ft,TrackClass:Tr,capitalName:"Audio"},video:{ListClass:jt,TrackClass:Ar,capitalName:"Video"},text:{ListClass:Ut,TrackClass:Er,capitalName:"Text"}};Object.keys(Sr).forEach(function(e){Sr[e].getterName=e+"Tracks",Sr[e].privateName=e+"Tracks_"});var Cr={remoteText:{ListClass:Ut,TrackClass:Er,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:Ht,TrackClass:wr,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}},xr=Pe(Sr,Cr);Cr.names=Object.keys(Cr),Sr.names=Object.keys(Sr),xr.names=[].concat(Cr.names).concat(Sr.names);var Mr=Object.create||function(e){if(1!==arguments.length)throw new Error("Object.create shim only accepts one parameter.");return Rr.prototype=e,new Rr};function Rr(){}function Ir(e,t){this.name="ParsingError",this.code=e.code,this.message=t||e.message}function Pr(e){function t(e,t,n,r){return 3600*(0|e)+60*(0|t)+(0|n)+(0|r)/1e3}var n=e.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return n?n[3]?t(n[1],n[2],n[3].replace(":",""),n[4]):59<n[1]?t(n[1],n[2],0,n[4]):t(0,n[1],n[2],n[4]):null}function Dr(){this.values=Mr(null)}function Lr(e,t,n,r){var i=r?e.split(r):[e];for(var a in i)if("string"==typeof i[a]){var o=i[a].split(n);if(2===o.length)t(o[0],o[1])}}function Or(t,e,a){var n,r,o,i=t;function s(){var e=Pr(t);if(null===e)throw new Ir(Ir.Errors.BadTimeStamp,"Malformed timestamp: "+i);return t=t.replace(/^[^\sa-zA-Z-]+/,""),e}function l(){t=t.replace(/^\s+/,"")}if(l(),e.startTime=s(),l(),"--\x3e"!==t.substr(0,3))throw new Ir(Ir.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '--\x3e'): "+i);t=t.substr(3),l(),e.endTime=s(),l(),n=t,r=e,o=new Dr,Lr(n,function(e,t){switch(e){case"region":for(var n=a.length-1;0<=n;n--)if(a[n].id===t){o.set(e,a[n].region);break}break;case"vertical":o.alt(e,t,["rl","lr"]);break;case"line":var r=t.split(","),i=r[0];o.integer(e,i),o.percent(e,i)&&o.set("snapToLines",!1),o.alt(e,i,["auto"]),2===r.length&&o.alt("lineAlign",r[1],["start","middle","end"]);break;case"position":r=t.split(","),o.percent(e,r[0]),2===r.length&&o.alt("positionAlign",r[1],["start","middle","end"]);break;case"size":o.percent(e,t);break;case"align":o.alt(e,t,["start","middle","end","left","right"])}},/:/,/\s/),r.region=o.get("region",null),r.vertical=o.get("vertical",""),r.line=o.get("line","auto"),r.lineAlign=o.get("lineAlign","start"),r.snapToLines=o.get("snapToLines",!0),r.size=o.get("size",100),r.align=o.get("align","middle"),r.position=o.get("position",{start:0,left:0,middle:50,end:100,right:100},r.align),r.positionAlign=o.get("positionAlign",{start:"start",left:"start",middle:"middle",end:"end",right:"end"},r.align)}((Ir.prototype=Mr(Error.prototype)).constructor=Ir).Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}},Dr.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,n){for(var r=0;r<n.length;++r)if(t===n[r]){this.set(e,t);break}},integer:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&0<=(t=parseFloat(t))&&t<=100)&&(this.set(e,t),!0)}};var Nr={"&amp;":"&","&lt;":"<","&gt;":">","&lrm;":"‎","&rlm;":"‏","&nbsp;":" "},kr={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},Br={v:"title",lang:"lang"},Fr={rt:"ruby"};function jr(a,n){function e(){if(!n)return null;var e,t=n.match(/^([^<]*)(<[^>]*>?)?/);return e=t[1]?t[1]:t[2],n=n.substr(e.length),e}function t(e){return Nr[e]}function r(e){for(;p=e.match(/&(amp|lt|gt|lrm|rlm|nbsp);/);)e=e.replace(p[0],t);return e}function i(e,t){var n=kr[e];if(!n)return null;var r=a.document.createElement(n);r.localName=n;var i=Br[e];return i&&t&&(r[i]=t.trim()),r}for(var o,s,l,u=a.document.createElement("div"),c=u,d=[];null!==(o=e());)if("<"!==o[0])c.appendChild(a.document.createTextNode(r(o)));else{if("/"===o[1]){d.length&&d[d.length-1]===o.substr(2).replace(">","")&&(d.pop(),c=c.parentNode);continue}var h,f=Pr(o.substr(1,o.length-2));if(f){h=a.document.createProcessingInstruction("timestamp",f),c.appendChild(h);continue}var p=o.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!p)continue;if(!(h=i(p[1],p[3])))continue;if(s=c,Fr[(l=h).localName]&&Fr[l.localName]!==s.localName)continue;p[2]&&(h.className=p[2].substr(1).replace("."," ")),d.push(p[1]),c.appendChild(h),c=h}return u}var Ur=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function Hr(e){for(var t=0;t<Ur.length;t++){var n=Ur[t];if(e>=n[0]&&e<=n[1])return!0}return!1}function Gr(){}function Vr(e,t,n){Gr.call(this),this.cue=t,this.cueDiv=jr(e,t.text);var r={color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 0.8)",position:"relative",left:0,right:0,top:0,bottom:0,display:"inline",writingMode:""===t.vertical?"horizontal-tb":"lr"===t.vertical?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext"};this.applyStyles(r,this.cueDiv),this.div=e.document.createElement("div"),r={direction:function(e){var t=[],n="";if(!e||!e.childNodes)return"ltr";function i(e,t){for(var n=t.childNodes.length-1;0<=n;n--)e.push(t.childNodes[n])}function a(e){if(!e||!e.length)return null;var t=e.pop(),n=t.textContent||t.innerText;if(n){var r=n.match(/^.*(\n|\r)/);return r?r[e.length=0]:n}return"ruby"===t.tagName?a(e):t.childNodes?(i(e,t),a(e)):void 0}for(i(t,e);n=a(t);)for(var r=0;r<n.length;r++)if(Hr(n.charCodeAt(r)))return"rtl";return"ltr"}(this.cueDiv),writingMode:""===t.vertical?"horizontal-tb":"lr"===t.vertical?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext",textAlign:"middle"===t.align?"center":t.align,font:n.font,whiteSpace:"pre-line",position:"absolute"},this.applyStyles(r),this.div.appendChild(this.cueDiv);var i=0;switch(t.positionAlign){case"start":i=t.position;break;case"middle":i=t.position-t.size/2;break;case"end":i=t.position-t.size}""===t.vertical?this.applyStyles({left:this.formatStyle(i,"%"),width:this.formatStyle(t.size,"%")}):this.applyStyles({top:this.formatStyle(i,"%"),height:this.formatStyle(t.size,"%")}),this.move=function(e){this.applyStyles({top:this.formatStyle(e.top,"px"),bottom:this.formatStyle(e.bottom,"px"),left:this.formatStyle(e.left,"px"),right:this.formatStyle(e.right,"px"),height:this.formatStyle(e.height,"px"),width:this.formatStyle(e.width,"px")})}}function zr(e){var t,n,r,i;if(e.div){n=e.div.offsetHeight,r=e.div.offsetWidth,i=e.div.offsetTop;var a=(a=e.div.childNodes)&&(a=a[0])&&a.getClientRects&&a.getClientRects();e=e.div.getBoundingClientRect(),t=a?Math.max(a[0]&&a[0].height||0,e.height/a.length):0}this.left=e.left,this.right=e.right,this.top=e.top||i,this.height=e.height||n,this.bottom=e.bottom||i+(e.height||n),this.width=e.width||r,this.lineHeight=void 0!==t?t:e.lineHeight}function Wr(e,t,s,l){var n=new zr(t),r=t.cue,i=function(e){if("number"==typeof e.line&&(e.snapToLines||0<=e.line&&e.line<=100))return e.line;if(!e.track||!e.track.textTrackList||!e.track.textTrackList.mediaElement)return-1;for(var t=e.track,n=t.textTrackList,r=0,i=0;i<n.length&&n[i]!==t;i++)"showing"===n[i].mode&&r++;return-1*++r}(r),a=[];if(r.snapToLines){var o;switch(r.vertical){case"":a=["+y","-y"],o="height";break;case"rl":a=["+x","-x"],o="width";break;case"lr":a=["-x","+x"],o="width"}var u=n.lineHeight,c=u*Math.round(i),d=s[o]+u,h=a[0];Math.abs(c)>d&&(c=c<0?-1:1,c*=Math.ceil(d/u)*u),i<0&&(c+=""===r.vertical?s.height:s.width,a=a.reverse()),n.move(h,c)}else{var f=n.lineHeight/s.height*100;switch(r.lineAlign){case"middle":i-=f/2;break;case"end":i-=f}switch(r.vertical){case"":t.applyStyles({top:t.formatStyle(i,"%")});break;case"rl":t.applyStyles({left:t.formatStyle(i,"%")});break;case"lr":t.applyStyles({right:t.formatStyle(i,"%")})}a=["+y","-x","+x","-y"],n=new zr(t)}var p=function(e,t){for(var n,r=new zr(e),i=1,a=0;a<t.length;a++){for(;e.overlapsOppositeAxis(s,t[a])||e.within(s)&&e.overlapsAny(l);)e.move(t[a]);if(e.within(s))return e;var o=e.intersectPercentage(s);o<i&&(n=new zr(e),i=o),e=new zr(r)}return n||r}(n,a);t.move(p.toCSSCompatValues(s))}function qr(){}Gr.prototype.applyStyles=function(e,t){for(var n in t=t||this.div,e)e.hasOwnProperty(n)&&(t.style[n]=e[n])},Gr.prototype.formatStyle=function(e,t){return 0===e?0:e+t},(Vr.prototype=Mr(Gr.prototype)).constructor=Vr,zr.prototype.move=function(e,t){switch(t=void 0!==t?t:this.lineHeight,e){case"+x":this.left+=t,this.right+=t;break;case"-x":this.left-=t,this.right-=t;break;case"+y":this.top+=t,this.bottom+=t;break;case"-y":this.top-=t,this.bottom-=t}},zr.prototype.overlaps=function(e){return this.left<e.right&&this.right>e.left&&this.top<e.bottom&&this.bottom>e.top},zr.prototype.overlapsAny=function(e){for(var t=0;t<e.length;t++)if(this.overlaps(e[t]))return!0;return!1},zr.prototype.within=function(e){return this.top>=e.top&&this.bottom<=e.bottom&&this.left>=e.left&&this.right<=e.right},zr.prototype.overlapsOppositeAxis=function(e,t){switch(t){case"+x":return this.left<e.left;case"-x":return this.right>e.right;case"+y":return this.top<e.top;case"-y":return this.bottom>e.bottom}},zr.prototype.intersectPercentage=function(e){return Math.max(0,Math.min(this.right,e.right)-Math.max(this.left,e.left))*Math.max(0,Math.min(this.bottom,e.bottom)-Math.max(this.top,e.top))/(this.height*this.width)},zr.prototype.toCSSCompatValues=function(e){return{top:this.top-e.top,bottom:e.bottom-this.bottom,left:this.left-e.left,right:e.right-this.right,height:this.height,width:this.width}},zr.getSimpleBoxPosition=function(e){var t=e.div?e.div.offsetHeight:e.tagName?e.offsetHeight:0,n=e.div?e.div.offsetWidth:e.tagName?e.offsetWidth:0,r=e.div?e.div.offsetTop:e.tagName?e.offsetTop:0;return{left:(e=e.div?e.div.getBoundingClientRect():e.tagName?e.getBoundingClientRect():e).left,right:e.right,top:e.top||r,height:e.height||t,bottom:e.bottom||r+(e.height||t),width:e.width||n}},qr.StringDecoder=function(){return{decode:function(e){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}},qr.convertCueToDOMTree=function(e,t){return e&&t?jr(e,t):null};qr.processCues=function(r,i,e){if(!r||!i||!e)return null;for(;e.firstChild;)e.removeChild(e.firstChild);var a=r.document.createElement("div");if(a.style.position="absolute",a.style.left="0",a.style.right="0",a.style.top="0",a.style.bottom="0",a.style.margin="1.5%",e.appendChild(a),function(e){for(var t=0;t<e.length;t++)if(e[t].hasBeenReset||!e[t].displayState)return!0;return!1}(i)){var o=[],s=zr.getSimpleBoxPosition(a),l={font:Math.round(.05*s.height*100)/100+"px sans-serif"};!function(){for(var e,t,n=0;n<i.length;n++)t=i[n],e=new Vr(r,t,l),a.appendChild(e.div),Wr(0,e,s,o),t.displayState=e.div,o.push(zr.getSimpleBoxPosition(e))}()}else for(var t=0;t<i.length;t++)a.appendChild(i[t].displayState)},(qr.Parser=function(e,t,n){n||(n=t,t={}),t=t||{},this.window=e,this.vttjs=t,this.state="INITIAL",this.buffer="",this.decoder=n||new TextDecoder("utf8"),this.regionList=[]}).prototype={reportOrThrowError:function(e){if(!(e instanceof Ir))throw e;this.onparsingerror&&this.onparsingerror(e)},parse:function(e){var r=this;function t(){for(var e=r.buffer,t=0;t<e.length&&"\r"!==e[t]&&"\n"!==e[t];)++t;var n=e.substr(0,t);return"\r"===e[t]&&++t,"\n"===e[t]&&++t,r.buffer=e.substr(t),n}function n(e){e.match(/X-TIMESTAMP-MAP/)?Lr(e,function(e,t){switch(e){case"X-TIMESTAMP-MAP":!function(e){var n=new Dr;Lr(e,function(e,t){switch(e){case"MPEGT":n.integer(e+"S",t);break;case"LOCA":n.set(e+"L",Pr(t))}},/[^\d]:/,/,/),r.ontimestampmap&&r.ontimestampmap({MPEGTS:n.get("MPEGTS"),LOCAL:n.get("LOCAL")})}(t)}},/=/):Lr(e,function(e,t){switch(e){case"Region":!function(e){var i=new Dr;if(Lr(e,function(e,t){switch(e){case"id":i.set(e,t);break;case"width":i.percent(e,t);break;case"lines":i.integer(e,t);break;case"regionanchor":case"viewportanchor":var n=t.split(",");if(2!==n.length)break;var r=new Dr;if(r.percent("x",n[0]),r.percent("y",n[1]),!r.has("x")||!r.has("y"))break;i.set(e+"X",r.get("x")),i.set(e+"Y",r.get("y"));break;case"scroll":i.alt(e,t,["up"])}},/=/,/\s/),i.has("id")){var t=new(r.vttjs.VTTRegion||r.window.VTTRegion);t.width=i.get("width",100),t.lines=i.get("lines",3),t.regionAnchorX=i.get("regionanchorX",0),t.regionAnchorY=i.get("regionanchorY",100),t.viewportAnchorX=i.get("viewportanchorX",0),t.viewportAnchorY=i.get("viewportanchorY",100),t.scroll=i.get("scroll",""),r.onregion&&r.onregion(t),r.regionList.push({id:i.get("id"),region:t})}}(t)}},/:/)}e&&(r.buffer+=r.decoder.decode(e,{stream:!0}));try{var i;if("INITIAL"===r.state){if(!/\r\n|\n/.test(r.buffer))return this;var a=(i=t()).match(/^WEBVTT([ \t].*)?$/);if(!a||!a[0])throw new Ir(Ir.Errors.BadSignature);r.state="HEADER"}for(var o=!1;r.buffer;){if(!/\r\n|\n/.test(r.buffer))return this;switch(o?o=!1:i=t(),r.state){case"HEADER":/:/.test(i)?n(i):i||(r.state="ID");continue;case"NOTE":i||(r.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(i)){r.state="NOTE";break}if(!i)continue;if(r.cue=new(r.vttjs.VTTCue||r.window.VTTCue)(0,0,""),r.state="CUE",-1===i.indexOf("--\x3e")){r.cue.id=i;continue}case"CUE":try{Or(i,r.cue,r.regionList)}catch(e){r.reportOrThrowError(e),r.cue=null,r.state="BADCUE";continue}r.state="CUETEXT";continue;case"CUETEXT":var s=-1!==i.indexOf("--\x3e");if(!i||s&&(o=!0)){r.oncue&&r.oncue(r.cue),r.cue=null,r.state="ID";continue}r.cue.text&&(r.cue.text+="\n"),r.cue.text+=i;continue;case"BADCUE":i||(r.state="ID");continue}}}catch(e){r.reportOrThrowError(e),"CUETEXT"===r.state&&r.cue&&r.oncue&&r.oncue(r.cue),r.cue=null,r.state="INITIAL"===r.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){var t=this;try{if(t.buffer+=t.decoder.decode(),!t.cue&&"HEADER"!==t.state||(t.buffer+="\n\n",t.parse()),"INITIAL"===t.state)throw new Ir(Ir.Errors.BadSignature)}catch(e){t.reportOrThrowError(e)}return t.onflush&&t.onflush(),this}};var Yr=qr,Kr={"":1,lr:1,rl:1},Xr={start:1,middle:1,end:1,left:1,right:1};function Qr(e){return"string"==typeof e&&(!!Xr[e.toLowerCase()]&&e.toLowerCase())}function Zr(e,t,n){this.hasBeenReset=!1;var r="",i=!1,a=e,o=t,s=n,l=null,u="",c=!0,d="auto",h="start",f=50,p="middle",m=50,g="middle";Object.defineProperties(this,{id:{enumerable:!0,get:function(){return r},set:function(e){r=""+e}},pauseOnExit:{enumerable:!0,get:function(){return i},set:function(e){i=!!e}},startTime:{enumerable:!0,get:function(){return a},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");a=e,this.hasBeenReset=!0}},endTime:{enumerable:!0,get:function(){return o},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");o=e,this.hasBeenReset=!0}},text:{enumerable:!0,get:function(){return s},set:function(e){s=""+e,this.hasBeenReset=!0}},region:{enumerable:!0,get:function(){return l},set:function(e){l=e,this.hasBeenReset=!0}},vertical:{enumerable:!0,get:function(){return u},set:function(e){var t=function(e){return"string"==typeof e&&(!!Kr[e.toLowerCase()]&&e.toLowerCase())}(e);if(!1===t)throw new SyntaxError("An invalid or illegal string was specified.");u=t,this.hasBeenReset=!0}},snapToLines:{enumerable:!0,get:function(){return c},set:function(e){c=!!e,this.hasBeenReset=!0}},line:{enumerable:!0,get:function(){return d},set:function(e){if("number"!=typeof e&&"auto"!==e)throw new SyntaxError("An invalid number or illegal string was specified.");d=e,this.hasBeenReset=!0}},lineAlign:{enumerable:!0,get:function(){return h},set:function(e){var t=Qr(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");h=t,this.hasBeenReset=!0}},position:{enumerable:!0,get:function(){return f},set:function(e){if(e<0||100<e)throw new Error("Position must be between 0 and 100.");f=e,this.hasBeenReset=!0}},positionAlign:{enumerable:!0,get:function(){return p},set:function(e){var t=Qr(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");p=t,this.hasBeenReset=!0}},size:{enumerable:!0,get:function(){return m},set:function(e){if(e<0||100<e)throw new Error("Size must be between 0 and 100.");m=e,this.hasBeenReset=!0}},align:{enumerable:!0,get:function(){return g},set:function(e){var t=Qr(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");g=t,this.hasBeenReset=!0}}}),this.displayState=void 0}Zr.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)};var Jr=Zr,$r={"":!0,up:!0};function ei(e){return"number"==typeof e&&0<=e&&e<=100}function ti(){var t=100,n=3,r=0,i=100,a=0,o=100,s="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return t},set:function(e){if(!ei(e))throw new Error("Width must be between 0 and 100.");t=e}},lines:{enumerable:!0,get:function(){return n},set:function(e){if("number"!=typeof e)throw new TypeError("Lines must be set to a number.");n=e}},regionAnchorY:{enumerable:!0,get:function(){return i},set:function(e){if(!ei(e))throw new Error("RegionAnchorX must be between 0 and 100.");i=e}},regionAnchorX:{enumerable:!0,get:function(){return r},set:function(e){if(!ei(e))throw new Error("RegionAnchorY must be between 0 and 100.");r=e}},viewportAnchorY:{enumerable:!0,get:function(){return o},set:function(e){if(!ei(e))throw new Error("ViewportAnchorY must be between 0 and 100.");o=e}},viewportAnchorX:{enumerable:!0,get:function(){return a},set:function(e){if(!ei(e))throw new Error("ViewportAnchorX must be between 0 and 100.");a=e}},scroll:{enumerable:!0,get:function(){return s},set:function(e){var t=function(e){return"string"==typeof e&&(!!$r[e.toLowerCase()]&&e.toLowerCase())}(e);if(!1===t)throw new SyntaxError("An invalid or illegal string was specified.");s=t}}})}var ni=Ct(function(e){var t=e.exports={WebVTT:Yr,VTTCue:Jr,VTTRegion:ti};y.vttjs=t,y.WebVTT=t.WebVTT;var n=t.VTTCue,r=t.VTTRegion,i=y.VTTCue,a=y.VTTRegion;t.shim=function(){y.VTTCue=n,y.VTTRegion=r},t.restore=function(){y.VTTCue=i,y.VTTRegion=a},y.VTTCue||t.shim()});ni.WebVTT,ni.VTTCue,ni.VTTRegion;var ri=function(t){function n(n,e){var r;return void 0===n&&(n={}),void 0===e&&(e=function(){}),n.reportTouchActivity=!1,(r=t.call(this,null,n,e)||this).hasStarted_=!1,r.on("playing",function(){this.hasStarted_=!0}),r.on("loadstart",function(){this.hasStarted_=!1}),xr.names.forEach(function(e){var t=xr[e];n&&n[t.getterName]&&(r[t.privateName]=n[t.getterName])}),r.featuresProgressEvents||r.manualProgressOn(),r.featuresTimeupdateEvents||r.manualTimeUpdatesOn(),["Text","Audio","Video"].forEach(function(e){!1===n["native"+e+"Tracks"]&&(r["featuresNative"+e+"Tracks"]=!1)}),!1===n.nativeCaptions||!1===n.nativeTextTracks?r.featuresNativeTextTracks=!1:!0!==n.nativeCaptions&&!0!==n.nativeTextTracks||(r.featuresNativeTextTracks=!0),r.featuresNativeTextTracks||r.emulateTextTracks(),r.autoRemoteTextTracks_=new xr.text.ListClass,r.initTrackListeners(),n.nativeControlsForTouch||r.emitTapEvents(),r.constructor&&(r.name_=r.constructor.name||"Unknown Tech"),r}Le(n,t);var e=n.prototype;return e.triggerSourceset=function(e){var t=this;this.isReady_||this.one("ready",function(){return t.setTimeout(function(){return t.triggerSourceset(e)},1)}),this.trigger({src:e,type:"sourceset"})},e.manualProgressOn=function(){this.on("durationchange",this.onDurationChange),this.manualProgress=!0,this.one("ready",this.trackProgress)},e.manualProgressOff=function(){this.manualProgress=!1,this.stopTrackingProgress(),this.off("durationchange",this.onDurationChange)},e.trackProgress=function(){this.stopTrackingProgress(),this.progressInterval=this.setInterval(he(this,function(){var e=this.bufferedPercent();this.bufferedPercent_!==e&&this.trigger("progress"),1===(this.bufferedPercent_=e)&&this.stopTrackingProgress()}),500)},e.onDurationChange=function(){this.duration_=this.duration()},e.buffered=function(){return ct(0,0)},e.bufferedPercent=function(){return dt(this.buffered(),this.duration_)},e.stopTrackingProgress=function(){this.clearInterval(this.progressInterval)},e.manualTimeUpdatesOn=function(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime),this.on("pause",this.stopTrackingCurrentTime)},e.manualTimeUpdatesOff=function(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime),this.off("pause",this.stopTrackingCurrentTime)},e.trackCurrentTime=function(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval(function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},250)},e.stopTrackingCurrentTime=function(){this.clearInterval(this.currentTimeInterval),this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},e.dispose=function(){this.clearTracks(Sr.names),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),t.prototype.dispose.call(this)},e.clearTracks=function(e){var i=this;(e=[].concat(e)).forEach(function(e){for(var t=i[e+"Tracks"]()||[],n=t.length;n--;){var r=t[n];"text"===e&&i.removeRemoteTextTrack(r),t.removeTrack(r)}})},e.cleanupAutoTextTracks=function(){for(var e=this.autoRemoteTextTracks_||[],t=e.length;t--;){var n=e[t];this.removeRemoteTextTrack(n)}},e.reset=function(){},e.error=function(e){return void 0!==e&&(this.error_=new yt(e),this.trigger("error")),this.error_},e.played=function(){return this.hasStarted_?ct(0,0):ct()},e.setCurrentTime=function(){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},e.initTrackListeners=function(){var i=this;Sr.names.forEach(function(e){function t(){i.trigger(e+"trackchange")}var n=Sr[e],r=i[n.getterName]();r.addEventListener("removetrack",t),r.addEventListener("addtrack",t),i.on("dispose",function(){r.removeEventListener("removetrack",t),r.removeEventListener("addtrack",t)})})},e.addWebVttScript_=function(){var e=this;if(!y.WebVTT)if(d.body.contains(this.el())){if(!this.options_["vtt.js"]&&s(ni)&&0<Object.keys(ni).length)return void this.trigger("vttjsloaded");var t=d.createElement("script");t.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js",t.onload=function(){e.trigger("vttjsloaded")},t.onerror=function(){e.trigger("vttjserror")},this.on("dispose",function(){t.onload=null,t.onerror=null}),y.WebVTT=!0,this.el().parentNode.appendChild(t)}else this.ready(this.addWebVttScript_)},e.emulateTextTracks=function(){function t(e){return r.addTrack(e.track)}function n(e){return r.removeTrack(e.track)}var e=this,r=this.textTracks(),i=this.remoteTextTracks();i.on("addtrack",t),i.on("removetrack",n),this.addWebVttScript_();function a(){return e.trigger("texttrackchange")}function o(){a();for(var e=0;e<r.length;e++){var t=r[e];t.removeEventListener("cuechange",a),"showing"===t.mode&&t.addEventListener("cuechange",a)}}o(),r.addEventListener("change",o),r.addEventListener("addtrack",o),r.addEventListener("removetrack",o),this.on("dispose",function(){i.off("addtrack",t),i.off("removetrack",n),r.removeEventListener("change",o),r.removeEventListener("addtrack",o),r.removeEventListener("removetrack",o);for(var e=0;e<r.length;e++){r[e].removeEventListener("cuechange",a)}})},e.addTextTrack=function(e,t,n){if(!e)throw new Error("TextTrack kind is required but was not provided");return function(e,t,n,r,i){void 0===i&&(i={});var a=e.textTracks();i.kind=t,n&&(i.label=n),r&&(i.language=r),i.tech=e;var o=new xr.text.TrackClass(i);return a.addTrack(o),o}(this,e,t,n)},e.createRemoteTextTrack=function(e){var t=Pe(e,{tech:this});return new Cr.remoteTextEl.TrackClass(t)},e.addRemoteTextTrack=function(e,t){var n=this;void 0===e&&(e={});var r=this.createRemoteTextTrack(e);return!0!==t&&!1!==t&&(h.warn('Calling addRemoteTextTrack without explicitly setting the "manualCleanup" parameter to `true` is deprecated and default to `false` in future version of video.js'),t=!0),this.remoteTextTrackEls().addTrackElement_(r),this.remoteTextTracks().addTrack(r.track),!0!==t&&this.ready(function(){return n.autoRemoteTextTracks_.addTrack(r.track)}),r},e.removeRemoteTextTrack=function(e){var t=this.remoteTextTrackEls().getTrackElementByTrack_(e);this.remoteTextTrackEls().removeTrackElement_(t),this.remoteTextTracks().removeTrack(e),this.autoRemoteTextTracks_.removeTrack(e)},e.getVideoPlaybackQuality=function(){return{}},e.requestPictureInPicture=function(){var e=this.options_.Promise||y.Promise;if(e)return e.reject()},e.setPoster=function(){},e.playsinline=function(){},e.setPlaysinline=function(){},e.overrideNativeAudioTracks=function(){},e.overrideNativeVideoTracks=function(){},e.canPlayType=function(){return""},n.canPlayType=function(){return""},n.canPlaySource=function(e){return n.canPlayType(e.type)},n.isTech=function(e){return e.prototype instanceof n||e instanceof n||e===n},n.registerTech=function(e,t){if(n.techs_||(n.techs_={}),!n.isTech(t))throw new Error("Tech "+e+" must be a Tech");if(!n.canPlayType)throw new Error("Techs must have a static canPlayType method on them");if(!n.canPlaySource)throw new Error("Techs must have a static canPlaySource method on them");return e=Ie(e),n.techs_[e]=t,n.techs_[Re(e)]=t,"Tech"!==e&&n.defaultTechOrder_.push(e),t},n.getTech=function(e){if(e)return n.techs_&&n.techs_[e]?n.techs_[e]:(e=Ie(e),y&&y.videojs&&y.videojs[e]?(h.warn("The "+e+" tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)"),y.videojs[e]):void 0)},n}(De);xr.names.forEach(function(e){var t=xr[e];ri.prototype[t.getterName]=function(){return this[t.privateName]=this[t.privateName]||new t.ListClass,this[t.privateName]}}),ri.prototype.featuresVolumeControl=!0,ri.prototype.featuresMuteControl=!0,ri.prototype.featuresFullscreenResize=!1,ri.prototype.featuresPlaybackRate=!1,ri.prototype.featuresProgressEvents=!1,ri.prototype.featuresSourceset=!1,ri.prototype.featuresTimeupdateEvents=!1,ri.prototype.featuresNativeTextTracks=!1,ri.withSourceHandlers=function(i){i.registerSourceHandler=function(e,t){var n=i.sourceHandlers;n=n||(i.sourceHandlers=[]),void 0===t&&(t=n.length),n.splice(t,0,e)},i.canPlayType=function(e){for(var t,n=i.sourceHandlers||[],r=0;r<n.length;r++)if(t=n[r].canPlayType(e))return t;return""},i.selectSourceHandler=function(e,t){for(var n=i.sourceHandlers||[],r=0;r<n.length;r++)if(n[r].canHandleSource(e,t))return n[r];return null},i.canPlaySource=function(e,t){var n=i.selectSourceHandler(e,t);return n?n.canHandleSource(e,t):""};["seekable","seeking","duration"].forEach(function(e){var t=this[e];"function"==typeof t&&(this[e]=function(){return this.sourceHandler_&&this.sourceHandler_[e]?this.sourceHandler_[e].apply(this.sourceHandler_,arguments):t.apply(this,arguments)})},i.prototype),i.prototype.setSource=function(e){var t=i.selectSourceHandler(e,this.options_);t||(i.nativeSourceHandler?t=i.nativeSourceHandler:h.error("No source handler found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler),t!==i.nativeSourceHandler&&(this.currentSource_=e),this.sourceHandler_=t.handleSource(e,this,this.options_),this.one("dispose",this.disposeSourceHandler)},i.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null),this.cleanupAutoTextTracks(),this.sourceHandler_&&(this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}},De.registerComponent("Tech",ri),ri.registerTech("Tech",ri),ri.defaultTechOrder_=[];var ii={},ai={},oi={};function si(e,t,n){e.setTimeout(function(){return function n(r,e,i,a,o,s){void 0===r&&(r={});void 0===e&&(e=[]);void 0===o&&(o=[]);void 0===s&&(s=!1);var t=e,l=t[0],u=t.slice(1);if("string"==typeof l)n(r,ii[l],i,a,o,s);else if(l){var c=fi(a,l);if(!c.setSource)return o.push(c),n(r,u,i,a,o,s);c.setSource(p({},r),function(e,t){if(e)return n(r,u,i,a,o,s);o.push(c),n(t,r.type===t.type?u:ii[t.type],i,a,o,s)})}else u.length?n(r,u,i,a,o,s):s?i(r,o):n(r,ii["*"],i,a,o,!0)}(t,ii[t.type],n,e)},1)}function li(e,t,n,r){void 0===r&&(r=null);var i="call"+Ie(n),a=e.reduce(hi(i),r),o=a===oi,s=o?null:t[n](a);return function(e,t,n,r){for(var i=e.length-1;0<=i;i--){var a=e[i];a[t]&&a[t](r,n)}}(e,n,s,o),s}var ui={buffered:1,currentTime:1,duration:1,seekable:1,played:1,paused:1,volume:1},ci={setCurrentTime:1,setVolume:1},di={play:1,pause:1};function hi(n){return function(e,t){return e===oi?oi:t[n]?t[n](e):e}}function fi(e,t){var n=ai[e.id()],r=null;if(null==n)return r=t(e),ai[e.id()]=[[t,r]],r;for(var i=0;i<n.length;i++){var a=n[i],o=a[0],s=a[1];o===t&&(r=s)}return null===r&&(r=t(e),n.push([t,r])),r}function pi(e){void 0===e&&(e="");var t=kt(e);return mi[t.toLowerCase()]||""}var mi={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",m4a:"audio/mp4",mp3:"audio/mpeg",aac:"audio/aac",oga:"audio/ogg",m3u8:"application/x-mpegURL",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",svg:"image/svg+xml",webp:"image/webp"};function gi(e){if(!e.type){var t=pi(e.src);t&&(e.type=t)}return e}var vi=function(u){function e(e,t,n){var r,i=Pe({createEl:!1},t);if(r=u.call(this,e,i,n)||this,t.playerOptions.sources&&0!==t.playerOptions.sources.length)e.src(t.playerOptions.sources);else for(var a=0,o=t.playerOptions.techOrder;a<o.length;a++){var s=Ie(o[a]),l=ri.getTech(s);if(s||(l=De.getComponent(s)),l&&l.isSupported()){e.loadTech_(s);break}}return r}return Le(e,u),e}(De);De.registerComponent("MediaLoader",vi);var yi=function(i){function e(e,t){var n;return(n=i.call(this,e,t)||this).emitTapEvents(),n.enable(),n}Le(e,i);var t=e.prototype;return t.createEl=function(e,t,n){void 0===e&&(e="div"),void 0===t&&(t={}),void 0===n&&(n={}),t=p({innerHTML:'<span aria-hidden="true" class="vjs-icon-placeholder"></span>',className:this.buildCSSClass(),tabIndex:0},t),"button"===e&&h.error("Creating a ClickableComponent with an HTML element of "+e+" is not supported; use a Button instead."),n=p({role:"button"},n),this.tabIndex_=t.tabIndex;var r=i.prototype.createEl.call(this,e,t,n);return this.createControlTextEl(r),r},t.dispose=function(){this.controlTextEl_=null,i.prototype.dispose.call(this)},t.createControlTextEl=function(e){return this.controlTextEl_=_("span",{className:"vjs-control-text"},{"aria-live":"polite"}),e&&e.appendChild(this.controlTextEl_),this.controlText(this.controlText_,e),this.controlTextEl_},t.controlText=function(e,t){if(void 0===t&&(t=this.el()),void 0===e)return this.controlText_||"Need Text";var n=this.localize(e);this.controlText_=e,b(this.controlTextEl_,n),this.nonIconControl||t.setAttribute("title",n)},t.buildCSSClass=function(){return"vjs-control vjs-button "+i.prototype.buildCSSClass.call(this)},t.enable=function(){this.enabled_||(this.enabled_=!0,this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),void 0!==this.tabIndex_&&this.el_.setAttribute("tabIndex",this.tabIndex_),this.on(["tap","click"],this.handleClick),this.on("keydown",this.handleKeyDown))},t.disable=function(){this.enabled_=!1,this.addClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","true"),void 0!==this.tabIndex_&&this.el_.removeAttribute("tabIndex"),this.off("mouseover",this.handleMouseOver),this.off("mouseout",this.handleMouseOut),this.off(["tap","click"],this.handleClick),this.off("keydown",this.handleKeyDown)},t.handleClick=function(){},t.handleKeyDown=function(e){xt.isEventKey(e,"Space")||xt.isEventKey(e,"Enter")?(e.preventDefault(),e.stopPropagation(),this.trigger("click")):i.prototype.handleKeyDown.call(this,e)},e}(De);De.registerComponent("ClickableComponent",yi);var _i=function(r){function e(e,t){var n;return(n=r.call(this,e,t)||this).update(),e.on("posterchange",he(ke(n),n.update)),n}Le(e,r);var t=e.prototype;return t.dispose=function(){this.player().off("posterchange",this.update),r.prototype.dispose.call(this)},t.createEl=function(){return _("div",{className:"vjs-poster",tabIndex:-1})},t.update=function(){var e=this.player().poster();this.setSrc(e),e?this.show():this.hide()},t.setSrc=function(e){var t="";e&&(t='url("'+e+'")'),this.el_.style.backgroundImage=t},t.handleClick=function(){this.player_.controls()&&(this.player_.tech(!0)&&this.player_.tech(!0).focus(),this.player_.paused()?Tt(this.player_.play()):this.player_.pause())},e}(yi);De.registerComponent("PosterImage",_i);var bi="#222",Ei={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function Ti(e,t){var n;if(4===e.length)n=e[1]+e[1]+e[2]+e[2]+e[3]+e[3];else{if(7!==e.length)throw new Error("Invalid color code provided, "+e+"; must be formatted as e.g. #f0e or #f604e2.");n=e.slice(1)}return"rgba("+parseInt(n.slice(0,2),16)+","+parseInt(n.slice(2,4),16)+","+parseInt(n.slice(4,6),16)+","+t+")"}function Ai(e,t,n){try{e.style[t]=n}catch(e){return}}var wi=function(a){function e(n,e,t){var r;r=a.call(this,n,e,t)||this;var i=he(ke(r),r.updateDisplay);return n.on("loadstart",he(ke(r),r.toggleDisplay)),n.on("texttrackchange",i),n.on("loadedmetadata",he(ke(r),r.preselectTrack)),n.ready(he(ke(r),function(){if(n.tech_&&n.tech_.featuresNativeTextTracks)this.hide();else{n.on("fullscreenchange",i),n.on("playerresize",i),y.addEventListener("orientationchange",i),n.on("dispose",function(){return y.removeEventListener("orientationchange",i)});for(var e=this.options_.playerOptions.tracks||[],t=0;t<e.length;t++)this.player_.addRemoteTextTrack(e[t],!0);this.preselectTrack()}})),r}Le(e,a);var t=e.prototype;return t.preselectTrack=function(){for(var e,t,n,r={captions:1,subtitles:1},i=this.player_.textTracks(),a=this.player_.cache_.selectedLanguage,o=0;o<i.length;o++){var s=i[o];a&&a.enabled&&a.language&&a.language===s.language&&s.kind in r?n=s.kind===a.kind?s:n||s:a&&!a.enabled?t=e=n=null:s.default&&("descriptions"!==s.kind||e?s.kind in r&&!t&&(t=s):e=s)}n?n.mode="showing":t?t.mode="showing":e&&(e.mode="showing")},t.toggleDisplay=function(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()},t.createEl=function(){return a.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"},{"aria-live":"off","aria-atomic":"true"})},t.clearDisplay=function(){"function"==typeof y.WebVTT&&y.WebVTT.processCues(y,[],this.el_)},t.updateDisplay=function(){var e=this.player_.textTracks(),t=this.options_.allowMultipleShowingTracks;if(this.clearDisplay(),t){for(var n=[],r=0;r<e.length;++r){var i=e[r];"showing"===i.mode&&n.push(i)}this.updateForTrack(n)}else{for(var a=null,o=null,s=e.length;s--;){var l=e[s];"showing"===l.mode&&("descriptions"===l.kind?a=l:o=l)}o?("off"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","off"),this.updateForTrack(o)):a&&("assertive"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","assertive"),this.updateForTrack(a))}},t.updateDisplayState=function(e){for(var t=this.player_.textTrackSettings.getValues(),n=e.activeCues,r=n.length;r--;){var i=n[r];if(i){var a=i.displayState;if(t.color&&(a.firstChild.style.color=t.color),t.textOpacity&&Ai(a.firstChild,"color",Ti(t.color||"#fff",t.textOpacity)),t.backgroundColor&&(a.firstChild.style.backgroundColor=t.backgroundColor),t.backgroundOpacity&&Ai(a.firstChild,"backgroundColor",Ti(t.backgroundColor||"#000",t.backgroundOpacity)),t.windowColor&&(t.windowOpacity?Ai(a,"backgroundColor",Ti(t.windowColor,t.windowOpacity)):a.style.backgroundColor=t.windowColor),t.edgeStyle&&("dropshadow"===t.edgeStyle?a.firstChild.style.textShadow="2px 2px 3px #222, 2px 2px 4px #222, 2px 2px 5px "+bi:"raised"===t.edgeStyle?a.firstChild.style.textShadow="1px 1px #222, 2px 2px #222, 3px 3px "+bi:"depressed"===t.edgeStyle?a.firstChild.style.textShadow="1px 1px #ccc, 0 1px #ccc, -1px -1px #222, 0 -1px "+bi:"uniform"===t.edgeStyle&&(a.firstChild.style.textShadow="0 0 4px #222, 0 0 4px #222, 0 0 4px #222, 0 0 4px "+bi)),t.fontPercent&&1!==t.fontPercent){var o=y.parseFloat(a.style.fontSize);a.style.fontSize=o*t.fontPercent+"px",a.style.height="auto",a.style.top="auto",a.style.bottom="2px"}t.fontFamily&&"default"!==t.fontFamily&&("small-caps"===t.fontFamily?a.firstChild.style.fontVariant="small-caps":a.firstChild.style.fontFamily=Ei[t.fontFamily])}}},t.updateForTrack=function(e){if(Array.isArray(e)||(e=[e]),"function"==typeof y.WebVTT&&!e.every(function(e){return!e.activeCues})){for(var t=[],n=0;n<e.length;++n)for(var r=e[n],i=0;i<r.activeCues.length;++i)t.push(r.activeCues[i]);y.WebVTT.processCues(y,t,this.el_);for(var a=0;a<e.length;++a){for(var o=e[a],s=0;s<o.activeCues.length;++s){var l=o.activeCues[s].displayState;A(l,"vjs-text-track-cue"),A(l,"vjs-text-track-cue-"+(o.language?o.language:a))}this.player_.textTrackSettings&&this.updateDisplayState(o)}}},e}(De);De.registerComponent("TextTrackDisplay",wi);var Si=function(i){function e(){return i.apply(this,arguments)||this}return Le(e,i),e.prototype.createEl=function(){var e=this.player_.isAudio(),t=this.localize(e?"Audio Player":"Video Player"),n=_("span",{className:"vjs-control-text",innerHTML:this.localize("{1} is loading.",[t])}),r=i.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner",dir:"ltr"});return r.appendChild(n),r},e}(De);De.registerComponent("LoadingSpinner",Si);var Ci=function(t){function e(){return t.apply(this,arguments)||this}Le(e,t);var n=e.prototype;return n.createEl=function(e,t,n){void 0===t&&(t={}),void 0===n&&(n={}),t=p({innerHTML:'<span aria-hidden="true" class="vjs-icon-placeholder"></span>',className:this.buildCSSClass()},t),n=p({type:"button"},n);var r=De.prototype.createEl.call(this,"button",t,n);return this.createControlTextEl(r),r},n.addChild=function(e,t){void 0===t&&(t={});var n=this.constructor.name;return h.warn("Adding an actionable (user controllable) child to a Button ("+n+") is not supported; use a ClickableComponent instead."),De.prototype.addChild.call(this,e,t)},n.enable=function(){t.prototype.enable.call(this),this.el_.removeAttribute("disabled")},n.disable=function(){t.prototype.disable.call(this),this.el_.setAttribute("disabled","disabled")},n.handleKeyDown=function(e){xt.isEventKey(e,"Space")||xt.isEventKey(e,"Enter")?e.stopPropagation():t.prototype.handleKeyDown.call(this,e)},e}(yi);De.registerComponent("Button",Ci);var xi=function(r){function e(e,t){var n;return(n=r.call(this,e,t)||this).mouseused_=!1,n.on("mousedown",n.handleMouseDown),n}Le(e,r);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-big-play-button"},t.handleClick=function(e){var t=this.player_.play();if(this.mouseused_&&e.clientX&&e.clientY)return Tt(t),void(this.player_.tech(!0)&&this.player_.tech(!0).focus());var n=this.player_.getChild("controlBar"),r=n&&n.getChild("playToggle");if(r){function i(){return r.focus()}Et(t)?t.then(i,function(){}):this.setTimeout(i,1)}else this.player_.tech(!0).focus()},t.handleKeyDown=function(e){this.mouseused_=!1,r.prototype.handleKeyDown.call(this,e)},t.handleMouseDown=function(){this.mouseused_=!0},e}(Ci);xi.prototype.controlText_="Play Video",De.registerComponent("BigPlayButton",xi);var Mi=function(r){function e(e,t){var n;return(n=r.call(this,e,t)||this).controlText(t&&t.controlText||n.localize("Close")),n}Le(e,r);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-close-button "+r.prototype.buildCSSClass.call(this)},t.handleClick=function(){this.trigger({type:"close",bubbles:!1})},t.handleKeyDown=function(e){xt.isEventKey(e,"Esc")?(e.preventDefault(),e.stopPropagation(),this.trigger("click")):r.prototype.handleKeyDown.call(this,e)},e}(Ci);De.registerComponent("CloseButton",Mi);var Ri=function(r){function e(e,t){var n;return void 0===t&&(t={}),n=r.call(this,e,t)||this,t.replay=void 0===t.replay||t.replay,n.on(e,"play",n.handlePlay),n.on(e,"pause",n.handlePause),t.replay&&n.on(e,"ended",n.handleEnded),n}Le(e,r);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-play-control "+r.prototype.buildCSSClass.call(this)},t.handleClick=function(){this.player_.paused()?this.player_.play():this.player_.pause()},t.handleSeeked=function(e){this.removeClass("vjs-ended"),this.player_.paused()?this.handlePause(e):this.handlePlay(e)},t.handlePlay=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.controlText("Pause")},t.handlePause=function(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.controlText("Play")},t.handleEnded=function(){this.removeClass("vjs-playing"),this.addClass("vjs-ended"),this.controlText("Replay"),this.one(this.player_,"seeked",this.handleSeeked)},e}(Ci);Ri.prototype.controlText_="Play",De.registerComponent("PlayToggle",Ri);function Ii(e,t){e=e<0?0:e;var n=Math.floor(e%60),r=Math.floor(e/60%60),i=Math.floor(e/3600),a=Math.floor(t/60%60),o=Math.floor(t/3600);return!isNaN(e)&&e!==1/0||(i=r=n="-"),(i=0<i||0<o?i+":":"")+(r=((i||10<=a)&&r<10?"0"+r:r)+":")+(n=n<10?"0"+n:n)}var Pi=Ii;function Di(e,t){return void 0===t&&(t=e),Pi(e,t)}var Li=function(r){function e(e,t){var n;return(n=r.call(this,e,t)||this).throttledUpdateContent=fe(he(ke(n),n.updateContent),30),n.on(e,"timeupdate",n.throttledUpdateContent),n}Le(e,r);var t=e.prototype;return t.createEl=function(){var e=this.buildCSSClass(),t=r.prototype.createEl.call(this,"div",{className:e+" vjs-time-control vjs-control",innerHTML:'<span class="vjs-control-text" role="presentation">'+this.localize(this.labelText_)+" </span>"});return this.contentEl_=_("span",{className:e+"-display"},{"aria-live":"off",role:"presentation"}),this.updateTextNode_(),t.appendChild(this.contentEl_),t},t.dispose=function(){this.contentEl_=null,this.textNode_=null,r.prototype.dispose.call(this)},t.updateTextNode_=function(){if(this.contentEl_){for(;this.contentEl_.firstChild;)this.contentEl_.removeChild(this.contentEl_.firstChild);this.textNode_=d.createTextNode(this.formattedTime_||this.formatTime_(0)),this.contentEl_.appendChild(this.textNode_)}},t.formatTime_=function(e){return Di(e)},t.updateFormattedTime_=function(e){var t=this.formatTime_(e);t!==this.formattedTime_&&(this.formattedTime_=t,this.requestAnimationFrame(this.updateTextNode_))},t.updateContent=function(){},e}(De);Li.prototype.labelText_="Time",Li.prototype.controlText_="Time",De.registerComponent("TimeDisplay",Li);var Oi=function(r){function e(e,t){var n;return(n=r.call(this,e,t)||this).on(e,"ended",n.handleEnded),n}Le(e,r);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-current-time"},t.updateContent=function(){var e=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();this.updateFormattedTime_(e)},t.handleEnded=function(){this.player_.duration()&&this.updateFormattedTime_(this.player_.duration())},e}(Li);Oi.prototype.labelText_="Current Time",Oi.prototype.controlText_="Current Time",De.registerComponent("CurrentTimeDisplay",Oi);var Ni=function(r){function e(e,t){var n;return(n=r.call(this,e,t)||this).on(e,"durationchange",n.updateContent),n.on(e,"loadstart",n.updateContent),n.on(e,"loadedmetadata",n.throttledUpdateContent),n}Le(e,r);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-duration"},t.updateContent=function(){var e=this.player_.duration();this.duration_!==e&&(this.duration_=e,this.updateFormattedTime_(e))},e}(Li);Ni.prototype.labelText_="Duration",Ni.prototype.controlText_="Duration",De.registerComponent("DurationDisplay",Ni);var ki=function(e){function t(){return e.apply(this,arguments)||this}return Le(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-time-control vjs-time-divider",innerHTML:"<div><span>/</span></div>"},{"aria-hidden":!0})},t}(De);De.registerComponent("TimeDivider",ki);var Bi=function(r){function e(e,t){var n;return(n=r.call(this,e,t)||this).on(e,"durationchange",n.throttledUpdateContent),n.on(e,"ended",n.handleEnded),n}Le(e,r);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-remaining-time"},t.createEl=function(){var e=r.prototype.createEl.call(this);return e.insertBefore(_("span",{},{"aria-hidden":!0},"-"),this.contentEl_),e},t.updateContent=function(){"number"==typeof this.player_.duration()&&(this.player_.remainingTimeDisplay?this.updateFormattedTime_(this.player_.remainingTimeDisplay()):this.updateFormattedTime_(this.player_.remainingTime()))},t.handleEnded=function(){this.player_.duration()&&this.updateFormattedTime_(0)},e}(Li);Bi.prototype.labelText_="Remaining Time",Bi.prototype.controlText_="Remaining Time",De.registerComponent("RemainingTimeDisplay",Bi);var Fi=function(r){function e(e,t){var n;return(n=r.call(this,e,t)||this).updateShowing(),n.on(n.player(),"durationchange",n.updateShowing),n}Le(e,r);var t=e.prototype;return t.createEl=function(){var e=r.prototype.createEl.call(this,"div",{className:"vjs-live-control vjs-control"});return this.contentEl_=_("div",{className:"vjs-live-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Stream Type")+" </span>"+this.localize("LIVE")},{"aria-live":"off"}),e.appendChild(this.contentEl_),e},t.dispose=function(){this.contentEl_=null,r.prototype.dispose.call(this)},t.updateShowing=function(){this.player().duration()===1/0?this.show():this.hide()},e}(De);De.registerComponent("LiveDisplay",Fi);var ji=function(r){function e(e,t){var n;return(n=r.call(this,e,t)||this).updateLiveEdgeStatus(),n.player_.liveTracker&&n.on(n.player_.liveTracker,"liveedgechange",n.updateLiveEdgeStatus),n}Le(e,r);var t=e.prototype;return t.createEl=function(){var e=r.prototype.createEl.call(this,"button",{className:"vjs-seek-to-live-control vjs-control"});return this.textEl_=_("span",{className:"vjs-seek-to-live-text",innerHTML:this.localize("LIVE")},{"aria-hidden":"true"}),e.appendChild(this.textEl_),e},t.updateLiveEdgeStatus=function(){!this.player_.liveTracker||this.player_.liveTracker.atLiveEdge()?(this.setAttribute("aria-disabled",!0),this.addClass("vjs-at-live-edge"),this.controlText("Seek to live, currently playing live")):(this.setAttribute("aria-disabled",!1),this.removeClass("vjs-at-live-edge"),this.controlText("Seek to live, currently behind live"))},t.handleClick=function(){this.player_.liveTracker.seekToLiveEdge()},t.dispose=function(){this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatus),this.textEl_=null,r.prototype.dispose.call(this)},e}(Ci);ji.prototype.controlText_="Seek to live, currently playing live",De.registerComponent("SeekToLive",ji);var Ui=function(r){function e(e,t){var n;return(n=r.call(this,e,t)||this).bar=n.getChild(n.options_.barName),n.vertical(!!n.options_.vertical),n.enable(),n}Le(e,r);var t=e.prototype;return t.enabled=function(){return this.enabled_},t.enable=function(){this.enabled()||(this.on("mousedown",this.handleMouseDown),this.on("touchstart",this.handleMouseDown),this.on("keydown",this.handleKeyDown),this.on("click",this.handleClick),this.on(this.player_,"controlsvisible",this.update),this.playerEvent&&this.on(this.player_,this.playerEvent,this.update),this.removeClass("disabled"),this.setAttribute("tabindex",0),this.enabled_=!0)},t.disable=function(){if(this.enabled()){var e=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown),this.off("touchstart",this.handleMouseDown),this.off("keydown",this.handleKeyDown),this.off("click",this.handleClick),this.off(this.player_,"controlsvisible",this.update),this.off(e,"mousemove",this.handleMouseMove),this.off(e,"mouseup",this.handleMouseUp),this.off(e,"touchmove",this.handleMouseMove),this.off(e,"touchend",this.handleMouseUp),this.removeAttribute("tabindex"),this.addClass("disabled"),this.playerEvent&&this.off(this.player_,this.playerEvent,this.update),this.enabled_=!1}},t.createEl=function(e,t,n){return void 0===t&&(t={}),void 0===n&&(n={}),t.className=t.className+" vjs-slider",t=p({tabIndex:0},t),n=p({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},n),r.prototype.createEl.call(this,e,t,n)},t.handleMouseDown=function(e){var t=this.bar.el_.ownerDocument;"mousedown"===e.type&&e.preventDefault(),"touchstart"!==e.type||et||e.preventDefault(),P(),this.addClass("vjs-sliding"),this.trigger("slideractive"),this.on(t,"mousemove",this.handleMouseMove),this.on(t,"mouseup",this.handleMouseUp),this.on(t,"touchmove",this.handleMouseMove),this.on(t,"touchend",this.handleMouseUp),this.handleMouseMove(e)},t.handleMouseMove=function(){},t.handleMouseUp=function(){var e=this.bar.el_.ownerDocument;D(),this.removeClass("vjs-sliding"),this.trigger("sliderinactive"),this.off(e,"mousemove",this.handleMouseMove),this.off(e,"mouseup",this.handleMouseUp),this.off(e,"touchmove",this.handleMouseMove),this.off(e,"touchend",this.handleMouseUp),this.update()},t.update=function(){if(this.el_){var e=this.getPercent(),t=this.bar;if(t){("number"!=typeof e||e!=e||e<0||e===1/0)&&(e=0);var n=(100*e).toFixed(2)+"%",r=t.el().style,i=this.vertical()?"height":"width";return r[i]!==n&&(r[i]=n),e}}},t.calculateDistance=function(e){var t=N(this.el_,e);return this.vertical()?t.y:t.x},t.handleKeyDown=function(e){xt.isEventKey(e,"Left")||xt.isEventKey(e,"Down")?(e.preventDefault(),e.stopPropagation(),this.stepBack()):xt.isEventKey(e,"Right")||xt.isEventKey(e,"Up")?(e.preventDefault(),e.stopPropagation(),this.stepForward()):r.prototype.handleKeyDown.call(this,e)},t.handleClick=function(e){e.stopPropagation(),e.preventDefault()},t.vertical=function(e){if(void 0===e)return this.vertical_||!1;this.vertical_=!!e,this.vertical_?this.addClass("vjs-slider-vertical"):this.addClass("vjs-slider-horizontal")},e}(De);De.registerComponent("Slider",Ui);var Hi=function(r){function e(e,t){var n;return(n=r.call(this,e,t)||this).partEls_=[],n.on(e,"progress",n.update),n}Le(e,r);var t=e.prototype;return t.createEl=function(){return r.prototype.createEl.call(this,"div",{className:"vjs-load-progress",innerHTML:'<span class="vjs-control-text"><span>'+this.localize("Loaded")+'</span>: <span class="vjs-control-text-loaded-percentage">0%</span></span>'})},t.dispose=function(){this.partEls_=null,r.prototype.dispose.call(this)},t.update=function(){function e(e,t,n){var r=e/t||0;return r=100*(1<=r?1:r),n&&(r=r.toFixed(2)),r+"%"}var t=this.player_.liveTracker,n=this.player_.buffered(),r=t&&t.isLive()?t.seekableEnd():this.player_.duration(),i=this.player_.bufferedEnd(),a=this.partEls_,o=this.$(".vjs-control-text-loaded-percentage");this.el_.style.width=e(i,r),b(o,e(i,r,!0));for(var s=0;s<n.length;s++){var l=n.start(s),u=n.end(s),c=a[s];c||(c=this.el_.appendChild(_()),a[s]=c),c.style.left=e(l,i),c.style.width=e(u-l,i)}for(var d=a.length;d>n.length;d--)this.el_.removeChild(a[d-1]);a.length=n.length},e}(De);De.registerComponent("LoadProgressBar",Hi);var Gi=function(r){function e(e,t){var n;return(n=r.call(this,e,t)||this).update=fe(he(ke(n),n.update),30),n}Le(e,r);var t=e.prototype;return t.createEl=function(){return r.prototype.createEl.call(this,"div",{className:"vjs-time-tooltip"},{"aria-hidden":"true"})},t.update=function(e,t,n){var r=L(this.el_),i=L(this.player_.el()),a=e.width*t;if(i&&r){var o=e.left-i.left+a,s=e.width-a+(i.right-e.right),l=r.width/2;o<l?l+=l-o:s<l&&(l=s),l<0?l=0:l>r.width&&(l=r.width),this.el_.style.right="-"+l+"px",this.write(n)}},t.write=function(e){b(this.el_,e)},t.updateTime=function(i,a,o,s){var l=this;this.rafId_&&this.cancelAnimationFrame(this.rafId_),this.rafId_=this.requestAnimationFrame(function(){var e,t=l.player_.duration();if(l.player_.liveTracker&&l.player_.liveTracker.isLive()){var n=l.player_.liveTracker.liveWindow(),r=n-a*n;e=(r<1?"":"-")+Di(r,n)}else e=Di(o,t);l.update(i,a,e),s&&s()})},e}(De);De.registerComponent("TimeTooltip",Gi);var Vi=function(r){function e(e,t){var n;return(n=r.call(this,e,t)||this).update=fe(he(ke(n),n.update),30),n}Le(e,r);var t=e.prototype;return t.createEl=function(){return r.prototype.createEl.call(this,"div",{className:"vjs-play-progress vjs-slider-bar"},{"aria-hidden":"true"})},t.update=function(e,t){var n=this.getChild("timeTooltip");if(n){var r=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();n.updateTime(e,t,r)}},e}(De);Vi.prototype.options_={children:[]},Ye||Xe||Vi.prototype.options_.children.push("timeTooltip"),De.registerComponent("PlayProgressBar",Vi);var zi=function(r){function e(e,t){var n;return(n=r.call(this,e,t)||this).update=fe(he(ke(n),n.update),30),n}Le(e,r);var t=e.prototype;return t.createEl=function(){return r.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"})},t.update=function(e,t){var n=this,r=t*this.player_.duration();this.getChild("timeTooltip").updateTime(e,t,r,function(){n.el_.style.left=e.width*t+"px"})},e}(De);zi.prototype.options_={children:["timeTooltip"]},De.registerComponent("MouseTimeDisplay",zi);var Wi=function(r){function e(e,t){var n;return(n=r.call(this,e,t)||this).setEventHandlers_(),n}Le(e,r);var t=e.prototype;return t.setEventHandlers_=function(){this.update=fe(he(this,this.update),30),this.on(this.player_,"timeupdate",this.update),this.on(this.player_,"ended",this.handleEnded),this.on(this.player_,"durationchange",this.update),this.player_.liveTracker&&this.on(this.player_.liveTracker,"liveedgechange",this.update),this.updateInterval=null,this.on(this.player_,["playing"],this.enableInterval_),this.on(this.player_,["ended","pause","waiting"],this.disableInterval_),"hidden"in d&&"visibilityState"in d&&this.on(d,"visibilitychange",this.toggleVisibility_)},t.toggleVisibility_=function(e){d.hidden?this.disableInterval_(e):(this.enableInterval_(),this.requestAnimationFrame(this.update))},t.enableInterval_=function(){var e=this;this.clearInterval(this.updateInterval),this.updateInterval=this.setInterval(function(){e.requestAnimationFrame(e.update)},30)},t.disableInterval_=function(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&"ended"!==e.type||this.clearInterval(this.updateInterval)},t.createEl=function(){return r.prototype.createEl.call(this,"div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})},t.update_=function(e,t){var n=this.player_.liveTracker,r=this.player_.duration();n&&n.isLive()&&(r=this.player_.liveTracker.liveCurrentTime()),this.el_.setAttribute("aria-valuenow",(100*t).toFixed(2)),this.el_.setAttribute("aria-valuetext",this.localize("progress bar timing: currentTime={1} duration={2}",[Di(e,r),Di(r,r)],"{1} of {2}")),this.bar&&this.bar.update(L(this.el_),t)},t.update=function(){if(null!==this.el().offsetParent){var e=r.prototype.update.call(this);return this.update_(this.getCurrentTime_(),e),e}},t.getCurrentTime_=function(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()},t.handleEnded=function(){this.update_(this.player_.duration(),1)},t.getPercent=function(){var e,t=this.getCurrentTime_(),n=this.player_.liveTracker;return n&&n.isLive()?(e=(t-n.seekableStart())/n.liveWindow(),n.atLiveEdge()&&(e=1)):e=t/this.player_.duration(),1<=e?1:e||0},t.handleMouseDown=function(e){H(e)&&(e.stopPropagation(),this.player_.scrubbing(!0),this.videoWasPlaying=!this.player_.paused(),this.player_.pause(),r.prototype.handleMouseDown.call(this,e))},t.handleMouseMove=function(e){if(H(e)){var t,n=this.calculateDistance(e),r=this.player_.liveTracker;if(r&&r.isLive()){var i=r.seekableStart(),a=r.liveCurrentTime();if(a<=(t=i+n*r.liveWindow())&&(t=a),t<=i&&(t=i+.1),t===1/0)return}else(t=n*this.player_.duration())===this.player_.duration()&&(t-=.1);this.player_.currentTime(t)}},t.enable=function(){r.prototype.enable.call(this);var e=this.getChild("mouseTimeDisplay");e&&e.show()},t.disable=function(){r.prototype.disable.call(this);var e=this.getChild("mouseTimeDisplay");e&&e.hide()},t.handleMouseUp=function(e){r.prototype.handleMouseUp.call(this,e),e&&e.stopPropagation(),this.player_.scrubbing(!1),this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0}),this.videoWasPlaying&&Tt(this.player_.play())},t.stepForward=function(){this.player_.currentTime(this.player_.currentTime()+5)},t.stepBack=function(){this.player_.currentTime(this.player_.currentTime()-5)},t.handleAction=function(){this.player_.paused()?this.player_.play():this.player_.pause()},t.handleKeyDown=function(e){if(xt.isEventKey(e,"Space")||xt.isEventKey(e,"Enter"))e.preventDefault(),e.stopPropagation(),this.handleAction(e);else if(xt.isEventKey(e,"Home"))e.preventDefault(),e.stopPropagation(),this.player_.currentTime(0);else if(xt.isEventKey(e,"End"))e.preventDefault(),e.stopPropagation(),this.player_.currentTime(this.player_.duration());else if(/^[0-9]$/.test(xt(e))){e.preventDefault(),e.stopPropagation();var t=10*(xt.codes[xt(e)]-xt.codes[0])/100;this.player_.currentTime(this.player_.duration()*t)}else xt.isEventKey(e,"PgDn")?(e.preventDefault(),e.stopPropagation(),this.player_.currentTime(this.player_.currentTime()-60)):xt.isEventKey(e,"PgUp")?(e.preventDefault(),e.stopPropagation(),this.player_.currentTime(this.player_.currentTime()+60)):r.prototype.handleKeyDown.call(this,e)},e}(Ui);Wi.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"},Ye||Xe||Wi.prototype.options_.children.splice(1,0,"mouseTimeDisplay"),De.registerComponent("SeekBar",Wi);var qi=function(r){function e(e,t){var n;return(n=r.call(this,e,t)||this).handleMouseMove=fe(he(ke(n),n.handleMouseMove),30),n.throttledHandleMouseSeek=fe(he(ke(n),n.handleMouseSeek),30),n.enable(),n}Le(e,r);var t=e.prototype;return t.createEl=function(){return r.prototype.createEl.call(this,"div",{className:"vjs-progress-control vjs-control"})},t.handleMouseMove=function(e){var t=this.getChild("seekBar");if(t){var n=t.getChild("mouseTimeDisplay"),r=t.el(),i=L(r),a=N(r,e).x;1<a?a=1:a<0&&(a=0),n&&n.update(i,a)}},t.handleMouseSeek=function(e){var t=this.getChild("seekBar");t&&t.handleMouseMove(e)},t.enabled=function(){return this.enabled_},t.disable=function(){this.children().forEach(function(e){return e.disable&&e.disable()}),this.enabled()&&(this.off(["mousedown","touchstart"],this.handleMouseDown),this.off(this.el_,"mousemove",this.handleMouseMove),this.handleMouseUp(),this.addClass("disabled"),this.enabled_=!1)},t.enable=function(){this.children().forEach(function(e){return e.enable&&e.enable()}),this.enabled()||(this.on(["mousedown","touchstart"],this.handleMouseDown),this.on(this.el_,"mousemove",this.handleMouseMove),this.removeClass("disabled"),this.enabled_=!0)},t.handleMouseDown=function(e){var t=this.el_.ownerDocument,n=this.getChild("seekBar");n&&n.handleMouseDown(e),this.on(t,"mousemove",this.throttledHandleMouseSeek),this.on(t,"touchmove",this.throttledHandleMouseSeek),this.on(t,"mouseup",this.handleMouseUp),this.on(t,"touchend",this.handleMouseUp)},t.handleMouseUp=function(e){var t=this.el_.ownerDocument,n=this.getChild("seekBar");n&&n.handleMouseUp(e),this.off(t,"mousemove",this.throttledHandleMouseSeek),this.off(t,"touchmove",this.throttledHandleMouseSeek),this.off(t,"mouseup",this.handleMouseUp),this.off(t,"touchend",this.handleMouseUp)},e}(De);qi.prototype.options_={children:["seekBar"]},De.registerComponent("ProgressControl",qi);var Yi=function(r){function e(e,t){var n;return(n=r.call(this,e,t)||this).on(e,["enterpictureinpicture","leavepictureinpicture"],n.handlePictureInPictureChange),d.pictureInPictureEnabled||n.disable(),n}Le(e,r);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-picture-in-picture-control "+r.prototype.buildCSSClass.call(this)},t.handlePictureInPictureChange=function(){this.player_.isInPictureInPicture()?this.controlText("Exit Picture-in-Picture"):this.controlText("Picture-in-Picture")},t.handleClick=function(){this.player_.isInPictureInPicture()?this.player_.exitPictureInPicture():this.player_.requestPictureInPicture()},e}(Ci);Yi.prototype.controlText_="Picture-in-Picture",De.registerComponent("PictureInPictureToggle",Yi);var Ki=function(r){function e(e,t){var n;return(n=r.call(this,e,t)||this).on(e,"fullscreenchange",n.handleFullscreenChange),!1===d[e.fsApi_.fullscreenEnabled]&&n.disable(),n}Le(e,r);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-fullscreen-control "+r.prototype.buildCSSClass.call(this)},t.handleFullscreenChange=function(){this.player_.isFullscreen()?this.controlText("Non-Fullscreen"):this.controlText("Fullscreen")},t.handleClick=function(){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()},e}(Ci);Ki.prototype.controlText_="Fullscreen",De.registerComponent("FullscreenToggle",Ki);var Xi=function(e){function t(){return e.apply(this,arguments)||this}return Le(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-volume-level",innerHTML:'<span class="vjs-control-text"></span>'})},t}(De);De.registerComponent("VolumeLevel",Xi);var Qi=function(r){function e(e,t){var n;return(n=r.call(this,e,t)||this).on("slideractive",n.updateLastVolume_),n.on(e,"volumechange",n.updateARIAAttributes),e.ready(function(){return n.updateARIAAttributes()}),n}Le(e,r);var t=e.prototype;return t.createEl=function(){return r.prototype.createEl.call(this,"div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})},t.handleMouseDown=function(e){H(e)&&r.prototype.handleMouseDown.call(this,e)},t.handleMouseMove=function(e){H(e)&&(this.checkMuted(),this.player_.volume(this.calculateDistance(e)))},t.checkMuted=function(){this.player_.muted()&&this.player_.muted(!1)},t.getPercent=function(){return this.player_.muted()?0:this.player_.volume()},t.stepForward=function(){this.checkMuted(),this.player_.volume(this.player_.volume()+.1)},t.stepBack=function(){this.checkMuted(),this.player_.volume(this.player_.volume()-.1)},t.updateARIAAttributes=function(){var e=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",e),this.el_.setAttribute("aria-valuetext",e+"%")},t.volumeAsPercentage_=function(){return Math.round(100*this.player_.volume())},t.updateLastVolume_=function(){var e=this,t=this.player_.volume();this.one("sliderinactive",function(){0===e.player_.volume()&&e.player_.lastVolume_(t)})},e}(Ui);Qi.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"},Qi.prototype.playerEvent="volumechange",De.registerComponent("VolumeBar",Qi);var Zi=function(r){function e(e,t){var n;return void 0===t&&(t={}),t.vertical=t.vertical||!1,void 0!==t.volumeBar&&!s(t.volumeBar)||(t.volumeBar=t.volumeBar||{},t.volumeBar.vertical=t.vertical),function(e,t){t.tech_&&!t.tech_.featuresVolumeControl&&e.addClass("vjs-hidden"),e.on(t,"loadstart",function(){t.tech_.featuresVolumeControl?e.removeClass("vjs-hidden"):e.addClass("vjs-hidden")})}(ke(n=r.call(this,e,t)||this),e),n.throttledHandleMouseMove=fe(he(ke(n),n.handleMouseMove),30),n.on("mousedown",n.handleMouseDown),n.on("touchstart",n.handleMouseDown),n.on(n.volumeBar,["focus","slideractive"],function(){n.volumeBar.addClass("vjs-slider-active"),n.addClass("vjs-slider-active"),n.trigger("slideractive")}),n.on(n.volumeBar,["blur","sliderinactive"],function(){n.volumeBar.removeClass("vjs-slider-active"),n.removeClass("vjs-slider-active"),n.trigger("sliderinactive")}),n}Le(e,r);var t=e.prototype;return t.createEl=function(){var e="vjs-volume-horizontal";return this.options_.vertical&&(e="vjs-volume-vertical"),r.prototype.createEl.call(this,"div",{className:"vjs-volume-control vjs-control "+e})},t.handleMouseDown=function(){var e=this.el_.ownerDocument;this.on(e,"mousemove",this.throttledHandleMouseMove),this.on(e,"touchmove",this.throttledHandleMouseMove),this.on(e,"mouseup",this.handleMouseUp),this.on(e,"touchend",this.handleMouseUp)},t.handleMouseUp=function(){var e=this.el_.ownerDocument;this.off(e,"mousemove",this.throttledHandleMouseMove),this.off(e,"touchmove",this.throttledHandleMouseMove),this.off(e,"mouseup",this.handleMouseUp),this.off(e,"touchend",this.handleMouseUp)},t.handleMouseMove=function(e){this.volumeBar.handleMouseMove(e)},e}(De);Zi.prototype.options_={children:["volumeBar"]},De.registerComponent("VolumeControl",Zi);var Ji=function(r){function e(e,t){var n;return function(e,t){t.tech_&&!t.tech_.featuresMuteControl&&e.addClass("vjs-hidden"),e.on(t,"loadstart",function(){t.tech_.featuresMuteControl?e.removeClass("vjs-hidden"):e.addClass("vjs-hidden")})}(ke(n=r.call(this,e,t)||this),e),n.on(e,["loadstart","volumechange"],n.update),n}Le(e,r);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-mute-control "+r.prototype.buildCSSClass.call(this)},t.handleClick=function(){var e=this.player_.volume(),t=this.player_.lastVolume_();if(0===e){var n=t<.1?.1:t;this.player_.volume(n),this.player_.muted(!1)}else this.player_.muted(!this.player_.muted())},t.update=function(){this.updateIcon_(),this.updateControlText_()},t.updateIcon_=function(){var e=this.player_.volume(),t=3;Ye&&this.player_.tech_&&this.player_.tech_.el_&&this.player_.muted(this.player_.tech_.el_.muted),0===e||this.player_.muted()?t=0:e<.33?t=1:e<.67&&(t=2);for(var n=0;n<4;n++)w(this.el_,"vjs-vol-"+n);A(this.el_,"vjs-vol-"+t)},t.updateControlText_=function(){var e=this.player_.muted()||0===this.player_.volume()?"Unmute":"Mute";this.controlText()!==e&&this.controlText(e)},e}(Ci);Ji.prototype.controlText_="Mute",De.registerComponent("MuteToggle",Ji);var $i=function(r){function e(e,t){var n;return void 0===t&&(t={}),void 0!==t.inline?t.inline=t.inline:t.inline=!0,void 0!==t.volumeControl&&!s(t.volumeControl)||(t.volumeControl=t.volumeControl||{},t.volumeControl.vertical=!t.inline),(n=r.call(this,e,t)||this).on(e,["loadstart"],n.volumePanelState_),n.on(n.muteToggle,"keyup",n.handleKeyPress),n.on(n.volumeControl,"keyup",n.handleVolumeControlKeyUp),n.on("keydown",n.handleKeyPress),n.on("mouseover",n.handleMouseOver),n.on("mouseout",n.handleMouseOut),n.on(n.volumeControl,["slideractive"],n.sliderActive_),n.on(n.volumeControl,["sliderinactive"],n.sliderInactive_),n}Le(e,r);var t=e.prototype;return t.sliderActive_=function(){this.addClass("vjs-slider-active")},t.sliderInactive_=function(){this.removeClass("vjs-slider-active")},t.volumePanelState_=function(){this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-hidden"),this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-mute-toggle-only")},t.createEl=function(){var e="vjs-volume-panel-horizontal";return this.options_.inline||(e="vjs-volume-panel-vertical"),r.prototype.createEl.call(this,"div",{className:"vjs-volume-panel vjs-control "+e})},t.dispose=function(){this.handleMouseOut(),r.prototype.dispose.call(this)},t.handleVolumeControlKeyUp=function(e){xt.isEventKey(e,"Esc")&&this.muteToggle.focus()},t.handleMouseOver=function(){this.addClass("vjs-hover"),se(d,"keyup",he(this,this.handleKeyPress))},t.handleMouseOut=function(){this.removeClass("vjs-hover"),le(d,"keyup",he(this,this.handleKeyPress))},t.handleKeyPress=function(e){xt.isEventKey(e,"Esc")&&this.handleMouseOut()},e}(De);$i.prototype.options_={children:["muteToggle","volumeControl"]},De.registerComponent("VolumePanel",$i);var ea=function(r){function e(e,t){var n;return n=r.call(this,e,t)||this,t&&(n.menuButton_=t.menuButton),n.focusedChild_=-1,n.on("keydown",n.handleKeyDown),n.boundHandleBlur_=he(ke(n),n.handleBlur),n.boundHandleTapClick_=he(ke(n),n.handleTapClick),n}Le(e,r);var t=e.prototype;return t.addEventListenerForItem=function(e){e instanceof De&&(this.on(e,"blur",this.boundHandleBlur_),this.on(e,["tap","click"],this.boundHandleTapClick_))},t.removeEventListenerForItem=function(e){e instanceof De&&(this.off(e,"blur",this.boundHandleBlur_),this.off(e,["tap","click"],this.boundHandleTapClick_))},t.removeChild=function(e){"string"==typeof e&&(e=this.getChild(e)),this.removeEventListenerForItem(e),r.prototype.removeChild.call(this,e)},t.addItem=function(e){var t=this.addChild(e);t&&this.addEventListenerForItem(t)},t.createEl=function(){var e=this.options_.contentElType||"ul";this.contentEl_=_(e,{className:"vjs-menu-content"}),this.contentEl_.setAttribute("role","menu");var t=r.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"});return t.appendChild(this.contentEl_),se(t,"click",function(e){e.preventDefault(),e.stopImmediatePropagation()}),t},t.dispose=function(){this.contentEl_=null,this.boundHandleBlur_=null,this.boundHandleTapClick_=null,r.prototype.dispose.call(this)},t.handleBlur=function(e){var t=e.relatedTarget||d.activeElement;if(!this.children().some(function(e){return e.el()===t})){var n=this.menuButton_;n&&n.buttonPressed_&&t!==n.el().firstChild&&n.unpressButton()}},t.handleTapClick=function(t){if(this.menuButton_){this.menuButton_.unpressButton();var e=this.children();if(!Array.isArray(e))return;var n=e.filter(function(e){return e.el()===t.target})[0];if(!n)return;"CaptionSettingsMenuItem"!==n.name()&&this.menuButton_.focus()}},t.handleKeyDown=function(e){xt.isEventKey(e,"Left")||xt.isEventKey(e,"Down")?(e.preventDefault(),e.stopPropagation(),this.stepForward()):(xt.isEventKey(e,"Right")||xt.isEventKey(e,"Up"))&&(e.preventDefault(),e.stopPropagation(),this.stepBack())},t.stepForward=function(){var e=0;void 0!==this.focusedChild_&&(e=this.focusedChild_+1),this.focus(e)},t.stepBack=function(){var e=0;void 0!==this.focusedChild_&&(e=this.focusedChild_-1),this.focus(e)},t.focus=function(e){void 0===e&&(e=0);var t=this.children().slice();t.length&&t[0].className&&/vjs-menu-title/.test(t[0].className)&&t.shift(),0<t.length&&(e<0?e=0:e>=t.length&&(e=t.length-1),t[this.focusedChild_=e].el_.focus())},e}(De);De.registerComponent("Menu",ea);var ta=function(i){function e(e,t){var n;void 0===t&&(t={}),(n=i.call(this,e,t)||this).menuButton_=new Ci(e,t),n.menuButton_.controlText(n.controlText_),n.menuButton_.el_.setAttribute("aria-haspopup","true");var r=Ci.prototype.buildCSSClass();return n.menuButton_.el_.className=n.buildCSSClass()+" "+r,n.menuButton_.removeClass("vjs-control"),n.addChild(n.menuButton_),n.update(),n.enabled_=!0,n.on(n.menuButton_,"tap",n.handleClick),n.on(n.menuButton_,"click",n.handleClick),n.on(n.menuButton_,"keydown",n.handleKeyDown),n.on(n.menuButton_,"mouseenter",function(){n.addClass("vjs-hover"),n.menu.show(),se(d,"keyup",he(ke(n),n.handleMenuKeyUp))}),n.on("mouseleave",n.handleMouseLeave),n.on("keydown",n.handleSubmenuKeyDown),n}Le(e,i);var t=e.prototype;return t.update=function(){var e=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu)),this.menu=e,this.addChild(e),this.buttonPressed_=!1,this.menuButton_.el_.setAttribute("aria-expanded","false"),this.items&&this.items.length<=this.hideThreshold_?this.hide():this.show()},t.createMenu=function(){var e=new ea(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title){var t=_("li",{className:"vjs-menu-title",innerHTML:Ie(this.options_.title),tabIndex:-1});this.hideThreshold_+=1;var n=new De(this.player_,{el:t});e.addItem(n)}if(this.items=this.createItems(),this.items)for(var r=0;r<this.items.length;r++)e.addItem(this.items[r]);return e},t.createItems=function(){},t.createEl=function(){return i.prototype.createEl.call(this,"div",{className:this.buildWrapperCSSClass()},{})},t.buildWrapperCSSClass=function(){var e="vjs-menu-button";return!0===this.options_.inline?e+="-inline":e+="-popup","vjs-menu-button "+e+" "+Ci.prototype.buildCSSClass()+" "+i.prototype.buildCSSClass.call(this)},t.buildCSSClass=function(){var e="vjs-menu-button";return!0===this.options_.inline?e+="-inline":e+="-popup","vjs-menu-button "+e+" "+i.prototype.buildCSSClass.call(this)},t.controlText=function(e,t){return void 0===t&&(t=this.menuButton_.el()),this.menuButton_.controlText(e,t)},t.dispose=function(){this.handleMouseLeave(),i.prototype.dispose.call(this)},t.handleClick=function(){this.buttonPressed_?this.unpressButton():this.pressButton()},t.handleMouseLeave=function(){this.removeClass("vjs-hover"),le(d,"keyup",he(this,this.handleMenuKeyUp))},t.focus=function(){this.menuButton_.focus()},t.blur=function(){this.menuButton_.blur()},t.handleKeyDown=function(e){xt.isEventKey(e,"Esc")||xt.isEventKey(e,"Tab")?(this.buttonPressed_&&this.unpressButton(),xt.isEventKey(e,"Tab")||(e.preventDefault(),this.menuButton_.focus())):(xt.isEventKey(e,"Up")||xt.isEventKey(e,"Down"))&&(this.buttonPressed_||(e.preventDefault(),this.pressButton()))},t.handleMenuKeyUp=function(e){(xt.isEventKey(e,"Esc")||xt.isEventKey(e,"Tab"))&&this.removeClass("vjs-hover")},t.handleSubmenuKeyPress=function(e){this.handleSubmenuKeyDown(e)},t.handleSubmenuKeyDown=function(e){(xt.isEventKey(e,"Esc")||xt.isEventKey(e,"Tab"))&&(this.buttonPressed_&&this.unpressButton(),xt.isEventKey(e,"Tab")||(e.preventDefault(),this.menuButton_.focus()))},t.pressButton=function(){if(this.enabled_){if(this.buttonPressed_=!0,this.menu.show(),this.menu.lockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","true"),Ye&&g())return;this.menu.focus()}},t.unpressButton=function(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.menu.hide(),this.menuButton_.el_.setAttribute("aria-expanded","false"))},t.disable=function(){this.unpressButton(),this.enabled_=!1,this.addClass("vjs-disabled"),this.menuButton_.disable()},t.enable=function(){this.enabled_=!0,this.removeClass("vjs-disabled"),this.menuButton_.enable()},e}(De);De.registerComponent("MenuButton",ta);var na=function(a){function e(e,t){var n,r=t.tracks;if((n=a.call(this,e,t)||this).items.length<=1&&n.hide(),!r)return ke(n);var i=he(ke(n),n.update);return r.addEventListener("removetrack",i),r.addEventListener("addtrack",i),n.player_.on("ready",i),n.player_.on("dispose",function(){r.removeEventListener("removetrack",i),r.removeEventListener("addtrack",i)}),n}return Le(e,a),e}(ta);De.registerComponent("TrackButton",na);var ra=["Tab","Esc","Up","Down","Right","Left"],ia=function(r){function e(e,t){var n;return(n=r.call(this,e,t)||this).selectable=t.selectable,n.isSelected_=t.selected||!1,n.multiSelectable=t.multiSelectable,n.selected(n.isSelected_),n.selectable?n.multiSelectable?n.el_.setAttribute("role","menuitemcheckbox"):n.el_.setAttribute("role","menuitemradio"):n.el_.setAttribute("role","menuitem"),n}Le(e,r);var t=e.prototype;return t.createEl=function(e,t,n){return this.nonIconControl=!0,r.prototype.createEl.call(this,"li",p({className:"vjs-menu-item",innerHTML:'<span class="vjs-menu-item-text">'+this.localize(this.options_.label)+"</span>",tabIndex:-1},t),n)},t.handleKeyDown=function(t){ra.some(function(e){return xt.isEventKey(t,e)})||r.prototype.handleKeyDown.call(this,t)},t.handleClick=function(){this.selected(!0)},t.selected=function(e){this.selectable&&(e?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected"),this.isSelected_=!0):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(""),this.isSelected_=!1))},e}(yi);De.registerComponent("MenuItem",ia);var aa=function(l){function e(e,t){var r,n=t.track,i=e.textTracks();t.label=n.label||n.language||"Unknown",t.selected="showing"===n.mode,(r=l.call(this,e,t)||this).track=n,r.kinds=(t.kinds||[t.kind||r.track.kind]).filter(Boolean);function a(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.handleTracksChange.apply(ke(r),t)}function o(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.handleSelectedLanguageChange.apply(ke(r),t)}var s;e.on(["loadstart","texttrackchange"],a),i.addEventListener("change",a),i.addEventListener("selectedlanguagechange",o),r.on("dispose",function(){e.off(["loadstart","texttrackchange"],a),i.removeEventListener("change",a),i.removeEventListener("selectedlanguagechange",o)}),void 0===i.onchange&&r.on(["tap","click"],function(){if("object"!=typeof y.Event)try{s=new y.Event("change")}catch(e){}s||(s=d.createEvent("Event")).initEvent("change",!0,!0),i.dispatchEvent(s)});return r.handleTracksChange(),r}Le(e,l);var t=e.prototype;return t.handleClick=function(e){var t=this.track,n=this.player_.textTracks();if(l.prototype.handleClick.call(this,e),n)for(var r=0;r<n.length;r++){var i=n[r];-1!==this.kinds.indexOf(i.kind)&&(i===t?"showing"!==i.mode&&(i.mode="showing"):"disabled"!==i.mode&&(i.mode="disabled"))}},t.handleTracksChange=function(){var e="showing"===this.track.mode;e!==this.isSelected_&&this.selected(e)},t.handleSelectedLanguageChange=function(){if("showing"===this.track.mode){var e=this.player_.cache_.selectedLanguage;if(e&&e.enabled&&e.language===this.track.language&&e.kind!==this.track.kind)return;this.player_.cache_.selectedLanguage={enabled:!0,language:this.track.language,kind:this.track.kind}}},t.dispose=function(){this.track=null,l.prototype.dispose.call(this)},e}(ia);De.registerComponent("TextTrackMenuItem",aa);var oa=function(n){function e(e,t){return t.track={player:e,kind:t.kind,kinds:t.kinds,default:!1,mode:"disabled"},t.kinds||(t.kinds=[t.kind]),t.label?t.track.label=t.label:t.track.label=t.kinds.join(" and ")+" off",t.selectable=!0,t.multiSelectable=!1,n.call(this,e,t)||this}Le(e,n);var t=e.prototype;return t.handleTracksChange=function(){for(var e=this.player().textTracks(),t=!0,n=0,r=e.length;n<r;n++){var i=e[n];if(-1<this.options_.kinds.indexOf(i.kind)&&"showing"===i.mode){t=!1;break}}t!==this.isSelected_&&this.selected(t)},t.handleSelectedLanguageChange=function(){for(var e=this.player().textTracks(),t=!0,n=0,r=e.length;n<r;n++){var i=e[n];if(-1<["captions","descriptions","subtitles"].indexOf(i.kind)&&"showing"===i.mode){t=!1;break}}t&&(this.player_.cache_.selectedLanguage={enabled:!1})},e}(aa);De.registerComponent("OffTextTrackMenuItem",oa);var sa=function(n){function e(e,t){return void 0===t&&(t={}),t.tracks=e.textTracks(),n.call(this,e,t)||this}return Le(e,n),e.prototype.createItems=function(e,t){var n;void 0===e&&(e=[]),void 0===t&&(t=aa),this.label_&&(n=this.label_+" off"),e.push(new oa(this.player_,{kinds:this.kinds_,kind:this.kind_,label:n})),this.hideThreshold_+=1;var r=this.player_.textTracks();Array.isArray(this.kinds_)||(this.kinds_=[this.kind_]);for(var i=0;i<r.length;i++){var a=r[i];if(-1<this.kinds_.indexOf(a.kind)){var o=new t(this.player_,{track:a,kinds:this.kinds_,kind:this.kind_,selectable:!0,multiSelectable:!1});o.addClass("vjs-"+a.kind+"-menu-item"),e.push(o)}}return e},e}(na);De.registerComponent("TextTrackButton",sa);var la=function(o){function e(e,t){var n,r=t.track,i=t.cue,a=e.currentTime();return t.selectable=!0,t.multiSelectable=!1,t.label=i.text,t.selected=i.startTime<=a&&a<i.endTime,(n=o.call(this,e,t)||this).track=r,n.cue=i,r.addEventListener("cuechange",he(ke(n),n.update)),n}Le(e,o);var t=e.prototype;return t.handleClick=function(){o.prototype.handleClick.call(this),this.player_.currentTime(this.cue.startTime),this.update(this.cue.startTime)},t.update=function(){var e=this.cue,t=this.player_.currentTime();this.selected(e.startTime<=t&&t<e.endTime)},e}(ia);De.registerComponent("ChaptersTrackMenuItem",la);var ua=function(r){function e(e,t,n){return r.call(this,e,t,n)||this}Le(e,r);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-chapters-button "+r.prototype.buildCSSClass.call(this)},t.buildWrapperCSSClass=function(){return"vjs-chapters-button "+r.prototype.buildWrapperCSSClass.call(this)},t.update=function(e){this.track_&&(!e||"addtrack"!==e.type&&"removetrack"!==e.type)||this.setTrack(this.findChaptersTrack()),r.prototype.update.call(this)},t.setTrack=function(e){if(this.track_!==e){if(this.updateHandler_||(this.updateHandler_=this.update.bind(this)),this.track_){var t=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);t&&t.removeEventListener("load",this.updateHandler_),this.track_=null}if(this.track_=e,this.track_){this.track_.mode="hidden";var n=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);n&&n.addEventListener("load",this.updateHandler_)}}},t.findChaptersTrack=function(){for(var e=this.player_.textTracks()||[],t=e.length-1;0<=t;t--){var n=e[t];if(n.kind===this.kind_)return n}},t.getMenuCaption=function(){return this.track_&&this.track_.label?this.track_.label:this.localize(Ie(this.kind_))},t.createMenu=function(){return this.options_.title=this.getMenuCaption(),r.prototype.createMenu.call(this)},t.createItems=function(){var e=[];if(!this.track_)return e;var t=this.track_.cues;if(!t)return e;for(var n=0,r=t.length;n<r;n++){var i=t[n],a=new la(this.player_,{track:this.track_,cue:i});e.push(a)}return e},e}(sa);ua.prototype.kind_="chapters",ua.prototype.controlText_="Chapters",De.registerComponent("ChaptersButton",ua);var ca=function(o){function e(e,t,n){var r;r=o.call(this,e,t,n)||this;var i=e.textTracks(),a=he(ke(r),r.handleTracksChange);return i.addEventListener("change",a),r.on("dispose",function(){i.removeEventListener("change",a)}),r}Le(e,o);var t=e.prototype;return t.handleTracksChange=function(){for(var e=this.player().textTracks(),t=!1,n=0,r=e.length;n<r;n++){var i=e[n];if(i.kind!==this.kind_&&"showing"===i.mode){t=!0;break}}t?this.disable():this.enable()},t.buildCSSClass=function(){return"vjs-descriptions-button "+o.prototype.buildCSSClass.call(this)},t.buildWrapperCSSClass=function(){return"vjs-descriptions-button "+o.prototype.buildWrapperCSSClass.call(this)},e}(sa);ca.prototype.kind_="descriptions",ca.prototype.controlText_="Descriptions",De.registerComponent("DescriptionsButton",ca);var da=function(r){function e(e,t,n){return r.call(this,e,t,n)||this}Le(e,r);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-subtitles-button "+r.prototype.buildCSSClass.call(this)},t.buildWrapperCSSClass=function(){return"vjs-subtitles-button "+r.prototype.buildWrapperCSSClass.call(this)},e}(sa);da.prototype.kind_="subtitles",da.prototype.controlText_="Subtitles",De.registerComponent("SubtitlesButton",da);var ha=function(r){function e(e,t){var n;return t.track={player:e,kind:t.kind,label:t.kind+" settings",selectable:!1,default:!1,mode:"disabled"},t.selectable=!1,t.name="CaptionSettingsMenuItem",(n=r.call(this,e,t)||this).addClass("vjs-texttrack-settings"),n.controlText(", opens "+t.kind+" settings dialog"),n}return Le(e,r),e.prototype.handleClick=function(){this.player().getChild("textTrackSettings").open()},e}(aa);De.registerComponent("CaptionSettingsMenuItem",ha);var fa=function(r){function e(e,t,n){return r.call(this,e,t,n)||this}Le(e,r);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-captions-button "+r.prototype.buildCSSClass.call(this)},t.buildWrapperCSSClass=function(){return"vjs-captions-button "+r.prototype.buildWrapperCSSClass.call(this)},t.createItems=function(){var e=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(e.push(new ha(this.player_,{kind:this.kind_})),this.hideThreshold_+=1),r.prototype.createItems.call(this,e)},e}(sa);fa.prototype.kind_="captions",fa.prototype.controlText_="Captions",De.registerComponent("CaptionsButton",fa);var pa=function(i){function e(){return i.apply(this,arguments)||this}return Le(e,i),e.prototype.createEl=function(e,t,n){var r='<span class="vjs-menu-item-text">'+this.localize(this.options_.label);return"captions"===this.options_.track.kind&&(r+='\n        <span aria-hidden="true" class="vjs-icon-placeholder"></span>\n        <span class="vjs-control-text"> '+this.localize("Captions")+"</span>\n      "),r+="</span>",i.prototype.createEl.call(this,e,p({innerHTML:r},t),n)},e}(aa);De.registerComponent("SubsCapsMenuItem",pa);var ma=function(r){function e(e,t){var n;return void 0===t&&(t={}),(n=r.call(this,e,t)||this).label_="subtitles",-1<["en","en-us","en-ca","fr-ca"].indexOf(n.player_.language_)&&(n.label_="captions"),n.menuButton_.controlText(Ie(n.label_)),n}Le(e,r);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-subs-caps-button "+r.prototype.buildCSSClass.call(this)},t.buildWrapperCSSClass=function(){return"vjs-subs-caps-button "+r.prototype.buildWrapperCSSClass.call(this)},t.createItems=function(){var e=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(e.push(new ha(this.player_,{kind:this.label_})),this.hideThreshold_+=1),e=r.prototype.createItems.call(this,e,pa)},e}(sa);ma.prototype.kinds_=["captions","subtitles"],ma.prototype.controlText_="Subtitles",De.registerComponent("SubsCapsButton",ma);var ga=function(o){function e(e,t){var r,n=t.track,i=e.audioTracks();t.label=n.label||n.language||"Unknown",t.selected=n.enabled,(r=o.call(this,e,t)||this).track=n,r.addClass("vjs-"+n.kind+"-menu-item");function a(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];r.handleTracksChange.apply(ke(r),t)}return i.addEventListener("change",a),r.on("dispose",function(){i.removeEventListener("change",a)}),r}Le(e,o);var t=e.prototype;return t.createEl=function(e,t,n){var r='<span class="vjs-menu-item-text">'+this.localize(this.options_.label);return"main-desc"===this.options_.track.kind&&(r+='\n        <span aria-hidden="true" class="vjs-icon-placeholder"></span>\n        <span class="vjs-control-text"> '+this.localize("Descriptions")+"</span>\n      "),r+="</span>",o.prototype.createEl.call(this,e,p({innerHTML:r},t),n)},t.handleClick=function(e){var t=this.player_.audioTracks();o.prototype.handleClick.call(this,e);for(var n=0;n<t.length;n++){var r=t[n];r.enabled=r===this.track}},t.handleTracksChange=function(){this.selected(this.track.enabled)},e}(ia);De.registerComponent("AudioTrackMenuItem",ga);var va=function(n){function e(e,t){return void 0===t&&(t={}),t.tracks=e.audioTracks(),n.call(this,e,t)||this}Le(e,n);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-audio-button "+n.prototype.buildCSSClass.call(this)},t.buildWrapperCSSClass=function(){return"vjs-audio-button "+n.prototype.buildWrapperCSSClass.call(this)},t.createItems=function(e){void 0===e&&(e=[]),this.hideThreshold_=1;for(var t=this.player_.audioTracks(),n=0;n<t.length;n++){var r=t[n];e.push(new ga(this.player_,{track:r,selectable:!0,multiSelectable:!1}))}return e},e}(na);va.prototype.controlText_="Audio Track",De.registerComponent("AudioTrackButton",va);var ya=function(a){function e(e,t){var n,r=t.rate,i=parseFloat(r,10);return t.label=r,t.selected=1===i,t.selectable=!0,t.multiSelectable=!1,(n=a.call(this,e,t)||this).label=r,n.rate=i,n.on(e,"ratechange",n.update),n}Le(e,a);var t=e.prototype;return t.handleClick=function(){a.prototype.handleClick.call(this),this.player().playbackRate(this.rate)},t.update=function(){this.selected(this.player().playbackRate()===this.rate)},e}(ia);ya.prototype.contentElType="button",De.registerComponent("PlaybackRateMenuItem",ya);var _a=function(r){function e(e,t){var n;return(n=r.call(this,e,t)||this).updateVisibility(),n.updateLabel(),n.on(e,"loadstart",n.updateVisibility),n.on(e,"ratechange",n.updateLabel),n}Le(e,r);var t=e.prototype;return t.createEl=function(){var e=r.prototype.createEl.call(this);return this.labelEl_=_("div",{className:"vjs-playback-rate-value",innerHTML:"1x"}),e.appendChild(this.labelEl_),e},t.dispose=function(){this.labelEl_=null,r.prototype.dispose.call(this)},t.buildCSSClass=function(){return"vjs-playback-rate "+r.prototype.buildCSSClass.call(this)},t.buildWrapperCSSClass=function(){return"vjs-playback-rate "+r.prototype.buildWrapperCSSClass.call(this)},t.createMenu=function(){var e=new ea(this.player()),t=this.playbackRates();if(t)for(var n=t.length-1;0<=n;n--)e.addChild(new ya(this.player(),{rate:t[n]+"x"}));return e},t.updateARIAAttributes=function(){this.el().setAttribute("aria-valuenow",this.player().playbackRate())},t.handleClick=function(){for(var e=this.player().playbackRate(),t=this.playbackRates(),n=t[0],r=0;r<t.length;r++)if(t[r]>e){n=t[r];break}this.player().playbackRate(n)},t.playbackRates=function(){return this.options_.playbackRates||this.options_.playerOptions&&this.options_.playerOptions.playbackRates},t.playbackRateSupported=function(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&0<this.playbackRates().length},t.updateVisibility=function(){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")},t.updateLabel=function(){this.playbackRateSupported()&&(this.labelEl_.innerHTML=this.player().playbackRate()+"x")},e}(ta);_a.prototype.controlText_="Playback Rate",De.registerComponent("PlaybackRateMenuButton",_a);var ba=function(e){function t(){return e.apply(this,arguments)||this}Le(t,e);var n=t.prototype;return n.buildCSSClass=function(){return"vjs-spacer "+e.prototype.buildCSSClass.call(this)},n.createEl=function(){return e.prototype.createEl.call(this,"div",{className:this.buildCSSClass()})},t}(De);De.registerComponent("Spacer",ba);var Ea=function(t){function e(){return t.apply(this,arguments)||this}Le(e,t);var n=e.prototype;return n.buildCSSClass=function(){return"vjs-custom-control-spacer "+t.prototype.buildCSSClass.call(this)},n.createEl=function(){var e=t.prototype.createEl.call(this,{className:this.buildCSSClass()});return e.innerHTML=" ",e},e}(ba);De.registerComponent("CustomControlSpacer",Ea);var Ta=function(e){function t(){return e.apply(this,arguments)||this}return Le(t,e),t.prototype.createEl=function(){return e.prototype.createEl.call(this,"div",{className:"vjs-control-bar",dir:"ltr"})},t}(De);Ta.prototype.options_={children:["playToggle","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","seekToLive","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","fullscreenToggle"]},"exitPictureInPicture"in d&&Ta.prototype.options_.children.splice(Ta.prototype.options_.children.length-1,0,"pictureInPictureToggle"),De.registerComponent("ControlBar",Ta);var Aa=function(r){function e(e,t){var n;return(n=r.call(this,e,t)||this).on(e,"error",n.open),n}Le(e,r);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-error-display "+r.prototype.buildCSSClass.call(this)},t.content=function(){var e=this.player().error();return e?this.localize(e.message):""},e}(Rt);Aa.prototype.options_=Pe(Rt.prototype.options_,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0}),De.registerComponent("ErrorDisplay",Aa);var wa="vjs-text-track-settings",Sa=["#000","Black"],Ca=["#00F","Blue"],xa=["#0FF","Cyan"],Ma=["#0F0","Green"],Ra=["#F0F","Magenta"],Ia=["#F00","Red"],Pa=["#FFF","White"],Da=["#FF0","Yellow"],La=["1","Opaque"],Oa=["0.5","Semi-Transparent"],Na=["0","Transparent"],ka={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[Sa,Pa,Ia,Ma,Ca,Da,Ra,xa]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Transparency",options:[La,Oa,Na]},color:{selector:".vjs-fg-color > select",id:"captions-foreground-color-%s",label:"Color",options:[Pa,Sa,Ia,Ma,Ca,Da,Ra,xa]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Dropshadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:function(e){return"1.00"===e?null:Number(e)}},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Transparency",options:[La,Oa]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Transparency",options:[Na,Oa,La]}};function Ba(e,t){if(t&&(e=t(e)),e&&"none"!==e)return e}ka.windowColor.options=ka.backgroundColor.options;var Fa=function(r){function e(e,t){var n;return t.temporary=!1,(n=r.call(this,e,t)||this).updateDisplay=he(ke(n),n.updateDisplay),n.fill(),n.hasBeenOpened_=n.hasBeenFilled_=!0,n.endDialog=_("p",{className:"vjs-control-text",textContent:n.localize("End of dialog window.")}),n.el().appendChild(n.endDialog),n.setDefaults(),void 0===t.persistTextTrackSettings&&(n.options_.persistTextTrackSettings=n.options_.playerOptions.persistTextTrackSettings),n.on(n.$(".vjs-done-button"),"click",function(){n.saveSettings(),n.close()}),n.on(n.$(".vjs-default-button"),"click",function(){n.setDefaults(),n.updateDisplay()}),i(ka,function(e){n.on(n.$(e.selector),"change",n.updateDisplay)}),n.options_.persistTextTrackSettings&&n.restoreSettings(),n}Le(e,r);var t=e.prototype;return t.dispose=function(){this.endDialog=null,r.prototype.dispose.call(this)},t.createElSelect_=function(e,t,n){var r=this;void 0===t&&(t=""),void 0===n&&(n="label");var i=ka[e],a=i.id.replace("%s",this.id_),o=[t,a].join(" ").trim();return["<"+n+' id="'+a+'" class="'+("label"===n?"vjs-label":"")+'">',this.localize(i.label),"</"+n+">",'<select aria-labelledby="'+o+'">'].concat(i.options.map(function(e){var t=a+"-"+e[1].replace(/\W+/g,"");return['<option id="'+t+'" value="'+e[0]+'" ','aria-labelledby="'+o+" "+t+'">',r.localize(e[1]),"</option>"].join("")})).concat("</select>").join("")},t.createElFgColor_=function(){var e="captions-text-legend-"+this.id_;return['<fieldset class="vjs-fg-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Text"),"</legend>",this.createElSelect_("color",e),'<span class="vjs-text-opacity vjs-opacity">',this.createElSelect_("textOpacity",e),"</span>","</fieldset>"].join("")},t.createElBgColor_=function(){var e="captions-background-"+this.id_;return['<fieldset class="vjs-bg-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Background"),"</legend>",this.createElSelect_("backgroundColor",e),'<span class="vjs-bg-opacity vjs-opacity">',this.createElSelect_("backgroundOpacity",e),"</span>","</fieldset>"].join("")},t.createElWinColor_=function(){var e="captions-window-"+this.id_;return['<fieldset class="vjs-window-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Window"),"</legend>",this.createElSelect_("windowColor",e),'<span class="vjs-window-opacity vjs-opacity">',this.createElSelect_("windowOpacity",e),"</span>","</fieldset>"].join("")},t.createElColors_=function(){return _("div",{className:"vjs-track-settings-colors",innerHTML:[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})},t.createElFont_=function(){return _("div",{className:"vjs-track-settings-font",innerHTML:['<fieldset class="vjs-font-percent vjs-track-setting">',this.createElSelect_("fontPercent","","legend"),"</fieldset>",'<fieldset class="vjs-edge-style vjs-track-setting">',this.createElSelect_("edgeStyle","","legend"),"</fieldset>",'<fieldset class="vjs-font-family vjs-track-setting">',this.createElSelect_("fontFamily","","legend"),"</fieldset>"].join("")})},t.createElControls_=function(){var e=this.localize("restore all settings to the default values");return _("div",{className:"vjs-track-settings-controls",innerHTML:['<button type="button" class="vjs-default-button" title="'+e+'">',this.localize("Reset"),'<span class="vjs-control-text"> '+e+"</span>","</button>",'<button type="button" class="vjs-done-button">'+this.localize("Done")+"</button>"].join("")})},t.content=function(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]},t.label=function(){return this.localize("Caption Settings Dialog")},t.description=function(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")},t.buildCSSClass=function(){return r.prototype.buildCSSClass.call(this)+" vjs-text-track-settings"},t.getValues=function(){var i=this;return function(n,r,e){return void 0===e&&(e=0),a(n).reduce(function(e,t){return r(e,n[t],t)},e)}(ka,function(e,t,n){var r=function(e,t){return Ba(e.options[e.options.selectedIndex].value,t)}(i.$(t.selector),t.parser);return void 0!==r&&(e[n]=r),e},{})},t.setValues=function(n){var r=this;i(ka,function(e,t){!function(e,t,n){if(t)for(var r=0;r<e.options.length;r++)if(Ba(e.options[r].value,n)===t){e.selectedIndex=r;break}}(r.$(e.selector),n[t],e.parser)})},t.setDefaults=function(){var n=this;i(ka,function(e){var t=e.hasOwnProperty("default")?e.default:0;n.$(e.selector).selectedIndex=t})},t.restoreSettings=function(){var e;try{e=JSON.parse(y.localStorage.getItem(wa))}catch(e){h.warn(e)}e&&this.setValues(e)},t.saveSettings=function(){if(this.options_.persistTextTrackSettings){var e=this.getValues();try{Object.keys(e).length?y.localStorage.setItem(wa,JSON.stringify(e)):y.localStorage.removeItem(wa)}catch(e){h.warn(e)}}},t.updateDisplay=function(){var e=this.player_.getChild("textTrackDisplay");e&&e.updateDisplay()},t.conditionalBlur_=function(){this.previouslyActiveEl_=null;var e=this.player_.controlBar,t=e&&e.subsCapsButton,n=e&&e.captionsButton;t?t.focus():n&&n.focus()},e}(Rt);De.registerComponent("TextTrackSettings",Fa);var ja=function(a){function e(e,t){var n,r=t.ResizeObserver||y.ResizeObserver;null===t.ResizeObserver&&(r=!1);var i=Pe({createEl:!r,reportTouchActivity:!1},t);return(n=a.call(this,e,i)||this).ResizeObserver=t.ResizeObserver||y.ResizeObserver,n.loadListener_=null,n.resizeObserver_=null,n.debouncedHandler_=pe(function(){n.resizeHandler()},100,!1,ke(n)),r?(n.resizeObserver_=new n.ResizeObserver(n.debouncedHandler_),n.resizeObserver_.observe(e.el())):(n.loadListener_=function(){if(n.el_&&n.el_.contentWindow){var e=n.debouncedHandler_,t=n.unloadListener_=function(){le(this,"resize",e),le(this,"unload",t),t=null};se(n.el_.contentWindow,"unload",t),se(n.el_.contentWindow,"resize",e)}},n.one("load",n.loadListener_)),n}Le(e,a);var t=e.prototype;return t.createEl=function(){return a.prototype.createEl.call(this,"iframe",{className:"vjs-resize-manager",tabIndex:-1},{"aria-hidden":"true"})},t.resizeHandler=function(){this.player_&&this.player_.trigger&&this.player_.trigger("playerresize")},t.dispose=function(){this.debouncedHandler_&&this.debouncedHandler_.cancel(),this.resizeObserver_&&(this.player_.el()&&this.resizeObserver_.unobserve(this.player_.el()),this.resizeObserver_.disconnect()),this.loadListener_&&this.off("load",this.loadListener_),this.el_&&this.el_.contentWindow&&this.unloadListener_&&this.unloadListener_.call(this.el_.contentWindow),this.ResizeObserver=null,this.resizeObserver=null,this.debouncedHandler_=null,this.loadListener_=null,a.prototype.dispose.call(this)},e}(De);De.registerComponent("ResizeManager",ja);var Ua=function(i){function e(e,t){var n,r=Pe({createEl:!1},t);return(n=i.call(this,e,r)||this).reset_(),n.on(n.player_,"durationchange",n.handleDurationchange),nt&&"hidden"in d&&"visibilityState"in d&&n.on(d,"visibilitychange",n.handleVisibilityChange),n}Le(e,i);var t=e.prototype;return t.handleVisibilityChange=function(){this.player_.duration()===1/0&&(d.hidden?this.stopTracking():this.startTracking())},t.isBehind_=function(){if(!this.timeupdateSeen_)return!1;var e=this.liveCurrentTime(),t=this.player_.currentTime(),n=2*this.seekableIncrement_+.07;return e!==1/0&&t<=e-n},t.trackLive_=function(){this.pastSeekEnd_=this.pastSeekEnd_;var e=this.player_.seekable();if(e&&e.length){var t=this.seekableEnd();t!==this.lastSeekEnd_&&(this.lastSeekEnd_&&(this.seekableIncrementList_=this.seekableIncrementList_.slice(-11),this.seekableIncrementList_.push(Math.abs(t-this.lastSeekEnd_)),3<this.seekableIncrementList_.length&&(this.seekableIncrement_=function(e){var t=Math.floor(e.length/2),n=[].concat(e).sort(function(e,t){return e-t});return e.length%2!=0?n[t]:(n[t-1]+n[t])/2}(this.seekableIncrementList_))),this.pastSeekEnd_=0,this.lastSeekEnd_=t,this.trigger("seekableendchange")),this.pastSeekEnd_=this.pastSeekEnd()+.03,this.isBehind_()!==this.behindLiveEdge()&&(this.behindLiveEdge_=this.isBehind_(),this.trigger("liveedgechange"))}},t.handleDurationchange=function(){this.player_.duration()===1/0?this.startTracking():this.stopTracking()},t.startTracking=function(){var e=this;this.isTracking()||(this.timeupdateSeen_||(this.timeupdateSeen_=this.player_.hasStarted()),this.trackingInterval_=this.setInterval(this.trackLive_,30),this.trackLive_(),this.on(this.player_,"play",this.trackLive_),this.on(this.player_,"pause",this.trackLive_),this.timeupdateSeen_||(this.one(this.player_,"play",this.handlePlay),this.handleTimeupdate=function(){e.timeupdateSeen_=!0,e.handleTimeupdate=null},this.one(this.player_,"timeupdate",this.handleTimeupdate)))},t.handlePlay=function(){this.one(this.player_,"timeupdate",this.seekToLiveEdge)},t.reset_=function(){this.pastSeekEnd_=0,this.lastSeekEnd_=null,this.behindLiveEdge_=null,this.timeupdateSeen_=!1,this.clearInterval(this.trackingInterval_),this.trackingInterval_=null,this.seekableIncrement_=12,this.seekableIncrementList_=[],this.off(this.player_,"play",this.trackLive_),this.off(this.player_,"pause",this.trackLive_),this.off(this.player_,"play",this.handlePlay),this.off(this.player_,"timeupdate",this.seekToLiveEdge),this.handleTimeupdate&&(this.off(this.player_,"timeupdate",this.handleTimeupdate),this.handleTimeupdate=null)},t.stopTracking=function(){this.isTracking()&&this.reset_()},t.seekableEnd=function(){for(var e=this.player_.seekable(),t=[],n=e?e.length:0;n--;)t.push(e.end(n));return t.length?t.sort()[t.length-1]:1/0},t.seekableStart=function(){for(var e=this.player_.seekable(),t=[],n=e?e.length:0;n--;)t.push(e.start(n));return t.length?t.sort()[0]:0},t.liveWindow=function(){var e=this.liveCurrentTime();return e===1/0?1/0:e-this.seekableStart()},t.isLive=function(){return this.isTracking()},t.atLiveEdge=function(){return!this.behindLiveEdge()},t.liveCurrentTime=function(){return this.pastSeekEnd()+this.seekableEnd()},t.pastSeekEnd=function(){return this.pastSeekEnd_},t.behindLiveEdge=function(){return this.behindLiveEdge_},t.isTracking=function(){return"number"==typeof this.trackingInterval_},t.seekToLiveEdge=function(){this.atLiveEdge()||(this.player_.currentTime(this.liveCurrentTime()),this.player_.paused()&&this.player_.play())},t.dispose=function(){this.stopTracking(),i.prototype.dispose.call(this)},e}(De);De.registerComponent("LiveTracker",Ua);function Ha(e){var t=e.el();if(t.hasAttribute("src"))return e.triggerSourceset(t.src),!0;var n=e.$$("source"),r=[],i="";if(!n.length)return!1;for(var a=0;a<n.length;a++){var o=n[a].src;o&&-1===r.indexOf(o)&&r.push(o)}return!!r.length&&(1===r.length&&(i=r[0]),e.triggerSourceset(i),!0)}function Ga(e,t){for(var n={},r=0;r<e.length&&!((n=Object.getOwnPropertyDescriptor(e[r],t))&&n.set&&n.get);r++);return n.enumerable=!0,n.configurable=!0,n}function Va(a){var o=a.el();if(!o.resetSourceWatch_){function t(i){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=i.apply(o,t);return Ha(a),r}}var n={},e=function(e){return Ga([e.el(),y.HTMLMediaElement.prototype,y.Element.prototype,Wa],"innerHTML")}(a);["append","appendChild","insertAdjacentHTML"].forEach(function(e){o[e]&&(n[e]=o[e],o[e]=t(n[e]))}),Object.defineProperty(o,"innerHTML",Pe(e,{set:t(e.set)})),o.resetSourceWatch_=function(){o.resetSourceWatch_=null,Object.keys(n).forEach(function(e){o[e]=n[e]}),Object.defineProperty(o,"innerHTML",e)},a.one("sourceset",o.resetSourceWatch_)}}function za(r){if(r.featuresSourceset){var i=r.el();if(!i.resetSourceset_){var n=function(e){return Ga([e.el(),y.HTMLMediaElement.prototype,qa],"src")}(r),a=i.setAttribute,t=i.load;Object.defineProperty(i,"src",Pe(n,{set:function(e){var t=n.set.call(i,e);return r.triggerSourceset(i.src),t}})),i.setAttribute=function(e,t){var n=a.call(i,e,t);return/src/i.test(e)&&r.triggerSourceset(i.src),n},i.load=function(){var e=t.call(i);return Ha(r)||(r.triggerSourceset(""),Va(r)),e},i.currentSrc?r.triggerSourceset(i.currentSrc):Ha(r)||Va(r),i.resetSourceset_=function(){i.resetSourceset_=null,i.load=t,i.setAttribute=a,Object.defineProperty(i,"src",n),i.resetSourceWatch_&&i.resetSourceWatch_()}}}}var Wa=Object.defineProperty({},"innerHTML",{get:function(){return this.cloneNode(!0).innerHTML},set:function(e){var t=d.createElement(this.nodeName.toLowerCase());t.innerHTML=e;for(var n=d.createDocumentFragment();t.childNodes.length;)n.appendChild(t.childNodes[0]);return this.innerText="",y.Element.prototype.appendChild.call(this,n),this.innerHTML}}),qa=Object.defineProperty({},"src",{get:function(){return this.hasAttribute("src")?Nt(y.Element.prototype.getAttribute.call(this,"src")):""},set:function(e){return y.Element.prototype.setAttribute.call(this,"src",e),e}}),Ya=function(c){function s(e,t){var n;n=c.call(this,e,t)||this;var r=e.source,i=!1;if(r&&(n.el_.currentSrc!==r.src||e.tag&&3===e.tag.initNetworkState_)?n.setSource(r):n.handleLateInit_(n.el_),e.enableSourceset&&n.setupSourcesetHandling_(),n.el_.hasChildNodes()){for(var a=n.el_.childNodes,o=a.length,s=[];o--;){var l=a[o];"track"===l.nodeName.toLowerCase()&&(n.featuresNativeTextTracks?(n.remoteTextTrackEls().addTrackElement_(l),n.remoteTextTracks().addTrack(l.track),n.textTracks().addTrack(l.track),i||n.el_.hasAttribute("crossorigin")||!Bt(l.src)||(i=!0)):s.push(l))}for(var u=0;u<s.length;u++)n.el_.removeChild(s[u])}return n.proxyNativeTracks_(),n.featuresNativeTextTracks&&i&&h.warn("Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.\nThis may prevent text tracks from loading."),n.restoreMetadataTracksInIOSNativePlayer_(),(ot||We||Ze)&&!0===e.nativeControlsForTouch&&n.setControls(!0),n.proxyWebkitFullscreen_(),n.triggerReady(),n}Le(s,c);var e=s.prototype;return e.dispose=function(){this.el_&&this.el_.resetSourceset_&&this.el_.resetSourceset_(),s.disposeMediaElement(this.el_),this.options_=null,c.prototype.dispose.call(this)},e.setupSourcesetHandling_=function(){za(this)},e.restoreMetadataTracksInIOSNativePlayer_=function(){function e(){n=[];for(var e=0;e<r.length;e++){var t=r[e];"metadata"===t.kind&&n.push({track:t,storedMode:t.mode})}}var n,r=this.textTracks();e(),r.addEventListener("change",e),this.on("dispose",function(){return r.removeEventListener("change",e)});function i(){for(var e=0;e<n.length;e++){var t=n[e];"disabled"===t.track.mode&&t.track.mode!==t.storedMode&&(t.track.mode=t.storedMode)}r.removeEventListener("change",i)}this.on("webkitbeginfullscreen",function(){r.removeEventListener("change",e),r.removeEventListener("change",i),r.addEventListener("change",i)}),this.on("webkitendfullscreen",function(){r.removeEventListener("change",e),r.addEventListener("change",e),r.removeEventListener("change",i)})},e.overrideNative_=function(e,t){var n=this;if(t===this["featuresNative"+e+"Tracks"]){var r=e.toLowerCase();this[r+"TracksListeners_"]&&Object.keys(this[r+"TracksListeners_"]).forEach(function(e){n.el()[r+"Tracks"].removeEventListener(e,n[r+"TracksListeners_"][e])}),this["featuresNative"+e+"Tracks"]=!t,this[r+"TracksListeners_"]=null,this.proxyNativeTracksForType_(r)}},e.overrideNativeAudioTracks=function(e){this.overrideNative_("Audio",e)},e.overrideNativeVideoTracks=function(e){this.overrideNative_("Video",e)},e.proxyNativeTracksForType_=function(e){var r=this,t=Sr[e],i=this.el()[t.getterName],a=this[t.getterName]();if(this["featuresNative"+t.capitalName+"Tracks"]&&i&&i.addEventListener){function n(){for(var e=[],t=0;t<a.length;t++){for(var n=!1,r=0;r<i.length;r++)if(i[r]===a[t]){n=!0;break}n||e.push(a[t])}for(;e.length;)a.removeTrack(e.shift())}var o={change:function(){a.trigger({type:"change",target:a,currentTarget:a,srcElement:a})},addtrack:function(e){a.addTrack(e.track)},removetrack:function(e){a.removeTrack(e.track)}};this[t.getterName+"Listeners_"]=o,Object.keys(o).forEach(function(t){var n=o[t];i.addEventListener(t,n),r.on("dispose",function(e){return i.removeEventListener(t,n)})}),this.on("loadstart",n),this.on("dispose",function(e){return r.off("loadstart",n)})}},e.proxyNativeTracks_=function(){var t=this;Sr.names.forEach(function(e){t.proxyNativeTracksForType_(e)})},e.createEl=function(){var e=this.options_.tag;if(!e||!this.options_.playerElIngest&&!this.movingMediaElementInDOM){if(e){var t=e.cloneNode(!0);e.parentNode&&e.parentNode.insertBefore(t,e),s.disposeMediaElement(e),e=t}else{e=d.createElement("video");var n=Pe({},this.options_.tag&&x(this.options_.tag));ot&&!0===this.options_.nativeControlsForTouch||delete n.controls,C(e,p(n,{id:this.options_.techId,class:"vjs-tech"}))}e.playerId=this.options_.playerId}void 0!==this.options_.preload&&R(e,"preload",this.options_.preload);for(var r=["loop","muted","playsinline","autoplay"],i=0;i<r.length;i++){var a=r[i],o=this.options_[a];void 0!==o&&(o?R(e,a,a):I(e,a),e[a]=o)}return e},e.handleLateInit_=function(e){if(0!==e.networkState&&3!==e.networkState){if(0===e.readyState){function t(){n=!0}var n=!1;this.on("loadstart",t);function r(){n||this.trigger("loadstart")}return this.on("loadedmetadata",r),void this.ready(function(){this.off("loadstart",t),this.off("loadedmetadata",r),n||this.trigger("loadstart")})}var i=["loadstart"];i.push("loadedmetadata"),2<=e.readyState&&i.push("loadeddata"),3<=e.readyState&&i.push("canplay"),4<=e.readyState&&i.push("canplaythrough"),this.ready(function(){i.forEach(function(e){this.trigger(e)},this)})}},e.setCurrentTime=function(e){try{this.el_.currentTime=e}catch(e){h(e,"Video is not ready. (Video.js)")}},e.duration=function(){var t=this;if(this.el_.duration===1/0&&Xe&&et&&0===this.el_.currentTime){return this.on("timeupdate",function e(){0<t.el_.currentTime&&(t.el_.duration===1/0&&t.trigger("durationchange"),t.off("timeupdate",e))}),NaN}return this.el_.duration||NaN},e.width=function(){return this.el_.offsetWidth},e.height=function(){return this.el_.offsetHeight},e.proxyWebkitFullscreen_=function(){var e=this;if("webkitDisplayingFullscreen"in this.el_){function t(){this.trigger("fullscreenchange",{isFullscreen:!1})}function n(){"webkitPresentationMode"in this.el_&&"picture-in-picture"!==this.el_.webkitPresentationMode&&(this.one("webkitendfullscreen",t),this.trigger("fullscreenchange",{isFullscreen:!0}))}this.on("webkitbeginfullscreen",n),this.on("dispose",function(){e.off("webkitbeginfullscreen",n),e.off("webkitendfullscreen",t)})}},e.supportsFullScreen=function(){if("function"==typeof this.el_.webkitEnterFullScreen){var e=y.navigator&&y.navigator.userAgent||"";if(/Android/.test(e)||!/Chrome|Mac OS X 10.5/.test(e))return!0}return!1},e.enterFullScreen=function(){var e=this.el_;e.paused&&e.networkState<=e.HAVE_METADATA?(this.el_.play(),this.setTimeout(function(){e.pause(),e.webkitEnterFullScreen()},0)):e.webkitEnterFullScreen()},e.exitFullScreen=function(){this.el_.webkitExitFullScreen()},e.requestPictureInPicture=function(){return this.el_.requestPictureInPicture()},e.src=function(e){if(void 0===e)return this.el_.src;this.setSrc(e)},e.reset=function(){s.resetMediaElement(this.el_)},e.currentSrc=function(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc},e.setControls=function(e){this.el_.controls=!!e},e.addTextTrack=function(e,t,n){return this.featuresNativeTextTracks?this.el_.addTextTrack(e,t,n):c.prototype.addTextTrack.call(this,e,t,n)},e.createRemoteTextTrack=function(e){if(!this.featuresNativeTextTracks)return c.prototype.createRemoteTextTrack.call(this,e);var t=d.createElement("track");return e.kind&&(t.kind=e.kind),e.label&&(t.label=e.label),(e.language||e.srclang)&&(t.srclang=e.language||e.srclang),e.default&&(t.default=e.default),e.id&&(t.id=e.id),e.src&&(t.src=e.src),t},e.addRemoteTextTrack=function(e,t){var n=c.prototype.addRemoteTextTrack.call(this,e,t);return this.featuresNativeTextTracks&&this.el().appendChild(n),n},e.removeRemoteTextTrack=function(e){if(c.prototype.removeRemoteTextTrack.call(this,e),this.featuresNativeTextTracks)for(var t=this.$$("track"),n=t.length;n--;)e!==t[n]&&e!==t[n].track||this.el().removeChild(t[n])},e.getVideoPlaybackQuality=function(){if("function"==typeof this.el().getVideoPlaybackQuality)return this.el().getVideoPlaybackQuality();var e={};return void 0!==this.el().webkitDroppedFrameCount&&void 0!==this.el().webkitDecodedFrameCount&&(e.droppedVideoFrames=this.el().webkitDroppedFrameCount,e.totalVideoFrames=this.el().webkitDecodedFrameCount),y.performance&&"function"==typeof y.performance.now?e.creationTime=y.performance.now():y.performance&&y.performance.timing&&"number"==typeof y.performance.timing.navigationStart&&(e.creationTime=y.Date.now()-y.performance.timing.navigationStart),e},s}(ri);if(c()){Ya.TEST_VID=d.createElement("video");var Ka=d.createElement("track");Ka.kind="captions",Ka.srclang="en",Ka.label="English",Ya.TEST_VID.appendChild(Ka)}Ya.isSupported=function(){try{Ya.TEST_VID.volume=.5}catch(e){return!1}return!(!Ya.TEST_VID||!Ya.TEST_VID.canPlayType)},Ya.canPlayType=function(e){return Ya.TEST_VID.canPlayType(e)},Ya.canPlaySource=function(e,t){return Ya.canPlayType(e.type)},Ya.canControlVolume=function(){try{var e=Ya.TEST_VID.volume;return Ya.TEST_VID.volume=e/2+.1,e!==Ya.TEST_VID.volume}catch(e){return!1}},Ya.canMuteVolume=function(){try{var e=Ya.TEST_VID.muted;return Ya.TEST_VID.muted=!e,Ya.TEST_VID.muted?R(Ya.TEST_VID,"muted","muted"):I(Ya.TEST_VID,"muted"),e!==Ya.TEST_VID.muted}catch(e){return!1}},Ya.canControlPlaybackRate=function(){if(Xe&&et&&tt<58)return!1;try{var e=Ya.TEST_VID.playbackRate;return Ya.TEST_VID.playbackRate=e/2+.1,e!==Ya.TEST_VID.playbackRate}catch(e){return!1}},Ya.canOverrideAttributes=function(){try{function e(){}Object.defineProperty(d.createElement("video"),"src",{get:e,set:e}),Object.defineProperty(d.createElement("audio"),"src",{get:e,set:e}),Object.defineProperty(d.createElement("video"),"innerHTML",{get:e,set:e}),Object.defineProperty(d.createElement("audio"),"innerHTML",{get:e,set:e})}catch(e){return!1}return!0},Ya.supportsNativeTextTracks=function(){return it||Ye&&et},Ya.supportsNativeVideoTracks=function(){return!(!Ya.TEST_VID||!Ya.TEST_VID.videoTracks)},Ya.supportsNativeAudioTracks=function(){return!(!Ya.TEST_VID||!Ya.TEST_VID.audioTracks)},Ya.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"],Ya.prototype.featuresVolumeControl=Ya.canControlVolume(),Ya.prototype.featuresMuteControl=Ya.canMuteVolume(),Ya.prototype.featuresPlaybackRate=Ya.canControlPlaybackRate(),Ya.prototype.featuresSourceset=Ya.canOverrideAttributes(),Ya.prototype.movingMediaElementInDOM=!Ye,Ya.prototype.featuresFullscreenResize=!0,Ya.prototype.featuresProgressEvents=!0,Ya.prototype.featuresTimeupdateEvents=!0,Ya.prototype.featuresNativeTextTracks=Ya.supportsNativeTextTracks(),Ya.prototype.featuresNativeVideoTracks=Ya.supportsNativeVideoTracks(),Ya.prototype.featuresNativeAudioTracks=Ya.supportsNativeAudioTracks();var Xa=Ya.TEST_VID&&Ya.TEST_VID.constructor.prototype.canPlayType,Qa=/^application\/(?:x-|vnd\.apple\.)mpegurl/i;Ya.patchCanPlayType=function(){4<=Qe&&!Je&&!et&&(Ya.TEST_VID.constructor.prototype.canPlayType=function(e){return e&&Qa.test(e)?"maybe":Xa.call(this,e)})},Ya.unpatchCanPlayType=function(){var e=Ya.TEST_VID.constructor.prototype.canPlayType;return Ya.TEST_VID.constructor.prototype.canPlayType=Xa,e},Ya.patchCanPlayType(),Ya.disposeMediaElement=function(e){if(e){for(e.parentNode&&e.parentNode.removeChild(e);e.hasChildNodes();)e.removeChild(e.firstChild);e.removeAttribute("src"),"function"==typeof e.load&&function(){try{e.load()}catch(e){}}()}},Ya.resetMediaElement=function(e){if(e){for(var t=e.querySelectorAll("source"),n=t.length;n--;)e.removeChild(t[n]);e.removeAttribute("src"),"function"==typeof e.load&&function(){try{e.load()}catch(e){}}()}},["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach(function(e){Ya.prototype[e]=function(){return this.el_[e]||this.el_.hasAttribute(e)}}),["muted","defaultMuted","autoplay","loop","playsinline"].forEach(function(t){Ya.prototype["set"+Ie(t)]=function(e){(this.el_[t]=e)?this.el_.setAttribute(t,t):this.el_.removeAttribute(t)}}),["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","played","networkState","readyState","videoWidth","videoHeight"].forEach(function(e){Ya.prototype[e]=function(){return this.el_[e]}}),["volume","src","poster","preload","playbackRate","defaultPlaybackRate"].forEach(function(t){Ya.prototype["set"+Ie(t)]=function(e){this.el_[t]=e}}),["pause","load","play"].forEach(function(e){Ya.prototype[e]=function(){return this.el_[e]()}}),ri.withSourceHandlers(Ya),Ya.nativeSourceHandler={},Ya.nativeSourceHandler.canPlayType=function(e){try{return Ya.TEST_VID.canPlayType(e)}catch(e){return""}},Ya.nativeSourceHandler.canHandleSource=function(e,t){if(e.type)return Ya.nativeSourceHandler.canPlayType(e.type);if(e.src){var n=kt(e.src);return Ya.nativeSourceHandler.canPlayType("video/"+n)}return""},Ya.nativeSourceHandler.handleSource=function(e,t,n){t.setSrc(e.src)},Ya.nativeSourceHandler.dispose=function(){},Ya.registerSourceHandler(Ya.nativeSourceHandler),ri.registerTech("Html5",Ya);var Za=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"],Ja={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"},$a=["tiny","xsmall","small","medium","large","xlarge","huge"],eo={};$a.forEach(function(e){var t="x"===e.charAt(0)?"x-"+e.substring(1):e;eo[e]="vjs-layout-"+t});var to={tiny:210,xsmall:320,small:425,medium:768,large:1440,xlarge:2560,huge:1/0},no=function(c){function u(e,t,n){var r;if(e.id=e.id||t.id||"vjs_video_"+ee(),(t=p(u.getTagSettings(e),t)).initChildren=!1,t.createEl=!1,t.evented=!1,t.reportTouchActivity=!1,!t.language)if("function"==typeof e.closest){var i=e.closest("[lang]");i&&i.getAttribute&&(t.language=i.getAttribute("lang"))}else for(var a=e;a&&1===a.nodeType;){if(x(a).hasOwnProperty("lang")){t.language=a.getAttribute("lang");break}a=a.parentNode}if((r=c.call(this,null,t,n)||this).boundDocumentFullscreenChange_=he(ke(r),r.documentFullscreenChange_),r.boundFullWindowOnEscKey_=he(ke(r),r.fullWindowOnEscKey),r.log=f(r.id_),r.fsApi_=ft,r.isPosterFromTech_=!1,r.queuedCallbacks_=[],r.isReady_=!1,r.hasStarted_=!1,r.userActive_=!1,!r.options_||!r.options_.techOrder||!r.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");if(r.tag=e,r.tagAttributes=e&&x(e),r.language(r.options_.language),t.languages){var o={};Object.getOwnPropertyNames(t.languages).forEach(function(e){o[e.toLowerCase()]=t.languages[e]}),r.languages_=o}else r.languages_=u.prototype.options_.languages;r.resetCache_(),r.poster_=t.poster||"",r.controls_=!!t.controls,e.controls=!1,e.removeAttribute("controls"),r.changingSrc_=!1,r.playCallbacks_=[],r.playTerminatedQueue_=[],e.hasAttribute("autoplay")?r.autoplay(!0):r.autoplay(r.options_.autoplay),t.plugins&&Object.keys(t.plugins).forEach(function(e){if("function"!=typeof r[e])throw new Error('plugin "'+e+'" does not exist')}),r.scrubbing_=!1,r.el_=r.createEl(),Ce(ke(r),{eventBusKey:"el_"}),r.fluid_&&r.on("playerreset",r.updateStyleEl_);var s=Pe(r.options_);t.plugins&&Object.keys(t.plugins).forEach(function(e){r[e](t.plugins[e])}),r.options_.playerOptions=s,r.middleware_=[],r.initChildren(),r.isAudio("audio"===e.nodeName.toLowerCase()),r.controls()?r.addClass("vjs-controls-enabled"):r.addClass("vjs-controls-disabled"),r.el_.setAttribute("role","region"),r.isAudio()?r.el_.setAttribute("aria-label",r.localize("Audio Player")):r.el_.setAttribute("aria-label",r.localize("Video Player")),r.isAudio()&&r.addClass("vjs-audio"),r.flexNotSupported_()&&r.addClass("vjs-no-flex"),ot&&r.addClass("vjs-touch-enabled"),Ye||r.addClass("vjs-workinghover"),u.players[r.id_]=ke(r);var l="7.6.6".split(".")[0];return r.addClass("vjs-v"+l),r.userActive(!0),r.reportUserActivity(),r.one("play",r.listenForUserActivity_),r.on("stageclick",r.handleStageClick_),r.on("keydown",r.handleKeyDown),r.breakpoints(r.options_.breakpoints),r.responsive(r.options_.responsive),r}Le(u,c);var e=u.prototype;return e.dispose=function(){var r=this;this.trigger("dispose"),this.off("dispose"),le(d,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),le(d,"keydown",this.boundFullWindowOnEscKey_),this.styleEl_&&this.styleEl_.parentNode&&(this.styleEl_.parentNode.removeChild(this.styleEl_),this.styleEl_=null),u.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech_&&(this.tech_.dispose(),this.isPosterFromTech_=!1,this.poster_=""),this.playerElIngest_&&(this.playerElIngest_=null),this.tag&&(this.tag=null),function(e){ai[e.id()]=null}(this),xr.names.forEach(function(e){var t=xr[e],n=r[t.getterName]();n&&n.off&&n.off()}),c.prototype.dispose.call(this)},e.createEl=function(){var t,n=this.tag,e=this.playerElIngest_=n.parentNode&&n.parentNode.hasAttribute&&n.parentNode.hasAttribute("data-vjs-player"),r="video-js"===this.tag.tagName.toLowerCase();e?t=this.el_=n.parentNode:r||(t=this.el_=c.prototype.createEl.call(this,"div"));var i=x(n);if(r){for(t=this.el_=n,n=this.tag=d.createElement("video");t.children.length;)n.appendChild(t.firstChild);T(t,"video-js")||A(t,"video-js"),t.appendChild(n),e=this.playerElIngest_=t,Object.keys(t).forEach(function(e){try{n[e]=t[e]}catch(e){}})}if(n.setAttribute("tabindex","-1"),i.tabindex="-1",(nt||et&&at)&&(n.setAttribute("role","application"),i.role="application"),n.removeAttribute("width"),n.removeAttribute("height"),"width"in i&&delete i.width,"height"in i&&delete i.height,Object.getOwnPropertyNames(i).forEach(function(e){r&&"class"===e||t.setAttribute(e,i[e]),r&&n.setAttribute(e,i[e])}),n.playerId=n.id,n.id+="_html5_api",n.className="vjs-tech",n.player=t.player=this,this.addClass("vjs-paused"),!0!==y.VIDEOJS_NO_DYNAMIC_STYLE){this.styleEl_=Q("vjs-styles-dimensions");var a=V(".vjs-styles-defaults"),o=V("head");o.insertBefore(this.styleEl_,a?a.nextSibling:o.firstChild)}this.fill_=!1,this.fluid_=!1,this.width(this.options_.width),this.height(this.options_.height),this.fill(this.options_.fill),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio);for(var s=n.getElementsByTagName("a"),l=0;l<s.length;l++){var u=s.item(l);A(u,"vjs-hidden"),u.setAttribute("hidden","hidden")}return n.initNetworkState_=n.networkState,n.parentNode&&!e&&n.parentNode.insertBefore(t,n),E(n,t),this.children_.unshift(n),this.el_.setAttribute("lang",this.language_),this.el_=t},e.width=function(e){return this.dimension("width",e)},e.height=function(e){return this.dimension("height",e)},e.dimension=function(e,t){var n=e+"_";if(void 0===t)return this[n]||0;if(""===t)return this[n]=void 0,void this.updateStyleEl_();var r=parseFloat(t);isNaN(r)?h.error('Improper value "'+t+'" supplied for for '+e):(this[n]=r,this.updateStyleEl_())},e.fluid=function(e){if(void 0===e)return!!this.fluid_;this.fluid_=!!e,we(this)&&this.off("playerreset",this.updateStyleEl_),e?(this.addClass("vjs-fluid"),this.fill(!1),function(e,t){we(e)?t():(e.eventedCallbacks||(e.eventedCallbacks=[]),e.eventedCallbacks.push(t))}(function(){this.on("playerreset",this.updateStyleEl_)})):this.removeClass("vjs-fluid"),this.updateStyleEl_()},e.fill=function(e){if(void 0===e)return!!this.fill_;this.fill_=!!e,e?(this.addClass("vjs-fill"),this.fluid(!1)):this.removeClass("vjs-fill")},e.aspectRatio=function(e){if(void 0===e)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(e))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=e,this.fluid(!0),this.updateStyleEl_()},e.updateStyleEl_=function(){if(!0!==y.VIDEOJS_NO_DYNAMIC_STYLE){var e,t,n,r=(void 0!==this.aspectRatio_&&"auto"!==this.aspectRatio_?this.aspectRatio_:0<this.videoWidth()?this.videoWidth()+":"+this.videoHeight():"16:9").split(":"),i=r[1]/r[0];e=void 0!==this.width_?this.width_:void 0!==this.height_?this.height_/i:this.videoWidth()||300,t=void 0!==this.height_?this.height_:e*i,n=/^[^a-zA-Z]/.test(this.id())?"dimensions-"+this.id():this.id()+"-dimensions",this.addClass(n),Z(this.styleEl_,"\n      ."+n+" {\n        width: "+e+"px;\n        height: "+t+"px;\n      }\n\n      ."+n+".vjs-fluid {\n        padding-top: "+100*i+"%;\n      }\n    ")}else{var a="number"==typeof this.width_?this.width_:this.options_.width,o="number"==typeof this.height_?this.height_:this.options_.height,s=this.tech_&&this.tech_.el();s&&(0<=a&&(s.width=a),0<=o&&(s.height=o))}},e.loadTech_=function(e,t){var n=this;this.tech_&&this.unloadTech_();var r=Ie(e),i=e.charAt(0).toLowerCase()+e.slice(1);"Html5"!==r&&this.tag&&(ri.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=r,this.isReady_=!1;var a={source:t,autoplay:"string"!=typeof this.autoplay()&&this.autoplay(),nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:this.id()+"_"+i+"_api",playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset,Promise:this.options_.Promise};xr.names.forEach(function(e){var t=xr[e];a[t.getterName]=n[t.privateName]}),p(a,this.options_[r]),p(a,this.options_[i]),p(a,this.options_[e.toLowerCase()]),this.tag&&(a.tag=this.tag),t&&t.src===this.cache_.src&&0<this.cache_.currentTime&&(a.startTime=this.cache_.currentTime);var o=ri.getTech(e);if(!o)throw new Error("No Tech named '"+r+"' exists! '"+r+"' should be registered using videojs.registerTech()'");this.tech_=new o(a),this.tech_.ready(he(this,this.handleTechReady_),!0),St(this.textTracksJson_||[],this.tech_),Za.forEach(function(e){n.on(n.tech_,e,n["handleTech"+Ie(e)+"_"])}),Object.keys(Ja).forEach(function(t){n.on(n.tech_,t,function(e){0===n.tech_.playbackRate()&&n.tech_.seeking()?n.queuedCallbacks_.push({callback:n["handleTech"+Ja[t]+"_"].bind(n),event:e}):n["handleTech"+Ja[t]+"_"](e)})}),this.on(this.tech_,"loadstart",this.handleTechLoadStart_),this.on(this.tech_,"sourceset",this.handleTechSourceset_),this.on(this.tech_,"waiting",this.handleTechWaiting_),this.on(this.tech_,"ended",this.handleTechEnded_),this.on(this.tech_,"seeking",this.handleTechSeeking_),this.on(this.tech_,"play",this.handleTechPlay_),this.on(this.tech_,"firstplay",this.handleTechFirstPlay_),this.on(this.tech_,"pause",this.handleTechPause_),this.on(this.tech_,"durationchange",this.handleTechDurationChange_),this.on(this.tech_,"fullscreenchange",this.handleTechFullscreenChange_),this.on(this.tech_,"enterpictureinpicture",this.handleTechEnterPictureInPicture_),this.on(this.tech_,"leavepictureinpicture",this.handleTechLeavePictureInPicture_),this.on(this.tech_,"error",this.handleTechError_),this.on(this.tech_,"loadedmetadata",this.updateStyleEl_),this.on(this.tech_,"posterchange",this.handleTechPosterChange_),this.on(this.tech_,"textdata",this.handleTechTextData_),this.on(this.tech_,"ratechange",this.handleTechRateChange_),this.usingNativeControls(this.techGet_("controls")),this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_(),this.tech_.el().parentNode===this.el()||"Html5"===r&&this.tag||E(this.tech_.el(),this.el()),this.tag&&(this.tag.player=null,this.tag=null)},e.unloadTech_=function(){var n=this;xr.names.forEach(function(e){var t=xr[e];n[t.privateName]=n[t.getterName]()}),this.textTracksJson_=wt(this.tech_),this.isReady_=!1,this.tech_.dispose(),this.tech_=!1,this.isPosterFromTech_&&(this.poster_="",this.trigger("posterchange")),this.isPosterFromTech_=!1},e.tech=function(e){return void 0===e&&h.warn("Using the tech directly can be dangerous. I hope you know what you're doing.\nSee https://github.com/videojs/video.js/issues/2617 for more info.\n"),this.tech_},e.addTechControlsListeners_=function(){this.removeTechControlsListeners_(),this.on(this.tech_,"mouseup",this.handleTechClick_),this.on(this.tech_,"dblclick",this.handleTechDoubleClick_),this.on(this.tech_,"touchstart",this.handleTechTouchStart_),this.on(this.tech_,"touchmove",this.handleTechTouchMove_),this.on(this.tech_,"touchend",this.handleTechTouchEnd_),this.on(this.tech_,"tap",this.handleTechTap_)},e.removeTechControlsListeners_=function(){this.off(this.tech_,"tap",this.handleTechTap_),this.off(this.tech_,"touchstart",this.handleTechTouchStart_),this.off(this.tech_,"touchmove",this.handleTechTouchMove_),this.off(this.tech_,"touchend",this.handleTechTouchEnd_),this.off(this.tech_,"mouseup",this.handleTechClick_),this.off(this.tech_,"dblclick",this.handleTechDoubleClick_)},e.handleTechReady_=function(){this.triggerReady(),this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume),this.handleTechPosterChange_(),this.handleTechDurationChange_()},e.handleTechLoadStart_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-seeking"),this.error(null),this.handleTechDurationChange_(),this.paused()?(this.hasStarted(!1),this.trigger("loadstart")):(this.trigger("loadstart"),this.trigger("firstplay")),this.manualAutoplay_(this.autoplay())},e.manualAutoplay_=function(t){var r=this;if(this.tech_&&"string"==typeof t){function e(){var e=r.muted();r.muted(!0);function t(){r.muted(e)}r.playTerminatedQueue_.push(t);var n=r.play();if(Et(n))return n.catch(t)}var n;if("any"===t&&!0!==this.muted()?Et(n=this.play())&&(n=n.catch(e)):n="muted"===t&&!0!==this.muted()?e():this.play(),Et(n))return n.then(function(){r.trigger({type:"autoplay-success",autoplay:t})}).catch(function(e){r.trigger({type:"autoplay-failure",autoplay:t})})}},e.updateSourceCaches_=function(e){void 0===e&&(e="");var t=e,n="";"string"!=typeof t&&(t=e.src,n=e.type),this.cache_.source=this.cache_.source||{},this.cache_.sources=this.cache_.sources||[],t&&!n&&(n=function(e,t){if(!t)return"";if(e.cache_.source.src===t&&e.cache_.source.type)return e.cache_.source.type;var n=e.cache_.sources.filter(function(e){return e.src===t});if(n.length)return n[0].type;for(var r=e.$$("source"),i=0;i<r.length;i++){var a=r[i];if(a.type&&a.src&&a.src===t)return a.type}return pi(t)}(this,t)),this.cache_.source=Pe({},e,{src:t,type:n});for(var r=this.cache_.sources.filter(function(e){return e.src&&e.src===t}),i=[],a=this.$$("source"),o=[],s=0;s<a.length;s++){var l=x(a[s]);i.push(l),l.src&&l.src===t&&o.push(l.src)}o.length&&!r.length?this.cache_.sources=i:r.length||(this.cache_.sources=[this.cache_.source]),this.cache_.src=t},e.handleTechSourceset_=function(e){var n=this;if(!this.changingSrc_){var t=function(e){return n.updateSourceCaches_(e)},r=this.currentSource().src,i=e.src;r&&!/^blob:/.test(r)&&/^blob:/.test(i)&&(this.lastSource_&&(this.lastSource_.tech===i||this.lastSource_.player===r)||(t=function(){})),t(i),e.src||this.tech_.any(["sourceset","loadstart"],function(e){if("sourceset"!==e.type){var t=n.techGet("currentSrc");n.lastSource_.tech=t,n.updateSourceCaches_(t)}})}this.lastSource_={player:this.currentSource().src,tech:e.src},this.trigger({src:e.src,type:"sourceset"})},e.hasStarted=function(e){if(void 0===e)return this.hasStarted_;e!==this.hasStarted_&&(this.hasStarted_=e,this.hasStarted_?(this.addClass("vjs-has-started"),this.trigger("firstplay")):this.removeClass("vjs-has-started"))},e.handleTechPlay_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0),this.trigger("play")},e.handleTechRateChange_=function(){0<this.tech_.playbackRate()&&0===this.cache_.lastPlaybackRate&&(this.queuedCallbacks_.forEach(function(e){return e.callback(e.event)}),this.queuedCallbacks_=[]),this.cache_.lastPlaybackRate=this.tech_.playbackRate(),this.trigger("ratechange")},e.handleTechWaiting_=function(){var t=this;this.addClass("vjs-waiting"),this.trigger("waiting");var n=this.currentTime();this.on("timeupdate",function e(){n!==t.currentTime()&&(t.removeClass("vjs-waiting"),t.off("timeupdate",e))})},e.handleTechCanPlay_=function(){this.removeClass("vjs-waiting"),this.trigger("canplay")},e.handleTechCanPlayThrough_=function(){this.removeClass("vjs-waiting"),this.trigger("canplaythrough")},e.handleTechPlaying_=function(){this.removeClass("vjs-waiting"),this.trigger("playing")},e.handleTechSeeking_=function(){this.addClass("vjs-seeking"),this.trigger("seeking")},e.handleTechSeeked_=function(){this.removeClass("vjs-seeking"),this.removeClass("vjs-ended"),this.trigger("seeked")},e.handleTechFirstPlay_=function(){this.options_.starttime&&(h.warn("Passing the `starttime` option to the player will be deprecated in 6.0"),this.currentTime(this.options_.starttime)),this.addClass("vjs-has-started"),this.trigger("firstplay")},e.handleTechPause_=function(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.trigger("pause")},e.handleTechEnded_=function(){this.addClass("vjs-ended"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause(),this.trigger("ended")},e.handleTechDurationChange_=function(){this.duration(this.techGet_("duration"))},e.handleTechClick_=function(e){H(e)&&this.controls_&&(this.paused()?Tt(this.play()):this.pause())},e.handleTechDoubleClick_=function(t){this.controls_&&(Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),function(e){return e.contains(t.target)})||void 0!==this.options_&&void 0!==this.options_.userActions&&void 0!==this.options_.userActions.doubleClick&&!1===this.options_.userActions.doubleClick||(void 0!==this.options_&&void 0!==this.options_.userActions&&"function"==typeof this.options_.userActions.doubleClick?this.options_.userActions.doubleClick.call(this,t):this.isFullscreen()?this.exitFullscreen():this.requestFullscreen()))},e.handleTechTap_=function(){this.userActive(!this.userActive())},e.handleTechTouchStart_=function(){this.userWasActive=this.userActive()},e.handleTechTouchMove_=function(){this.userWasActive&&this.reportUserActivity()},e.handleTechTouchEnd_=function(e){e.preventDefault()},e.handleStageClick_=function(){this.reportUserActivity()},e.toggleFullscreenClass_=function(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")},e.documentFullscreenChange_=function(){var e=this.el(),t=d[this.fsApi_.fullscreenElement]===e;!t&&e.matches?t=e.matches(":"+this.fsApi_.fullscreen):!t&&e.msMatchesSelector&&(t=e.msMatchesSelector(":"+this.fsApi_.fullscreen)),this.isFullscreen(t),!1===this.isFullscreen()&&le(d,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),this.fsApi_.prefixed&&this.trigger("fullscreenchange")},e.handleTechFullscreenChange_=function(e,t){t&&this.isFullscreen(t.isFullscreen),this.trigger("fullscreenchange")},e.togglePictureInPictureClass_=function(){this.isInPictureInPicture()?this.addClass("vjs-picture-in-picture"):this.removeClass("vjs-picture-in-picture")},e.handleTechEnterPictureInPicture_=function(){this.isInPictureInPicture(!0)},e.handleTechLeavePictureInPicture_=function(){this.isInPictureInPicture(!1)},e.handleTechError_=function(){var e=this.tech_.error();this.error(e)},e.handleTechTextData_=function(e,t){var n=null;1<arguments.length&&(n=t),this.trigger("textdata",n)},e.getCache=function(){return this.cache_},e.resetCache_=function(){this.cache_={currentTime:0,inactivityTimeout:this.options_.inactivityTimeout,duration:NaN,lastVolume:1,lastPlaybackRate:this.defaultPlaybackRate(),media:null,src:"",source:{},sources:[],volume:1}},e.techCall_=function(e,t){this.ready(function(){if(e in ci)return function(e,t,n,r){return t[n](e.reduce(hi(n),r))}(this.middleware_,this.tech_,e,t);if(e in di)return li(this.middleware_,this.tech_,e,t);try{this.tech_&&this.tech_[e](t)}catch(e){throw h(e),e}},!0)},e.techGet_=function(t){if(this.tech_&&this.tech_.isReady_){if(t in ui)return function(e,t,n){return e.reduceRight(hi(n),t[n]())}(this.middleware_,this.tech_,t);if(t in di)return li(this.middleware_,this.tech_,t);try{return this.tech_[t]()}catch(e){if(void 0===this.tech_[t])throw h("Video.js: "+t+" method not defined for "+this.techName_+" playback technology.",e),e;if("TypeError"===e.name)throw h("Video.js: "+t+" unavailable on "+this.techName_+" playback technology element.",e),this.tech_.isReady_=!1,e;throw h(e),e}}},e.play=function(){var t=this,e=this.options_.Promise||y.Promise;return e?new e(function(e){t.play_(e)}):this.play_()},e.play_=function(e){var t=this;void 0===e&&(e=Tt),this.playCallbacks_.push(e);var n=Boolean(!this.changingSrc_&&(this.src()||this.currentSrc()));if(this.waitToPlay_&&(this.off(["ready","loadstart"],this.waitToPlay_),this.waitToPlay_=null),!this.isReady_||!n)return this.waitToPlay_=function(e){t.play_()},this.one(["ready","loadstart"],this.waitToPlay_),void(n||!it&&!Ye||this.load());var r=this.techGet_("play");null===r?this.runPlayTerminatedQueue_():this.runPlayCallbacks_(r)},e.runPlayTerminatedQueue_=function(){var e=this.playTerminatedQueue_.slice(0);this.playTerminatedQueue_=[],e.forEach(function(e){e()})},e.runPlayCallbacks_=function(t){var e=this.playCallbacks_.slice(0);this.playCallbacks_=[],this.playTerminatedQueue_=[],e.forEach(function(e){e(t)})},e.pause=function(){this.techCall_("pause")},e.paused=function(){return!1!==this.techGet_("paused")},e.played=function(){return this.techGet_("played")||ct(0,0)},e.scrubbing=function(e){if(void 0===e)return this.scrubbing_;this.scrubbing_=!!e,e?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing")},e.currentTime=function(e){return void 0!==e?(e<0&&(e=0),void this.techCall_("setCurrentTime",e)):(this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime)},e.duration=function(e){if(void 0===e)return void 0!==this.cache_.duration?this.cache_.duration:NaN;(e=parseFloat(e))<0&&(e=1/0),e!==this.cache_.duration&&((this.cache_.duration=e)===1/0?(this.addClass("vjs-live"),this.options_.liveui&&this.player_.liveTracker&&this.addClass("vjs-liveui")):(this.removeClass("vjs-live"),this.removeClass("vjs-liveui")),isNaN(e)||this.trigger("durationchange"))},e.remainingTime=function(){return this.duration()-this.currentTime()},e.remainingTimeDisplay=function(){return Math.floor(this.duration())-Math.floor(this.currentTime())},e.buffered=function(){var e=this.techGet_("buffered");return e&&e.length||(e=ct(0,0)),e},e.bufferedPercent=function(){return dt(this.buffered(),this.duration())},e.bufferedEnd=function(){var e=this.buffered(),t=this.duration(),n=e.end(e.length-1);return t<n&&(n=t),n},e.volume=function(e){var t;return void 0!==e?(t=Math.max(0,Math.min(1,parseFloat(e))),this.cache_.volume=t,this.techCall_("setVolume",t),void(0<t&&this.lastVolume_(t))):(t=parseFloat(this.techGet_("volume")),isNaN(t)?1:t)},e.muted=function(e){if(void 0===e)return this.techGet_("muted")||!1;this.techCall_("setMuted",e)},e.defaultMuted=function(e){return void 0!==e?this.techCall_("setDefaultMuted",e):this.techGet_("defaultMuted")||!1},e.lastVolume_=function(e){if(void 0===e||0===e)return this.cache_.lastVolume;this.cache_.lastVolume=e},e.supportsFullScreen=function(){return this.techGet_("supportsFullScreen")||!1},e.isFullscreen=function(e){return void 0!==e?(this.isFullscreen_=!!e,void this.toggleFullscreenClass_()):!!this.isFullscreen_},e.requestFullscreen=function(e){var t;this.isFullscreen(!0),this.fsApi_.requestFullscreen?(se(d,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),this.fsApi_.prefixed||(t=this.options_.fullscreen&&this.options_.fullscreen.options||{},void 0!==e&&(t=e)),Tt(this.el_[this.fsApi_.requestFullscreen](t))):this.tech_.supportsFullScreen()?this.techCall_("enterFullScreen"):(this.enterFullWindow(),this.trigger("fullscreenchange"))},e.exitFullscreen=function(){this.isFullscreen(!1),this.fsApi_.requestFullscreen?Tt(d[this.fsApi_.exitFullscreen]()):this.tech_.supportsFullScreen()?this.techCall_("exitFullScreen"):(this.exitFullWindow(),this.trigger("fullscreenchange"))},e.enterFullWindow=function(){this.isFullWindow=!0,this.docOrigOverflow=d.documentElement.style.overflow,se(d,"keydown",this.boundFullWindowOnEscKey_),d.documentElement.style.overflow="hidden",A(d.body,"vjs-full-window"),this.trigger("enterFullWindow")},e.fullWindowOnEscKey=function(e){xt.isEventKey(e,"Esc")&&(!0===this.isFullscreen()?this.exitFullscreen():this.exitFullWindow())},e.exitFullWindow=function(){this.isFullWindow=!1,le(d,"keydown",this.boundFullWindowOnEscKey_),d.documentElement.style.overflow=this.docOrigOverflow,w(d.body,"vjs-full-window"),this.trigger("exitFullWindow")},e.isInPictureInPicture=function(e){return void 0!==e?(this.isInPictureInPicture_=!!e,void this.togglePictureInPictureClass_()):!!this.isInPictureInPicture_},e.requestPictureInPicture=function(){if("pictureInPictureEnabled"in d)return this.techGet_("requestPictureInPicture")},e.exitPictureInPicture=function(){if("pictureInPictureEnabled"in d)return d.exitPictureInPicture()},e.handleKeyDown=function(e){var t=this.options_.userActions;if(t&&t.hotkeys){!function(e){var t=e.tagName.toLowerCase();if(e.isContentEditable)return!0;if("input"===t)return-1===["button","checkbox","hidden","radio","reset","submit"].indexOf(e.type);return-1!==["textarea"].indexOf(t)}(this.el_.ownerDocument.activeElement)&&("function"==typeof t.hotkeys?t.hotkeys.call(this,e):this.handleHotkeys(e))}},e.handleHotkeys=function(e){var t=this.options_.userActions?this.options_.userActions.hotkeys:{},n=t.fullscreenKey,r=void 0===n?function(e){return xt.isEventKey(e,"f")}:n,i=t.muteKey,a=void 0===i?function(e){return xt.isEventKey(e,"m")}:i,o=t.playPauseKey,s=void 0===o?function(e){return xt.isEventKey(e,"k")||xt.isEventKey(e,"Space")}:o;if(r.call(this,e)){e.preventDefault(),e.stopPropagation();var l=De.getComponent("FullscreenToggle");!1!==d[this.fsApi_.fullscreenEnabled]&&l.prototype.handleClick.call(this,e)}else if(a.call(this,e)){e.preventDefault(),e.stopPropagation(),De.getComponent("MuteToggle").prototype.handleClick.call(this,e)}else if(s.call(this,e)){e.preventDefault(),e.stopPropagation(),De.getComponent("PlayToggle").prototype.handleClick.call(this,e)}},e.canPlayType=function(e){for(var t,n=0,r=this.options_.techOrder;n<r.length;n++){var i=r[n],a=ri.getTech(i);if(a=a||De.getComponent(i)){if(a.isSupported()&&(t=a.canPlayType(e)))return t}else h.error('The "'+i+'" tech is undefined. Skipped browser support check for that tech.')}return""},e.selectSource=function(e){function t(e,n,r){var i;return e.some(function(t){return n.some(function(e){if(i=r(t,e))return!0})}),i}function n(e,t){var n=e[0];if(e[1].canPlaySource(t,i.options_[n.toLowerCase()]))return{source:t,tech:n}}var r,i=this,a=this.options_.techOrder.map(function(e){return[e,ri.getTech(e)]}).filter(function(e){var t=e[0],n=e[1];return n?n.isSupported():(h.error('The "'+t+'" tech is undefined. Skipped browser support check for that tech.'),!1)});return(this.options_.sourceOrder?t(e,a,(r=n,function(e,t){return r(t,e)})):t(a,e,n))||!1},e.src=function(e){var n=this;if(void 0===e)return this.cache_.src||"";var r=function t(e){if(Array.isArray(e)){var n=[];e.forEach(function(e){e=t(e),Array.isArray(e)?n=n.concat(e):o(e)&&n.push(e)}),e=n}else e="string"==typeof e&&e.trim()?[gi({src:e})]:o(e)&&"string"==typeof e.src&&e.src&&e.src.trim()?[gi(e)]:[];return e}(e);r.length?(this.changingSrc_=!0,this.cache_.sources=r,this.updateSourceCaches_(r[0]),si(this,r[0],function(e,t){if(n.middleware_=t,n.cache_.sources=r,n.updateSourceCaches_(e),n.src_(e))return 1<r.length?n.src(r.slice(1)):(n.changingSrc_=!1,n.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0),void n.triggerReady());!function(e,t){e.forEach(function(e){return e.setTech&&e.setTech(t)})}(t,n.tech_)})):this.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0)},e.src_=function(e){var t=this,n=this.selectSource([e]);return!n||(function(e,t){return Ie(e)===Ie(t)}(n.tech,this.techName_)?this.ready(function(){this.tech_.constructor.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",e):this.techCall_("src",e.src),this.changingSrc_=!1},!0):(this.changingSrc_=!0,this.loadTech_(n.tech,n.source),this.tech_.ready(function(){t.changingSrc_=!1})),!1)},e.load=function(){this.techCall_("load")},e.reset=function(){var e=this,t=this.options_.Promise||y.Promise;this.paused()||!t?this.doReset_():Tt(this.play().then(function(){return e.doReset_()}))},e.doReset_=function(){this.tech_&&this.tech_.clearTracks("text"),this.resetCache_(),this.poster(""),this.loadTech_(this.options_.techOrder[0],null),this.techCall_("reset"),this.resetControlBarUI_(),we(this)&&this.trigger("playerreset")},e.resetControlBarUI_=function(){this.resetProgressBar_(),this.resetPlaybackRate_(),this.resetVolumeBar_()},e.resetProgressBar_=function(){this.currentTime(0);var e=this.controlBar,t=e.durationDisplay,n=e.remainingTimeDisplay;t&&t.updateContent(),n&&n.updateContent()},e.resetPlaybackRate_=function(){this.playbackRate(this.defaultPlaybackRate()),this.handleTechRateChange_()},e.resetVolumeBar_=function(){this.volume(1),this.trigger("volumechange")},e.currentSources=function(){var e=this.currentSource(),t=[];return 0!==Object.keys(e).length&&t.push(e),this.cache_.sources||t},e.currentSource=function(){return this.cache_.source||{}},e.currentSrc=function(){return this.currentSource()&&this.currentSource().src||""},e.currentType=function(){return this.currentSource()&&this.currentSource().type||""},e.preload=function(e){return void 0!==e?(this.techCall_("setPreload",e),void(this.options_.preload=e)):this.techGet_("preload")},e.autoplay=function(e){if(void 0===e)return this.options_.autoplay||!1;var t;"string"==typeof e&&/(any|play|muted)/.test(e)?(this.options_.autoplay=e,this.manualAutoplay_(e),t=!1):this.options_.autoplay=!!e,t=void 0===t?this.options_.autoplay:t,this.tech_&&this.techCall_("setAutoplay",t)},e.playsinline=function(e){return void 0!==e?(this.techCall_("setPlaysinline",e),this.options_.playsinline=e,this):this.techGet_("playsinline")},e.loop=function(e){return void 0!==e?(this.techCall_("setLoop",e),void(this.options_.loop=e)):this.techGet_("loop")},e.poster=function(e){if(void 0===e)return this.poster_;(e=e||"")!==this.poster_&&(this.poster_=e,this.techCall_("setPoster",e),this.isPosterFromTech_=!1,this.trigger("posterchange"))},e.handleTechPosterChange_=function(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){var e=this.tech_.poster()||"";e!==this.poster_&&(this.poster_=e,this.isPosterFromTech_=!0,this.trigger("posterchange"))}},e.controls=function(e){if(void 0===e)return!!this.controls_;e=!!e,this.controls_!==e&&(this.controls_=e,this.usingNativeControls()&&this.techCall_("setControls",e),this.controls_?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_()))},e.usingNativeControls=function(e){if(void 0===e)return!!this.usingNativeControls_;e=!!e,this.usingNativeControls_!==e&&(this.usingNativeControls_=e,this.usingNativeControls_?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols")))},e.error=function(e){if(void 0===e)return this.error_||null;if(this.options_.suppressNotSupportedError&&e&&e.message&&e.message===this.localize(this.options_.notSupportedMessage)){function t(){this.error(e)}return this.options_.suppressNotSupportedError=!1,this.any(["click","touchstart"],t),void this.one("loadstart",function(){this.off(["click","touchstart"],t)})}if(null===e)return this.error_=e,this.removeClass("vjs-error"),void(this.errorDisplay&&this.errorDisplay.close());this.error_=new yt(e),this.addClass("vjs-error"),h.error("(CODE:"+this.error_.code+" "+yt.errorTypes[this.error_.code]+")",this.error_.message,this.error_),this.trigger("error")},e.reportUserActivity=function(){this.userActivity_=!0},e.userActive=function(e){if(void 0===e)return this.userActive_;if((e=!!e)!==this.userActive_){if(this.userActive_=e,this.userActive_)return this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),void this.trigger("useractive");this.tech_&&this.tech_.one("mousemove",function(e){e.stopPropagation(),e.preventDefault()}),this.userActivity_=!1,this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive")}},e.listenForUserActivity_=function(){var e,t,n,r=he(this,this.reportUserActivity);this.on("mousedown",function(){r(),this.clearInterval(e),e=this.setInterval(r,250)}),this.on("mousemove",function(e){e.screenX===t&&e.screenY===n||(t=e.screenX,n=e.screenY,r())}),this.on("mouseup",function(){r(),this.clearInterval(e)});var i,a=this.getChild("controlBar");!a||Ye||Xe||(a.on("mouseenter",function(e){this.player().cache_.inactivityTimeout=this.player().options_.inactivityTimeout,this.player().options_.inactivityTimeout=0}),a.on("mouseleave",function(e){this.player().options_.inactivityTimeout=this.player().cache_.inactivityTimeout})),this.on("keydown",r),this.on("keyup",r),this.setInterval(function(){if(this.userActivity_){this.userActivity_=!1,this.userActive(!0),this.clearTimeout(i);var e=this.options_.inactivityTimeout;e<=0||(i=this.setTimeout(function(){this.userActivity_||this.userActive(!1)},e))}},250)},e.playbackRate=function(e){if(void 0===e)return this.tech_&&this.tech_.featuresPlaybackRate?this.cache_.lastPlaybackRate||this.techGet_("playbackRate"):1;this.techCall_("setPlaybackRate",e)},e.defaultPlaybackRate=function(e){return void 0!==e?this.techCall_("setDefaultPlaybackRate",e):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("defaultPlaybackRate"):1},e.isAudio=function(e){if(void 0===e)return!!this.isAudio_;this.isAudio_=!!e},e.addTextTrack=function(e,t,n){if(this.tech_)return this.tech_.addTextTrack(e,t,n)},e.addRemoteTextTrack=function(e,t){if(this.tech_)return this.tech_.addRemoteTextTrack(e,t)},e.removeRemoteTextTrack=function(e){void 0===e&&(e={});var t=e.track;if(t=t||e,this.tech_)return this.tech_.removeRemoteTextTrack(t)},e.getVideoPlaybackQuality=function(){return this.techGet_("getVideoPlaybackQuality")},e.videoWidth=function(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0},e.videoHeight=function(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0},e.language=function(e){if(void 0===e)return this.language_;this.language_=String(e).toLowerCase()},e.languages=function(){return Pe(u.prototype.options_.languages,this.languages_)},e.toJSON=function(){var e=Pe(this.options_),t=e.tracks;e.tracks=[];for(var n=0;n<t.length;n++){var r=t[n];(r=Pe(r)).player=void 0,e.tracks[n]=r}return e},e.createModal=function(e,t){var n=this;(t=t||{}).content=e||"";var r=new Rt(this,t);return this.addChild(r),r.on("dispose",function(){n.removeChild(r)}),r.open(),r},e.updateCurrentBreakpoint_=function(){if(this.responsive())for(var e=this.currentBreakpoint(),t=this.currentWidth(),n=0;n<$a.length;n++){var r=$a[n];if(t<=this.breakpoints_[r]){if(e===r)return;e&&this.removeClass(eo[e]),this.addClass(eo[r]),this.breakpoint_=r;break}}},e.removeCurrentBreakpoint_=function(){var e=this.currentBreakpointClass();this.breakpoint_="",e&&this.removeClass(e)},e.breakpoints=function(e){return void 0===e||(this.breakpoint_="",this.breakpoints_=p({},to,e),this.updateCurrentBreakpoint_()),p(this.breakpoints_)},e.responsive=function(e){return void 0===e?this.responsive_:(e=Boolean(e))!==this.responsive_?((this.responsive_=e)?(this.on("playerresize",this.updateCurrentBreakpoint_),this.updateCurrentBreakpoint_()):(this.off("playerresize",this.updateCurrentBreakpoint_),this.removeCurrentBreakpoint_()),e):void 0},e.currentBreakpoint=function(){return this.breakpoint_},e.currentBreakpointClass=function(){return eo[this.breakpoint_]||""},e.loadMedia=function(e,t){var n=this;if(e&&"object"==typeof e){this.reset(),this.cache_.media=Pe(e);var r=this.cache_.media,i=r.artwork,a=r.poster,o=r.src,s=r.textTracks;!i&&a&&(this.cache_.media.artwork=[{src:a,type:pi(a)}]),o&&this.src(o),a&&this.poster(a),Array.isArray(s)&&s.forEach(function(e){return n.addRemoteTextTrack(e,!1)}),this.ready(t)}},e.getMedia=function(){if(this.cache_.media)return Pe(this.cache_.media);var e=this.poster(),t={src:this.currentSources(),textTracks:Array.prototype.map.call(this.remoteTextTracks(),function(e){return{kind:e.kind,label:e.label,language:e.language,src:e.src}})};return e&&(t.poster=e,t.artwork=[{src:t.poster,type:pi(t.poster)}]),t},u.getTagSettings=function(e){var t={sources:[],tracks:[]},n=x(e),r=n["data-setup"];if(T(e,"vjs-fill")&&(n.fill=!0),T(e,"vjs-fluid")&&(n.fluid=!0),null!==r){var i=bt(r||"{}"),a=i[0],o=i[1];a&&h.error(a),p(n,o)}if(p(t,n),e.hasChildNodes())for(var s=e.childNodes,l=0,u=s.length;l<u;l++){var c=s[l],d=c.nodeName.toLowerCase();"source"===d?t.sources.push(x(c)):"track"===d&&t.tracks.push(x(c))}return t},e.flexNotSupported_=function(){var e=d.createElement("i");return!("flexBasis"in e.style||"webkitFlexBasis"in e.style||"mozFlexBasis"in e.style||"msFlexBasis"in e.style||"msFlexOrder"in e.style)},u}(De);xr.names.forEach(function(e){var t=xr[e];no.prototype[t.getterName]=function(){return this.tech_?this.tech_[t.getterName]():(this[t.privateName]=this[t.privateName]||new t.ListClass,this[t.privateName])}}),no.players={};var ro=y.navigator;no.prototype.options_={techOrder:ri.defaultTechOrder_,html5:{},flash:{},inactivityTimeout:2e3,playbackRates:[],liveui:!1,children:["mediaLoader","posterImage","textTrackDisplay","loadingSpinner","bigPlayButton","liveTracker","controlBar","errorDisplay","textTrackSettings","resizeManager"],language:ro&&(ro.languages&&ro.languages[0]||ro.userLanguage||ro.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media.",fullscreen:{options:{navigationUI:"hide"}},breakpoints:{},responsive:!1},["ended","seeking","seekable","networkState","readyState"].forEach(function(e){no.prototype[e]=function(){return this.techGet_(e)}}),Za.forEach(function(e){no.prototype["handleTech"+Ie(e)+"_"]=function(){return this.trigger(e)}}),De.registerComponent("Player",no);function io(e){return fo.hasOwnProperty(e)}function ao(e){return io(e)?fo[e]:void 0}function oo(e,t){e[ho]=e[ho]||{},e[ho][t]=!0}function so(e,t,n){var r=(n?"before":"")+"pluginsetup";e.trigger(r,t),e.trigger(r+":"+t.name,t)}function lo(t,n){function r(){so(this,{name:t,plugin:n,instance:null},!0);var e=n.apply(this,arguments);return oo(this,t),so(this,{name:t,plugin:n,instance:e}),e}return Object.keys(n).forEach(function(e){r[e]=n[e]}),r}function uo(i,a){return a.prototype.name=i,function(){so(this,{name:i,plugin:a,instance:null},!0);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=Ne(a,[this].concat(t));return this[i]=function(){return r},so(this,r.getEventHash()),r}}var co="plugin",ho="activePlugins_",fo={},po=function(){function n(e){if(this.constructor===n)throw new Error("Plugin must be sub-classed; not directly instantiated.");this.player=e,Ce(this),delete this.trigger,Me(this,this.constructor.defaultState),oo(e,this.name),this.dispose=he(this,this.dispose),e.on("dispose",this.dispose)}var e=n.prototype;return e.version=function(){return this.constructor.VERSION},e.getEventHash=function(e){return void 0===e&&(e={}),e.name=this.name,e.plugin=this.constructor,e.instance=this,e},e.trigger=function(e,t){return void 0===t&&(t={}),ue(this.eventBusEl_,e,this.getEventHash(t))},e.handleStateChanged=function(){},e.dispose=function(){var e=this.name,t=this.player;this.trigger("dispose"),this.off(),t.off("dispose",this.dispose),t[ho][e]=!1,this.player=this.state=null,t[e]=uo(e,fo[e])},n.isBasic=function(e){var t="string"==typeof e?ao(e):e;return"function"==typeof t&&!n.prototype.isPrototypeOf(t.prototype)},n.registerPlugin=function(e,t){if("string"!=typeof e)throw new Error('Illegal plugin name, "'+e+'", must be a string, was '+typeof e+".");if(io(e))h.warn('A plugin named "'+e+'" already exists. You may want to avoid re-registering plugins!');else if(no.prototype.hasOwnProperty(e))throw new Error('Illegal plugin name, "'+e+'", cannot share a name with an existing player method!');if("function"!=typeof t)throw new Error('Illegal plugin for "'+e+'", must be a function, was '+typeof t+".");return fo[e]=t,e!==co&&(n.isBasic(t)?no.prototype[e]=lo(e,t):no.prototype[e]=uo(e,t)),t},n.deregisterPlugin=function(e){if(e===co)throw new Error("Cannot de-register base plugin.");io(e)&&(delete fo[e],delete no.prototype[e])},n.getPlugins=function(e){var n;return void 0===e&&(e=Object.keys(fo)),e.forEach(function(e){var t=ao(e);t&&((n=n||{})[e]=t)}),n},n.getPluginVersion=function(e){var t=ao(e);return t&&t.VERSION||""},n}();po.getPlugin=ao,po.BASE_PLUGIN_NAME=co,po.registerPlugin(co,po),no.prototype.usingPlugin=function(e){return!!this[ho]&&!0===this[ho][e]},no.prototype.hasPlugin=function(e){return!!io(e)};var mo=function(e){return 0===e.indexOf("#")?e.slice(1):e};function go(e,n,t){var r=go.getPlayer(e);if(r)return n&&h.warn('Player "'+e+'" is already initialised. Options will not be applied.'),t&&r.ready(t),r;var i="string"==typeof e?V("#"+mo(e)):e;if(!m(i))throw new TypeError("The element or ID supplied is not valid. (videojs)");i.ownerDocument.defaultView&&i.ownerDocument.body.contains(i)||h.warn("The element supplied is not included in the DOM"),n=n||{},go.hooks("beforesetup").forEach(function(e){var t=e(i,Pe(n));o(t)&&!Array.isArray(t)?n=Pe(n,t):h.error("please return an object in beforesetup hooks")});var a=De.getComponent("Player");return r=new a(i,n,t),go.hooks("setup").forEach(function(e){return e(r)}),r}if(go.hooks_={},go.hooks=function(e,t){return go.hooks_[e]=go.hooks_[e]||[],t&&(go.hooks_[e]=go.hooks_[e].concat(t)),go.hooks_[e]},go.hook=function(e,t){go.hooks(e,t)},go.hookOnce=function(n,e){go.hooks(n,[].concat(e).map(function(t){return function e(){return go.removeHook(n,e),t.apply(void 0,arguments)}}))},go.removeHook=function(e,t){var n=go.hooks(e).indexOf(t);return!(n<=-1)&&(go.hooks_[e]=go.hooks_[e].slice(),go.hooks_[e].splice(n,1),!0)},!0!==y.VIDEOJS_NO_DYNAMIC_STYLE&&c()){var vo=V(".vjs-styles-defaults");if(!vo){vo=Q("vjs-styles-defaults");var yo=V("head");yo&&yo.insertBefore(vo,yo.firstChild),Z(vo,"\n      .video-js {\n        width: 300px;\n        height: 150px;\n      }\n\n      .vjs-fluid {\n        padding-top: 56.25%\n      }\n    ")}}K(1,go),go.VERSION="7.6.6",go.options=no.prototype.options_,go.getPlayers=function(){return no.players},go.getPlayer=function(e){var t,n=no.players;if("string"==typeof e){var r=mo(e),i=n[r];if(i)return i;t=V("#"+r)}else t=e;if(m(t)){var a=t,o=a.player,s=a.playerId;if(o||n[s])return o||n[s]}},go.getAllPlayers=function(){return Object.keys(no.players).map(function(e){return no.players[e]}).filter(Boolean)},go.players=no.players,go.getComponent=De.getComponent,go.registerComponent=function(e,t){ri.isTech(t)&&h.warn("The "+e+" tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)"),De.registerComponent.call(De,e,t)},go.getTech=ri.getTech,go.registerTech=ri.registerTech,go.use=function(e,t){ii[e]=ii[e]||[],ii[e].push(t)},Object.defineProperty(go,"middleware",{value:{},writeable:!1,enumerable:!0}),Object.defineProperty(go.middleware,"TERMINATOR",{value:oi,writeable:!1,enumerable:!0}),go.browser=st,go.TOUCH_ENABLED=ot,go.extend=function(e,t){void 0===t&&(t={});var n=function(){e.apply(this,arguments)},r={};for(var i in"object"==typeof t?(t.constructor!==Object.prototype.constructor&&(n=t.constructor),r=t):"function"==typeof t&&(n=t),function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(e.super_=t)}(n,e),r)r.hasOwnProperty(i)&&(n.prototype[i]=r[i]);return n},go.mergeOptions=Pe,go.bind=he,go.registerPlugin=po.registerPlugin,go.deregisterPlugin=po.deregisterPlugin,go.plugin=function(e,t){return h.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"),po.registerPlugin(e,t)},go.getPlugins=po.getPlugins,go.getPlugin=po.getPlugin,go.getPluginVersion=po.getPluginVersion,go.addLanguage=function(e,t){var n;return e=(""+e).toLowerCase(),go.options.languages=Pe(go.options.languages,((n={})[e]=t,n)),go.options.languages[e]},go.log=h,go.createLogger=f,go.createTimeRange=go.createTimeRanges=ct,go.formatTime=Di,go.setFormatTime=function(e){Pi=e},go.resetFormatTime=function(){Pi=Ii},go.parseUrl=Ot,go.isCrossOrigin=Bt,go.EventTarget=me,go.on=se,go.one=ce,go.off=le,go.trigger=ue,go.xhr=gr,go.TextTrack=Er,go.AudioTrack=Tr,go.VideoTrack=Ar,["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach(function(e){go[e]=function(){return h.warn("videojs."+e+"() is deprecated; use videojs.dom."+e+"() instead"),W[e].apply(null,arguments)}}),go.computedStyle=r,go.dom=W,go.url=Kt;var _o=Ct(function(e,t){var n,c,r,i,d;n=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/\?#]*\/)*.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,c=/^([^\/?#]*)(.*)$/,r=/(?:\/|^)\.(?=\/)/g,i=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,d={buildAbsoluteURL:function(e,t,n){if(n=n||{},e=e.trim(),!(t=t.trim())){if(!n.alwaysNormalize)return e;var r=d.parseURL(e);if(!r)throw new Error("Error trying to parse base URL.");return r.path=d.normalizePath(r.path),d.buildURLFromParts(r)}var i=d.parseURL(t);if(!i)throw new Error("Error trying to parse relative URL.");if(i.scheme)return n.alwaysNormalize?(i.path=d.normalizePath(i.path),d.buildURLFromParts(i)):t;var a=d.parseURL(e);if(!a)throw new Error("Error trying to parse base URL.");if(!a.netLoc&&a.path&&"/"!==a.path[0]){var o=c.exec(a.path);a.netLoc=o[1],a.path=o[2]}a.netLoc&&!a.path&&(a.path="/");var s={scheme:a.scheme,netLoc:i.netLoc,path:null,params:i.params,query:i.query,fragment:i.fragment};if(!i.netLoc&&(s.netLoc=a.netLoc,"/"!==i.path[0]))if(i.path){var l=a.path,u=l.substring(0,l.lastIndexOf("/")+1)+i.path;s.path=d.normalizePath(u)}else s.path=a.path,i.params||(s.params=a.params,i.query||(s.query=a.query));return null===s.path&&(s.path=n.alwaysNormalize?d.normalizePath(i.path):i.path),d.buildURLFromParts(s)},parseURL:function(e){var t=n.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(r,"");e.length!==(e=e.replace(i,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},e.exports=d});function bo(){return(bo=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Eo(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}function To(e){for(var t,n=e.split(new RegExp('(?:^|,)((?:[^=]*)=(?:"[^"]*"|[^,]*))')),r={},i=n.length;i--;)""!==n[i]&&((t=/([^=]*)=(.*)/.exec(n[i]).slice(1))[0]=t[0].replace(/^\s+|\s+$/g,""),t[1]=t[1].replace(/^\s+|\s+$/g,""),t[1]=t[1].replace(/^['"](.*)['"]$/g,"$1"),r[t[0]]=t[1]);return r}var Ao=function(){function e(){this.listeners={}}var t=e.prototype;return t.on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},t.off=function(e,t){if(!this.listeners[e])return!1;var n=this.listeners[e].indexOf(t);return this.listeners[e].splice(n,1),-1<n},t.trigger=function(e,t){var n,r,i,a=this.listeners[e];if(a)if(2===arguments.length)for(r=a.length,n=0;n<r;++n)a[n].call(this,t);else for(i=Array.prototype.slice.call(arguments,1),r=a.length,n=0;n<r;++n)a[n].apply(this,i)},t.dispose=function(){this.listeners={}},t.pipe=function(t){this.on("data",function(e){t.push(e)})},e}(),wo=function(t){function e(){var e;return(e=t.call(this)||this).buffer="",e}return Eo(e,t),e.prototype.push=function(e){var t;for(this.buffer+=e,t=this.buffer.indexOf("\n");-1<t;t=this.buffer.indexOf("\n"))this.trigger("data",this.buffer.substring(0,t)),this.buffer=this.buffer.substring(t+1)},e}(Ao),So=function(t){function e(){var e;return(e=t.call(this)||this).customParsers=[],e.tagMappers=[],e}Eo(e,t);var n=e.prototype;return n.push=function(r){var l,u,c=this;0!==(r=r.trim()).length&&("#"===r[0]?this.tagMappers.reduce(function(e,t){var n=t(r);return n===r?e:e.concat([n])},[r]).forEach(function(e){for(var t=0;t<c.customParsers.length;t++)if(c.customParsers[t].call(c,e))return;if(0===e.indexOf("#EXT"))if(e=e.replace("\r",""),l=/^#EXTM3U/.exec(e))c.trigger("data",{type:"tag",tagType:"m3u"});else{if(l=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(e))return u={type:"tag",tagType:"inf"},l[1]&&(u.duration=parseFloat(l[1])),l[2]&&(u.title=l[2]),void c.trigger("data",u);if(l=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(e))return u={type:"tag",tagType:"targetduration"},l[1]&&(u.duration=parseInt(l[1],10)),void c.trigger("data",u);if(l=/^#ZEN-TOTAL-DURATION:?([0-9.]*)?/.exec(e))return u={type:"tag",tagType:"totalduration"},l[1]&&(u.duration=parseInt(l[1],10)),void c.trigger("data",u);if(l=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(e))return u={type:"tag",tagType:"version"},l[1]&&(u.version=parseInt(l[1],10)),void c.trigger("data",u);if(l=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(e))return u={type:"tag",tagType:"media-sequence"},l[1]&&(u.number=parseInt(l[1],10)),void c.trigger("data",u);if(l=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(e))return u={type:"tag",tagType:"discontinuity-sequence"},l[1]&&(u.number=parseInt(l[1],10)),void c.trigger("data",u);if(l=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(e))return u={type:"tag",tagType:"playlist-type"},l[1]&&(u.playlistType=l[1]),void c.trigger("data",u);if(l=/^#EXT-X-BYTERANGE:?([0-9.]*)?@?([0-9.]*)?/.exec(e))return u={type:"tag",tagType:"byterange"},l[1]&&(u.length=parseInt(l[1],10)),l[2]&&(u.offset=parseInt(l[2],10)),void c.trigger("data",u);if(l=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(e))return u={type:"tag",tagType:"allow-cache"},l[1]&&(u.allowed=!/NO/.test(l[1])),void c.trigger("data",u);if(l=/^#EXT-X-MAP:?(.*)$/.exec(e)){if(u={type:"tag",tagType:"map"},l[1]){var n=To(l[1]);if(n.URI&&(u.uri=n.URI),n.BYTERANGE){var r=n.BYTERANGE.split("@"),i=r[0],a=r[1];u.byterange={},i&&(u.byterange.length=parseInt(i,10)),a&&(u.byterange.offset=parseInt(a,10))}}c.trigger("data",u)}else if(l=/^#EXT-X-STREAM-INF:?(.*)$/.exec(e)){if(u={type:"tag",tagType:"stream-inf"},l[1]){if(u.attributes=To(l[1]),u.attributes.RESOLUTION){var o=u.attributes.RESOLUTION.split("x"),s={};o[0]&&(s.width=parseInt(o[0],10)),o[1]&&(s.height=parseInt(o[1],10)),u.attributes.RESOLUTION=s}u.attributes.BANDWIDTH&&(u.attributes.BANDWIDTH=parseInt(u.attributes.BANDWIDTH,10)),u.attributes["PROGRAM-ID"]&&(u.attributes["PROGRAM-ID"]=parseInt(u.attributes["PROGRAM-ID"],10))}c.trigger("data",u)}else{if(l=/^#EXT-X-MEDIA:?(.*)$/.exec(e))return u={type:"tag",tagType:"media"},l[1]&&(u.attributes=To(l[1])),void c.trigger("data",u);if(l=/^#EXT-X-ENDLIST/.exec(e))c.trigger("data",{type:"tag",tagType:"endlist"});else if(l=/^#EXT-X-DISCONTINUITY/.exec(e))c.trigger("data",{type:"tag",tagType:"discontinuity"});else{if(l=/^#EXT-X-PROGRAM-DATE-TIME:?(.*)$/.exec(e))return u={type:"tag",tagType:"program-date-time"},l[1]&&(u.dateTimeString=l[1],u.dateTimeObject=new Date(l[1])),void c.trigger("data",u);if(l=/^#EXT-X-KEY:?(.*)$/.exec(e))return u={type:"tag",tagType:"key"},l[1]&&(u.attributes=To(l[1]),u.attributes.IV&&("0x"===u.attributes.IV.substring(0,2).toLowerCase()&&(u.attributes.IV=u.attributes.IV.substring(2)),u.attributes.IV=u.attributes.IV.match(/.{8}/g),u.attributes.IV[0]=parseInt(u.attributes.IV[0],16),u.attributes.IV[1]=parseInt(u.attributes.IV[1],16),u.attributes.IV[2]=parseInt(u.attributes.IV[2],16),u.attributes.IV[3]=parseInt(u.attributes.IV[3],16),u.attributes.IV=new Uint32Array(u.attributes.IV))),void c.trigger("data",u);if(l=/^#EXT-X-START:?(.*)$/.exec(e))return u={type:"tag",tagType:"start"},l[1]&&(u.attributes=To(l[1]),u.attributes["TIME-OFFSET"]=parseFloat(u.attributes["TIME-OFFSET"]),u.attributes.PRECISE=/YES/.test(u.attributes.PRECISE)),void c.trigger("data",u);if(l=/^#EXT-X-CUE-OUT-CONT:?(.*)?$/.exec(e))return u={type:"tag",tagType:"cue-out-cont"},l[1]?u.data=l[1]:u.data="",void c.trigger("data",u);if(l=/^#EXT-X-CUE-OUT:?(.*)?$/.exec(e))return u={type:"tag",tagType:"cue-out"},l[1]?u.data=l[1]:u.data="",void c.trigger("data",u);if(l=/^#EXT-X-CUE-IN:?(.*)?$/.exec(e))return u={type:"tag",tagType:"cue-in"},l[1]?u.data=l[1]:u.data="",void c.trigger("data",u);c.trigger("data",{type:"tag",data:e.slice(4)})}}}else c.trigger("data",{type:"comment",text:e.slice(1)})}):this.trigger("data",{type:"uri",uri:r}))},n.addParser=function(e){var t=this,n=e.expression,r=e.customType,i=e.dataParser,a=e.segment;"function"!=typeof i&&(i=function(e){return e}),this.customParsers.push(function(e){if(n.exec(e))return t.trigger("data",{type:"custom",data:i(e),customType:r,segment:a}),!0})},n.addTagMapper=function(e){var t=e.expression,n=e.map;this.tagMappers.push(function(e){return t.test(e)?n(e):e})},e}(Ao);function Co(e){return!!e&&"object"==typeof e}function xo(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(function(t,n){return Object.keys(n).forEach(function(e){Array.isArray(t[e])&&Array.isArray(n[e])?t[e]=t[e].concat(n[e]):Co(t[e])&&Co(n[e])?t[e]=xo(t[e],n[e]):t[e]=n[e]}),t},{})}function Mo(e){return e.reduce(function(e,t){return e.concat(t)},[])}function Ro(e){if(!e.length)return[];for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t}var Io=function(t){function e(){var e;(e=t.call(this)||this).lineStream=new wo,e.parseStream=new So,e.lineStream.pipe(e.parseStream);var i,a,o=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e),s=[],l={},u={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},c=0;return e.manifest={allowCache:!0,discontinuityStarts:[],segments:[]},e.parseStream.on("data",function(t){var n,r;({tag:function(){({"allow-cache":function(){this.manifest.allowCache=t.allowed,"allowed"in t||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange:function(){var e={};"length"in t&&((l.byterange=e).length=t.length,"offset"in t||(this.trigger("info",{message:"defaulting offset to zero"}),t.offset=0)),"offset"in t&&((l.byterange=e).offset=t.offset)},endlist:function(){this.manifest.endList=!0},inf:function(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),0<t.duration&&(l.duration=t.duration),0===t.duration&&(l.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=s},key:function(){if(t.attributes)if("NONE"!==t.attributes.METHOD)if(t.attributes.URI){if("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"===t.attributes.KEYFORMAT){return-1===["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(t.attributes.METHOD)?void this.trigger("warn",{message:"invalid key method provided for Widevine"}):("SAMPLE-AES-CENC"===t.attributes.METHOD&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),"data:text/plain;base64,"!==t.attributes.URI.substring(0,23)?void this.trigger("warn",{message:"invalid key URI provided for Widevine"}):t.attributes.KEYID&&"0x"===t.attributes.KEYID.substring(0,2)?void(this.manifest.contentProtection={"com.widevine.alpha":{attributes:{schemeIdUri:t.attributes.KEYFORMAT,keyId:t.attributes.KEYID.substring(2)},pssh:function(e){for(var t=y.atob(e||""),n=new Uint8Array(t.length),r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}(t.attributes.URI.split(",")[1])}}):void this.trigger("warn",{message:"invalid key ID provided for Widevine"}))}t.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),a={method:t.attributes.METHOD||"AES-128",uri:t.attributes.URI},void 0!==t.attributes.IV&&(a.iv=t.attributes.IV)}else this.trigger("warn",{message:"ignoring key declaration without URI"});else a=null;else this.trigger("warn",{message:"ignoring key declaration without attribute list"})},"media-sequence":function(){isFinite(t.number)?this.manifest.mediaSequence=t.number:this.trigger("warn",{message:"ignoring invalid media sequence: "+t.number})},"discontinuity-sequence":function(){isFinite(t.number)?(this.manifest.discontinuitySequence=t.number,c=t.number):this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+t.number})},"playlist-type":function(){/VOD|EVENT/.test(t.playlistType)?this.manifest.playlistType=t.playlistType:this.trigger("warn",{message:"ignoring unknown playlist type: "+t.playlist})},map:function(){i={},t.uri&&(i.uri=t.uri),t.byterange&&(i.byterange=t.byterange)},"stream-inf":function(){this.manifest.playlists=s,this.manifest.mediaGroups=this.manifest.mediaGroups||u,t.attributes?(l.attributes||(l.attributes={}),bo(l.attributes,t.attributes)):this.trigger("warn",{message:"ignoring empty stream-inf attributes"})},media:function(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||u,t.attributes&&t.attributes.TYPE&&t.attributes["GROUP-ID"]&&t.attributes.NAME){var e=this.manifest.mediaGroups[t.attributes.TYPE];e[t.attributes["GROUP-ID"]]=e[t.attributes["GROUP-ID"]]||{},n=e[t.attributes["GROUP-ID"]],(r={default:/yes/i.test(t.attributes.DEFAULT)}).default?r.autoselect=!0:r.autoselect=/yes/i.test(t.attributes.AUTOSELECT),t.attributes.LANGUAGE&&(r.language=t.attributes.LANGUAGE),t.attributes.URI&&(r.uri=t.attributes.URI),t.attributes["INSTREAM-ID"]&&(r.instreamId=t.attributes["INSTREAM-ID"]),t.attributes.CHARACTERISTICS&&(r.characteristics=t.attributes.CHARACTERISTICS),t.attributes.FORCED&&(r.forced=/yes/i.test(t.attributes.FORCED)),n[t.attributes.NAME]=r}else this.trigger("warn",{message:"ignoring incomplete or missing media group"})},discontinuity:function(){c+=1,l.discontinuity=!0,this.manifest.discontinuityStarts.push(s.length)},"program-date-time":function(){void 0===this.manifest.dateTimeString&&(this.manifest.dateTimeString=t.dateTimeString,this.manifest.dateTimeObject=t.dateTimeObject),l.dateTimeString=t.dateTimeString,l.dateTimeObject=t.dateTimeObject},targetduration:function(){!isFinite(t.duration)||t.duration<0?this.trigger("warn",{message:"ignoring invalid target duration: "+t.duration}):this.manifest.targetDuration=t.duration},totalduration:function(){!isFinite(t.duration)||t.duration<0?this.trigger("warn",{message:"ignoring invalid total duration: "+t.duration}):this.manifest.totalDuration=t.duration},start:function(){t.attributes&&!isNaN(t.attributes["TIME-OFFSET"])?this.manifest.start={timeOffset:t.attributes["TIME-OFFSET"],precise:t.attributes.PRECISE}:this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"})},"cue-out":function(){l.cueOut=t.data},"cue-out-cont":function(){l.cueOutCont=t.data},"cue-in":function(){l.cueIn=t.data}}[t.tagType]||function(){}).call(o)},uri:function(){l.uri=t.uri,s.push(l),!this.manifest.targetDuration||"duration"in l||(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),l.duration=this.manifest.targetDuration),a&&(l.key=a),l.timeline=c,i&&(l.map=i),l={}},comment:function(){},custom:function(){t.segment?(l.custom=l.custom||{},l.custom[t.customType]=t.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[t.customType]=t.data)}})[t.type].call(o)}),e}Eo(e,t);var n=e.prototype;return n.push=function(e){this.lineStream.push(e)},n.end=function(){this.lineStream.push("\n")},n.addParser=function(e){this.parseStream.addParser(e)},n.addTagMapper=function(e){this.parseStream.addTagMapper(e)},e}(Ao),Po="INVALID_NUMBER_OF_PERIOD",Do="DASH_EMPTY_MANIFEST",Lo="DASH_INVALID_XML",Oo="NO_BASE_URL",No="SEGMENT_TIME_UNSPECIFIED",ko="UNSUPPORTED_UTC_TIMING_SCHEME";function Bo(e,t){return/^[a-z]+:/i.test(t)?t:(/\/\//i.test(e)||(e=ns.buildAbsoluteURL(y.location.href,e)),ns.buildAbsoluteURL(e,t))}function Fo(e){var t=e.baseUrl,n=void 0===t?"":t,r=e.source,i=void 0===r?"":r,a=e.range,o=void 0===a?"":a,s=e.indexRange,l=void 0===s?"":s,u={uri:i,resolvedUri:Bo(n||"",i)};if(o||l){var c=(o||l).split("-"),d=parseInt(c[0],10),h=parseInt(c[1],10);u.byterange={length:h-d+1,offset:d}}return u}function jo(e){var t=e.type,n=void 0===t?"static":t,r=e.duration,i=e.timescale,a=void 0===i?1:i,o=e.sourceDuration,s=rs[n](e),l=function(e,t){for(var n=[],r=e;r<t;r++)n.push(r);return n}(s.start,s.end).map(function(s){return function(e,t){var n=s.duration,r=s.timescale,i=void 0===r?1:r,a=s.periodIndex,o=s.startNumber;return{number:(void 0===o?1:o)+e,duration:n/i,timeline:a,time:t*n}}}(e));if("static"===n){var u=l.length-1;l[u].duration=o-r/a*u}return l}function Uo(e){var t=e.baseUrl,n=e.initialization,r=void 0===n?{}:n,i=e.sourceDuration,a=e.timescale,o=void 0===a?1:a,s=e.indexRange,l=void 0===s?"":s,u=e.duration;if(!t)throw new Error(Oo);var c=Fo({baseUrl:t,source:r.sourceURL,range:r.range}),d=Fo({baseUrl:t,source:t,indexRange:l});if(d.map=c,u){var h=jo(e);h.length&&(d.duration=h[0].duration,d.timeline=h[0].timeline)}else i&&(d.duration=i/o,d.timeline=0);return d.number=0,[d]}function Ho(e,t,n){for(var r=e.sidx.map?e.sidx.map:null,i=e.sidx.duration,a=e.timeline||0,o=e.sidx.byterange,s=o.offset+o.length,l=t.timescale,u=t.references.filter(function(e){return 1!==e.referenceType}),c=[],d=s+t.firstOffset,h=0;h<u.length;h++){var f=t.references[h],p=f.referencedSize,m=f.subsegmentDuration,g=Uo({baseUrl:n,timescale:l,timeline:a,periodIndex:a,duration:m,sourceDuration:i,indexRange:d+"-"+(d+p-1)})[0];r&&(g.map=r),c.push(g),d+=p}return e.segments=c,e}function Go(e){return function(t){return Object.keys(t).map(function(e){return t[e]})}(e.reduce(function(e,t){var n,r=t.attributes.id+(t.attributes.lang||"");e[r]?(t.segments[0]&&(t.segments[0].discontinuity=!0),(n=e[r].segments).push.apply(n,t.segments),t.attributes.contentProtection&&(e[r].attributes.contentProtection=t.attributes.contentProtection)):e[r]=t;return e},{})).map(function(e){return e.discontinuityStarts=function(e,r){return e.reduce(function(e,t,n){return t[r]&&e.push(n),e},[])}(e.segments,"discontinuity"),e})}function Vo(e,t){if(void 0===t&&(t={}),!Object.keys(t).length)return e;for(var n in e){var r=e[n];if(r.sidx){var i=r.sidx.uri+"-"+(o=r.sidx.byterange,void 0,s=o.offset+o.length-1,o.offset+"-"+s),a=t[i]&&t[i].sidx;r.sidx&&a&&Ho(r,a,r.sidx.resolvedUri)}}var o,s;return e}function zo(e){var t,n=e.attributes,r=e.segments,i=e.sidx,a={attributes:(t={NAME:n.id,AUDIO:"audio",SUBTITLES:"subs",RESOLUTION:{width:n.width,height:n.height},CODECS:n.codecs,BANDWIDTH:n.bandwidth},t["PROGRAM-ID"]=1,t),uri:"",endList:"static"===(n.type||"static"),timeline:n.periodIndex,resolvedUri:"",targetDuration:n.duration,segments:r,mediaSequence:r.length?r[0].number:1};return n.contentProtection&&(a.contentProtection=n.contentProtection),i&&(a.sidx=i),a}function Wo(e,t){var n;if(void 0===t&&(t={}),!e.length)return{};var r=e[0].attributes,i=r.sourceDuration,a=r.minimumUpdatePeriod,o=void 0===a?0:a,s=Go(e.filter(function(e){var t=e.attributes;return"video/mp4"===t.mimeType||"video"===t.contentType})).map(zo),l=Go(e.filter(function(e){var t=e.attributes;return"audio/mp4"===t.mimeType||"audio"===t.contentType})),u=e.filter(function(e){var t=e.attributes;return"text/vtt"===t.mimeType||"text"===t.contentType}),c={allowCache:!0,discontinuityStarts:[],segments:[],endList:!0,mediaGroups:(n={AUDIO:{},VIDEO:{}},n["CLOSED-CAPTIONS"]={},n.SUBTITLES={},n),uri:"",duration:i,playlists:Vo(s,t),minimumUpdatePeriod:1e3*o};return l.length&&(c.mediaGroups.AUDIO.audio=function(e,o){var s;void 0===o&&(o={});var t=e.reduce(function(e,t){var n=t.attributes.role&&t.attributes.role.value||"",r=t.attributes.lang||"",i="main";if(r){var a=n?" ("+n+")":"";i=t.attributes.lang+a}return e[i]&&e[i].playlists[0].attributes.BANDWIDTH>t.attributes.bandwidth||(e[i]={language:r,autoselect:!0,default:"main"===n,playlists:Vo([function(e){var t,n=e.attributes,r=e.segments,i=e.sidx,a={attributes:(t={NAME:n.id,BANDWIDTH:n.bandwidth,CODECS:n.codecs},t["PROGRAM-ID"]=1,t),uri:"",endList:"static"===(n.type||"static"),timeline:n.periodIndex,resolvedUri:"",targetDuration:n.duration,segments:r,mediaSequence:r.length?r[0].number:1};return n.contentProtection&&(a.contentProtection=n.contentProtection),i&&(a.sidx=i),a}(t)],o),uri:""},void 0===s&&"main"===n&&((s=t).default=!0)),e},{});s||(t[Object.keys(t)[0]].default=!0);return t}(l,t)),u.length&&(c.mediaGroups.SUBTITLES.subs=function(e,r){return void 0===r&&(r={}),e.reduce(function(e,t){var n=t.attributes.lang||"text";return e[n]||(e[n]={language:n,default:!1,autoselect:!1,playlists:Vo([function(e){var t,n=e.attributes,r=e.segments;return void 0===r&&(r=[{uri:n.baseUrl,timeline:n.periodIndex,resolvedUri:n.baseUrl||"",duration:n.sourceDuration,number:0}],n.duration=n.sourceDuration),{attributes:(t={NAME:n.id,BANDWIDTH:n.bandwidth},t["PROGRAM-ID"]=1,t),uri:"",endList:"static"===(n.type||"static"),timeline:n.periodIndex,resolvedUri:n.baseUrl||"",targetDuration:n.duration,segments:r,mediaSequence:r.length?r[0].number:1}}(t)],r),uri:""}),e},{})}(u,t)),c}function qo(e,t){for(var n,r,i,a,o,s,l,u,c,d,h,f,p=e.type,m=void 0===p?"static":p,g=e.minimumUpdatePeriod,v=void 0===g?0:g,y=e.media,_=void 0===y?"":y,b=e.sourceDuration,E=e.timescale,T=void 0===E?1:E,A=e.startNumber,w=void 0===A?1:A,S=e.periodIndex,C=[],x=-1,M=0;M<t.length;M++){var R=t[M],I=R.d,P=R.r||0,D=R.t||0;x<0&&(x=D),D&&x<D&&(x=D);var L=void 0;if(P<0){var O=M+1;L=O===t.length?"dynamic"===m&&0<v&&0<_.indexOf("$Number$")?(r=x,i=I,void 0,a=(n=e).NOW,o=n.clientOffset,s=n.availabilityStartTime,l=n.timescale,u=void 0===l?1:l,c=n.start,d=void 0===c?0:c,h=n.minimumUpdatePeriod,f=(a+o)/1e3+(void 0===h?0:h)-(s+d),Math.ceil((f*u-r)/i)):(b*T-x)/I:(t[O].t-x)/I}else L=P+1;for(var N=w+C.length+L,k=w+C.length;k<N;)C.push({number:k,duration:I/T,time:x,timeline:S}),x+=I,k++}return C}function Yo(e,t){return e.replace(is,function(a){return function(e,t,n,r){if("$$"===e)return"$";if(void 0===a[t])return e;var i=""+a[t];return"RepresentationID"===t?i:(r=n?parseInt(r,10):1)<=i.length?i:new Array(r-i.length+1).join("0")+i}}(t))}function Ko(n,e){var r={RepresentationID:n.id,Bandwidth:n.bandwidth||0},t=n.initialization,i=void 0===t?{sourceURL:"",range:""}:t,a=Fo({baseUrl:n.baseUrl,source:Yo(i.sourceURL,r),range:i.range});return function(e,t){return e.duration||t?e.duration?jo(e):qo(e,t):[{number:e.startNumber||1,duration:e.sourceDuration,time:0,timeline:e.periodIndex}]}(n,e).map(function(e){r.Number=e.number,r.Time=e.time;var t=Yo(n.media||"",r);return{uri:t,timeline:e.timeline,duration:e.duration,resolvedUri:Bo(n.baseUrl||"",t),map:a,number:e.number}})}function Xo(t,e){var n=t.duration,r=t.segmentUrls,i=void 0===r?[]:r;if(!n&&!e||n&&e)throw new Error(No);var a,o=i.map(function(e){return function(e,t){var n=e.baseUrl,r=e.initialization,i=void 0===r?{}:r,a=Fo({baseUrl:n,source:i.sourceURL,range:i.range}),o=Fo({baseUrl:n,source:t.media,range:t.mediaRange});return o.map=a,o}(t,e)});return n&&(a=jo(t)),e&&(a=qo(t,e)),a.map(function(e,t){if(o[t]){var n=o[t];return n.timeline=e.timeline,n.duration=e.duration,n.number=e.number,n}}).filter(function(e){return e})}function Qo(e){var t,n,r=e.attributes,i=e.segmentInfo;i.template?(n=Ko,t=xo(r,i.template)):i.base?(n=Uo,t=xo(r,i.base)):i.list&&(n=Xo,t=xo(r,i.list));var a={attributes:r};if(!n)return a;var o=n(t,i.timeline);if(t.duration){var s=t,l=s.duration,u=s.timescale,c=void 0===u?1:u;t.duration=l/c}else o.length?t.duration=o.reduce(function(e,t){return Math.max(e,Math.ceil(t.duration))},0):t.duration=0;return a.attributes=t,a.segments=o,i.base&&t.indexRange&&(a.sidx=o[0],a.segments=[]),a}function Zo(e,t){return Ro(e.childNodes).filter(function(e){return e.tagName===t})}function Jo(e){return e.textContent.trim()}function $o(e){var t=/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/.exec(e);if(!t)return 0;var n=t.slice(1),r=n[0],i=n[1],a=n[2],o=n[3],s=n[4],l=n[5];return 31536e3*parseFloat(r||0)+2592e3*parseFloat(i||0)+86400*parseFloat(a||0)+3600*parseFloat(o||0)+60*parseFloat(s||0)+parseFloat(l||0)}function es(e){return e&&e.attributes?Ro(e.attributes).reduce(function(e,t){var n=as[t.name]||as.DEFAULT;return e[t.name]=n(t.value),e},{}):{}}var ts,ns=(function(e,t){var n,c,r,i,d;n=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/\?#]*\/)*.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,c=/^([^\/?#]*)(.*)$/,r=/(?:\/|^)\.(?=\/)/g,i=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,d={buildAbsoluteURL:function(e,t,n){if(n=n||{},e=e.trim(),!(t=t.trim())){if(!n.alwaysNormalize)return e;var r=d.parseURL(e);if(!r)throw new Error("Error trying to parse base URL.");return r.path=d.normalizePath(r.path),d.buildURLFromParts(r)}var i=d.parseURL(t);if(!i)throw new Error("Error trying to parse relative URL.");if(i.scheme)return n.alwaysNormalize?(i.path=d.normalizePath(i.path),d.buildURLFromParts(i)):t;var a=d.parseURL(e);if(!a)throw new Error("Error trying to parse base URL.");if(!a.netLoc&&a.path&&"/"!==a.path[0]){var o=c.exec(a.path);a.netLoc=o[1],a.path=o[2]}a.netLoc&&!a.path&&(a.path="/");var s={scheme:a.scheme,netLoc:i.netLoc,path:null,params:i.params,query:i.query,fragment:i.fragment};if(!i.netLoc&&(s.netLoc=a.netLoc,"/"!==i.path[0]))if(i.path){var l=a.path,u=l.substring(0,l.lastIndexOf("/")+1)+i.path;s.path=d.normalizePath(u)}else s.path=a.path,i.params||(s.params=a.params,i.query||(s.query=a.query));return null===s.path&&(s.path=n.alwaysNormalize?d.normalizePath(i.path):i.path),d.buildURLFromParts(s)},parseURL:function(e){var t=n.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(r,"");e.length!==(e=e.replace(i,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},e.exports=d}(ts={exports:{}},ts.exports),ts.exports),rs={static:function(e){var t=e.duration,n=e.timescale,r=void 0===n?1:n,i=e.sourceDuration;return{start:0,end:Math.ceil(i/(t/r))}},dynamic:function(e){var t=e.NOW,n=e.clientOffset,r=e.availabilityStartTime,i=e.timescale,a=void 0===i?1:i,o=e.duration,s=e.start,l=void 0===s?0:s,u=e.minimumUpdatePeriod,c=void 0===u?0:u,d=e.timeShiftBufferDepth,h=void 0===d?1/0:d,f=(t+n)/1e3,p=r+l,m=f+c-p,g=Math.ceil(m*a/o),v=Math.floor((f-p-h)*a/o),y=Math.floor((f-p)*a/o);return{start:Math.max(0,v),end:Math.min(g,y)}}},is=/\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g,as={mediaPresentationDuration:function(e){return $o(e)},availabilityStartTime:function(e){return function(e){return/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(e)&&(e+="Z"),Date.parse(e)}(e)/1e3},minimumUpdatePeriod:function(e){return $o(e)},timeShiftBufferDepth:function(e){return $o(e)},start:function(e){return $o(e)},width:function(e){return parseInt(e,10)},height:function(e){return parseInt(e,10)},bandwidth:function(e){return parseInt(e,10)},startNumber:function(e){return parseInt(e,10)},timescale:function(e){return parseInt(e,10)},duration:function(e){var t=parseInt(e,10);return isNaN(t)?$o(e):t},d:function(e){return parseInt(e,10)},t:function(e){return parseInt(e,10)},r:function(e){return parseInt(e,10)},DEFAULT:function(e){return e}};function os(e,n){return n.length?Mo(e.map(function(t){return n.map(function(e){return Bo(t,Jo(e))})})):e}function ss(e){var t=Zo(e,"SegmentTemplate")[0],n=Zo(e,"SegmentList")[0],r=n&&Zo(n,"SegmentURL").map(function(e){return xo({tag:"SegmentURL"},es(e))}),i=Zo(e,"SegmentBase")[0],a=n||t,o=a&&Zo(a,"SegmentTimeline")[0],s=n||i||t,l=s&&Zo(s,"Initialization")[0],u=t&&es(t);u&&l?u.initialization=l&&es(l):u&&u.initialization&&(u.initialization={sourceURL:u.initialization});var c={template:u,timeline:o&&Zo(o,"S").map(function(e){return es(e)}),list:n&&xo(es(n),{segmentUrls:r,initialization:es(l)}),base:i&&xo(es(i),{initialization:es(l)})};return Object.keys(c).forEach(function(e){c[e]||delete c[e]}),c}function ls(e){return e.reduce(function(e,t){var n=es(t),r=bs[n.schemeIdUri];if(r){e[r]={attributes:n};var i=Zo(t,"cenc:pssh")[0];if(i){var a=Jo(i),o=a&&function(e){for(var t=y.atob(e),n=new Uint8Array(t.length),r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}(a);e[r].pssh=o}}return e},{})}function us(c,d,h){return function(e){var t=es(e),n=os(d,Zo(e,"BaseURL")),r=Zo(e,"Role")[0],i={role:es(r)},a=xo(c,t,i),o=ls(Zo(e,"ContentProtection"));Object.keys(o).length&&(a=xo(a,{contentProtection:o}));var s=ss(e),l=Zo(e,"Representation"),u=xo(h,s);return Mo(l.map(function(a,o,s){return function(e){var t=Zo(e,"BaseURL"),n=os(o,t),r=xo(a,es(e)),i=ss(e);return n.map(function(e){return{segmentInfo:xo(s,i),attributes:xo(r,{baseUrl:e})}})}}(a,n,u)))}}function cs(e,t){void 0===t&&(t={});var n=t,r=n.manifestUri,i=void 0===r?"":r,a=n.NOW,o=void 0===a?Date.now():a,s=n.clientOffset,l=void 0===s?0:s,u=Zo(e,"Period");if(!u.length)throw new Error(Po);var c=es(e),d=os([i],Zo(e,"BaseURL"));return c.sourceDuration=c.mediaPresentationDuration||0,c.NOW=o,c.clientOffset=l,Mo(u.map(function(u,c){return function(e,t){var n=os(c,Zo(e,"BaseURL")),r=es(e),i=parseInt(r.id,10),a=y.isNaN(i)?t:i,o=xo(u,{periodIndex:a}),s=Zo(e,"AdaptationSet"),l=ss(e);return Mo(s.map(us(o,n,l)))}}(c,d)))}function ds(e){if(""===e)throw new Error(Do);var t=(new y.DOMParser).parseFromString(e,"application/xml"),n=t&&"MPD"===t.documentElement.tagName?t.documentElement:null;if(!n||n&&0<n.getElementsByTagName("parsererror").length)throw new Error(Lo);return n}function hs(e,t){return void 0===t&&(t={}),Wo(function(e){return e.map(Qo)}(cs(ds(e),t)),t.sidxMapping)}function fs(e){return function(e){var t=Zo(e,"UTCTiming")[0];if(!t)return null;var n=es(t);switch(n.schemeIdUri){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":n.method="HEAD";break;case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":n.method="GET";break;case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":n.method="DIRECT",n.value=Date.parse(n.value);break;case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":default:throw new Error(ko)}return n}(ds(e))}var ps,ms,gs,vs,ys,_s,bs={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime"},Es=function(e){return e>>>0},Ts=function(e){return("00"+e.toString(16)).slice(-2)};gs=function(e){return ps(e,["moov","trak"]).reduce(function(e,t){var n,r,i,a,o;return(n=ps(t,["tkhd"])[0])?(r=n[0],a=Es(n[i=0===r?12:20]<<24|n[i+1]<<16|n[i+2]<<8|n[i+3]),(o=ps(t,["mdia","mdhd"])[0])?(i=0===(r=o[0])?12:20,e[a]=Es(o[i]<<24|o[i+1]<<16|o[i+2]<<8|o[i+3]),e):null):null},{})},vs=function(i,e){var t,n,r;return t=ps(e,["moof","traf"]),n=[].concat.apply([],t.map(function(r){return ps(r,["tfhd"]).map(function(e){var t,n;return t=Es(e[4]<<24|e[5]<<16|e[6]<<8|e[7]),n=i[t]||9e4,(ps(r,["tfdt"]).map(function(e){var t,n;return t=e[0],n=Es(e[4]<<24|e[5]<<16|e[6]<<8|e[7]),1===t&&(n*=Math.pow(2,32),n+=Es(e[8]<<24|e[9]<<16|e[10]<<8|e[11])),n})[0]||1/0)/n})})),r=Math.min.apply(null,n),isFinite(r)?r:0},ys=function(e){var t=ps(e,["moov","trak"]),s=[];return t.forEach(function(e){var t=ps(e,["mdia","hdlr"]),o=ps(e,["tkhd"]);t.forEach(function(e,t){var n,r,i=ms(e.subarray(8,12)),a=o[t];"vide"===i&&(r=0===(n=new DataView(a.buffer,a.byteOffset,a.byteLength)).getUint8(0)?n.getUint32(12):n.getUint32(20),s.push(r))})}),s},_s=function(e){var t=ps(e,["moov","trak"]),f=[];return t.forEach(function(e){var t,n,r={},i=ps(e,["tkhd"])[0];i&&(n=(t=new DataView(i.buffer,i.byteOffset,i.byteLength)).getUint8(0),r.id=0===n?t.getUint32(12):t.getUint32(20));var a=ps(e,["mdia","hdlr"])[0];if(a){var o=ms(a.subarray(8,12));r.type="vide"===o?"video":"soun"===o?"audio":o}var s=ps(e,["mdia","minf","stbl","stsd"])[0];if(s){var l=s.subarray(8);r.codec=ms(l.subarray(4,8));var u,c=ps(l,[r.codec])[0];c&&(/^[a-z]vc[1-9]$/i.test(r.codec)?(u=c.subarray(78),"avcC"===ms(u.subarray(4,8))&&11<u.length?(r.codec+=".",r.codec+=Ts(u[9]),r.codec+=Ts(u[10]),r.codec+=Ts(u[11])):r.codec="avc1.4d400d"):/^mp4[a,v]$/i.test(r.codec)&&(u=c.subarray(28),"esds"===ms(u.subarray(4,8))&&20<u.length&&0!==u[19]?(r.codec+="."+Ts(u[19]),r.codec+="."+Ts(u[20]>>>2&63).replace(/^0/,"")):r.codec="mp4a.40.2"))}var d=ps(e,["mdia","mdhd"])[0];if(d&&i){var h=0===n?12:20;r.timescale=Es(d[h]<<24|d[1+h]<<16|d[2+h]<<8|d[3+h])}f.push(r)}),f};function As(e){return new Date(1e3*e-20828448e5)}function ws(e){return{isLeading:(12&e[0])>>>2,dependsOn:3&e[0],isDependedOn:(192&e[1])>>>6,hasRedundancy:(48&e[1])>>>4,paddingValue:(14&e[1])>>>1,isNonSyncSample:1&e[1],degradationPriority:e[2]<<8|e[3]}}function Ss(){this.init=function(){var a={};this.on=function(e,t){a[e]||(a[e]=[]),a[e]=a[e].concat(t)},this.off=function(e,t){var n;return!!a[e]&&(n=a[e].indexOf(t),a[e]=a[e].slice(),a[e].splice(n,1),-1<n)},this.trigger=function(e){var t,n,r,i;if(t=a[e])if(2===arguments.length)for(r=t.length,n=0;n<r;++n)t[n].call(this,arguments[1]);else{for(i=[],n=arguments.length,n=1;n<arguments.length;++n)i.push(arguments[n]);for(r=t.length,n=0;n<r;++n)t[n].apply(this,i)}},this.dispose=function(){a={}}}}var Cs,xs,Ms={findBox:ps=function(e,t){var n,r,i,a,o,s=[];if(!t.length)return null;for(n=0;n<e.byteLength;)r=Es(e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3]),i=ms(e.subarray(n+4,n+8)),a=1<r?n+r:e.byteLength,i===t[0]&&(1===t.length?s.push(e.subarray(n+8,a)):(o=ps(e.subarray(n+8,a),t.slice(1))).length&&(s=s.concat(o))),n=a;return s},parseType:ms=function(e){var t="";return t+=String.fromCharCode(e[0]),t+=String.fromCharCode(e[1]),t+=String.fromCharCode(e[2]),t+=String.fromCharCode(e[3])},timescale:gs,startTime:vs,videoTrackIds:ys,tracks:_s},Rs=Ms.parseType,Is={avc1:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{dataReferenceIndex:t.getUint16(6),width:t.getUint16(24),height:t.getUint16(26),horizresolution:t.getUint16(28)+t.getUint16(30)/16,vertresolution:t.getUint16(32)+t.getUint16(34)/16,frameCount:t.getUint16(40),depth:t.getUint16(74),config:Cs(e.subarray(78,e.byteLength))}},avcC:function(e){var t,n,r,i,a=new DataView(e.buffer,e.byteOffset,e.byteLength),o={configurationVersion:e[0],avcProfileIndication:e[1],profileCompatibility:e[2],avcLevelIndication:e[3],lengthSizeMinusOne:3&e[4],sps:[],pps:[]},s=31&e[5];for(r=6,i=0;i<s;i++)n=a.getUint16(r),r+=2,o.sps.push(new Uint8Array(e.subarray(r,r+n))),r+=n;for(t=e[r],r++,i=0;i<t;i++)n=a.getUint16(r),r+=2,o.pps.push(new Uint8Array(e.subarray(r,r+n))),r+=n;return o},btrt:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{bufferSizeDB:t.getUint32(0),maxBitrate:t.getUint32(4),avgBitrate:t.getUint32(8)}},esds:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),esId:e[6]<<8|e[7],streamPriority:31&e[8],decoderConfig:{objectProfileIndication:e[11],streamType:e[12]>>>2&63,bufferSize:e[13]<<16|e[14]<<8|e[15],maxBitrate:e[16]<<24|e[17]<<16|e[18]<<8|e[19],avgBitrate:e[20]<<24|e[21]<<16|e[22]<<8|e[23],decoderConfigDescriptor:{tag:e[24],length:e[25],audioObjectType:e[26]>>>3&31,samplingFrequencyIndex:(7&e[26])<<1|e[27]>>>7&1,channelConfiguration:e[27]>>>3&15}}}},ftyp:function(e){for(var t=new DataView(e.buffer,e.byteOffset,e.byteLength),n={majorBrand:Rs(e.subarray(0,4)),minorVersion:t.getUint32(4),compatibleBrands:[]},r=8;r<e.byteLength;)n.compatibleBrands.push(Rs(e.subarray(r,r+4))),r+=4;return n},dinf:function(e){return{boxes:Cs(e)}},dref:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),dataReferences:Cs(e.subarray(8))}},hdlr:function(e){var t={version:new DataView(e.buffer,e.byteOffset,e.byteLength).getUint8(0),flags:new Uint8Array(e.subarray(1,4)),handlerType:Rs(e.subarray(8,12)),name:""},n=8;for(n=24;n<e.byteLength;n++){if(0===e[n]){n++;break}t.name+=String.fromCharCode(e[n])}return t.name=decodeURIComponent(escape(t.name)),t},mdat:function(e){return{byteLength:e.byteLength,nals:function(e){var t,n,r=new DataView(e.buffer,e.byteOffset,e.byteLength),i=[];for(t=0;t+4<e.length;t+=n)if(n=r.getUint32(t),t+=4,n<=0)i.push("<span style='color:red;'>MALFORMED DATA</span>");else switch(31&e[t]){case 1:i.push("slice_layer_without_partitioning_rbsp");break;case 5:i.push("slice_layer_without_partitioning_rbsp_idr");break;case 6:i.push("sei_rbsp");break;case 7:i.push("seq_parameter_set_rbsp");break;case 8:i.push("pic_parameter_set_rbsp");break;case 9:i.push("access_unit_delimiter_rbsp");break;default:i.push("UNKNOWN NAL - "+e[t]&31)}return i}(e)}},mdhd:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),r=4,i={version:n.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),language:""};return 1===i.version?(r+=4,i.creationTime=As(n.getUint32(r)),r+=8,i.modificationTime=As(n.getUint32(r)),r+=4,i.timescale=n.getUint32(r),r+=8):(i.creationTime=As(n.getUint32(r)),r+=4,i.modificationTime=As(n.getUint32(r)),r+=4,i.timescale=n.getUint32(r),r+=4),i.duration=n.getUint32(r),r+=4,t=n.getUint16(r),i.language+=String.fromCharCode(96+(t>>10)),i.language+=String.fromCharCode(96+((992&t)>>5)),i.language+=String.fromCharCode(96+(31&t)),i},mdia:function(e){return{boxes:Cs(e)}},mfhd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),sequenceNumber:e[4]<<24|e[5]<<16|e[6]<<8|e[7]}},minf:function(e){return{boxes:Cs(e)}},mp4a:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),n={dataReferenceIndex:t.getUint16(6),channelcount:t.getUint16(16),samplesize:t.getUint16(18),samplerate:t.getUint16(24)+t.getUint16(26)/65536};return 28<e.byteLength&&(n.streamDescriptor=Cs(e.subarray(28))[0]),n},moof:function(e){return{boxes:Cs(e)}},moov:function(e){return{boxes:Cs(e)}},mvex:function(e){return{boxes:Cs(e)}},mvhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),n=4,r={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4))};return 1===r.version?(n+=4,r.creationTime=As(t.getUint32(n)),n+=8,r.modificationTime=As(t.getUint32(n)),n+=4,r.timescale=t.getUint32(n),n+=8):(r.creationTime=As(t.getUint32(n)),n+=4,r.modificationTime=As(t.getUint32(n)),n+=4,r.timescale=t.getUint32(n),n+=4),r.duration=t.getUint32(n),n+=4,r.rate=t.getUint16(n)+t.getUint16(n+2)/16,n+=4,r.volume=t.getUint8(n)+t.getUint8(n+1)/8,n+=2,n+=2,n+=8,r.matrix=new Uint32Array(e.subarray(n,n+36)),n+=36,n+=24,r.nextTrackId=t.getUint32(n),r},pdin:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4)),rate:t.getUint32(4),initialDelay:t.getUint32(8)}},sdtp:function(e){var t,n={version:e[0],flags:new Uint8Array(e.subarray(1,4)),samples:[]};for(t=4;t<e.byteLength;t++)n.samples.push({dependsOn:(48&e[t])>>4,isDependedOn:(12&e[t])>>2,hasRedundancy:3&e[t]});return n},sidx:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),r={version:e[0],flags:new Uint8Array(e.subarray(1,4)),references:[],referenceId:n.getUint32(4),timescale:n.getUint32(8),earliestPresentationTime:n.getUint32(12),firstOffset:n.getUint32(16)},i=n.getUint16(22);for(t=24;i;t+=12,i--)r.references.push({referenceType:(128&e[t])>>>7,referencedSize:2147483647&n.getUint32(t),subsegmentDuration:n.getUint32(t+4),startsWithSap:!!(128&e[t+8]),sapType:(112&e[t+8])>>>4,sapDeltaTime:268435455&n.getUint32(t+8)});return r},smhd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),balance:e[4]+e[5]/256}},stbl:function(e){return{boxes:Cs(e)}},stco:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),r={version:e[0],flags:new Uint8Array(e.subarray(1,4)),chunkOffsets:[]},i=n.getUint32(4);for(t=8;i;t+=4,i--)r.chunkOffsets.push(n.getUint32(t));return r},stsc:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),r=n.getUint32(4),i={version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleToChunks:[]};for(t=8;r;t+=12,r--)i.sampleToChunks.push({firstChunk:n.getUint32(t),samplesPerChunk:n.getUint32(t+4),sampleDescriptionIndex:n.getUint32(t+8)});return i},stsd:function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleDescriptions:Cs(e.subarray(8))}},stsz:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),r={version:e[0],flags:new Uint8Array(e.subarray(1,4)),sampleSize:n.getUint32(4),entries:[]};for(t=12;t<e.byteLength;t+=4)r.entries.push(n.getUint32(t));return r},stts:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),r={version:e[0],flags:new Uint8Array(e.subarray(1,4)),timeToSamples:[]},i=n.getUint32(4);for(t=8;i;t+=8,i--)r.timeToSamples.push({sampleCount:n.getUint32(t),sampleDelta:n.getUint32(t+4)});return r},styp:function(e){return Is.ftyp(e)},tfdt:function(e){var t={version:e[0],flags:new Uint8Array(e.subarray(1,4)),baseMediaDecodeTime:e[4]<<24|e[5]<<16|e[6]<<8|e[7]};return 1===t.version&&(t.baseMediaDecodeTime*=Math.pow(2,32),t.baseMediaDecodeTime+=e[8]<<24|e[9]<<16|e[10]<<8|e[11]),t},tfhd:function(e){var t,n=new DataView(e.buffer,e.byteOffset,e.byteLength),r={version:e[0],flags:new Uint8Array(e.subarray(1,4)),trackId:n.getUint32(4)},i=1&r.flags[2],a=2&r.flags[2],o=8&r.flags[2],s=16&r.flags[2],l=32&r.flags[2],u=65536&r.flags[0],c=131072&r.flags[0];return t=8,i&&(t+=4,r.baseDataOffset=n.getUint32(12),t+=4),a&&(r.sampleDescriptionIndex=n.getUint32(t),t+=4),o&&(r.defaultSampleDuration=n.getUint32(t),t+=4),s&&(r.defaultSampleSize=n.getUint32(t),t+=4),l&&(r.defaultSampleFlags=n.getUint32(t)),u&&(r.durationIsEmpty=!0),!i&&c&&(r.baseDataOffsetIsMoof=!0),r},tkhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),n=4,r={version:t.getUint8(0),flags:new Uint8Array(e.subarray(1,4))};return 1===r.version?(n+=4,r.creationTime=As(t.getUint32(n)),n+=8,r.modificationTime=As(t.getUint32(n)),n+=4,r.trackId=t.getUint32(n),n+=4,n+=8):(r.creationTime=As(t.getUint32(n)),n+=4,r.modificationTime=As(t.getUint32(n)),n+=4,r.trackId=t.getUint32(n),n+=4,n+=4),r.duration=t.getUint32(n),n+=4,n+=8,r.layer=t.getUint16(n),n+=2,r.alternateGroup=t.getUint16(n),n+=2,r.volume=t.getUint8(n)+t.getUint8(n+1)/8,n+=2,n+=2,r.matrix=new Uint32Array(e.subarray(n,n+36)),n+=36,r.width=t.getUint16(n)+t.getUint16(n+2)/16,n+=4,r.height=t.getUint16(n)+t.getUint16(n+2)/16,r},traf:function(e){return{boxes:Cs(e)}},trak:function(e){return{boxes:Cs(e)}},trex:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),trackId:t.getUint32(4),defaultSampleDescriptionIndex:t.getUint32(8),defaultSampleDuration:t.getUint32(12),defaultSampleSize:t.getUint32(16),sampleDependsOn:3&e[20],sampleIsDependedOn:(192&e[21])>>6,sampleHasRedundancy:(48&e[21])>>4,samplePaddingValue:(14&e[21])>>1,sampleIsDifferenceSample:!!(1&e[21]),sampleDegradationPriority:t.getUint16(22)}},trun:function(e){var t,n={version:e[0],flags:new Uint8Array(e.subarray(1,4)),samples:[]},r=new DataView(e.buffer,e.byteOffset,e.byteLength),i=1&n.flags[2],a=4&n.flags[2],o=1&n.flags[1],s=2&n.flags[1],l=4&n.flags[1],u=8&n.flags[1],c=r.getUint32(4),d=8;for(i&&(n.dataOffset=r.getInt32(d),d+=4),a&&c&&(t={flags:ws(e.subarray(d,d+4))},d+=4,o&&(t.duration=r.getUint32(d),d+=4),s&&(t.size=r.getUint32(d),d+=4),u&&(t.compositionTimeOffset=r.getUint32(d),d+=4),n.samples.push(t),c--);c--;)t={},o&&(t.duration=r.getUint32(d),d+=4),s&&(t.size=r.getUint32(d),d+=4),l&&(t.flags=ws(e.subarray(d,d+4)),d+=4),u&&(t.compositionTimeOffset=r.getUint32(d),d+=4),n.samples.push(t);return n},"url ":function(e){return{version:e[0],flags:new Uint8Array(e.subarray(1,4))}},vmhd:function(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);return{version:e[0],flags:new Uint8Array(e.subarray(1,4)),graphicsmode:t.getUint16(4),opcolor:new Uint16Array([t.getUint16(6),t.getUint16(8),t.getUint16(10)])}}},Ps={inspect:Cs=function(e){for(var t,n,r,i,a,o=0,s=[],l=new ArrayBuffer(e.length),u=new Uint8Array(l),c=0;c<e.length;++c)u[c]=e[c];for(t=new DataView(l);o<e.byteLength;)n=t.getUint32(o),r=Rs(e.subarray(o+4,o+8)),i=1<n?o+n:e.byteLength,(a=(Is[r]||function(e){return{data:e}})(e.subarray(o+8,i))).size=n,a.type=r,s.push(a),o=i;return s},textify:xs=function(e,t){var a;return t=t||0,a=new Array(2*t+1).join(" "),e.map(function(i,e){return a+i.type+"\n"+Object.keys(i).filter(function(e){return"type"!==e&&"boxes"!==e}).map(function(e){var t=a+"  "+e+": ",n=i[e];if(n instanceof Uint8Array||n instanceof Uint32Array){var r=Array.prototype.slice.call(new Uint8Array(n.buffer,n.byteOffset,n.byteLength)).map(function(e){return" "+("00"+e.toString(16)).slice(-2)}).join("").match(/.{1,24}/g);return r?1===r.length?t+"<"+r.join("").slice(1)+">":t+"<\n"+r.map(function(e){return a+"  "+e}).join("\n")+"\n"+a+"  >":t+"<>"}return t+JSON.stringify(n,null,2).split("\n").map(function(e,t){return 0===t?e:a+"  "+e}).join("\n")}).join("\n")+(i.boxes?"\n"+xs(i.boxes,t+1):"")}).join("\n")},parseTfdt:Is.tfdt,parseHdlr:Is.hdlr,parseTfhd:Is.tfhd,parseTrun:Is.trun,parseSidx:Is.sidx},Ds=function(e){for(var t=0,n={payloadType:-1,payloadSize:0},r=0,i=0;t<e.byteLength&&128!==e[t];){for(;255===e[t];)r+=255,t++;for(r+=e[t++];255===e[t];)i+=255,t++;if(i+=e[t++],!n.payload&&4===r){n.payloadType=r,n.payloadSize=i,n.payload=e.subarray(t,t+i);break}t+=i,i=r=0}return n},Ls=function(e){return 181!==e.payload[0]?null:49!=(e.payload[1]<<8|e.payload[2])?null:"GA94"!==String.fromCharCode(e.payload[3],e.payload[4],e.payload[5],e.payload[6])?null:3!==e.payload[7]?null:e.payload.subarray(8,e.payload.length-1)},Os=function(e,t){var n,r,i,a,o=[];if(!(64&t[0]))return o;for(r=31&t[0],n=0;n<r;n++)a={type:3&t[2+(i=3*n)],pts:e},4&t[2+i]&&(a.ccData=t[3+i]<<8|t[4+i],o.push(a));return o},Ns=function(e){for(var t,n,r=e.byteLength,i=[],a=1;a<r-2;)0===e[a]&&0===e[a+1]&&3===e[a+2]?(i.push(a+2),a+=2):a++;if(0===i.length)return e;t=r-i.length,n=new Uint8Array(t);var o=0;for(a=0;a<t;o++,a++)o===i[0]&&(o++,i.shift()),n[a]=e[o];return n},ks=4;Ss.prototype.pipe=function(t){return this.on("data",function(e){t.push(e)}),this.on("done",function(e){t.flush(e)}),this.on("partialdone",function(e){t.partialFlush(e)}),this.on("endedtimeline",function(e){t.endTimeline(e)}),this.on("reset",function(e){t.reset(e)}),t},Ss.prototype.push=function(e){this.trigger("data",e)},Ss.prototype.flush=function(e){this.trigger("done",e)},Ss.prototype.partialFlush=function(e){this.trigger("partialdone",e)},Ss.prototype.endTimeline=function(e){this.trigger("endedtimeline",e)},Ss.prototype.reset=function(e){this.trigger("reset",e)};function Bs(){Bs.prototype.init.call(this),this.captionPackets_=[],this.ccStreams_=[new Vs(0,0),new Vs(0,1),new Vs(1,0),new Vs(1,1)],this.reset(),this.ccStreams_.forEach(function(e){e.on("data",this.trigger.bind(this,"data")),e.on("partialdone",this.trigger.bind(this,"partialdone")),e.on("done",this.trigger.bind(this,"done"))},this)}var Fs=Ss;(Bs.prototype=new Fs).push=function(e){var t,n,r;if("sei_rbsp"===e.nalUnitType&&(t=Ds(e.escapedRBSP)).payloadType===ks&&(n=Ls(t)))if(e.dts<this.latestDts_)this.ignoreNextEqualDts_=!0;else{if(e.dts===this.latestDts_&&this.ignoreNextEqualDts_)return this.numSameDts_--,void(this.numSameDts_||(this.ignoreNextEqualDts_=!1));r=Os(e.pts,n),this.captionPackets_=this.captionPackets_.concat(r),this.latestDts_!==e.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=e.dts}},Bs.prototype.flushCCStreams=function(t){this.ccStreams_.forEach(function(e){return"flush"===t?e.flush():e.partialFlush()},this)},Bs.prototype.flushStream=function(e){this.captionPackets_.length&&(this.captionPackets_.forEach(function(e,t){e.presortIndex=t}),this.captionPackets_.sort(function(e,t){return e.pts===t.pts?e.presortIndex-t.presortIndex:e.pts-t.pts}),this.captionPackets_.forEach(function(e){e.type<2&&this.dispatchCea608Packet(e)},this),this.captionPackets_.length=0),this.flushCCStreams(e)},Bs.prototype.flush=function(){return this.flushStream("flush")},Bs.prototype.partialFlush=function(){return this.flushStream("partialFlush")},Bs.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach(function(e){e.reset()})},Bs.prototype.dispatchCea608Packet=function(e){this.setsTextOrXDSActive(e)?this.activeCea608Channel_[e.type]=null:this.setsChannel1Active(e)?this.activeCea608Channel_[e.type]=0:this.setsChannel2Active(e)&&(this.activeCea608Channel_[e.type]=1),null!==this.activeCea608Channel_[e.type]&&this.ccStreams_[(e.type<<1)+this.activeCea608Channel_[e.type]].push(e)},Bs.prototype.setsChannel1Active=function(e){return 4096==(30720&e.ccData)},Bs.prototype.setsChannel2Active=function(e){return 6144==(30720&e.ccData)},Bs.prototype.setsTextOrXDSActive=function(e){return 256==(28928&e.ccData)||4138==(30974&e.ccData)||6186==(30974&e.ccData)};function js(e){return null===e?"":(e=Hs[e]||e,String.fromCharCode(e))}function Us(){for(var e=[],t=15;t--;)e.push("");return e}var Hs={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},Gs=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],Vs=function e(t,n){e.prototype.init.call(this),this.field_=t||0,this.dataChannel_=n||0,this.name_="CC"+(1+(this.field_<<1|this.dataChannel_)),this.setConstants(),this.reset(),this.push=function(e){var t,n,r,i,a;if((t=32639&e.ccData)!==this.lastControlCode_){if(4096==(61440&t)?this.lastControlCode_=t:t!==this.PADDING_&&(this.lastControlCode_=null),r=t>>>8,i=255&t,t!==this.PADDING_)if(t===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(t===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(e.pts),this.flushDisplayed(e.pts),n=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=n,this.startPts_=e.pts;else if(t===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(e.pts);else if(t===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(e.pts);else if(t===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(e.pts);else if(t===this.CARRIAGE_RETURN_)this.clearFormatting(e.pts),this.flushDisplayed(e.pts),this.shiftRowsUp_(),this.startPts_=e.pts;else if(t===this.BACKSPACE_)"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1);else if(t===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(e.pts),this.displayed_=Us();else if(t===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=Us();else if(t===this.RESUME_DIRECT_CAPTIONING_)"paintOn"!==this.mode_&&(this.flushDisplayed(e.pts),this.displayed_=Us()),this.mode_="paintOn",this.startPts_=e.pts;else if(this.isSpecialCharacter(r,i))a=js((r=(3&r)<<8)|i),this[this.mode_](e.pts,a),this.column_++;else if(this.isExtCharacter(r,i))"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1),a=js((r=(3&r)<<8)|i),this[this.mode_](e.pts,a),this.column_++;else if(this.isMidRowCode(r,i))this.clearFormatting(e.pts),this[this.mode_](e.pts," "),this.column_++,14==(14&i)&&this.addFormatting(e.pts,["i"]),1==(1&i)&&this.addFormatting(e.pts,["u"]);else if(this.isOffsetControlCode(r,i))this.column_+=3&i;else if(this.isPAC(r,i)){var o=Gs.indexOf(7968&t);"rollUp"===this.mode_&&(o-this.rollUpRows_+1<0&&(o=this.rollUpRows_-1),this.setRollUp(e.pts,o)),o!==this.row_&&(this.clearFormatting(e.pts),this.row_=o),1&i&&-1===this.formatting_.indexOf("u")&&this.addFormatting(e.pts,["u"]),16==(16&t)&&(this.column_=4*((14&t)>>1)),this.isColorPAC(i)&&14==(14&i)&&this.addFormatting(e.pts,["i"])}else this.isNormalChar(r)&&(0===i&&(i=null),a=js(r),a+=js(i),this[this.mode_](e.pts,a),this.column_+=a.length)}else this.lastControlCode_=null}};Vs.prototype=new Fs,Vs.prototype.flushDisplayed=function(e){var t=this.displayed_.map(function(e){try{return e.trim()}catch(e){return console.error("Skipping malformed caption."),""}}).join("\n").replace(/^\n+|\n+$/g,"");t.length&&this.trigger("data",{startPts:this.startPts_,endPts:e,text:t,stream:this.name_})},Vs.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=Us(),this.nonDisplayed_=Us(),this.lastControlCode_=null,this.column_=0,this.row_=14,this.rollUpRows_=2,this.formatting_=[]},Vs.prototype.setConstants=function(){0===this.dataChannel_?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):1===this.dataChannel_&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=32|this.CONTROL_,this.END_OF_CAPTION_=47|this.CONTROL_,this.ROLL_UP_2_ROWS_=37|this.CONTROL_,this.ROLL_UP_3_ROWS_=38|this.CONTROL_,this.ROLL_UP_4_ROWS_=39|this.CONTROL_,this.CARRIAGE_RETURN_=45|this.CONTROL_,this.RESUME_DIRECT_CAPTIONING_=41|this.CONTROL_,this.BACKSPACE_=33|this.CONTROL_,this.ERASE_DISPLAYED_MEMORY_=44|this.CONTROL_,this.ERASE_NON_DISPLAYED_MEMORY_=46|this.CONTROL_},Vs.prototype.isSpecialCharacter=function(e,t){return e===this.EXT_&&48<=t&&t<=63},Vs.prototype.isExtCharacter=function(e,t){return(e===this.EXT_+1||e===this.EXT_+2)&&32<=t&&t<=63},Vs.prototype.isMidRowCode=function(e,t){return e===this.EXT_&&32<=t&&t<=47},Vs.prototype.isOffsetControlCode=function(e,t){return e===this.OFFSET_&&33<=t&&t<=35},Vs.prototype.isPAC=function(e,t){return e>=this.BASE_&&e<this.BASE_+8&&64<=t&&t<=127},Vs.prototype.isColorPAC=function(e){return 64<=e&&e<=79||96<=e&&e<=127},Vs.prototype.isNormalChar=function(e){return 32<=e&&e<=127},Vs.prototype.setRollUp=function(e,t){if("rollUp"!==this.mode_&&(this.row_=14,this.mode_="rollUp",this.flushDisplayed(e),this.nonDisplayed_=Us(),this.displayed_=Us()),void 0!==t&&t!==this.row_)for(var n=0;n<this.rollUpRows_;n++)this.displayed_[t-n]=this.displayed_[this.row_-n],this.displayed_[this.row_-n]="";void 0===t&&(t=this.row_),this.topRow_=t-this.rollUpRows_+1},Vs.prototype.addFormatting=function(e,t){this.formatting_=this.formatting_.concat(t);var n=t.reduce(function(e,t){return e+"<"+t+">"},"");this[this.mode_](e,n)},Vs.prototype.clearFormatting=function(e){if(this.formatting_.length){var t=this.formatting_.reverse().reduce(function(e,t){return e+"</"+t+">"},"");this.formatting_=[],this[this.mode_](e,t)}},Vs.prototype.popOn=function(e,t){var n=this.nonDisplayed_[this.row_];n+=t,this.nonDisplayed_[this.row_]=n},Vs.prototype.rollUp=function(e,t){var n=this.displayed_[this.row_];n+=t,this.displayed_[this.row_]=n},Vs.prototype.shiftRowsUp_=function(){var e;for(e=0;e<this.topRow_;e++)this.displayed_[e]="";for(e=this.row_+1;e<15;e++)this.displayed_[e]="";for(e=this.topRow_;e<this.row_;e++)this.displayed_[e]=this.displayed_[e+1];this.displayed_[this.row_]=""},Vs.prototype.paintOn=function(e,t){var n=this.displayed_[this.row_];n+=t,this.displayed_[this.row_]=n};function zs(e,t){for(var n=e,r=0;r<t.length;r++){var i=t[r];if(n<i.size)return i;n-=i.size}return null}function Ws(e,c){var r=Ms.findBox(e,["moof","traf"]),t=Ms.findBox(e,["mdat"]),d={},i=[];return t.forEach(function(e,t){var n=r[t];i.push({mdat:e,traf:n})}),i.forEach(function(e){var t,n=e.mdat,r=e.traf,i=Ms.findBox(r,["tfhd"]),a=Ps.parseTfhd(i[0]),o=a.trackId,s=Ms.findBox(r,["tfdt"]),l=0<s.length?Ps.parseTfdt(s[0]).baseMediaDecodeTime:0,u=Ms.findBox(r,["trun"]);c===o&&0<u.length&&(t=function(e,t,n){var r,i,a,o,s=new DataView(e.buffer,e.byteOffset,e.byteLength),l=[];for(i=0;i+4<e.length;i+=a)if(a=s.getUint32(i),i+=4,!(a<=0))switch(31&e[i]){case 6:var u=e.subarray(i+1,i+1+a),c=zs(i,t);r={nalUnitType:"sei_rbsp",size:a,data:u,escapedRBSP:Ys(u),trackId:n},c?(r.pts=c.pts,r.dts=c.dts,o=c):(r.pts=o.pts,r.dts=o.dts),l.push(r)}return l}(n,function(e,t,n){var r=t,i=n.defaultSampleDuration||0,a=n.defaultSampleSize||0,o=n.trackId,s=[];return e.forEach(function(e){var t=Ps.parseTrun(e).samples;t.forEach(function(e){void 0===e.duration&&(e.duration=i),void 0===e.size&&(e.size=a),e.trackId=o,e.dts=r,void 0===e.compositionTimeOffset&&(e.compositionTimeOffset=0),e.pts=r+e.compositionTimeOffset,r+=e.duration}),s=s.concat(t)}),s}(u,l,a),o),d[o]||(d[o]=[]),d[o]=d[o].concat(t))}),d}function qs(e,t){var n=1;for(t<e&&(n=-1);4294967296<Math.abs(t-e);)e+=8589934592*n;return e}var Ys=Ns,Ks=Bs,Xs=function(){var t,a,o,s,l,n,r=!1;this.isInitialized=function(){return r},this.init=function(e){t=new Ks,r=!0,n=!!e&&e.isPartial,t.on("data",function(e){e.startTime=e.startPts/s,e.endTime=e.endPts/s,l.captions.push(e),l.captionStreams[e.stream]=!0})},this.isNewInit=function(e,t){return!(e&&0===e.length||t&&"object"==typeof t&&0===Object.keys(t).length)&&(o!==e[0]||s!==t[o])},this.parse=function(e,t,n){var r;if(!this.isInitialized())return null;if(!t||!n)return null;if(this.isNewInit(t,n))o=t[0],s=n[o];else if(null===o||!s)return a.push(e),null;for(;0<a.length;){var i=a.shift();this.parse(i,t,n)}return null!==(r=function(e,t,n){return null===t?null:{seiNals:Ws(e,t)[t],timescale:n}}(e,o,s))&&r.seiNals?(this.pushNals(r.seiNals),this.flushStream(),l):null},this.pushNals=function(e){if(!this.isInitialized()||!e||0===e.length)return null;e.forEach(function(e){t.push(e)})},this.flushStream=function(){if(!this.isInitialized())return null;n?t.partialFlush():t.flush()},this.clearParsedCaptions=function(){l.captions=[],l.captionStreams={}},this.resetCaptionStream=function(){if(!this.isInitialized())return null;t.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){a=[],s=o=null,l?this.clearParsedCaptions():l={captions:[],captionStreams:{}},this.resetCaptionStream()},this.reset()},Qs=27,Zs=15,Js=21;new Fs;function $s(e){var t=31&e[1];return t<<=8,t|=e[2]}function el(e){return!!(64&e[1])}function tl(e){var t=0;return 1<(48&e[3])>>>4&&(t+=e[4]+1),t}function nl(e){switch(e){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}}function rl(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]}var il,al,ol,sl,ll={parseType:function(e,t){var n=$s(e);return 0===n?"pat":n===t?"pmt":t?"pes":null},parsePat:function(e){var t=el(e),n=4+tl(e);return t&&(n+=e[n]+1),(31&e[n+10])<<8|e[n+11]},parsePmt:function(e){var t={},n=el(e),r=4+tl(e);if(n&&(r+=e[r]+1),1&e[r+5]){var i;i=3+((15&e[r+1])<<8|e[r+2])-4;for(var a=12+((15&e[r+10])<<8|e[r+11]);a<i;){var o=r+a;t[(31&e[o+1])<<8|e[o+2]]=e[o],a+=5+((15&e[o+3])<<8|e[o+4])}return t}},parsePayloadUnitStartIndicator:el,parsePesType:function(e,t){switch(t[$s(e)]){case Qs:return"video";case Zs:return"audio";case Js:return"timed-metadata";default:return null}},parsePesTime:function(e){if(!el(e))return null;var t=4+tl(e);if(t>=e.byteLength)return null;var n,r=null;return 192&(n=e[t+7])&&((r={}).pts=(14&e[t+9])<<27|(255&e[t+10])<<20|(254&e[t+11])<<12|(255&e[t+12])<<5|(254&e[t+13])>>>3,r.pts*=4,r.pts+=(6&e[t+13])>>>1,r.dts=r.pts,64&n&&(r.dts=(14&e[t+14])<<27|(255&e[t+15])<<20|(254&e[t+16])<<12|(255&e[t+17])<<5|(254&e[t+18])>>>3,r.dts*=4,r.dts+=(6&e[t+18])>>>1)),r},videoPacketContainsKeyFrame:function(e){for(var t=4+tl(e),n=e.subarray(t),r=0,i=0,a=!1;i<n.byteLength-3;i++)if(1===n[i+2]){r=i+5;break}for(;r<n.byteLength;)switch(n[r]){case 0:if(0!==n[r-1]){r+=2;break}if(0!==n[r-2]){r++;break}for(i+3!==r-2&&"slice_layer_without_partitioning_rbsp_idr"===nl(31&n[i+3])&&(a=!0);1!==n[++r]&&r<n.length;);i=r-2,r+=3;break;case 1:if(0!==n[r-1]||0!==n[r-2]){r+=3;break}"slice_layer_without_partitioning_rbsp_idr"===nl(31&n[i+3])&&(a=!0),i=r-2,r+=3;break;default:r+=3}return n=n.subarray(i),r-=i,i=0,n&&3<n.byteLength&&"slice_layer_without_partitioning_rbsp_idr"===nl(31&n[i+3])&&(a=!0),a}},ul=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],cl={isLikelyAacData:function(e){return e[0]==="I".charCodeAt(0)&&e[1]==="D".charCodeAt(0)&&e[2]==="3".charCodeAt(0)},parseId3TagSize:function(e,t){var n=e[t+6]<<21|e[t+7]<<14|e[t+8]<<7|e[t+9];return(16&e[t+5])>>4?20+n:10+n},parseAdtsSize:function(e,t){var n=(224&e[t+5])>>5,r=e[t+4]<<3;return 6144&e[t+3]|r|n},parseType:function(e,t){return e[t]==="I".charCodeAt(0)&&e[t+1]==="D".charCodeAt(0)&&e[t+2]==="3".charCodeAt(0)?"timed-metadata":!0&e[t]&&240==(240&e[t+1])?"audio":null},parseSampleRate:function(e){for(var t=0;t+5<e.length;){if(255===e[t]&&240==(246&e[t+1]))return ul[(60&e[t+2])>>>2];t++}return null},parseAacTimestamp:function(e){var t,n,r;t=10,64&e[5]&&(t+=4,t+=rl(e.subarray(10,14)));do{if((n=rl(e.subarray(t+4,t+8)))<1)return null;if("PRIV"===String.fromCharCode(e[t],e[t+1],e[t+2],e[t+3])){r=e.subarray(t+10,t+n+10);for(var i=0;i<r.byteLength;i++)if(0===r[i]){if("com.apple.streaming.transportStreamTimestamp"!==unescape(function(e,t,n){var r,i="";for(r=t;r<n;r++)i+="%"+("00"+e[r].toString(16)).slice(-2);return i}(r,0,i)))break;var a=r.subarray(i+1),o=(1&a[3])<<30|a[4]<<22|a[5]<<14|a[6]<<6|a[7]>>>2;return o*=4,o+=3&a[7]}}t+=10,t+=n}while(t<e.byteLength);return null}},dl=9e4,hl=(il=function(e){return 9e4*e},al=function(e,t){return e*t},ol=function(e){return e/9e4},sl=function(e,t){return e/t},qs),fl={};fl.ts=ll,fl.aac=cl;function pl(e,t,n){for(var r,i,a,o,s=0,l=yl,u=!1;l<=e.byteLength;)if(71!==e[s]||71!==e[l]&&l!==e.byteLength)s++,l++;else{switch(r=e.subarray(s,l),fl.ts.parseType(r,t.pid)){case"pes":i=fl.ts.parsePesType(r,t.table),a=fl.ts.parsePayloadUnitStartIndicator(r),"audio"===i&&a&&(o=fl.ts.parsePesTime(r))&&(o.type="audio",n.audio.push(o),u=!0)}if(u)break;s+=yl,l+=yl}for(s=(l=e.byteLength)-yl,u=!1;0<=s;)if(71!==e[s]||71!==e[l]&&l!==e.byteLength)s--,l--;else{switch(r=e.subarray(s,l),fl.ts.parseType(r,t.pid)){case"pes":i=fl.ts.parsePesType(r,t.table),a=fl.ts.parsePayloadUnitStartIndicator(r),"audio"===i&&a&&(o=fl.ts.parsePesTime(r))&&(o.type="audio",n.audio.push(o),u=!0)}if(u)break;s-=yl,l-=yl}}function ml(e,t,n){for(var r,i,a,o,s,l,u,c=0,d=yl,h=!1,f={data:[],size:0};d<e.byteLength;)if(71!==e[c]||71!==e[d])c++,d++;else{switch(r=e.subarray(c,d),fl.ts.parseType(r,t.pid)){case"pes":if(i=fl.ts.parsePesType(r,t.table),a=fl.ts.parsePayloadUnitStartIndicator(r),"video"===i&&(a&&!h&&(o=fl.ts.parsePesTime(r))&&(o.type="video",n.video.push(o),h=!0),!n.firstKeyFrame)){if(a&&0!==f.size){for(s=new Uint8Array(f.size),l=0;f.data.length;)u=f.data.shift(),s.set(u,l),l+=u.byteLength;if(fl.ts.videoPacketContainsKeyFrame(s)){var p=fl.ts.parsePesTime(s);p?(n.firstKeyFrame=p,n.firstKeyFrame.type="video"):console.warn("Failed to extract PTS/DTS from PES at first keyframe. This could be an unusual TS segment, or else mux.js did not parse your TS segment correctly. If you know your TS segments do contain PTS/DTS on keyframes please file a bug report! You can try ffprobe to double check for yourself.")}f.size=0}f.data.push(r),f.size+=r.byteLength}}if(h&&n.firstKeyFrame)break;c+=yl,d+=yl}for(c=(d=e.byteLength)-yl,h=!1;0<=c;)if(71!==e[c]||71!==e[d])c--,d--;else{switch(r=e.subarray(c,d),fl.ts.parseType(r,t.pid)){case"pes":i=fl.ts.parsePesType(r,t.table),a=fl.ts.parsePayloadUnitStartIndicator(r),"video"===i&&a&&(o=fl.ts.parsePesTime(r))&&(o.type="video",n.video.push(o),h=!0)}if(h)break;c-=yl,d-=yl}}function gl(e){var t={pid:null,table:null},n={};for(var r in!function(e,t){for(var n,r=0,i=yl;i<e.byteLength;)if(71!==e[r]||71!==e[i])r++,i++;else{switch(n=e.subarray(r,i),fl.ts.parseType(n,t.pid)){case"pat":t.pid||(t.pid=fl.ts.parsePat(n));break;case"pmt":t.table||(t.table=fl.ts.parsePmt(n))}if(t.pid&&t.table)return;r+=yl,i+=yl}}(e,t),t.table){if(t.table.hasOwnProperty(r))switch(t.table[r]){case Qs:n.video=[],ml(e,t,n),0===n.video.length&&delete n.video;break;case Zs:n.audio=[],pl(e,t,n),0===n.audio.length&&delete n.audio}}return n}var vl=dl,yl=188,_l=function(e,t){var n;return(n=fl.aac.isLikelyAacData(e)?function(e){for(var t,n=!1,r=0,i=null,a=null,o=0,s=0;3<=e.length-s;){switch(fl.aac.parseType(e,s)){case"timed-metadata":if(e.length-s<10){n=!0;break}if((o=fl.aac.parseId3TagSize(e,s))>e.length){n=!0;break}null===a&&(t=e.subarray(s,s+o),a=fl.aac.parseAacTimestamp(t)),s+=o;break;case"audio":if(e.length-s<7){n=!0;break}if((o=fl.aac.parseAdtsSize(e,s))>e.length){n=!0;break}null===i&&(t=e.subarray(s,s+o),i=fl.aac.parseSampleRate(t)),r++,s+=o;break;default:s++}if(n)return null}if(null===i||null===a)return null;var l=vl/i;return{audio:[{type:"audio",dts:a,pts:a},{type:"audio",dts:a+1024*r*l,pts:a+1024*r*l}]}}(e):gl(e))&&(n.audio||n.video)?(function(e,t){if(e.audio&&e.audio.length){var n=t;void 0===n&&(n=e.audio[0].dts),e.audio.forEach(function(e){e.dts=hl(e.dts,n),e.pts=hl(e.pts,n),e.dtsTime=e.dts/vl,e.ptsTime=e.pts/vl})}if(e.video&&e.video.length){var r=t;if(void 0===r&&(r=e.video[0].dts),e.video.forEach(function(e){e.dts=hl(e.dts,r),e.pts=hl(e.pts,r),e.dtsTime=e.dts/vl,e.ptsTime=e.pts/vl}),e.firstKeyFrame){var i=e.firstKeyFrame;i.dts=hl(i.dts,r),i.pts=hl(i.pts,r),i.dtsTime=i.dts/vl,i.ptsTime=i.dts/vl}}}(n,t),n):null};function bl(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var El=function(e,t,n){return t&&Tl(e.prototype,t),n&&Tl(e,n),e};function Tl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Al=null,wl=(Sl.prototype.decrypt=function(e,t,n,r,i,a){var o=this._key[1],s=e^o[0],l=r^o[1],u=n^o[2],c=t^o[3],d=void 0,h=void 0,f=void 0,p=o.length/4-2,m=void 0,g=4,v=this._tables[1],y=v[0],_=v[1],b=v[2],E=v[3],T=v[4];for(m=0;m<p;m++)d=y[s>>>24]^_[l>>16&255]^b[u>>8&255]^E[255&c]^o[g],h=y[l>>>24]^_[u>>16&255]^b[c>>8&255]^E[255&s]^o[g+1],f=y[u>>>24]^_[c>>16&255]^b[s>>8&255]^E[255&l]^o[g+2],c=y[c>>>24]^_[s>>16&255]^b[l>>8&255]^E[255&u]^o[g+3],g+=4,s=d,l=h,u=f;for(m=0;m<4;m++)i[(3&-m)+a]=T[s>>>24]<<24^T[l>>16&255]<<16^T[u>>8&255]<<8^T[255&c]^o[g++],d=s,s=l,l=u,u=c,c=d},Sl);function Sl(e){bl(this,Sl),Al=Al||function(){var e=[[[],[],[],[],[]],[[],[],[],[],[]]],t=e[0],n=e[1],r=t[4],i=n[4],a=void 0,o=void 0,s=void 0,l=[],u=[],c=void 0,d=void 0,h=void 0,f=void 0,p=void 0;for(a=0;a<256;a++)u[(l[a]=a<<1^283*(a>>7))^a]=a;for(o=s=0;!r[o];o^=c||1,s=u[s]||1)for(h=(h=s^s<<1^s<<2^s<<3^s<<4)>>8^255&h^99,p=16843009*l[d=l[c=l[i[r[o]=h]=o]]]^65537*d^257*c^16843008*o,f=257*l[h]^16843008*h,a=0;a<4;a++)t[a][o]=f=f<<24^f>>>8,n[a][h]=p=p<<24^p>>>8;for(a=0;a<5;a++)t[a]=t[a].slice(0),n[a]=n[a].slice(0);return e}(),this._tables=[[Al[0][0].slice(),Al[0][1].slice(),Al[0][2].slice(),Al[0][3].slice(),Al[0][4].slice()],[Al[1][0].slice(),Al[1][1].slice(),Al[1][2].slice(),Al[1][3].slice(),Al[1][4].slice()]];var t=void 0,n=void 0,r=void 0,i=void 0,a=void 0,o=this._tables[0][4],s=this._tables[1],l=e.length,u=1;if(4!==l&&6!==l&&8!==l)throw new Error("Invalid aes key size");for(i=e.slice(0),a=[],this._key=[i,a],t=l;t<4*l+28;t++)r=i[t-1],(t%l==0||8===l&&t%l==4)&&(r=o[r>>>24]<<24^o[r>>16&255]<<16^o[r>>8&255]<<8^o[255&r],t%l==0&&(r=r<<8^r>>>24^u<<24,u=u<<1^283*(u>>7))),i[t]=i[t-l]^r;for(n=0;t;n++,t--)r=i[3&n?t:t-4],a[n]=t<=4||n<4?r:s[0][o[r>>>24]]^s[1][o[r>>16&255]]^s[2][o[r>>8&255]]^s[3][o[255&r]]}var Cl=(xl.prototype.on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},xl.prototype.off=function(e,t){if(!this.listeners[e])return!1;var n=this.listeners[e].indexOf(t);return this.listeners[e].splice(n,1),-1<n},xl.prototype.trigger=function(e,t){var n=this.listeners[e];if(n)if(2===arguments.length)for(var r=n.length,i=0;i<r;++i)n[i].call(this,t);else for(var a=Array.prototype.slice.call(arguments,1),o=n.length,s=0;s<o;++s)n[s].apply(this,a)},xl.prototype.dispose=function(){this.listeners={}},xl.prototype.pipe=function(t){this.on("data",function(e){t.push(e)})},xl);function xl(){bl(this,xl),this.listeners={}}var Ml,Rl=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(Il,Ml=Cl),Il.prototype.processJob_=function(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null},Il.prototype.push=function(e){this.jobs.push(e),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))},Il);function Il(){bl(this,Il);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,Ml.call(this,Cl));return e.jobs=[],e.delay=1,e.timeout_=null,e}function Pl(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24}function Dl(e,t,n){var r=new Int32Array(e.buffer,e.byteOffset,e.byteLength>>2),i=new wl(Array.prototype.slice.call(t)),a=new Uint8Array(e.byteLength),o=new Int32Array(a.buffer),s=void 0,l=void 0,u=void 0,c=void 0,d=void 0,h=void 0,f=void 0,p=void 0,m=void 0;for(s=n[0],l=n[1],u=n[2],c=n[3],m=0;m<r.length;m+=4)d=Pl(r[m]),h=Pl(r[m+1]),f=Pl(r[m+2]),p=Pl(r[m+3]),i.decrypt(d,h,f,p,o,m),o[m]=Pl(o[m]^s),o[m+1]=Pl(o[m+1]^l),o[m+2]=Pl(o[m+2]^u),o[m+3]=Pl(o[m+3]^c),s=d,l=h,u=f,c=p;return a}var Ll=(Ol.prototype.decryptChunk_=function(t,n,r,i){return function(){var e=Dl(t,n,r);i.set(e,t.byteOffset)}},El(Ol,null,[{key:"STEP",get:function(){return 32e3}}]),Ol);function Ol(e,t,n,r){bl(this,Ol);var i=Ol.STEP,a=new Int32Array(e.buffer),o=new Uint8Array(e.byteLength),s=0;for(this.asyncStream_=new Rl,this.asyncStream_.push(this.decryptChunk_(a.subarray(s,s+i),t,n,o)),s=i;s<a.length;s+=i)n=new Uint32Array([Pl(a[s-4]),Pl(a[s-3]),Pl(a[s-2]),Pl(a[s-1])]),this.asyncStream_.push(this.decryptChunk_(a.subarray(s,s+i),t,n,o));this.asyncStream_.push(function(){r(null,function(e){return e.subarray(0,e.byteLength-e[e.byteLength-1])}(o))})}function Nl(e,t){return/^[a-z]+:/i.test(t)?t:(/\/\//i.test(e)||(e=_o.buildAbsoluteURL(y.location.href,e)),_o.buildAbsoluteURL(e,t))}function kl(e,t,n){return e&&n.responseURL&&t!==n.responseURL?n.responseURL:t}function Bl(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Fl=function(e,t,n){return t&&jl(e.prototype,t),n&&jl(e,n),e};function jl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ul(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function Hl(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function Gl(i,a){["AUDIO","SUBTITLES"].forEach(function(e){for(var t in i.mediaGroups[e])for(var n in i.mediaGroups[e][t]){var r=i.mediaGroups[e][t][n];a(r,e,t,n)}})}function Vl(e,t){var n=Kl(e,{}),r=n.playlists[t.uri];if(!r)return null;if(r.segments&&t.segments&&r.segments.length===t.segments.length&&r.endList===t.endList&&r.mediaSequence===t.mediaSequence)return null;var i=Kl(r,t);r.segments&&(i.segments=function(e,t,n){var r=t.slice();n=n||0;for(var i=Math.min(e.length,t.length+n),a=n;a<i;a++)r[a-n]=Kl(e[a],r[a-n]);return r}(r.segments,t.segments,t.mediaSequence-r.mediaSequence)),i.segments.forEach(function(e){!function(e,t){e.resolvedUri||(e.resolvedUri=Nl(t,e.uri)),e.key&&!e.key.resolvedUri&&(e.key.resolvedUri=Nl(t,e.key.uri)),e.map&&!e.map.resolvedUri&&(e.map.resolvedUri=Nl(t,e.map.uri))}(e,i.resolvedUri)});for(var a=0;a<n.playlists.length;a++)n.playlists[a].uri===t.uri&&(n.playlists[a]=i);return n.playlists[t.uri]=i,n}function zl(e){for(var t=e.playlists.length;t--;){var n=e.playlists[t];(e.playlists[n.uri]=n).resolvedUri=Nl(e.uri,n.uri),n.id=t,n.attributes||(n.attributes={},Xl.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute."))}}function Wl(t){Gl(t,function(e){e.uri&&(e.resolvedUri=Nl(t.uri,e.uri))})}function ql(e,t){var n=e.segments[e.segments.length-1];return t&&n&&n.duration?1e3*n.duration:500*(e.targetDuration||10)}var Yl=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},Kl=go.mergeOptions,Xl=go.log,Ql=(Ul(Zl,go.EventTarget),Fl(Zl,[{key:"playlistRequestError",value:function(e,t,n){this.request=null,n&&(this.state=n),this.error={playlist:this.master.playlists[t],status:e.status,message:"HLS playlist request error at URL: "+t+".",responseText:e.responseText,code:500<=e.status?4:2},this.trigger("error")}},{key:"haveMetadata",value:function(e,t){var n=this;this.request=null,this.state="HAVE_METADATA";var r=new Io;this.customTagParsers.forEach(function(e){return r.addParser(e)}),this.customTagMappers.forEach(function(e){return r.addTagMapper(e)}),r.push(e.responseText),r.end(),r.manifest.uri=t,r.manifest.attributes=r.manifest.attributes||{};var i=Vl(this.master,r.manifest);this.targetDuration=r.manifest.targetDuration,i?(this.master=i,this.media_=this.master.playlists[r.manifest.uri]):this.trigger("playlistunchanged"),this.media().endList||(y.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=y.setTimeout(function(){n.trigger("mediaupdatetimeout")},ql(this.media(),!!i))),this.trigger("loadedplaylist")}},{key:"dispose",value:function(){this.stopRequest(),y.clearTimeout(this.mediaUpdateTimeout),y.clearTimeout(this.finalRenditionTimeout)}},{key:"stopRequest",value:function(){if(this.request){var e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}}},{key:"media",value:function(n,e){var r=this;if(!n)return this.media_;if("HAVE_NOTHING"===this.state)throw new Error("Cannot switch media playlist from "+this.state);if("string"==typeof n){if(!this.master.playlists[n])throw new Error("Unknown playlist URI: "+n);n=this.master.playlists[n]}if(y.clearTimeout(this.finalRenditionTimeout),e){var t=n.targetDuration/2*1e3||5e3;this.finalRenditionTimeout=y.setTimeout(this.media.bind(this,n,!1),t)}else{var i=this.state,a=!this.media_||n.uri!==this.media_.uri;if(this.master.playlists[n.uri].endList)return this.request&&(this.request.onreadystatechange=null,this.request.abort(),this.request=null),this.state="HAVE_METADATA",this.media_=n,void(a&&(this.trigger("mediachanging"),this.trigger("mediachange")));if(a){if(this.state="SWITCHING_MEDIA",this.request){if(n.resolvedUri===this.request.url)return;this.request.onreadystatechange=null,this.request.abort(),this.request=null}this.media_&&this.trigger("mediachanging"),this.request=this.hls_.xhr({uri:n.resolvedUri,withCredentials:this.withCredentials},function(e,t){if(r.request){if(n.resolvedUri=kl(r.handleManifestRedirects,n.resolvedUri,t),e)return r.playlistRequestError(r.request,n.uri,i);r.haveMetadata(t,n.uri),"HAVE_MASTER"===i?r.trigger("loadedmetadata"):r.trigger("mediachange")}})}}}},{key:"pause",value:function(){this.stopRequest(),y.clearTimeout(this.mediaUpdateTimeout),"HAVE_NOTHING"===this.state&&(this.started=!1),"SWITCHING_MEDIA"===this.state?this.media_?this.state="HAVE_METADATA":this.state="HAVE_MASTER":"HAVE_CURRENT_METADATA"===this.state&&(this.state="HAVE_METADATA")}},{key:"load",value:function(e){var t=this;y.clearTimeout(this.mediaUpdateTimeout);var n=this.media();if(e){var r=n?n.targetDuration/2*1e3:5e3;this.mediaUpdateTimeout=y.setTimeout(function(){return t.load()},r)}else this.started?n&&!n.endList?this.trigger("mediaupdatetimeout"):this.trigger("loadedplaylist"):this.start()}},{key:"start",value:function(){var r=this;this.started=!0,this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},function(e,t){if(r.request){if(r.request=null,e)return r.error={status:t.status,message:"HLS playlist request error at URL: "+r.srcUrl+".",responseText:t.responseText,code:2},"HAVE_NOTHING"===r.state&&(r.started=!1),r.trigger("error");var n=new Io;return r.customTagParsers.forEach(function(e){return n.addParser(e)}),r.customTagMappers.forEach(function(e){return n.addTagMapper(e)}),n.push(t.responseText),n.end(),r.state="HAVE_MASTER",r.srcUrl=kl(r.handleManifestRedirects,r.srcUrl,t),n.manifest.uri=r.srcUrl,n.manifest.playlists?(r.master=n.manifest,zl(r.master),Wl(r.master),r.trigger("loadedplaylist"),void(r.request||r.media(n.manifest.playlists[0]))):(r.master={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:y.location.href,playlists:[{uri:r.srcUrl,id:0,resolvedUri:r.srcUrl,attributes:{}}]},r.master.playlists[r.srcUrl]=r.master.playlists[0],r.haveMetadata(t,r.srcUrl),r.trigger("loadedmetadata"))}})}}]),Zl);function Zl(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};Bl(this,Zl);var r=Hl(this,(Zl.__proto__||Object.getPrototypeOf(Zl)).call(this)),i=n.withCredentials,a=void 0!==i&&i,o=n.handleManifestRedirects,s=void 0!==o&&o;r.srcUrl=e,r.hls_=t,r.withCredentials=a,r.handleManifestRedirects=s;var l=t.options_;if(r.customTagParsers=l&&l.customTagParsers||[],r.customTagMappers=l&&l.customTagMappers||[],!r.srcUrl)throw new Error("A non-empty playlist URL is required");return r.state="HAVE_NOTHING",r.on("mediaupdatetimeout",function(){"HAVE_METADATA"===r.state&&(r.state="HAVE_CURRENT_METADATA",r.request=r.hls_.xhr({uri:Nl(r.master.uri,r.media().uri),withCredentials:r.withCredentials},function(e,t){if(r.request)return e?r.playlistRequestError(r.request,r.media().uri,"HAVE_METADATA"):void r.haveMetadata(r.request,r.media().uri)}))}),r}function Jl(e,t,n){var r,i;return void 0===t&&(t=e.mediaSequence+e.segments.length),t<e.mediaSequence?0:(r=function(e,t){var n=0,r=t-e.mediaSequence,i=e.segments[r];if(i){if(void 0!==i.start)return{result:i.start,precise:!0};if(void 0!==i.end)return{result:i.end-i.duration,precise:!0}}for(;r--;){if(void 0!==(i=e.segments[r]).end)return{result:n+i.end,precise:!0};if(n+=i.duration,void 0!==i.start)return{result:n+i.start,precise:!0}}return{result:n,precise:!1}}(e,t)).precise?r.result:(i=function(e,t){for(var n=0,r=void 0,i=t-e.mediaSequence;i<e.segments.length;i++){if(void 0!==(r=e.segments[i]).start)return{result:r.start-n,precise:!0};if(n+=r.duration,void 0!==r.end)return{result:r.end-n,precise:!0}}return{result:-1,precise:!1}}(e,t)).precise?i.result:r.result+n}function $l(e,t,n){if(!e)return 0;if("number"!=typeof n&&(n=0),void 0===t){if(e.totalDuration)return e.totalDuration;if(!e.endList)return y.Infinity}return Jl(e,t,n)}function eu(e,t,n){var r=0;if(n<t){var i=[n,t];t=i[0],n=i[1]}if(t<0){for(var a=t;a<Math.min(0,n);a++)r+=e.targetDuration;t=0}for(var o=t;o<n;o++)r+=e.segments[o].duration;return r}function tu(e){if(!e.segments.length)return 0;for(var t=e.segments.length-1,n=e.segments[t].duration||e.targetDuration,r=n+2*e.targetDuration;t--&&!(r<=(n+=e.segments[t].duration)););return Math.max(0,t)}function nu(e,t,n){if(!e||!e.segments)return null;if(e.endList)return $l(e);if(null===t)return null;t=t||0;var r=n?tu(e):e.segments.length;return Jl(e,e.mediaSequence+r,t)}function ru(e){return e-Math.floor(e)==0}function iu(e,t){if(ru(t))return t+.1*e;for(var n=t.toString().split(".")[1].length,r=1;r<=n;r++){var i=Math.pow(10,r),a=t*i;if(ru(a)||r===n)return(a+e)/i}}function au(e){return e.excludeUntil&&e.excludeUntil>Date.now()}function ou(e){return e.excludeUntil&&e.excludeUntil===1/0}function su(e){var t=au(e);return!e.disabled&&!t}function lu(e,t){return t.attributes&&t.attributes[e]}function uu(e,t){if(1===e.playlists.length)return!0;var n=t.attributes.BANDWIDTH||Number.MAX_VALUE;return 0===e.playlists.filter(function(e){return!!su(e)&&(e.attributes.BANDWIDTH||0)<n}).length}function cu(){return function e(t,r){t=Lu({timeout:45e3},t);var n=e.beforeRequest||go.Hls.xhr.beforeRequest;if(n&&"function"==typeof n){var i=n(t);i&&(t=i)}var a=Du(t,function(e,t){var n=a.response;!e&&n&&(a.responseTime=Date.now(),a.roundTripTime=a.responseTime-a.requestTime,a.bytesReceived=n.byteLength||n.length,a.bandwidth||(a.bandwidth=Math.floor(a.bytesReceived/a.roundTripTime*8*1e3))),t.headers&&(a.responseHeaders=t.headers),e&&"ETIMEDOUT"===e.code&&(a.timedout=!0),e||a.aborted||200===t.statusCode||206===t.statusCode||0===t.statusCode||(e=new Error("XHR Failed with a response of: "+(a&&(n||a.responseText)))),r(e,a)}),o=a.abort;return a.abort=function(){return a.aborted=!0,o.apply(a,arguments)},a.uri=t.uri,a.requestTime=Date.now(),a}}function du(e){var t={};return e.byterange&&(t.Range=function(e){var t;return t=e.offset+e.length-1,"bytes="+e.offset+"-"+t}(e.byterange)),t}function hu(e,t){var n=e.toString(16);return"00".substring(0,2-n.length)+n+(t%2?" ":"")}function fu(e){return 32<=e&&e<126?String.fromCharCode(e):"."}function pu(n){var r={};return Object.keys(n).forEach(function(e){var t=n[e];ArrayBuffer.isView(t)?r[e]={bytes:t.buffer,byteOffset:t.byteOffset,byteLength:t.byteLength}:r[e]=t}),r}function mu(e){var t=e.byterange||{length:1/0,offset:0};return[t.length,t.offset,e.resolvedUri].join(",")}function gu(e){return e.resolvedUri}function vu(e){for(var t=Array.prototype.slice.call(e),n="",r=0;r<t.length/16;r++)n+=t.slice(16*r,16*r+16).map(hu).join("")+" "+t.slice(16*r,16*r+16).map(fu).join("")+"\n";return n}function yu(e){var t=e.playlist,n=e.time,r=void 0===n?void 0:n,i=e.callback;if(!i)throw new Error("getProgramTime: callback must be provided");if(!t||void 0===r)return i({message:"getProgramTime: playlist and time must be provided"});var a=function(e,t){if(!t||!t.segments||0===t.segments.length)return null;for(var n=0,r=void 0,i=0;i<t.segments.length&&!(e<=(n=(r=t.segments[i]).videoTimingInfo?r.videoTimingInfo.transmuxedPresentationEnd:n+r.duration));i++);var a=t.segments[t.segments.length-1];if(a.videoTimingInfo&&a.videoTimingInfo.transmuxedPresentationEnd<e)return null;if(n<e){if(e>n+.25*a.duration)return null;r=a}return{segment:r,estimatedStart:r.videoTimingInfo?r.videoTimingInfo.transmuxedPresentationStart:n-r.duration,type:r.videoTimingInfo?"accurate":"estimate"}}(r,t);if(!a)return i({message:"valid programTime was not found"});if("estimate"===a.type)return i({message:"Accurate programTime could not be determined. Please seek to e.seekTime and try again",seekTime:a.estimatedStart});var o={mediaSeconds:r},s=function(e,t){if(!t.dateTimeObject)return null;var n=t.videoTimingInfo.transmuxerPrependedSeconds,r=e-(t.videoTimingInfo.transmuxedPresentationStart+n);return new Date(t.dateTimeObject.getTime()+1e3*r)}(r,a.segment);return s&&(o.programDateTime=s.toISOString()),i(null,o)}function _u(e){var t=e.programTime,n=e.playlist,r=e.retryCount,i=void 0===r?2:r,a=e.seekTo,o=e.pauseAfterSeek,s=void 0===o||o,l=e.tech,u=e.callback;if(!u)throw new Error("seekToProgramTime: callback must be provided");if(void 0===t||!n||!a)return u({message:"seekToProgramTime: programTime, seekTo and playlist must be provided"});if(!n.endList&&!l.hasStarted_)return u({message:"player must be playing a live stream to start buffering"});if(!function(e){if(!e.segments||0===e.segments.length)return!1;for(var t=0;t<e.segments.length;t++){if(!e.segments[t].dateTimeObject)return!1}return!0}(n))return u({message:"programDateTime tags must be provided in the manifest "+n.resolvedUri});var c=function(e,t){var n=void 0;try{n=new Date(e)}catch(e){return null}if(!t||!t.segments||0===t.segments.length)return null;var r=t.segments[0];if(n<r.dateTimeObject)return null;for(var i=0;i<t.segments.length-1;i++){if(r=t.segments[i],n<t.segments[i+1].dateTimeObject)break}var a=t.segments[t.segments.length-1],o=a.dateTimeObject,s=a.videoTimingInfo?function(e){return e.transmuxedPresentationEnd-e.transmuxedPresentationStart-e.transmuxerPrependedSeconds}(a.videoTimingInfo):a.duration+.25*a.duration;return new Date(o.getTime()+1e3*s)<n?null:(o<n&&(r=a),{segment:r,estimatedStart:r.videoTimingInfo?r.videoTimingInfo.transmuxedPresentationStart:Pu.duration(t,t.mediaSequence+t.segments.indexOf(r)),type:r.videoTimingInfo?"accurate":"estimate"})}(t,n);if(!c)return u({message:t+" was not found in the stream"});var d=c.segment,h=function(e,t){var n=void 0,r=void 0;try{n=new Date(e),r=new Date(t)}catch(e){}var i=n.getTime();return(r.getTime()-i)/1e3}(d.dateTimeObject,t);if("estimate"===c.type)return 0===i?u({message:t+" is not buffered yet. Try again"}):(a(c.estimatedStart+h),void l.one("seeked",function(){_u({programTime:t,playlist:n,retryCount:i-1,seekTo:a,pauseAfterSeek:s,tech:l,callback:u})}));var f=d.start+h;l.one("seeked",function(){return u(null,l.currentTime())}),s&&l.pause(),a(f)}function bu(e,t){var n=[],r=void 0;if(e&&e.length)for(r=0;r<e.length;r++)t(e.start(r),e.end(r))&&n.push([e.start(r),e.end(r)]);return go.createTimeRanges(n)}function Eu(e,n){return bu(e,function(e,t){return e-.1<=n&&n<=t+.1})}function Tu(e,t){return bu(e,function(e){return t<=e-1/30})}function Au(e){var t=[];if(!e||!e.length)return"";for(var n=0;n<e.length;n++)t.push(e.start(n)+" => "+e.end(n));return t.join(", ")}function wu(e){for(var t=[],n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t}function Su(e,t,n){var r=void 0,i=void 0;if(n&&n.cues)for(r=n.cues.length;r--;)(i=n.cues[r]).startTime<=t&&i.endTime>=e&&n.removeCue(i)}function Cu(e){return isNaN(e)||Math.abs(e)===1/0?Number.MAX_VALUE:e}function xu(e,t,n){var r=y.WebKitDataCue||y.VTTCue;if(t&&t.forEach(function(e){var t=e.stream;this.inbandTextTracks_[t].addCue(new r(e.startTime+this.timestampOffset,e.endTime+this.timestampOffset,e.text))},e),n){var i=Cu(e.mediaSource_.duration);if(n.forEach(function(e){var n=e.cueTime+this.timestampOffset;!("number"!=typeof n||y.isNaN(n)||n<0)&&n<1/0&&e.frames.forEach(function(e){var t=new r(n,n,e.value||e.url||e.data||"");t.frame=e,t.value=e,function(e){Object.defineProperties(e.frame,{id:{get:function(){return go.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."),e.value.key}},value:{get:function(){return go.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."),e.value.data}},privateData:{get:function(){return go.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."),e.value.data}}})}(t),this.metadataTrack_.addCue(t)},this)},e),e.metadataTrack_&&e.metadataTrack_.cues&&e.metadataTrack_.cues.length){for(var a=e.metadataTrack_.cues,o=[],s=0;s<a.length;s++)a[s]&&o.push(a[s]);var l=o.reduce(function(e,t){var n=e[t.startTime]||[];return n.push(t),e[t.startTime]=n,e},{}),u=Object.keys(l).sort(function(e,t){return Number(e)-Number(t)});u.forEach(function(e,t){var n=l[e],r=Number(u[t+1])||i;n.forEach(function(e){e.endTime=r})})}}}var Mu=go.createTimeRange,Ru=iu.bind(null,1),Iu=iu.bind(null,-1),Pu={duration:$l,seekable:function(e,t){var n=t||0,r=nu(e,t,!0);return null===r?Mu():Mu(n,r)},safeLiveIndex:tu,getMediaInfoForTime:function(e,t,n,r){var i=void 0,a=void 0,o=e.segments.length,s=t-r;if(s<0){if(0<n)for(i=n-1;0<=i;i--)if(a=e.segments[i],0<(s+=Iu(a.duration)))return{mediaIndex:i,startTime:r-eu(e,n,i)};return{mediaIndex:0,startTime:t}}if(n<0){for(i=n;i<0;i++)if((s-=e.targetDuration)<0)return{mediaIndex:0,startTime:t};n=0}for(i=n;i<o;i++)if(a=e.segments[i],(s-=Ru(a.duration))<0)return{mediaIndex:i,startTime:r+eu(e,n,i)};return{mediaIndex:o-1,startTime:t}},isEnabled:su,isDisabled:function(e){return e.disabled},isBlacklisted:au,isIncompatible:ou,playlistEnd:nu,isAes:function(e){for(var t=0;t<e.segments.length;t++)if(e.segments[t].key)return!0;return!1},isFmp4:function(e){for(var t=0;t<e.segments.length;t++)if(e.segments[t].map)return!0;return!1},hasAttribute:lu,estimateSegmentRequestTime:function(e,t,n,r){var i=3<arguments.length&&void 0!==r?r:0;return lu("BANDWIDTH",n)?(e*n.attributes.BANDWIDTH-8*i)/t:NaN},isLowestEnabledRendition:uu},Du=go.xhr,Lu=go.mergeOptions,Ou=Object.freeze({createTransferableMessage:pu,initSegmentId:mu,segmentKeyId:gu,hexDump:vu,tagDump:function(e){var t=e.bytes;return vu(t)},textRanges:function(e){var t,n,r="",i=void 0;for(i=0;i<e.length;i++)r+=(n=i,(t=e).start(n)+"-"+t.end(n)+" ");return r}}),Nu="undefined"!=typeof window?window:{},ku="undefined"==typeof Symbol?"__target":Symbol(),Bu="application/javascript",Fu=Nu.BlobBuilder||Nu.WebKitBlobBuilder||Nu.MozBlobBuilder||Nu.MSBlobBuilder,ju=Nu.URL||Nu.webkitURL||ju&&ju.msURL,Uu=Nu.Worker;function Hu(i,a){return function(e){var t=this;if(!a)return new Uu(i);if(Uu&&!e){var n=Wu(a.toString().replace(/^function.+?{/,"").slice(0,-1));return this[ku]=new Uu(n),function(e,t){if(!e||!t)return;var n=e.terminate;e.objURL=t,e.terminate=function(){e.objURL&&ju.revokeObjectURL(e.objURL),n.call(e)}}(this[ku],n),this[ku]}var r={postMessage:function(e){t.onmessage&&setTimeout(function(){t.onmessage({data:e,target:r})})}};a.call(r),this.postMessage=function(e){setTimeout(function(){r.onmessage({data:e,target:t})})},this.isThisThread=!0}}if(Uu){var Gu,Vu=Wu("self.onmessage = function () {}"),zu=new Uint8Array(1);try{(Gu=new Uu(Vu)).postMessage(zu,[zu.buffer])}catch(e){Uu=null}finally{ju.revokeObjectURL(Vu),Gu&&Gu.terminate()}}function Wu(t){try{return ju.createObjectURL(new Blob([t],{type:Bu}))}catch(e){var n=new Fu;return n.append(t),ju.createObjectURL(n.getBlob(type))}}function qu(e){return e.map(function(e){return e.replace(/avc1\.(\d+)\.(\d+)/i,function(e,t,n){return"avc1."+("00"+Number(t).toString(16)).slice(-2)+"00"+("00"+Number(n).toString(16)).slice(-2)})})}function Yu(e){var t,n=0<arguments.length&&void 0!==e?e:"",r={codecCount:0};return r.codecCount=n.split(",").length,r.codecCount=r.codecCount||2,(t=/(^|\s|,)+(avc[13])([^ ,]*)/i.exec(n))&&(r.videoCodec=t[2],r.videoObjectTypeIndicator=t[3]),r.audioProfile=/(^|\s|,)+mp4a.[0-9A-Fa-f]+\.([0-9A-Fa-f]+)/i.exec(n),r.audioProfile=r.audioProfile&&r.audioProfile[2],r}function Ku(e,t,n){return e+"/"+t+'; codecs="'+n.filter(function(e){return!!e}).join(", ")+'"'}function Xu(e,t){var n=function(e){return e.segments&&e.segments.length&&e.segments[0].map?"mp4":"mp2t"}(t),r=function(e){var t=e.attributes||{};return t.CODECS?Yu(t.CODECS):ec}(t),i=t.attributes||{},a=!0,o=!1;if(!t)return[];if(e.mediaGroups.AUDIO&&i.AUDIO){var s=e.mediaGroups.AUDIO[i.AUDIO];if(s)for(var l in a=!(o=!0),s)if(!s[l].uri&&!s[l].playlists){a=!0;break}}o&&!r.audioProfile&&(a||(r.audioProfile=function(e,t){if(!e.mediaGroups.AUDIO||!t)return null;var n=e.mediaGroups.AUDIO[t];if(!n)return null;for(var r in n){var i=n[r];if(i.default&&i.playlists)return Yu(i.playlists[0].attributes.CODECS).audioProfile}return null}(e,i.AUDIO)),r.audioProfile||(go.log.warn("Multiple audio tracks present but no audio codec string is specified. Attempting to use the default audio codec (mp4a.40.2)"),r.audioProfile=ec.audioProfile));var u={};r.videoCodec&&(u.video=""+r.videoCodec+r.videoObjectTypeIndicator),r.audioProfile&&(u.audio="mp4a.40."+r.audioProfile);var c=Ku("audio",n,[u.audio]),d=Ku("video",n,[u.video]),h=Ku("video",n,[u.video,u.audio]);return o?!a&&u.video?[d,c]:a||u.video?[h,c]:[c,c]:u.video?[h]:[c]}function Qu(e){return/mp4a\.\d+.\d+/i.test(e)}function Zu(e){return/avc1\.[\da-f]+/i.test(e)}function Ju(e,t){var n=e.addSourceBuffer(t),r=Object.create(null);function i(t){"function"==typeof n[t]?r[t]=function(){return n[t].apply(n,arguments)}:void 0===r[t]&&Object.defineProperty(r,t,{get:function(){return n[t]},set:function(e){return n[t]=e}})}for(var a in r.updating=!1,r.realBuffer_=n)i(a);return r}var $u=new Hu("./transmuxer-worker.worker.js",function(e,t){var At=this;!function(){function e(){this.init=function(){var a={};this.on=function(e,t){a[e]||(a[e]=[]),a[e]=a[e].concat(t)},this.off=function(e,t){var n;return!!a[e]&&(n=a[e].indexOf(t),a[e]=a[e].slice(),a[e].splice(n,1),-1<n)},this.trigger=function(e){var t,n,r,i;if(t=a[e])if(2===arguments.length)for(r=t.length,n=0;n<r;++n)t[n].call(this,arguments[1]);else{for(i=[],n=arguments.length,n=1;n<arguments.length;++n)i.push(arguments[n]);for(r=t.length,n=0;n<r;++n)t[n].apply(this,i)}},this.dispose=function(){a={}}}}e.prototype.pipe=function(t){return this.on("data",function(e){t.push(e)}),this.on("done",function(e){t.flush(e)}),this.on("partialdone",function(e){t.partialFlush(e)}),this.on("endedtimeline",function(e){t.endTimeline(e)}),this.on("reset",function(e){t.reset(e)}),t},e.prototype.push=function(e){this.trigger("data",e)},e.prototype.flush=function(e){this.trigger("done",e)},e.prototype.partialFlush=function(e){this.trigger("partialdone",e)},e.prototype.endTimeline=function(e){this.trigger("endedtimeline",e)},e.prototype.reset=function(e){this.trigger("reset",e)};var u,t,n,i,a,r,o,s,l,c,d,h,f,p,m,g,v,y,_,b,E,T,A,w,S,C,x,M,R,I,P,D,L,O,N,k,B,F,j,U,H=e,G=Math.pow(2,32)-1;!function(){var e;if(T={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],pasp:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},"undefined"!=typeof Uint8Array){for(e in T)T.hasOwnProperty(e)&&(T[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);A=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]),S=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]),w=new Uint8Array([0,0,0,1]),C=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),x=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),M={video:C,audio:x},P=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),I=new Uint8Array([0,0,0,0,0,0,0,0]),D=new Uint8Array([0,0,0,0,0,0,0,0]),L=D,O=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),N=D,R=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}}(),u=function(e){var t,n,r=[],i=0;for(t=1;t<arguments.length;t++)r.push(arguments[t]);for(t=r.length;t--;)i+=r[t].byteLength;for(n=new Uint8Array(i+8),new DataView(n.buffer,n.byteOffset,n.byteLength).setUint32(0,n.byteLength),n.set(e,4),t=0,i=8;t<r.length;t++)n.set(r[t],i),i+=r[t].byteLength;return n},t=function(){return u(T.dinf,u(T.dref,P))},n=function(e){return u(T.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,e.audioobjecttype<<3|e.samplingfrequencyindex>>>1,e.samplingfrequencyindex<<7|e.channelcount<<3,6,1,2]))},m=function(e){return u(T.hdlr,M[e])},p=function(e){var t=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,e.duration>>>24&255,e.duration>>>16&255,e.duration>>>8&255,255&e.duration,85,196,0,0]);return e.samplerate&&(t[12]=e.samplerate>>>24&255,t[13]=e.samplerate>>>16&255,t[14]=e.samplerate>>>8&255,t[15]=255&e.samplerate),u(T.mdhd,t)},f=function(e){return u(T.mdia,p(e),m(e.type),r(e))},a=function(e){return u(T.mfhd,new Uint8Array([0,0,0,0,(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e]))},r=function(e){return u(T.minf,"video"===e.type?u(T.vmhd,R):u(T.smhd,I),t(),v(e))},o=function(e,t){for(var n=[],r=t.length;r--;)n[r]=_(t[r]);return u.apply(null,[T.moof,a(e)].concat(n))},s=function(e){for(var t=e.length,n=[];t--;)n[t]=d(e[t]);return u.apply(null,[T.moov,c(4294967295)].concat(n).concat(l(e)))},l=function(e){for(var t=e.length,n=[];t--;)n[t]=b(e[t]);return u.apply(null,[T.mvex].concat(n))},c=function(e){var t=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return u(T.mvhd,t)},g=function(e){var t,n,r=e.samples||[],i=new Uint8Array(4+r.length);for(n=0;n<r.length;n++)t=r[n].flags,i[n+4]=t.dependsOn<<4|t.isDependedOn<<2|t.hasRedundancy;return u(T.sdtp,i)},v=function(e){return u(T.stbl,y(e),u(T.stts,N),u(T.stsc,L),u(T.stsz,O),u(T.stco,D))},y=function(e){return u(T.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),"video"===e.type?k(e):B(e))},k=function(e){var t,n,r=e.sps||[],i=e.pps||[],a=[],o=[];for(t=0;t<r.length;t++)a.push((65280&r[t].byteLength)>>>8),a.push(255&r[t].byteLength),a=a.concat(Array.prototype.slice.call(r[t]));for(t=0;t<i.length;t++)o.push((65280&i[t].byteLength)>>>8),o.push(255&i[t].byteLength),o=o.concat(Array.prototype.slice.call(i[t]));if(n=[T.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(65280&e.width)>>8,255&e.width,(65280&e.height)>>8,255&e.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),u(T.avcC,new Uint8Array([1,e.profileIdc,e.profileCompatibility,e.levelIdc,255].concat([r.length],a,[i.length],o))),u(T.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]))],e.sarRatio){var s=e.sarRatio[0],l=e.sarRatio[1];n.push(u(T.pasp,new Uint8Array([(4278190080&s)>>24,(16711680&s)>>16,(65280&s)>>8,255&s,(4278190080&l)>>24,(16711680&l)>>16,(65280&l)>>8,255&l])))}return u.apply(null,n)},B=function(e){return u(T.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(65280&e.channelcount)>>8,255&e.channelcount,(65280&e.samplesize)>>8,255&e.samplesize,0,0,0,0,(65280&e.samplerate)>>8,255&e.samplerate,0,0]),n(e))},h=function(e){var t=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,0,(4278190080&e.duration)>>24,(16711680&e.duration)>>16,(65280&e.duration)>>8,255&e.duration,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(65280&e.width)>>8,255&e.width,0,0,(65280&e.height)>>8,255&e.height,0,0]);return u(T.tkhd,t)},_=function(e){var t,n,r,i,a,o;return t=u(T.tfhd,new Uint8Array([0,0,0,58,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),a=Math.floor(e.baseMediaDecodeTime/(1+G)),o=Math.floor(e.baseMediaDecodeTime%(1+G)),n=u(T.tfdt,new Uint8Array([1,0,0,0,a>>>24&255,a>>>16&255,a>>>8&255,255&a,o>>>24&255,o>>>16&255,o>>>8&255,255&o])),92,"audio"===e.type?(r=E(e,92),u(T.traf,t,n,r)):(i=g(e),r=E(e,i.length+92),u(T.traf,t,n,r,i))},d=function(e){return e.duration=e.duration||4294967295,u(T.trak,h(e),f(e))},b=function(e){var t=new Uint8Array([0,0,0,0,(4278190080&e.id)>>24,(16711680&e.id)>>16,(65280&e.id)>>8,255&e.id,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return"video"!==e.type&&(t[t.length-1]=0),u(T.trex,t)},U=function(e,t){var n=0,r=0,i=0,a=0;return e.length&&(void 0!==e[0].duration&&(n=1),void 0!==e[0].size&&(r=2),void 0!==e[0].flags&&(i=4),void 0!==e[0].compositionTimeOffset&&(a=8)),[0,0,n|r|i|a,1,(4278190080&e.length)>>>24,(16711680&e.length)>>>16,(65280&e.length)>>>8,255&e.length,(4278190080&t)>>>24,(16711680&t)>>>16,(65280&t)>>>8,255&t]},j=function(e,t){var n,r,i,a;for(r=e.samples||[],n=U(r,t+=20+16*r.length),a=0;a<r.length;a++)i=r[a],n=n.concat([(4278190080&i.duration)>>>24,(16711680&i.duration)>>>16,(65280&i.duration)>>>8,255&i.duration,(4278190080&i.size)>>>24,(16711680&i.size)>>>16,(65280&i.size)>>>8,255&i.size,i.flags.isLeading<<2|i.flags.dependsOn,i.flags.isDependedOn<<6|i.flags.hasRedundancy<<4|i.flags.paddingValue<<1|i.flags.isNonSyncSample,61440&i.flags.degradationPriority,15&i.flags.degradationPriority,(4278190080&i.compositionTimeOffset)>>>24,(16711680&i.compositionTimeOffset)>>>16,(65280&i.compositionTimeOffset)>>>8,255&i.compositionTimeOffset]);return u(T.trun,new Uint8Array(n))},F=function(e,t){var n,r,i,a;for(r=e.samples||[],n=U(r,t+=20+8*r.length),a=0;a<r.length;a++)i=r[a],n=n.concat([(4278190080&i.duration)>>>24,(16711680&i.duration)>>>16,(65280&i.duration)>>>8,255&i.duration,(4278190080&i.size)>>>24,(16711680&i.size)>>>16,(65280&i.size)>>>8,255&i.size]);return u(T.trun,new Uint8Array(n))},E=function(e,t){return"audio"===e.type?F(e,t):j(e,t)};i=function(){return u(T.ftyp,A,w,A,S)};function V(e,t){var n={size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}};return n.dataOffset=t,n.compositionTimeOffset=e.pts-e.dts,n.duration=e.duration,n.size=4*e.length,n.size+=e.byteLength,e.keyFrame&&(n.flags.dependsOn=2,n.flags.isNonSyncSample=0),n}function z(e){for(var t=[];e--;)t.push(0);return t}function W(){W.prototype.init.call(this),this.captionPackets_=[],this.ccStreams_=[new Re(0,0),new Re(0,1),new Re(1,0),new Re(1,1)],this.reset(),this.ccStreams_.forEach(function(e){e.on("data",this.trigger.bind(this,"data")),e.on("partialdone",this.trigger.bind(this,"partialdone")),e.on("done",this.trigger.bind(this,"done"))},this)}var q,Y,K,X,Q,Z=function(e){return u(T.mdat,e)},J=o,$=function(e){var t,n=i(),r=s(e);return(t=new Uint8Array(n.byteLength+r.byteLength)).set(n),t.set(r,n.byteLength),t},ee=function(e){var t,n,r=[],i=[];for(i.byteLength=0,i.nalCount=0,i.duration=0,t=r.byteLength=0;t<e.length;t++)"access_unit_delimiter_rbsp"===(n=e[t]).nalUnitType?(r.length&&(r.duration=n.dts-r.dts,i.byteLength+=r.byteLength,i.nalCount+=r.length,i.duration+=r.duration,i.push(r)),(r=[n]).byteLength=n.data.byteLength,r.pts=n.pts,r.dts=n.dts):("slice_layer_without_partitioning_rbsp_idr"===n.nalUnitType&&(r.keyFrame=!0),r.duration=n.dts-r.dts,r.byteLength+=n.data.byteLength,r.push(n));return i.length&&(!r.duration||r.duration<=0)&&(r.duration=i[i.length-1].duration),i.byteLength+=r.byteLength,i.nalCount+=r.length,i.duration+=r.duration,i.push(r),i},te=function(e){var t,n,r=[],i=[];for(r.byteLength=0,r.nalCount=0,r.duration=0,r.pts=e[0].pts,r.dts=e[0].dts,i.byteLength=0,i.nalCount=0,i.duration=0,i.pts=e[0].pts,i.dts=e[0].dts,t=0;t<e.length;t++)(n=e[t]).keyFrame?(r.length&&(i.push(r),i.byteLength+=r.byteLength,i.nalCount+=r.nalCount,i.duration+=r.duration),(r=[n]).nalCount=n.length,r.byteLength=n.byteLength,r.pts=n.pts,r.dts=n.dts,r.duration=n.duration):(r.duration+=n.duration,r.nalCount+=n.length,r.byteLength+=n.byteLength,r.push(n));return i.length&&r.duration<=0&&(r.duration=i[i.length-1].duration),i.byteLength+=r.byteLength,i.nalCount+=r.nalCount,i.duration+=r.duration,i.push(r),i},ne=function(e){var t;return!e[0][0].keyFrame&&1<e.length&&(t=e.shift(),e.byteLength-=t.byteLength,e.nalCount-=t.nalCount,e[0][0].dts=t.dts,e[0][0].pts=t.pts,e[0][0].duration+=t.duration),e},re=function(e,t){var n,r,i,a,o,s=t||0,l=[];for(n=0;n<e.length;n++)for(a=e[n],r=0;r<a.length;r++)o=a[r],s+=(i=V(o,s)).size,l.push(i);return l},ie=function(e){var t,n,r,i,a,o,s=0,l=e.byteLength,u=e.nalCount,c=new Uint8Array(l+4*u),d=new DataView(c.buffer);for(t=0;t<e.length;t++)for(i=e[t],n=0;n<i.length;n++)for(a=i[n],r=0;r<a.length;r++)o=a[r],d.setUint32(s,o.data.byteLength),s+=4,c.set(o.data,s),s+=o.data.byteLength;return c},ae=[33,16,5,32,164,27],oe=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],se={96e3:[ae,[227,64],z(154),[56]],88200:[ae,[231],z(170),[56]],64e3:[ae,[248,192],z(240),[56]],48e3:[ae,[255,192],z(268),[55,148,128],z(54),[112]],44100:[ae,[255,192],z(268),[55,163,128],z(84),[112]],32e3:[ae,[255,192],z(268),[55,234],z(226),[112]],24e3:[ae,[255,192],z(268),[55,255,128],z(268),[111,112],z(126),[224]],16e3:[ae,[255,192],z(268),[55,255,128],z(268),[111,255],z(269),[223,108],z(195),[1,192]],12e3:[oe,z(268),[3,127,248],z(268),[6,255,240],z(268),[13,255,224],z(268),[27,253,128],z(259),[56]],11025:[oe,z(268),[3,127,248],z(268),[6,255,240],z(268),[13,255,224],z(268),[27,255,192],z(268),[55,175,128],z(108),[112]],8e3:[oe,z(268),[3,121,16],z(47),[7]]},le=(q=se,Object.keys(q).reduce(function(e,t){return e[t]=new Uint8Array(q[t].reduce(function(e,t){return e.concat(t)},[])),e},{})),ue=9e4,ce=(Y=function(e){return 9e4*e},K=function(e,t){return e*t},X=function(e){return e/9e4},Q=function(e,t){return e/t},function(e,t){return Y(Q(e,t))}),de=function(e,t){return K(X(e),t)},he=function(e,t,n){return X(n?e:e-t)},fe=function(e,t,n,r){var i,a,o,s,l,u=0,c=0,d=0;if(t.length&&(i=ce(e.baseMediaDecodeTime,e.samplerate),a=Math.ceil(ue/(e.samplerate/1024)),n&&r&&(u=i-Math.max(n,r),d=(c=Math.floor(u/a))*a),!(c<1||ue/2<d))){for(o=(o=le[e.samplerate])||t[0].data,s=0;s<c;s++)l=t[0],t.splice(0,0,{data:o,dts:l.dts-a,pts:l.pts-a});e.baseMediaDecodeTime-=Math.floor(de(d,e.samplerate))}},pe=function(e,t,n){return t.minSegmentDts>=n?e:(t.minSegmentDts=1/0,e.filter(function(e){return e.dts>=n&&(t.minSegmentDts=Math.min(t.minSegmentDts,e.dts),t.minSegmentPts=t.minSegmentDts,!0)}))},me=function(e){var t,n,r=[];for(t=0;t<e.length;t++)n=e[t],r.push({size:n.data.byteLength,duration:1024});return r},ge=function(e){var t,n,r=0,i=new Uint8Array(function(e){var t,n=0;for(t=0;t<e.length;t++)n+=e[t].data.byteLength;return n}(e));for(t=0;t<e.length;t++)n=e[t],i.set(n.data,r),r+=n.data.byteLength;return i},ve=ue,ye=function(e){delete e.minSegmentDts,delete e.maxSegmentDts,delete e.minSegmentPts,delete e.maxSegmentPts},_e=function(e,t){var n,r=e.minSegmentDts;return t||(r-=e.timelineStartInfo.dts),n=e.timelineStartInfo.baseMediaDecodeTime,n+=r,n=Math.max(0,n),"audio"===e.type&&(n*=e.samplerate/ve,n=Math.floor(n)),n},be=function(e,t){"number"==typeof t.pts&&(void 0===e.timelineStartInfo.pts&&(e.timelineStartInfo.pts=t.pts),void 0===e.minSegmentPts?e.minSegmentPts=t.pts:e.minSegmentPts=Math.min(e.minSegmentPts,t.pts),void 0===e.maxSegmentPts?e.maxSegmentPts=t.pts:e.maxSegmentPts=Math.max(e.maxSegmentPts,t.pts)),"number"==typeof t.dts&&(void 0===e.timelineStartInfo.dts&&(e.timelineStartInfo.dts=t.dts),void 0===e.minSegmentDts?e.minSegmentDts=t.dts:e.minSegmentDts=Math.min(e.minSegmentDts,t.dts),void 0===e.maxSegmentDts?e.maxSegmentDts=t.dts:e.maxSegmentDts=Math.max(e.maxSegmentDts,t.dts))},Ee=function(e){for(var t=0,n={payloadType:-1,payloadSize:0},r=0,i=0;t<e.byteLength&&128!==e[t];){for(;255===e[t];)r+=255,t++;for(r+=e[t++];255===e[t];)i+=255,t++;if(i+=e[t++],!n.payload&&4===r){n.payloadType=r,n.payloadSize=i,n.payload=e.subarray(t,t+i);break}t+=i,i=r=0}return n},Te=function(e){return 181!==e.payload[0]?null:49!=(e.payload[1]<<8|e.payload[2])?null:"GA94"!==String.fromCharCode(e.payload[3],e.payload[4],e.payload[5],e.payload[6])?null:3!==e.payload[7]?null:e.payload.subarray(8,e.payload.length-1)},Ae=function(e,t){var n,r,i,a,o=[];if(!(64&t[0]))return o;for(r=31&t[0],n=0;n<r;n++)a={type:3&t[2+(i=3*n)],pts:e},4&t[2+i]&&(a.ccData=t[3+i]<<8|t[4+i],o.push(a));return o},we=4;(W.prototype=new H).push=function(e){var t,n,r;if("sei_rbsp"===e.nalUnitType&&(t=Ee(e.escapedRBSP)).payloadType===we&&(n=Te(t)))if(e.dts<this.latestDts_)this.ignoreNextEqualDts_=!0;else{if(e.dts===this.latestDts_&&this.ignoreNextEqualDts_)return this.numSameDts_--,void(this.numSameDts_||(this.ignoreNextEqualDts_=!1));r=Ae(e.pts,n),this.captionPackets_=this.captionPackets_.concat(r),this.latestDts_!==e.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=e.dts}},W.prototype.flushCCStreams=function(t){this.ccStreams_.forEach(function(e){return"flush"===t?e.flush():e.partialFlush()},this)},W.prototype.flushStream=function(e){this.captionPackets_.length&&(this.captionPackets_.forEach(function(e,t){e.presortIndex=t}),this.captionPackets_.sort(function(e,t){return e.pts===t.pts?e.presortIndex-t.presortIndex:e.pts-t.pts}),this.captionPackets_.forEach(function(e){e.type<2&&this.dispatchCea608Packet(e)},this),this.captionPackets_.length=0),this.flushCCStreams(e)},W.prototype.flush=function(){return this.flushStream("flush")},W.prototype.partialFlush=function(){return this.flushStream("partialFlush")},W.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach(function(e){e.reset()})},W.prototype.dispatchCea608Packet=function(e){this.setsTextOrXDSActive(e)?this.activeCea608Channel_[e.type]=null:this.setsChannel1Active(e)?this.activeCea608Channel_[e.type]=0:this.setsChannel2Active(e)&&(this.activeCea608Channel_[e.type]=1),null!==this.activeCea608Channel_[e.type]&&this.ccStreams_[(e.type<<1)+this.activeCea608Channel_[e.type]].push(e)},W.prototype.setsChannel1Active=function(e){return 4096==(30720&e.ccData)},W.prototype.setsChannel2Active=function(e){return 6144==(30720&e.ccData)},W.prototype.setsTextOrXDSActive=function(e){return 256==(28928&e.ccData)||4138==(30974&e.ccData)||6186==(30974&e.ccData)};function Se(e){return null===e?"":(e=xe[e]||e,String.fromCharCode(e))}function Ce(){for(var e=[],t=15;t--;)e.push("");return e}var xe={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},Me=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],Re=function e(t,n){e.prototype.init.call(this),this.field_=t||0,this.dataChannel_=n||0,this.name_="CC"+(1+(this.field_<<1|this.dataChannel_)),this.setConstants(),this.reset(),this.push=function(e){var t,n,r,i,a;if((t=32639&e.ccData)!==this.lastControlCode_){if(4096==(61440&t)?this.lastControlCode_=t:t!==this.PADDING_&&(this.lastControlCode_=null),r=t>>>8,i=255&t,t!==this.PADDING_)if(t===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(t===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(e.pts),this.flushDisplayed(e.pts),n=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=n,this.startPts_=e.pts;else if(t===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(e.pts);else if(t===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(e.pts);else if(t===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(e.pts);else if(t===this.CARRIAGE_RETURN_)this.clearFormatting(e.pts),this.flushDisplayed(e.pts),this.shiftRowsUp_(),this.startPts_=e.pts;else if(t===this.BACKSPACE_)"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1);else if(t===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(e.pts),this.displayed_=Ce();else if(t===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=Ce();else if(t===this.RESUME_DIRECT_CAPTIONING_)"paintOn"!==this.mode_&&(this.flushDisplayed(e.pts),this.displayed_=Ce()),this.mode_="paintOn",this.startPts_=e.pts;else if(this.isSpecialCharacter(r,i))a=Se((r=(3&r)<<8)|i),this[this.mode_](e.pts,a),this.column_++;else if(this.isExtCharacter(r,i))"popOn"===this.mode_?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1),a=Se((r=(3&r)<<8)|i),this[this.mode_](e.pts,a),this.column_++;else if(this.isMidRowCode(r,i))this.clearFormatting(e.pts),this[this.mode_](e.pts," "),this.column_++,14==(14&i)&&this.addFormatting(e.pts,["i"]),1==(1&i)&&this.addFormatting(e.pts,["u"]);else if(this.isOffsetControlCode(r,i))this.column_+=3&i;else if(this.isPAC(r,i)){var o=Me.indexOf(7968&t);"rollUp"===this.mode_&&(o-this.rollUpRows_+1<0&&(o=this.rollUpRows_-1),this.setRollUp(e.pts,o)),o!==this.row_&&(this.clearFormatting(e.pts),this.row_=o),1&i&&-1===this.formatting_.indexOf("u")&&this.addFormatting(e.pts,["u"]),16==(16&t)&&(this.column_=4*((14&t)>>1)),this.isColorPAC(i)&&14==(14&i)&&this.addFormatting(e.pts,["i"])}else this.isNormalChar(r)&&(0===i&&(i=null),a=Se(r),a+=Se(i),this[this.mode_](e.pts,a),this.column_+=a.length)}else this.lastControlCode_=null}};Re.prototype=new H,Re.prototype.flushDisplayed=function(e){var t=this.displayed_.map(function(e){try{return e.trim()}catch(e){return console.error("Skipping malformed caption."),""}}).join("\n").replace(/^\n+|\n+$/g,"");t.length&&this.trigger("data",{startPts:this.startPts_,endPts:e,text:t,stream:this.name_})},Re.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=Ce(),this.nonDisplayed_=Ce(),this.lastControlCode_=null,this.column_=0,this.row_=14,this.rollUpRows_=2,this.formatting_=[]},Re.prototype.setConstants=function(){0===this.dataChannel_?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):1===this.dataChannel_&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=32|this.CONTROL_,this.END_OF_CAPTION_=47|this.CONTROL_,this.ROLL_UP_2_ROWS_=37|this.CONTROL_,this.ROLL_UP_3_ROWS_=38|this.CONTROL_,this.ROLL_UP_4_ROWS_=39|this.CONTROL_,this.CARRIAGE_RETURN_=45|this.CONTROL_,this.RESUME_DIRECT_CAPTIONING_=41|this.CONTROL_,this.BACKSPACE_=33|this.CONTROL_,this.ERASE_DISPLAYED_MEMORY_=44|this.CONTROL_,this.ERASE_NON_DISPLAYED_MEMORY_=46|this.CONTROL_},Re.prototype.isSpecialCharacter=function(e,t){return e===this.EXT_&&48<=t&&t<=63},Re.prototype.isExtCharacter=function(e,t){return(e===this.EXT_+1||e===this.EXT_+2)&&32<=t&&t<=63},Re.prototype.isMidRowCode=function(e,t){return e===this.EXT_&&32<=t&&t<=47},Re.prototype.isOffsetControlCode=function(e,t){return e===this.OFFSET_&&33<=t&&t<=35},Re.prototype.isPAC=function(e,t){return e>=this.BASE_&&e<this.BASE_+8&&64<=t&&t<=127},Re.prototype.isColorPAC=function(e){return 64<=e&&e<=79||96<=e&&e<=127},Re.prototype.isNormalChar=function(e){return 32<=e&&e<=127},Re.prototype.setRollUp=function(e,t){if("rollUp"!==this.mode_&&(this.row_=14,this.mode_="rollUp",this.flushDisplayed(e),this.nonDisplayed_=Ce(),this.displayed_=Ce()),void 0!==t&&t!==this.row_)for(var n=0;n<this.rollUpRows_;n++)this.displayed_[t-n]=this.displayed_[this.row_-n],this.displayed_[this.row_-n]="";void 0===t&&(t=this.row_),this.topRow_=t-this.rollUpRows_+1},Re.prototype.addFormatting=function(e,t){this.formatting_=this.formatting_.concat(t);var n=t.reduce(function(e,t){return e+"<"+t+">"},"");this[this.mode_](e,n)},Re.prototype.clearFormatting=function(e){if(this.formatting_.length){var t=this.formatting_.reverse().reduce(function(e,t){return e+"</"+t+">"},"");this.formatting_=[],this[this.mode_](e,t)}},Re.prototype.popOn=function(e,t){var n=this.nonDisplayed_[this.row_];n+=t,this.nonDisplayed_[this.row_]=n},Re.prototype.rollUp=function(e,t){var n=this.displayed_[this.row_];n+=t,this.displayed_[this.row_]=n},Re.prototype.shiftRowsUp_=function(){var e;for(e=0;e<this.topRow_;e++)this.displayed_[e]="";for(e=this.row_+1;e<15;e++)this.displayed_[e]="";for(e=this.topRow_;e<this.row_;e++)this.displayed_[e]=this.displayed_[e+1];this.displayed_[this.row_]=""},Re.prototype.paintOn=function(e,t){var n=this.displayed_[this.row_];n+=t,this.displayed_[this.row_]=n};function Ie(e,t){var n=1;for(t<e&&(n=-1);4294967296<Math.abs(t-e);)e+=8589934592*n;return e}function Pe(e){var t,n;Pe.prototype.init.call(this),this.type_=e||"shared",this.push=function(e){"shared"!==this.type_&&e.type!==this.type_||(void 0===n&&(n=e.dts),e.dts=Ie(e.dts,n),e.pts=Ie(e.pts,n),t=e.dts,this.trigger("data",e))},this.flush=function(){n=t,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.discontinuity=function(){t=n=void 0},this.reset=function(){this.discontinuity(),this.trigger("reset")}}var De={CaptionStream:W,Cea608Stream:Re},Le={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21};Pe.prototype=new H;function Oe(e,t,n){var r,i="";for(r=t;r<n;r++)i+="%"+("00"+e[r].toString(16)).slice(-2);return i}function Ne(e,t,n){return decodeURIComponent(Oe(e,t,n))}function ke(e){return e[0]<<21|e[1]<<14|e[2]<<7|e[3]}var Be,Fe=Pe,je={TXXX:function(e){var t;if(3===e.data[0]){for(t=1;t<e.data.length;t++)if(0===e.data[t]){e.description=Ne(e.data,1,t),e.value=Ne(e.data,t+1,e.data.length).replace(/\0*$/,"");break}e.data=e.value}},WXXX:function(e){var t;if(3===e.data[0])for(t=1;t<e.data.length;t++)if(0===e.data[t]){e.description=Ne(e.data,1,t),e.url=Ne(e.data,t+1,e.data.length);break}},PRIV:function(e){var t,n;for(t=0;t<e.data.length;t++)if(0===e.data[t]){e.owner=(n=e.data,unescape(Oe(n,0,t)));break}e.privateData=e.data.subarray(t+1),e.data=e.privateData}};(Be=function(e){var t,l={debug:!(!e||!e.debug),descriptor:e&&e.descriptor},u=0,c=[],d=0;if(Be.prototype.init.call(this),this.dispatchType=Le.METADATA_STREAM_TYPE.toString(16),l.descriptor)for(t=0;t<l.descriptor.length;t++)this.dispatchType+=("00"+l.descriptor[t].toString(16)).slice(-2);this.push=function(e){var t,n,r,i,a;if("timed-metadata"===e.type)if(e.dataAlignmentIndicator&&(d=0,c.length=0),0===c.length&&(e.data.length<10||e.data[0]!=="I".charCodeAt(0)||e.data[1]!=="D".charCodeAt(0)||e.data[2]!=="3".charCodeAt(0)))l.debug&&console.log("Skipping unrecognized metadata packet");else if(c.push(e),d+=e.data.byteLength,1===c.length&&(u=ke(e.data.subarray(6,10)),u+=10),!(d<u)){for(t={data:new Uint8Array(u),frames:[],pts:c[0].pts,dts:c[0].dts},a=0;a<u;)t.data.set(c[0].data.subarray(0,u-a),a),a+=c[0].data.byteLength,d-=c[0].data.byteLength,c.shift();n=10,64&t.data[5]&&(n+=4,n+=ke(t.data.subarray(10,14)),u-=ke(t.data.subarray(16,20)));do{if((r=ke(t.data.subarray(n+4,n+8)))<1)return console.log("Malformed ID3 frame encountered. Skipping metadata parsing.");if((i={id:String.fromCharCode(t.data[n],t.data[n+1],t.data[n+2],t.data[n+3]),data:t.data.subarray(n+10,n+r+10)}).key=i.id,je[i.id]&&(je[i.id](i),"com.apple.streaming.transportStreamTimestamp"===i.owner)){var o=i.data,s=(1&o[3])<<30|o[4]<<22|o[5]<<14|o[6]<<6|o[7]>>>2;s*=4,s+=3&o[7],i.timeStamp=s,void 0===t.pts&&void 0===t.dts&&(t.pts=i.timeStamp,t.dts=i.timeStamp),this.trigger("timestamp",i)}t.frames.push(i),n+=10,n+=r}while(n<u);this.trigger("data",t)}}}).prototype=new H;var Ue,He,Ge,Ve=Be,ze=Fe;(Ue=function(){var i=new Uint8Array(188),a=0;Ue.prototype.init.call(this),this.push=function(e){var t,n=0,r=188;for(a?((t=new Uint8Array(e.byteLength+a)).set(i.subarray(0,a)),t.set(e,a),a=0):t=e;r<t.byteLength;)71!==t[n]||71!==t[r]?(n++,r++):(this.trigger("data",t.subarray(n,r)),n+=188,r+=188);n<t.byteLength&&(i.set(t.subarray(n),0),a=t.byteLength-n)},this.flush=function(){188===a&&71===i[0]&&(this.trigger("data",i),a=0),this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.reset=function(){a=0,this.trigger("reset")}}).prototype=new H,(He=function(){var r,i,a,o;He.prototype.init.call(this),(o=this).packetsWaitingForPmt=[],this.programMapTable=void 0,r=function(e,t){var n=0;t.payloadUnitStartIndicator&&(n+=e[n]+1),"pat"===t.type?i(e.subarray(n),t):a(e.subarray(n),t)},i=function(e,t){t.section_number=e[7],t.last_section_number=e[8],o.pmtPid=(31&e[10])<<8|e[11],t.pmtPid=o.pmtPid},a=function(e,t){var n,r;if(1&e[5]){for(o.programMapTable={video:null,audio:null,"timed-metadata":{}},n=3+((15&e[1])<<8|e[2])-4,r=12+((15&e[10])<<8|e[11]);r<n;){var i=e[r],a=(31&e[r+1])<<8|e[r+2];i===Le.H264_STREAM_TYPE&&null===o.programMapTable.video?o.programMapTable.video=a:i===Le.ADTS_STREAM_TYPE&&null===o.programMapTable.audio?o.programMapTable.audio=a:i===Le.METADATA_STREAM_TYPE&&(o.programMapTable["timed-metadata"][a]=i),r+=5+((15&e[r+3])<<8|e[r+4])}t.programMapTable=o.programMapTable}},this.push=function(e){var t={},n=4;if(t.payloadUnitStartIndicator=!!(64&e[1]),t.pid=31&e[1],t.pid<<=8,t.pid|=e[2],1<(48&e[3])>>>4&&(n+=e[n]+1),0===t.pid)t.type="pat",r(e.subarray(n),t),this.trigger("data",t);else if(t.pid===this.pmtPid)for(t.type="pmt",r(e.subarray(n),t),this.trigger("data",t);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else void 0===this.programMapTable?this.packetsWaitingForPmt.push([e,n,t]):this.processPes_(e,n,t)},this.processPes_=function(e,t,n){n.pid===this.programMapTable.video?n.streamType=Le.H264_STREAM_TYPE:n.pid===this.programMapTable.audio?n.streamType=Le.ADTS_STREAM_TYPE:n.streamType=this.programMapTable["timed-metadata"][n.pid],n.type="pes",n.data=e.subarray(t),this.trigger("data",n)}}).prototype=new H,He.STREAM_TYPES={h264:27,adts:15},(Ge=function(){function r(e,t,n){var r,i,a=new Uint8Array(e.size),o={type:t},s=0,l=0;if(e.data.length&&!(e.size<9)){for(o.trackId=e.data[0].pid,s=0;s<e.data.length;s++)i=e.data[s],a.set(i.data,l),l+=i.data.byteLength;!function(e,t){var n;t.packetLength=6+(e[4]<<8|e[5]),t.dataAlignmentIndicator=0!=(4&e[6]),192&(n=e[7])&&(t.pts=(14&e[9])<<27|(255&e[10])<<20|(254&e[11])<<12|(255&e[12])<<5|(254&e[13])>>>3,t.pts*=4,t.pts+=(6&e[13])>>>1,t.dts=t.pts,64&n&&(t.dts=(14&e[14])<<27|(255&e[15])<<20|(254&e[16])<<12|(255&e[17])<<5|(254&e[18])>>>3,t.dts*=4,t.dts+=(6&e[18])>>>1)),t.data=e.subarray(9+e[8])}(a,o),r="video"===t||o.packetLength<=e.size,(n||r)&&(e.size=0,e.data.length=0),r&&u.trigger("data",o)}}var t,u=this,i={data:[],size:0},a={data:[],size:0},o={data:[],size:0};Ge.prototype.init.call(this),this.push=function(n){({pat:function(){},pes:function(){var e,t;switch(n.streamType){case Le.H264_STREAM_TYPE:case Le.H264_STREAM_TYPE:e=i,t="video";break;case Le.ADTS_STREAM_TYPE:e=a,t="audio";break;case Le.METADATA_STREAM_TYPE:e=o,t="timed-metadata";break;default:return}n.payloadUnitStartIndicator&&r(e,t,!0),e.data.push(n),e.size+=n.data.byteLength},pmt:function(){var e={type:"metadata",tracks:[]};null!==(t=n.programMapTable).video&&e.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+t.video,codec:"avc",type:"video"}),null!==t.audio&&e.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+t.audio,codec:"adts",type:"audio"}),u.trigger("data",e)}})[n.type]()},this.reset=function(){i.size=0,i.data.length=0,a.size=0,a.data.length=0,this.trigger("reset")},this.flushStreams_=function(){r(i,"video"),r(a,"audio"),r(o,"timed-metadata")},this.flush=function(){this.flushStreams_(),this.trigger("done")}}).prototype=new H;var We={PAT_PID:0,MP2T_PACKET_LENGTH:188,TransportPacketStream:Ue,TransportParseStream:He,ElementaryStream:Ge,TimestampRolloverStream:ze,CaptionStream:De.CaptionStream,Cea608Stream:De.Cea608Stream,MetadataStream:Ve};for(var qe in Le)Le.hasOwnProperty(qe)&&(We[qe]=Le[qe]);var Ye,Ke=We,Xe=ue,Qe=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];(Ye=function(l){var u,c=0;Ye.prototype.init.call(this),this.push=function(e){var t,n,r,i,a,o,s=0;if(l||(c=0),"audio"===e.type)for(u?(i=u,(u=new Uint8Array(i.byteLength+e.data.byteLength)).set(i),u.set(e.data,i.byteLength)):u=e.data;s+5<u.length;)if(255===u[s]&&240==(246&u[s+1])){if(n=2*(1&~u[s+1]),t=(3&u[s+3])<<11|u[s+4]<<3|(224&u[s+5])>>5,o=(a=1024*(1+(3&u[s+6])))*Xe/Qe[(60&u[s+2])>>>2],r=s+t,u.byteLength<r)return;if(this.trigger("data",{pts:e.pts+c*o,dts:e.dts+c*o,sampleCount:a,audioobjecttype:1+(u[s+2]>>>6&3),channelcount:(1&u[s+2])<<2|(192&u[s+3])>>>6,samplerate:Qe[(60&u[s+2])>>>2],samplingfrequencyindex:(60&u[s+2])>>>2,samplesize:16,data:u.subarray(s+7+n,r)}),c++,u.byteLength===r)return void(u=void 0);u=u.subarray(r)}else s++},this.flush=function(){c=0,this.trigger("done")},this.reset=function(){u=void 0,this.trigger("reset")},this.endTimeline=function(){u=void 0,this.trigger("endedtimeline")}}).prototype=new H;var Ze,Je,$e,et=Ye,tt=function(r){var i=r.byteLength,a=0,o=0;this.length=function(){return 8*i},this.bitsAvailable=function(){return 8*i+o},this.loadWord=function(){var e=r.byteLength-i,t=new Uint8Array(4),n=Math.min(4,i);if(0===n)throw new Error("no bytes available");t.set(r.subarray(e,e+n)),a=new DataView(t.buffer).getUint32(0),o=8*n,i-=n},this.skipBits=function(e){var t;e<o||(e-=o,e-=8*(t=Math.floor(e/8)),i-=t,this.loadWord()),a<<=e,o-=e},this.readBits=function(e){var t=Math.min(o,e),n=a>>>32-t;return 0<(o-=t)?a<<=t:0<i&&this.loadWord(),0<(t=e-t)?n<<t|this.readBits(t):n},this.skipLeadingZeros=function(){var e;for(e=0;e<o;++e)if(0!=(a&2147483648>>>e))return a<<=e,o-=e,e;return this.loadWord(),e+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var e=this.skipLeadingZeros();return this.readBits(e+1)-1},this.readExpGolomb=function(){var e=this.readUnsignedExpGolomb();return 1&e?1+e>>>1:-1*(e>>>1)},this.readBoolean=function(){return 1===this.readBits(1)},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()};(Je=function(){var r,i,a=0;Je.prototype.init.call(this),this.push=function(e){for(var t,n=(i=i?((t=new Uint8Array(i.byteLength+e.data.byteLength)).set(i),t.set(e.data,i.byteLength),t):e.data).byteLength;a<n-3;a++)if(1===i[a+2]){r=a+5;break}for(;r<n;)switch(i[r]){case 0:if(0!==i[r-1]){r+=2;break}if(0!==i[r-2]){r++;break}for(a+3!==r-2&&this.trigger("data",i.subarray(a+3,r-2));1!==i[++r]&&r<n;);a=r-2,r+=3;break;case 1:if(0!==i[r-1]||0!==i[r-2]){r+=3;break}this.trigger("data",i.subarray(a+3,r-2)),a=r-2,r+=3;break;default:r+=3}i=i.subarray(a),r-=a,a=0},this.reset=function(){i=null,a=0,this.trigger("reset")},this.flush=function(){i&&3<i.byteLength&&this.trigger("data",i.subarray(a+3)),i=null,a=0,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")}}).prototype=new H,$e={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},(Ze=function(){var n,r,i,a,o,s,_,t=new Je;Ze.prototype.init.call(this),(n=this).push=function(e){"video"===e.type&&(r=e.trackId,i=e.pts,a=e.dts,t.push(e))},t.on("data",function(e){var t={trackId:r,pts:i,dts:a,data:e};switch(31&e[0]){case 5:t.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:t.nalUnitType="sei_rbsp",t.escapedRBSP=o(e.subarray(1));break;case 7:t.nalUnitType="seq_parameter_set_rbsp",t.escapedRBSP=o(e.subarray(1)),t.config=s(t.escapedRBSP);break;case 8:t.nalUnitType="pic_parameter_set_rbsp";break;case 9:t.nalUnitType="access_unit_delimiter_rbsp"}n.trigger("data",t)}),t.on("done",function(){n.trigger("done")}),t.on("partialdone",function(){n.trigger("partialdone")}),t.on("reset",function(){n.trigger("reset")}),t.on("endedtimeline",function(){n.trigger("endedtimeline")}),this.flush=function(){t.flush()},this.partialFlush=function(){t.partialFlush()},this.reset=function(){t.reset()},this.endTimeline=function(){t.endTimeline()},_=function(e,t){var n,r=8,i=8;for(n=0;n<e;n++)0!==i&&(i=(r+t.readExpGolomb()+256)%256),r=0===i?r:i},o=function(e){for(var t,n,r=e.byteLength,i=[],a=1;a<r-2;)0===e[a]&&0===e[a+1]&&3===e[a+2]?(i.push(a+2),a+=2):a++;if(0===i.length)return e;t=r-i.length,n=new Uint8Array(t);var o=0;for(a=0;a<t;o++,a++)o===i[0]&&(o++,i.shift()),n[a]=e[o];return n},s=function(e){var t,n,r,i,a,o,s,l,u,c,d,h,f,p=0,m=0,g=0,v=0,y=1;if(n=(t=new tt(e)).readUnsignedByte(),i=t.readUnsignedByte(),r=t.readUnsignedByte(),t.skipUnsignedExpGolomb(),$e[n]&&(3===(a=t.readUnsignedExpGolomb())&&t.skipBits(1),t.skipUnsignedExpGolomb(),t.skipUnsignedExpGolomb(),t.skipBits(1),t.readBoolean()))for(d=3!==a?8:12,f=0;f<d;f++)t.readBoolean()&&_(f<6?16:64,t);if(t.skipUnsignedExpGolomb(),0===(o=t.readUnsignedExpGolomb()))t.readUnsignedExpGolomb();else if(1===o)for(t.skipBits(1),t.skipExpGolomb(),t.skipExpGolomb(),s=t.readUnsignedExpGolomb(),f=0;f<s;f++)t.skipExpGolomb();if(t.skipUnsignedExpGolomb(),t.skipBits(1),l=t.readUnsignedExpGolomb(),u=t.readUnsignedExpGolomb(),0===(c=t.readBits(1))&&t.skipBits(1),t.skipBits(1),t.readBoolean()&&(p=t.readUnsignedExpGolomb(),m=t.readUnsignedExpGolomb(),g=t.readUnsignedExpGolomb(),v=t.readUnsignedExpGolomb()),t.readBoolean()&&t.readBoolean()){switch(t.readUnsignedByte()){case 1:h=[1,1];break;case 2:h=[12,11];break;case 3:h=[10,11];break;case 4:h=[16,11];break;case 5:h=[40,33];break;case 6:h=[24,11];break;case 7:h=[20,11];break;case 8:h=[32,11];break;case 9:h=[80,33];break;case 10:h=[18,11];break;case 11:h=[15,11];break;case 12:h=[64,33];break;case 13:h=[160,99];break;case 14:h=[4,3];break;case 15:h=[3,2];break;case 16:h=[2,1];break;case 255:h=[t.readUnsignedByte()<<8|t.readUnsignedByte(),t.readUnsignedByte()<<8|t.readUnsignedByte()]}h&&(y=h[0]/h[1])}return{profileIdc:n,levelIdc:r,profileCompatibility:i,width:Math.ceil((16*(l+1)-2*p-2*m)*y),height:(2-c)*(u+1)*16-2*g-2*v,sarRatio:h}}}).prototype=new H;var nt,rt={H264Stream:Ze,NalByteStream:Je},it=function(e){return e[0]==="I".charCodeAt(0)&&e[1]==="D".charCodeAt(0)&&e[2]==="3".charCodeAt(0)},at=function(e,t){var n=e[t+6]<<21|e[t+7]<<14|e[t+8]<<7|e[t+9];return(16&e[t+5])>>4?20+n:10+n},ot=function(e,t){var n=(224&e[t+5])>>5,r=e[t+4]<<3;return 6144&e[t+3]|r|n};(nt=function(){var s=new Uint8Array,l=0;nt.prototype.init.call(this),this.setTimestamp=function(e){l=e},this.push=function(e){var t,n,r,i,a=0,o=0;for(s.length?(i=s.length,(s=new Uint8Array(e.byteLength+i)).set(s.subarray(0,i)),s.set(e,i)):s=e;3<=s.length-o;)if(s[o]!=="I".charCodeAt(0)||s[o+1]!=="D".charCodeAt(0)||s[o+2]!=="3".charCodeAt(0))if(255!=(255&s[o])||240!=(240&s[o+1]))o++;else{if(s.length-o<7)break;if(o+(a=ot(s,o))>s.length)break;r={type:"audio",data:s.subarray(o,o+a),pts:l,dts:l},this.trigger("data",r),o+=a}else{if(s.length-o<10)break;if(o+(a=at(s,o))>s.length)break;n={type:"timed-metadata",data:s.subarray(o,o+a)},this.trigger("data",n),o+=a}t=s.length-o,s=0<t?s.subarray(o):new Uint8Array},this.reset=function(){s=new Uint8Array,this.trigger("reset")},this.endTimeline=function(){s=new Uint8Array,this.trigger("endedtimeline")}}).prototype=new H;function st(e,t){var n;if(e.length!==t.length)return!1;for(n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function lt(e,t,n,r,i,a){return{start:{dts:e,pts:e+(n-t)},end:{dts:e+(r-t),pts:e+(i-n)},prependedContentDuration:a,baseMediaDecodeTime:e}}var ut,ct,dt,ht,ft=nt,pt=rt.H264Stream,mt=it,gt=ue,vt=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],yt=["width","height","profileIdc","levelIdc","profileCompatibility","sarRatio"];(ct=function(a,o){var s=[],l=0,u=0,c=0,d=1/0;o=o||{},ct.prototype.init.call(this),this.push=function(t){be(a,t),a&&vt.forEach(function(e){a[e]=t[e]}),s.push(t)},this.setEarliestDts=function(e){u=e-a.timelineStartInfo.baseMediaDecodeTime},this.setVideoBaseMediaDecodeTime=function(e){d=e},this.setAudioAppendStart=function(e){c=e},this.flush=function(){var e,t,n,r,i;0!==s.length&&(e=pe(s,a,u),a.baseMediaDecodeTime=_e(a,o.keepOriginalTimestamps),fe(a,e,c,d),a.samples=me(e),n=Z(ge(e)),s=[],t=J(l,[a]),r=new Uint8Array(t.byteLength+n.byteLength),l++,r.set(t),r.set(n,t.byteLength),ye(a),i=Math.ceil(1024*gt/a.samplerate),e.length&&this.trigger("timingInfo",{start:e[0].dts,end:e[0].dts+e.length*i}),this.trigger("data",{track:a,boxes:r})),this.trigger("done","AudioSegmentStream")},this.reset=function(){ye(a),s=[],this.trigger("reset")}}).prototype=new H,(ut=function(c,d){var t,n,h=0,f=[],p=[];d=d||{},ut.prototype.init.call(this),delete c.minPTS,this.gopCache_=[],this.push=function(e){be(c,e),"seq_parameter_set_rbsp"!==e.nalUnitType||t||(t=e.config,c.sps=[e.data],yt.forEach(function(e){c[e]=t[e]},this)),"pic_parameter_set_rbsp"!==e.nalUnitType||n||(n=e.data,c.pps=[e.data]),f.push(e)},this.flush=function(){for(var e,t,n,r,i,a,o,s,l=0;f.length&&"access_unit_delimiter_rbsp"!==f[0].nalUnitType;)f.shift();if(0===f.length)return this.resetStream_(),void this.trigger("done","VideoSegmentStream");if(e=ee(f),(n=te(e))[0][0].keyFrame||((t=this.getGopForFusion_(f[0],c))?(l=t.duration,n.unshift(t),n.byteLength+=t.byteLength,n.nalCount+=t.nalCount,n.pts=t.pts,n.dts=t.dts,n.duration+=t.duration):n=ne(n)),p.length){var u;if(!(u=d.alignGopsAtEnd?this.alignGopsAtEnd_(n):this.alignGopsAtStart_(n)))return this.gopCache_.unshift({gop:n.pop(),pps:c.pps,sps:c.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),f=[],this.resetStream_(),void this.trigger("done","VideoSegmentStream");ye(c),n=u}be(c,n),c.samples=re(n),i=Z(ie(n)),c.baseMediaDecodeTime=_e(c,d.keepOriginalTimestamps),this.trigger("processedGopsInfo",n.map(function(e){return{pts:e.pts,dts:e.dts,byteLength:e.byteLength}})),o=n[0],s=n[n.length-1],this.trigger("segmentTimingInfo",lt(c.baseMediaDecodeTime,o.dts,o.pts,s.dts+s.duration,s.pts+s.duration,l)),this.trigger("timingInfo",{start:n[0].dts,end:n[n.length-1].dts+n[n.length-1].duration}),this.gopCache_.unshift({gop:n.pop(),pps:c.pps,sps:c.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),f=[],this.trigger("baseMediaDecodeTime",c.baseMediaDecodeTime),this.trigger("timelineStartInfo",c.timelineStartInfo),r=J(h,[c]),a=new Uint8Array(r.byteLength+i.byteLength),h++,a.set(r),a.set(i,r.byteLength),this.trigger("data",{track:c,boxes:a}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.reset=function(){this.resetStream_(),f=[],this.gopCache_.length=0,p.length=0,this.trigger("reset")},this.resetStream_=function(){ye(c),n=t=void 0},this.getGopForFusion_=function(e){var t,n,r,i,a,o=1/0;for(a=0;a<this.gopCache_.length;a++)r=(i=this.gopCache_[a]).gop,c.pps&&st(c.pps[0],i.pps[0])&&c.sps&&st(c.sps[0],i.sps[0])&&(r.dts<c.timelineStartInfo.dts||-1e4<=(t=e.dts-r.dts-r.duration)&&t<=45e3&&(!n||t<o)&&(n=i,o=t));return n?n.gop:null},this.alignGopsAtStart_=function(e){var t,n,r,i,a,o,s,l;for(a=e.byteLength,o=e.nalCount,s=e.duration,t=n=0;t<p.length&&n<e.length&&(r=p[t],i=e[n],r.pts!==i.pts);)i.pts>r.pts?t++:(n++,a-=i.byteLength,o-=i.nalCount,s-=i.duration);return 0===n?e:n===e.length?null:((l=e.slice(n)).byteLength=a,l.duration=s,l.nalCount=o,l.pts=l[0].pts,l.dts=l[0].dts,l)},this.alignGopsAtEnd_=function(e){var t,n,r,i,a,o,s;for(t=p.length-1,n=e.length-1,a=null,o=!1;0<=t&&0<=n;){if(r=p[t],i=e[n],r.pts===i.pts){o=!0;break}r.pts>i.pts?t--:(t===p.length-1&&(a=n),n--)}if(!o&&null===a)return null;if(0===(s=o?n:a))return e;var l=e.slice(s),u=l.reduce(function(e,t){return e.byteLength+=t.byteLength,e.duration+=t.duration,e.nalCount+=t.nalCount,e},{byteLength:0,duration:0,nalCount:0});return l.byteLength=u.byteLength,l.duration=u.duration,l.nalCount=u.nalCount,l.pts=l[0].pts,l.dts=l[0].dts,l},this.alignGopsWith=function(e){p=e}}).prototype=new H,(ht=function(e,t){this.numberOfTracks=0,this.metadataStream=t,void 0!==(e=e||{}).remux?this.remuxTracks=!!e.remux:this.remuxTracks=!0,"boolean"==typeof e.keepOriginalTimestamps?this.keepOriginalTimestamps=e.keepOriginalTimestamps:this.keepOriginalTimestamps=!1,this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,ht.prototype.init.call(this),this.push=function(e){return e.text?this.pendingCaptions.push(e):e.frames?this.pendingMetadata.push(e):(this.pendingTracks.push(e.track),this.pendingBytes+=e.boxes.byteLength,"video"===e.track.type&&(this.videoTrack=e.track,this.pendingBoxes.push(e.boxes)),void("audio"===e.track.type&&(this.audioTrack=e.track,this.pendingBoxes.unshift(e.boxes))))}}).prototype=new H,ht.prototype.flush=function(e){var t,n,r,i,a=0,o={captions:[],captionStreams:{},metadata:[],info:{}},s=0;if(this.pendingTracks.length<this.numberOfTracks){if("VideoSegmentStream"!==e&&"AudioSegmentStream"!==e)return;if(this.remuxTracks)return;if(0===this.pendingTracks.length)return this.emittedTracks++,void(this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0))}if(this.videoTrack?(s=this.videoTrack.timelineStartInfo.pts,yt.forEach(function(e){o.info[e]=this.videoTrack[e]},this)):this.audioTrack&&(s=this.audioTrack.timelineStartInfo.pts,vt.forEach(function(e){o.info[e]=this.audioTrack[e]},this)),this.videoTrack||this.audioTrack){for(1===this.pendingTracks.length?o.type=this.pendingTracks[0].type:o.type="combined",this.emittedTracks+=this.pendingTracks.length,r=$(this.pendingTracks),o.initSegment=new Uint8Array(r.byteLength),o.initSegment.set(r),o.data=new Uint8Array(this.pendingBytes),i=0;i<this.pendingBoxes.length;i++)o.data.set(this.pendingBoxes[i],a),a+=this.pendingBoxes[i].byteLength;for(i=0;i<this.pendingCaptions.length;i++)(t=this.pendingCaptions[i]).startTime=he(t.startPts,s,this.keepOriginalTimestamps),t.endTime=he(t.endPts,s,this.keepOriginalTimestamps),o.captionStreams[t.stream]=!0,o.captions.push(t);for(i=0;i<this.pendingMetadata.length;i++)(n=this.pendingMetadata[i]).cueTime=he(n.pts,s,this.keepOriginalTimestamps),o.metadata.push(n);for(o.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",o),i=0;i<o.captions.length;i++)t=o.captions[i],this.trigger("caption",t);for(i=0;i<o.metadata.length;i++)n=o.metadata[i],this.trigger("id3Frame",n)}this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},ht.prototype.setRemux=function(e){this.remuxTracks=e},(dt=function(r){var i,a,o=this,n=!0;dt.prototype.init.call(this),r=r||{},this.baseMediaDecodeTime=r.baseMediaDecodeTime||0,this.transmuxPipeline_={},this.setupAacPipeline=function(){var t={};(this.transmuxPipeline_=t).type="aac",t.metadataStream=new Ke.MetadataStream,t.aacStream=new ft,t.audioTimestampRolloverStream=new Ke.TimestampRolloverStream("audio"),t.timedMetadataTimestampRolloverStream=new Ke.TimestampRolloverStream("timed-metadata"),t.adtsStream=new et,t.coalesceStream=new ht(r,t.metadataStream),t.headOfPipeline=t.aacStream,t.aacStream.pipe(t.audioTimestampRolloverStream).pipe(t.adtsStream),t.aacStream.pipe(t.timedMetadataTimestampRolloverStream).pipe(t.metadataStream).pipe(t.coalesceStream),t.metadataStream.on("timestamp",function(e){t.aacStream.setTimestamp(e.timeStamp)}),t.aacStream.on("data",function(e){"timed-metadata"!==e.type||t.audioSegmentStream||(a=a||{timelineStartInfo:{baseMediaDecodeTime:o.baseMediaDecodeTime},codec:"adts",type:"audio"},t.coalesceStream.numberOfTracks++,t.audioSegmentStream=new ct(a,r),t.audioSegmentStream.on("timingInfo",o.trigger.bind(o,"audioTimingInfo")),t.adtsStream.pipe(t.audioSegmentStream).pipe(t.coalesceStream)),o.trigger("trackinfo",{hasAudio:!!a,hasVideo:!!i})}),t.coalesceStream.on("data",this.trigger.bind(this,"data")),t.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setupTsPipeline=function(){var n={};(this.transmuxPipeline_=n).type="ts",n.metadataStream=new Ke.MetadataStream,n.packetStream=new Ke.TransportPacketStream,n.parseStream=new Ke.TransportParseStream,n.elementaryStream=new Ke.ElementaryStream,n.timestampRolloverStream=new Ke.TimestampRolloverStream,n.adtsStream=new et,n.h264Stream=new pt,n.captionStream=new Ke.CaptionStream,n.coalesceStream=new ht(r,n.metadataStream),n.headOfPipeline=n.packetStream,n.packetStream.pipe(n.parseStream).pipe(n.elementaryStream).pipe(n.timestampRolloverStream),n.timestampRolloverStream.pipe(n.h264Stream),n.timestampRolloverStream.pipe(n.adtsStream),n.timestampRolloverStream.pipe(n.metadataStream).pipe(n.coalesceStream),n.h264Stream.pipe(n.captionStream).pipe(n.coalesceStream),n.elementaryStream.on("data",function(e){var t;if("metadata"===e.type){for(t=e.tracks.length;t--;)i||"video"!==e.tracks[t].type?a||"audio"!==e.tracks[t].type||((a=e.tracks[t]).timelineStartInfo.baseMediaDecodeTime=o.baseMediaDecodeTime):(i=e.tracks[t]).timelineStartInfo.baseMediaDecodeTime=o.baseMediaDecodeTime;i&&!n.videoSegmentStream&&(n.coalesceStream.numberOfTracks++,n.videoSegmentStream=new ut(i,r),n.videoSegmentStream.on("timelineStartInfo",function(e){a&&(a.timelineStartInfo=e,n.audioSegmentStream.setEarliestDts(e.dts))}),n.videoSegmentStream.on("processedGopsInfo",o.trigger.bind(o,"gopInfo")),n.videoSegmentStream.on("segmentTimingInfo",o.trigger.bind(o,"videoSegmentTimingInfo")),n.videoSegmentStream.on("baseMediaDecodeTime",function(e){a&&n.audioSegmentStream.setVideoBaseMediaDecodeTime(e)}),n.videoSegmentStream.on("timingInfo",o.trigger.bind(o,"videoTimingInfo")),n.h264Stream.pipe(n.videoSegmentStream).pipe(n.coalesceStream)),a&&!n.audioSegmentStream&&(n.coalesceStream.numberOfTracks++,n.audioSegmentStream=new ct(a,r),n.audioSegmentStream.on("timingInfo",o.trigger.bind(o,"audioTimingInfo")),n.adtsStream.pipe(n.audioSegmentStream).pipe(n.coalesceStream)),o.trigger("trackinfo",{hasAudio:!!a,hasVideo:!!i})}}),n.coalesceStream.on("data",this.trigger.bind(this,"data")),n.coalesceStream.on("id3Frame",function(e){e.dispatchType=n.metadataStream.dispatchType,o.trigger("id3Frame",e)}),n.coalesceStream.on("caption",this.trigger.bind(this,"caption")),n.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setBaseMediaDecodeTime=function(e){var t=this.transmuxPipeline_;r.keepOriginalTimestamps||(this.baseMediaDecodeTime=e),a&&(a.timelineStartInfo.dts=void 0,a.timelineStartInfo.pts=void 0,ye(a),r.keepOriginalTimestamps||(a.timelineStartInfo.baseMediaDecodeTime=e),t.audioTimestampRolloverStream&&t.audioTimestampRolloverStream.discontinuity()),i&&(t.videoSegmentStream&&(t.videoSegmentStream.gopCache_=[]),i.timelineStartInfo.dts=void 0,i.timelineStartInfo.pts=void 0,ye(i),t.captionStream.reset(),r.keepOriginalTimestamps||(i.timelineStartInfo.baseMediaDecodeTime=e)),t.timestampRolloverStream&&t.timestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(e){a&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(e)},this.setRemux=function(e){var t=this.transmuxPipeline_;r.remux=e,t&&t.coalesceStream&&t.coalesceStream.setRemux(e)},this.alignGopsWith=function(e){i&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(e)},this.push=function(e){if(n){var t=mt(e);t&&"aac"!==this.transmuxPipeline_.type?this.setupAacPipeline():t||"ts"===this.transmuxPipeline_.type||this.setupTsPipeline(),n=!1}this.transmuxPipeline_.headOfPipeline.push(e)},this.flush=function(){n=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.endTimeline=function(){this.transmuxPipeline_.headOfPipeline.endTimeline()},this.reset=function(){this.transmuxPipeline_.headOfPipeline&&this.transmuxPipeline_.headOfPipeline.reset()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}}).prototype=new H;var _t={Transmuxer:dt,VideoSegmentStream:ut,AudioSegmentStream:ct,AUDIO_PROPERTIES:vt,VIDEO_PROPERTIES:yt,generateVideoSegmentTimingInfo:lt};function bt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Et=(function(e,t,n){return t&&bt(e.prototype,t),n&&bt(e,n),e}(Tt,[{key:"init",value:function(){this.transmuxer&&this.transmuxer.dispose(),this.transmuxer=new _t.Transmuxer(this.options),function(r,e){e.on("data",function(e){var t=e.initSegment;e.initSegment={data:t.buffer,byteOffset:t.byteOffset,byteLength:t.byteLength};var n=e.data;e.data=n.buffer,r.postMessage({action:"data",segment:e,byteOffset:n.byteOffset,byteLength:n.byteLength},[e.data])}),e.captionStream&&e.captionStream.on("data",function(e){r.postMessage({action:"caption",data:e})}),e.on("done",function(e){r.postMessage({action:"done"})}),e.on("gopInfo",function(e){r.postMessage({action:"gopInfo",gopInfo:e})}),e.on("videoSegmentTimingInfo",function(e){r.postMessage({action:"videoSegmentTimingInfo",videoSegmentTimingInfo:e})})}(this.self,this.transmuxer)}},{key:"push",value:function(e){var t=new Uint8Array(e.data,e.byteOffset,e.byteLength);this.transmuxer.push(t)}},{key:"reset",value:function(){this.init()}},{key:"setTimestampOffset",value:function(e){var t=e.timestampOffset||0;this.transmuxer.setBaseMediaDecodeTime(Math.round(9e4*t))}},{key:"setAudioAppendStart",value:function(e){this.transmuxer.setAudioAppendStart(Math.ceil(9e4*e.appendStart))}},{key:"flush",value:function(){this.transmuxer.flush()}},{key:"resetCaptions",value:function(){this.transmuxer.resetCaptions()}},{key:"alignGopsWith",value:function(e){this.transmuxer.alignGopsWith(e.gopsToAlignWith.slice())}}]),Tt);function Tt(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Tt),this.options=t||{},this.self=e,this.init()}new function(t){t.onmessage=function(e){"init"===e.data.action&&e.data.options?this.messageHandlers=new Et(t,e.data.options):(this.messageHandlers||(this.messageHandlers=new Et(t)),e.data&&e.data.action&&"init"!==e.data.action&&this.messageHandlers[e.data.action]&&this.messageHandlers[e.data.action](e.data))}}(At)}()}),ec={videoCodec:"avc1",videoObjectTypeIndicator:".4d400d",audioProfile:"2"},tc=(Ul(nc,go.EventTarget),Fl(nc,[{key:"data_",value:function(e){var t=e.data.segment;t.data=new Uint8Array(t.data,e.data.byteOffset,e.data.byteLength),t.initSegment=new Uint8Array(t.initSegment.data,t.initSegment.byteOffset,t.initSegment.byteLength),function(e,t,n){var r=t.player_;if(n.captions&&n.captions.length)for(var i in e.inbandTextTracks_||(e.inbandTextTracks_={}),n.captionStreams)if(!e.inbandTextTracks_[i]){r.tech_.trigger({type:"usage",name:"hls-608"});var a=r.textTracks().getTrackById(i);e.inbandTextTracks_[i]=a||r.addRemoteTextTrack({kind:"captions",id:i,label:i},!1).track}n.metadata&&n.metadata.length&&!e.metadataTrack_&&(e.metadataTrack_=r.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},!1).track,e.metadataTrack_.inBandMetadataTrackDispatchType=n.metadata.dispatchType)}(this,this.mediaSource_,t),this.pendingBuffers_.push(t)}},{key:"done_",value:function(){"closed"!==this.mediaSource_.readyState?this.processPendingSegments_():this.pendingBuffers_.length=0}},{key:"videoSegmentTimingInfo_",value:function(e){var t={start:{decode:e.start.dts/9e4,presentation:e.start.pts/9e4},end:{decode:e.end.dts/9e4,presentation:e.end.pts/9e4},baseMediaDecodeTime:e.baseMediaDecodeTime/9e4};e.prependedContentDuration&&(t.prependedContentDuration=e.prependedContentDuration/9e4),this.trigger({type:"videoSegmentTimingInfo",videoSegmentTimingInfo:t})}},{key:"createRealSourceBuffers_",value:function(){var r=this,i=["audio","video"];i.forEach(function(t){if(r[t+"Codec_"]&&!r[t+"Buffer_"]){var n=null;if(r.mediaSource_[t+"Buffer_"])(n=r.mediaSource_[t+"Buffer_"]).updating=!1;else{var e=t+'/mp4;codecs="'+r[t+"Codec_"]+'"';n=Ju(r.mediaSource_.nativeMediaSource_,e),r.mediaSource_[t+"Buffer_"]=n}r[t+"Buffer_"]=n,["update","updatestart","updateend"].forEach(function(e){n.addEventListener(e,function(){if("audio"!==t||!r.audioDisabled_)return"updateend"===e&&(r[t+"Buffer_"].updating=!1),i.every(function(e){return!("audio"!==e||!r.audioDisabled_)||t===e||!r[e+"Buffer_"]||!r[e+"Buffer_"].updating})?r.trigger(e):void 0})})}})}},{key:"appendBuffer",value:function(e){if(this.bufferUpdating_=!0,this.audioBuffer_&&this.audioBuffer_.buffered.length){var t=this.audioBuffer_.buffered;this.transmuxer_.postMessage({action:"setAudioAppendStart",appendStart:t.end(t.length-1)})}this.videoBuffer_&&this.transmuxer_.postMessage({action:"alignGopsWith",gopsToAlignWith:function(e,t,n){if(null==t||!e.length)return[];var r=Math.ceil(9e4*(t-n+3)),i=void 0;for(i=0;i<e.length&&!(e[i].pts>r);i++);return e.slice(i)}(this.gopBuffer_,this.mediaSource_.player_?this.mediaSource_.player_.currentTime():null,this.timeMapping_)}),this.transmuxer_.postMessage({action:"push",data:e.buffer,byteOffset:e.byteOffset,byteLength:e.byteLength},[e.buffer]),this.transmuxer_.postMessage({action:"flush"})}},{key:"appendGopInfo_",value:function(e){this.gopBuffer_=function(e,t,n){if(!t.length)return e;if(n)return t.slice();for(var r=t[0].pts,i=0;i<e.length&&!(e[i].pts>=r);i++);return e.slice(0,i).concat(t)}(this.gopBuffer_,e.data.gopInfo,this.safeAppend_)}},{key:"remove",value:function(e,t){if(this.videoBuffer_&&(this.videoBuffer_.updating=!0,this.videoBuffer_.remove(e,t),this.gopBuffer_=function(e,t,n,r){for(var i=Math.ceil(9e4*(t-r)),a=Math.ceil(9e4*(n-r)),o=e.slice(),s=e.length;s--&&!(e[s].pts<=a););if(-1===s)return o;for(var l=s+1;l--&&!(e[l].pts<=i););return l=Math.max(l,0),o.splice(l,s-l+1),o}(this.gopBuffer_,e,t,this.timeMapping_)),!this.audioDisabled_&&this.audioBuffer_&&(this.audioBuffer_.updating=!0,this.audioBuffer_.remove(e,t)),Su(e,t,this.metadataTrack_),this.inbandTextTracks_)for(var n in this.inbandTextTracks_)Su(e,t,this.inbandTextTracks_[n])}},{key:"processPendingSegments_",value:function(){var e={video:{segments:[],bytes:0},audio:{segments:[],bytes:0},captions:[],metadata:[]};if(!this.pendingBuffers_.length)return this.trigger("updateend"),void(this.bufferUpdating_=!1);e=this.pendingBuffers_.reduce(function(e,t){var n=t.type,r=t.data,i=t.initSegment;return e[n].segments.push(r),e[n].bytes+=r.byteLength,e[n].initSegment=i,t.captions&&(e.captions=e.captions.concat(t.captions)),t.info&&(e[n].info=t.info),t.metadata&&(e.metadata=e.metadata.concat(t.metadata)),e},e),this.videoBuffer_||this.audioBuffer_||(0===e.video.bytes&&(this.videoCodec_=null),0===e.audio.bytes&&(this.audioCodec_=null),this.createRealSourceBuffers_()),e.audio.info&&this.mediaSource_.trigger({type:"audioinfo",info:e.audio.info}),e.video.info&&this.mediaSource_.trigger({type:"videoinfo",info:e.video.info}),this.appendAudioInitSegment_&&(!this.audioDisabled_&&this.audioBuffer_&&(e.audio.segments.unshift(e.audio.initSegment),e.audio.bytes+=e.audio.initSegment.byteLength),this.appendAudioInitSegment_=!1);var t=!1;this.videoBuffer_&&e.video.bytes?(e.video.segments.unshift(e.video.initSegment),e.video.bytes+=e.video.initSegment.byteLength,this.concatAndAppendSegments_(e.video,this.videoBuffer_)):!this.videoBuffer_||!this.audioDisabled_&&this.audioBuffer_||(t=!0),xu(this,e.captions,e.metadata),!this.audioDisabled_&&this.audioBuffer_&&this.concatAndAppendSegments_(e.audio,this.audioBuffer_),this.pendingBuffers_.length=0,t&&this.trigger("updateend"),this.bufferUpdating_=!1}},{key:"concatAndAppendSegments_",value:function(e,t){var n=0,r=void 0;if(e.bytes){r=new Uint8Array(e.bytes),e.segments.forEach(function(e){r.set(e,n),n+=e.byteLength});try{t.updating=!0,t.appendBuffer(r)}catch(e){this.mediaSource_.player_&&this.mediaSource_.player_.error({code:-3,type:"APPEND_BUFFER_ERR",message:e.message,originalError:e})}}}},{key:"abort",value:function(){this.videoBuffer_&&this.videoBuffer_.abort(),!this.audioDisabled_&&this.audioBuffer_&&this.audioBuffer_.abort(),this.transmuxer_&&this.transmuxer_.postMessage({action:"reset"}),this.pendingBuffers_.length=0,this.bufferUpdating_=!1}}]),nc);function nc(e,t){Bl(this,nc);var n=Hl(this,(nc.__proto__||Object.getPrototypeOf(nc)).call(this,go.EventTarget));n.timestampOffset_=0,n.pendingBuffers_=[],n.bufferUpdating_=!1,n.mediaSource_=e,n.codecs_=t,n.audioCodec_=null,n.videoCodec_=null,n.audioDisabled_=!1,n.appendAudioInitSegment_=!0,n.gopBuffer_=[],n.timeMapping_=0,n.safeAppend_=11<=go.browser.IE_VERSION;var r={remux:!1,alignGopsAtEnd:n.safeAppend_};return n.codecs_.forEach(function(e){Qu(e)?n.audioCodec_=e:Zu(e)&&(n.videoCodec_=e)}),n.transmuxer_=new $u,n.transmuxer_.postMessage({action:"init",options:r}),n.transmuxer_.onmessage=function(e){return"data"===e.data.action?n.data_(e):"done"===e.data.action?n.done_(e):"gopInfo"===e.data.action?n.appendGopInfo_(e):"videoSegmentTimingInfo"===e.data.action?n.videoSegmentTimingInfo_(e.data.videoSegmentTimingInfo):void 0},Object.defineProperty(n,"timestampOffset",{get:function(){return this.timestampOffset_},set:function(e){"number"==typeof e&&0<=e&&(this.timestampOffset_=e,this.appendAudioInitSegment_=!0,this.gopBuffer_.length=0,this.timeMapping_=0,this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:e}))}}),Object.defineProperty(n,"appendWindowStart",{get:function(){return(this.videoBuffer_||this.audioBuffer_).appendWindowStart},set:function(e){this.videoBuffer_&&(this.videoBuffer_.appendWindowStart=e),this.audioBuffer_&&(this.audioBuffer_.appendWindowStart=e)}}),Object.defineProperty(n,"updating",{get:function(){return!!(this.bufferUpdating_||!this.audioDisabled_&&this.audioBuffer_&&this.audioBuffer_.updating||this.videoBuffer_&&this.videoBuffer_.updating)}}),Object.defineProperty(n,"buffered",{get:function(){return function(e,t,n){var r=null,i=null,a=0,o=[],s=[];if(!e&&!t)return go.createTimeRange();if(!e)return t.buffered;if(!t)return e.buffered;if(n)return e.buffered;if(0===e.buffered.length&&0===t.buffered.length)return go.createTimeRange();for(var l=e.buffered,u=t.buffered,c=l.length;c--;)o.push({time:l.start(c),type:"start"}),o.push({time:l.end(c),type:"end"});for(c=u.length;c--;)o.push({time:u.start(c),type:"start"}),o.push({time:u.end(c),type:"end"});for(o.sort(function(e,t){return e.time-t.time}),c=0;c<o.length;c++)"start"===o[c].type?2===++a&&(r=o[c].time):"end"===o[c].type&&1===--a&&(i=o[c].time),null!==r&&null!==i&&(s.push([r,i]),i=r=null);return go.createTimeRanges(s)}(this.videoBuffer_,this.audioBuffer_,this.audioDisabled_)}}),n}var rc=(Ul(ic,go.EventTarget),Fl(ic,[{key:"addSeekableRange_",value:function(e,t){var n=void 0;if(this.duration!==1/0)throw(n=new Error("MediaSource.addSeekableRange() can only be invoked when the duration is Infinity")).name="InvalidStateError",n.code=11,n;(t>this.nativeMediaSource_.duration||isNaN(this.nativeMediaSource_.duration))&&(this.nativeMediaSource_.duration=t)}},{key:"addSourceBuffer",value:function(e){var t=void 0,n=function(e){var i={type:"",parameters:{}},t=e.trim().split(";");return i.type=t.shift().trim(),t.forEach(function(e){var t=e.trim().split("=");if(1<t.length){var n=t[0].replace(/"/g,"").trim(),r=t[1].replace(/"/g,"").trim();i.parameters[n]=r}}),i}(e);if(/^(video|audio)\/mp2t$/i.test(n.type)){var r=[];n.parameters&&n.parameters.codecs&&(r=n.parameters.codecs.split(","),r=(r=qu(r)).filter(function(e){return Qu(e)||Zu(e)})),0===r.length&&(r=["avc1.4d400d","mp4a.40.2"]),t=new tc(this,r),0!==this.sourceBuffers.length&&(this.sourceBuffers[0].createRealSourceBuffers_(),t.createRealSourceBuffers_(),this.sourceBuffers[0].audioDisabled_=!0)}else t=this.nativeMediaSource_.addSourceBuffer(e);return this.sourceBuffers.push(t),t}}]),ic);function ic(){Bl(this,ic);var a=Hl(this,(ic.__proto__||Object.getPrototypeOf(ic)).call(this)),e=void 0;for(e in a.nativeMediaSource_=new y.MediaSource,a.nativeMediaSource_)e in ic.prototype||"function"!=typeof a.nativeMediaSource_[e]||(a[e]=a.nativeMediaSource_[e].bind(a.nativeMediaSource_));return a.duration_=NaN,Object.defineProperty(a,"duration",{get:function(){return this.duration_===1/0?this.duration_:this.nativeMediaSource_.duration},set:function(e){(this.duration_=e)===1/0||(this.nativeMediaSource_.duration=e)}}),Object.defineProperty(a,"seekable",{get:function(){return this.duration_===1/0?go.createTimeRanges([[0,this.nativeMediaSource_.duration]]):this.nativeMediaSource_.seekable}}),Object.defineProperty(a,"readyState",{get:function(){return this.nativeMediaSource_.readyState}}),Object.defineProperty(a,"activeSourceBuffers",{get:function(){return this.activeSourceBuffers_}}),a.sourceBuffers=[],a.activeSourceBuffers_=[],a.updateActiveSourceBuffers_=function(){if(a.activeSourceBuffers_.length=0,1===a.sourceBuffers.length){var e=a.sourceBuffers[0];return e.appendAudioInitSegment_=!0,e.audioDisabled_=!e.audioCodec_,void a.activeSourceBuffers_.push(e)}for(var n=!1,r=!0,t=0;t<a.player_.audioTracks().length;t++){var i=a.player_.audioTracks()[t];if(i.enabled&&"main"!==i.kind){r=!(n=!0);break}}a.sourceBuffers.forEach(function(e,t){if(e.appendAudioInitSegment_=!0,e.videoCodec_&&e.audioCodec_)e.audioDisabled_=n;else if(e.videoCodec_&&!e.audioCodec_)e.audioDisabled_=!0,r=!1;else if(!e.videoCodec_&&e.audioCodec_&&(e.audioDisabled_=t?r:!r,e.audioDisabled_))return;a.activeSourceBuffers_.push(e)})},a.onPlayerMediachange_=function(){a.sourceBuffers.forEach(function(e){e.appendAudioInitSegment_=!0})},a.onHlsReset_=function(){a.sourceBuffers.forEach(function(e){e.transmuxer_&&e.transmuxer_.postMessage({action:"resetCaptions"})})},a.onHlsSegmentTimeMapping_=function(t){a.sourceBuffers.forEach(function(e){return e.timeMapping_=t.mapping})},["sourceopen","sourceclose","sourceended"].forEach(function(e){this.nativeMediaSource_.addEventListener(e,this.trigger.bind(this))},a),a.on("sourceopen",function(e){var t=d.querySelector('[src="'+a.url_+'"]');t&&(a.player_=go(t.parentNode),a.player_&&(a.player_.tech_.on("hls-reset",a.onHlsReset_),a.player_.tech_.on("hls-segment-time-mapping",a.onHlsSegmentTimeMapping_),a.player_.audioTracks&&a.player_.audioTracks()&&(a.player_.audioTracks().on("change",a.updateActiveSourceBuffers_),a.player_.audioTracks().on("addtrack",a.updateActiveSourceBuffers_),a.player_.audioTracks().on("removetrack",a.updateActiveSourceBuffers_)),a.player_.on("mediachange",a.onPlayerMediachange_)))}),a.on("sourceended",function(e){for(var t=Cu(a.duration),n=0;n<a.sourceBuffers.length;n++){var r=a.sourceBuffers[n],i=r.metadataTrack_&&r.metadataTrack_.cues;i&&i.length&&(i[i.length-1].endTime=t)}}),a.on("sourceclose",function(e){this.sourceBuffers.forEach(function(e){e.transmuxer_&&e.transmuxer_.terminate()}),this.sourceBuffers.length=0,this.player_&&(this.player_.audioTracks&&this.player_.audioTracks()&&(this.player_.audioTracks().off("change",this.updateActiveSourceBuffers_),this.player_.audioTracks().off("addtrack",this.updateActiveSourceBuffers_),this.player_.audioTracks().off("removetrack",this.updateActiveSourceBuffers_)),this.player_.el_&&this.player_.off("mediachange",this.onPlayerMediachange_),this.player_.tech_&&this.player_.tech_.el_&&(this.player_.tech_.off("hls-reset",this.onHlsReset_),this.player_.tech_.off("hls-segment-time-mapping",this.onHlsSegmentTimeMapping_)))}),a}var ac=0;go.mediaSources={};function oc(e,t){var n=go.mediaSources[e];if(!n)throw new Error("Media Source not found (Video.js)");n.trigger({type:"sourceopen",swfId:t})}function sc(){return!!y.MediaSource&&!!y.MediaSource.isTypeSupported&&y.MediaSource.isTypeSupported('video/mp4;codecs="avc1.4d400d,mp4a.40.2"')}function lc(){if(this.MediaSource={open:oc,supportsNativeMediaSources:sc},sc())return new rc;throw new Error("Cannot use create a virtual MediaSource for this video")}lc.open=oc,lc.supportsNativeMediaSources=sc;var uc={createObjectURL:function(e){var t=void 0;return e instanceof rc?(t=y.URL.createObjectURL(e.nativeMediaSource_),e.url_=t):e instanceof rc?(t="blob:vjs-media-source/"+ac,ac++,go.mediaSources[t]=e,t):(t=y.URL.createObjectURL(e),e.url_=t)}};go.MediaSource=lc,go.URL=uc;function cc(e,t){for(var o=void 0,s=pc(e,{duration:t.duration,minimumUpdatePeriod:t.minimumUpdatePeriod}),n=0;n<t.playlists.length;n++){var r=Vl(s,t.playlists[n]);r?s=r:o=!0}return Gl(t,function(e,t,n,r){if(e.playlists&&e.playlists.length){var i=e.playlists[0].uri,a=Vl(s,e.playlists[0]);a&&((s=a).mediaGroups[t][n][r].playlists[0]=s.playlists[i],o=!1)}}),o?null:s}function dc(e){var t=e.byterange.offset+e.byterange.length-1;return e.uri+"-"+e.byterange.offset+"-"+t}function hc(e,t){var n,r,i={};for(var a in e){var o=e[a].sidx;if(o){var s=dc(o);if(!t[s])break;var l=t[s].sidxInfo;n=l,r=o,(Boolean(!n.map&&!r.map)||Boolean(n.map&&r.map&&n.map.byterange.offset===r.map.byterange.offset&&n.map.byterange.length===r.map.byterange.length))&&n.uri===r.uri&&n.byterange.offset===r.byterange.offset&&n.byterange.length===r.byterange.length&&(i[s]=t[s])}}return i}function fc(e,t,n,r,i){var a={uri:kl(r.handleManifestRedirects,e.resolvedUri),byterange:e.byterange,playlist:t};return n(go.mergeOptions(a,{responseType:"arraybuffer",headers:du(a)}),i)}var pc=go.mergeOptions,mc=(Ul(gc,go.EventTarget),Fl(gc,[{key:"setupChildLoader",value:function(e,t){this.masterPlaylistLoader_=e,this.childPlaylist_=t}},{key:"dispose",value:function(){this.stopRequest(),this.loadedPlaylists_={},y.clearTimeout(this.minimumUpdatePeriodTimeout_),y.clearTimeout(this.mediaRequest_),y.clearTimeout(this.mediaUpdateTimeout)}},{key:"hasPendingRequest",value:function(){return this.request||this.mediaRequest_}},{key:"stopRequest",value:function(){if(this.request){var e=this.request;this.request=null,e.onreadystatechange=null,e.abort()}}},{key:"sidxRequestFinished_",value:function(i,a,o,s){var l=this;return function(e,t){if(l.request){if(l.request=null,e)return l.error={status:t.status,message:"DASH playlist request error at URL: "+i.uri,response:t.response,code:2},o&&(l.state=o),l.trigger("error"),s(a,null);var n=new Uint8Array(t.response),r=Ps.parseSidx(n.subarray(8));return s(a,r)}}}},{key:"media",value:function(n){var r=this;if(!n)return this.media_;if("HAVE_NOTHING"===this.state)throw new Error("Cannot switch media playlist from "+this.state);var i=this.state;if("string"==typeof n){if(!this.master.playlists[n])throw new Error("Unknown playlist URI: "+n);n=this.master.playlists[n]}var e=!this.media_||n.uri!==this.media_.uri;if(e&&this.loadedPlaylists_[n.uri]&&this.loadedPlaylists_[n.uri].endList)return this.state="HAVE_METADATA",this.media_=n,void(e&&(this.trigger("mediachanging"),this.trigger("mediachange")));if(e)if(this.media_&&this.trigger("mediachanging"),n.sidx){var t=void 0,a=void 0;a=this.masterPlaylistLoader_?(t=this.masterPlaylistLoader_.master,this.masterPlaylistLoader_.sidxMapping_):(t=this.master,this.sidxMapping_);var o=dc(n.sidx);a[o]={sidxInfo:n.sidx},this.request=fc(n.sidx,n,this.hls_.xhr,{handleManifestRedirects:this.handleManifestRedirects},this.sidxRequestFinished_(n,t,i,function(e,t){if(!e||!t)throw new Error("failed to request sidx");a[o].sidx=t,r.haveMetadata({startingState:i,playlist:e.playlists[n.uri]})}))}else this.mediaRequest_=y.setTimeout(this.haveMetadata.bind(this,{startingState:i,playlist:n}),0)}},{key:"haveMetadata",value:function(e){var t=e.startingState,n=e.playlist;this.state="HAVE_METADATA",this.loadedPlaylists_[n.uri]=n,this.mediaRequest_=null,this.refreshMedia_(n.uri),"HAVE_MASTER"===t?this.trigger("loadedmetadata"):this.trigger("mediachange")}},{key:"pause",value:function(){this.stopRequest(),y.clearTimeout(this.mediaUpdateTimeout),y.clearTimeout(this.minimumUpdatePeriodTimeout_),"HAVE_NOTHING"===this.state&&(this.started=!1)}},{key:"load",value:function(e){var t=this;y.clearTimeout(this.mediaUpdateTimeout),y.clearTimeout(this.minimumUpdatePeriodTimeout_);var n=this.media();if(e){var r=n?n.targetDuration/2*1e3:5e3;this.mediaUpdateTimeout=y.setTimeout(function(){return t.load()},r)}else this.started?this.trigger("loadedplaylist"):this.start()}},{key:"parseMasterXml",value:function(){var a=hs(this.masterXml_,{manifestUri:this.srcUrl,clientOffset:this.clientOffset_,sidxMapping:this.sidxMapping_});a.uri=this.srcUrl;for(var e=0;e<a.playlists.length;e++){var t="placeholder-uri-"+e;a.playlists[e].uri=t,a.playlists[t]=a.playlists[e]}return Gl(a,function(e,t,n,r){if(e.playlists&&e.playlists.length){var i="placeholder-uri-"+t+"-"+n+"-"+r;e.playlists[0].uri=i,a.playlists[i]=e.playlists[0]}}),zl(a),Wl(a),a}},{key:"start",value:function(){var n=this;this.started=!0,this.masterPlaylistLoader_?this.mediaRequest_=y.setTimeout(this.haveMaster_.bind(this),0):this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},function(e,t){if(n.request){if(n.request=null,e)return n.error={status:t.status,message:"DASH playlist request error at URL: "+n.srcUrl,responseText:t.responseText,code:2},"HAVE_NOTHING"===n.state&&(n.started=!1),n.trigger("error");n.masterXml_=t.responseText,t.responseHeaders&&t.responseHeaders.date?n.masterLoaded_=Date.parse(t.responseHeaders.date):n.masterLoaded_=Date.now(),n.srcUrl=kl(n.handleManifestRedirects,n.srcUrl,t),n.syncClientServerClock_(n.onClientServerClockSync_.bind(n))}})}},{key:"syncClientServerClock_",value:function(r){var i=this,a=fs(this.masterXml_);return null===a?(this.clientOffset_=this.masterLoaded_-Date.now(),r()):"DIRECT"===a.method?(this.clientOffset_=a.value-Date.now(),r()):void(this.request=this.hls_.xhr({uri:Nl(this.srcUrl,a.value),method:a.method,withCredentials:this.withCredentials},function(e,t){if(i.request){if(e)return i.clientOffset_=i.masterLoaded_-Date.now(),r();var n=void 0;n="HEAD"===a.method?t.responseHeaders&&t.responseHeaders.date?Date.parse(t.responseHeaders.date):i.masterLoaded_:Date.parse(t.responseText),i.clientOffset_=n-Date.now(),r()}}))}},{key:"haveMaster_",value:function(){this.state="HAVE_MASTER",this.mediaRequest_=null,this.masterPlaylistLoader_?this.media_||this.media(this.childPlaylist_):(this.master=this.parseMasterXml(),this.trigger("loadedplaylist"))}},{key:"onClientServerClockSync_",value:function(){var e=this;this.haveMaster_(),this.hasPendingRequest()||this.media_||this.media(this.master.playlists[0]),this.master&&this.master.minimumUpdatePeriod&&(this.minimumUpdatePeriodTimeout_=y.setTimeout(function(){e.trigger("minimumUpdatePeriod")},this.master.minimumUpdatePeriod))}},{key:"refreshXml_",value:function(){var s=this;this.request=this.hls_.xhr({uri:this.srcUrl,withCredentials:this.withCredentials},function(e,t){if(s.request){if(s.request=null,e)return s.error={status:t.status,message:"DASH playlist request error at URL: "+s.srcUrl,responseText:t.responseText,code:2},"HAVE_NOTHING"===s.state&&(s.started=!1),s.trigger("error");s.masterXml_=t.responseText,s.sidxMapping_=function(e,t,n,a){var r=hs(e,{manifestUri:t,clientOffset:n}),o=hc(r.playlists,a);return Gl(r,function(e,t,n,r){if(e.playlists&&e.playlists.length){var i=e.playlists;o=pc(o,hc(i,a))}}),o}(s.masterXml_,s.srcUrl,s.clientOffset_,s.sidxMapping_);var n=s.parseMasterXml(),r=cc(s.master,n),i=s.media().sidx;if(r)if(i){var a=dc(i);if(!s.sidxMapping_[a]){var o=s.media();s.request=fc(o.sidx,o,s.hls_.xhr,{handleManifestRedirects:s.handleManifestRedirects},s.sidxRequestFinished_(o,n,s.state,function(e,t){if(!e||!t)throw new Error("failed to request sidx on minimumUpdatePeriod");s.sidxMapping_[a].sidx=t,s.minimumUpdatePeriodTimeout_=y.setTimeout(function(){s.trigger("minimumUpdatePeriod")},s.master.minimumUpdatePeriod),s.refreshMedia_(s.media().uri)}))}}else s.master=r;s.minimumUpdatePeriodTimeout_=y.setTimeout(function(){s.trigger("minimumUpdatePeriod")},s.master.minimumUpdatePeriod)}})}},{key:"refreshMedia_",value:function(e){var t=this;if(!e)throw new Error("refreshMedia_ must take a media uri");var n=void 0,r=void 0;r=this.masterPlaylistLoader_?(n=this.masterPlaylistLoader_.master,this.masterPlaylistLoader_.parseMasterXml()):(n=this.master,this.parseMasterXml());var i=cc(n,r);i?(this.masterPlaylistLoader_?this.masterPlaylistLoader_.master=i:this.master=i,this.media_=i.playlists[e]):(this.media_=r.playlists[e],this.trigger("playlistunchanged")),this.media().endList||(this.mediaUpdateTimeout=y.setTimeout(function(){t.trigger("mediaupdatetimeout")},ql(this.media(),!!i))),this.trigger("loadedplaylist")}}]),gc);function gc(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r=arguments[3];Bl(this,gc);var i=Hl(this,(gc.__proto__||Object.getPrototypeOf(gc)).call(this)),a=n.withCredentials,o=void 0!==a&&a,s=n.handleManifestRedirects,l=void 0!==s&&s;if(i.hls_=t,i.withCredentials=o,i.handleManifestRedirects=l,!e)throw new Error("A non-empty playlist URL or playlist is required");return i.on("minimumUpdatePeriod",function(){i.refreshXml_()}),i.on("mediaupdatetimeout",function(){i.refreshMedia_(i.media().uri)}),i.state="HAVE_NOTHING",i.loadedPlaylists_={},"string"==typeof e?(i.srcUrl=e,i.sidxMapping_={},Hl(i)):(i.setupChildLoader(r,e),i)}function vc(e){return go.log.debug?go.log.debug.bind(go,"VHS:",e+" >"):function(){}}function yc(){}var _c=(Fl(bc,[{key:"createSourceBuffer_",value:function(e,t){var n=this;this.sourceBuffer_=this.mediaSource.addSourceBuffer(e),this.logger_("created SourceBuffer"),t&&(t.trigger("sourcebufferadded"),this.mediaSource.sourceBuffers.length<2)?t.on("sourcebufferadded",function(){n.start_()}):this.start_()}},{key:"start_",value:function(){var t=this;this.started_=!0,this.onUpdateendCallback_=function(){var e=t.pendingCallback_;t.pendingCallback_=null,t.sourceBuffer_.removing=!1,t.logger_("buffered ["+Au(t.buffered())+"]"),e&&e(),t.runCallback_()},this.sourceBuffer_.addEventListener("updateend",this.onUpdateendCallback_),this.runCallback_()}},{key:"abort",value:function(e){var t=this;this.processedAppend_&&this.queueCallback_(function(){t.sourceBuffer_.abort()},e)}},{key:"appendBuffer",value:function(e,t){var n=this;this.processedAppend_=!0,this.queueCallback_(function(){e.videoSegmentTimingInfoCallback&&n.sourceBuffer_.addEventListener("videoSegmentTimingInfo",e.videoSegmentTimingInfoCallback),n.sourceBuffer_.appendBuffer(e.bytes)},function(){e.videoSegmentTimingInfoCallback&&n.sourceBuffer_.removeEventListener("videoSegmentTimingInfo",e.videoSegmentTimingInfoCallback),t()})}},{key:"buffered",value:function(){return this.sourceBuffer_?this.sourceBuffer_.buffered:go.createTimeRanges()}},{key:"remove",value:function(e,t,n){var r=this,i=2<arguments.length&&void 0!==n?n:yc;this.processedAppend_&&this.queueCallback_(function(){r.logger_("remove ["+e+" => "+t+"]"),r.sourceBuffer_.removing=!0,r.sourceBuffer_.remove(e,t)},i)}},{key:"updating",value:function(){return!this.sourceBuffer_||this.sourceBuffer_.updating||!!this.pendingCallback_&&this.pendingCallback_!==yc}},{key:"timestampOffset",value:function(e){var t=this;return void 0!==e&&(this.queueCallback_(function(){t.sourceBuffer_.timestampOffset=e,t.runCallback_()}),this.timestampOffset_=e),this.timestampOffset_}},{key:"queueCallback_",value:function(e,t){this.callbacks_.push([e.bind(this),t]),this.runCallback_()}},{key:"runCallback_",value:function(){var e=void 0;!this.updating()&&this.callbacks_.length&&this.started_&&(e=this.callbacks_.shift(),this.pendingCallback_=e[1],e[0]())}},{key:"dispose",value:function(){function e(){t.sourceBuffer_&&"open"===t.mediaSource.readyState&&t.sourceBuffer_.abort(),t.sourceBuffer_.removeEventListener("updateend",e)}var t=this;this.sourceBuffer_.removeEventListener("updateend",this.onUpdateendCallback_),this.sourceBuffer_.removing?this.sourceBuffer_.addEventListener("updateend",e):e()}}]),bc);function bc(e,t,n,r){Bl(this,bc),this.callbacks_=[],this.pendingCallback_=null,this.timestampOffset_=0,this.mediaSource=e,this.processedAppend_=!1,this.type_=n,this.mimeType_=t,this.logger_=vc("SourceUpdater["+n+"]["+t+"]"),"closed"===e.readyState?e.addEventListener("sourceopen",this.createSourceBuffer_.bind(this,t,r)):this.createSourceBuffer_(t,r)}function Ec(e){e.forEach(function(e){e.abort()})}function Tc(e,t){return t.timedout?{status:t.status,message:"HLS request timed-out at URL: "+t.uri,code:Lc,xhr:t}:t.aborted?{status:t.status,message:"HLS request aborted at URL: "+t.uri,code:Oc,xhr:t}:e?{status:t.status,message:"HLS request errored at URL: "+t.uri,code:Dc,xhr:t}:null}function Ac(i,a){return function(e,t){var n=t.response,r=Tc(e,t);return r?a(r,i):(i.key.bytes=new Uint32Array(function(e){for(var t=[];8<=e.length;)t.push(parseInt(e.substring(0,8),16)),e=e.substring(8,e.length);return t}(function(e){var t=JSON.parse(atob(e)),n=t.ciphertext,r=CryptoJS.enc.Hex.parse(t.salt),i=CryptoJS.enc.Hex.parse(t.iv);e=CryptoJS.PBKDF2(t.passphrase,r,{hasher:CryptoJS.algo.SHA512,keySize:8,iterations:999});return CryptoJS.AES.decrypt(n,e,{iv:i}).toString(CryptoJS.enc.Utf8)}(n))),a(null,i))}}function wc(n,r,i){var a=0,o=!1;return function(e,t){if(!o)return e?(o=!0,Ec(n),i(e,t)):(a+=1)===n.length?(t.endOfAllRequests=Date.now(),t.encryptedBytes?function(r,i,a){r.addEventListener("message",function e(t){if(t.data.source===i.requestId){r.removeEventListener("message",e);var n=t.data.decrypted;return i.bytes=new Uint8Array(n.bytes,n.byteOffset,n.byteLength),a(null,i)}});var e=void 0;e=i.key.bytes.slice?i.key.bytes.slice():new Uint32Array(Array.prototype.slice.call(i.key.bytes)),r.postMessage(pu({source:i.requestId,encrypted:i.encryptedBytes,key:e,iv:i.key.iv}),[i.encryptedBytes.buffer,e.buffer])}(r,t,i):i(null,t)):void 0}}function Sc(t,n){return function(e){return t.stats=go.mergeOptions(t.stats,function(e){var t=e.target,n={bandwidth:1/0,bytesReceived:0,roundTripTime:Date.now()-t.requestTime||0};return n.bytesReceived=e.loaded,n.bandwidth=Math.floor(n.bytesReceived/n.roundTripTime*8*1e3),n}(e)),!t.stats.firstBytesReceivedAt&&t.stats.bytesReceived&&(t.stats.firstBytesReceivedAt=Date.now()),n(e,t)}}function Cc(e,t,n,r,i,a,o){var s=[],l=wc(s,n,o);if(i.key&&!i.key.bytes)if(!i.key.resolvedUri.includes("?action")||G.browser.IS_IOS||G.browser.IS_ANDROID){u=e(go.mergeOptions(t,{uri:i.key.resolvedUri,responseType:"arraybuffer"}),function(a,o){return function(e,t){var n=t.response,r=Tc(e,t);if(r)return o(r,a);if(16!==n.byteLength)return console.log("The key length is not correct check for white spaces in ajax response"),o({status:t.status,message:"Invalid HLS key at URL: "+t.uri,code:Dc,xhr:t},a);var i=new DataView(n);return a.key.bytes=new Uint32Array([i.getUint32(0),i.getUint32(4),i.getUint32(8),i.getUint32(12)]),o(null,a)}}(i,l));s.push(u)}else{var u=e(go.mergeOptions(t,{uri:i.key.resolvedUri,responseType:"text"}),Ac(i,l));s.push(u)}if(i.map&&!i.map.bytes){var c=e(go.mergeOptions(t,{uri:i.map.resolvedUri,responseType:"arraybuffer",headers:du(i.map)}),function(i,a,o){return function(e,t){var n=t.response,r=Tc(e,t);return r?o(r,i):0===n.byteLength?o({status:t.status,message:"Empty HLS segment content at URL: "+t.uri,code:Dc,xhr:t},i):(i.map.bytes=new Uint8Array(t.response),a&&!a.isInitialized()&&a.init(),i.map.timescales=Ms.timescale(i.map.bytes),i.map.videoTrackIds=Ms.videoTrackIds(i.map.bytes),o(null,i))}}(i,r,l));s.push(c)}var d=e(go.mergeOptions(t,{uri:i.resolvedUri,responseType:"arraybuffer",headers:du(i)}),function(a,o,s){return function(e,t){var n=t.response,r=Tc(e,t),i=void 0;return r?s(r,a):0===n.byteLength?s({status:t.status,message:"Empty HLS segment content at URL: "+t.uri,code:Dc,xhr:t},a):(a.stats=function(e){return{bandwidth:e.bandwidth,bytesReceived:e.bytesReceived||0,roundTripTime:e.roundTripTime||0}}(t),a.key?a.encryptedBytes=new Uint8Array(t.response):a.bytes=new Uint8Array(t.response),o&&a.map&&a.map.bytes&&(o.isInitialized()||o.init(),(i=o.parse(a.bytes,a.map.videoTrackIds,a.map.timescales))&&i.captions&&(a.captionStreams=i.captionStreams,a.fmp4Captions=i.captions)),s(null,a))}}(i,r,l));return d.addEventListener("progress",Sc(i,a)),s.push(d),function(){return Ec(s)}}function xc(e,t){var n;return e&&(n=y.getComputedStyle(e))?n[t]:""}function Mc(e,r){var i=e.slice();e.sort(function(e,t){var n=r(e,t);return 0===n?i.indexOf(e)-i.indexOf(t):n})}function Rc(e,t){var n=void 0,r=void 0;return e.attributes.BANDWIDTH&&(n=e.attributes.BANDWIDTH),n=n||y.Number.MAX_VALUE,t.attributes.BANDWIDTH&&(r=t.attributes.BANDWIDTH),n-(r=r||y.Number.MAX_VALUE)}function Ic(e){return"number"==typeof e&&isFinite(e)}var Pc={GOAL_BUFFER_LENGTH:30,MAX_GOAL_BUFFER_LENGTH:60,GOAL_BUFFER_LENGTH_RATE:1,INITIAL_BANDWIDTH:4194304,BANDWIDTH_VARIANCE:1.2,BUFFER_LOW_WATER_LINE:0,MAX_BUFFER_LOW_WATER_LINE:30,BUFFER_LOW_WATER_LINE_RATE:1},Dc=2,Lc=-101,Oc=-102,Nc=(Ul(kc,go.EventTarget),Fl(kc,[{key:"resetStats_",value:function(){this.mediaBytesTransferred=0,this.mediaRequests=0,this.mediaRequestsAborted=0,this.mediaRequestsTimedout=0,this.mediaRequestsErrored=0,this.mediaTransferDuration=0,this.mediaSecondsLoaded=0}},{key:"dispose",value:function(){this.state="DISPOSED",this.pause(),this.abort_(),this.sourceUpdater_&&this.sourceUpdater_.dispose(),this.resetStats_(),this.captionParser_&&this.captionParser_.reset()}},{key:"abort",value:function(){"WAITING"===this.state?(this.abort_(),this.state="READY",this.paused()||this.monitorBuffer_()):this.pendingSegment_&&(this.pendingSegment_=null)}},{key:"abort_",value:function(){this.pendingSegment_&&this.pendingSegment_.abortRequests(),this.pendingSegment_=null}},{key:"error",value:function(e){return void 0!==e&&(this.error_=e),this.pendingSegment_=null,this.error_}},{key:"endOfStream",value:function(){this.ended_=!0,this.pause(),this.trigger("ended")}},{key:"buffered_",value:function(){return this.sourceUpdater_?this.sourceUpdater_.buffered():go.createTimeRanges()}},{key:"initSegment",value:function(e,t){var n=1<arguments.length&&void 0!==t&&t;if(!e)return null;var r=mu(e),i=this.initSegments_[r];return n&&!i&&e.bytes&&(this.initSegments_[r]=i={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:e.bytes,timescales:e.timescales,videoTrackIds:e.videoTrackIds}),i||e}},{key:"segmentKey",value:function(e,t){var n=1<arguments.length&&void 0!==t&&t;if(!e)return null;var r=gu(e),i=this.keyCache_[r];this.cacheEncryptionKeys_&&n&&!i&&e.bytes&&(this.keyCache_[r]=i={resolvedUri:e.resolvedUri,bytes:e.bytes});var a={resolvedUri:(i||e).resolvedUri};return i&&(a.bytes=i.bytes),a}},{key:"couldBeginLoading_",value:function(){return this.playlist_&&(this.sourceUpdater_||this.mimeType_&&"INIT"===this.state)&&!this.paused()}},{key:"load",value:function(){if(this.monitorBuffer_(),this.playlist_){if(this.syncController_.setDateTimeMapping(this.playlist_),"INIT"===this.state&&this.couldBeginLoading_())return this.init_();!this.couldBeginLoading_()||"READY"!==this.state&&"INIT"!==this.state||(this.state="READY")}}},{key:"init_",value:function(){return this.state="READY",this.sourceUpdater_=new _c(this.mediaSource_,this.mimeType_,this.loaderType_,this.sourceBufferEmitter_),this.resetEverything(),this.monitorBuffer_()}},{key:"playlist",value:function(e,t){var n=1<arguments.length&&void 0!==t?t:{};if(e){var r=this.playlist_,i=this.pendingSegment_;this.playlist_=e,this.xhrOptions_=n,this.hasPlayed_()||(e.syncInfo={mediaSequence:e.mediaSequence,time:0});var a=null;if(r&&(r.id?a=r.id:r.uri&&(a=r.uri)),this.logger_("playlist update ["+a+" => "+(e.id||e.uri)+"]"),this.trigger("syncinfoupdate"),"INIT"===this.state&&this.couldBeginLoading_())return this.init_();if(r&&r.uri===e.uri){var o=e.mediaSequence-r.mediaSequence;this.logger_("live window shift ["+o+"]"),null!==this.mediaIndex&&(this.mediaIndex-=o),i&&(i.mediaIndex-=o,0<=i.mediaIndex&&(i.segment=e.segments[i.mediaIndex])),this.syncController_.saveExpiredSegmentInfo(r,e)}else null!==this.mediaIndex&&this.resyncLoader()}}},{key:"pause",value:function(){this.checkBufferTimeout_&&(y.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null)}},{key:"paused",value:function(){return null===this.checkBufferTimeout_}},{key:"mimeType",value:function(e,t){this.mimeType_||(this.mimeType_=e,this.sourceBufferEmitter_=t,"INIT"===this.state&&this.couldBeginLoading_()&&this.init_())}},{key:"resetEverything",value:function(e){this.ended_=!1,this.resetLoader(),this.remove(0,this.duration_(),e),this.captionParser_&&this.captionParser_.clearAllCaptions(),this.trigger("reseteverything")}},{key:"resetLoader",value:function(){this.fetchAtBuffer_=!1,this.resyncLoader()}},{key:"resyncLoader",value:function(){this.mediaIndex=null,this.syncPoint_=null,this.abort()}},{key:"remove",value:function(e,t,n){if(this.sourceUpdater_&&this.sourceUpdater_.remove(e,t,n),Su(e,t,this.segmentMetadataTrack_),this.inbandTextTracks_)for(var r in this.inbandTextTracks_)Su(e,t,this.inbandTextTracks_[r])}},{key:"monitorBuffer_",value:function(){this.checkBufferTimeout_&&y.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=y.setTimeout(this.monitorBufferTick_.bind(this),1)}},{key:"monitorBufferTick_",value:function(){"READY"===this.state&&this.fillBuffer_(),this.checkBufferTimeout_&&y.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=y.setTimeout(this.monitorBufferTick_.bind(this),500)}},{key:"fillBuffer_",value:function(){if(!this.sourceUpdater_.updating()){this.syncPoint_||(this.syncPoint_=this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_()));var e=this.checkBuffer_(this.buffered_(),this.playlist_,this.mediaIndex,this.hasPlayed_(),this.currentTime_(),this.syncPoint_);e&&(this.isEndOfStream_(e.mediaIndex)?this.endOfStream():e.mediaIndex===this.playlist_.segments.length-1&&"ended"===this.mediaSource_.readyState&&!this.seeking_()||(e.timeline!==this.currentTimeline_&&(this.syncController_.reset(),e.timestampOffset=e.startOfSegment,this.captionParser_&&this.captionParser_.clearAllCaptions()),this.loadSegment_(e)))}}},{key:"isEndOfStream_",value:function(e,t){return function(e,t,n){if(!e||!t)return!1;var r=n===e.segments.length;return e.endList&&"open"===t.readyState&&r}(1<arguments.length&&void 0!==t?t:this.playlist_,this.mediaSource_,e)&&!this.sourceUpdater_.updating()}},{key:"checkBuffer_",value:function(e,t,n,r,i,a){var o=0,s=void 0;e.length&&(o=e.end(e.length-1));var l=Math.max(0,o-i);if(!t.segments.length)return null;if(l>=this.goalBufferLength_())return null;if(!r&&1<=l)return null;if(null===a)return n=this.getSyncSegmentCandidate_(t),this.generateSegmentInfo_(t,n,null,!0);if(null!==n)return t.segments[n],s=o,this.generateSegmentInfo_(t,n+1,s,!1);if(this.fetchAtBuffer_){var u=Pu.getMediaInfoForTime(t,o,a.segmentIndex,a.time);n=u.mediaIndex,s=u.startTime}else{var c=Pu.getMediaInfoForTime(t,i,a.segmentIndex,a.time);n=c.mediaIndex,s=c.startTime}return this.generateSegmentInfo_(t,n,s,!1)}},{key:"getSyncSegmentCandidate_",value:function(e){var t=this;if(-1===this.currentTimeline_)return 0;var n=e.segments.map(function(e,t){return{timeline:e.timeline,segmentIndex:t}}).filter(function(e){return e.timeline===t.currentTimeline_});return n.length?n[Math.min(n.length-1,1)].segmentIndex:Math.max(e.segments.length-1,0)}},{key:"generateSegmentInfo_",value:function(e,t,n,r){if(t<0||t>=e.segments.length)return null;var i=e.segments[t];return{requestId:"segment-loader-"+Math.random(),uri:i.resolvedUri,mediaIndex:t,isSyncRequest:r,startOfSegment:n,playlist:e,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:i.timeline,duration:i.duration,segment:i}}},{key:"abortRequestEarly_",value:function(e){if(this.hls_.tech_.paused()||!this.xhrOptions_.timeout||!this.playlist_.attributes.BANDWIDTH)return!1;if(Date.now()-(e.firstBytesReceivedAt||Date.now())<1e3)return!1;var t=this.currentTime_(),n=e.bandwidth,r=this.pendingSegment_.duration,i=Pu.estimateSegmentRequestTime(r,n,this.playlist_,e.bytesReceived),a=function(e,t,n){var r=2<arguments.length&&void 0!==n?n:1;return((e.length?e.end(e.length-1):0)-t)/r}(this.buffered_(),t,this.hls_.tech_.playbackRate())-1;if(i<=a)return!1;var o=function(e){var t=e.master,n=e.currentTime,r=e.bandwidth,i=e.duration,a=e.segmentDuration,o=e.timeUntilRebuffer,s=e.currentTimeline,l=e.syncController,u=t.playlists.filter(function(e){return!Pu.isIncompatible(e)}),c=u.filter(Pu.isEnabled);c.length||(c=u.filter(function(e){return!Pu.isDisabled(e)}));var d=c.filter(Pu.hasAttribute.bind(null,"BANDWIDTH")).map(function(e){var t=l.getSyncPoint(e,i,s,n)?1:2;return{playlist:e,rebufferingImpact:Pu.estimateSegmentRequestTime(a,r,e)*t-o}}),h=d.filter(function(e){return e.rebufferingImpact<=0});return Mc(h,function(e,t){return Rc(t.playlist,e.playlist)}),h.length?h[0]:(Mc(d,function(e,t){return e.rebufferingImpact-t.rebufferingImpact}),d[0]||null)}({master:this.hls_.playlists.master,currentTime:t,bandwidth:n,duration:this.duration_(),segmentDuration:r,timeUntilRebuffer:a,currentTimeline:this.currentTimeline_,syncController:this.syncController_});if(o){var s=i-a-o.rebufferingImpact,l=.5;return a<=1/30&&(l=1),!(!o.playlist||o.playlist.uri===this.playlist_.uri||s<l)&&(this.bandwidth=o.playlist.attributes.BANDWIDTH*Pc.BANDWIDTH_VARIANCE+1,this.abort(),this.trigger("earlyabort"),!0)}}},{key:"handleProgress_",value:function(e,t){this.pendingSegment_&&t.requestId===this.pendingSegment_.requestId&&!this.abortRequestEarly_(t.stats)&&this.trigger("progress")}},{key:"loadSegment_",value:function(e){this.state="WAITING",this.pendingSegment_=e,this.trimBackBuffer_(e),e.abortRequests=Cc(this.hls_.xhr,this.xhrOptions_,this.decrypter_,this.captionParser_,this.createSimplifiedSegmentObj_(e),this.handleProgress_.bind(this),this.segmentRequestFinished_.bind(this))}},{key:"trimBackBuffer_",value:function(){var e=function(e,t,n){var r=void 0;return r=e.length&&0<e.start(0)&&e.start(0)<t?e.start(0):t-30,Math.min(r,t-n)}(this.seekable_(),this.currentTime_(),this.playlist_.targetDuration||10);0<e&&this.remove(0,e)}},{key:"createSimplifiedSegmentObj_",value:function(e){var t=e.segment,n={resolvedUri:t.resolvedUri,byterange:t.byterange,requestId:e.requestId};if(t.key){var r=t.key.iv||new Uint32Array([0,0,0,e.mediaIndex+e.playlist.mediaSequence]);n.key=this.segmentKey(t.key),n.key.iv=r}return t.map&&(n.map=this.initSegment(t.map)),n}},{key:"segmentRequestFinished_",value:function(e,t){if(this.mediaRequests+=1,t.stats&&(this.mediaBytesTransferred+=t.stats.bytesReceived,this.mediaTransferDuration+=t.stats.roundTripTime),this.pendingSegment_){if(t.requestId===this.pendingSegment_.requestId){if(e)return this.pendingSegment_=null,this.state="READY",e.code===Oc?void(this.mediaRequestsAborted+=1):(this.pause(),e.code===Lc?(this.mediaRequestsTimedout+=1,this.bandwidth=1,this.roundTrip=NaN,void this.trigger("bandwidthupdate")):(this.mediaRequestsErrored+=1,this.error(e),void this.trigger("error")));this.bandwidth=t.stats.bandwidth,this.roundTrip=t.stats.roundTripTime,t.map&&(t.map=this.initSegment(t.map,!0)),t.key&&this.segmentKey(t.key,!0),this.processSegmentResponse_(t)}}else this.mediaRequestsAborted+=1}},{key:"processSegmentResponse_",value:function(e){var t=this.pendingSegment_;t.bytes=e.bytes,e.map&&(t.segment.map.bytes=e.map.bytes),t.endOfAllRequests=e.endOfAllRequests,e.fmp4Captions&&(function(e,t,n){for(var r in n)if(!e[r]){t.trigger({type:"usage",name:"hls-608"});var i=t.textTracks().getTrackById(r);e[r]=i||t.addRemoteTextTrack({kind:"captions",id:r,label:r},!1).track}}(this.inbandTextTracks_,this.hls_.tech_,e.captionStreams),function(e){var i=e.inbandTextTracks,t=e.captionArray,a=e.timestampOffset;if(t){var o=window.WebKitDataCue||window.VTTCue;t.forEach(function(e){var t=e.stream,n=e.startTime,r=e.endTime;i[t]&&(n+=a,r+=a,i[t].addCue(new o(n,r,e.text)))})}}({inbandTextTracks:this.inbandTextTracks_,captionArray:e.fmp4Captions,timestampOffset:0}),this.captionParser_&&this.captionParser_.clearParsedCaptions()),this.handleSegment_()}},{key:"handleSegment_",value:function(){var e=this;if(this.pendingSegment_){var t=this.pendingSegment_,n=t.segment,r=this.syncController_.probeSegmentInfo(t);void 0===this.startingMedia_&&r&&(r.containsAudio||r.containsVideo)&&(this.startingMedia_={containsAudio:r.containsAudio,containsVideo:r.containsVideo});var i=function(e,t,n){return"main"===e&&t&&n?n.containsAudio||n.containsVideo?t.containsVideo&&!n.containsVideo?"Only audio found in segment when we expected video. We can't switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest.":!t.containsVideo&&n.containsVideo?"Video found in segment when we expected only audio. We can't switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest.":null:"Neither audio nor video found in segment.":null}(this.loaderType_,this.startingMedia_,r);if(i)return this.error({message:i,blacklistDuration:1/0}),void this.trigger("error");if(t.isSyncRequest)return this.trigger("syncinfoupdate"),this.pendingSegment_=null,void(this.state="READY");if(null!==t.timestampOffset&&t.timestampOffset!==this.sourceUpdater_.timestampOffset()){if(r&&r.segmentTimestampInfo){var a=r.segmentTimestampInfo[0].ptsTime,o=r.segmentTimestampInfo[0].dtsTime;t.timestampOffset-=a-o}this.sourceUpdater_.timestampOffset(t.timestampOffset),this.trigger("timestampoffset")}var s=this.syncController_.mappingForTimeline(t.timeline);if(null!==s&&this.trigger({type:"segmenttimemapping",mapping:s}),this.state="APPENDING",n.map){var l=mu(n.map);if(!this.activeInitSegmentId_||this.activeInitSegmentId_!==l){var u=this.initSegment(n.map);this.sourceUpdater_.appendBuffer({bytes:u.bytes},function(){e.activeInitSegmentId_=l})}}t.byteLength=t.bytes.byteLength,"number"==typeof n.start&&"number"==typeof n.end?this.mediaSecondsLoaded+=n.end-n.start:this.mediaSecondsLoaded+=n.duration,this.logger_(function(e){var t=e.segment,n=t.start,r=t.end,i=e.playlist,a=i.mediaSequence,o=i.id,s=i.segments,l=void 0===s?[]:s,u=e.mediaIndex,c=e.timeline;return["appending ["+u+"] of ["+a+", "+(a+l.length)+"] from playlist ["+o+"]","["+n+" => "+r+"] in timeline ["+c+"]"].join(" ")}(t)),this.sourceUpdater_.appendBuffer({bytes:t.bytes,videoSegmentTimingInfoCallback:this.handleVideoSegmentTimingInfo_.bind(this,t.requestId)},this.handleUpdateEnd_.bind(this))}else this.state="READY"}},{key:"handleVideoSegmentTimingInfo_",value:function(e,t){if(this.pendingSegment_&&e===this.pendingSegment_.requestId){var n=this.pendingSegment_.segment;n.videoTimingInfo||(n.videoTimingInfo={}),n.videoTimingInfo.transmuxerPrependedSeconds=t.videoSegmentTimingInfo.prependedContentDuration||0,n.videoTimingInfo.transmuxedPresentationStart=t.videoSegmentTimingInfo.start.presentation,n.videoTimingInfo.transmuxedPresentationEnd=t.videoSegmentTimingInfo.end.presentation,n.videoTimingInfo.baseMediaDecodeTime=t.videoSegmentTimingInfo.baseMediaDecodeTime}}},{key:"handleUpdateEnd_",value:function(){if(!this.pendingSegment_)return this.state="READY",void(this.paused()||this.monitorBuffer_());var e=this.pendingSegment_,t=e.segment,n=null!==this.mediaIndex;this.pendingSegment_=null,this.recordThroughput_(e),this.addSegmentMetadataCue_(e),this.state="READY",this.mediaIndex=e.mediaIndex,this.fetchAtBuffer_=!0,this.currentTimeline_=e.timeline,this.trigger("syncinfoupdate"),t.end&&this.currentTime_()-t.end>3*e.playlist.targetDuration?this.resetEverything():(n&&this.trigger("bandwidthupdate"),this.trigger("progress"),this.isEndOfStream_(e.mediaIndex+1,e.playlist)&&this.endOfStream(),this.paused()||this.monitorBuffer_())}},{key:"recordThroughput_",value:function(e){var t=this.throughput.rate,n=Date.now()-e.endOfAllRequests+1,r=Math.floor(e.byteLength/n*8*1e3);this.throughput.rate+=(r-t)/++this.throughput.count}},{key:"addSegmentMetadataCue_",value:function(e){if(this.segmentMetadataTrack_){var t=e.segment,n=t.start,r=t.end;if(Ic(n)&&Ic(r)){Su(n,r,this.segmentMetadataTrack_);var i=y.WebKitDataCue||y.VTTCue,a={custom:t.custom,dateTimeObject:t.dateTimeObject,dateTimeString:t.dateTimeString,bandwidth:e.playlist.attributes.BANDWIDTH,resolution:e.playlist.attributes.RESOLUTION,codecs:e.playlist.attributes.CODECS,byteLength:e.byteLength,uri:e.uri,timeline:e.timeline,playlist:e.playlist.uri,start:n,end:r},o=new i(n,r,JSON.stringify(a));o.value=a,this.segmentMetadataTrack_.addCue(o)}}}}]),kc);function kc(e){Bl(this,kc);var t=Hl(this,(kc.__proto__||Object.getPrototypeOf(kc)).call(this));if(!e)throw new TypeError("Initialization settings are required");if("function"!=typeof e.currentTime)throw new TypeError("No currentTime getter specified");if(!e.mediaSource)throw new TypeError("No MediaSource specified");return t.bandwidth=e.bandwidth,t.throughput={rate:0,count:0},t.roundTrip=NaN,t.resetStats_(),t.mediaIndex=null,t.hasPlayed_=e.hasPlayed,t.currentTime_=e.currentTime,t.seekable_=e.seekable,t.seeking_=e.seeking,t.duration_=e.duration,t.mediaSource_=e.mediaSource,t.hls_=e.hls,t.loaderType_=e.loaderType,t.startingMedia_=void 0,t.segmentMetadataTrack_=e.segmentMetadataTrack,t.goalBufferLength_=e.goalBufferLength,t.sourceType_=e.sourceType,t.inbandTextTracks_=e.inbandTextTracks,t.state_="INIT",t.checkBufferTimeout_=null,t.error_=void 0,t.currentTimeline_=-1,t.pendingSegment_=null,t.mimeType_=null,t.sourceUpdater_=null,t.xhrOptions_=null,t.activeInitSegmentId_=null,t.initSegments_={},t.cacheEncryptionKeys_=e.cacheEncryptionKeys,t.keyCache_={},"main"===t.loaderType_?t.captionParser_=new Xs:t.captionParser_=null,t.decrypter_=e.decrypter,t.syncController_=e.syncController,t.syncPoint_={segmentIndex:0,time:0},t.syncController_.on("syncinfoupdate",function(){return t.trigger("syncinfoupdate")}),t.mediaSource_.addEventListener("sourceopen",function(){return t.ended_=!1}),t.fetchAtBuffer_=!1,t.logger_=vc("SegmentLoader["+t.loaderType_+"]"),Object.defineProperty(t,"state",{get:function(){return this.state_},set:function(e){e!==this.state_&&(this.logger_(this.state_+" -> "+e),this.state_=e)}}),t}function Bc(e){return decodeURIComponent(escape(String.fromCharCode.apply(null,e)))}var Fc=new Uint8Array("\n\n".split("").map(function(e){return e.charCodeAt(0)})),jc=(Ul(Uc,Nc),Fl(Uc,[{key:"buffered_",value:function(){if(!this.subtitlesTrack_||!this.subtitlesTrack_.cues.length)return go.createTimeRanges();var e=this.subtitlesTrack_.cues,t=e[0].startTime,n=e[e.length-1].startTime;return go.createTimeRanges([[t,n]])}},{key:"initSegment",value:function(e,t){var n=1<arguments.length&&void 0!==t&&t;if(!e)return null;var r=mu(e),i=this.initSegments_[r];if(n&&!i&&e.bytes){var a=Fc.byteLength+e.bytes.byteLength,o=new Uint8Array(a);o.set(e.bytes),o.set(Fc,e.bytes.byteLength),this.initSegments_[r]=i={resolvedUri:e.resolvedUri,byterange:e.byterange,bytes:o}}return i||e}},{key:"couldBeginLoading_",value:function(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()}},{key:"init_",value:function(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()}},{key:"track",value:function(e){return void 0===e||(this.subtitlesTrack_=e,"INIT"===this.state&&this.couldBeginLoading_()&&this.init_()),this.subtitlesTrack_}},{key:"remove",value:function(e,t){Su(e,t,this.subtitlesTrack_)}},{key:"fillBuffer_",value:function(){var e=this;this.syncPoint_||(this.syncPoint_=this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_()));var t=this.checkBuffer_(this.buffered_(),this.playlist_,this.mediaIndex,this.hasPlayed_(),this.currentTime_(),this.syncPoint_);if(t=this.skipEmptySegments_(t)){if(null===this.syncController_.timestampOffsetForTimeline(t.timeline))return this.syncController_.one("timestampoffset",function(){e.state="READY",e.paused()||e.monitorBuffer_()}),void(this.state="WAITING_ON_TIMELINE");this.loadSegment_(t)}}},{key:"skipEmptySegments_",value:function(e){for(;e&&e.segment.empty;)e=this.generateSegmentInfo_(e.playlist,e.mediaIndex+1,e.startOfSegment+e.duration,e.isSyncRequest);return e}},{key:"handleSegment_",value:function(){var t=this;if(this.pendingSegment_&&this.subtitlesTrack_){this.state="APPENDING";var e=this.pendingSegment_,n=e.segment;if("function"!=typeof y.WebVTT&&this.subtitlesTrack_&&this.subtitlesTrack_.tech_){function r(){t.subtitlesTrack_.tech_.off("vttjsloaded",i),t.error({message:"Error loading vtt.js"}),t.state="READY",t.pause(),t.trigger("error")}var i=void 0;return i=function(){t.subtitlesTrack_.tech_.off("vttjserror",r),t.handleSegment_()},this.state="WAITING_ON_VTTJS",this.subtitlesTrack_.tech_.one("vttjsloaded",i),void this.subtitlesTrack_.tech_.one("vttjserror",r)}n.requested=!0;try{this.parseVTTCues_(e)}catch(e){return this.error({message:e.message}),this.state="READY",this.pause(),this.trigger("error")}if(this.updateTimeMapping_(e,this.syncController_.timelines[e.timeline],this.playlist_),e.isSyncRequest)return this.trigger("syncinfoupdate"),this.pendingSegment_=null,void(this.state="READY");e.byteLength=e.bytes.byteLength,this.mediaSecondsLoaded+=n.duration,e.cues.length&&this.remove(e.cues[0].endTime,e.cues[e.cues.length-1].endTime),e.cues.forEach(function(e){t.subtitlesTrack_.addCue(e)}),this.handleUpdateEnd_()}else this.state="READY"}},{key:"parseVTTCues_",value:function(t){var e=void 0,n=!1;"function"==typeof y.TextDecoder?e=new y.TextDecoder("utf8"):(e=y.WebVTT.StringDecoder(),n=!0);var r=new y.WebVTT.Parser(y,y.vttjs,e);if(t.cues=[],t.timestampmap={MPEGTS:0,LOCAL:0},r.oncue=t.cues.push.bind(t.cues),r.ontimestampmap=function(e){return t.timestampmap=e},r.onparsingerror=function(e){go.log.warn("Error encountered when parsing cues: "+e.message)},t.segment.map){var i=t.segment.map.bytes;n&&(i=Bc(i)),r.parse(i)}var a=t.bytes;n&&(a=Bc(a)),r.parse(a),r.flush()}},{key:"updateTimeMapping_",value:function(e,t,n){var r=e.segment;if(t)if(e.cues.length){var i=e.timestampmap,a=i.MPEGTS/9e4-i.LOCAL+t.mapping;if(e.cues.forEach(function(e){e.startTime+=a,e.endTime+=a}),!n.syncInfo){var o=e.cues[0].startTime,s=e.cues[e.cues.length-1].startTime;n.syncInfo={mediaSequence:n.mediaSequence+e.mediaIndex,time:Math.min(o,s-r.duration)}}}else r.empty=!0}}]),Uc);function Uc(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};Bl(this,Uc);var n=Hl(this,(Uc.__proto__||Object.getPrototypeOf(Uc)).call(this,e,t));return n.mediaSource_=null,n.subtitlesTrack_=null,n}function Hc(e,t){for(var n=e.cues,r=0;r<n.length;r++){var i=n[r];if(t>=i.adStartTime&&t<=i.adEndTime)return i}return null}var Gc=_l,Vc=[{name:"VOD",run:function(e,t,n){if(n===1/0)return null;return{time:0,segmentIndex:0}}},{name:"ProgramDateTime",run:function(e,t,n,r,i){if(!e.datetimeToDisplayTime)return null;var a=t.segments||[],o=null,s=null;i=i||0;for(var l=0;l<a.length;l++){var u=a[l];if(u.dateTimeObject){var c=u.dateTimeObject.getTime()/1e3+e.datetimeToDisplayTime,d=Math.abs(i-c);if(null!==s&&(0===d||s<d))break;s=d,o={time:c,segmentIndex:l}}}return o}},{name:"Segment",run:function(e,t,n,r,i){var a=t.segments||[],o=null,s=null;i=i||0;for(var l=0;l<a.length;l++){var u=a[l];if(u.timeline===r&&void 0!==u.start){var c=Math.abs(i-u.start);if(null!==s&&s<c)break;(!o||null===s||c<=s)&&(s=c,o={time:u.start,segmentIndex:l})}}return o}},{name:"Discontinuity",run:function(e,t,n,r,i){var a=null;if(i=i||0,t.discontinuityStarts&&t.discontinuityStarts.length)for(var o=null,s=0;s<t.discontinuityStarts.length;s++){var l=t.discontinuityStarts[s],u=t.discontinuitySequence+s+1,c=e.discontinuities[u];if(c){var d=Math.abs(i-c.time);if(null!==o&&o<d)break;(!a||null===o||d<=o)&&(o=d,a={time:c.time,segmentIndex:l})}}return a}},{name:"Playlist",run:function(e,t){return t.syncInfo?{time:t.syncInfo.time,segmentIndex:t.syncInfo.mediaSequence-t.mediaSequence}:null}}],zc=(Ul(Wc,go.EventTarget),Fl(Wc,[{key:"getSyncPoint",value:function(e,t,n,r){var i=this.runStrategies_(e,t,n,r);return i.length?this.selectSyncPoint_(i,{key:"time",value:r}):null}},{key:"getExpiredTime",value:function(e,t){if(!e||!e.segments)return null;var n=this.runStrategies_(e,t,e.discontinuitySequence,0);if(!n.length)return null;var r=this.selectSyncPoint_(n,{key:"segmentIndex",value:0});return 0<r.segmentIndex&&(r.time*=-1),Math.abs(r.time+eu(e,r.segmentIndex,0))}},{key:"runStrategies_",value:function(e,t,n,r){for(var i=[],a=0;a<Vc.length;a++){var o=Vc[a],s=o.run(this,e,t,n,r);s&&(s.strategy=o.name,i.push({strategy:o.name,syncPoint:s}))}return i}},{key:"selectSyncPoint_",value:function(e,t){for(var n=e[0].syncPoint,r=Math.abs(e[0].syncPoint[t.key]-t.value),i=e[0].strategy,a=1;a<e.length;a++){var o=Math.abs(e[a].syncPoint[t.key]-t.value);o<r&&(r=o,n=e[a].syncPoint,i=e[a].strategy)}return this.logger_("syncPoint for ["+t.key+": "+t.value+"] chosen with strategy ["+i+"]: [time:"+n.time+", segmentIndex:"+n.segmentIndex+"]"),n}},{key:"saveExpiredSegmentInfo",value:function(e,t){for(var n=t.mediaSequence-e.mediaSequence-1;0<=n;n--){var r=e.segments[n];if(r&&void 0!==r.start){t.syncInfo={mediaSequence:e.mediaSequence+n,time:r.start},this.logger_("playlist refresh sync: [time:"+t.syncInfo.time+", mediaSequence: "+t.syncInfo.mediaSequence+"]"),this.trigger("syncinfoupdate");break}}}},{key:"setDateTimeMapping",value:function(e){if(!this.datetimeToDisplayTime&&e.segments&&e.segments.length&&e.segments[0].dateTimeObject){var t=e.segments[0].dateTimeObject.getTime()/1e3;this.datetimeToDisplayTime=-t}}},{key:"reset",value:function(){this.inspectCache_=void 0}},{key:"probeSegmentInfo",value:function(e){var t=e.segment,n=e.playlist,r=void 0;return(r=t.map?this.probeMp4Segment_(e):this.probeTsSegment_(e))&&this.calculateSegmentTimeMapping_(e,r)&&(this.saveDiscontinuitySyncInfo_(e),n.syncInfo||(n.syncInfo={mediaSequence:n.mediaSequence+e.mediaIndex,time:t.start})),r}},{key:"probeMp4Segment_",value:function(e){var t=e.segment,n=Ms.timescale(t.map.bytes),r=Ms.startTime(n,e.bytes);return null!==e.timestampOffset&&(e.timestampOffset-=r),{start:r,end:r+t.duration}}},{key:"probeTsSegment_",value:function(e){var t=Gc(e.bytes,this.inspectCache_),n=void 0,r=void 0,i=void 0;return t?(t.video&&2===t.video.length?(this.inspectCache_=t.video[1].dts,n=t.video[0].dtsTime,r=t.video[1].dtsTime,i=t.video):t.audio&&2===t.audio.length&&(this.inspectCache_=t.audio[1].dts,n=t.audio[0].dtsTime,r=t.audio[1].dtsTime,i=t.audio),{segmentTimestampInfo:i,start:n,end:r,containsVideo:t.video&&2===t.video.length,containsAudio:t.audio&&2===t.audio.length}):null}},{key:"timestampOffsetForTimeline",value:function(e){return void 0===this.timelines[e]?null:this.timelines[e].time}},{key:"mappingForTimeline",value:function(e){return void 0===this.timelines[e]?null:this.timelines[e].mapping}},{key:"calculateSegmentTimeMapping_",value:function(e,t){var n=e.segment,r=this.timelines[e.timeline];if(null!==e.timestampOffset)r={time:e.startOfSegment,mapping:e.startOfSegment-t.start},this.timelines[e.timeline]=r,this.trigger("timestampoffset"),this.logger_("time mapping for timeline "+e.timeline+": [time: "+r.time+"] [mapping: "+r.mapping+"]"),n.start=e.startOfSegment,n.end=t.end+r.mapping;else{if(!r)return!1;n.start=t.start+r.mapping,n.end=t.end+r.mapping}return!0}},{key:"saveDiscontinuitySyncInfo_",value:function(e){var t=e.playlist,n=e.segment;if(n.discontinuity)this.discontinuities[n.timeline]={time:n.start,accuracy:0};else if(t.discontinuityStarts&&t.discontinuityStarts.length)for(var r=0;r<t.discontinuityStarts.length;r++){var i=t.discontinuityStarts[r],a=t.discontinuitySequence+r+1,o=i-e.mediaIndex,s=Math.abs(o);if(!this.discontinuities[a]||this.discontinuities[a].accuracy>s){var l=void 0;l=o<0?n.start-eu(t,e.mediaIndex,i):n.end+eu(t,e.mediaIndex+1,i),this.discontinuities[a]={time:l,accuracy:s}}}}}]),Wc);function Wc(){Bl(this,Wc);var e=Hl(this,(Wc.__proto__||Object.getPrototypeOf(Wc)).call(this));return e.inspectCache_=void 0,e.timelines=[],e.discontinuities=[],e.datetimeToDisplayTime=null,e.logger_=vc("SyncController"),e}function qc(e,t){e.abort(),e.pause(),t&&t.activePlaylistLoader&&(t.activePlaylistLoader.pause(),t.activePlaylistLoader=null)}function Yc(e,t){(t.activePlaylistLoader=e).load()}function Kc(t){["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(function(e){Jc[e](e,t)});var n=t.mediaTypes,e=t.masterPlaylistLoader,r=t.tech,i=t.hls;["AUDIO","SUBTITLES"].forEach(function(e){n[e].activeGroup=function(a,o){return function(t){var e=o.masterPlaylistLoader,n=o.mediaTypes[a].groups,r=e.media();if(!r)return null;var i=null;return r.attributes[a]&&(i=n[r.attributes[a]]),i=i||n.main,void 0===t?i:null===t?null:i.filter(function(e){return e.id===t.id})[0]||null}}(e,t),n[e].activeTrack=$c[e](e,t),n[e].onGroupChanged=function(s,l){return function(){var e=l.segmentLoaders,t=e[s],n=e.main,r=l.mediaTypes[s],i=r.activeTrack(),a=r.activeGroup(i),o=r.activePlaylistLoader;qc(t,r),a&&(a.playlistLoader?(t.resyncLoader(),Yc(a.playlistLoader,r)):o&&n.resetEverything())}}(e,t),n[e].onTrackChanged=function(s,l){return function(){var e=l.segmentLoaders,t=e[s],n=e.main,r=l.mediaTypes[s],i=r.activeTrack(),a=r.activeGroup(i),o=r.activePlaylistLoader;qc(t,r),a&&(a.playlistLoader?(o!==a.playlistLoader&&(t.track&&t.track(i),t.resetEverything()),Yc(a.playlistLoader,r)):n.resetEverything())}}(e,t)});var a=n.AUDIO.activeGroup(),o=(a.filter(function(e){return e.default})[0]||a[0]).id;function s(){n.AUDIO.onTrackChanged(),r.trigger({type:"usage",name:"hls-audio-change"})}for(var l in n.AUDIO.tracks[o].enabled=!0,n.AUDIO.onTrackChanged(),e.on("mediachange",function(){["AUDIO","SUBTITLES"].forEach(function(e){return n[e].onGroupChanged()})}),r.audioTracks().addEventListener("change",s),r.remoteTextTracks().addEventListener("change",n.SUBTITLES.onTrackChanged),i.on("dispose",function(){r.audioTracks().removeEventListener("change",s),r.remoteTextTracks().removeEventListener("change",n.SUBTITLES.onTrackChanged)}),r.clearTracks("audio"),n.AUDIO.tracks)r.audioTracks().addTrack(n.AUDIO.tracks[l])}var Xc=new Hu("./decrypter-worker.worker.js",function(e,t){var n,c,g,r,i,l,o,a=this;n=function(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e},c=null,h.prototype.decrypt=function(e,t,n,r,i,a){var o=this._key[1],s=e^o[0],l=r^o[1],u=n^o[2],c=t^o[3],d=void 0,h=void 0,f=void 0,p=o.length/4-2,m=void 0,g=4,v=this._tables[1],y=v[0],_=v[1],b=v[2],E=v[3],T=v[4];for(m=0;m<p;m++)d=y[s>>>24]^_[l>>16&255]^b[u>>8&255]^E[255&c]^o[g],h=y[l>>>24]^_[u>>16&255]^b[c>>8&255]^E[255&s]^o[g+1],f=y[u>>>24]^_[c>>16&255]^b[s>>8&255]^E[255&l]^o[g+2],c=y[c>>>24]^_[s>>16&255]^b[l>>8&255]^E[255&u]^o[g+3],g+=4,s=d,l=h,u=f;for(m=0;m<4;m++)i[(3&-m)+a]=T[s>>>24]<<24^T[l>>16&255]<<16^T[u>>8&255]<<8^T[255&c]^o[g++],d=s,s=l,l=u,u=c,c=d},g=h,u.prototype.on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},u.prototype.off=function(e,t){if(!this.listeners[e])return!1;var n=this.listeners[e].indexOf(t);return this.listeners[e].splice(n,1),-1<n},u.prototype.trigger=function(e,t){var n=this.listeners[e];if(n)if(2===arguments.length)for(var r=n.length,i=0;i<r;++i)n[i].call(this,t);else for(var a=Array.prototype.slice.call(arguments,1),o=n.length,s=0;s<o;++s)n[s].apply(this,a)},u.prototype.dispose=function(){this.listeners={}},u.prototype.pipe=function(t){this.on("data",function(e){t.push(e)})},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(f,i=r=u),f.prototype.processJob_=function(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null},f.prototype.push=function(e){this.jobs.push(e),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))},l=f,p.prototype.decryptChunk_=function(t,n,r,i){return function(){var e=function(e,t,n){var r=new Int32Array(e.buffer,e.byteOffset,e.byteLength>>2),i=new g(Array.prototype.slice.call(t)),a=new Uint8Array(e.byteLength),o=new Int32Array(a.buffer),s=void 0,l=void 0,u=void 0,c=void 0,d=void 0,h=void 0,f=void 0,p=void 0,m=void 0;for(s=n[0],l=n[1],u=n[2],c=n[3],m=0;m<r.length;m+=4)d=v(r[m]),h=v(r[m+1]),f=v(r[m+2]),p=v(r[m+3]),i.decrypt(d,h,f,p,o,m),o[m]=v(o[m]^s),o[m+1]=v(o[m+1]^l),o[m+2]=v(o[m+2]^u),o[m+3]=v(o[m+3]^c),s=d,l=h,u=f,c=p;return a}(t,n,r);i.set(e,t.byteOffset)}},n(p,null,[{key:"STEP",get:function(){return 32e3}}]),o=p,new function(a){a.onmessage=function(e){var n=e.data,t=new Uint8Array(n.encrypted.bytes,n.encrypted.byteOffset,n.encrypted.byteLength),r=new Uint32Array(n.key.bytes,n.key.byteOffset,n.key.byteLength/4),i=new Uint32Array(n.iv.bytes,n.iv.byteOffset,n.iv.byteLength/4);new o(t,r,i,function(e,t){a.postMessage(function(n){var r={};return Object.keys(n).forEach(function(e){var t=n[e];ArrayBuffer.isView(t)?r[e]={bytes:t.buffer,byteOffset:t.byteOffset,byteLength:t.byteLength}:r[e]=t}),r}({source:n.source,decrypted:t}),[t.buffer])})}}(a);function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e){d(this,h),c=c||function(){var e=[[[],[],[],[],[]],[[],[],[],[],[]]],t=e[0],n=e[1],r=t[4],i=n[4],a=void 0,o=void 0,s=void 0,l=[],u=[],c=void 0,d=void 0,h=void 0,f=void 0,p=void 0;for(a=0;a<256;a++)u[(l[a]=a<<1^283*(a>>7))^a]=a;for(o=s=0;!r[o];o^=c||1,s=u[s]||1)for(h=(h=s^s<<1^s<<2^s<<3^s<<4)>>8^255&h^99,p=16843009*l[d=l[c=l[i[r[o]=h]=o]]]^65537*d^257*c^16843008*o,f=257*l[h]^16843008*h,a=0;a<4;a++)t[a][o]=f=f<<24^f>>>8,n[a][h]=p=p<<24^p>>>8;for(a=0;a<5;a++)t[a]=t[a].slice(0),n[a]=n[a].slice(0);return e}(),this._tables=[[c[0][0].slice(),c[0][1].slice(),c[0][2].slice(),c[0][3].slice(),c[0][4].slice()],[c[1][0].slice(),c[1][1].slice(),c[1][2].slice(),c[1][3].slice(),c[1][4].slice()]];var t=void 0,n=void 0,r=void 0,i=void 0,a=void 0,o=this._tables[0][4],s=this._tables[1],l=e.length,u=1;if(4!==l&&6!==l&&8!==l)throw new Error("Invalid aes key size");for(i=e.slice(0),a=[],this._key=[i,a],t=l;t<4*l+28;t++)r=i[t-1],(t%l==0||8===l&&t%l==4)&&(r=o[r>>>24]<<24^o[r>>16&255]<<16^o[r>>8&255]<<8^o[255&r],t%l==0&&(r=r<<8^r>>>24^u<<24,u=u<<1^283*(u>>7))),i[t]=i[t-l]^r;for(n=0;t;n++,t--)r=i[3&n?t:t-4],a[n]=t<=4||n<4?r:s[0][o[r>>>24]]^s[1][o[r>>16&255]]^s[2][o[r>>8&255]]^s[3][o[255&r]]}function u(){d(this,u),this.listeners={}}function f(){d(this,f);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,i.call(this,r));return e.jobs=[],e.delay=1,e.timeout_=null,e}function v(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24}function p(e,t,n,r){d(this,p);var i=p.STEP,a=new Int32Array(e.buffer),o=new Uint8Array(e.byteLength),s=0;for(this.asyncStream_=new l,this.asyncStream_.push(this.decryptChunk_(a.subarray(s,s+i),t,n,o)),s=i;s<a.length;s+=i)n=new Uint32Array([v(a[s-4]),v(a[s-3]),v(a[s-2]),v(a[s-1])]),this.asyncStream_.push(this.decryptChunk_(a.subarray(s,s+i),t,n,o));this.asyncStream_.push(function(){r(null,function(e){return e.subarray(0,e.byteLength-e[e.byteLength-1])}(o))})}}),Qc={AUDIO:function(l,u){return function(){var e=u.segmentLoaders[l],t=u.mediaTypes[l],n=u.blacklistCurrentPlaylist;qc(e,t);var r=t.activeTrack(),i=t.activeGroup(),a=(i.filter(function(e){return e.default})[0]||i[0]).id,o=t.tracks[a];if(r!==o){for(var s in go.log.warn("Problem encountered loading the alternate audio track.Switching back to default."),t.tracks)t.tracks[s].enabled=t.tracks[s]===o;t.onTrackChanged()}else n({message:"Problem encountered loading the default audio track."})}},SUBTITLES:function(r,i){return function(){var e=i.segmentLoaders[r],t=i.mediaTypes[r];go.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track."),qc(e,t);var n=t.activeTrack();n&&(n.mode="disabled"),t.onTrackChanged()}}},Zc={AUDIO:function(e,t,n){if(t){var r=n.tech,i=n.requestOptions,a=n.segmentLoaders[e];t.on("loadedmetadata",function(){var e=t.media();a.playlist(e,i),(!r.paused()||e.endList&&"none"!==r.preload())&&a.load()}),t.on("loadedplaylist",function(){a.playlist(t.media(),i),r.paused()||a.load()}),t.on("error",Qc[e](e,n))}},SUBTITLES:function(e,t,n){var r=n.tech,i=n.requestOptions,a=n.segmentLoaders[e],o=n.mediaTypes[e];t.on("loadedmetadata",function(){var e=t.media();a.playlist(e,i),a.track(o.activeTrack()),(!r.paused()||e.endList&&"none"!==r.preload())&&a.load()}),t.on("loadedplaylist",function(){a.playlist(t.media(),i),r.paused()||a.load()}),t.on("error",Qc[e](e,n))}},Jc={AUDIO:function(e,t){var n,r,i=t.hls,a=t.sourceType,o=t.segmentLoaders[e],s=t.requestOptions,l=t.master.mediaGroups,u=t.mediaTypes[e],c=u.groups,d=u.tracks,h=t.masterPlaylistLoader;for(var f in l[e]&&0!==Object.keys(l[e]).length||(l[e]={main:{default:{default:!0}}}),l[e])for(var p in c[f]||(c[f]=[]),l[e][f]){var m=l[e][f][p],g=void 0;if(g=m.resolvedUri?new Ql(m.resolvedUri,i,s):m.playlists&&"dash"===a?new mc(m.playlists[0],i,s,h):null,m=go.mergeOptions({id:p,playlistLoader:g},m),Zc[e](e,m.playlistLoader,t),c[f].push(m),void 0===d[p]){var v=new go.AudioTrack({id:p,kind:(n=m,r=void 0,r=n.default?"main":"alternative",n.characteristics&&0<=n.characteristics.indexOf("public.accessibility.describes-video")&&(r="main-desc"),r),enabled:!1,language:m.language,default:m.default,label:p});d[p]=v}}o.on("error",Qc[e](e,t))},SUBTITLES:function(e,t){var n=t.tech,r=t.hls,i=t.sourceType,a=t.segmentLoaders[e],o=t.requestOptions,s=t.master.mediaGroups,l=t.mediaTypes[e],u=l.groups,c=l.tracks,d=t.masterPlaylistLoader;for(var h in s[e])for(var f in u[h]||(u[h]=[]),s[e][h])if(!s[e][h][f].forced){var p=s[e][h][f],m=void 0;if("hls"===i?m=new Ql(p.resolvedUri,r,o):"dash"===i&&(m=new mc(p.playlists[0],r,o,d)),p=go.mergeOptions({id:f,playlistLoader:m},p),Zc[e](e,p.playlistLoader,t),u[h].push(p),void 0===c[f]){var g=n.addRemoteTextTrack({id:f,kind:"subtitles",default:p.default&&p.autoselect,language:p.language,label:f},!1).track;c[f]=g}}a.on("error",Qc[e](e,t))},"CLOSED-CAPTIONS":function(e,t){var n=t.tech,r=t.master.mediaGroups,i=t.mediaTypes[e],a=i.groups,o=i.tracks;for(var s in r[e])for(var l in a[s]||(a[s]=[]),r[e][s]){var u=r[e][s][l];if(u.instreamId.match(/CC\d/)&&(a[s].push(go.mergeOptions({id:l},u)),void 0===o[l])){var c=n.addRemoteTextTrack({id:u.instreamId,kind:"captions",default:u.default&&u.autoselect,language:u.language,label:l},!1).track;o[l]=c}}}},$c={AUDIO:function(n,r){return function(){var e=r.mediaTypes[n].tracks;for(var t in e)if(e[t].enabled)return e[t];return null}},SUBTITLES:function(n,r){return function(){var e=r.mediaTypes[n].tracks;for(var t in e)if("showing"===e[t].mode)return e[t];return null}}},ed=void 0,td=["mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaBytesTransferred"],nd=(Ul(rd,go.EventTarget),Fl(rd,[{key:"setupMasterPlaylistLoaderListeners_",value:function(){var r=this;this.masterPlaylistLoader_.on("loadedmetadata",function(){var e=r.masterPlaylistLoader_.media(),t=1.5*e.targetDuration*1e3;uu(r.masterPlaylistLoader_.master,r.masterPlaylistLoader_.media())?r.requestOptions_.timeout=0:r.requestOptions_.timeout=t,e.endList&&"none"!==r.tech_.preload()&&(r.mainSegmentLoader_.playlist(e,r.requestOptions_),r.mainSegmentLoader_.load()),Kc({sourceType:r.sourceType_,segmentLoaders:{AUDIO:r.audioSegmentLoader_,SUBTITLES:r.subtitleSegmentLoader_,main:r.mainSegmentLoader_},tech:r.tech_,requestOptions:r.requestOptions_,masterPlaylistLoader:r.masterPlaylistLoader_,hls:r.hls_,master:r.master(),mediaTypes:r.mediaTypes_,blacklistCurrentPlaylist:r.blacklistCurrentPlaylist.bind(r)}),r.triggerPresenceUsage_(r.master(),e);try{r.setupSourceBuffers_()}catch(e){return go.log.warn("Failed to create SourceBuffers",e),r.mediaSource.endOfStream("decode")}r.setupFirstPlay(),!r.mediaTypes_.AUDIO.activePlaylistLoader||r.mediaTypes_.AUDIO.activePlaylistLoader.media()?r.trigger("selectedinitialmedia"):r.mediaTypes_.AUDIO.activePlaylistLoader.one("loadedmetadata",function(){r.trigger("selectedinitialmedia")})}),this.masterPlaylistLoader_.on("loadedplaylist",function(){var e=r.masterPlaylistLoader_.media();if(!e){r.excludeUnsupportedVariants_();var t=void 0;return r.enableLowInitialPlaylist&&(t=r.selectInitialPlaylist()),t=t||r.selectPlaylist(),r.initialMedia_=t,void r.masterPlaylistLoader_.media(r.initialMedia_)}if(r.useCueTags_&&r.updateAdCues_(e),r.mainSegmentLoader_.playlist(e,r.requestOptions_),r.updateDuration(),r.tech_.paused()||(r.mainSegmentLoader_.load(),r.audioSegmentLoader_&&r.audioSegmentLoader_.load()),!e.endList){function n(){var e=r.seekable();0!==e.length&&r.mediaSource.addSeekableRange_(e.start(0),e.end(0))}r.duration()!==1/0?r.tech_.one("durationchange",function e(){r.duration()===1/0?n():r.tech_.one("durationchange",e)}):n()}}),this.masterPlaylistLoader_.on("error",function(){r.blacklistCurrentPlaylist(r.masterPlaylistLoader_.error)}),this.masterPlaylistLoader_.on("mediachanging",function(){r.mainSegmentLoader_.abort(),r.mainSegmentLoader_.pause()}),this.masterPlaylistLoader_.on("mediachange",function(){var e=r.masterPlaylistLoader_.media(),t=1.5*e.targetDuration*1e3;uu(r.masterPlaylistLoader_.master,r.masterPlaylistLoader_.media())?r.requestOptions_.timeout=0:r.requestOptions_.timeout=t,r.mainSegmentLoader_.playlist(e,r.requestOptions_),r.mainSegmentLoader_.load(),r.tech_.trigger({type:"mediachange",bubbles:!0})}),this.masterPlaylistLoader_.on("playlistunchanged",function(){var e=r.masterPlaylistLoader_.media();r.stuckAtPlaylistEnd_(e)&&(r.blacklistCurrentPlaylist({message:"Playlist no longer updating."}),r.tech_.trigger("playliststuck"))}),this.masterPlaylistLoader_.on("renditiondisabled",function(){r.tech_.trigger({type:"usage",name:"hls-rendition-disabled"})}),this.masterPlaylistLoader_.on("renditionenabled",function(){r.tech_.trigger({type:"usage",name:"hls-rendition-enabled"})})}},{key:"triggerPresenceUsage_",value:function(e,t){var n=e.mediaGroups||{},r=!0,i=Object.keys(n.AUDIO);for(var a in n.AUDIO)for(var o in n.AUDIO[a])n.AUDIO[a][o].uri||(r=!1);r&&this.tech_.trigger({type:"usage",name:"hls-demuxed"}),Object.keys(n.SUBTITLES).length&&this.tech_.trigger({type:"usage",name:"hls-webvtt"}),ed.Playlist.isAes(t)&&this.tech_.trigger({type:"usage",name:"hls-aes"}),ed.Playlist.isFmp4(t)&&this.tech_.trigger({type:"usage",name:"hls-fmp4"}),i.length&&1<Object.keys(n.AUDIO[i[0]]).length&&this.tech_.trigger({type:"usage",name:"hls-alternate-audio"}),this.useCueTags_&&this.tech_.trigger({type:"usage",name:"hls-playlist-cue-tags"})}},{key:"setupSegmentLoaderListeners_",value:function(){var a=this;this.mainSegmentLoader_.on("bandwidthupdate",function(){var e=a.selectPlaylist(),t=a.masterPlaylistLoader_.media(),n=a.tech_.buffered(),r=n.length?n.end(n.length-1)-a.tech_.currentTime():0,i=a.bufferLowWaterLine();(!t.endList||a.duration()<Pc.MAX_BUFFER_LOW_WATER_LINE||e.attributes.BANDWIDTH<t.attributes.BANDWIDTH||i<=r)&&a.masterPlaylistLoader_.media(e),a.tech_.trigger("bandwidthupdate")}),this.mainSegmentLoader_.on("progress",function(){a.trigger("progress")}),this.mainSegmentLoader_.on("error",function(){a.blacklistCurrentPlaylist(a.mainSegmentLoader_.error())}),this.mainSegmentLoader_.on("syncinfoupdate",function(){a.onSyncInfoUpdate_()}),this.mainSegmentLoader_.on("timestampoffset",function(){a.tech_.trigger({type:"usage",name:"hls-timestamp-offset"})}),this.audioSegmentLoader_.on("syncinfoupdate",function(){a.onSyncInfoUpdate_()}),this.mainSegmentLoader_.on("ended",function(){a.onEndOfStream()}),this.mainSegmentLoader_.on("earlyabort",function(){a.blacklistCurrentPlaylist({message:"Aborted early because there isn't enough bandwidth to complete the request without rebuffering."},120)}),this.mainSegmentLoader_.on("reseteverything",function(){a.tech_.trigger("hls-reset")}),this.mainSegmentLoader_.on("segmenttimemapping",function(e){a.tech_.trigger({type:"hls-segment-time-mapping",mapping:e.mapping})}),this.audioSegmentLoader_.on("ended",function(){a.onEndOfStream()})}},{key:"mediaSecondsLoaded_",value:function(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)}},{key:"load",value:function(){this.mainSegmentLoader_.load(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.load(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.load()}},{key:"smoothQualityChange_",value:function(){var e=this.selectPlaylist();e!==this.masterPlaylistLoader_.media()&&(this.masterPlaylistLoader_.media(e),this.mainSegmentLoader_.resetLoader())}},{key:"fastQualityChange_",value:function(){var e=this,t=this.selectPlaylist();t!==this.masterPlaylistLoader_.media()&&(this.masterPlaylistLoader_.media(t),this.mainSegmentLoader_.resetEverything(function(){go.browser.IE_VERSION||go.browser.IS_EDGE?e.tech_.setCurrentTime(e.tech_.currentTime()+.04):e.tech_.setCurrentTime(e.tech_.currentTime())}))}},{key:"play",value:function(){if(!this.setupFirstPlay()){this.tech_.ended()&&this.seekTo_(0),this.hasPlayed_()&&this.load();var e=this.tech_.seekable();return this.tech_.duration()===1/0&&this.tech_.currentTime()<e.start(0)?this.seekTo_(e.end(e.length-1)):void 0}}},{key:"setupFirstPlay",value:function(){var e=this,t=this.masterPlaylistLoader_.media();if(!t||this.tech_.paused()||this.hasPlayed_())return!1;if(!t.endList){var n=this.seekable();if(!n.length)return!1;if(go.browser.IE_VERSION&&0===this.tech_.readyState())return this.tech_.one("loadedmetadata",function(){e.trigger("firstplay"),e.seekTo_(n.end(0)),e.hasPlayed_=function(){return!0}}),!1;this.trigger("firstplay"),this.seekTo_(n.end(0))}return this.hasPlayed_=function(){return!0},this.load(),!0}},{key:"handleSourceOpen_",value:function(){try{this.setupSourceBuffers_()}catch(e){return go.log.warn("Failed to create Source Buffers",e),this.mediaSource.endOfStream("decode")}if(this.tech_.autoplay()){var e=this.tech_.play();void 0!==e&&"function"==typeof e.then&&e.then(null,function(e){})}this.trigger("sourceopen")}},{key:"onEndOfStream",value:function(){var e=this.mainSegmentLoader_.ended_;if(this.mediaTypes_.AUDIO.activePlaylistLoader&&(e=!this.mainSegmentLoader_.startingMedia_||this.mainSegmentLoader_.startingMedia_.containsVideo?e&&this.audioSegmentLoader_.ended_:this.audioSegmentLoader_.ended_),e){this.logger_("calling mediaSource.endOfStream()");try{this.mediaSource.endOfStream()}catch(e){go.log.warn("Failed to call media source endOfStream",e)}}}},{key:"stuckAtPlaylistEnd_",value:function(e){if(!this.seekable().length)return!1;var t=this.syncController_.getExpiredTime(e,this.mediaSource.duration);if(null===t)return!1;var n=ed.Playlist.playlistEnd(e,t),r=this.tech_.currentTime(),i=this.tech_.buffered();if(!i.length)return n-r<=.1;var a=i.end(i.length-1);return a-r<=.1&&n-a<=.1}},{key:"blacklistCurrentPlaylist",value:function(e,t){var n,r=0<arguments.length&&void 0!==e?e:{},i=t,a=void 0;if(a=r.playlist||this.masterPlaylistLoader_.media(),i=i||r.blacklistDuration||this.blacklistDuration,!a){this.error=r;try{return this.mediaSource.endOfStream("network")}catch(e){return this.trigger("error")}}var o=1===this.masterPlaylistLoader_.master.playlists.filter(su).length,s=this.masterPlaylistLoader_.master.playlists;return 1===s.length?(go.log.warn("Problem encountered with the current HLS playlist. Trying again since it is the only playlist."),this.tech_.trigger("retryplaylist"),this.masterPlaylistLoader_.load(o)):(o&&(go.log.warn("Removing all playlists from the blacklist because the last rendition is about to be blacklisted."),s.forEach(function(e){e.excludeUntil!==1/0&&delete e.excludeUntil}),this.tech_.trigger("retryplaylist")),a.excludeUntil=Date.now()+1e3*i,this.tech_.trigger("blacklistplaylist"),this.tech_.trigger({type:"usage",name:"hls-rendition-blacklisted"}),n=this.selectPlaylist(),go.log.warn("Problem encountered with the current HLS playlist."+(r.message?" "+r.message:"")+" Switching to another playlist."),this.masterPlaylistLoader_.media(n,o))}},{key:"pauseLoading",value:function(){this.mainSegmentLoader_.pause(),this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.pause(),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.pause()}},{key:"setCurrentTime",value:function(e){var t=Eu(this.tech_.buffered(),e);return this.masterPlaylistLoader_&&this.masterPlaylistLoader_.media()&&this.masterPlaylistLoader_.media().segments?t&&t.length?e:(this.mainSegmentLoader_.resetEverything(),this.mainSegmentLoader_.abort(),this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.resetEverything(),this.audioSegmentLoader_.abort()),this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.resetEverything(),this.subtitleSegmentLoader_.abort()),void this.load()):0}},{key:"duration",value:function(){return this.masterPlaylistLoader_?this.mediaSource?this.mediaSource.duration:ed.Playlist.duration(this.masterPlaylistLoader_.media()):0}},{key:"seekable",value:function(){return this.seekable_}},{key:"onSyncInfoUpdate_",value:function(){var e=void 0,t=void 0;if(this.masterPlaylistLoader_){var n=this.masterPlaylistLoader_.media();if(n){var r=this.syncController_.getExpiredTime(n,this.mediaSource.duration);if(null!==r&&0!==(e=ed.Playlist.seekable(n,r)).length){if(this.mediaTypes_.AUDIO.activePlaylistLoader){if(n=this.mediaTypes_.AUDIO.activePlaylistLoader.media(),null===(r=this.syncController_.getExpiredTime(n,this.mediaSource.duration)))return;if(0===(t=ed.Playlist.seekable(n,r)).length)return}var i=void 0,a=void 0;this.seekable_&&this.seekable_.length&&(i=this.seekable_.end(0),a=this.seekable_.start(0)),t?t.start(0)>e.end(0)||e.start(0)>t.end(0)?this.seekable_=e:this.seekable_=go.createTimeRanges([[t.start(0)>e.start(0)?t.start(0):e.start(0),t.end(0)<e.end(0)?t.end(0):e.end(0)]]):this.seekable_=e,this.seekable_&&this.seekable_.length&&this.seekable_.end(0)===i&&this.seekable_.start(0)===a||(this.logger_("seekable updated ["+Au(this.seekable_)+"]"),this.tech_.trigger("seekablechanged"))}}}}},{key:"updateDuration",value:function(){function e(){t.logger_("Setting duration from "+t.mediaSource.duration+" => "+r);try{t.mediaSource.duration=r}catch(e){go.log.warn("Failed to set media source duration",e)}t.tech_.trigger("durationchange"),t.mediaSource.removeEventListener("sourceopen",e)}var t=this,n=this.mediaSource.duration,r=ed.Playlist.duration(this.masterPlaylistLoader_.media()),i=this.tech_.buffered();0<i.length&&(r=Math.max(r,i.end(i.length-1))),n!==r&&("open"!==this.mediaSource.readyState?this.mediaSource.addEventListener("sourceopen",e):e())}},{key:"dispose",value:function(){var r=this;this.decrypter_.terminate(),this.masterPlaylistLoader_.dispose(),this.mainSegmentLoader_.dispose(),["AUDIO","SUBTITLES"].forEach(function(e){var t=r.mediaTypes_[e].groups;for(var n in t)t[n].forEach(function(e){e.playlistLoader&&e.playlistLoader.dispose()})}),this.audioSegmentLoader_.dispose(),this.subtitleSegmentLoader_.dispose()}},{key:"master",value:function(){return this.masterPlaylistLoader_.master}},{key:"media",value:function(){return this.masterPlaylistLoader_.media()||this.initialMedia_}},{key:"setupSourceBuffers_",value:function(){var e,t=this.masterPlaylistLoader_.media();if(t&&"open"===this.mediaSource.readyState){if((e=Xu(this.masterPlaylistLoader_.master,t)).length<1)return this.error="No compatible SourceBuffer configuration for the variant stream:"+t.resolvedUri,this.mediaSource.endOfStream("decode");this.configureLoaderMimeTypes_(e),this.excludeIncompatibleVariants_(t)}}},{key:"configureLoaderMimeTypes_",value:function(e){var t=1<e.length&&-1===e[0].indexOf(",")&&e[0]!==e[1]?new go.EventTarget:null;this.mainSegmentLoader_.mimeType(e[0],t),e[1]&&this.audioSegmentLoader_.mimeType(e[1],t)}},{key:"excludeUnsupportedVariants_",value:function(){this.master().playlists.forEach(function(e){e.attributes.CODECS&&y.MediaSource&&y.MediaSource.isTypeSupported&&!y.MediaSource.isTypeSupported('video/mp4; codecs="'+function(e){return e.replace(/avc1\.(\d+)\.(\d+)/i,function(e){return qu([e])[0]})}(e.attributes.CODECS)+'"')&&(e.excludeUntil=1/0)})}},{key:"excludeIncompatibleVariants_",value:function(e){var n=2,r=null,t=void 0;e.attributes.CODECS&&(t=Yu(e.attributes.CODECS),r=t.videoCodec,n=t.codecCount),this.master().playlists.forEach(function(e){var t={codecCount:2,videoCodec:null};e.attributes.CODECS&&(t=Yu(e.attributes.CODECS)),t.codecCount!==n&&(e.excludeUntil=1/0),t.videoCodec!==r&&(e.excludeUntil=1/0)})}},{key:"updateAdCues_",value:function(e){var t=0,n=this.seekable();n.length&&(t=n.start(0)),function(e,t,n){var r=2<arguments.length&&void 0!==n?n:0;if(e.segments)for(var i=r,a=void 0,o=0;o<e.segments.length;o++){var s=e.segments[o];if(a=a||Hc(t,i+s.duration/2)){if("cueIn"in s){a.endTime=i,a.adEndTime=i,i+=s.duration,a=null;continue}if(i<a.endTime){i+=s.duration;continue}a.endTime+=s.duration}else if("cueOut"in s&&((a=new y.VTTCue(i,i+s.duration,s.cueOut)).adStartTime=i,a.adEndTime=i+parseFloat(s.cueOut),t.addCue(a)),"cueOutCont"in s){var l,u,c=s.cueOutCont.split("/").map(parseFloat),d=Yl(c,2);l=d[0],u=d[1],(a=new y.VTTCue(i,i+s.duration,"")).adStartTime=i-l,a.adEndTime=a.adStartTime+u,t.addCue(a)}i+=s.duration}}(e,this.cueTagsTrack_,t)}},{key:"goalBufferLength",value:function(){var e=this.tech_.currentTime(),t=Pc.GOAL_BUFFER_LENGTH,n=Pc.GOAL_BUFFER_LENGTH_RATE,r=Math.max(t,Pc.MAX_GOAL_BUFFER_LENGTH);return Math.min(t+e*n,r)}},{key:"bufferLowWaterLine",value:function(){var e=this.tech_.currentTime(),t=Pc.BUFFER_LOW_WATER_LINE,n=Pc.BUFFER_LOW_WATER_LINE_RATE,r=Math.max(t,Pc.MAX_BUFFER_LOW_WATER_LINE);return Math.min(t+e*n,r)}}]),rd);function rd(e){Bl(this,rd);var t=Hl(this,(rd.__proto__||Object.getPrototypeOf(rd)).call(this)),n=e.url,r=e.handleManifestRedirects,i=e.withCredentials,a=e.tech,o=e.bandwidth,s=e.externHls,l=e.useCueTags,u=e.blacklistDuration,c=e.enableLowInitialPlaylist,d=e.sourceType,h=e.seekTo,f=e.cacheEncryptionKeys;if(!n)throw new Error("A non-empty playlist URL is required");ed=s,t.withCredentials=i,t.tech_=a,t.hls_=a.hls,t.seekTo_=h,t.sourceType_=d,t.useCueTags_=l,t.blacklistDuration=u,t.enableLowInitialPlaylist=c,t.useCueTags_&&(t.cueTagsTrack_=t.tech_.addTextTrack("metadata","ad-cues"),t.cueTagsTrack_.inBandMetadataTrackDispatchType=""),t.requestOptions_={withCredentials:i,handleManifestRedirects:r,timeout:null},t.mediaTypes_=function(){var t={};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(function(e){t[e]={groups:{},tracks:{},activePlaylistLoader:null,activeGroup:yc,activeTrack:yc,onGroupChanged:yc,onTrackChanged:yc}}),t}(),t.mediaSource=new go.MediaSource,t.mediaSource.addEventListener("sourceopen",t.handleSourceOpen_.bind(t)),t.seekable_=go.createTimeRanges(),t.hasPlayed_=function(){return!1},t.syncController_=new zc(e),t.segmentMetadataTrack_=a.addRemoteTextTrack({kind:"metadata",label:"segment-metadata"},!1).track,t.decrypter_=new Xc,t.inbandTextTracks_={};var p={hls:t.hls_,mediaSource:t.mediaSource,currentTime:t.tech_.currentTime.bind(t.tech_),seekable:function(){return t.seekable()},seeking:function(){return t.tech_.seeking()},duration:function(){return t.mediaSource.duration},hasPlayed:function(){return t.hasPlayed_()},goalBufferLength:function(){return t.goalBufferLength()},bandwidth:o,syncController:t.syncController_,decrypter:t.decrypter_,sourceType:t.sourceType_,inbandTextTracks:t.inbandTextTracks_,cacheEncryptionKeys:f};return t.masterPlaylistLoader_="dash"===t.sourceType_?new mc(n,t.hls_,t.requestOptions_):new Ql(n,t.hls_,t.requestOptions_),t.setupMasterPlaylistLoaderListeners_(),t.mainSegmentLoader_=new Nc(go.mergeOptions(p,{segmentMetadataTrack:t.segmentMetadataTrack_,loaderType:"main"}),e),t.audioSegmentLoader_=new Nc(go.mergeOptions(p,{loaderType:"audio"}),e),t.subtitleSegmentLoader_=new jc(go.mergeOptions(p,{loaderType:"vtt"}),e),t.setupSegmentLoaderListeners_(),td.forEach(function(e){t[e+"_"]=function(e){return this.audioSegmentLoader_[e]+this.mainSegmentLoader_[e]}.bind(t,e)}),t.logger_=vc("MPC"),t.masterPlaylistLoader_.load(),t}function id(e,t,n){Bl(this,id);var r=e.masterPlaylistController_,i=r[(e.options_.smoothQualityChange?"smooth":"fast")+"QualityChange_"].bind(r);if(t.attributes.RESOLUTION){var a=t.attributes.RESOLUTION;this.width=a.width,this.height=a.height}this.bandwidth=t.attributes.BANDWIDTH,this.id=n,this.enabled=function(i,a,o){return function(e){var t=i.master.playlists[a],n=ou(t),r=su(t);return void 0===e?r:(e?delete t.disabled:t.disabled=!0,e===r||n||(o(),e?i.trigger("renditionenabled"):i.trigger("renditiondisabled")),e)}}(e.playlists,t.uri,i)}var ad=["seeking","seeked","pause","playing","error"],od=(Fl(sd,[{key:"monitorCurrentTime_",value:function(){this.checkCurrentTime_(),this.checkCurrentTimeTimeout_&&y.clearTimeout(this.checkCurrentTimeTimeout_),this.checkCurrentTimeTimeout_=y.setTimeout(this.monitorCurrentTime_.bind(this),250)}},{key:"checkCurrentTime_",value:function(){if(this.tech_.seeking()&&this.fixesBadSeeks_())return this.consecutiveUpdates=0,void(this.lastRecordedTime=this.tech_.currentTime());if(!this.tech_.paused()&&!this.tech_.seeking()){var e=this.tech_.currentTime(),t=this.tech_.buffered();if(this.lastRecordedTime===e&&(!t.length||e+.1>=t.end(t.length-1)))return this.techWaiting_();5<=this.consecutiveUpdates&&e===this.lastRecordedTime?(this.consecutiveUpdates++,this.waiting_()):e===this.lastRecordedTime?this.consecutiveUpdates++:(this.consecutiveUpdates=0,this.lastRecordedTime=e)}}},{key:"cancelTimer_",value:function(){this.consecutiveUpdates=0,this.timer_&&(this.logger_("cancelTimer_"),clearTimeout(this.timer_)),this.timer_=null}},{key:"fixesBadSeeks_",value:function(){if(!this.tech_.seeking())return!1;var e=this.seekable(),t=this.tech_.currentTime(),n=void 0;return this.afterSeekableWindow_(e,t,this.media(),this.allowSeeksWithinUnsafeLiveWindow)&&(n=e.end(e.length-1)),this.beforeSeekableWindow_(e,t)&&(n=e.start(0)+.1),void 0!==n&&(this.logger_("Trying to seek outside of seekable at time "+t+" with seekable range "+Au(e)+". Seeking to "+n+"."),this.seekTo(n),!0)}},{key:"waiting_",value:function(){if(!this.techWaiting_()){var e=this.tech_.currentTime(),t=this.tech_.buffered(),n=Eu(t,e);return n.length&&e+3<=n.end(0)?(this.cancelTimer_(),this.seekTo(e),this.logger_("Stopped at "+e+" while inside a buffered region ["+n.start(0)+" -> "+n.end(0)+"]. Attempting to resume playback by seeking to the current time."),void this.tech_.trigger({type:"usage",name:"hls-unknown-waiting"})):void 0}}},{key:"techWaiting_",value:function(){var e=this.seekable(),t=this.tech_.currentTime();if(this.tech_.seeking()&&this.fixesBadSeeks_())return!0;if(this.tech_.seeking()||null!==this.timer_)return!0;if(this.beforeSeekableWindow_(e,t)){var n=e.end(e.length-1);return this.logger_("Fell out of live window at time "+t+". Seeking to live point (seekable end) "+n),this.cancelTimer_(),this.seekTo(n),this.tech_.trigger({type:"usage",name:"hls-live-resync"}),!0}var r=this.tech_.buffered(),i=Tu(r,t);if(this.videoUnderflow_(i,r,t))return this.cancelTimer_(),this.seekTo(t),this.tech_.trigger({type:"usage",name:"hls-video-underflow"}),!0;if(0<i.length){var a=i.start(0)-t;return this.logger_("Stopped at "+t+", setting timer for "+a+", seeking to "+i.start(0)),this.timer_=setTimeout(this.skipTheGap_.bind(this),1e3*a,t),!0}return!1}},{key:"afterSeekableWindow_",value:function(e,t,n,r){var i=3<arguments.length&&void 0!==r&&r;if(!e.length)return!1;var a=e.end(e.length-1)+.1;return!n.endList&&i&&(a=e.end(e.length-1)+3*n.targetDuration),a<t}},{key:"beforeSeekableWindow_",value:function(e,t){return!!(e.length&&0<e.start(0)&&t<e.start(0)-.1)}},{key:"videoUnderflow_",value:function(e,t,n){if(0===e.length){var r=this.gapFromVideoUnderflow_(t,n);if(r)return this.logger_("Encountered a gap in video from "+r.start+" to "+r.end+". Seeking to current time "+n),!0}return!1}},{key:"skipTheGap_",value:function(e){var t=this.tech_.buffered(),n=this.tech_.currentTime(),r=Tu(t,n);this.cancelTimer_(),0!==r.length&&n===e&&(this.logger_("skipTheGap_:","currentTime:",n,"scheduled currentTime:",e,"nextRange start:",r.start(0)),this.seekTo(r.start(0)+1/30),this.tech_.trigger({type:"usage",name:"hls-gap-skip"}))}},{key:"gapFromVideoUnderflow_",value:function(e,t){for(var n=function(e){if(e.length<2)return go.createTimeRanges();for(var t=[],n=1;n<e.length;n++){var r=e.end(n-1),i=e.start(n);t.push([r,i])}return go.createTimeRanges(t)}(e),r=0;r<n.length;r++){var i=n.start(r),a=n.end(r);if(t-i<4&&2<t-i)return{start:i,end:a}}return null}}]),sd);function sd(e){var t=this;Bl(this,sd),this.tech_=e.tech,this.seekable=e.seekable,this.seekTo=e.seekTo,this.allowSeeksWithinUnsafeLiveWindow=e.allowSeeksWithinUnsafeLiveWindow,this.media=e.media,this.consecutiveUpdates=0,this.lastRecordedTime=null,this.timer_=null,this.checkCurrentTimeTimeout_=null,this.logger_=vc("PlaybackWatcher"),this.logger_("initialize");function n(){return t.monitorCurrentTime_()}function r(){return t.techWaiting_()}function i(){return t.cancelTimer_()}function a(){return t.fixesBadSeeks_()}this.tech_.on("seekablechanged",a),this.tech_.on("waiting",r),this.tech_.on(ad,i),this.tech_.on("canplay",n),this.dispose=function(){t.logger_("dispose"),t.tech_.off("seekablechanged",a),t.tech_.off("waiting",r),t.tech_.off(ad,i),t.tech_.off("canplay",n),t.checkCurrentTimeTimeout_&&y.clearTimeout(t.checkCurrentTimeTimeout_),t.cancelTimer_()}}function ld(t,e){var n=0,r=0,i=go.mergeOptions(cd,e);function a(){r&&t.currentTime(r)}function o(e){null!=e&&(r=t.duration()!==1/0&&t.currentTime()||0,t.one("loadedmetadata",a),t.src(e),t.trigger({type:"usage",name:"hls-error-reload"}),t.play())}function s(){if(Date.now()-n<1e3*i.errorInterval)t.trigger({type:"usage",name:"hls-error-reload-canceled"});else{if(i.getSource&&"function"==typeof i.getSource)return n=Date.now(),i.getSource.call(t,o);go.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!")}}function l(){t.off("loadedmetadata",a),t.off("error",s),t.off("dispose",l)}t.ready(function(){t.trigger({type:"usage",name:"hls-error-reload-initialized"})}),t.on("error",s),t.on("dispose",l),t.reloadSourceOnError=function(e){l(),ld(t,e)}}function ud(e){ld(this,e)}var cd={errorInterval:30,getSource:function(e){return e(this.tech({IWillNotUseThisInPlugins:!0}).currentSource_)}};go.use("*",function(t){return{setSource:function(e,t){t(null,e)},setCurrentTime:function(e){return t.vhs&&t.currentSource().src===t.vhs.source_.src&&t.vhs.setCurrentTime(e),e},play:function(){t.vhs&&t.currentSource().src===t.vhs.source_.src&&t.vhs.setCurrentTime(t.tech_.currentTime())}}});var dd={PlaylistLoader:Ql,Playlist:Pu,Decrypter:Ll,AsyncStream:Rl,decrypt:Dl,utils:Ou,STANDARD_PLAYLIST_SELECTOR:function(){return function(e,t,n,r,i){var a=e.playlists.map(function(e){var t,n;return t=e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width,n=e.attributes.RESOLUTION&&e.attributes.RESOLUTION.height,{bandwidth:e.attributes.BANDWIDTH||y.Number.MAX_VALUE,width:t,height:n,playlist:e}});Mc(a,function(e,t){return e.bandwidth-t.bandwidth});var o=(a=a.filter(function(e){return!Pu.isIncompatible(e.playlist)})).filter(function(e){return Pu.isEnabled(e.playlist)});o.length||(o=a.filter(function(e){return!Pu.isDisabled(e.playlist)}));var s=o.filter(function(e){return e.bandwidth*Pc.BANDWIDTH_VARIANCE<t}),l=s[s.length-1],u=s.filter(function(e){return e.bandwidth===l.bandwidth})[0];if(!1===i){var c=u||o[0]||a[0];return c?c.playlist:null}var d=s.filter(function(e){return e.width&&e.height});Mc(d,function(e,t){return e.width-t.width});var h=d.filter(function(e){return e.width===n&&e.height===r});l=h[h.length-1];var f=h.filter(function(e){return e.bandwidth===l.bandwidth})[0],p=void 0,m=void 0,g=void 0;f||(m=(p=d.filter(function(e){return e.width>n||e.height>r})).filter(function(e){return e.width===p[0].width&&e.height===p[0].height}),l=m[m.length-1],g=m.filter(function(e){return e.bandwidth===l.bandwidth})[0]);var v=g||f||u||o[0]||a[0];return v?v.playlist:null}(this.playlists.master,this.systemBandwidth,parseInt(xc(this.tech_.el(),"width"),10),parseInt(xc(this.tech_.el(),"height"),10),this.limitRenditionByPlayerDimensions)},INITIAL_PLAYLIST_SELECTOR:function(){var e=this.playlists.master.playlists.filter(Pu.isEnabled);return Mc(e,function(e,t){return Rc(e,t)}),e.filter(function(e){return Yu(e.attributes.CODECS).videoCodec})[0]||null},comparePlaylistBandwidth:Rc,comparePlaylistResolution:function(e,t){var n=void 0,r=void 0;return e.attributes.RESOLUTION&&e.attributes.RESOLUTION.width&&(n=e.attributes.RESOLUTION.width),n=n||y.Number.MAX_VALUE,t.attributes.RESOLUTION&&t.attributes.RESOLUTION.width&&(r=t.attributes.RESOLUTION.width),n===(r=r||y.Number.MAX_VALUE)&&e.attributes.BANDWIDTH&&t.attributes.BANDWIDTH?e.attributes.BANDWIDTH-t.attributes.BANDWIDTH:n-r},xhr:cu()};["GOAL_BUFFER_LENGTH","MAX_GOAL_BUFFER_LENGTH","GOAL_BUFFER_LENGTH_RATE","BUFFER_LOW_WATER_LINE","MAX_BUFFER_LOW_WATER_LINE","BUFFER_LOW_WATER_LINE_RATE","BANDWIDTH_VARIANCE"].forEach(function(t){Object.defineProperty(dd,t,{get:function(){return go.log.warn("using Hls."+t+" is UNSAFE be sure you know what you are doing"),Pc[t]},set:function(e){go.log.warn("using Hls."+t+" is UNSAFE be sure you know what you are doing"),"number"!=typeof e||e<0?go.log.warn("value of Hls."+t+" must be greater than or equal to 0"):Pc[t]=e}})});function hd(e){return/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i.test(e)?"hls":/^application\/dash\+xml/i.test(e)?"dash":null}function fd(e,t){for(var n=t.media(),r=-1,i=0;i<e.length;i++)if(e[i].id===n.uri){r=i;break}e.selectedIndex_=r,e.trigger({selectedIndex:r,type:"change"})}var pd="videojs-vhs";dd.canPlaySource=function(){return go.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};function md(e){if("dash"===e.options_.sourceType){var t=go.players[e.tech_.options_.playerId];if(t.eme){var n=function(e,t,n){if(!e)return e;var r={};for(var i in e)r[i]={audioContentType:'audio/mp4; codecs="'+n.attributes.CODECS+'"',videoContentType:'video/mp4; codecs="'+t.attributes.CODECS+'"'},t.contentProtection&&t.contentProtection[i]&&t.contentProtection[i].pssh&&(r[i].pssh=t.contentProtection[i].pssh),"string"==typeof e[i]&&(r[i].url=e[i]);return go.mergeOptions(e,r)}(e.source_.keySystems,e.playlists.media(),e.masterPlaylistController_.mediaTypes_.AUDIO.activePlaylistLoader.media());n&&(t.currentSource().keySystems=n,t.eme.initializeMediaKeys&&t.eme.initializeMediaKeys())}}}function gd(){if(!window.localStorage)return null;var e=window.localStorage.getItem(pd);if(!e)return null;try{return JSON.parse(e)}catch(e){return null}}dd.supportsNativeHls=function(){var t=d.createElement("video");if(!go.getTech("Html5").isSupported())return!1;return["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"].some(function(e){return/maybe|probably/i.test(t.canPlayType(e))})}(),dd.supportsNativeDash=!!go.getTech("Html5").isSupported()&&/maybe|probably/i.test(d.createElement("video").canPlayType("application/dash+xml")),dd.supportsTypeNatively=function(e){return"hls"===e?dd.supportsNativeHls:"dash"===e&&dd.supportsNativeDash},dd.isSupported=function(){return go.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};var vd=go.getComponent("Component"),yd=(Ul(_d,vd),Fl(_d,[{key:"setOptions_",value:function(){var t=this;if(this.options_.withCredentials=this.options_.withCredentials||!1,this.options_.handleManifestRedirects=this.options_.handleManifestRedirects||!1,this.options_.limitRenditionByPlayerDimensions=!1!==this.options_.limitRenditionByPlayerDimensions,this.options_.smoothQualityChange=this.options_.smoothQualityChange||!1,this.options_.useBandwidthFromLocalStorage=void 0!==this.source_.useBandwidthFromLocalStorage?this.source_.useBandwidthFromLocalStorage:this.options_.useBandwidthFromLocalStorage||!1,this.options_.customTagParsers=this.options_.customTagParsers||[],this.options_.customTagMappers=this.options_.customTagMappers||[],this.options_.cacheEncryptionKeys=this.options_.cacheEncryptionKeys||!1,"number"!=typeof this.options_.blacklistDuration&&(this.options_.blacklistDuration=300),"number"!=typeof this.options_.bandwidth&&this.options_.useBandwidthFromLocalStorage){var e=gd();e&&e.bandwidth&&(this.options_.bandwidth=e.bandwidth,this.tech_.trigger({type:"usage",name:"hls-bandwidth-from-local-storage"})),e&&e.throughput&&(this.options_.throughput=e.throughput,this.tech_.trigger({type:"usage",name:"hls-throughput-from-local-storage"}))}"number"!=typeof this.options_.bandwidth&&(this.options_.bandwidth=Pc.INITIAL_BANDWIDTH),this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&this.options_.bandwidth===Pc.INITIAL_BANDWIDTH,["withCredentials","limitRenditionByPlayerDimensions","bandwidth","smoothQualityChange","customTagParsers","customTagMappers","handleManifestRedirects","cacheEncryptionKeys"].forEach(function(e){void 0!==t.source_[e]&&(t.options_[e]=t.source_[e])}),this.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions}},{key:"src",value:function(e,t){var n=this;e&&(this.setOptions_(),this.options_.url=this.source_.src,this.options_.tech=this.tech_,this.options_.externHls=dd,this.options_.sourceType=hd(t),this.options_.seekTo=function(e){n.tech_.setCurrentTime(e),n.setCurrentTime(e)},this.masterPlaylistController_=new nd(this.options_),this.playbackWatcher_=new od(go.mergeOptions(this.options_,{seekable:function(){return n.seekable()},media:function(){return n.masterPlaylistController_.media()}})),this.masterPlaylistController_.on("error",function(){go.players[n.tech_.options_.playerId].error(n.masterPlaylistController_.error)}),this.masterPlaylistController_.selectPlaylist=this.selectPlaylist?this.selectPlaylist.bind(this):dd.STANDARD_PLAYLIST_SELECTOR.bind(this),this.masterPlaylistController_.selectInitialPlaylist=dd.INITIAL_PLAYLIST_SELECTOR.bind(this),this.playlists=this.masterPlaylistController_.masterPlaylistLoader_,this.mediaSource=this.masterPlaylistController_.mediaSource,Object.defineProperties(this,{selectPlaylist:{get:function(){return this.masterPlaylistController_.selectPlaylist},set:function(e){this.masterPlaylistController_.selectPlaylist=e.bind(this)}},throughput:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.throughput.rate},set:function(e){this.masterPlaylistController_.mainSegmentLoader_.throughput.rate=e,this.masterPlaylistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.bandwidth},set:function(e){this.masterPlaylistController_.mainSegmentLoader_.bandwidth=e,this.masterPlaylistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get:function(){var e=1/(this.bandwidth||1),t=void 0;return t=0<this.throughput?1/this.throughput:0,Math.floor(1/(e+t))},set:function(){go.log.error('The "systemBandwidth" property is read-only')}}}),this.options_.bandwidth&&(this.bandwidth=this.options_.bandwidth),this.options_.throughput&&(this.throughput=this.options_.throughput),Object.defineProperties(this.stats,{bandwidth:{get:function(){return n.bandwidth||0},enumerable:!0},mediaRequests:{get:function(){return n.masterPlaylistController_.mediaRequests_()||0},enumerable:!0},mediaRequestsAborted:{get:function(){return n.masterPlaylistController_.mediaRequestsAborted_()||0},enumerable:!0},mediaRequestsTimedout:{get:function(){return n.masterPlaylistController_.mediaRequestsTimedout_()||0},enumerable:!0},mediaRequestsErrored:{get:function(){return n.masterPlaylistController_.mediaRequestsErrored_()||0},enumerable:!0},mediaTransferDuration:{get:function(){return n.masterPlaylistController_.mediaTransferDuration_()||0},enumerable:!0},mediaBytesTransferred:{get:function(){return n.masterPlaylistController_.mediaBytesTransferred_()||0},enumerable:!0},mediaSecondsLoaded:{get:function(){return n.masterPlaylistController_.mediaSecondsLoaded_()||0},enumerable:!0},buffered:{get:function(){return wu(n.tech_.buffered())},enumerable:!0},currentTime:{get:function(){return n.tech_.currentTime()},enumerable:!0},currentSource:{get:function(){return n.tech_.currentSource_},enumerable:!0},currentTech:{get:function(){return n.tech_.name_},enumerable:!0},duration:{get:function(){return n.tech_.duration()},enumerable:!0},master:{get:function(){return n.playlists.master},enumerable:!0},playerDimensions:{get:function(){return n.tech_.currentDimensions()},enumerable:!0},seekable:{get:function(){return wu(n.tech_.seekable())},enumerable:!0},timestamp:{get:function(){return Date.now()},enumerable:!0},videoPlaybackQuality:{get:function(){return n.tech_.getVideoPlaybackQuality()},enumerable:!0}}),this.tech_.one("canplay",this.masterPlaylistController_.setupFirstPlay.bind(this.masterPlaylistController_)),this.tech_.on("bandwidthupdate",function(){n.options_.useBandwidthFromLocalStorage&&function(e){if(window.localStorage){var t=gd();t=t?go.mergeOptions(t,e):e;try{window.localStorage.setItem(pd,JSON.stringify(t))}catch(e){return}}}({bandwidth:n.bandwidth,throughput:Math.round(n.throughput)})}),this.masterPlaylistController_.on("selectedinitialmedia",function(){!function(n){var e=n.playlists;n.representations=function(){return e.master.playlists.filter(function(e){return!ou(e)}).map(function(e,t){return new id(n,e,e.uri)})}}(n),md(n)}),this.on(this.masterPlaylistController_,"progress",function(){this.tech_.trigger("progress")}),this.tech_.ready(function(){return n.setupQualityLevels_()}),this.tech_.el()&&this.tech_.src(go.URL.createObjectURL(this.masterPlaylistController_.mediaSource)))}},{key:"setupQualityLevels_",value:function(){var e=this,t=go.players[this.tech_.options_.playerId];t&&t.qualityLevels&&(this.qualityLevels_=t.qualityLevels(),this.masterPlaylistController_.on("selectedinitialmedia",function(){!function(t,e){e.representations().forEach(function(e){t.addQualityLevel(e)}),fd(t,e.playlists)}(e.qualityLevels_,e)}),this.playlists.on("mediachange",function(){fd(e.qualityLevels_,e.playlists)}))}},{key:"play",value:function(){this.masterPlaylistController_.play()}},{key:"setCurrentTime",value:function(e){this.masterPlaylistController_.setCurrentTime(e)}},{key:"duration",value:function(){return this.masterPlaylistController_.duration()}},{key:"seekable",value:function(){return this.masterPlaylistController_.seekable()}},{key:"dispose",value:function(){this.playbackWatcher_&&this.playbackWatcher_.dispose(),this.masterPlaylistController_&&this.masterPlaylistController_.dispose(),this.qualityLevels_&&this.qualityLevels_.dispose(),this.player_&&(delete this.player_.vhs,delete this.player_.dash,delete this.player_.hls),this.tech_&&this.tech_.hls&&delete this.tech_.hls,function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,n,r)}if("value"in i)return i.value;var o=i.get;return void 0!==o?o.call(r):void 0}(_d.prototype.__proto__||Object.getPrototypeOf(_d.prototype),"dispose",this).call(this)}},{key:"convertToProgramTime",value:function(e,t){return yu({playlist:this.masterPlaylistController_.media(),time:e,callback:t})}},{key:"seekToProgramTime",value:function(e,t,n,r){var i=!(2<arguments.length&&void 0!==n)||n,a=3<arguments.length&&void 0!==r?r:2;return _u({programTime:e,playlist:this.masterPlaylistController_.media(),retryCount:a,pauseAfterSeek:i,seekTo:this.options_.seekTo,tech:this.options_.tech,callback:t})}}]),_d);function _d(e,t,n){Bl(this,_d);var r=Hl(this,(_d.__proto__||Object.getPrototypeOf(_d)).call(this,t,n.hls));if(t.options_&&t.options_.playerId){var i=go(t.options_.playerId);i.hasOwnProperty("hls")||Object.defineProperty(i,"hls",{get:function(){return go.log.warn("player.hls is deprecated. Use player.tech().hls instead."),t.trigger({type:"usage",name:"hls-player-access"}),r},configurable:!0}),i.vhs=r,(i.dash=r).player_=i}if(r.tech_=t,r.source_=e,r.stats={},r.setOptions_(),r.options_.overrideNative&&t.overrideNativeAudioTracks&&t.overrideNativeVideoTracks)t.overrideNativeAudioTracks(!0),t.overrideNativeVideoTracks(!0);else if(r.options_.overrideNative&&(t.featuresNativeVideoTracks||t.featuresNativeAudioTracks))throw new Error("Overriding native HLS requires emulated tracks. See https://git.io/vMpjB");return r.on(d,["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],function(e){var t=d.fullscreenElement||d.webkitFullscreenElement||d.mozFullScreenElement||d.msFullscreenElement;t&&t.contains(r.tech_.el())&&r.masterPlaylistController_.smoothQualityChange_()}),r.on(r.tech_,"seeking",function(){0===this.tech_.currentTime()&&this.tech_.player_.loop()&&this.setCurrentTime(0)}),r.on(r.tech_,"error",function(){this.masterPlaylistController_&&this.masterPlaylistController_.pauseLoading()}),r.on(r.tech_,"play",r.play),r}var bd={name:"videojs-http-streaming",VERSION:"1.10.6",canHandleSource:function(e,t){var n=go.mergeOptions(go.options,1<arguments.length&&void 0!==t?t:{});return bd.canPlayType(e.type,n)},handleSource:function(e,t,n){var r=go.mergeOptions(go.options,2<arguments.length&&void 0!==n?n:{});return t.hls=new yd(e,t,r),t.hls.xhr=cu(),t.hls.src(e.src,e.type),t.hls},canPlayType:function(e,t){var n=go.mergeOptions(go.options,1<arguments.length&&void 0!==t?t:{}).hls.overrideNative,r=hd(e);return r&&(!dd.supportsTypeNatively(r)||n)?"maybe":""}};return void 0!==go.MediaSource&&void 0!==go.URL||(go.MediaSource=lc,go.URL=uc),lc.supportsNativeMediaSources()&&go.getTech("Html5").registerSourceHandler(bd,0),go.HlsHandler=yd,go.HlsSourceHandler=bd,go.Hls=dd,go.use||go.registerComponent("Hls",dd),go.options.hls=go.options.hls||{},go.registerPlugin?go.registerPlugin("reloadSourceOnError",ud):go.plugin("reloadSourceOnError",ud),go}),function(e,t){if("function"==typeof define&&define.amd)define(["video.js"],t);else if("undefined"!=typeof exports)t(require("video.js"));else{t(e.videojs),e.videojsMarkersPlugin={}}}(this,function(e){"use strict";var t,y=(t=e)&&t.__esModule?t:{default:t};var _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b={markerStyle:{width:"7px","border-radius":"30%","background-color":"red"},markerTip:{display:!0,text:function(e){return"Break: "+e.text},time:function(e){return e.time}},breakOverlay:{display:!1,displayTime:3,text:function(e){return"Break overlay: "+e.overlayText},style:{width:"100%",height:"20%","background-color":"rgba(0,0,0,0.7)",color:"white","font-size":"17px"}},onMarkerClick:function(){},onMarkerReached:function(){},markers:[]};function E(e){var t,n={top:0,bottom:0,left:0,width:0,height:0,right:0};try{t=e.getBoundingClientRect()}catch(e){t=n}return t}y.default.registerPlugin("markers",function(a){if(!y.default.mergeOptions){var o=function(e){return!!e&&"object"===(void 0===e?"undefined":_(e))&&"[object Object]"===toString.call(e)&&e.constructor===Object};y.default.mergeOptions=function r(e,t){var i={};return[e,t].forEach(function(n){n&&Object.keys(n).forEach(function(e){var t=n[e];o(t)?(o(i[e])||(i[e]={}),i[e]=r(i[e],t)):i[e]=t})}),i}}y.default.dom.createEl||(y.default.dom.createEl=function(e,t,n){var r=y.default.Player.prototype.dom.createEl(e,t);return n&&Object.keys(n).forEach(function(e){r.setAttribute(e,n[e])}),r});var s=y.default.mergeOptions(b,a),i={},l=[],u=-1,c=this,d=null,h=null,f=-1;function t(){l.sort(function(e,t){return s.markerTip.time(e)-s.markerTip.time(t)})}function n(e){e.forEach(function(e){e.key=function(){var n=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=(n+16*Math.random())%16|0;return n=Math.floor(n/16),("x"==e?t:3&t|8).toString(16)})}(),c.el().querySelector(".vjs-progress-holder").appendChild(function(r){var e=y.default.dom.createEl("div",{},{"data-marker-key":r.key,"data-marker-time":s.markerTip.time(r)});m(r,e),e.addEventListener("click",function(e){var t=!1;if("function"==typeof s.onMarkerClick&&(t=!1===s.onMarkerClick(r)),!t){var n=this.getAttribute("data-marker-key");c.currentTime(s.markerTip.time(i[n]))}}),s.markerTip.display&&function(r){r.addEventListener("mouseover",function(){var e=i[r.getAttribute("data-marker-key")];if(d){s.markerTip.html?d.querySelector(".vjs-tip-inner").innerHTML=s.markerTip.html(e):d.querySelector(".vjs-tip-inner").innerText=s.markerTip.text(e),d.style.left=p(e)+"%";var t=E(d),n=E(r);d.style.marginLeft=-parseFloat(t.width/2)+parseFloat(n.width/4)+"px",d.style.visibility="visible"}}),r.addEventListener("mouseout",function(){d&&(d.style.visibility="hidden")})}(e);return e}(e)),i[e.key]=e,l.push(e)}),t()}function p(e){return s.markerTip.time(e)/c.duration()*100}function m(e,t){t.className="vjs-marker "+(e.class||""),Object.keys(s.markerStyle).forEach(function(e){t.style[e]=s.markerStyle[e]});var n=e.time/c.duration();if((n<0||1<n)&&(t.style.display="none"),t.style.left=p(e)+"%",e.duration)t.style.width=e.duration/c.duration()*100+"%",t.style.marginLeft="0px";else{var r=E(t);t.style.marginLeft=r.width/2+"px"}}function r(e){h&&(f=-1,h.style.visibility="hidden"),u=-1;var r=[];e.forEach(function(e){var t=l[e];if(t){delete i[t.key],r.push(e);var n=c.el().querySelector(".vjs-marker[data-marker-key='"+t.key+"']");n&&n.parentNode.removeChild(n)}}),r.reverse(),r.forEach(function(e){l.splice(e,1)}),t()}function e(){if(s.breakOverlay.display&&!(u<0)){var e=c.currentTime(),t=l[u],n=s.markerTip.time(t);n<=e&&e<=n+s.breakOverlay.displayTime?(f!==u&&(f=u,h&&(h.querySelector(".vjs-break-overlay-text").innerHTML=s.breakOverlay.text(t))),h&&(h.style.visibility="visible")):(f=-1,h&&(h.style.visibility="hidden"))}}function g(){!function(){if(!l.length)return;function e(e){return e<l.length-1?s.markerTip.time(l[e+1]):c.duration()}var t=c.currentTime(),n=-1;if(-1!==u){var r=e(u);if(t>=s.markerTip.time(l[u])&&t<r)return;if(u===l.length-1&&t===c.duration())return}if(t<s.markerTip.time(l[0]))n=-1;else for(var i=0;i<l.length;i++)if(r=e(i),t>=s.markerTip.time(l[i])&&t<r){n=i;break}n!==u&&(-1!==n&&a.onMarkerReached&&a.onMarkerReached(l[n],n),u=n)}(),e(),a.onTimeUpdateAfterMarkerUpdate&&a.onTimeUpdateAfterMarkerUpdate()}function v(){s.markerTip.display&&(d=y.default.dom.createEl("div",{className:"vjs-tip",innerHTML:"<div class='vjs-tip-arrow'></div><div class='vjs-tip-inner'></div>"}),c.el().querySelector(".vjs-progress-holder").appendChild(d)),c.markers.removeAll(),n(s.markers),s.breakOverlay.display&&(h=y.default.dom.createEl("div",{className:"vjs-break-overlay",innerHTML:"<div class='vjs-break-overlay-text'></div>"}),Object.keys(s.breakOverlay.style).forEach(function(e){h&&(h.style[e]=s.breakOverlay.style[e])}),c.el().appendChild(h),f=-1),g(),c.on("timeupdate",g),c.off("loadedmetadata")}c.on("loadedmetadata",function(){v()}),c.markers={getMarkers:function(){return l},next:function(){for(var e=c.currentTime(),t=0;t<l.length;t++){var n=s.markerTip.time(l[t]);if(e<n){c.currentTime(n);break}}},prev:function(){for(var e=c.currentTime(),t=l.length-1;0<=t;t--){var n=s.markerTip.time(l[t]);if(n+.5<e)return void c.currentTime(n)}},add:function(e){n(e)},remove:function(e){r(e)},removeAll:function(){for(var e=[],t=0;t<l.length;t++)e.push(t);r(e)},updateTime:function(e){!function(r){l.forEach(function(e){var t=c.el().querySelector(".vjs-marker[data-marker-key='"+e.key+"']"),n=s.markerTip.time(e);!r&&t.getAttribute("data-marker-time")===n||(m(e,t),t.setAttribute("data-marker-time",n))}),t()}(e)},reset:function(e){c.markers.removeAll(),n(e)},destroy:function(){c.markers.removeAll(),h&&h.remove(),d&&d.remove(),c.off("timeupdate",e),delete c.markers}}})}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("global/document"),require("video.js"),require("global/window")):"function"==typeof define&&define.amd?define(["exports","global/document","video.js","global/window"],t):t(e.videojsContribEme={},e.document,e.videojs,e.window)}(this,function(e,n,c,d){"use strict";function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}n=n&&n.hasOwnProperty("default")?n.default:n,c=c&&c.hasOwnProperty("default")?c.default:c,d=d&&d.hasOwnProperty("default")?d.default:d;function a(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(var n=new DataView(e),r=new DataView(t),i=0;i<n.byteLength;i++)if(n.getUint8(i)!==r.getUint8(i))return!1;return!0}function o(e){return e instanceof Uint8Array||e instanceof Uint16Array?e.buffer:e}function u(){var t=c.mergeOptions.apply(c,arguments);return Object.keys(t).forEach(function(e){null===t[e]&&delete t[e]}),t}var h=c.xhr.httpHandler;h=h||function(i,a){return function(e,t,n){if(e)i(e);else{if(400<=t.statusCode&&t.statusCode<=599){var r=n;return a&&(r=String.fromCharCode.apply(null,new Uint8Array(n))),void i({cause:r})}i(null,n)}}};function l(e,t,n,r){var i=function(e){var t=String.fromCharCode.apply(null,new Uint16Array(e)),n=(new d.DOMParser).parseFromString(t,"application/xml"),r=n.getElementsByTagName("HttpHeaders")[0],i={};if(r)for(var a=r.getElementsByTagName("name"),o=r.getElementsByTagName("value"),s=0;s<a.length;s++)i[a[s].childNodes[0].nodeValue]=o[s].childNodes[0].nodeValue;var l,u=n.getElementsByTagName("Challenge")[0];return u&&(l=d.atob(u.childNodes[0].nodeValue)),{headers:i,message:l}}(t),a=i.message,o=u(i.headers,n.emeHeaders,e.licenseHeaders);c.xhr({uri:e.url,method:"post",headers:o,body:a,responseType:"arraybuffer"},h(r,!0))}function t(e){var r;return Object.keys(e).forEach(function(t){var n=function(e){if(e.supportedConfigurations)return e.supportedConfigurations;var t={},n=e.audioContentType,r=e.audioRobustness,i=e.videoContentType,a=e.videoRobustness,o=e.persistentState;return(n||r)&&(t.audioCapabilities=[s({},n?{contentType:n}:{},r?{robustness:r}:{})]),(i||a)&&(t.videoCapabilities=[s({},i?{contentType:i}:{},a?{robustness:a}:{})]),o&&(t.persistentState=o),[t]}(e[t]);r=r?r.catch(function(e){return d.navigator.requestMediaKeySystemAccess(t,n)}):d.navigator.requestMediaKeySystemAccess(t,n)}),r}function f(e){var t=e.mediaKeys,r=e.initDataType,i=e.initData,a=e.options,o=e.getLicense,s=e.removeSession,l=e.eventBus,u=t.createSession();return l.trigger("keysessioncreated"),new Promise(function(t,n){u.addEventListener("message",function(e){"license-request"!==e.messageType&&"license-renewal"!==e.messageType||o(a,e.message).then(function(e){t(u.update(e))}).catch(function(e){n(e)})},!1),u.addEventListener("keystatuseschange",function(n){var r=!1;u.keyStatuses.forEach(function(e,t){switch(l.trigger({keyId:t,status:e,target:u,type:"keystatuschange"}),e){case"expired":r=!0;break;case"internal-error":c.log.warn('Key status reported as "internal-error." Leaving the session open since we don\'t have enough details to know if this error is fatal.',n)}}),r&&u.close().then(function(){s(i),f(e)})},!1),u.generateRequest(r,i).catch(function(){n("Unable to create or initialize key session")})})}function p(e,t){if("string"==typeof t&&(t={url:t}),!t.url&&!t.getLicense)throw new Error("Neither URL nor getLicense function provided to get license");return t.url&&!t.getLicense&&(t.getLicense="com.microsoft.playready"===e?function(r){return function(e,t,n){l(r,t,e,n)}}(t):function(i){return function(e,t,n){var r=u({"Content-type":"application/octet-stream"},e.emeHeaders,i.licenseHeaders);c.xhr({uri:i.url,method:"POST",responseType:"arraybuffer",body:t,headers:r},h(n,!0))}}(t)),t}function m(e){var i,t,a=e.video,n=e.initDataType,r=e.initData,o=e.keySystemAccess,s=e.options,l=e.removeSession,u=e.eventBus,c=Promise.resolve();return void 0===a.mediaKeysObject&&(a.mediaKeysObject=null,a.pendingSessionData=[],c=new Promise(function(n,r){a.keySystem=o.keySystem,(t=p(o.keySystem,s.keySystems[o.keySystem])).getCertificate?t.getCertificate(s,function(e,t){e?r(e):(i=t,n())}):n(o)}).then(function(){return o.createMediaKeys()}).then(function(e){return function(e){var t=e.video,n=e.certificate,r=e.createdMediaKeys;t.mediaKeysObject=r;var i=[];n&&i.push(r.setServerCertificate(n));for(var a=0;a<t.pendingSessionData.length;a++){var o=t.pendingSessionData[a];i.push(f({mediaKeys:t.mediaKeysObject,initDataType:o.initDataType,initData:o.initData,options:o.options,getLicense:o.getLicense,removeSession:o.removeSession,eventBus:o.eventBus}))}return t.pendingSessionData=[],i.push(t.setMediaKeys(r)),Promise.all(i)}({video:a,certificate:i,createdMediaKeys:e})}).catch(function(e){return e?Promise.reject(e):Promise.reject("Failed to create and initialize a MediaKeys object")})),c.then(function(){var e=p(a.keySystem,s.keySystems[a.keySystem]).getLicense;return function(e){var t=e.video,n=e.initDataType,r=e.initData,i=e.options,a=e.getLicense,o=e.removeSession,s=e.eventBus;return t.mediaKeysObject?f({mediaKeys:t.mediaKeysObject,initDataType:n,initData:r,options:i,getLicense:a,removeSession:o,eventBus:s}):(t.pendingSessionData.push({initDataType:n,initData:r,options:i,getLicense:a,removeSession:o,eventBus:s}),Promise.resolve())}({video:a,initDataType:n,initData:r,options:s,getLicense:a.keySystem?function(i,a){return function(e,t){return new Promise(function(n,r){i(e,t,function(e,t){a&&a.trigger("licenserequestattempted"),e?r(e):n(t)})})}}(e,u):null,removeSession:l,eventBus:u})})}function g(e){var t=e.initData,n=e.id,r=e.cert;"string"==typeof n&&(n=function(e){for(var t=new ArrayBuffer(2*e.length),n=new Uint16Array(t),r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n}(n));var i=0,a=new ArrayBuffer(t.byteLength+4+n.byteLength+4+r.byteLength),o=new DataView(a);new Uint8Array(a,i,t.byteLength).set(t),i+=t.byteLength,o.setUint32(i,n.byteLength,!0),i+=4;var s=new Uint16Array(a,i,n.length);return s.set(n),i+=s.byteLength,o.setUint32(i,r.byteLength,!0),i+=4,new Uint8Array(a,i,r.byteLength).set(r),new Uint8Array(a,0,a.byteLength)}function v(e,t){return function(e){var t=n.createElement("a");return t.href=e,t.hostname}(function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))}(t))}function r(e){var t=e.video,n=e.initData,i=e.options,r=e.eventBus,a=i.keySystems[x],o=a.getCertificate||function(r){return function(e,n){var t=u(e.emeHeaders,r.certificateHeaders);c.xhr({uri:r.certificateUri,responseType:"arraybuffer",headers:t},h(function(e,t){e?n(e):n(null,new Uint8Array(t))}))}}(a),s=a.getContentId||v,l=a.getLicense||function(a){return function(e,t,n,r){var i=u({"Content-type":"application/octet-stream"},e.emeHeaders,a.licenseHeaders);c.xhr({uri:a.licenseUri,method:"POST",responseType:"arraybuffer",body:n,headers:i},h(r,!0))}}(a);return new Promise(function(n,r){o(i,function(e,t){e?r(e):n(t)})}).then(function(e){return function(e){var t=e.video,i=e.contentId,a=e.initData,o=e.cert,s=e.options,l=e.getLicense,u=e.eventBus;return new Promise(function(e,n){if(!t.webkitKeys)try{t.webkitSetMediaKeys(new d.WebKitMediaKeys(x))}catch(e){return void n("Could not create MediaKeys")}var r;try{r=t.webkitKeys.createSession("video/mp4",g({id:i,initData:a,cert:o}))}catch(e){return void n("Could not create key session")}u.trigger("keysessioncreated"),r.contentId=i,r.addEventListener("webkitkeymessage",function(e){l(s,i,e.message,function(e,t){u&&u.trigger("licenserequestattempted"),e?n(e):r.update(new Uint8Array(t))})}),r.addEventListener("webkitkeyadded",function(){e()}),r.addEventListener("webkitkeyerror",function(){var e=r.error;n("KeySession error: code "+e.code+", systemCode "+e.systemCode)})})}({video:t,cert:e,initData:n,getLicense:l,options:i,contentId:s(i,n),eventBus:r})})}function y(e,t,n,r){var i=e.msKeys.createSession("video/mp4",t);if(!i)throw new Error("Could not create key session.");r.trigger("keysessioncreated"),i.addEventListener("mskeymessage",function(e){!function(e,n,t,r){var i=e.keySystems[M];if("function"!=typeof i.getKey){"string"==typeof i?i={url:i}:"boolean"==typeof i&&(i={}),i.url||(i.url=t.destinationURL);var a=function(e,t){r&&r.trigger("licenserequestattempted"),e?r.trigger({message:"Unable to request key from url: "+i.url,target:n,type:"mskeyerror"}):n.update(new Uint8Array(t))};i.getLicense?i.getLicense(e,t.message.buffer,a):l(i,t.message.buffer,e,a)}else i.getKey(e,t.destinationURL,t.message.buffer,function(e,t){e?r.trigger({message:"Unable to get key: "+e,target:n,type:"mskeyerror"}):n.update(t)})}(n,i,e,r)}),i.addEventListener("mskeyerror",function(e){r.trigger({message:"Unexpected key error from key session with code: "+i.error.code+" and systemCode: "+i.error.systemCode,target:i,type:"mskeyerror"})}),i.addEventListener("mskeyadded",function(){r.trigger({target:i,type:"mskeyadded"})})}function _(e,t){for(var n=0;n<e.length;n++)if(e[n].initData){var r=o(e[n].initData),i=o(t);if(a(r,i))return!0}return!1}function b(e,t){for(var n=0;n<e.length;n++)if(e[n].initData===t)return void e.splice(n,1)}function E(n,r,i,a){if(!r||!r.keySystems)return Promise.resolve();var o=n.initData;return t(r.keySystems).then(function(e){var t=e.keySystem;return r.keySystems[t]&&r.keySystems[t].pssh&&(o=r.keySystems[t].pssh),_(i,o)||!o?Promise.resolve():(i.push({initData:o}),m({video:n.target,initDataType:n.initDataType,initData:o,keySystemAccess:e,options:r,removeSession:b.bind(null,i),eventBus:a}))})}function T(e,t,n){return t.keySystems&&t.keySystems[x]&&e.initData?r({video:e.target,initData:e.initData,options:t,eventBus:n}):Promise.resolve()}function A(e,t,n,r){if(t.keySystems&&t.keySystems[M]&&!n.reduce(function(e,t){return e||t.playready},!1)){var i=e.initData;t.keySystems[M]&&t.keySystems[M].pssh&&(i=t.keySystems[M].pssh),i&&(n.push({playready:!0,initData:i}),function(e){var t=e.video,n=e.initData,r=e.options,i=e.eventBus;t.msKeys&&delete t.msKeys;try{t.msSetMediaKeys(new d.MSMediaKeys(M))}catch(e){throw new Error("Unable to create media keys for PlayReady key system. Error: "+e.message)}y(t,n,r,i)}({video:e.target,initData:i,options:t,eventBus:r}))}}function w(e){return c.mergeOptions(e.currentSource(),e.eme.options)}function S(e){var t=e.src();t!==e.eme.activeSrc&&(e.eme.activeSrc=t,e.eme.sessions=[])}function i(n){return function(e){var t={code:5};"string"==typeof e?t.message=e:e&&(e.message&&(t.message=e.message),e.cause&&(e.cause.length||e.cause.byteLength)&&(t.cause=e.cause)),n.error(t)}}function C(o){void 0===o&&(o={});var s=this,l=i(s);s.ready(function(){return function(r,t){if("video"===r.$(".vjs-tech").tagName.toLowerCase())if(S(r),d.WebKitMediaKeys){var i=function(e){S(r),T(e,w(r),r.tech_).catch(t)};r.tech_.el_.addEventListener("webkitneedkey",function(e){var t=w(r).firstWebkitneedkeyTimeout||1e3,n=r.src();r.eme.webkitneedkey_=r.eme.webkitneedkey_||{},r.eme.webkitneedkey_.src!==n&&(r.eme.webkitneedkey_={handledFirstEvent:!1,src:n}),r.eme.webkitneedkey_.handledFirstEvent?i(e):(r.clearTimeout(r.eme.webkitneedkey_.timeout),r.eme.webkitneedkey_.timeout=r.setTimeout(function(){r.eme.webkitneedkey_.handledFirstEvent=!0,r.eme.webkitneedkey_.timeout=null,i(e)},t))})}else d.MediaKeys?r.tech_.el_.addEventListener("encrypted",function(e){S(r),E(e,w(r),r.eme.sessions,r.tech_).catch(t)}):d.MSMediaKeys&&(r.tech_.el_.addEventListener("msneedkey",function(e){S(r);try{A(e,w(r),r.eme.sessions,r.tech_)}catch(e){t(e)}}),r.tech_.on("mskeyerror",t),r.on("dispose",function(){r.tech_.off("mskeyerror",t)}))}(s,l)}),s.eme={initializeMediaKeys:function(e,n,r){void 0===e&&(e={}),void 0===n&&(n=function(){}),void 0===r&&(r=!1);var t=c.mergeOptions(s.currentSource(),o,e),i={initDataType:"cenc",initData:null,target:s.tech_.el_};if(S(s),s.tech_.el_.setMediaKeys)E(i,t,s.eme.sessions,s.tech_).then(function(){return n()}).catch(function(e){n(e),r||l(e)});else if(s.tech_.el_.msSetMediaKeys){var a=function e(t){s.tech_.off("mskeyadded",e),s.tech_.off("mskeyerror",e),"mskeyerror"===t.type?(n(t.target.error),r||l(t.message)):n()};s.tech_.one("mskeyadded",a),s.tech_.one("mskeyerror",a);try{A(i,t,s.eme.sessions,s.tech_)}catch(e){s.tech_.off("mskeyadded",a),s.tech_.off("mskeyerror",a),n(e),r||l(e)}}},options:o}}var x="com.apple.fps.1_0",M="com.microsoft.playready";(c.registerPlugin||c.plugin)("eme",C),e.hasSession=_,e.removeSession=b,e.handleEncryptedEvent=E,e.handleWebKitNeedKeyEvent=T,e.handleMsNeedKeyEvent=A,e.getOptions=w,e.setupSessions=S,e.emeErrorHandler=i,e.default=C,Object.defineProperty(e,"__esModule",{value:!0})}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("video.js"),require("global/window"),require("global/document")):"function"==typeof define&&define.amd?define(["video.js","global/window","global/document"],t):e.videojsDash=t(e.videojs,e.window,e.document)}(this,function(c,l,n){"use strict";c=c&&c.hasOwnProperty("default")?c.default:c,l=l&&l.hasOwnProperty("default")?l.default:l,n=n&&n.hasOwnProperty("default")?n.default:n;var e,t,r=(function(e,t){var n;window,n=function(){return(r={},i.m=n={"./externals/base64.js":function(e,t,n){var o,l,r,i={encode:function(e){for(var t=[],n=0;n<e.length;++n){var r=e.charCodeAt(n);r<128?t.push(r):(r<2048?t.push(192|r>>6):(r<65536?t.push(224|r>>12):(t.push(240|r>>18),t.push(128|63&r>>12)),t.push(128|63&r>>6)),t.push(128|63&r))}return t},decode:function(e){for(var t=[],n=0;n<e.length;){var r=e[n++];r<128||(r<224?r=(31&r)<<6:(r<240?r=(15&r)<<12:(r=(7&r)<<18,r|=(63&e[n++])<<12),r|=(63&e[n++])<<6),r|=63&e[n++]),t.push(String.fromCharCode(r))}return t.join("")}},u={};function c(e){for(var t=0,n=[],r=0|e.length/3;0<r--;){var i=(e[t]<<16)+(e[t+1]<<8)+e[t+2];t+=3,n.push(o.charAt(63&i>>18)),n.push(o.charAt(63&i>>12)),n.push(o.charAt(63&i>>6)),n.push(o.charAt(63&i))}if(2==e.length-t){i=(e[t]<<16)+(e[t+1]<<8);n.push(o.charAt(63&i>>18)),n.push(o.charAt(63&i>>12)),n.push(o.charAt(63&i>>6)),n.push("=")}else if(1==e.length-t){i=e[t]<<16;n.push(o.charAt(63&i>>18)),n.push(o.charAt(63&i>>12)),n.push("==")}return n.join("")}function d(e){for(var t=0,n=[],r=0|e.length/4;0<r--;){var i=(l[e.charCodeAt(t)]<<18)+(l[e.charCodeAt(t+1)]<<12)+(l[e.charCodeAt(t+2)]<<6)+l[e.charCodeAt(t+3)];n.push(255&i>>16),n.push(255&i>>8),n.push(255&i),t+=4}return n&&("="==e.charAt(t-2)?(n.pop(),n.pop()):"="==e.charAt(t-1)&&n.pop()),n}o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l=function(){for(var e=[],t=0;t<o.length;++t)e[o.charCodeAt(t)]=t;return e["=".charCodeAt(0)]=0,e}(),r={encode:function(e){for(var t=[],n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t},decode:function(e){for(var t=0;t<s.length;++t)a[t]=String.fromCharCode(a[t]);return a.join("")}},u.decodeArray=function(e){var t=d(e);return new Uint8Array(t)},u.encodeASCII=function(e){var t=r.encode(e);return c(t)},u.decodeASCII=function(e){var t=d(e);return r.decode(t)},u.encode=function(e){var t=i.encode(e);return c(t)},u.decode=function(e){var t=d(e);return i.decode(t)},t.decode=u.decode,t.decodeArray=u.decodeArray,t.encode=u.encode,t.encodeASCII=u.encodeASCII},"./externals/cea608-parser.js":function(e,t,n){!function(e){function s(e){var t=e;return n.hasOwnProperty(e)&&(t=n[e]),String.fromCharCode(t)}function l(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].toString(16));return t}function o(e,t,n,r,i){this.foreground=e||"white",this.underline=t||!1,this.italics=n||!1,this.background=r||"black",this.flash=i||!1}var n={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},a={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},u={17:2,18:4,21:6,22:8,23:10,19:13,20:15},c={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},d={25:2,26:4,29:6,30:8,31:10,27:13,28:15},h=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],f={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(e){this.time=e},log:function(e,t){var n=this.verboseFilter[e];this.verboseLevel>=n&&console.log(this.time+" ["+e+"] "+t)}};o.prototype={reset:function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},setStyles:function(e){for(var t=["foreground","underline","italics","background","flash"],n=0;n<t.length;n++){var r=t[n];e.hasOwnProperty(r)&&(this[r]=e[r])}},isDefault:function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},equals:function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash},copy:function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash},toString:function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}};function t(e,t,n,r,i,a){this.uchar=e||" ",this.penState=new o(t,n,r,i,a)}t.prototype={reset:function(){this.uchar=" ",this.penState.reset()},setChar:function(e,t){this.uchar=e,this.penState.copy(t)},setPenState:function(e){this.penState.copy(e)},equals:function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)},copy:function(e){this.uchar=e.uchar,this.penState.copy(e.penState)},isEmpty:function(){return" "===this.uchar&&this.penState.isDefault()}};function r(){this.chars=[];for(var e=0;e<32;e++)this.chars.push(new t);this.pos=0,this.currPenState=new o}r.prototype={equals:function(e){for(var t=!0,n=0;n<32;n++)if(!this.chars[n].equals(e.chars[n])){t=!1;break}return t},copy:function(e){for(var t=0;t<32;t++)this.chars[t].copy(e.chars[t])},isEmpty:function(){for(var e=!0,t=0;t<32;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e},setCursor:function(e){this.pos!==e&&(this.pos=e),this.pos<0?(f.log("ERROR","Negative cursor position "+this.pos),this.pos=0):32<this.pos&&(f.log("ERROR","Too large cursor position "+this.pos),this.pos=32)},moveCursor:function(e){var t=this.pos+e;if(1<e)for(var n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)},backSpace:function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},insertChar:function(e){144<=e&&this.backSpace();var t=s(e);32<=this.pos?f.log("ERROR","Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))},clearFromPos:function(e){var t;for(t=e;t<32;t++)this.chars[t].reset()},clear:function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},clearToEndOfRow:function(){this.clearFromPos(this.pos)},getTextString:function(){for(var e=[],t=!0,n=0;n<32;n++){var r=this.chars[n].uchar;" "!==r&&(t=!1),e.push(r)}return t?"":e.join("")},setPenStyles:function(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}};function i(){this.rows=[];for(var e=0;e<15;e++)this.rows.push(new r);this.currRow=14,this.nrRollUpRows=null,this.reset()}i.prototype={reset:function(){for(var e=0;e<15;e++)this.rows[e].clear();this.currRow=14},equals:function(e){for(var t=!0,n=0;n<15;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t},copy:function(e){for(var t=0;t<15;t++)this.rows[t].copy(e.rows[t])},isEmpty:function(){for(var e=!0,t=0;t<15;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e},backSpace:function(){this.rows[this.currRow].backSpace()},clearToEndOfRow:function(){this.rows[this.currRow].clearToEndOfRow()},insertChar:function(e){this.rows[this.currRow].insertChar(e)},setPen:function(e){this.rows[this.currRow].setPenStyles(e)},moveCursor:function(e){this.rows[this.currRow].moveCursor(e)},setCursor:function(e){f.log("INFO","setCursor: "+e),this.rows[this.currRow].setCursor(e)},setPAC:function(e){f.log("INFO","pacData = "+JSON.stringify(e));var t=e.row-1;this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.currRow=t;var n=this.rows[this.currRow];if(null!==e.indent){var r=e.indent,i=Math.max(r-1,0);n.setCursor(e.indent),e.color=n.chars[i].penState.foreground}var a={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(a)},setBkgData:function(e){f.log("INFO","bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)},setRollUpRows:function(e){this.nrRollUpRows=e},rollUp:function(){if(null!==this.nrRollUpRows){f.log("TEXT",this.getDisplayText());var e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),f.log("INFO","Rolling up")}else f.log("DEBUG","roll_up but nrRollUpRows not set yet")},getDisplayText:function(e){e=e||!1;for(var t=[],n="",r=-1,i=0;i<15;i++){var a=this.rows[i].getTextString();a&&(r=i+1,e?t.push("Row "+r+': "'+a+'"'):t.push(a.trim()))}return 0<t.length&&(n=e?"["+t.join(" | ")+"]":t.join("\n")),n},getTextAndFormat:function(){return this.rows}};function p(e,t){this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new i,this.nonDisplayedMemory=new i,this.lastOutputScreen=new i,this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}p.prototype={modes:["MODE_ROLL-UP","MODE_POP-ON","MODE_PAINT-ON","MODE_TEXT"],reset:function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.lastCueEndTime=null},getHandler:function(){return this.outputFilter},setHandler:function(e){this.outputFilter=e},setPAC:function(e){this.writeScreen.setPAC(e)},setBkgData:function(e){this.writeScreen.setBkgData(e)},setMode:function(e){e!==this.mode&&(this.mode=e,f.log("INFO","MODE="+e),"MODE_POP-ON"==this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)},insertChars:function(e){for(var t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);var n=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";f.log("INFO",n+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(f.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},cc_RCL:function(){f.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},cc_BS:function(){f.log("INFO","BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},cc_AOF:function(){},cc_AON:function(){},cc_DER:function(){f.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},cc_RU:function(e){f.log("INFO","RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)},cc_FON:function(){f.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})},cc_RDC:function(){f.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},cc_TR:function(){f.log("INFO","TR"),this.setMode("MODE_TEXT")},cc_RTD:function(){f.log("INFO","RTD"),this.setMode("MODE_TEXT")},cc_EDM:function(){f.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate()},cc_CR:function(){f.log("CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate()},cc_ENM:function(){f.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},cc_EOC:function(){if(f.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,f.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate()},cc_TO:function(e){f.log("INFO","TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)},cc_MIDROW:function(e){var t={flash:!1};if(t.underline=e%2==1,t.italics=46<=e,t.italics)t.foreground="white";else{var n=Math.floor(e/2)-16;t.foreground=["white","green","blue","cyan","red","yellow","magenta"][n]}f.log("INFO","MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)},outputDataUpdate:function(){var e=f.time;null!==e&&this.outputFilter&&(this.outputFilter.updateData&&this.outputFilter.updateData(e,this.displayedMemory),null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.lastOutputScreen),this.cueStartTime=this.displayedMemory.isEmpty()?null:e):this.cueStartTime=e,this.lastOutputScreen.copy(this.displayedMemory))},cueSplitAtTime:function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}};function m(e,t,n){this.field=e||1,this.outputs=[t,n],this.channels=[new p(1,t),new p(2,n)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.bufferedData=[],this.startTime=null,this.lastTime=null,this.dataCounters={padding:0,char:0,cmd:0,other:0}}m.prototype={getHandler:function(e){return this.channels[e].getHandler()},setHandler:function(e,t){this.channels[e].setHandler(t)},addData:function(e,t){var n,r,i,a=!1;this.lastTime=e,f.setTime(e);for(var o=0;o<t.length;o+=2)if(r=127&t[o],i=127&t[o+1],16<=r&&r<=31&&r===this.lastCmdA&&i===this.lastCmdB)this.lastCmdA=null,this.lastCmdB=null,f.log("DEBUG","Repeated command ("+l([r,i])+") is dropped");else if(0!=r||0!=i){if(f.log("DATA","["+l([t[o],t[o+1]])+"] -> ("+l([r,i])+")"),!(n=(n=(n=(n=this.parseCmd(r,i))||this.parseMidrow(r,i))||this.parsePAC(r,i))||this.parseBackgroundAttributes(r,i)))if(a=this.parseChars(r,i))if(this.currChNr&&0<=this.currChNr)this.channels[this.currChNr-1].insertChars(a);else f.log("WARNING","No channel found yet. TEXT-MODE?");n?this.dataCounters.cmd+=2:a?this.dataCounters.char+=2:(this.dataCounters.other+=2,f.log("WARNING","Couldn't parse cleaned data "+l([r,i])+" orig: "+l([t[o],t[o+1]])))}else this.dataCounters.padding+=2},parseCmd:function(e,t){var n=null;if(!((20===e||21===e||28===e||29===e)&&32<=t&&t<=47)&&!((23===e||31===e)&&33<=t&&t<=35))return!1;n=20===e||21===e||23===e?1:2;var r=this.channels[n-1];return 20===e||21===e||28===e||29===e?32===t?r.cc_RCL():33===t?r.cc_BS():34===t?r.cc_AOF():35===t?r.cc_AON():36===t?r.cc_DER():37===t?r.cc_RU(2):38===t?r.cc_RU(3):39===t?r.cc_RU(4):40===t?r.cc_FON():41===t?r.cc_RDC():42===t?r.cc_TR():43===t?r.cc_RTD():44===t?r.cc_EDM():45===t?r.cc_CR():46===t?r.cc_ENM():47===t&&r.cc_EOC():r.cc_TO(t-32),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=n,!0},parseMidrow:function(e,t){var n=null;if((17===e||25===e)&&32<=t&&t<=47){if((n=17===e?1:2)!==this.currChNr)return f.log("ERROR","Mismatch channel in midrow parsing"),!1;var r=this.channels[n-1];return r.insertChars([32]),r.cc_MIDROW(t),f.log("DEBUG","MIDROW ("+l([e,t])+")"),this.lastCmdA=e,this.lastCmdB=t,!0}return!1},parsePAC:function(e,t){var n,r=null;if(!((17<=e&&e<=23||25<=e&&e<=31)&&64<=t&&t<=127)&&!((16===e||24===e)&&64<=t&&t<=95))return!1;n=e<=23?1:2,r=64<=t&&t<=95?1==n?a[e]:c[e]:1==n?u[e]:d[e];var i=this.interpretPAC(r,t);return this.channels[n-1].setPAC(i),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=n,!0},interpretPAC:function(e,t){var n=t,r={color:null,italics:!1,indent:null,underline:!1,row:e};return n=95<t?t-96:t-64,r.underline=1==(1&n),n<=13?r.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(r.italics=!0,r.color="white"):r.indent=4*Math.floor((n-16)/2),r},parseChars:function(e,t){var n=null,r=null,i=null;if(17<=(i=25<=e?(n=2,e-8):(n=1,e))&&i<=19){var a=t;a=17===i?t+80:18===i?t+112:t+144,f.log("INFO","Special char '"+s(a)+"' in channel "+n),r=[a],this.lastCmdA=e,this.lastCmdB=t}else 32<=e&&e<=127&&(r=0===t?[e]:[e,t],this.lastCmdA=null,this.lastCmdB=null);if(r){var o=l(r);f.log("DEBUG","Char codes =  "+o.join(","))}return r},parseBackgroundAttributes:function(e,t){var n,r,i;return((16===e||24===e)&&32<=t&&t<=47||(23===e||31===e)&&45<=t&&t<=47)&&(n={},16===e||24===e?(r=Math.floor((t-32)/2),n.background=h[r],t%2==1&&(n.background=n.background+"_semi")):45===t?n.background="transparent":(n.foreground="black",47===t&&(n.underline=!0)),i=e<24?1:2,this.channels[i-1].setBkgData(n),this.lastCmdA=e,this.lastCmdB=t,!0)},reset:function(){for(var e=0;e<this.channels.length;e++)this.channels[e]&&this.channels[e].reset();this.lastCmdA=null,this.lastCmdB=null},cueSplitAtTime:function(e){for(var t=0;t<this.channels.length;t++)this.channels[t]&&this.channels[t].cueSplitAtTime(e)}};e.logger=f,e.PenState=o,e.CaptionScreen=i,e.Cea608Parser=m,e.findCea608Nalus=function(e,t,n){for(var r=0,i=t,a=[],o=function(e,t,n,r){if(4!==e||t<8)return null;var i=n.getUint8(r),a=n.getUint16(r+1),o=n.getUint32(r+3),s=n.getUint8(r+7);return 181==i&&49==a&&1195456820==o&&3==s};i<t+n;){if(r=e.getUint32(i),6===(31&e.getUint8(i+4)))for(var s=i+5,l=-1;s<i+4+r-1;){l=0;for(var u=255;255===u;)l+=u=e.getUint8(s),s++;var c=0;for(u=255;255===u;)c+=u=e.getUint8(s),s++;o(l,c,e,s)&&a.push([s,c]),s+=c}i+=r+4}return a},e.extractCea608DataFromRange=function(e,t){var n=t[0],r=[[],[]];n+=8;var i=31&e.getUint8(n);n+=2;for(var a=0;a<i;a++){var o=e.getUint8(n),s=4&o,l=3&o;n++;var u=e.getUint8(n);n++;var c=e.getUint8(n);n++,s&&(127&u)+(127&c)!=0&&(0==l?(r[0].push(u),r[0].push(c)):1==l&&(r[1].push(u),r[1].push(c)))}return r}}(t)},"./externals/xml2json.js":function(e,t,n){n.r(t),t.default=function(A){A=A||{},function(){void 0===A.escapeMode&&(A.escapeMode=!0);void 0===A.attributePrefix&&(A.attributePrefix="_");A.arrayAccessForm=A.arrayAccessForm||"none",A.emptyNodeForm=A.emptyNodeForm||"text",void 0===A.enableToStringFunc&&(A.enableToStringFunc=!0);A.arrayAccessFormPaths=A.arrayAccessFormPaths||[],void 0===A.skipEmptyTextNodesForObj&&(A.skipEmptyTextNodesForObj=!0);void 0===A.stripWhitespaces&&(A.stripWhitespaces=!0);A.datetimeAccessFormPaths=A.datetimeAccessFormPaths||[],void 0===A.useDoubleQuotes&&(A.useDoubleQuotes=!1);A.xmlElementsFilter=A.xmlElementsFilter||[],A.jsonPropertiesFilter=A.jsonPropertiesFilter||[],void 0===A.keepCData&&(A.keepCData=!1);void 0===A.ignoreRoot&&(A.ignoreRoot=!1)}();var w={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,COMMENT_NODE:8,DOCUMENT_NODE:9};function S(e){var t=e.localName;return null==t&&(t=e.baseName),null!=t&&""!=t||(t=e.nodeName),t}function l(e){return"string"==typeof e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):e}function C(e,t,n,r){for(var i=0;i<e.length;i++){var a=e[i];if("string"==typeof a){if(a==r)break}else if(a instanceof RegExp){if(a.test(r))break}else if("function"==typeof a&&a(t,n,r))break}return i!=e.length}function x(e,t,n){switch(A.arrayAccessForm){case"property":e[t]instanceof Array?e[t+"_asArray"]=e[t]:e[t+"_asArray"]=[e[t]]}!(e[t]instanceof Array)&&0<A.arrayAccessFormPaths.length&&C(A.arrayAccessFormPaths,e,t,n)&&(e[t]=[e[t]])}function M(e){var t=e.split(/[-T:+Z]/g),n=new Date(t[0],t[1]-1,t[2]),r=t[5].split(".");if(n.setHours(t[3],t[4],r[0]),1<r.length&&n.setMilliseconds(r[1]),t[6]&&t[7]){var i=60*t[6]+Number(t[7]);i=0+("-"==(/\d\d-\d\d:\d\d$/.test(e)?"-":"+")?-1*i:i),n.setMinutes(n.getMinutes()-i-n.getTimezoneOffset())}else-1!==e.indexOf("Z",e.length-1)&&(n=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds())));return n}function R(e,t){if(e.nodeType==w.DOCUMENT_NODE){for(var n=new Object,r=e.childNodes,i=0;i<r.length;i++){if((o=r[i]).nodeType==w.ELEMENT_NODE)if(A.ignoreRoot)n=R(o);else(n={})[s=S(o)]=R(o)}return n}if(e.nodeType==w.ELEMENT_NODE){(n=new Object).__cnt=0;var a=[];for(r=e.childNodes,i=0;i<r.length;i++){var o,s=S(o=r[i]);if(o.nodeType!=w.COMMENT_NODE){var l=t+"."+s;if(_=n,b=o.nodeType,E=s,T=l,!(b==w.ELEMENT_NODE&&0<A.xmlElementsFilter.length)||C(A.xmlElementsFilter,_,E,T))if(n.__cnt++,null==n[s]){var u=R(o,l);if("#text"!=s||/[^\s]/.test(u))(c={})[s]=u,a.push(c);n[s]=u,x(n,s,l)}else{null!=n[s]&&(n[s]instanceof Array||(n[s]=[n[s]],x(n,s,l)));var c;u=R(o,l);if("#text"!=s||/[^\s]/.test(u))(c={})[s]=u,a.push(c);n[s][n[s].length]=u}}}n.__children=a;for(var d=S(e),h=0;h<e.attributes.length;h++){var f=e.attributes[h];n.__cnt++;for(var p=f.value,m=0,g=A.matchers.length;m<g;m++){var v=A.matchers[m];v.test(f,d)&&(p=v.converter(f.value))}n[A.attributePrefix+f.name]=p}var y=function(e){return e.prefix}(e);return null!=y&&""!=y&&(n.__cnt++,n.__prefix=y),null!=n["#text"]&&(n.__text=n["#text"],n.__text instanceof Array&&(n.__text=n.__text.join("\n")),A.stripWhitespaces&&(n.__text=n.__text.trim()),delete n["#text"],"property"==A.arrayAccessForm&&delete n["#text_asArray"],n.__text=function(e,t,n){if(0<A.datetimeAccessFormPaths.length){var r=n.split(".#")[0];return C(A.datetimeAccessFormPaths,e,t,r)?M(e):e}return e}(n.__text,s,t+"."+s)),null!=n["#cdata-section"]&&(n.__cdata=n["#cdata-section"],delete n["#cdata-section"],"property"==A.arrayAccessForm&&delete n["#cdata-section_asArray"]),0==n.__cnt&&"text"==A.emptyNodeForm?n="":1==n.__cnt&&null!=n.__text?n=n.__text:1!=n.__cnt||null==n.__cdata||A.keepCData?1<n.__cnt&&null!=n.__text&&A.skipEmptyTextNodesForObj&&(A.stripWhitespaces&&""==n.__text||""==n.__text.trim())&&delete n.__text:n=n.__cdata,delete n.__cnt,!A.enableToStringFunc||null==n.__text&&null==n.__cdata||(n.toString=function(){return(null!=this.__text?this.__text:"")+(null!=this.__cdata?this.__cdata:"")}),n}if(e.nodeType==w.TEXT_NODE||e.nodeType==w.CDATA_SECTION_NODE)return e.nodeValue;var _,b,E,T}function u(e,t,n,r){var i="<"+(null!=e&&null!=e.__prefix?e.__prefix+":":"")+t;if(null!=n)for(var a=0;a<n.length;a++){var o=n[a],s=e[o];A.escapeMode&&(s=l(s)),i+=" "+o.substr(A.attributePrefix.length)+"=",A.useDoubleQuotes?i+='"'+s+'"':i+="'"+s+"'"}return i+=r?"/>":">"}function c(e,t){return"</"+(null!=e.__prefix?e.__prefix+":":"")+t+">"}function d(e,t){return!!("property"==A.arrayAccessForm&&function(e,t){return-1!==e.indexOf(t,e.length-t.length)}(t.toString(),"_asArray")||0==t.toString().indexOf(A.attributePrefix)||0==t.toString().indexOf("__")||e[t]instanceof Function)}function h(e){var t=0;if(e instanceof Object)for(var n in e)d(e,n)||t++;return t}function f(e){var t=[];if(e instanceof Object)for(var n in e)-1==n.toString().indexOf("__")&&0==n.toString().indexOf(A.attributePrefix)&&t.push(n);return t}function p(e){var t="";return e instanceof Object?t+=function(e){var t="";return null!=e.__cdata&&(t+="<![CDATA["+e.__cdata+"]]>"),null!=e.__text&&(A.escapeMode?t+=l(e.__text):t+=e.__text),t}(e):null!=e&&(A.escapeMode?t+=l(e):t+=e),t}function m(e,t){return""===e?t:e+"."+t}function g(e,t,n,r){var i="";if(0==e.length)i+=u(e,t,n,!0);else for(var a=0;a<e.length;a++)i+=u(e[a],t,f(e[a]),!1),i+=v(e[a],m(r,t)),i+=c(e[a],t);return i}function v(e,t){var n,r,i,a="";if(0<h(e))for(var o in e)if(!d(e,o)&&(""==t||(n=e,i=m(t,r=o),0==A.jsonPropertiesFilter.length||""==i||C(A.jsonPropertiesFilter,n,r,i)))){var s=e[o],l=f(s);if(null==s||null==s)a+=u(s,o,l,!0);else if(s instanceof Object)if(s instanceof Array)a+=g(s,o,l,t);else if(s instanceof Date)a+=u(s,o,l,!1),a+=s.toISOString(),a+=c(s,o);else{0<h(s)||null!=s.__text||null!=s.__cdata?(a+=u(s,o,l,!1),a+=v(s,m(t,o)),a+=c(s,o)):a+=u(s,o,l,!0)}else a+=u(s,o,l,!1),a+=p(s),a+=c(s,o)}return a+=p(e)}this.parseXmlString=function(e){var t;window.ActiveXObject||window;if(void 0===e)return null;if(window.DOMParser){var n=new window.DOMParser;try{0<(t=n.parseFromString(e,"text/xml")).getElementsByTagNameNS("*","parsererror").length&&(t=null)}catch(e){t=null}}else 0==e.indexOf("<?")&&(e=e.substr(e.indexOf("?>")+2)),(t=new ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e);return t},this.asArray=function(e){return void 0===e||null==e?[]:e instanceof Array?e:[e]},this.toXmlDateTime=function(e){return e instanceof Date?e.toISOString():"number"==typeof e?new Date(e).toISOString():null},this.asDateTime=function(e){return"string"==typeof e?M(e):e},this.xml2json=function(e){return R(e)},this.xml_str2json=function(e){var t=this.parseXmlString(e);return null!=t?this.xml2json(t):null},this.json2xml_str=function(e){return v(e,"")},this.json2xml=function(e){var t=this.json2xml_str(e);return this.parseXmlString(t)},this.getVersion=function(){return"1.2.0"}}},"./index.js":function(e,t,n){n.r(t);var r=n("./index_mediaplayerOnly.js");n.d(t,"MediaPlayer",function(){return r.MediaPlayer});var i=n("./src/streaming/utils/Capabilities.js");n.d(t,"supportsMediaSource",function(){return i.supportsMediaSource});var a=n("./src/streaming/metrics/MetricsReporting.js");n.d(t,"MetricsReporting",function(){return a.default});var o=n("./src/streaming/protection/Protection.js");n.d(t,"Protection",function(){return o.default});var s=n("./src/streaming/MediaPlayerFactory.js");n.d(t,"MediaPlayerFactory",function(){return s.default});var l=n("./src/core/Debug.js");n.d(t,"Debug",function(){return l.default}),dashjs.Protection=o.default,dashjs.MetricsReporting=a.default,dashjs.MediaPlayerFactory=s.default,dashjs.Debug=l.default,dashjs.supportsMediaSource=i.supportsMediaSource,t.default=dashjs},"./index_mediaplayerOnly.js":function(e,s,l){l.r(s),function(e){var t=l("./src/streaming/MediaPlayer.js");l.d(s,"MediaPlayer",function(){return t.default});var n=l("./src/core/FactoryMaker.js");l.d(s,"FactoryMaker",function(){return n.default});var r=l("./src/core/Debug.js");l.d(s,"Debug",function(){return r.default});var i=l("./src/core/Version.js"),a=(l("./node_modules/es6-promise/auto.js"),"undefined"!=typeof window&&window||e),o=a.dashjs;(o=o||(a.dashjs={})).MediaPlayer=t.default,o.FactoryMaker=n.default,o.Debug=r.default,o.Version=Object(i.getVersionString)(),s.default=o}.call(this,l("./node_modules/webpack/buildin/global.js"))},"./node_modules/base64-js/index.js":function(e,t,n){t.byteLength=function(e){var t=d(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){for(var t,n=d(e),r=n[0],i=n[1],a=new c(function(e,t,n){return 3*(t+n)/4-n}(0,r,i)),o=0,s=0<i?r-4:r,l=0;l<s;l+=4)t=u[e.charCodeAt(l)]<<18|u[e.charCodeAt(l+1)]<<12|u[e.charCodeAt(l+2)]<<6|u[e.charCodeAt(l+3)],a[o++]=t>>16&255,a[o++]=t>>8&255,a[o++]=255&t;2===i&&(t=u[e.charCodeAt(l)]<<2|u[e.charCodeAt(l+1)]>>4,a[o++]=255&t);1===i&&(t=u[e.charCodeAt(l)]<<10|u[e.charCodeAt(l+1)]<<4|u[e.charCodeAt(l+2)]>>2,a[o++]=t>>8&255,a[o++]=255&t);return a},t.fromByteArray=function(e){for(var t,n=e.length,r=n%3,i=[],a=0,o=n-r;a<o;a+=16383)i.push(l(e,a,o<a+16383?o:a+16383));1==r?(t=e[n-1],i.push(s[t>>2]+s[t<<4&63]+"==")):2==r&&(t=(e[n-2]<<8)+e[n-1],i.push(s[t>>10]+s[t>>4&63]+s[t<<2&63]+"="));return i.join("")};for(var s=[],u=[],c="undefined"!=typeof Uint8Array?Uint8Array:Array,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,a=r.length;i<a;++i)s[i]=r[i],u[r.charCodeAt(i)]=i;function d(e){var t=e.length;if(0<t%4)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function l(e,t,n){for(var r,i,a=[],o=t;o<n;o+=3)r=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),a.push(s[(i=r)>>18&63]+s[i>>12&63]+s[i>>6&63]+s[63&i]);return a.join("")}u["-".charCodeAt(0)]=62,u["_".charCodeAt(0)]=63},"./node_modules/codem-isoboxer/dist/iso_boxer.js":function(e,t,n){var i={parseBuffer:function(e){return new a(e).parse()},addBoxProcessor:function(e,t){"string"==typeof e&&"function"==typeof t&&(o.prototype._boxProcessors[e]=t)},createFile:function(){return new a},createBox:function(e,t,n){var r=o.create(e);return t&&t.append(r,n),r},createFullBox:function(e,t,n){var r=i.createBox(e,t,n);return r.version=0,r.flags=0,r},Utils:{}};i.Utils.dataViewToString=function(e,t){var n=t||"utf-8";if("undefined"!=typeof TextDecoder)return new TextDecoder(n).decode(e);var r=[],i=0;if("utf-8"===n)for(;i<e.byteLength;){var a=e.getUint8(i++);a<128||(a<224?a=(31&a)<<6:(a<240?a=(15&a)<<12:(a=(7&a)<<18,a|=(63&e.getUint8(i++))<<12),a|=(63&e.getUint8(i++))<<6),a|=63&e.getUint8(i++)),r.push(String.fromCharCode(a))}else for(;i<e.byteLength;)r.push(String.fromCharCode(e.getUint8(i++)));return r.join("")},i.Utils.utf8ToByteArray=function(e){var t,n;if("undefined"!=typeof TextEncoder)t=(new TextEncoder).encode(e);else for(t=[],n=0;n<e.length;++n){var r=e.charCodeAt(n);r<128?t.push(r):(r<2048?t.push(192|r>>6):(r<65536?t.push(224|r>>12):(t.push(240|r>>18),t.push(128|63&r>>12)),t.push(128|63&r>>6)),t.push(128|63&r))}return t},i.Utils.appendBox=function(e,t,n){if(t._offset=e._cursor.offset,t._root=e._root?e._root:e,t._raw=e._raw,t._parent=e,-1!==n)if(null!=n){var r,i=-1;if("number"==typeof n)i=n;else{if("string"==typeof n)r=n;else{if("object"!=typeof n||!n.type)return void e.boxes.push(t);r=n.type}for(var a=0;a<e.boxes.length;a++)if(r===e.boxes[a].type){i=a+1;break}}e.boxes.splice(i,0,t)}else e.boxes.push(t)},t.parseBuffer=i.parseBuffer,t.addBoxProcessor=i.addBoxProcessor,t.createFile=i.createFile,t.createBox=i.createBox,t.createFullBox=i.createFullBox,t.Utils=i.Utils,i.Cursor=function(e){this.offset=void 0===e?0:e};var a=function(e){this._cursor=new i.Cursor,this.boxes=[],e&&(this._raw=new DataView(e))};a.prototype.fetch=function(e){var t=this.fetchAll(e,!0);return t.length?t[0]:null},a.prototype.fetchAll=function(e,t){var n=[];return a._sweep.call(this,e,n,t),n},a.prototype.parse=function(){for(this._cursor.offset=0,this.boxes=[];this._cursor.offset<this._raw.byteLength;){var e=o.parse(this);if(void 0===e.type)break;this.boxes.push(e)}return this},a._sweep=function(e,t,n){for(var r in this.type&&this.type==e&&t.push(this),this.boxes){if(t.length&&n)return;a._sweep.call(this.boxes[r],e,t,n)}},a.prototype.write=function(){var e,t=0;for(e=0;e<this.boxes.length;e++)t+=this.boxes[e].getLength(!1);var n=new Uint8Array(t);for(this._rawo=new DataView(n.buffer),this.bytes=n,e=this._cursor.offset=0;e<this.boxes.length;e++)this.boxes[e].write();return n.buffer},a.prototype.append=function(e,t){i.Utils.appendBox(this,e,t)};var o=function(){this._cursor=new i.Cursor};o.parse=function(e){var t=new o;return t._offset=e._cursor.offset,t._root=e._root?e._root:e,t._raw=e._raw,t._parent=e,t._parseBox(),e._cursor.offset=t._raw.byteOffset+t._raw.byteLength,t},o.create=function(e){var t=new o;return t.type=e,t.boxes=[],t},o.prototype._boxContainers=["dinf","edts","mdia","meco","mfra","minf","moof","moov","mvex","stbl","strk","traf","trak","tref","udta","vttc","sinf","schi","encv","enca"],o.prototype._boxProcessors={},o.prototype._procField=function(e,t,n){this._parsing?this[e]=this._readField(t,n):this._writeField(t,n,this[e])},o.prototype._procFieldArray=function(e,t,n,r){var i;if(this._parsing)for(this[e]=[],i=0;i<t;i++)this[e][i]=this._readField(n,r);else for(i=0;i<this[e].length;i++)this._writeField(n,r,this[e][i])},o.prototype._procFullBox=function(){this._procField("version","uint",8),this._procField("flags","uint",24)},o.prototype._procEntries=function(e,t,n){var r;if(this._parsing)for(this[e]=[],r=0;r<t;r++)this[e].push({}),n.call(this,this[e][r]);else for(r=0;r<t;r++)n.call(this,this[e][r])},o.prototype._procSubEntries=function(e,t,n,r){var i;if(this._parsing)for(e[t]=[],i=0;i<n;i++)e[t].push({}),r.call(this,e[t][i]);else for(i=0;i<n;i++)r.call(this,e[t][i])},o.prototype._procEntryField=function(e,t,n,r){this._parsing?e[t]=this._readField(n,r):this._writeField(n,r,e[t])},o.prototype._procSubBoxes=function(e,t){var n;if(this._parsing)for(this[e]=[],n=0;n<t;n++)this[e].push(o.parse(this));else for(n=0;n<t;n++)this._rawo?this[e][n].write():this.size+=this[e][n].getLength()},o.prototype._readField=function(e,t){switch(e){case"uint":return this._readUint(t);case"int":return this._readInt(t);case"template":return this._readTemplate(t);case"string":return-1===t?this._readTerminatedString():this._readString(t);case"data":return this._readData(t);case"utf8":return this._readUTF8String();default:return-1}},o.prototype._readInt=function(e){var t=null,n=this._cursor.offset-this._raw.byteOffset;switch(e){case 8:t=this._raw.getInt8(n);break;case 16:t=this._raw.getInt16(n);break;case 32:t=this._raw.getInt32(n);break;case 64:var r=this._raw.getInt32(n),i=this._raw.getInt32(4+n);t=r*Math.pow(2,32)+i}return this._cursor.offset+=e>>3,t},o.prototype._readUint=function(e){var t,n,r=null,i=this._cursor.offset-this._raw.byteOffset;switch(e){case 8:r=this._raw.getUint8(i);break;case 16:r=this._raw.getUint16(i);break;case 24:r=((t=this._raw.getUint16(i))<<8)+(n=this._raw.getUint8(2+i));break;case 32:r=this._raw.getUint32(i);break;case 64:t=this._raw.getUint32(i),n=this._raw.getUint32(4+i),r=t*Math.pow(2,32)+n}return this._cursor.offset+=e>>3,r},o.prototype._readString=function(e){for(var t="",n=0;n<e;n++){var r=this._readUint(8);t+=String.fromCharCode(r)}return t},o.prototype._readTemplate=function(e){return this._readUint(e/2)+this._readUint(e/2)/Math.pow(2,e/2)},o.prototype._readTerminatedString=function(){for(var e="";this._cursor.offset-this._offset<this._raw.byteLength;){var t=this._readUint(8);if(0===t)break;e+=String.fromCharCode(t)}return e},o.prototype._readData=function(e){var t=0<e?e:this._raw.byteLength-(this._cursor.offset-this._offset);if(0<t){var n=new Uint8Array(this._raw.buffer,this._cursor.offset,t);return this._cursor.offset+=t,n}return null},o.prototype._readUTF8String=function(){var e=this._raw.byteLength-(this._cursor.offset-this._offset),t=null;return 0<e&&(t=new DataView(this._raw.buffer,this._cursor.offset,e),this._cursor.offset+=e),t?i.Utils.dataViewToString(t):t},o.prototype._parseBox=function(){if(this._parsing=!0,this._cursor.offset=this._offset,this._offset+8>this._raw.buffer.byteLength)this._root._incomplete=!0;else{switch(this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this.size){case 0:this._raw=new DataView(this._raw.buffer,this._offset,this._raw.byteLength-this._cursor.offset+8);break;case 1:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.largesize);break;default:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.size)}this._incomplete||(this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type)?this._parseContainerBox():this._data=this._readData())}},o.prototype._parseFullBox=function(){this.version=this._readUint(8),this.flags=this._readUint(24)},o.prototype._parseContainerBox=function(){for(this.boxes=[];this._cursor.offset-this._raw.byteOffset<this._raw.byteLength;)this.boxes.push(o.parse(this))},o.prototype.append=function(e,t){i.Utils.appendBox(this,e,t)},o.prototype.getLength=function(){if(this._parsing=!1,this._rawo=null,this.size=0,this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type))for(var e=0;e<this.boxes.length;e++)this.size+=this.boxes[e].getLength();return this._data&&this._writeData(this._data),this.size},o.prototype.write=function(){switch(this._parsing=!1,this._cursor.offset=this._parent._cursor.offset,this.size){case 0:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.parent._rawo.byteLength-this._cursor.offset);break;case 1:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.largesize);break;default:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.size)}if(this._procField("size","uint",32),this._procField("type","string",4),1===this.size&&this._procField("largesize","uint",64),"uuid"===this.type&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),-1!==this._boxContainers.indexOf(this.type))for(var e=0;e<this.boxes.length;e++)this.boxes[e].write();return this._data&&this._writeData(this._data),this._parent._cursor.offset+=this.size,this.size},o.prototype._writeInt=function(e,t){if(this._rawo){var n=this._cursor.offset-this._rawo.byteOffset;switch(e){case 8:this._rawo.setInt8(n,t);break;case 16:this._rawo.setInt16(n,t);break;case 32:this._rawo.setInt32(n,t);break;case 64:var r=Math.floor(t/Math.pow(2,32)),i=t-r*Math.pow(2,32);this._rawo.setUint32(n,r),this._rawo.setUint32(4+n,i)}this._cursor.offset+=e>>3}else this.size+=e>>3},o.prototype._writeUint=function(e,t){if(this._rawo){var n,r,i=this._cursor.offset-this._rawo.byteOffset;switch(e){case 8:this._rawo.setUint8(i,t);break;case 16:this._rawo.setUint16(i,t);break;case 24:n=(16776960&t)>>8,r=255&t,this._rawo.setUint16(i,n),this._rawo.setUint8(2+i,r);break;case 32:this._rawo.setUint32(i,t);break;case 64:r=t-(n=Math.floor(t/Math.pow(2,32)))*Math.pow(2,32),this._rawo.setUint32(i,n),this._rawo.setUint32(4+i,r)}this._cursor.offset+=e>>3}else this.size+=e>>3},o.prototype._writeString=function(e,t){for(var n=0;n<e;n++)this._writeUint(8,t.charCodeAt(n))},o.prototype._writeTerminatedString=function(e){if(0!==e.length){for(var t=0;t<e.length;t++)this._writeUint(8,e.charCodeAt(t));this._writeUint(8,0)}},o.prototype._writeTemplate=function(e,t){var n=Math.floor(t),r=(t-n)*Math.pow(2,e/2);this._writeUint(e/2,n),this._writeUint(e/2,r)},o.prototype._writeData=function(e){if(e)if(this._rawo){if(e instanceof Array){for(var t=this._cursor.offset-this._rawo.byteOffset,n=0;n<e.length;n++)this._rawo.setInt8(t+n,e[n]);this._cursor.offset+=e.length}e instanceof Uint8Array&&(this._root.bytes.set(e,this._cursor.offset),this._cursor.offset+=e.length)}else this.size+=e.length},o.prototype._writeUTF8String=function(e){var t=i.Utils.utf8ToByteArray(e);if(this._rawo)for(var n=new DataView(this._rawo.buffer,this._cursor.offset,t.length),r=0;r<t.length;r++)n.setUint8(r,t[r]);else this.size+=t.length},o.prototype._writeField=function(e,t,n){switch(e){case"uint":this._writeUint(t,n);break;case"int":this._writeInt(t,n);break;case"template":this._writeTemplate(t,n);break;case"string":-1==t?this._writeTerminatedString(n):this._writeString(t,n);break;case"data":this._writeData(n);break;case"utf8":this._writeUTF8String(n)}},o.prototype._boxProcessors.avc1=o.prototype._boxProcessors.encv=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procField("pre_defined1","uint",16),this._procField("reserved2","uint",16),this._procFieldArray("pre_defined2",3,"uint",32),this._procField("width","uint",16),this._procField("height","uint",16),this._procField("horizresolution","template",32),this._procField("vertresolution","template",32),this._procField("reserved3","uint",32),this._procField("frame_count","uint",16),this._procFieldArray("compressorname",32,"uint",8),this._procField("depth","uint",16),this._procField("pre_defined3","int",16),this._procField("config","data",-1)},o.prototype._boxProcessors.dref=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count)},o.prototype._boxProcessors.elst=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,function(e){this._procEntryField(e,"segment_duration","uint",1===this.version?64:32),this._procEntryField(e,"media_time","int",1===this.version?64:32),this._procEntryField(e,"media_rate_integer","int",16),this._procEntryField(e,"media_rate_fraction","int",16)})},o.prototype._boxProcessors.emsg=function(){this._procFullBox(),1==this.version?(this._procField("timescale","uint",32),this._procField("presentation_time","uint",64),this._procField("event_duration","uint",32),this._procField("id","uint",32),this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1)):(this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1),this._procField("timescale","uint",32),this._procField("presentation_time_delta","uint",32),this._procField("event_duration","uint",32),this._procField("id","uint",32)),this._procField("message_data","data",-1)},o.prototype._boxProcessors.free=o.prototype._boxProcessors.skip=function(){this._procField("data","data",-1)},o.prototype._boxProcessors.frma=function(){this._procField("data_format","uint",32)},o.prototype._boxProcessors.ftyp=o.prototype._boxProcessors.styp=function(){this._procField("major_brand","string",4),this._procField("minor_version","uint",32);var e=-1;this._parsing&&(e=(this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset))/4),this._procFieldArray("compatible_brands",e,"string",4)},o.prototype._boxProcessors.hdlr=function(){this._procFullBox(),this._procField("pre_defined","uint",32),this._procField("handler_type","string",4),this._procFieldArray("reserved",3,"uint",32),this._procField("name","string",-1)},o.prototype._boxProcessors.mdat=function(){this._procField("data","data",-1)},o.prototype._boxProcessors.mdhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",1==this.version?64:32),this._parsing||"string"!=typeof this.language||(this.language=this.language.charCodeAt(0)-96<<10|this.language.charCodeAt(1)-96<<5|this.language.charCodeAt(2)-96),this._procField("language","uint",16),this._parsing&&(this.language=String.fromCharCode(96+(this.language>>10&31),96+(this.language>>5&31),96+(31&this.language))),this._procField("pre_defined","uint",16)},o.prototype._boxProcessors.mehd=function(){this._procFullBox(),this._procField("fragment_duration","uint",1==this.version?64:32)},o.prototype._boxProcessors.mfhd=function(){this._procFullBox(),this._procField("sequence_number","uint",32)},o.prototype._boxProcessors.mfro=function(){this._procFullBox(),this._procField("mfra_size","uint",32)},o.prototype._boxProcessors.mp4a=o.prototype._boxProcessors.enca=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procField("channelcount","uint",16),this._procField("samplesize","uint",16),this._procField("pre_defined","uint",16),this._procField("reserved3","uint",16),this._procField("samplerate","template",32),this._procField("esds","data",-1)},o.prototype._boxProcessors.mvhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",1==this.version?64:32),this._procField("rate","template",32),this._procField("volume","template",16),this._procField("reserved1","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procFieldArray("matrix",9,"template",32),this._procFieldArray("pre_defined",6,"uint",32),this._procField("next_track_ID","uint",32)},o.prototype._boxProcessors.payl=function(){this._procField("cue_text","utf8")},o.prototype._boxProcessors.pssh=function(){this._procFullBox(),this._procFieldArray("SystemID",16,"uint",8),this._procField("DataSize","uint",32),this._procFieldArray("Data",this.DataSize,"uint",8)},o.prototype._boxProcessors.schm=function(){this._procFullBox(),this._procField("scheme_type","uint",32),this._procField("scheme_version","uint",32),1&this.flags&&this._procField("scheme_uri","string",-1)},o.prototype._boxProcessors.sdtp=function(){this._procFullBox();var e=-1;this._parsing&&(e=this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset)),this._procFieldArray("sample_dependency_table",e,"uint",8)},o.prototype._boxProcessors.sidx=function(){this._procFullBox(),this._procField("reference_ID","uint",32),this._procField("timescale","uint",32),this._procField("earliest_presentation_time","uint",1==this.version?64:32),this._procField("first_offset","uint",1==this.version?64:32),this._procField("reserved","uint",16),this._procField("reference_count","uint",16),this._procEntries("references",this.reference_count,function(e){this._parsing||(e.reference=(1&e.reference_type)<<31,e.reference|=2147483647&e.referenced_size,e.sap=(1&e.starts_with_SAP)<<31,e.sap|=(3&e.SAP_type)<<28,e.sap|=268435455&e.SAP_delta_time),this._procEntryField(e,"reference","uint",32),this._procEntryField(e,"subsegment_duration","uint",32),this._procEntryField(e,"sap","uint",32),this._parsing&&(e.reference_type=e.reference>>31&1,e.referenced_size=2147483647&e.reference,e.starts_with_SAP=e.sap>>31&1,e.SAP_type=e.sap>>28&7,e.SAP_delta_time=268435455&e.sap)})},o.prototype._boxProcessors.smhd=function(){this._procFullBox(),this._procField("balance","uint",16),this._procField("reserved","uint",16)},o.prototype._boxProcessors.ssix=function(){this._procFullBox(),this._procField("subsegment_count","uint",32),this._procEntries("subsegments",this.subsegment_count,function(e){this._procEntryField(e,"ranges_count","uint",32),this._procSubEntries(e,"ranges",e.ranges_count,function(e){this._procEntryField(e,"level","uint",8),this._procEntryField(e,"range_size","uint",24)})})},o.prototype._boxProcessors.stsd=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count)},o.prototype._boxProcessors.subs=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,function(e){this._procEntryField(e,"sample_delta","uint",32),this._procEntryField(e,"subsample_count","uint",16),this._procSubEntries(e,"subsamples",e.subsample_count,function(e){this._procEntryField(e,"subsample_size","uint",1===this.version?32:16),this._procEntryField(e,"subsample_priority","uint",8),this._procEntryField(e,"discardable","uint",8),this._procEntryField(e,"codec_specific_parameters","uint",32)})})},o.prototype._boxProcessors.tenc=function(){this._procFullBox(),this._procField("default_IsEncrypted","uint",24),this._procField("default_IV_size","uint",8),this._procFieldArray("default_KID",16,"uint",8)},o.prototype._boxProcessors.tfdt=function(){this._procFullBox(),this._procField("baseMediaDecodeTime","uint",1==this.version?64:32)},o.prototype._boxProcessors.tfhd=function(){this._procFullBox(),this._procField("track_ID","uint",32),1&this.flags&&this._procField("base_data_offset","uint",64),2&this.flags&&this._procField("sample_description_offset","uint",32),8&this.flags&&this._procField("default_sample_duration","uint",32),16&this.flags&&this._procField("default_sample_size","uint",32),32&this.flags&&this._procField("default_sample_flags","uint",32)},o.prototype._boxProcessors.tfra=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._parsing||(this.reserved=0,this.reserved|=(48&this.length_size_of_traf_num)<<4,this.reserved|=(12&this.length_size_of_trun_num)<<2,this.reserved|=3&this.length_size_of_sample_num),this._procField("reserved","uint",32),this._parsing&&(this.length_size_of_traf_num=(48&this.reserved)>>4,this.length_size_of_trun_num=(12&this.reserved)>>2,this.length_size_of_sample_num=3&this.reserved),this._procField("number_of_entry","uint",32),this._procEntries("entries",this.number_of_entry,function(e){this._procEntryField(e,"time","uint",1===this.version?64:32),this._procEntryField(e,"moof_offset","uint",1===this.version?64:32),this._procEntryField(e,"traf_number","uint",8*(this.length_size_of_traf_num+1)),this._procEntryField(e,"trun_number","uint",8*(this.length_size_of_trun_num+1)),this._procEntryField(e,"sample_number","uint",8*(this.length_size_of_sample_num+1))})},o.prototype._boxProcessors.tkhd=function(){this._procFullBox(),this._procField("creation_time","uint",1==this.version?64:32),this._procField("modification_time","uint",1==this.version?64:32),this._procField("track_ID","uint",32),this._procField("reserved1","uint",32),this._procField("duration","uint",1==this.version?64:32),this._procFieldArray("reserved2",2,"uint",32),this._procField("layer","uint",16),this._procField("alternate_group","uint",16),this._procField("volume","template",16),this._procField("reserved3","uint",16),this._procFieldArray("matrix",9,"template",32),this._procField("width","template",32),this._procField("height","template",32)},o.prototype._boxProcessors.trex=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._procField("default_sample_description_index","uint",32),this._procField("default_sample_duration","uint",32),this._procField("default_sample_size","uint",32),this._procField("default_sample_flags","uint",32)},o.prototype._boxProcessors.trun=function(){this._procFullBox(),this._procField("sample_count","uint",32),1&this.flags&&this._procField("data_offset","int",32),4&this.flags&&this._procField("first_sample_flags","uint",32),this._procEntries("samples",this.sample_count,function(e){256&this.flags&&this._procEntryField(e,"sample_duration","uint",32),512&this.flags&&this._procEntryField(e,"sample_size","uint",32),1024&this.flags&&this._procEntryField(e,"sample_flags","uint",32),2048&this.flags&&this._procEntryField(e,"sample_composition_time_offset",1===this.version?"int":"uint",32)})},o.prototype._boxProcessors["url "]=o.prototype._boxProcessors["urn "]=function(){this._procFullBox(),"urn "===this.type&&this._procField("name","string",-1),this._procField("location","string",-1)},o.prototype._boxProcessors.vlab=function(){this._procField("source_label","utf8")},o.prototype._boxProcessors.vmhd=function(){this._procFullBox(),this._procField("graphicsmode","uint",16),this._procFieldArray("opcolor",3,"uint",16)},o.prototype._boxProcessors.vttC=function(){this._procField("config","utf8")},o.prototype._boxProcessors.vtte=function(){}},"./node_modules/core-util-is/lib/util.js":function(e,n,t){(function(e){function t(e){return Object.prototype.toString.call(e)}n.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===t(e)},n.isBoolean=function(e){return"boolean"==typeof e},n.isNull=function(e){return null===e},n.isNullOrUndefined=function(e){return null==e},n.isNumber=function(e){return"number"==typeof e},n.isString=function(e){return"string"==typeof e},n.isSymbol=function(e){return"symbol"==typeof e},n.isUndefined=function(e){return void 0===e},n.isRegExp=function(e){return"[object RegExp]"===t(e)},n.isObject=function(e){return"object"==typeof e&&null!==e},n.isDate=function(e){return"[object Date]"===t(e)},n.isError=function(e){return"[object Error]"===t(e)||e instanceof Error},n.isFunction=function(e){return"function"==typeof e},n.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},n.isBuffer=e.isBuffer}).call(this,t("./node_modules/node-libs-browser/node_modules/buffer/index.js").Buffer)},"./node_modules/es6-promise/auto.js":function(e,t,n){e.exports=n("./node_modules/es6-promise/dist/es6-promise.js").polyfill()},"./node_modules/es6-promise/dist/es6-promise.js":function(e,t,n){(function(re,ie){e.exports=function(){function r(e){var t=typeof e;return e!==null&&(t==="object"||t==="function")}function l(e){return typeof e==="function"}var e=void 0;if(Array.isArray){e=Array.isArray}else{e=function(e){return Object.prototype.toString.call(e)==="[object Array]"}}var n=e,i=0,t=void 0,a=void 0,o=function e(t,n){b[i]=t;b[i+1]=n;i+=2;if(i===2){if(a){a(E)}else{A()}}};function s(e){a=e}function u(e){o=e}var c=typeof window!=="undefined"?window:undefined,d=c||{},h=d.MutationObserver||d.WebKitMutationObserver,f=typeof self==="undefined"&&typeof re!=="undefined"&&{}.toString.call(re)==="[object process]",p=typeof Uint8ClampedArray!=="undefined"&&typeof importScripts!=="undefined"&&typeof MessageChannel!=="undefined";function m(){return function(){return re.nextTick(E)}}function g(){if(typeof t!=="undefined"){return function(){t(E)}}return _()}function v(){var e=0;var t=new h(E);var n=document.createTextNode("");t.observe(n,{characterData:true});return function(){n.data=e=++e%2}}function y(){var e=new MessageChannel;e.port1.onmessage=E;return function(){return e.port2.postMessage(0)}}function _(){var e=setTimeout;return function(){return e(E,1)}}var b=new Array(1e3);function E(){for(var e=0;e<i;e+=2){var t=b[e];var n=b[e+1];t(n);b[e]=undefined;b[e+1]=undefined}i=0}function T(){try{var e=Function("return this")().require("vertx");t=e.runOnLoop||e.runOnContext;return g()}catch(e){return _()}}var A=void 0;if(f){A=m()}else if(h){A=v()}else if(p){A=y()}else if(c===undefined&&"function"==="function"){A=T()}else{A=_()}function w(e,t){var n=this;var r=new this.constructor(x);if(r[C]===undefined){Y(r)}var i=n._state;if(i){var a=arguments[i-1];o(function(){return V(i,r,a,n._result)})}else{H(n,r,e,t)}return r}function S(e){var t=this;if(e&&typeof e==="object"&&e.constructor===t){return e}var n=new t(x);B(n,e);return n}var C=Math.random().toString(36).substring(2);function x(){}var M=void 0,R=1,I=2;function P(){return new TypeError("You cannot resolve a promise with itself")}function D(){return new TypeError("A promises callback cannot return that same promise.")}function L(e,t,n,r){try{e.call(t,n,r)}catch(e){return e}}function O(e,r,i){o(function(t){var n=false;var e=L(i,r,function(e){if(n){return}n=true;if(r!==e){B(t,e)}else{j(t,e)}},function(e){if(n){return}n=true;U(t,e)},"Settle: "+(t._label||" unknown promise"));if(!n&&e){n=true;U(t,e)}},e)}function N(t,e){if(e._state===R){j(t,e._result)}else if(e._state===I){U(t,e._result)}else{H(e,undefined,function(e){return B(t,e)},function(e){return U(t,e)})}}function k(e,t,n){if(t.constructor===e.constructor&&n===w&&t.constructor.resolve===S){N(e,t)}else{if(n===undefined){j(e,t)}else if(l(n)){O(e,t,n)}else{j(e,t)}}}function B(t,e){if(t===e){U(t,P())}else if(r(e)){var n=void 0;try{n=e.then}catch(e){U(t,e);return}k(t,e,n)}else{j(t,e)}}function F(e){if(e._onerror){e._onerror(e._result)}G(e)}function j(e,t){if(e._state!==M){return}e._result=t;e._state=R;if(e._subscribers.length!==0){o(G,e)}}function U(e,t){if(e._state!==M){return}e._state=I;e._result=t;o(F,e)}function H(e,t,n,r){var i=e._subscribers;var a=i.length;e._onerror=null;i[a]=t;i[a+R]=n;i[a+I]=r;if(a===0&&e._state){o(G,e)}}function G(e){var t=e._subscribers;var n=e._state;if(t.length===0){return}var r=void 0,i=void 0,a=e._result;for(var o=0;o<t.length;o+=3){r=t[o];i=t[o+n];if(r){V(n,r,i,a)}else{i(a)}}e._subscribers.length=0}function V(e,t,n,r){var i=l(n),a=void 0,o=void 0,s=true;if(i){try{a=n(r)}catch(e){s=false;o=e}if(t===a){U(t,D());return}}else{a=r}if(t._state!==M);else if(i&&s){B(t,a)}else if(s===false){U(t,o)}else if(e===R){j(t,a)}else if(e===I){U(t,a)}}function z(n,e){try{e(function e(t){B(n,t)},function e(t){U(n,t)})}catch(e){U(n,e)}}var W=0;function q(){return W++}function Y(e){e[C]=W++;e._state=undefined;e._result=undefined;e._subscribers=[]}function K(){return new Error("Array Methods must be provided an Array")}var X=function(){function e(e,t){this._instanceConstructor=e;this.promise=new e(x);if(!this.promise[C]){Y(this.promise)}if(n(t)){this.length=t.length;this._remaining=t.length;this._result=new Array(this.length);if(this.length===0){j(this.promise,this._result)}else{this.length=this.length||0;this._enumerate(t);if(this._remaining===0){j(this.promise,this._result)}}}else{U(this.promise,K())}}e.prototype._enumerate=function e(t){for(var n=0;this._state===M&&n<t.length;n++){this._eachEntry(t[n],n)}};e.prototype._eachEntry=function e(t,n){var r=this._instanceConstructor;var i=r.resolve;if(i===S){var a=void 0;var o=void 0;var s=false;try{a=t.then}catch(e){s=true;o=e}if(a===w&&t._state!==M){this._settledAt(t._state,n,t._result)}else if(typeof a!=="function"){this._remaining--;this._result[n]=t}else if(r===te){var l=new r(x);if(s){U(l,o)}else{k(l,t,a)}this._willSettleAt(l,n)}else{this._willSettleAt(new r(function(e){return e(t)}),n)}}else{this._willSettleAt(i(t),n)}};e.prototype._settledAt=function e(t,n,r){var i=this.promise;if(i._state===M){this._remaining--;if(t===I){U(i,r)}else{this._result[n]=r}}if(this._remaining===0){j(i,this._result)}};e.prototype._willSettleAt=function e(t,n){var r=this;H(t,undefined,function(e){return r._settledAt(R,n,e)},function(e){return r._settledAt(I,n,e)})};return e}();function Q(e){return new X(this,e).promise}function Z(i){var a=this;if(n(i))return new a(function(e,t){for(var n=i.length,r=0;r<n;r++)a.resolve(i[r]).then(e,t)});else return new a(function(e,t){return t(new TypeError("You must pass an array to race."))})}function J(e){var t=new this(x);return U(t,e),t}function $(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function ee(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var te=function(){function t(e){this[C]=q();this._result=this._state=undefined;this._subscribers=[];if(x!==e){typeof e!=="function"&&$();this instanceof t?z(this,e):ee()}}t.prototype.catch=function e(t){return this.then(null,t)};t.prototype.finally=function e(t){var n=this;var r=n.constructor;if(l(t)){return n.then(function(e){return r.resolve(t()).then(function(){return e})},function(e){return r.resolve(t()).then(function(){throw e})})}return n.then(t,t)};return t}();function ne(){var e=void 0;if(void 0!==ie)e=ie;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var n=null;try{n=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===n&&!t.cast)return}e.Promise=te}return te.prototype.then=w,te.all=function(e){return new X(this,e).promise},te.race=function(i){var a=this;return n(i)?new a(function(e,t){for(var n=i.length,r=0;r<n;r++)a.resolve(i[r]).then(e,t)}):new a(function(e,t){return t(new TypeError("You must pass an array to race."))})},te.resolve=S,te.reject=function(e){var t=new this(x);return U(t,e),t},te._setScheduler=function(e){a=e},te._setAsap=function(e){o=e},te._asap=o,te.polyfill=function(){var e=void 0;if(void 0!==ie)e=ie;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var n=null;try{n=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===n&&!t.cast)return}e.Promise=te},te.Promise=te}()}).call(this,n("./node_modules/process/browser.js"),n("./node_modules/webpack/buildin/global.js"))},"./node_modules/fast-deep-equal/index.js":function(e,t,n){var f=Array.isArray,p=Object.keys,m=Object.prototype.hasOwnProperty;e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){var r,i,a,o=f(t),s=f(n);if(o&&s){if((i=t.length)!=n.length)return!1;for(r=i;0!=r--;)if(!e(t[r],n[r]))return!1;return!0}if(o!=s)return!1;var l=t instanceof Date,u=n instanceof Date;if(l!=u)return!1;if(l&&u)return t.getTime()==n.getTime();var c=t instanceof RegExp,d=n instanceof RegExp;if(c!=d)return!1;if(c&&d)return t.toString()==n.toString();var h=p(t);if((i=h.length)!==p(n).length)return!1;for(r=i;0!=r--;)if(!m.call(n,h[r]))return!1;for(r=i;0!=r--;)if(!e(t[a=h[r]],n[a]))return!1;return!0}return t!=t&&n!=n}},"./node_modules/ieee754/index.js":function(e,t){t.read=function(e,t,n,r,i){var a,o,s=8*i-r-1,l=(1<<s)-1,u=l>>1,c=-7,d=n?i-1:0,h=n?-1:1,f=e[t+d];for(d+=h,a=f&(1<<-c)-1,f>>=-c,c+=s;0<c;a=256*a+e[t+d],d+=h,c-=8);for(o=a&(1<<-c)-1,a>>=-c,c+=r;0<c;o=256*o+e[t+d],d+=h,c-=8);if(0===a)a=1-u;else{if(a===l)return o?NaN:1/0*(f?-1:1);o+=Math.pow(2,r),a-=u}return(f?-1:1)*o*Math.pow(2,a-r)},t.write=function(e,t,n,r,i,a){var o,s,l,u=8*a-i-1,c=(1<<u)-1,d=c>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:a-1,p=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=c):(o=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),2<=(t+=1<=o+d?h/l:h*Math.pow(2,1-d))*l&&(o++,l/=2),c<=o+d?(s=0,o=c):1<=o+d?(s=(t*l-1)*Math.pow(2,i),o+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,i),o=0));8<=i;e[n+f]=255&s,f+=p,s/=256,i-=8);for(o=o<<i|s,u+=i;0<u;e[n+f]=255&o,f+=p,o/=256,u-=8);e[n+f-p]|=128*m}},"./node_modules/imsc/src/main/js/doc.js":function(e,t,n){function c(e,t,n,r){var i=r&&"seq"===r.timeContainer,a=0;r&&(a=i&&n?n.end:r.begin),t.begin=t.explicit_begin?t.explicit_begin+a:a;var o=t.begin,s=null;for(var l in t.sets)c(e,t.sets[l],s,t),o="seq"===t.timeContainer?t.sets[l].end:Math.max(o,t.sets[l].end),s=t.sets[l];if("contents"in t)for(var u in t.contents)c(e,t.contents[u],s,t),o="seq"===t.timeContainer?t.contents[u].end:Math.max(o,t.contents[u].end),s=t.contents[u];else o=i?t.begin:Number.POSITIVE_INFINITY;null!==t.explicit_end&&null!==t.explicit_dur?t.end=Math.min(t.begin+t.explicit_dur,a+t.explicit_end):null===t.explicit_end&&null!==t.explicit_dur?t.end=t.begin+t.explicit_dur:null!==t.explicit_end&&null===t.explicit_dur?t.end=a+t.explicit_end:t.end=o,delete t.explicit_begin,delete t.explicit_dur,delete t.explicit_end,e._registerEvent(t)}function b(e){this.node=e}function E(){this.events=[],this.head=null,this.body=null}function T(){this.styling=null,this.layout=null}function A(){this.styles={}}function w(){this.id=null,this.styleAttrs=null,this.styleRefs=null}function S(){this.regions={}}function r(e){this.kind=e}function i(e){this.id=e}function a(e){this.regionID=e}function o(e){this.styleAttrs=e}function s(e){this.sets=e}function l(e){this.contents=e}function u(e,t,n){this.explicit_begin=e,this.explicit_end=t,this.explicit_dur=n}function C(){r.call(this,"body")}function x(){r.call(this,"div")}function M(){r.call(this,"p")}function R(){r.call(this,"span")}function d(){r.call(this,"span")}function I(){r.call(this,"br")}function P(){}function D(){}function h(e){return e&&"xml:id"in e.attributes&&e.attributes["xml:id"].value||null}function f(e){return e&&"style"in e.attributes?e.attributes.style.value.split(" "):[]}function p(e,t){var n={};if(null!==e)for(var r in e.attributes){var i=e.attributes[r].uri+" "+e.attributes[r].local,a=U.byQName[i];if(void 0!==a){var o=a.parse(e.attributes[r].value);null!==o?(n[i]=o,a===U.byName.zIndex&&y(t,"zIndex attribute present but not used by IMSC1 since regions do not overlap")):N(t,"Cannot parse styling attribute "+i+" --\x3e "+e.attributes[r].value)}}return n}function m(e,t,n){for(var r in e.attributes)if(e.attributes[r].uri===t&&e.attributes[r].local===n)return e.attributes[r].value;return null}function g(e,t,n){var r,i=null;return null!==(r=/^(\d+(?:\.\d+)?)f$/.exec(n))?null!==t&&(i=parseFloat(r[1])/t):null!==(r=/^(\d+(?:\.\d+)?)t$/.exec(n))?null!==e&&(i=parseFloat(r[1])/e):null!==(r=/^(\d+(?:\.\d+)?)ms$/.exec(n))?i=parseFloat(r[1])/1e3:null!==(r=/^(\d+(?:\.\d+)?)s$/.exec(n))?i=parseFloat(r[1]):null!==(r=/^(\d+(?:\.\d+)?)h$/.exec(n))?i=3600*parseFloat(r[1]):null!==(r=/^(\d+(?:\.\d+)?)m$/.exec(n))?i=60*parseFloat(r[1]):null!==(r=/^(\d{2,}):(\d\d):(\d\d(?:\.\d+)?)$/.exec(n))?i=3600*parseInt(r[1])+60*parseInt(r[2])+parseFloat(r[3]):null!==(r=/^(\d{2,}):(\d\d):(\d\d)\:(\d{2,})$/.exec(n))&&null!==t&&(i=3600*parseInt(r[1])+60*parseInt(r[2])+parseInt(r[3])+(null===r[4]?0:parseInt(r[4])/t)),i}function L(e,t,n){for(;0<t.styleRefs.length;){var r=t.styleRefs.pop();r in e.styles?(L(e,e.styles[r],n),O(e.styles[r].styleAttrs,t.styleAttrs)):N(n,"Non-existant style id referenced")}}function v(e,t,n,r){for(var i=t.length-1;0<=i;i--){var a=t[i];a in e.styles?O(e.styles[a].styleAttrs,n):N(r,"Non-existant style id referenced")}}function O(e,t){for(var n in e)n in t||(t[n]=e[n])}function y(e,t){if(e&&e.warn&&e.warn(t))throw t}function N(e,t){if(e&&e.error&&e.error(t))throw t}function k(e,t){throw e&&e.fatal&&e.fatal(t),t}function _(e,t){for(var n,r=0,i=e.length-1;r<=i;){var a=e[n=Math.floor((r+i)/2)];if(a<t)r=n+1;else{if(!(t<a))return{found:!0,index:n};i=n-1}}return{found:!1,index:r}}var B,F,j,U,H;B=t,F="undefined"==typeof sax?n("./node_modules/sax/lib/sax.js"):sax,j="undefined"==typeof imscNames?n("./node_modules/imsc/src/main/js/names.js"):imscNames,U="undefined"==typeof imscStyles?n("./node_modules/imsc/src/main/js/styles.js"):imscStyles,H="undefined"==typeof imscUtils?n("./node_modules/imsc/src/main/js/utils.js"):imscUtils,B.fromXML=function(e,f,p){var t=F.parser(!0,{xmlns:!0}),m=[],g=[],v=[],y=0,_=null;t.onclosetag=function(e){if(m[0]instanceof A)for(var t in m[0].styles)L(m[0],m[0].styles[t],f);else if(m[0]instanceof M||m[0]instanceof R){if(1<m[0].contents.length){var n,r=[m[0].contents[0]];for(n=1;n<m[0].contents.length;n++)m[0].contents[n]instanceof d&&r[r.length-1]instanceof d?r[r.length-1].text+=m[0].contents[n].text:r.push(m[0].contents[n]);m[0].contents=r}m[0]instanceof R&&1===m[0].contents.length&&m[0].contents[0]instanceof d&&(m[0].text=m[0].contents[0].text,delete m[0].contents)}else m[0]instanceof b&&(m[0].node.uri===j.ns_tt&&"metadata"===m[0].node.local?y--:0<y&&p&&"onCloseTag"in p&&p.onCloseTag());v.shift(),g.shift(),m.shift()},t.ontext=function(e){if(void 0!==m[0])if(m[0]instanceof R||m[0]instanceof M){var t=new d;t.initFromText(_,m[0],e,v[0],f),m[0].contents.push(t)}else m[0]instanceof b&&0<y&&p&&"onText"in p&&p.onText(e)},t.onopentag=function(e){var t=e.attributes["xml:space"];t?v.unshift(t.value):0===v.length?v.unshift("default"):v.unshift(v[0]);var n=e.attributes["xml:lang"];if(n?g.unshift(n.value):0===g.length?g.unshift(""):g.unshift(g[0]),e.uri===j.ns_tt)if("tt"===e.local)null!==_&&k(f,"Two <tt> elements at ("+this.line+","+this.column+")"),(_=new E).initFromNode(e,f),m.unshift(_);else if("head"===e.local)m[0]instanceof E||k(f,"Parent of <head> element is not <tt> at ("+this.line+","+this.column+")"),null!==_.head&&k("Second <head> element at ("+this.line+","+this.column+")"),_.head=new T,m.unshift(_.head);else if("styling"===e.local)m[0]instanceof T||k(f,"Parent of <styling> element is not <head> at ("+this.line+","+this.column+")"),null!==_.head.styling&&k("Second <styling> element at ("+this.line+","+this.column+")"),_.head.styling=new A,m.unshift(_.head.styling);else if("style"===e.local){var r;m[0]instanceof A?((r=new w).initFromNode(e,f),r.id?_.head.styling.styles[r.id]=r:N(f,"<style> element missing @id attribute"),m.unshift(r)):m[0]instanceof P?((r=new w).initFromNode(e,f),O(r.styleAttrs,m[0].styleAttrs),m.unshift(r)):k(f,"Parent of <style> element is not <styling> or <region> at ("+this.line+","+this.column+")")}else if("layout"===e.local)m[0]instanceof T||k(f,"Parent of <layout> element is not <head> at "+this.line+","+this.column+")"),null!==_.head.layout&&k(f,"Second <layout> element at "+this.line+","+this.column+")"),_.head.layout=new S,m.unshift(_.head.layout);else if("region"===e.local){m[0]instanceof S||k(f,"Parent of <region> element is not <layout> at "+this.line+","+this.column+")");var i=new P;i.initFromNode(_,e,f),!i.id||i.id in _.head.layout.regions?N(f,"Ignoring <region> with duplicate or missing @id at "+this.line+","+this.column+")"):_.head.layout.regions[i.id]=i,m.unshift(i)}else if("body"===e.local){m[0]instanceof E||k(f,"Parent of <body> element is not <tt> at "+this.line+","+this.column+")"),null!==_.body&&k(f,"Second <body> element at "+this.line+","+this.column+")");var a=new C;a.initFromNode(_,e,f),_.body=a,m.unshift(a)}else if("div"===e.local){m[0]instanceof x||m[0]instanceof C||k(f,"Parent of <div> element is not <body> or <div> at "+this.line+","+this.column+")");var o=new x;o.initFromNode(_,m[0],e,f),m[0].contents.push(o),m.unshift(o)}else if("p"===e.local){m[0]instanceof x||k(f,"Parent of <p> element is not <div> at "+this.line+","+this.column+")");var s=new M;s.initFromNode(_,m[0],e,f),m[0].contents.push(s),m.unshift(s)}else if("span"===e.local){m[0]instanceof R||m[0]instanceof M||k(f,"Parent of <span> element is not <span> or <p> at "+this.line+","+this.column+")");var l=new R;l.initFromNode(_,m[0],e,v[0],f),m[0].contents.push(l),m.unshift(l)}else if("br"===e.local){m[0]instanceof R||m[0]instanceof M||k(f,"Parent of <br> element is not <span> or <p> at "+this.line+","+this.column+")");var u=new I;u.initFromNode(_,m[0],e,f),m[0].contents.push(u),m.unshift(u)}else if("set"===e.local){m[0]instanceof R||m[0]instanceof M||m[0]instanceof x||m[0]instanceof C||m[0]instanceof P||m[0]instanceof I||k(f,"Parent of <set> element is not a content element or a region at "+this.line+","+this.column+")");var c=new D;c.initFromNode(_,m[0],e,f),m[0].sets.push(c),m.unshift(c)}else m.unshift(new b(e));else m.unshift(new b(e));if(m[0]instanceof b)if(e.uri===j.ns_tt&&"metadata"===e.local)y++;else if(0<y&&p&&"onOpenTag"in p){var d=[];for(var h in e.attributes)d[e.attributes[h].uri+" "+e.attributes[h].local]={uri:e.attributes[h].uri,local:e.attributes[h].local,value:e.attributes[h].value};p.onOpenTag(e.uri,e.local,d)}},t.write(e).close(),null!==_.head?delete _.head.styling:_.head=new T,null===_.head.layout&&(_.head.layout=new S);var n=!1;for(var r in _.head.layout.regions){n=!0;break}if(!n){var i=P.prototype.createDefaultRegion();_.head.layout.regions[i.id]=i}for(var a in _.head.layout.regions)c(_,_.head.layout.regions[a],null,null);return _.body&&c(_,_.body,null,null),_},E.prototype.initFromNode=function(e,t){this.cellResolution=function(e,t){var n=m(e,j.ns_ttp,"cellResolution"),r=15,i=32;if(null!==n){var a=/(\d+) (\d+)/.exec(n);null!==a?(i=parseInt(a[1]),r=parseInt(a[2])):y(t,"Malformed cellResolution value (using initial value instead)")}return{w:i,h:r}}(e,t);var n=function(e,t){var n,r=m(e,j.ns_ttp,"frameRate"),i=30;if(null!==r){null!==(n=/(\d+)/.exec(r))?i=parseInt(n[1]):y(t,"Malformed frame rate attribute (using initial value instead)")}var a=m(e,j.ns_ttp,"frameRateMultiplier"),o=1;if(null!==a){null!==(n=/(\d+) (\d+)/.exec(a))?o=parseInt(n[1])/parseInt(n[2]):y(t,"Malformed frame rate multiplier attribute (using initial value instead)")}var s=o*i,l=1,u=m(e,j.ns_ttp,"tickRate");if(null===u)null!==r&&(l=s);else{null!==(n=/(\d+)/.exec(u))?l=parseInt(n[1]):y(t,"Malformed tick rate attribute (using initial value instead)")}return{effectiveFrameRate:s,tickRate:l}}(e,t);this.effectiveFrameRate=n.effectiveFrameRate,this.tickRate=n.tickRate,this.aspectRatio=function(e,t){var n=m(e,j.ns_ittp,"aspectRatio"),r=null;if(null!==n){var i=/(\d+) (\d+)/.exec(n);if(null!==i){var a=parseInt(i[1]),o=parseInt(i[2]);0!==a&&0!==o?r=a/o:N(t,"Illegal aspectRatio values (ignoring)")}else N(t,"Malformed aspectRatio attribute (ignoring)")}return r}(e,t);var r=m(e,j.ns_ttp,"timeBase");null!==r&&"media"!==r&&k(t,"Unsupported time base");var i=function(e,t){var n=m(e,j.ns_tts,"extent");if(null===n)return null;var r=n.split(" ");if(2!==r.length)return y(t,"Malformed extent (ignoring)"),null;var i=H.parseLength(r[0]),a=H.parseLength(r[1]);return a&&i?{h:a,w:i}:(y(t,"Malformed extent values (ignoring)"),null)}(e,t);null===i?this.pxDimensions={h:480,w:640}:("px"===i.h.unit&&"px"===i.w.unit||k(t,"Extent on TT must be in px or absent"),this.pxDimensions={h:i.h.value,w:i.w.value})},E.prototype._registerEvent=function(e){if(!(e.end<=e.begin)){var t=_(this.events,e.begin);if(t.found||this.events.splice(t.index,0,e.begin),e.end!==Number.POSITIVE_INFINITY){var n=_(this.events,e.end);n.found||this.events.splice(n.index,0,e.end)}}},E.prototype.getMediaTimeRange=function(){return[this.events[0],this.events[this.events.length-1]]},E.prototype.getMediaTimeEvents=function(){return this.events},w.prototype.initFromNode=function(e,t){this.id=h(e),this.styleAttrs=p(e,t),this.styleRefs=f(e)},i.prototype.initFromNode=function(e,t,n,r){this.id=h(n)},a.prototype.initFromNode=function(e,t,n,r){this.regionID=function(e){return e&&"region"in e.attributes?e.attributes.region.value:""}(n)},o.prototype.initFromNode=function(e,t,n,r){this.styleAttrs=p(n,r),null!==e.head&&null!==e.head.styling&&v(e.head.styling,f(n),this.styleAttrs,r)},s.prototype.initFromNode=function(e,t,n,r){this.sets=[]},l.prototype.initFromNode=function(e,t,n,r){this.contents=[]},u.prototype.initFromNode=function(e,t,n,r){var i=function(e,t,n,r){var i=null;n&&"begin"in n.attributes&&null===(i=g(e.tickRate,e.effectiveFrameRate,n.attributes.begin.value))&&y(r,"Malformed begin value "+n.attributes.begin.value+" (using 0)");var a=null;n&&"dur"in n.attributes&&null===(a=g(e.tickRate,e.effectiveFrameRate,n.attributes.dur.value))&&y(r,"Malformed dur value "+n.attributes.dur.value+" (ignoring)");var o=null;n&&"end"in n.attributes&&null===(o=g(e.tickRate,e.effectiveFrameRate,n.attributes.end.value))&&y(r,"Malformed end value (ignoring)");return{explicit_begin:i,explicit_end:o,explicit_dur:a}}(e,0,n,r);this.explicit_begin=i.explicit_begin,this.explicit_end=i.explicit_end,this.explicit_dur=i.explicit_dur,this.timeContainer=function(e,t){var n=e&&"timeContainer"in e.attributes?e.attributes.timeContainer.value:null;return n&&"par"!==n?"seq"===n?"seq":(N(t,"Illegal value of timeContainer (assuming 'par')"),"par"):"par"}(n,r)},C.prototype.initFromNode=function(e,t,n){o.prototype.initFromNode.call(this,e,null,t,n),u.prototype.initFromNode.call(this,e,null,t,n),s.prototype.initFromNode.call(this,e,null,t,n),a.prototype.initFromNode.call(this,e,null,t,n),l.prototype.initFromNode.call(this,e,null,t,n)},x.prototype.initFromNode=function(e,t,n,r){o.prototype.initFromNode.call(this,e,t,n,r),u.prototype.initFromNode.call(this,e,t,n,r),s.prototype.initFromNode.call(this,e,t,n,r),a.prototype.initFromNode.call(this,e,t,n,r),l.prototype.initFromNode.call(this,e,t,n,r)},M.prototype.initFromNode=function(e,t,n,r){o.prototype.initFromNode.call(this,e,t,n,r),u.prototype.initFromNode.call(this,e,t,n,r),s.prototype.initFromNode.call(this,e,t,n,r),a.prototype.initFromNode.call(this,e,t,n,r),l.prototype.initFromNode.call(this,e,t,n,r)},R.prototype.initFromNode=function(e,t,n,r,i){o.prototype.initFromNode.call(this,e,t,n,i),u.prototype.initFromNode.call(this,e,t,n,i),s.prototype.initFromNode.call(this,e,t,n,i),a.prototype.initFromNode.call(this,e,t,n,i),l.prototype.initFromNode.call(this,e,t,n,i),this.space=r},d.prototype.initFromText=function(e,t,n,r,i){u.prototype.initFromNode.call(this,e,t,null,i),this.text=n,this.space=r},I.prototype.initFromNode=function(e,t,n,r){a.prototype.initFromNode.call(this,e,t,n,r),u.prototype.initFromNode.call(this,e,t,n,r)},P.prototype.createDefaultRegion=function(){var e=new P;return i.call(e,""),o.call(e,{}),s.call(e,[]),u.call(e,0,Number.POSITIVE_INFINITY,null),e},P.prototype.initFromNode=function(e,t,n){i.prototype.initFromNode.call(this,e,null,t,n),o.prototype.initFromNode.call(this,e,null,t,n),u.prototype.initFromNode.call(this,e,null,t,n),s.prototype.initFromNode.call(this,e,null,t,n),null!==e.head&&null!==e.head.styling&&v(e.head.styling,f(t),this.styleAttrs,n)},D.prototype.initFromNode=function(e,t,n,r){u.prototype.initFromNode.call(this,e,t,n,r);var i=p(n,r);for(var a in this.qname=null,this.value=null,i){if(this.qname){N(r,"More than one style specified on set");break}this.qname=a,this.value=i[a]}}},"./node_modules/imsc/src/main/js/html.js":function(e,t,n){!function(e,t,A){function w(e,t,n){var r;if("region"===n.kind?(r=document.createElement("div")).style.position="absolute":"body"===n.kind?r=document.createElement("div"):"div"===n.kind?r=document.createElement("div"):"p"===n.kind?r=document.createElement("p"):"span"===n.kind?r=document.createElement("span"):"br"===n.kind&&(r=document.createElement("br")),r){for(var i in r.style.margin="0",M){var a=M[i],o=n.styleAttrs[a.qname];void 0!==o&&null!==a.map&&a.map(e,r,n,o)}var s=r;if("region"===n.kind){var l=n.styleAttrs[A.byName.writingMode.qname];"lrtb"===l||"lr"===l?(e.ipd="lr",e.bpd="tb"):"rltb"===l||"rl"===l?(e.ipd="rl",e.bpd="tb"):"tblr"===l?(e.ipd="tb",e.bpd="lr"):"tbrl"!==l&&"tb"!==l||(e.ipd="tb",e.bpd="rl")}var u=n.styleAttrs[A.byName.linePadding.qname];if(u&&0<u){var c=Math.ceil(u*e.h)+"px";"tb"===e.bpd?(s.style.paddingLeft=c,s.style.paddingRight=c):(s.style.paddingTop=c,s.style.paddingBottom=c),e.lp=u}var d=n.styleAttrs[A.byName.multiRowAlign.qname];if(d&&"auto"!==d){var h=document.createElement("span");h.style.display="inline-block",h.style.textAlign=d,r.appendChild(h),s=h,e.mra=d}if(n.styleAttrs[A.byName.fillLineGap.qname]&&(e.flg=!0),"span"===n.kind&&n.text)if(e.lp||e.mra||e.flg)for(var f="",p=0;p<n.text.length;p++){f+=n.text.charAt(p);var m=n.text.charCodeAt(p);if(m<55296||56319<m||p===n.text.length){var g=document.createElement("span");g.textContent=f,r.appendChild(g),f=""}}else r.textContent=n.text;for(var v in t.appendChild(r),n.contents)w(e,s,n.contents[v]);var y=[];if((e.lp||e.mra||e.flg)&&"p"===n.kind&&(x(e,s,y,null),e.mra&&(function(e){for(var t=0;t<e.length-1;t++){var n=e[t].elements.length;if(0!==n&&!1===e[t].br){var r=document.createElement("br"),i=e[t].elements[n-1].node;i.parentElement.insertBefore(r,i.nextSibling)}}}(y),e.mra=null),e.lp&&(function(e,t,n){for(var r in e){var i=e[r].elements.length,a=e[r].elements[e[r].start_elem],o=e[r].elements[e[r].end_elem],s=Math.ceil(t)+"px",l="-"+Math.ceil(t)+"px";0!==i&&("lr"===n.ipd?(a.node.style.borderLeftColor=a.bgcolor||"#00000000",a.node.style.borderLeftStyle="solid",a.node.style.borderLeftWidth=s,a.node.style.marginLeft=l):"rl"===n.ipd?(a.node.style.borderRightColor=a.bgcolor||"#00000000",a.node.style.borderRightStyle="solid",a.node.style.borderRightWidth=s,a.node.style.marginRight=l):"tb"===n.ipd&&(a.node.style.borderTopColor=a.bgcolor||"#00000000",a.node.style.borderTopStyle="solid",a.node.style.borderTopWidth=s,a.node.style.marginTop=l),"lr"===n.ipd?(o.node.style.borderRightColor=o.bgcolor||"#00000000",o.node.style.borderRightStyle="solid",o.node.style.borderRightWidth=s,o.node.style.marginRight=l):"rl"===n.ipd?(o.node.style.borderLeftColor=o.bgcolor||"#00000000",o.node.style.borderLeftStyle="solid",o.node.style.borderLeftWidth=s,o.node.style.marginLeft=l):"tb"===n.ipd&&(o.node.style.borderBottomColor=o.bgcolor||"#00000000",o.node.style.borderBottomStyle="solid",o.node.style.borderBottomWidth=s,o.node.style.marginBottom=l))}}(y,e.lp*e.h,e),e.lp=null),e.flg)){var _=C(s.getBoundingClientRect(),e);!function(e,t,n,r){for(var i=Math.sign(n-t),a=0;a<=e.length;a++){var o,s,l;if(o=0===a?t:a===e.length?n:(e[a].before+e[a-1].after)/2,0<a)for(var u=0;u<e[a-1].elements.length;u++)null!==e[a-1].elements[u].bgcolor&&(l=e[a-1].elements[u],i*(l.after-o)<0&&(s=Math.ceil(Math.abs(o-l.after))+"px",l.node.style.backgroundColor=l.bgcolor,"lr"===r.bpd?l.node.style.paddingRight=s:"rl"===r.bpd?l.node.style.paddingLeft=s:"tb"===r.bpd&&(l.node.style.paddingBottom=s)));if(a<e.length)for(var c=0;c<e[a].elements.length;c++)null!==(l=e[a].elements[c]).bgcolor&&0<i*(l.before-o)&&(s=Math.ceil(Math.abs(l.before-o))+"px",l.node.style.backgroundColor=l.bgcolor,"lr"===r.bpd?l.node.style.paddingLeft=s:"rl"===r.bpd?l.node.style.paddingRight=s:"tb"===r.bpd&&(l.node.style.paddingTop=s))}}(y,_.before,_.after,e),e.flg=null}if("region"===n.kind&&(x(e,s,y),"tb"===e.bpd&&e.enableRollUp&&0<n.contents.length&&"after"===n.styleAttrs[A.byName.displayAlign.qname])){var b=new S(""===n.id?"_":n.id,y);if(e.currentISDState[b.id]=b,e.previousISDState&&b.id in e.previousISDState&&0<e.previousISDState[b.id].plist.length&&1<b.plist.length&&b.plist[b.plist.length-2].text===e.previousISDState[b.id].plist[e.previousISDState[b.id].plist.length-1].text){var E=r.firstElementChild,T=b.plist[b.plist.length-1].after-b.plist[b.plist.length-1].before;E.style.bottom="-"+T+"px",E.style.transition="transform 0.4s",E.style.position="relative",E.style.transform="translateY(-"+T+"px)"}}}else!function(e,t){if(e&&e.error&&e.error(t))throw t}(e.errorHandler,"Error processing ISD element kind: "+n.kind)}function S(e,t){this.id=e,this.plist=t}function C(e,t){var n={before:null,after:null,start:null,end:null};return"tb"===t.bpd?(n.before=e.top,n.after=e.bottom,"lr"===t.ipd?(n.start=e.left,n.end=e.right):(n.start=e.right,n.end=e.left)):"lr"===t.bpd?(n.before=e.left,n.after=e.right,n.start=e.top,n.end=e.bottom):"rl"===t.bpd&&(n.before=e.right,n.after=e.left,n.start=e.top,n.end=e.bottom),n}function x(e,t,n,r){var i=t.style.backgroundColor||r;if(0===t.childElementCount)if("span"===t.localName){var a=t.getBoundingClientRect();if(0===a.height||0===a.width)return;var o=C(a,e);if(0!==n.length&&function(e,t,n,r){return t<r&&n<e||r<=t&&e<=n}(o.before,o.after,n[n.length-1].before,n[n.length-1].after)){var s=Math.sign(o.after-o.before),l=Math.sign(o.end-o.start);s*(o.before-n[n.length-1].before)<0&&(n[n.length-1].before=o.before),0<s*(o.after-n[n.length-1].after)&&(n[n.length-1].after=o.after),l*(o.start-n[n.length-1].start)<0&&(n[n.length-1].start=o.start,n[n.length-1].start_elem=n[n.length-1].elements.length),0<l*(o.end-n[n.length-1].end)&&(n[n.length-1].end=o.end,n[n.length-1].end_elem=n[n.length-1].elements.length)}else n.push({before:o.before,after:o.after,start:o.start,end:o.end,start_elem:0,end_elem:0,elements:[],text:"",br:!1});n[n.length-1].text+=t.textContent,n[n.length-1].elements.push({node:t,bgcolor:i,before:o.before,after:o.after})}else"br"===t.localName&&0!==n.length&&(n[n.length-1].br=!0);else for(var u=t.firstChild;u;)u.nodeType===Node.ELEMENT_NODE&&x(e,u,n,i),u=u.nextSibling}function n(e,t){this.qname=e,this.map=t}e.render=function(e,t,n,r,i,a,o,s,l){var u=r||t.clientHeight,c=i||t.clientWidth;if(null!==e.aspectRatio){var d=u*e.aspectRatio;c<d?u=Math.round(c/e.aspectRatio):c=d}var h=document.createElement("div");h.style.position="relative",h.style.width=c+"px",h.style.height=u+"px",h.style.margin="auto",h.style.top=0,h.style.bottom=0,h.style.left=0,h.style.right=0,h.style.zIndex=0;var f={h:u,w:c,regionH:null,regionW:null,imgResolver:n,displayForcedOnlyMode:a||!1,isd:e,errorHandler:o,previousISDState:s,enableRollUp:l||!1,currentISDState:{},flg:null,lp:null,mra:null,ipd:null,bpd:null};for(var p in t.appendChild(h),e.contents)w(f,h,e.contents[p]);return f.currentISDState};var M=[new n("http://www.w3.org/ns/ttml#styling backgroundColor",function(e,t,n,r){0!==r[3]&&(t.style.backgroundColor="rgba("+r[0].toString()+","+r[1].toString()+","+r[2].toString()+","+(r[3]/255).toString()+")")}),new n("http://www.w3.org/ns/ttml#styling color",function(e,t,n,r){t.style.color="rgba("+r[0].toString()+","+r[1].toString()+","+r[2].toString()+","+(r[3]/255).toString()+")"}),new n("http://www.w3.org/ns/ttml#styling direction",function(e,t,n,r){t.style.direction=r}),new n("http://www.w3.org/ns/ttml#styling display",function(e,t,n,r){}),new n("http://www.w3.org/ns/ttml#styling displayAlign",function(e,t,n,r){t.style.display="flex",t.style.flexDirection="column","before"===r?t.style.justifyContent="flex-start":"center"===r?t.style.justifyContent="center":"after"===r&&(t.style.justifyContent="flex-end")}),new n("http://www.w3.org/ns/ttml#styling extent",function(e,t,n,r){e.regionH=r.h*e.h,e.regionW=r.w*e.w;var i=0,a=0,o=n.styleAttrs["http://www.w3.org/ns/ttml#styling padding"];o&&(i=(o[0]+o[2])*e.h,a=(o[1]+o[3])*e.w),t.style.height=e.regionH-i+"px",t.style.width=e.regionW-a+"px"}),new n("http://www.w3.org/ns/ttml#styling fontFamily",function(e,t,n,r){var i=[];for(var a in r)"monospaceSerif"===r[a]?(i.push("Courier New"),i.push('"Liberation Mono"'),i.push("Courier"),i.push("monospace")):"proportionalSansSerif"===r[a]?(i.push("Arial"),i.push("Helvetica"),i.push('"Liberation Sans"'),i.push("sans-serif")):"monospace"===r[a]?i.push("monospace"):"sansSerif"===r[a]?i.push("sans-serif"):"serif"===r[a]?i.push("serif"):"monospaceSansSerif"===r[a]?(i.push("Consolas"),i.push("monospace")):"proportionalSerif"===r[a]?i.push("serif"):i.push(r[a]);t.style.fontFamily=i.join(",")}),new n("http://www.w3.org/ns/ttml#styling fontSize",function(e,t,n,r){t.style.fontSize=r*e.h+"px"}),new n("http://www.w3.org/ns/ttml#styling fontStyle",function(e,t,n,r){t.style.fontStyle=r}),new n("http://www.w3.org/ns/ttml#styling fontWeight",function(e,t,n,r){t.style.fontWeight=r}),new n("http://www.w3.org/ns/ttml#styling lineHeight",function(e,t,n,r){t.style.lineHeight="normal"===r?"normal":r*e.h+"px"}),new n("http://www.w3.org/ns/ttml#styling opacity",function(e,t,n,r){t.style.opacity=r}),new n("http://www.w3.org/ns/ttml#styling origin",function(e,t,n,r){t.style.top=r.h*e.h+"px",t.style.left=r.w*e.w+"px"}),new n("http://www.w3.org/ns/ttml#styling overflow",function(e,t,n,r){t.style.overflow=r}),new n("http://www.w3.org/ns/ttml#styling padding",function(e,t,n,r){var i=[];i[0]=r[0]*e.h+"px",i[1]=r[3]*e.w+"px",i[2]=r[2]*e.h+"px",i[3]=r[1]*e.w+"px",t.style.padding=i.join(" ")}),new n("http://www.w3.org/ns/ttml#styling showBackground",null),new n("http://www.w3.org/ns/ttml#styling textAlign",function(e,t,n,r){var i,a=n.styleAttrs[A.byName.direction.qname];i="start"===r?"rtl"===a?"right":"left":"end"===r?"rtl"===a?"left":"right":r,t.style.textAlign=i}),new n("http://www.w3.org/ns/ttml#styling textDecoration",function(e,t,n,r){t.style.textDecoration=r.join(" ").replace("lineThrough","line-through")}),new n("http://www.w3.org/ns/ttml#styling textOutline",function(e,t,n,r){t.style.textShadow="none"===r?"":"rgba("+r.color[0].toString()+","+r.color[1].toString()+","+r.color[2].toString()+","+(r.color[3]/255).toString()+") 0px 0px "+r.thickness*e.h+"px"}),new n("http://www.w3.org/ns/ttml#styling unicodeBidi",function(e,t,n,r){var i;i="bidiOverride"===r?"bidi-override":r,t.style.unicodeBidi=i}),new n("http://www.w3.org/ns/ttml#styling visibility",function(e,t,n,r){t.style.visibility=r}),new n("http://www.w3.org/ns/ttml#styling wrapOption",function(e,t,n,r){"wrap"===r?"preserve"===n.space?t.style.whiteSpace="pre-wrap":t.style.whiteSpace="normal":"preserve"===n.space?t.style.whiteSpace="pre":t.style.whiteSpace="noWrap"}),new n("http://www.w3.org/ns/ttml#styling writingMode",function(e,t,n,r){"lrtb"===r||"lr"===r?t.style.writingMode="horizontal-tb":"rltb"===r||"rl"===r?t.style.writingMode="horizontal-tb":"tblr"===r?t.style.writingMode="vertical-lr":"tbrl"!==r&&"tb"!==r||(t.style.writingMode="vertical-rl")}),new n("http://www.w3.org/ns/ttml#styling zIndex",function(e,t,n,r){t.style.zIndex=r}),new n("http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt backgroundImage",function(e,t,n,r){if(null!==e.imgResolver&&null!==r){var i=document.createElement("img"),a=e.imgResolver(r,i);a&&(i.src=a),i.height=e.regionH,i.width=e.regionW,t.appendChild(i)}}),new n("http://www.w3.org/ns/ttml/profile/imsc1#styling forcedDisplay",function(e,t,n,r){e.displayForcedOnlyMode&&!1===r&&(t.style.visibility="hidden")})],r={};for(var i in M)r[M[i].qname]=M[i]}(t,"undefined"==typeof imscNames&&n("./node_modules/imsc/src/main/js/names.js"),"undefined"==typeof imscStyles?n("./node_modules/imsc/src/main/js/styles.js"):imscStyles)},"./node_modules/imsc/src/main/js/isd.js":function(e,t,n){function O(e,t,n,r,i,a,o,s,l){if(t<o.begin||t>=o.end)return null;var u="regionID"in o&&""!==o.regionID?o.regionID:a;if(null!==i&&u!==n.id&&(!("contents"in o)||"contents"in o&&0===o.contents.length||""!==u))return null;var c=new N(o);for(var d in o.sets)t<o.sets[d].begin||t>=o.sets[d].end||(c.styleAttrs[o.sets[d].qname]=o.sets[d].value);var h,f={};for(var p in c.styleAttrs)if(f[p]=!0,p===B.byName.writingMode.qname&&!(B.byName.direction.qname in c.styleAttrs)){var m=c.styleAttrs[p];"lrtb"===m||"lr"===m?c.styleAttrs[B.byName.direction.qname]="ltr":"rltb"!==m&&"rl"!==m||(c.styleAttrs[B.byName.direction.qname]="rtl")}if(null!==i)for(var g in B.all){var v=B.all[g];if(v.qname===B.byName.textDecoration.qname){var y=i.styleAttrs[v.qname],_=c.styleAttrs[v.qname],b=[];void 0===_?b=y:-1===_.indexOf("none")?((-1===_.indexOf("noUnderline")&&-1!==y.indexOf("underline")||-1!==_.indexOf("underline"))&&b.push("underline"),(-1===_.indexOf("noLineThrough")&&-1!==y.indexOf("lineThrough")||-1!==_.indexOf("lineThrough"))&&b.push("lineThrough"),(-1===_.indexOf("noOverline")&&-1!==y.indexOf("overline")||-1!==_.indexOf("overline"))&&b.push("overline")):b.push("none"),c.styleAttrs[v.qname]=b}else v.inherit&&v.qname in i.styleAttrs&&!(v.qname in c.styleAttrs)&&(c.styleAttrs[v.qname]=i.styleAttrs[v.qname])}for(var E in B.all){var T=B.all[E];T.qname in c.styleAttrs||("region"===c.kind||!1===T.inherit&&null!==T.initial)&&(c.styleAttrs[T.qname]=T.parse(T.initial),f[T.qname]=!0)}for(var A in B.all){var w=B.all[A];if(w.qname in f&&null!==w.compute){var S=w.compute(e,i,c,c.styleAttrs[w.qname],l);null!==S?c.styleAttrs[w.qname]=S:k(s,"Style '"+w.qname+"' on element '"+c.kind+"' cannot be computed")}}if("none"===c.styleAttrs[B.byName.display.qname])return null;for(var C in null===i?h=null===r?[]:[r]:"contents"in o&&(h=o.contents),h){var x=O(e,t,n,r,c,u,h[C],s,l);null!==x&&c.contents.push(x.element)}for(var M in c.styleAttrs){-1===B.byQName[M].applies.indexOf(c.kind)&&delete c.styleAttrs[M]}if("span"===c.kind&&c.text&&"default"===c.space){var R=c.text.replace(/\s+/g," ");c.text=R}if("p"===c.kind){var I=[];!function e(t,n){if("contents"in t)for(var r in t.contents)e(t.contents[r],n);else n.push(t)}(c,I);for(var P=0,D="after_br",L=0;;)if("after_br"===D)P>=I.length||"br"===I[P].kind?(D="before_br",L=P,P--):("preserve"!==I[P].space&&(I[P].text=I[P].text.replace(/^\s+/g,"")),0<I[P].text.length?(D="looking_br",P++):I.splice(P,1));else if("before_br"===D)if(P<0||"br"===I[P].kind){if(D="after_br",(P=L+1)>=I.length)break}else if("preserve"!==I[P].space&&(I[P].text=I[P].text.replace(/\s+$/g,"")),0<I[P].text.length){if(D="after_br",(P=L+1)>=I.length)break}else I.splice(P,1),P--;else P>=I.length||"br"===I[P].kind?(D="before_br",L=P,P--):P++;!function e(t){{if("br"===t.kind)return!1;if("text"in t)return 0===t.text.length;if("contents"in t){for(var n=t.contents.length;n--;)e(t.contents[n])&&t.contents.splice(n,1);return 0===t.contents.length}}}(c)}return"div"===c.kind&&B.byName.backgroundImage.qname in c.styleAttrs||"br"===c.kind||"contents"in c&&0<c.contents.length||"span"===c.kind&&null!==c.text||"region"===c.kind&&"always"===c.styleAttrs[B.byName.showBackground.qname]?{region_id:u,element:c}:null}function s(e){this.contents=[],this.aspectRatio=e.aspectRatio}function N(e){for(var t in this.kind=e.kind||"region",e.id&&(this.id=e.id),this.styleAttrs={},e.styleAttrs)this.styleAttrs[t]=e.styleAttrs[t];"text"in e?this.text=e.text:"br"!==e.kind&&(this.contents=[]),"space"in e&&(this.space=e.space)}function k(e,t){if(e&&e.error&&e.error(t))throw t}var r,B;r=t,"undefined"==typeof imscNames&&n("./node_modules/imsc/src/main/js/names.js"),B="undefined"==typeof imscStyles?n("./node_modules/imsc/src/main/js/styles.js"):imscStyles,r.generateISD=function(e,t,n){var r=new s(e),i={};for(var a in e.head.layout.regions){var o=O(e,t,e.head.layout.regions[a],e.body,null,"",e.head.layout.regions[a],n,i);null!==o&&r.contents.push(o.element)}return r}},"./node_modules/imsc/src/main/js/main.js":function(e,t,n){t.generateISD=n("./node_modules/imsc/src/main/js/isd.js").generateISD,t.fromXML=n("./node_modules/imsc/src/main/js/doc.js").fromXML,t.renderHTML=n("./node_modules/imsc/src/main/js/html.js").render},"./node_modules/imsc/src/main/js/names.js":function(e,t,n){var r;(r=t).ns_tt="http://www.w3.org/ns/ttml",r.ns_tts="http://www.w3.org/ns/ttml#styling",r.ns_ttp="http://www.w3.org/ns/ttml#parameter",r.ns_xml="http://www.w3.org/XML/1998/namespace",r.ns_itts="http://www.w3.org/ns/ttml/profile/imsc1#styling",r.ns_ittp="http://www.w3.org/ns/ttml/profile/imsc1#parameter",r.ns_smpte="http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt",r.ns_ebutts="urn:ebu:tt:style"},"./node_modules/imsc/src/main/js/styles.js":function(e,t,n){!function(u,e,a){function t(e,t,n,r,i,a,o,s){this.name=t,this.ns=e,this.qname=e+" "+t,this.inherit=i,this.animatable=a,this.initial=n,this.applies=r,this.parse=o,this.compute=s}for(var n in u.all=[new t(e.ns_tts,"backgroundColor","transparent",["body","div","p","region","span"],!1,!0,a.parseColor,null),new t(e.ns_tts,"color","white",["span"],!0,!0,a.parseColor,null),new t(e.ns_tts,"direction","ltr",["p","span"],!0,!0,function(e){return e},null),new t(e.ns_tts,"display","auto",["body","div","p","region","span"],!1,!0,function(e){return e},null),new t(e.ns_tts,"displayAlign","before",["region"],!1,!0,function(e){return e},null),new t(e.ns_tts,"extent","auto",["tt","region"],!1,!0,function(e){if("auto"===e)return e;var t=e.split(" ");if(2!==t.length)return null;var n=a.parseLength(t[0]),r=a.parseLength(t[1]);return r&&n?{h:r,w:n}:null},function(e,t,n,r,i){var a,o;if("auto"===r)a=1;else if("%"===r.h.unit)a=r.h.value/100;else{if("px"!==r.h.unit)return null;a=r.h.value/e.pxDimensions.h}if("auto"===r)o=1;else if("%"===r.w.unit)o=r.w.value/100;else{if("px"!==r.w.unit)return null;o=r.w.value/e.pxDimensions.w}return{h:a,w:o}}),new t(e.ns_tts,"fontFamily","default",["span"],!0,!0,function(e){var t=e.split(","),n=[];for(var r in t)"'"!==t[r].charAt(0)&&'"'!==t[r].charAt(0)&&"default"===t[r]?n.push("monospaceSerif"):n.push(t[r]);return n},null),new t(e.ns_tts,"fontSize","1c",["span"],!0,!0,a.parseLength,function(e,t,n,r,i){var a;if("%"===r.unit)a=null!==t?t.styleAttrs[u.byName.fontSize.qname]*r.value/100:r.value/100/e.cellResolution.h;else if("em"===r.unit)a=null!==t?t.styleAttrs[u.byName.fontSize.qname]*r.value:r.value/e.cellResolution.h;else if("c"===r.unit)a=r.value/e.cellResolution.h;else{if("px"!==r.unit)return null;a=r.value/e.pxDimensions.h}return a}),new t(e.ns_tts,"fontStyle","normal",["span"],!0,!0,function(e){return e},null),new t(e.ns_tts,"fontWeight","normal",["span"],!0,!0,function(e){return e},null),new t(e.ns_tts,"lineHeight","normal",["p"],!0,!0,function(e){return"normal"===e?e:a.parseLength(e)},function(e,t,n,r,i){var a;if("normal"===r)a=r;else if("%"===r.unit)a=n.styleAttrs[u.byName.fontSize.qname]*r.value/100;else if("em"===r.unit)a=n.styleAttrs[u.byName.fontSize.qname]*r.value;else if("c"===r.unit)a=r.value/e.cellResolution.h;else{if("px"!==r.unit)return null;a=r.value/e.pxDimensions.h}return a}),new t(e.ns_tts,"opacity",1,["region"],!1,!0,parseFloat,null),new t(e.ns_tts,"origin","auto",["region"],!1,!0,function(e){if("auto"===e)return e;var t=e.split(" ");if(2!==t.length)return null;var n=a.parseLength(t[0]),r=a.parseLength(t[1]);return r&&n?{h:r,w:n}:null},function(e,t,n,r,i){var a,o;if("auto"===r)a=0;else if("%"===r.h.unit)a=r.h.value/100;else{if("px"!==r.h.unit)return null;a=r.h.value/e.pxDimensions.h}if("auto"===r)o=0;else if("%"===r.w.unit)o=r.w.value/100;else{if("px"!==r.w.unit)return null;o=r.w.value/e.pxDimensions.w}return{h:a,w:o}}),new t(e.ns_tts,"overflow","hidden",["region"],!1,!0,function(e){return e},null),new t(e.ns_tts,"padding","0px",["region"],!1,!0,function(e){var t=e.split(" ");if(4<t.length)return null;var n=[];for(var r in t){var i=a.parseLength(t[r]);if(!i)return null;n.push(i)}return n},function(e,t,n,r,i){var a;if(1===r.length)a=[r[0],r[0],r[0],r[0]];else if(2===r.length)a=[r[0],r[1],r[0],r[1]];else if(3===r.length)a=[r[0],r[1],r[2],r[1]];else{if(4!==r.length)return null;a=[r[0],r[1],r[2],r[3]]}var o=n.styleAttrs[u.byName.writingMode.qname];if("lrtb"===o||"lr"===o)a=[a[0],a[3],a[2],a[1]];else if("rltb"===o||"rl"===o)a=[a[0],a[1],a[2],a[3]];else if("tblr"===o)a=[a[3],a[0],a[1],a[2]];else{if("tbrl"!==o&&"tb"!==o)return null;a=[a[3],a[2],a[1],a[0]]}var s=[];for(var l in a)if(0===a[l].value)s[l]=0;else if("%"===a[l].unit)s[l]="0"===l||"2"===l?n.styleAttrs[u.byName.extent.qname].h*a[l].value/100:n.styleAttrs[u.byName.extent.qname].w*a[l].value/100;else if("em"===a[l].unit)s[l]=n.styleAttrs[u.byName.fontSize.qname]*a[l].value;else if("c"===a[l].unit)s[l]=a[l].value/e.cellResolution.h;else{if("px"!==a[l].unit)return null;s[l]="0"===l||"2"===l?a[l].value/e.pxDimensions.h:a[l].value/e.pxDimensions.w}return s}),new t(e.ns_tts,"showBackground","always",["region"],!1,!0,function(e){return e},null),new t(e.ns_tts,"textAlign","start",["p"],!0,!0,function(e){return e},function(e,t,n,r,i){return"left"===r?"start":"right"===r?"end":r}),new t(e.ns_tts,"textDecoration","none",["span"],!0,!0,function(e){return e.split(" ")},null),new t(e.ns_tts,"textOutline","none",["span"],!0,!0,function(e){if("none"===e)return e;var t={},n=e.split(" ");if(0===n.length||2<n.length)return null;var r=a.parseColor(n[0]);if(null!==(t.color=r)&&n.shift(),1!==n.length)return null;var i=a.parseLength(n[0]);return i?(t.thickness=i,t):null},function(e,t,n,r,i){if("none"===r)return r;var a={};if(null===r.color?a.color=n.styleAttrs[u.byName.color.qname]:a.color=r.color,"%"===r.thickness.unit)a.thickness=n.styleAttrs[u.byName.fontSize.qname]*r.thickness.value/100;else if("em"===r.thickness.unit)a.thickness=n.styleAttrs[u.byName.fontSize.qname]*r.thickness.value;else if("c"===r.thickness.unit)a.thickness=r.thickness.value/e.cellResolution.h;else{if("px"!==r.thickness.unit)return null;a.thickness=r.thickness.value/e.pxDimensions.h}return a}),new t(e.ns_tts,"unicodeBidi","normal",["span","p"],!1,!0,function(e){return e},null),new t(e.ns_tts,"visibility","visible",["body","div","p","region","span"],!0,!0,function(e){return e},null),new t(e.ns_tts,"wrapOption","wrap",["span"],!0,!0,function(e){return e},null),new t(e.ns_tts,"writingMode","lrtb",["region"],!1,!0,function(e){return e},null),new t(e.ns_tts,"zIndex","auto",["region"],!1,!0,function(e){var t;return"auto"===e?t=e:(t=parseInt(e),isNaN(t)&&(t=null)),t},null),new t(e.ns_ebutts,"linePadding","0c",["p"],!0,!1,a.parseLength,function(e,t,n,r,i){return"c"===r.unit?r.value/e.cellResolution.h:null}),new t(e.ns_ebutts,"multiRowAlign","auto",["p"],!0,!1,function(e){return e},null),new t(e.ns_smpte,"backgroundImage",null,["div"],!1,!1,function(e){return e},null),new t(e.ns_itts,"forcedDisplay","false",["body","div","p","region","span"],!0,!0,function(e){return"true"===e},null),new t(e.ns_itts,"fillLineGap","false",["p"],!0,!0,function(e){return"true"===e},null)],u.byQName={},u.all)u.byQName[u.all[n].qname]=u.all[n];for(var r in u.byName={},u.all)u.byName[u.all[r].name]=u.all[r]}(t,"undefined"==typeof imscNames?n("./node_modules/imsc/src/main/js/names.js"):imscNames,"undefined"==typeof imscUtils?n("./node_modules/imsc/src/main/js/utils.js"):imscUtils)},"./node_modules/imsc/src/main/js/utils.js":function(e,t,n){!function(e){var i=/#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})?/,a=/rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,o=/rgba\(\s*(\d+),\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,s={transparent:[0,0,0,0],black:[0,0,0,255],silver:[192,192,192,255],gray:[128,128,128,255],white:[255,255,255,255],maroon:[128,0,0,255],red:[255,0,0,255],purple:[128,0,128,255],fuchsia:[255,0,255,255],magenta:[255,0,255,255],green:[0,128,0,255],lime:[0,255,0,255],olive:[128,128,0,255],yellow:[255,255,0,255],navy:[0,0,128,255],blue:[0,0,255,255],teal:[0,128,128,255],aqua:[0,255,255,255],cyan:[0,255,255,255]};e.parseColor=function(e){var t,n=null,r=s[e.toLowerCase()];return void 0!==r?n=r:null!==(t=i.exec(e))?n=[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16),void 0!==t[4]?parseInt(t[4],16):255]:null!==(t=a.exec(e))?n=[parseInt(t[1]),parseInt(t[2]),parseInt(t[3]),255]:null!==(t=o.exec(e))&&(n=[parseInt(t[1]),parseInt(t[2]),parseInt(t[3]),parseInt(t[4])]),n};var r=/^((?:\+|\-)?\d*(?:\.\d+)?)(px|em|c|%)$/;e.parseLength=function(e){var t,n=null;return null!==(t=r.exec(e))&&(n={value:parseFloat(t[1]),unit:t[2]}),n}}(t)},"./node_modules/inherits/inherits_browser.js":function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;function n(){}n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},"./node_modules/isarray/index.js":function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},"./node_modules/node-libs-browser/node_modules/buffer/index.js":function(e,j,U){(function(e){var r=U("./node_modules/base64-js/index.js"),a=U("./node_modules/ieee754/index.js"),o=U("./node_modules/isarray/index.js");function n(){return d.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(n()<t)throw new RangeError("Invalid typed array length");return d.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=d.prototype:(null===e&&(e=new d(t)),e.length=t),e}function d(e,t,n){if(!(d.TYPED_ARRAY_SUPPORT||this instanceof d))return new d(e,t,n);if("number"!=typeof e)return i(this,e,t,n);if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return u(this,e)}function i(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);d.TYPED_ARRAY_SUPPORT?(e=t).__proto__=d.prototype:e=c(e,t);return e}(e,t,n,r):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!d.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|f(t,n),i=(e=s(e,r)).write(t,n);i!==r&&(e=e.slice(0,i));return e}(e,t,n):function(e,t){if(d.isBuffer(t)){var n=0|h(t.length);return 0===(e=s(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||function(e){return e!=e}(t.length)?s(e,0):c(e,t);if("Buffer"===t.type&&o(t.data))return c(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function u(e,t){if(l(t),e=s(e,t<0?0:0|h(t)),!d.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function c(e,t){var n=t.length<0?0:0|h(t.length);e=s(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function h(e){if(e>=n())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n().toString(16)+" bytes");return 0|e}function f(e,t){if(d.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return k(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return B(e).length;default:if(r)return k(e).length;t=(""+t).toLowerCase(),r=!0}}function p(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function m(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):2147483647<n?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=d.from(t,r)),d.isBuffer(t))return 0===t.length?-1:g(e,t,n,r,i);if("number"==typeof t)return t&=255,d.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):g(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function g(e,t,n,r,i){var a,o=1,s=e.length,l=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;s/=o=2,l/=2,n/=2}function u(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(i){var c=-1;for(a=n;a<s;a++)if(u(e,a)===u(t,-1===c?0:a-c)){if(-1===c&&(c=a),a-c+1===l)return c*o}else-1!==c&&(a-=a-c),c=-1}else for(s<n+l&&(n=s-l),a=n;0<=a;a--){for(var d=!0,h=0;h<l;h++)if(u(e,a+h)!==u(t,h)){d=!1;break}if(d)return a}return-1}function v(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?i<(r=Number(r))&&(r=i):r=i;var a=t.length;if(a%2!=0)throw new TypeError("Invalid hex string");a/2<r&&(r=a/2);for(var o=0;o<r;++o){var s=parseInt(t.substr(2*o,2),16);if(isNaN(s))return o;e[n+o]=s}return o}function y(e,t,n,r){return F(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function _(e,t,n,r){return F(function(e,t){for(var n,r,i,a=[],o=0;o<e.length&&!((t-=2)<0);++o)n=e.charCodeAt(o),r=n>>8,i=n%256,a.push(i),a.push(r);return a}(t,e.length-n),e,n,r)}function b(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function E(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var a,o,s,l,u=e[i],c=null,d=239<u?4:223<u?3:191<u?2:1;if(i+d<=n)switch(d){case 1:u<128&&(c=u);break;case 2:128==(192&(a=e[i+1]))&&127<(l=(31&u)<<6|63&a)&&(c=l);break;case 3:a=e[i+1],o=e[i+2],128==(192&a)&&128==(192&o)&&2047<(l=(15&u)<<12|(63&a)<<6|63&o)&&(l<55296||57343<l)&&(c=l);break;case 4:a=e[i+1],o=e[i+2],s=e[i+3],128==(192&a)&&128==(192&o)&&128==(192&s)&&65535<(l=(15&u)<<18|(63&a)<<12|(63&o)<<6|63&s)&&l<1114112&&(c=l)}null===c?(c=65533,d=1):65535<c&&(c-=65536,r.push(c>>>10&1023|55296),c=56320|1023&c),r.push(c),i+=d}return function(e){var t=e.length;if(t<=T)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=T));return n}(r)}j.Buffer=d,j.SlowBuffer=function(e){+e!=e&&(e=0);return d.alloc(+e)},j.INSPECT_MAX_BYTES=50,d.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),j.kMaxLength=n(),d.poolSize=8192,d._augment=function(e){return e.__proto__=d.prototype,e},d.from=function(e,t,n){return i(null,e,t,n)},d.TYPED_ARRAY_SUPPORT&&(d.prototype.__proto__=Uint8Array.prototype,d.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&d[Symbol.species]===d&&Object.defineProperty(d,Symbol.species,{value:null,configurable:!0})),d.alloc=function(e,t,n){return function(e,t,n,r){return l(t),t<=0?s(e,t):void 0!==n?"string"==typeof r?s(e,t).fill(n,r):s(e,t).fill(n):s(e,t)}(null,e,t,n)},d.allocUnsafe=function(e){return u(null,e)},d.allocUnsafeSlow=function(e){return u(null,e)},d.isBuffer=function(e){return!(null==e||!e._isBuffer)},d.compare=function(e,t){if(!d.isBuffer(e)||!d.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,a=Math.min(n,r);i<a;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},d.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},d.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return d.alloc(0);var n;if(void 0===t)for(n=t=0;n<e.length;++n)t+=e[n].length;var r=d.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var a=e[n];if(!d.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,i),i+=a.length}return r},d.byteLength=f,d.prototype._isBuffer=!0,d.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)p(this,t,t+1);return this},d.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)p(this,t,t+3),p(this,t+1,t+2);return this},d.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)p(this,t,t+7),p(this,t+1,t+6),p(this,t+2,t+5),p(this,t+3,t+4);return this},d.prototype.toString=function(){var e=0|this.length;return 0==e?"":0===arguments.length?E(this,0,e):function(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e=e||"utf8";;)switch(e){case"hex":return S(this,t,n);case"utf8":case"utf-8":return E(this,t,n);case"ascii":return A(this,t,n);case"latin1":case"binary":return w(this,t,n);case"base64":return b(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}.apply(this,arguments)},d.prototype.equals=function(e){if(!d.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===d.compare(this,e)},d.prototype.inspect=function(){var e="",t=j.INSPECT_MAX_BYTES;return 0<this.length&&(e=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(e+=" ... ")),"<Buffer "+e+">"},d.prototype.compare=function(e,t,n,r,i){if(!d.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(i<=r&&n<=t)return 0;if(i<=r)return-1;if(n<=t)return 1;if(this===e)return 0;for(var a=(i>>>=0)-(r>>>=0),o=(n>>>=0)-(t>>>=0),s=Math.min(a,o),l=this.slice(r,i),u=e.slice(t,n),c=0;c<s;++c)if(l[c]!==u[c]){a=l[c],o=u[c];break}return a<o?-1:o<a?1:0},d.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},d.prototype.indexOf=function(e,t,n){return m(this,e,t,n,!0)},d.prototype.lastIndexOf=function(e,t,n){return m(this,e,t,n,!1)},d.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||i<n)&&(n=i),0<e.length&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r=r||"utf8";for(var a,o,s,l,u,c,d=!1;;)switch(r){case"hex":return v(this,e,t,n);case"utf8":case"utf-8":return u=t,c=n,F(k(e,(l=this).length-u),l,u,c);case"ascii":return y(this,e,t,n);case"latin1":case"binary":return y(this,e,t,n);case"base64":return a=this,o=t,s=n,F(B(e),a,o,s);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _(this,e,t,n);default:if(d)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),d=!0}},d.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var T=4096;function A(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function w(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function S(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||r<n)&&(n=r);for(var i="",a=t;a<n;++a)i+=N(e[a]);return i}function C(e,t,n){for(var r=e.slice(t,n),i="",a=0;a<r.length;a+=2)i+=String.fromCharCode(r[a]+256*r[a+1]);return i}function x(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(n<e+t)throw new RangeError("Trying to access beyond buffer length")}function M(e,t,n,r,i,a){if(!d.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(i<t||t<a)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function R(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,a=Math.min(e.length-n,2);i<a;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function I(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,a=Math.min(e.length-n,4);i<a;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function P(e,t,n,r){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function D(e,t,n,r,i){return i||P(e,0,n,4),a.write(e,t,n,r,23,4),n+4}function L(e,t,n,r,i){return i||P(e,0,n,8),a.write(e,t,n,r,52,8),n+8}d.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):r<e&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):r<t&&(t=r),t<e&&(t=e),d.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=d.prototype;else{var i=t-e;n=new d(i,void 0);for(var a=0;a<i;++a)n[a]=this[a+e]}return n},d.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||x(e,t,this.length);for(var r=this[e],i=1,a=0;++a<t&&(i*=256);)r+=this[e+a]*i;return r},d.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||x(e,t,this.length);for(var r=this[e+--t],i=1;0<t&&(i*=256);)r+=this[e+--t]*i;return r},d.prototype.readUInt8=function(e,t){return t||x(e,1,this.length),this[e]},d.prototype.readUInt16LE=function(e,t){return t||x(e,2,this.length),this[e]|this[e+1]<<8},d.prototype.readUInt16BE=function(e,t){return t||x(e,2,this.length),this[e]<<8|this[e+1]},d.prototype.readUInt32LE=function(e,t){return t||x(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},d.prototype.readUInt32BE=function(e,t){return t||x(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},d.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||x(e,t,this.length);for(var r=this[e],i=1,a=0;++a<t&&(i*=256);)r+=this[e+a]*i;return(i*=128)<=r&&(r-=Math.pow(2,8*t)),r},d.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||x(e,t,this.length);for(var r=t,i=1,a=this[e+--r];0<r&&(i*=256);)a+=this[e+--r]*i;return(i*=128)<=a&&(a-=Math.pow(2,8*t)),a},d.prototype.readInt8=function(e,t){return t||x(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},d.prototype.readInt16LE=function(e,t){t||x(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},d.prototype.readInt16BE=function(e,t){t||x(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},d.prototype.readInt32LE=function(e,t){return t||x(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},d.prototype.readInt32BE=function(e,t){return t||x(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},d.prototype.readFloatLE=function(e,t){return t||x(e,4,this.length),a.read(this,e,!0,23,4)},d.prototype.readFloatBE=function(e,t){return t||x(e,4,this.length),a.read(this,e,!1,23,4)},d.prototype.readDoubleLE=function(e,t){return t||x(e,8,this.length),a.read(this,e,!0,52,8)},d.prototype.readDoubleBE=function(e,t){return t||x(e,8,this.length),a.read(this,e,!1,52,8)},d.prototype.writeUIntLE=function(e,t,n,r){e=+e,t|=0,n|=0,r||M(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,a=0;for(this[t]=255&e;++a<n&&(i*=256);)this[t+a]=e/i&255;return t+n},d.prototype.writeUIntBE=function(e,t,n,r){e=+e,t|=0,n|=0,r||M(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,a=1;for(this[t+i]=255&e;0<=--i&&(a*=256);)this[t+i]=e/a&255;return t+n},d.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,1,255,0),d.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},d.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,2,65535,0),d.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):R(this,e,t,!0),t+2},d.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,2,65535,0),d.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):R(this,e,t,!1),t+2},d.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,4,4294967295,0),d.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):I(this,e,t,!0),t+4},d.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,4,4294967295,0),d.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):I(this,e,t,!1),t+4},d.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);M(this,e,t,n,i-1,-i)}var a=0,o=1,s=0;for(this[t]=255&e;++a<n&&(o*=256);)e<0&&0===s&&0!==this[t+a-1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+n},d.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);M(this,e,t,n,i-1,-i)}var a=n-1,o=1,s=0;for(this[t+a]=255&e;0<=--a&&(o*=256);)e<0&&0===s&&0!==this[t+a+1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+n},d.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,1,127,-128),d.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},d.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,2,32767,-32768),d.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):R(this,e,t,!0),t+2},d.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,2,32767,-32768),d.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):R(this,e,t,!1),t+2},d.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,4,2147483647,-2147483648),d.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):I(this,e,t,!0),t+4},d.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),d.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):I(this,e,t,!1),t+4},d.prototype.writeFloatLE=function(e,t,n){return D(this,e,t,!0,n)},d.prototype.writeFloatBE=function(e,t,n){return D(this,e,t,!1,n)},d.prototype.writeDoubleLE=function(e,t,n){return L(this,e,t,!0,n)},d.prototype.writeDoubleBE=function(e,t,n){return L(this,e,t,!1,n)},d.prototype.copy=function(e,t,n,r){if(n=n||0,r||0===r||(r=this.length),t>=e.length&&(t=e.length),t=t||0,0<r&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,a=r-n;if(this===e&&n<t&&t<r)for(i=a-1;0<=i;--i)e[i+t]=this[i+n];else if(a<1e3||!d.TYPED_ARRAY_SUPPORT)for(i=0;i<a;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+a),t);return a},d.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!d.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var a;if(t>>>=0,n=void 0===n?this.length:n>>>0,"number"==typeof(e=e||0))for(a=t;a<n;++a)this[a]=e;else{var o=d.isBuffer(e)?e:k(new d(e,r).toString()),s=o.length;for(a=0;a<n-t;++a)this[a+t]=o[a%s]}return this};var t=/[^+\/0-9A-Za-z-_]/g;function O(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(t,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}function N(e){return e<16?"0"+e.toString(16):e.toString(16)}function k(e,t){var n;t=t||1/0;for(var r=e.length,i=null,a=[],o=0;o<r;++o){if(55295<(n=e.charCodeAt(o))&&n<57344){if(!i){if(56319<n){-1<(t-=3)&&a.push(239,191,189);continue}if(o+1===r){-1<(t-=3)&&a.push(239,191,189);continue}i=n;continue}if(n<56320){-1<(t-=3)&&a.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&-1<(t-=3)&&a.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;a.push(n)}else if(n<2048){if((t-=2)<0)break;a.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;a.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return a}function B(e){return r.toByteArray(O(e))}function F(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}}).call(this,U("./node_modules/webpack/buildin/global.js"))},"./node_modules/node-libs-browser/node_modules/events/events.js":function(e,t,n){var r,i="object"==typeof Reflect?Reflect:null,c=i&&"function"==typeof i.apply?i.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};r=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var a=Number.isNaN||function(e){return e!=e};function o(){o.init.call(this)}e.exports=o,e.exports.once=function(i,a){return new Promise(function(e,t){function n(e){i.removeListener(a,r),t(e)}function r(){"function"==typeof i.removeListener&&i.removeListener("error",n),e([].slice.call(arguments))}g(i,a,r,{once:!0}),"error"!==a&&function(e,t,n){"function"==typeof e.on&&g(e,"error",t,n)}(i,n,{once:!0})})},(o.EventEmitter=o).prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var s=10;function l(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function u(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function d(e,t,n,r){var i,a,o;if(l(n),void 0===(a=e._events)?(a=e._events=Object.create(null),e._eventsCount=0):(void 0!==a.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),a=e._events),o=a[t]),void 0===o)o=a[t]=n,++e._eventsCount;else if("function"==typeof o?o=a[t]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),0<(i=u(e))&&o.length>i&&!o.warned){o.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=e,s.type=t,s.count=o.length,function(e){console&&console.warn&&console.warn(e)}(s)}return e}function h(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=function(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}.bind(r);return i.listener=n,r.wrapFn=i}function f(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):m(i,i.length)}function p(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function m(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function g(n,r,i,a){if("function"==typeof n.on)a.once?n.once(r,i):n.on(r,i);else{if("function"!=typeof n.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof n);n.addEventListener(r,function e(t){a.once&&n.removeEventListener(r,e),i(t)})}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||a(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||a(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return u(this)},o.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var a;if(0<t.length&&(a=t[0]),a instanceof Error)throw a;var o=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw o.context=a,o}var s=i[e];if(void 0===s)return!1;if("function"==typeof s)c(s,this,t);else{var l=s.length,u=m(s,l);for(n=0;n<l;++n)c(u[n],this,t)}return!0},o.prototype.on=o.prototype.addListener=function(e,t){return d(this,e,t,!1)},o.prototype.prependListener=function(e,t){return d(this,e,t,!0)},o.prototype.once=function(e,t){return l(t),this.on(e,h(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return l(t),this.prependListener(e,h(this,e,t)),this},o.prototype.off=o.prototype.removeListener=function(e,t){var n,r,i,a,o;if(l(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,a=n.length-1;0<=a;a--)if(n[a]===t||n[a].listener===t){o=n[a].listener,i=a;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,o||t)}return this},o.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,a=Object.keys(n);for(r=0;r<a.length;++r)"removeListener"!==(i=a[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;0<=r;r--)this.removeListener(e,t[r]);return this},o.prototype.listeners=function(e){return f(this,e,!0)},o.prototype.rawListeners=function(e){return f(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},o.prototype.listenerCount=p,o.prototype.eventNames=function(){return 0<this._eventsCount?r(this._events):[]}},"./node_modules/node-libs-browser/node_modules/timers-browserify/main.js":function(e,i,a){(function(e){var t=void 0!==e&&e||"undefined"!=typeof self&&self||window,n=Function.prototype.apply;function r(e,t){this._id=e,this._clearFn=t}i.setTimeout=function(){return new r(n.call(setTimeout,t,arguments),clearTimeout)},i.setInterval=function(){return new r(n.call(setInterval,t,arguments),clearInterval)},i.clearTimeout=i.clearInterval=function(e){e&&e.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(t,this._id)},i.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},i.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},i._unrefActive=i.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;0<=t&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},a("./node_modules/setimmediate/setImmediate.js"),i.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,i.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,a("./node_modules/webpack/buildin/global.js"))},"./node_modules/path-browserify/index.js":function(e,u,t){(function(i){function a(e,t){for(var n=0,r=e.length-1;0<=r;r--){var i=e[r];"."===i?e.splice(r,1):".."===i?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n--;)e.unshift("..");return e}function o(e,t){if(e.filter)return e.filter(t);for(var n=[],r=0;r<e.length;r++)t(e[r],r,e)&&n.push(e[r]);return n}u.resolve=function(){for(var e="",t=!1,n=arguments.length-1;-1<=n&&!t;n--){var r=0<=n?arguments[n]:i.cwd();if("string"!=typeof r)throw new TypeError("Arguments to path.resolve must be strings");r&&(e=r+"/"+e,t="/"===r.charAt(0))}return(t?"/":"")+(e=a(o(e.split("/"),function(e){return!!e}),!t).join("/"))||"."},u.normalize=function(e){var t=u.isAbsolute(e),n="/"===r(e,-1);return(e=a(o(e.split("/"),function(e){return!!e}),!t).join("/"))||t||(e="."),e&&n&&(e+="/"),(t?"/":"")+e},u.isAbsolute=function(e){return"/"===e.charAt(0)},u.join=function(){var e=Array.prototype.slice.call(arguments,0);return u.normalize(o(e,function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},u.relative=function(e,t){function n(e){for(var t=0;t<e.length&&""===e[t];t++);for(var n=e.length-1;0<=n&&""===e[n];n--);return n<t?[]:e.slice(t,n-t+1)}e=u.resolve(e).substr(1),t=u.resolve(t).substr(1);for(var r=n(e.split("/")),i=n(t.split("/")),a=Math.min(r.length,i.length),o=a,s=0;s<a;s++)if(r[s]!==i[s]){o=s;break}var l=[];for(s=o;s<r.length;s++)l.push("..");return(l=l.concat(i.slice(o))).join("/")},u.sep="/",u.delimiter=":",u.dirname=function(e){if("string"!=typeof e&&(e+=""),0===e.length)return".";for(var t=e.charCodeAt(0),n=47===t,r=-1,i=!0,a=e.length-1;1<=a;--a)if(47===(t=e.charCodeAt(a))){if(!i){r=a;break}}else i=!1;return-1===r?n?"/":".":n&&1===r?"/":e.slice(0,r)},u.basename=function(e,t){var n=function(e){"string"!=typeof e&&(e+="");var t,n=0,r=-1,i=!0;for(t=e.length-1;0<=t;--t)if(47===e.charCodeAt(t)){if(!i){n=t+1;break}}else-1===r&&(i=!1,r=t+1);return-1===r?"":e.slice(n,r)}(e);return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},u.extname=function(e){"string"!=typeof e&&(e+="");for(var t=-1,n=0,r=-1,i=!0,a=0,o=e.length-1;0<=o;--o){var s=e.charCodeAt(o);if(47===s){if(i)continue;n=o+1;break}-1===r&&(i=!1,r=o+1),46===s?-1===t?t=o:1!==a&&(a=1):-1!==t&&(a=-1)}return-1===t||-1===r||0===a||1===a&&t===r-1&&t===n+1?"":e.slice(t,r)};var r="b"==="ab".substr(-1)?function(e,t,n){return e.substr(t,n)}:function(e,t,n){return t<0&&(t=e.length+t),e.substr(t,n)}}).call(this,t("./node_modules/process/browser.js"))},"./node_modules/process-nextick-args/index.js":function(e,t,n){(function(s){!s.version||0===s.version.indexOf("v0.")||0===s.version.indexOf("v1.")&&0!==s.version.indexOf("v1.8.")?e.exports={nextTick:function(e,t,n,r){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var i,a,o=arguments.length;switch(o){case 0:case 1:return s.nextTick(e);case 2:return s.nextTick(function(){e.call(null,t)});case 3:return s.nextTick(function(){e.call(null,t,n)});case 4:return s.nextTick(function(){e.call(null,t,n,r)});default:for(i=new Array(o-1),a=0;a<i.length;)i[a++]=arguments[a];return s.nextTick(function(){e.apply(null,i)})}}}:e.exports=s}).call(this,n("./node_modules/process/browser.js"))},"./node_modules/process/browser.js":function(e,t){var n,r,i=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:a}catch(e){n=a}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(e){r=o}}();var l,u=[],c=!1,d=-1;function h(){c&&l&&(c=!1,l.length?u=l.concat(u):d=-1,u.length&&f())}function f(){if(!c){var e=s(h);c=!0;for(var t=u.length;t;){for(l=u,u=[];++d<t;)l&&l[d].run();d=-1,t=u.length}l=null,c=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new p(e,t)),1!==u.length||c||s(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},"./node_modules/readable-stream/duplex-browser.js":function(e,t,n){e.exports=n("./node_modules/readable-stream/lib/_stream_duplex.js")},"./node_modules/readable-stream/lib/_stream_duplex.js":function(e,t,n){var r=n("./node_modules/process-nextick-args/index.js"),i=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};e.exports=d;var a=n("./node_modules/core-util-is/lib/util.js");a.inherits=n("./node_modules/inherits/inherits_browser.js");var o=n("./node_modules/readable-stream/lib/_stream_readable.js"),s=n("./node_modules/readable-stream/lib/_stream_writable.js");a.inherits(d,o);for(var l=i(s.prototype),u=0;u<l.length;u++){var c=l[u];d.prototype[c]||(d.prototype[c]=s.prototype[c])}function d(e){if(!(this instanceof d))return new d(e);o.call(this,e),s.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",h)}function h(){this.allowHalfOpen||this._writableState.ended||r.nextTick(f,this)}function f(e){e.end()}Object.defineProperty(d.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(d.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),d.prototype._destroy=function(e,t){this.push(null),this.end(),r.nextTick(t,e)}},"./node_modules/readable-stream/lib/_stream_passthrough.js":function(e,t,n){e.exports=a;var r=n("./node_modules/readable-stream/lib/_stream_transform.js"),i=n("./node_modules/core-util-is/lib/util.js");function a(e){if(!(this instanceof a))return new a(e);r.call(this,e)}i.inherits=n("./node_modules/inherits/inherits_browser.js"),i.inherits(a,r),a.prototype._transform=function(e,t,n){n(null,e)}},"./node_modules/readable-stream/lib/_stream_readable.js":function(L,e,O){(function(e,m){var g=O("./node_modules/process-nextick-args/index.js");L.exports=h;var o,v=O("./node_modules/isarray/index.js");h.ReadableState=a;function y(e,t){return e.listeners(t).length}O("./node_modules/node-libs-browser/node_modules/events/events.js").EventEmitter;var i=O("./node_modules/readable-stream/lib/internal/streams/stream-browser.js"),s=O("./node_modules/safe-buffer/index.js").Buffer,l=e.Uint8Array||function(){};var t=O("./node_modules/core-util-is/lib/util.js");t.inherits=O("./node_modules/inherits/inherits_browser.js");var n=O(0),_=void 0;_=n&&n.debuglog?n.debuglog("stream"):function(){};var u,c=O("./node_modules/readable-stream/lib/internal/streams/BufferList.js"),r=O("./node_modules/readable-stream/lib/internal/streams/destroy.js");t.inherits(h,i);var d=["error","close","destroy","pause","resume"];function a(e,t){e=e||{};var n=t instanceof(o=o||O("./node_modules/readable-stream/lib/_stream_duplex.js"));this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var r=e.highWaterMark,i=e.readableHighWaterMark,a=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:n&&(i||0===i)?i:a,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new c,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(u=u||O("./node_modules/string_decoder/lib/string_decoder.js").StringDecoder,this.decoder=new u(e.encoding),this.encoding=e.encoding)}function h(e){if(o=o||O("./node_modules/readable-stream/lib/_stream_duplex.js"),!(this instanceof h))return new h(e);this._readableState=new a(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),i.call(this)}function f(e,t,n,r,i){var a,o=e._readableState;null===t?(o.reading=!1,function(e,t){if(t.ended)return;if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,T(e)}(e,o)):(i||(a=function(e,t){var n;(function(e){return s.isBuffer(e)||e instanceof l})(t)||"string"==typeof t||void 0===t||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk"));return n}(o,t)),a?e.emit("error",a):o.objectMode||t&&0<t.length?("string"==typeof t||o.objectMode||Object.getPrototypeOf(t)===s.prototype||(t=function(e){return s.from(e)}(t)),r?o.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):p(e,o,t,!0):o.ended?e.emit("error",new Error("stream.push() after EOF")):(o.reading=!1,o.decoder&&!n?(t=o.decoder.write(t),o.objectMode||0!==t.length?p(e,o,t,!1):w(e,o)):p(e,o,t,!1))):r||(o.reading=!1));return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(o)}function p(e,t,n,r){t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,r?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&T(e)),w(e,t)}Object.defineProperty(h.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),h.prototype.destroy=r.destroy,h.prototype._undestroy=r.undestroy,h.prototype._destroy=function(e,t){this.push(null),t(e)},h.prototype.push=function(e,t){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof e&&((t=t||r.defaultEncoding)!==r.encoding&&(e=s.from(e,t),t=""),n=!0),f(this,e,t,!1,n)},h.prototype.unshift=function(e){return f(this,e,null,!0,!1)},h.prototype.isPaused=function(){return!1===this._readableState.flowing},h.prototype.setEncoding=function(e){return u=u||O("./node_modules/string_decoder/lib/string_decoder.js").StringDecoder,this._readableState.decoder=new u(e),this._readableState.encoding=e,this};var b=8388608;function E(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return b<=e?e=b:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function T(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(_("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?g.nextTick(A,e):A(e))}function A(e){_("emit readable"),e.emit("readable"),M(e)}function w(e,t){t.readingMore||(t.readingMore=!0,g.nextTick(S,e,t))}function S(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(_("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function C(e){_("readable nexttick read 0"),e.read(0)}function x(e,t){t.reading||(_("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),M(e),t.flowing&&!t.reading&&e.read(0)}function M(e){var t=e._readableState;for(_("flow",t.flowing);t.flowing&&null!==e.read(););}function R(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):n=function(e,t,n){var r;e<t.head.data.length?(r=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):r=e===t.head.data.length?t.shift():n?function(e,t){var n=t.head,r=1,i=n.data;e-=i.length;for(;n=n.next;){var a=n.data,o=e>a.length?a.length:e;if(o===a.length?i+=a:i+=a.slice(0,e),0===(e-=o)){o===a.length?(++r,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n).data=a.slice(o);break}++r}return t.length-=r,i}(e,t):function(e,t){var n=s.allocUnsafe(e),r=t.head,i=1;r.data.copy(n),e-=r.data.length;for(;r=r.next;){var a=r.data,o=e>a.length?a.length:e;if(a.copy(n,n.length-e,0,o),0===(e-=o)){o===a.length?(++i,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r).data=a.slice(o);break}++i}return t.length-=i,n}(e,t);return r}(e,t.buffer,t.decoder),n);var n}function I(e){var t=e._readableState;if(0<t.length)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,g.nextTick(P,t,e))}function P(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function D(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}h.prototype.read=function(e){_("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return _("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?I(this):T(this),null;if(0===(e=E(e,t))&&t.ended)return 0===t.length&&I(this),null;var r,i=t.needReadable;return _("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&_("length less than watermark",i=!0),t.ended||t.reading?_("reading or ended",i=!1):i&&(_("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=E(n,t))),null===(r=0<e?R(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&I(this)),null!==r&&this.emit("data",r),r},h.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},h.prototype.pipe=function(n,e){var r=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=n;break;case 1:i.pipes=[i.pipes,n];break;default:i.pipes.push(n)}i.pipesCount+=1,_("pipe count=%d opts=%j",i.pipesCount,e);var t=(!e||!1!==e.end)&&n!==m.stdout&&n!==m.stderr?o:p;function a(e,t){_("onunpipe"),e===r&&t&&!1===t.hasUnpiped&&(t.hasUnpiped=!0,_("cleanup"),n.removeListener("close",h),n.removeListener("finish",f),n.removeListener("drain",s),n.removeListener("error",d),n.removeListener("unpipe",a),r.removeListener("end",o),r.removeListener("end",p),r.removeListener("data",c),l=!0,!i.awaitDrain||n._writableState&&!n._writableState.needDrain||s())}function o(){_("onend"),n.end()}i.endEmitted?g.nextTick(t):r.once("end",t),n.on("unpipe",a);var s=function(t){return function(){var e=t._readableState;_("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&y(t,"data")&&(e.flowing=!0,M(t))}}(r);n.on("drain",s);var l=!1;var u=!1;function c(e){_("ondata"),(u=!1)!==n.write(e)||u||((1===i.pipesCount&&i.pipes===n||1<i.pipesCount&&-1!==D(i.pipes,n))&&!l&&(_("false write response, pause",r._readableState.awaitDrain),r._readableState.awaitDrain++,u=!0),r.pause())}function d(e){_("onerror",e),p(),n.removeListener("error",d),0===y(n,"error")&&n.emit("error",e)}function h(){n.removeListener("finish",f),p()}function f(){_("onfinish"),n.removeListener("close",h),p()}function p(){_("unpipe"),r.unpipe(n)}return r.on("data",c),function(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?v(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}(n,"error",d),n.once("close",h),n.once("finish",f),n.emit("pipe",r),i.flowing||(_("pipe resume"),r.resume()),n},h.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e=e||t.pipes,t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n)),this;if(!e){var r=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var a=0;a<i;a++)r[a].emit("unpipe",this,n);return this}var o=D(t.pipes,e);return-1===o||(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n)),this},h.prototype.addListener=h.prototype.on=function(e,t){var n=i.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var r=this._readableState;r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&T(this):g.nextTick(C,this))}return n},h.prototype.resume=function(){var e=this._readableState;return e.flowing||(_("resume"),e.flowing=!0,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,g.nextTick(x,e,t))}(this,e)),this},h.prototype.pause=function(){return _("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(_("pause"),this._readableState.flowing=!1,this.emit("pause")),this},h.prototype.wrap=function(t){var n=this,r=this._readableState,i=!1;for(var e in t.on("end",function(){if(_("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&n.push(e)}n.push(null)}),t.on("data",function(e){_("wrapped data"),r.decoder&&(e=r.decoder.write(e)),r.objectMode&&null==e||(r.objectMode||e&&e.length)&&(n.push(e)||(i=!0,t.pause()))}),t)void 0===this[e]&&"function"==typeof t[e]&&(this[e]=function(e){return function(){return t[e].apply(t,arguments)}}(e));for(var a=0;a<d.length;a++)t.on(d[a],this.emit.bind(this,d[a]));return this._read=function(e){_("wrapped _read",e),i&&(i=!1,t.resume())},this},Object.defineProperty(h.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),h._fromList=R}).call(this,O("./node_modules/webpack/buildin/global.js"),O("./node_modules/process/browser.js"))},"./node_modules/readable-stream/lib/_stream_transform.js":function(e,t,n){e.exports=a;var r=n("./node_modules/readable-stream/lib/_stream_duplex.js"),i=n("./node_modules/core-util-is/lib/util.js");function a(e){if(!(this instanceof a))return new a(e);r.call(this,e),this._transformState={afterTransform:function(e,t){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(!r)return this.emit("error",new Error("write callback called multiple times"));n.writechunk=null,(n.writecb=null)!=t&&this.push(t),r(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",o)}function o(){var n=this;"function"==typeof this._flush?this._flush(function(e,t){s(n,e,t)}):s(this,null,null)}function s(e,t,n){if(t)return e.emit("error",t);if(null!=n&&e.push(n),e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}i.inherits=n("./node_modules/inherits/inherits_browser.js"),i.inherits(a,r),a.prototype.push=function(e,t){return this._transformState.needTransform=!1,r.prototype.push.call(this,e,t)},a.prototype._transform=function(e,t,n){throw new Error("_transform() is not implemented")},a.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},a.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},a.prototype._destroy=function(e,t){var n=this;r.prototype._destroy.call(this,e,function(e){t(e),n.emit("close")})}},"./node_modules/readable-stream/lib/_stream_writable.js":function(A,e,w){(function(e,t,n){var s=w("./node_modules/process-nextick-args/index.js");function d(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,n){var r=e.entry;e.entry=null;for(;r;){var i=r.callback;t.pendingcb--,i(n),r=r.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}(t,e)}}A.exports=g;var l,u=!e.browser&&-1<["v0.10","v0.9."].indexOf(e.version.slice(0,5))?t:s.nextTick;g.WritableState=m;var r=w("./node_modules/core-util-is/lib/util.js");r.inherits=w("./node_modules/inherits/inherits_browser.js");var i={deprecate:w("./node_modules/util-deprecate/browser.js")},a=w("./node_modules/readable-stream/lib/internal/streams/stream-browser.js"),c=w("./node_modules/safe-buffer/index.js").Buffer,o=n.Uint8Array||function(){};var h,f=w("./node_modules/readable-stream/lib/internal/streams/destroy.js");function p(){}function m(e,t){l=l||w("./node_modules/readable-stream/lib/_stream_duplex.js"),e=e||{};var n=t instanceof l;this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var r=e.highWaterMark,i=e.writableHighWaterMark,a=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:n&&(i||0===i)?i:a,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var o=(this.destroyed=!1)===e.decodeStrings;this.decodeStrings=!o,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var n=e._writableState,r=n.sync,i=n.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(n),t)!function(e,t,n,r,i){--t.pendingcb,n?(s.nextTick(i,r),s.nextTick(T,e,t),e._writableState.errorEmitted=!0,e.emit("error",r)):(i(r),e._writableState.errorEmitted=!0,e.emit("error",r),T(e,t))}(e,n,r,t,i);else{var a=b(n);a||n.corked||n.bufferProcessing||!n.bufferedRequest||_(e,n),r?u(y,e,n,a,i):y(e,n,a,i)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new d(this)}function g(e){if(l=l||w("./node_modules/readable-stream/lib/_stream_duplex.js"),!(h.call(g,this)||this instanceof l))return new g(e);this._writableState=new m(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),a.call(this)}function v(e,t,n,r,i,a,o){t.writelen=r,t.writecb=o,t.writing=!0,t.sync=!0,n?e._writev(i,t.onwrite):e._write(i,a,t.onwrite),t.sync=!1}function y(e,t,n,r){n||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,r(),T(e,t)}function _(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var r=t.bufferedRequestCount,i=new Array(r),a=t.corkedRequestsFree;a.entry=n;for(var o=0,s=!0;n;)(i[o]=n).isBuf||(s=!1),n=n.next,o+=1;i.allBuffers=s,v(e,t,!0,t.length,i,"",a.finish),t.pendingcb++,t.lastBufferedRequest=null,a.next?(t.corkedRequestsFree=a.next,a.next=null):t.corkedRequestsFree=new d(t),t.bufferedRequestCount=0}else{for(;n;){var l=n.chunk,u=n.encoding,c=n.callback;if(v(e,t,!1,t.objectMode?1:l.length,l,u,c),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequest=n,t.bufferProcessing=!1}function b(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function E(t,n){t._final(function(e){n.pendingcb--,e&&t.emit("error",e),n.prefinished=!0,t.emit("prefinish"),T(t,n)})}function T(e,t){var n=b(t);return n&&(function(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,s.nextTick(E,e,t)):(t.prefinished=!0,e.emit("prefinish")))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),n}r.inherits(g,a),m.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(m.prototype,"buffer",{get:i.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(h=Function.prototype[Symbol.hasInstance],Object.defineProperty(g,Symbol.hasInstance,{value:function(e){return!!h.call(this,e)||this===g&&(e&&e._writableState instanceof m)}})):h=function(e){return e instanceof this},g.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},g.prototype.write=function(e,t,n){var r=this._writableState,i=!1,a=!r.objectMode&&function(e){return c.isBuffer(e)||e instanceof o}(e);return a&&!c.isBuffer(e)&&(e=function(e){return c.from(e)}(e)),"function"==typeof t&&(n=t,t=null),t=a?"buffer":t||r.defaultEncoding,"function"!=typeof n&&(n=p),r.ended?function(e,t){var n=new Error("write after end");e.emit("error",n),s.nextTick(t,n)}(this,n):(a||function(e,t,n,r){var i=!0,a=!1;return null===n?a=new TypeError("May not write null values to stream"):"string"==typeof n||void 0===n||t.objectMode||(a=new TypeError("Invalid non-string/buffer chunk")),a&&(e.emit("error",a),s.nextTick(r,a),i=!1),i}(this,r,e,n))&&(r.pendingcb++,i=function(e,t,n,r,i,a){if(!n){var o=function(e,t,n){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=c.from(t,n));return t}(t,r,i);r!==o&&(n=!0,i="buffer",r=o)}var s=t.objectMode?1:r.length;t.length+=s;var l=t.length<t.highWaterMark;l||(t.needDrain=!0);if(t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:a,next:null},u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else v(e,t,!1,s,r,i,a);return l}(this,r,a,e,t,n)),i},g.prototype.cork=function(){this._writableState.corked++},g.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||_(this,e))},g.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(g.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),g.prototype._write=function(e,t,n){n(new Error("_write() is not implemented"))},g.prototype._writev=null,g.prototype.end=function(e,t,n){var r=this._writableState;"function"==typeof e?(n=e,t=e=null):"function"==typeof t&&(n=t,t=null),null!=e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||function(e,t,n){t.ending=!0,T(e,t),n&&(t.finished?s.nextTick(n):e.once("finish",n));t.ended=!0,e.writable=!1}(this,r,n)},Object.defineProperty(g.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),g.prototype.destroy=f.destroy,g.prototype._undestroy=f.undestroy,g.prototype._destroy=function(e,t){this.end(),t(e)}}).call(this,w("./node_modules/process/browser.js"),w("./node_modules/node-libs-browser/node_modules/timers-browserify/main.js").setImmediate,w("./node_modules/webpack/buildin/global.js"))},"./node_modules/readable-stream/lib/internal/streams/BufferList.js":function(e,t,n){var s=n("./node_modules/safe-buffer/index.js").Buffer,r=n(1);function i(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),this.head=null,this.tail=null,this.length=0}e.exports=(i.prototype.push=function(e){var t={data:e,next:null};0<this.length?this.tail.next=t:this.head=t,this.tail=t,++this.length},i.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},i.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},i.prototype.clear=function(){this.head=this.tail=null,this.length=0},i.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n},i.prototype.concat=function(e){if(0===this.length)return s.alloc(0);if(1===this.length)return this.head.data;for(var t,n,r,i=s.allocUnsafe(e>>>0),a=this.head,o=0;a;)t=a.data,n=i,r=o,t.copy(n,r),o+=a.data.length,a=a.next;return i},i),r&&r.inspect&&r.inspect.custom&&(e.exports.prototype[r.inspect.custom]=function(){var e=r.inspect({length:this.length});return this.constructor.name+" "+e})},"./node_modules/readable-stream/lib/internal/streams/destroy.js":function(e,t,n){var a=n("./node_modules/process-nextick-args/index.js");function o(e,t){e.emit("error",t)}e.exports={destroy:function(e,t){var n=this,r=this._readableState&&this._readableState.destroyed,i=this._writableState&&this._writableState.destroyed;return r||i?t?t(e):!e||this._writableState&&this._writableState.errorEmitted||a.nextTick(o,this,e):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(e){!t&&e?(a.nextTick(o,n,e),n._writableState&&(n._writableState.errorEmitted=!0)):t&&t(e)})),this},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},"./node_modules/readable-stream/lib/internal/streams/stream-browser.js":function(e,t,n){e.exports=n("./node_modules/node-libs-browser/node_modules/events/events.js").EventEmitter},"./node_modules/readable-stream/passthrough.js":function(e,t,n){e.exports=n("./node_modules/readable-stream/readable-browser.js").PassThrough},"./node_modules/readable-stream/readable-browser.js":function(e,t,n){(((t=e.exports=n("./node_modules/readable-stream/lib/_stream_readable.js")).Stream=t).Readable=t).Writable=n("./node_modules/readable-stream/lib/_stream_writable.js"),t.Duplex=n("./node_modules/readable-stream/lib/_stream_duplex.js"),t.Transform=n("./node_modules/readable-stream/lib/_stream_transform.js"),t.PassThrough=n("./node_modules/readable-stream/lib/_stream_passthrough.js")},"./node_modules/readable-stream/transform.js":function(e,t,n){e.exports=n("./node_modules/readable-stream/readable-browser.js").Transform},"./node_modules/readable-stream/writable-browser.js":function(e,t,n){e.exports=n("./node_modules/readable-stream/lib/_stream_writable.js")},"./node_modules/safe-buffer/index.js":function(e,t,n){var r=n("./node_modules/node-libs-browser/node_modules/buffer/index.js"),i=r.Buffer;function a(e,t){for(var n in e)t[n]=e[n]}function o(e,t,n){return i(e,t,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=r:(a(r,t),t.Buffer=o),a(i,o),o.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,n)},o.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=i(e);return void 0!==t?"string"==typeof n?r.fill(t,n):r.fill(t):r.fill(0),r},o.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}},"./node_modules/sax/lib/sax.js":function(e,t,z){(function(V){!function(l){l.parser=function(e,t){return new i(e,t)},l.SAXParser=i,l.SAXStream=o,l.createStream=function(e,t){return new o(e,t)},l.MAX_BUFFER_LENGTH=65536;var r,u=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function i(e,t){if(!(this instanceof i))return new i(e,t);var n=this;!function(e){for(var t=0,n=u.length;t<n;t++)e[u[t]]=""}(n),n.q=n.c="",n.bufferCheckPosition=l.MAX_BUFFER_LENGTH,n.opt=t||{},n.opt.lowercase=n.opt.lowercase||n.opt.lowercasetags,n.looseCase=n.opt.lowercase?"toLowerCase":"toUpperCase",n.tags=[],n.closed=n.closedRoot=n.sawRoot=!1,n.tag=n.error=null,n.strict=!!e,n.noscript=!(!e&&!n.opt.noscript),n.state=S.BEGIN,n.strictEntities=n.opt.strictEntities,n.ENTITIES=n.strictEntities?Object.create(l.XML_ENTITIES):Object.create(l.ENTITIES),n.attribList=[],n.opt.xmlns&&(n.ns=Object.create(g)),n.trackPosition=!1!==n.opt.position,n.trackPosition&&(n.position=n.line=n.column=0),x(n,"onready")}l.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(e){function t(){}return t.prototype=e,new t}),Object.keys||(Object.keys=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}),i.prototype={end:function(){D(this)},write:function(e){var t=this;if(this.error)throw this.error;if(t.closed)return P(t,"Cannot write after close. Assign an onready handler.");if(null===e)return D(t);"object"==typeof e&&(e=e.toString());var n=0,r="";for(;r=H(e,n++),t.c=r;)switch(t.trackPosition&&(t.position++,"\n"===r?(t.line++,t.column=0):t.column++),t.state){case S.BEGIN:if(t.state=S.BEGIN_WHITESPACE,"\ufeff"===r)continue;U(t,r);continue;case S.BEGIN_WHITESPACE:U(t,r);continue;case S.TEXT:if(t.sawRoot&&!t.closedRoot){for(var i=n-1;r&&"<"!==r&&"&"!==r;)(r=H(e,n++))&&t.trackPosition&&(t.position++,"\n"===r?(t.line++,t.column=0):t.column++);t.textNode+=e.substring(i,n-1)}"<"!==r||t.sawRoot&&t.closedRoot&&!t.strict?(!T(c,r)||t.sawRoot&&!t.closedRoot||L(t,"Text data outside of root node."),"&"===r?t.state=S.TEXT_ENTITY:t.textNode+=r):(t.state=S.OPEN_WAKA,t.startTagPosition=t.position);continue;case S.SCRIPT:"<"===r?t.state=S.SCRIPT_ENDING:t.script+=r;continue;case S.SCRIPT_ENDING:"/"===r?t.state=S.CLOSE_TAG:(t.script+="<"+r,t.state=S.SCRIPT);continue;case S.OPEN_WAKA:if("!"===r)t.state=S.SGML_DECL,t.sgmlDecl="";else if(!E(c,r))if(E(v,r))t.state=S.OPEN_TAG,t.tagName=r;else if("/"===r)t.state=S.CLOSE_TAG,t.tagName="";else if("?"===r)t.state=S.PROC_INST,t.procInstName=t.procInstBody="";else{if(L(t,"Unencoded <"),t.startTagPosition+1<t.position){var a=t.position-t.startTagPosition;r=new Array(a).join(" ")+r}t.textNode+="<"+r,t.state=S.TEXT}continue;case S.SGML_DECL:(t.sgmlDecl+r).toUpperCase()===f?(M(t,"onopencdata"),t.state=S.CDATA,t.sgmlDecl="",t.cdata=""):t.sgmlDecl+r==="--"?(t.state=S.COMMENT,t.comment="",t.sgmlDecl=""):(t.sgmlDecl+r).toUpperCase()===p?(t.state=S.DOCTYPE,(t.doctype||t.sawRoot)&&L(t,"Inappropriately located doctype declaration"),t.doctype="",t.sgmlDecl=""):">"===r?(M(t,"onsgmldeclaration",t.sgmlDecl),t.sgmlDecl="",t.state=S.TEXT):(E(d,r)&&(t.state=S.SGML_DECL_QUOTED),t.sgmlDecl+=r);continue;case S.SGML_DECL_QUOTED:r===t.q&&(t.state=S.SGML_DECL,t.q=""),t.sgmlDecl+=r;continue;case S.DOCTYPE:">"===r?(t.state=S.TEXT,M(t,"ondoctype",t.doctype),t.doctype=!0):(t.doctype+=r,"["===r?t.state=S.DOCTYPE_DTD:E(d,r)&&(t.state=S.DOCTYPE_QUOTED,t.q=r));continue;case S.DOCTYPE_QUOTED:t.doctype+=r,r===t.q&&(t.q="",t.state=S.DOCTYPE);continue;case S.DOCTYPE_DTD:t.doctype+=r,"]"===r?t.state=S.DOCTYPE:E(d,r)&&(t.state=S.DOCTYPE_DTD_QUOTED,t.q=r);continue;case S.DOCTYPE_DTD_QUOTED:t.doctype+=r,r===t.q&&(t.state=S.DOCTYPE_DTD,t.q="");continue;case S.COMMENT:"-"===r?t.state=S.COMMENT_ENDING:t.comment+=r;continue;case S.COMMENT_ENDING:"-"===r?(t.state=S.COMMENT_ENDED,t.comment=I(t.opt,t.comment),t.comment&&M(t,"oncomment",t.comment),t.comment=""):(t.comment+="-"+r,t.state=S.COMMENT);continue;case S.COMMENT_ENDED:">"!==r?(L(t,"Malformed comment"),t.comment+="--"+r,t.state=S.COMMENT):t.state=S.TEXT;continue;case S.CDATA:"]"===r?t.state=S.CDATA_ENDING:t.cdata+=r;continue;case S.CDATA_ENDING:"]"===r?t.state=S.CDATA_ENDING_2:(t.cdata+="]"+r,t.state=S.CDATA);continue;case S.CDATA_ENDING_2:">"===r?(t.cdata&&M(t,"oncdata",t.cdata),M(t,"onclosecdata"),t.cdata="",t.state=S.TEXT):"]"===r?t.cdata+="]":(t.cdata+="]]"+r,t.state=S.CDATA);continue;case S.PROC_INST:"?"===r?t.state=S.PROC_INST_ENDING:E(c,r)?t.state=S.PROC_INST_BODY:t.procInstName+=r;continue;case S.PROC_INST_BODY:if(!t.procInstBody&&E(c,r))continue;"?"===r?t.state=S.PROC_INST_ENDING:t.procInstBody+=r;continue;case S.PROC_INST_ENDING:">"===r?(M(t,"onprocessinginstruction",{name:t.procInstName,body:t.procInstBody}),t.procInstName=t.procInstBody="",t.state=S.TEXT):(t.procInstBody+="?"+r,t.state=S.PROC_INST_BODY);continue;case S.OPEN_TAG:E(y,r)?t.tagName+=r:(O(t),">"===r?B(t):"/"===r?t.state=S.OPEN_TAG_SLASH:(T(c,r)&&L(t,"Invalid character in tag name"),t.state=S.ATTRIB));continue;case S.OPEN_TAG_SLASH:">"===r?(B(t,!0),F(t)):(L(t,"Forward-slash in opening tag not followed by >"),t.state=S.ATTRIB);continue;case S.ATTRIB:if(E(c,r))continue;">"===r?B(t):"/"===r?t.state=S.OPEN_TAG_SLASH:E(v,r)?(t.attribName=r,t.attribValue="",t.state=S.ATTRIB_NAME):L(t,"Invalid attribute name");continue;case S.ATTRIB_NAME:"="===r?t.state=S.ATTRIB_VALUE:">"===r?(L(t,"Attribute without value"),t.attribValue=t.attribName,k(t),B(t)):E(c,r)?t.state=S.ATTRIB_NAME_SAW_WHITE:E(y,r)?t.attribName+=r:L(t,"Invalid attribute name");continue;case S.ATTRIB_NAME_SAW_WHITE:if("="===r)t.state=S.ATTRIB_VALUE;else{if(E(c,r))continue;L(t,"Attribute without value"),t.tag.attributes[t.attribName]="",t.attribValue="",M(t,"onattribute",{name:t.attribName,value:""}),t.attribName="",">"===r?B(t):E(v,r)?(t.attribName=r,t.state=S.ATTRIB_NAME):(L(t,"Invalid attribute name"),t.state=S.ATTRIB)}continue;case S.ATTRIB_VALUE:if(E(c,r))continue;E(d,r)?(t.q=r,t.state=S.ATTRIB_VALUE_QUOTED):(L(t,"Unquoted attribute value"),t.state=S.ATTRIB_VALUE_UNQUOTED,t.attribValue=r);continue;case S.ATTRIB_VALUE_QUOTED:if(r!==t.q){"&"===r?t.state=S.ATTRIB_VALUE_ENTITY_Q:t.attribValue+=r;continue}k(t),t.q="",t.state=S.ATTRIB_VALUE_CLOSED;continue;case S.ATTRIB_VALUE_CLOSED:E(c,r)?t.state=S.ATTRIB:">"===r?B(t):"/"===r?t.state=S.OPEN_TAG_SLASH:E(v,r)?(L(t,"No whitespace between attributes"),t.attribName=r,t.attribValue="",t.state=S.ATTRIB_NAME):L(t,"Invalid attribute name");continue;case S.ATTRIB_VALUE_UNQUOTED:if(T(h,r)){"&"===r?t.state=S.ATTRIB_VALUE_ENTITY_U:t.attribValue+=r;continue}k(t),">"===r?B(t):t.state=S.ATTRIB;continue;case S.CLOSE_TAG:if(t.tagName)">"===r?F(t):E(y,r)?t.tagName+=r:t.script?(t.script+="</"+t.tagName,t.tagName="",t.state=S.SCRIPT):(T(c,r)&&L(t,"Invalid tagname in closing tag"),t.state=S.CLOSE_TAG_SAW_WHITE);else{if(E(c,r))continue;T(v,r)?t.script?(t.script+="</"+r,t.state=S.SCRIPT):L(t,"Invalid tagname in closing tag."):t.tagName=r}continue;case S.CLOSE_TAG_SAW_WHITE:if(E(c,r))continue;">"===r?F(t):L(t,"Invalid characters in closing tag");continue;case S.TEXT_ENTITY:case S.ATTRIB_VALUE_ENTITY_Q:case S.ATTRIB_VALUE_ENTITY_U:var o,s;switch(t.state){case S.TEXT_ENTITY:o=S.TEXT,s="textNode";break;case S.ATTRIB_VALUE_ENTITY_Q:o=S.ATTRIB_VALUE_QUOTED,s="attribValue";break;case S.ATTRIB_VALUE_ENTITY_U:o=S.ATTRIB_VALUE_UNQUOTED,s="attribValue"}";"===r?(t[s]+=j(t),t.entity="",t.state=o):E(t.entity.length?b:_,r)?t.entity+=r:(L(t,"Invalid character in entity name"),t[s]+="&"+t.entity+r,t.entity="",t.state=o);continue;default:throw new Error(t,"Unknown state: "+t.state)}t.position>=t.bufferCheckPosition&&function(e){for(var t=Math.max(l.MAX_BUFFER_LENGTH,10),n=0,r=0,i=u.length;r<i;r++){var a=e[u[r]].length;if(t<a)switch(u[r]){case"textNode":R(e);break;case"cdata":M(e,"oncdata",e.cdata),e.cdata="";break;case"script":M(e,"onscript",e.script),e.script="";break;default:P(e,"Max buffer length exceeded: "+u[r])}n=Math.max(n,a)}var o=l.MAX_BUFFER_LENGTH-n;e.bufferCheckPosition=o+e.position}(t);return t},resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){!function(e){R(e),""!==e.cdata&&(M(e,"oncdata",e.cdata),e.cdata=""),""!==e.script&&(M(e,"onscript",e.script),e.script="")}(this)}};try{r=z("./node_modules/stream-browserify/index.js").Stream}catch(e){r=function(){}}var a=l.EVENTS.filter(function(e){return"error"!==e&&"end"!==e});function o(e,t){if(!(this instanceof o))return new o(e,t);r.apply(this),this._parser=new i(e,t),this.writable=!0,this.readable=!0;var n=this;this._parser.onend=function(){n.emit("end")},this._parser.onerror=function(e){n.emit("error",e),n._parser.error=null},this._decoder=null,a.forEach(function(t){Object.defineProperty(n,"on"+t,{get:function(){return n._parser["on"+t]},set:function(e){if(!e)return n.removeAllListeners(t),n._parser["on"+t]=e;n.on(t,e)},enumerable:!0,configurable:!1})})}(o.prototype=Object.create(r.prototype,{constructor:{value:o}})).write=function(e){if("function"==typeof V&&"function"==typeof V.isBuffer&&V.isBuffer(e)){if(!this._decoder){var t=z("./node_modules/string_decoder/lib/string_decoder.js").StringDecoder;this._decoder=new t("utf8")}e=this._decoder.write(e)}return this._parser.write(e.toString()),this.emit("data",e),!0},o.prototype.end=function(e){return e&&e.length&&this.write(e),this._parser.end(),!0},o.prototype.on=function(t,e){var n=this;return n._parser["on"+t]||-1===a.indexOf(t)||(n._parser["on"+t]=function(){var e=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);e.splice(0,0,t),n.emit.apply(n,e)}),r.prototype.on.call(n,t,e)};var c="\r\n\t ",e="0124356789",t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",d="'\"",h=c+">",f="[CDATA[",p="DOCTYPE",s="http://www.w3.org/XML/1998/namespace",m="http://www.w3.org/2000/xmlns/",g={xml:s,xmlns:m};c=n(c),e=n(e),t=n(t);var v=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,y=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/,_=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,b=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/;function n(e){return e.split("").reduce(function(e,t){return e[t]=!0,e},{})}function E(e,t){return function(e){return"[object RegExp]"===Object.prototype.toString.call(e)}(e)?!!t.match(e):e[t]}function T(e,t){return!E(e,t)}d=n(d),h=n(h);var A,w,S=0;for(var C in l.STATE={BEGIN:S++,BEGIN_WHITESPACE:S++,TEXT:S++,TEXT_ENTITY:S++,OPEN_WAKA:S++,SGML_DECL:S++,SGML_DECL_QUOTED:S++,DOCTYPE:S++,DOCTYPE_QUOTED:S++,DOCTYPE_DTD:S++,DOCTYPE_DTD_QUOTED:S++,COMMENT_STARTING:S++,COMMENT:S++,COMMENT_ENDING:S++,COMMENT_ENDED:S++,CDATA:S++,CDATA_ENDING:S++,CDATA_ENDING_2:S++,PROC_INST:S++,PROC_INST_BODY:S++,PROC_INST_ENDING:S++,OPEN_TAG:S++,OPEN_TAG_SLASH:S++,ATTRIB:S++,ATTRIB_NAME:S++,ATTRIB_NAME_SAW_WHITE:S++,ATTRIB_VALUE:S++,ATTRIB_VALUE_QUOTED:S++,ATTRIB_VALUE_CLOSED:S++,ATTRIB_VALUE_UNQUOTED:S++,ATTRIB_VALUE_ENTITY_Q:S++,ATTRIB_VALUE_ENTITY_U:S++,CLOSE_TAG:S++,CLOSE_TAG_SAW_WHITE:S++,SCRIPT:S++,SCRIPT_ENDING:S++},l.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},l.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(l.ENTITIES).forEach(function(e){var t=l.ENTITIES[e],n="number"==typeof t?String.fromCharCode(t):t;l.ENTITIES[e]=n}),l.STATE)l.STATE[l.STATE[C]]=C;function x(e,t,n){e[t]&&e[t](n)}function M(e,t,n){e.textNode&&R(e),x(e,t,n)}function R(e){e.textNode=I(e.opt,e.textNode),e.textNode&&x(e,"ontext",e.textNode),e.textNode=""}function I(e,t){return e.trim&&(t=t.trim()),e.normalize&&(t=t.replace(/\s+/g," ")),t}function P(e,t){return R(e),e.trackPosition&&(t+="\nLine: "+e.line+"\nColumn: "+e.column+"\nChar: "+e.c),t=new Error(t),e.error=t,x(e,"onerror",t),e}function D(e){return e.sawRoot&&!e.closedRoot&&L(e,"Unclosed root tag"),e.state!==S.BEGIN&&e.state!==S.BEGIN_WHITESPACE&&e.state!==S.TEXT&&P(e,"Unexpected end"),R(e),e.c="",e.closed=!0,x(e,"onend"),i.call(e,e.strict,e.opt),e}function L(e,t){if("object"!=typeof e||!(e instanceof i))throw new Error("bad call to strictFail");e.strict&&P(e,t)}function O(e){e.strict||(e.tagName=e.tagName[e.looseCase]());var t=e.tags[e.tags.length-1]||e,n=e.tag={name:e.tagName,attributes:{}};e.opt.xmlns&&(n.ns=t.ns),e.attribList.length=0,M(e,"onopentagstart",n)}function N(e,t){var n=e.indexOf(":")<0?["",e]:e.split(":"),r=n[0],i=n[1];return t&&"xmlns"===e&&(r="xmlns",i=""),{prefix:r,local:i}}function k(e){if(e.strict||(e.attribName=e.attribName[e.looseCase]()),-1!==e.attribList.indexOf(e.attribName)||e.tag.attributes.hasOwnProperty(e.attribName))e.attribName=e.attribValue="";else{if(e.opt.xmlns){var t=N(e.attribName,!0),n=t.prefix,r=t.local;if("xmlns"===n)if("xml"===r&&e.attribValue!==s)L(e,"xml: prefix must be bound to "+s+"\nActual: "+e.attribValue);else if("xmlns"===r&&e.attribValue!==m)L(e,"xmlns: prefix must be bound to "+m+"\nActual: "+e.attribValue);else{var i=e.tag,a=e.tags[e.tags.length-1]||e;i.ns===a.ns&&(i.ns=Object.create(a.ns)),i.ns[r]=e.attribValue}e.attribList.push([e.attribName,e.attribValue])}else e.tag.attributes[e.attribName]=e.attribValue,M(e,"onattribute",{name:e.attribName,value:e.attribValue});e.attribName=e.attribValue=""}}function B(t,e){if(t.opt.xmlns){var n=t.tag,r=N(t.tagName);n.prefix=r.prefix,n.local=r.local,n.uri=n.ns[r.prefix]||"",n.prefix&&!n.uri&&(L(t,"Unbound namespace prefix: "+JSON.stringify(t.tagName)),n.uri=r.prefix);var i=t.tags[t.tags.length-1]||t;n.ns&&i.ns!==n.ns&&Object.keys(n.ns).forEach(function(e){M(t,"onopennamespace",{prefix:e,uri:n.ns[e]})});for(var a=0,o=t.attribList.length;a<o;a++){var s=t.attribList[a],l=s[0],u=s[1],c=N(l,!0),d=c.prefix,h=c.local,f=""===d?"":n.ns[d]||"",p={name:l,value:u,prefix:d,local:h,uri:f};d&&"xmlns"!==d&&!f&&(L(t,"Unbound namespace prefix: "+JSON.stringify(d)),p.uri=d),t.tag.attributes[l]=p,M(t,"onattribute",p)}t.attribList.length=0}t.tag.isSelfClosing=!!e,t.sawRoot=!0,t.tags.push(t.tag),M(t,"onopentag",t.tag),e||(t.noscript||"script"!==t.tagName.toLowerCase()?t.state=S.TEXT:t.state=S.SCRIPT,t.tag=null,t.tagName=""),t.attribName=t.attribValue="",t.attribList.length=0}function F(n){if(!n.tagName)return L(n,"Weird empty close tag."),n.textNode+="</>",void(n.state=S.TEXT);if(n.script){if("script"!==n.tagName)return n.script+="</"+n.tagName+">",n.tagName="",void(n.state=S.SCRIPT);M(n,"onscript",n.script),n.script=""}var e=n.tags.length,t=n.tagName;n.strict||(t=t[n.looseCase]());for(var r=t;e--;){if(n.tags[e].name===r)break;L(n,"Unexpected close tag")}if(e<0)return L(n,"Unmatched closing tag: "+n.tagName),n.textNode+="</"+n.tagName+">",void(n.state=S.TEXT);n.tagName=t;for(var i=n.tags.length;i-- >e;){var a=n.tag=n.tags.pop();n.tagName=n.tag.name,M(n,"onclosetag",n.tagName);var o={};for(var s in a.ns)o[s]=a.ns[s];var l=n.tags[n.tags.length-1]||n;n.opt.xmlns&&a.ns!==l.ns&&Object.keys(a.ns).forEach(function(e){var t=a.ns[e];M(n,"onclosenamespace",{prefix:e,uri:t})})}0===e&&(n.closedRoot=!0),n.tagName=n.attribValue=n.attribName="",n.attribList.length=0,n.state=S.TEXT}function j(e){var t,n=e.entity,r=n.toLowerCase(),i="";return e.ENTITIES[n]?e.ENTITIES[n]:e.ENTITIES[r]?e.ENTITIES[r]:("#"===(n=r).charAt(0)&&(i="x"===n.charAt(1)?(n=n.slice(2),(t=parseInt(n,16)).toString(16)):(n=n.slice(1),(t=parseInt(n,10)).toString(10))),n=n.replace(/^0+/,""),i.toLowerCase()!==n?(L(e,"Invalid character entity"),"&"+e.entity+";"):String.fromCodePoint(t))}function U(e,t){"<"===t?(e.state=S.OPEN_WAKA,e.startTagPosition=e.position):T(c,t)&&(L(e,"Non-whitespace before first tag."),e.textNode=t,e.state=S.TEXT)}function H(e,t){var n="";return t<e.length&&(n=e.charAt(t)),n}function G(){var e,t,n=[],r=-1,i=arguments.length;if(!i)return"";for(var a="";++r<i;){var o=Number(arguments[r]);if(!isFinite(o)||o<0||1114111<o||w(o)!==o)throw RangeError("Invalid code point: "+o);o<=65535?n.push(o):(e=55296+((o-=65536)>>10),t=o%1024+56320,n.push(e,t)),(r+1===i||16384<n.length)&&(a+=A.apply(null,n),n.length=0)}return a}S=l.STATE,String.fromCodePoint||(A=String.fromCharCode,w=Math.floor,Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:G,configurable:!0,writable:!0}):String.fromCodePoint=G)}(t)}).call(this,z("./node_modules/node-libs-browser/node_modules/buffer/index.js").Buffer)},"./node_modules/setimmediate/setImmediate.js":function(e,t,n){(function(e,p){!function(n,r){if(!n.setImmediate){var i,a,t,o,s=1,l={},u=!1,c=n.document,e=Object.getPrototypeOf&&Object.getPrototypeOf(n);e=e&&e.setTimeout?e:n,i="[object process]"==={}.toString.call(n.process)?function(e){p.nextTick(function(){h(e)})}:function(){if(n.postMessage&&!n.importScripts){var e=!0,t=n.onmessage;return n.onmessage=function(){e=!1},n.postMessage("","*"),n.onmessage=t,e}}()?(o="setImmediate$"+Math.random()+"$",n.addEventListener?n.addEventListener("message",f,!1):n.attachEvent("onmessage",f),function(e){n.postMessage(o+e,"*")}):n.MessageChannel?((t=new MessageChannel).port1.onmessage=function(e){h(e.data)},function(e){t.port2.postMessage(e)}):c&&"onreadystatechange"in c.createElement("script")?(a=c.documentElement,function(e){var t=c.createElement("script");t.onreadystatechange=function(){h(e),t.onreadystatechange=null,a.removeChild(t),t=null},a.appendChild(t)}):function(e){setTimeout(h,0,e)},e.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var r={callback:e,args:t};return l[s]=r,i(s),s++},e.clearImmediate=d}function d(e){delete l[e]}function h(e){if(u)setTimeout(h,0,e);else{var t=l[e];if(t){u=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(r,n)}}(t)}finally{d(e),u=!1}}}}function f(e){e.source===n&&"string"==typeof e.data&&0===e.data.indexOf(o)&&h(+e.data.slice(o.length))}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n("./node_modules/webpack/buildin/global.js"),n("./node_modules/process/browser.js"))},"./node_modules/stream-browserify/index.js":function(e,t,n){e.exports=r;var c=n("./node_modules/node-libs-browser/node_modules/events/events.js").EventEmitter;function r(){c.call(this)}n("./node_modules/inherits/inherits_browser.js")(r,c),r.Readable=n("./node_modules/readable-stream/readable-browser.js"),r.Writable=n("./node_modules/readable-stream/writable-browser.js"),r.Duplex=n("./node_modules/readable-stream/duplex-browser.js"),r.Transform=n("./node_modules/readable-stream/transform.js"),r.PassThrough=n("./node_modules/readable-stream/passthrough.js"),(r.Stream=r).prototype.pipe=function(t,e){var n=this;function r(e){t.writable&&!1===t.write(e)&&n.pause&&n.pause()}function i(){n.readable&&n.resume&&n.resume()}n.on("data",r),t.on("drain",i),t._isStdio||e&&!1===e.end||(n.on("end",o),n.on("close",s));var a=!1;function o(){a||(a=!0,t.end())}function s(){a||(a=!0,"function"==typeof t.destroy&&t.destroy())}function l(e){if(u(),0===c.listenerCount(this,"error"))throw e}function u(){n.removeListener("data",r),t.removeListener("drain",i),n.removeListener("end",o),n.removeListener("close",s),n.removeListener("error",l),t.removeListener("error",l),n.removeListener("end",u),n.removeListener("close",u),t.removeListener("close",u)}return n.on("error",l),t.on("error",l),n.on("end",u),n.on("close",u),t.on("close",u),t.emit("pipe",n),t}},"./node_modules/string_decoder/lib/string_decoder.js":function(e,t,n){var r=n("./node_modules/safe-buffer/index.js").Buffer,i=r.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function a(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(r.isEncoding===i||!i(e)))throw new Error("Unknown encoding: "+e);return t||e}function o(e){var t;switch(this.encoding=a(e),this.encoding){case"utf16le":this.text=u,this.end=c,t=4;break;case"utf8":this.fillLast=l,t=4;break;case"base64":this.text=d,this.end=h,t=3;break;default:return this.write=f,void(this.end=p)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(t)}function s(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function l(e){var t=this.lastTotal-this.lastNeed,n=function(e,t){if(128!=(192&t[0]))return e.lastNeed=0,"�";if(1<e.lastNeed&&1<t.length){if(128!=(192&t[1]))return e.lastNeed=1,"�";if(2<e.lastNeed&&2<t.length&&128!=(192&t[2]))return e.lastNeed=2,"�"}}(this,e);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function u(e,t){if((e.length-t)%2!=0)return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1);var n=e.toString("utf16le",t);if(n){var r=n.charCodeAt(n.length-1);if(55296<=r&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],n.slice(0,-1)}return n}function c(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,n)}return t}function d(e,t){var n=(e.length-t)%3;return 0==n?e.toString("base64",t):(this.lastNeed=3-n,this.lastTotal=3,1==n?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-n))}function h(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function f(e){return e.toString(this.encoding)}function p(e){return e&&e.length?this.write(e):""}(t.StringDecoder=o).prototype.write=function(e){if(0===e.length)return"";var t,n;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<e.length?t?t+this.text(e,n):this.text(e,n):t||""},o.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"�":t},o.prototype.text=function(e,t){var n=function(e,t,n){var r=t.length-1;if(r<n)return 0;var i=s(t[r]);if(0<=i)return 0<i&&(e.lastNeed=i-1),i;if(--r<n||-2===i)return 0;if(0<=(i=s(t[r])))return 0<i&&(e.lastNeed=i-2),i;if(--r<n||-2===i)return 0;if(0<=(i=s(t[r])))return 0<i&&(2===i?i=0:e.lastNeed=i-3),i;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=n;var r=e.length-(n-this.lastNeed);return e.copy(this.lastChar,0,r),e.toString("utf8",t,r)},o.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},"./node_modules/util-deprecate/browser.js":function(e,t,n){(function(n){function r(e){try{if(!n.localStorage)return!1}catch(e){return!1}var t=n.localStorage[e];return null!=t&&"true"===String(t).toLowerCase()}e.exports=function(e,t){if(r("noDeprecation"))return e;var n=!1;return function(){if(!n){if(r("throwDeprecation"))throw new Error(t);r("traceDeprecation")?console.trace(t):console.warn(t),n=!0}return e.apply(this,arguments)}}}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./node_modules/webpack/buildin/global.js":function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},"./src/core/Debug.js":function(e,t,n){n.r(t);var a=n("./src/core/EventBus.js"),f=n("./src/core/events/Events.js"),r=n("./src/core/FactoryMaker.js"),o=1,p=2,m=3,g=4,v=5;function i(e){e=e||{};var t,s,l,u,n=this.context,c=Object(a.default)(n).getInstance(),d=e.settings,h=[];function r(e){return e&&e.bind?e.bind(window.console):window.console.log.bind(window.console)}function i(e,t){var n="",r=null;s&&(r=(new Date).getTime(),n+="["+(r-u)+"]"),l&&t&&t.getClassName&&(n+="["+t.getClassName()+"]",t.getType&&(n+="["+t.getType()+"]")),0<n.length&&(n+=" ");for(var i=arguments.length,a=new Array(2<i?i-2:0),o=2;o<i;o++)a[o-2]=arguments[o];Array.apply(null,a).forEach(function(e){n+=e+" "}),h[e]&&d.get().debug.logLevel>=e&&h[e](n),d&&d.get().debug.dispatchEvent&&c.trigger(f.default.LOG,{message:n,level:e})}return t={getLogger:function(e){return{fatal:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];i.apply(void 0,[o,this].concat(t))}.bind(e),error:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];i.apply(void 0,[p,this].concat(t))}.bind(e),warn:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];i.apply(void 0,[m,this].concat(t))}.bind(e),info:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];i.apply(void 0,[g,this].concat(t))}.bind(e),debug:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];i.apply(void 0,[v,this].concat(t))}.bind(e)}},setLogTimestampVisible:function(e){s=e},setCalleeNameVisible:function(e){l=e}},l=s=!0,u=(new Date).getTime(),"undefined"!=typeof window&&window.console&&(h[o]=r(window.console.error),h[p]=r(window.console.error),h[m]=r(window.console.warn),h[g]=r(window.console.info),h[v]=r(window.console.debug)),t}i.__dashjs_factory_name="Debug";var s=r.default.getSingletonFactory(i);s.LOG_LEVEL_NONE=0,s.LOG_LEVEL_FATAL=o,s.LOG_LEVEL_ERROR=p,s.LOG_LEVEL_WARNING=m,s.LOG_LEVEL_INFO=g,s.LOG_LEVEL_DEBUG=v,r.default.updateSingletonFactory(i.__dashjs_factory_name,s),t.default=s},"./src/core/EventBus.js":function(e,t,n){n.r(t);var r=n("./src/core/FactoryMaker.js"),i=n("./src/streaming/MediaPlayerEvents.js");function a(){var o={};function s(e,n,r){var i=-1;return o[e]&&o[e].some(function(e,t){if(e&&e.callback===n&&(!r||r===e.scope))return i=t,!0}),i}return{on:function(n,e,t){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};if(!n)throw new Error("event type cannot be null or undefined");if(!e||"function"!=typeof e)throw new Error("listener must be a function: "+e);var i=r.priority||0;if(!(0<=s(n,e,t))){o[n]=o[n]||[];var a={callback:e,scope:t,priority:i};t&&t.getStreamId&&(a.streamId=t.getStreamId()),t&&t.getType&&(a.mediaType=t.getType()),r&&r.mode&&(a.mode=r.mode),o[n].some(function(e,t){if(e&&i>e.priority)return o[n].splice(t,0,a),!0})||o[n].push(a)}},off:function(e,t,n){if(e&&t&&o[e]){var r=s(e,t,n);r<0||(o[e][r]=null)}},trigger:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};if(e&&o[e]){if((t=t||{}).hasOwnProperty("type"))throw new Error("'type' is a reserved word for event dispatching");t.type=e,n.streamId&&(t.streamId=n.streamId),n.mediaType&&(t.mediaType=n.mediaType),o[e].filter(function(e){return!!e&&((!n.streamId||!e.streamId||e.streamId===n.streamId)&&((!n.mediaType||!e.mediaType||e.mediaType===n.mediaType)&&!(n.mode&&e.mode&&e.mode!==n.mode||!e.mode&&n.mode&&n.mode===i.default.EVENT_MODE_ON_RECEIVE)))}).forEach(function(e){return e&&e.callback.call(e.scope,t)})}},reset:function(){o={}}}}a.__dashjs_factory_name="EventBus";var o=r.default.getSingletonFactory(a);o.EVENT_PRIORITY_LOW=0,o.EVENT_PRIORITY_HIGH=5e3,r.default.updateSingletonFactory(a.__dashjs_factory_name,o),t.default=o},"./src/core/FactoryMaker.js":function(e,t,n){n.r(t);var l,a,r,i,o=(a=[],r={},i={},l={extend:function(e,t,n,r){!r[e]&&t&&(r[e]={instance:t,override:n})},getSingletonInstance:s,setSingletonInstance:function(e,t,n){for(var r in a){var i=a[r];if(i.context===e&&i.name===t)return void(a[r].instance=n)}a.push({name:t,context:e,instance:n})},deleteSingletonInstances:function(t){a=a.filter(function(e){return e.context!==t})},getSingletonFactory:function(n){var e=u(n.__dashjs_factory_name,r);return e||(e=function(e){var t;return void 0===e&&(e={}),{getInstance:function(){return(t=t||s(e,n.__dashjs_factory_name))||(t=d(n,e,arguments),a.push({name:n.__dashjs_factory_name,context:e,instance:t})),t}}},r[n.__dashjs_factory_name]=e),e},getSingletonFactoryByName:function(e){return u(e,r)},updateSingletonFactory:function(e,t){c(e,t,r)},getClassFactory:function(t){var e=u(t.__dashjs_factory_name,i);return e||(e=function(e){return void 0===e&&(e={}),{create:function(){return d(t,e,arguments)}}},i[t.__dashjs_factory_name]=e),e},getClassFactoryByName:function(e){return u(e,i)},updateClassFactory:function(e,t){c(e,t,i)}});function s(e,t){for(var n in a){var r=a[n];if(r.context===e&&r.name===t)return r.instance}return null}function u(e,t){return t[e]}function c(e,t,n){e in n&&(n[e]=t)}function d(e,t,n){var r,i=e.__dashjs_factory_name,a=t[i];if(a){var o=a.instance;if(!a.override)return o.apply({context:t,factory:l},n);for(var s in r=e.apply({context:t},n),o=o.apply({context:t,factory:l,parent:r},n))r.hasOwnProperty(s)&&(r[s]=o[s])}else r=e.apply({context:t},n);return r.getClassName=function(){return i},r}t.default=o},"./src/core/Settings.js":function(e,t,n){n.r(t);var r=n("./src/core/FactoryMaker.js"),a=n("./src/core/Utils.js"),i=n("./src/core/Debug.js"),o=n("./src/streaming/constants/Constants.js"),s=n("./src/streaming/vo/metrics/HTTPRequest.js");function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(){var e,t,n={debug:{logLevel:i.default.LOG_LEVEL_WARNING,dispatchEvent:!1},streaming:{abandonLoadTimeout:1e4,wallclockTimeUpdateInterval:100,lowLatencyEnabled:!1,lowLatencyEnabledByManifest:!0,manifestUpdateRetryInterval:100,cacheInitSegments:!1,eventControllerRefreshDelay:150,capabilities:{filterUnsupportedEssentialProperties:!0,useMediaCapabilitiesApi:!1},timeShiftBuffer:{calcFromSegmentTimeline:!1,fallbackToSegmentTimeline:!0},metrics:{maxListDepth:100},delay:{liveDelayFragmentCount:NaN,liveDelay:NaN,useSuggestedPresentationDelay:!0,applyServiceDescription:!0},protection:{keepProtectionMediaKeys:!1,ignoreEmeEncryptedEvent:!1},buffer:{enableSeekDecorrelationFix:!1,fastSwitchEnabled:!0,flushBufferAtTrackSwitch:!1,reuseExistingSourceBuffers:!0,bufferPruningInterval:10,bufferToKeep:20,bufferTimeAtTopQuality:30,bufferTimeAtTopQualityLongForm:60,initialBufferLevel:NaN,stableBufferTime:12,longFormContentDurationThreshold:600,stallThreshold:.3,useAppendWindow:!0,setStallState:!0},gaps:{jumpGaps:!0,jumpLargeGaps:!0,smallGapLimit:1.5,threshold:.3,enableSeekFix:!1},utcSynchronization:{enabled:!0,useManifestDateHeaderTimeSource:!0,backgroundAttempts:2,timeBetweenSyncAttempts:30,maximumTimeBetweenSyncAttempts:600,minimumTimeBetweenSyncAttempts:2,timeBetweenSyncAttemptsAdjustmentFactor:2,maximumAllowedDrift:100,enableBackgroundSyncAfterSegmentDownloadError:!0,defaultTimingSource:{scheme:"urn:mpeg:dash:utc:http-xsdate:2014",value:"https://time.akamai.com/?iso&ms"}},scheduling:{defaultTimeout:500,lowLatencyTimeout:0,scheduleWhilePaused:!0},text:{defaultEnabled:!0},liveCatchup:{minDrift:.02,maxDrift:12,playbackRate:.5,latencyThreshold:60,playbackBufferMin:.5,enabled:!1,mode:o.default.LIVE_CATCHUP_MODE_DEFAULT},lastBitrateCachingInfo:{enabled:!0,ttl:36e4},lastMediaSettingsCachingInfo:{enabled:!0,ttl:36e4},cacheLoadThresholds:{video:50,audio:5},trackSwitchMode:{audio:o.default.TRACK_SWITCH_MODE_ALWAYS_REPLACE,video:o.default.TRACK_SWITCH_MODE_NEVER_REPLACE},selectionModeForInitialTrack:o.default.TRACK_SELECTION_MODE_HIGHEST_SELECTION_PRIORITY,fragmentRequestTimeout:0,retryIntervals:(e={},u(e,s.HTTPRequest.MPD_TYPE,500),u(e,s.HTTPRequest.XLINK_EXPANSION_TYPE,500),u(e,s.HTTPRequest.MEDIA_SEGMENT_TYPE,1e3),u(e,s.HTTPRequest.INIT_SEGMENT_TYPE,1e3),u(e,s.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,1e3),u(e,s.HTTPRequest.INDEX_SEGMENT_TYPE,1e3),u(e,s.HTTPRequest.MSS_FRAGMENT_INFO_SEGMENT_TYPE,1e3),u(e,s.HTTPRequest.LICENSE,1e3),u(e,s.HTTPRequest.OTHER_TYPE,1e3),u(e,"lowLatencyReductionFactor",10),e),retryAttempts:(t={},u(t,s.HTTPRequest.MPD_TYPE,3),u(t,s.HTTPRequest.XLINK_EXPANSION_TYPE,1),u(t,s.HTTPRequest.MEDIA_SEGMENT_TYPE,3),u(t,s.HTTPRequest.INIT_SEGMENT_TYPE,3),u(t,s.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,3),u(t,s.HTTPRequest.INDEX_SEGMENT_TYPE,3),u(t,s.HTTPRequest.MSS_FRAGMENT_INFO_SEGMENT_TYPE,3),u(t,s.HTTPRequest.LICENSE,3),u(t,s.HTTPRequest.OTHER_TYPE,3),u(t,"lowLatencyMultiplyFactor",5),t),abr:{movingAverageMethod:o.default.MOVING_AVERAGE_SLIDING_WINDOW,ABRStrategy:o.default.ABR_STRATEGY_DYNAMIC,additionalAbrRules:{insufficientBufferRule:!0,switchHistoryRule:!0,droppedFramesRule:!0,abandonRequestsRule:!1},bandwidthSafetyFactor:.9,useDefaultABRRules:!0,useDeadTimeLatency:!0,limitBitrateByPortal:!1,usePixelRatioInLimitBitrateByPortal:!1,maxBitrate:{audio:-1,video:-1},minBitrate:{audio:-1,video:-1},maxRepresentationRatio:{audio:1,video:1},initialBitrate:{audio:-1,video:-1},initialRepresentationRatio:{audio:-1,video:-1},autoSwitchBitrate:{audio:!0,video:!0},fetchThroughputCalculationMode:o.default.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING},cmcd:{enabled:!1,sid:null,cid:null,rtp:null,rtpSafetyFactor:5,mode:o.default.CMCD_MODE_QUERY}},errors:{recoverAttempts:{mediaErrorDecode:5}}},r=a.default.clone(n);return{get:function(){return r},update:function(e){"object"===l(e)&&!function e(t,n,r){for(var i in t)t.hasOwnProperty(i)&&n.hasOwnProperty(i)&&("object"===l(t[i])&&null!==t[i]?e(t[i],n[i],r.slice()+i+"."):n[i]=a.default.clone(t[i]))}(e,r,"")},reset:function(){r=a.default.clone(n)}}}c.__dashjs_factory_name="Settings";var d=r.default.getSingletonFactory(c);t.default=d},"./src/core/Utils.js":function(e,t,n){n.r(t);var r=n("./node_modules/path-browserify/index.js"),s=n.n(r);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(){function o(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o)}return function(e,t,n){t&&i(e.prototype,t),n&&i(e,n)}(o,null,[{key:"mixin",value:function(e,t,n){var r,i={};if(e)for(var a in t)t.hasOwnProperty(a)&&(r=t[a],a in e&&(e[a]===r||a in i&&i[a]===r)||("object"===l(e[a])&&null!==e[a]?e[a]=o.mixin(e[a],r,n):e[a]=n(r)));return e}},{key:"clone",value:function(e){if(!e||"object"!==l(e))return e;var t;if(e instanceof Array){t=[];for(var n=0,r=e.length;n<r;++n)n in e&&t.push(o.clone(e[n]))}else t={};return o.mixin(t,e,o.clone)}},{key:"addAditionalQueryParameterToUrl",value:function(t,e){try{if(!e||0===e.length)return t;var n=new URL(t);return e.forEach(function(e){e.key&&e.value&&n.searchParams.set(e.key,e.value)}),n.href}catch(e){return t}}},{key:"parseHttpHeaders",value:function(e){var t={};if(!e)return t;for(var n=e.trim().split("\r\n"),r=0,i=n.length;r<i;r++){var a=n[r],o=a.indexOf(": ");0<o&&(t[a.substring(0,o)]=a.substring(o+2))}return t}},{key:"generateUuid",value:function(){var n=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=(n+16*Math.random())%16|0;return n=Math.floor(n/16),("x"==e?t:3&t|8).toString(16)})}},{key:"generateHashCode",value:function(e){var t=0;if(0===e.length)return t;for(var n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n),t|=0}return t}},{key:"getRelativeUrl",value:function(e,t){try{var n=new URL(e),r=new URL(t);if(n.protocol=r.protocol,n.origin!==r.origin)return t;var i=s.a.relative(n.pathname.substr(0,n.pathname.lastIndexOf("/")),r.pathname.substr(0,r.pathname.lastIndexOf("/"))),a=0===i.length?1:0;return i+=r.pathname.substr(r.pathname.lastIndexOf("/")+a,r.pathname.length-1),r.pathname.length<i.length?r.pathname:i}catch(e){return t}}}]),o}();t.default=a},"./src/core/Version.js":function(e,t,n){n.r(t),n.d(t,"getVersionString",function(){return i});var r="4.2.0";function i(){return r}},"./src/core/errors/Errors.js":function(e,t,n){n.r(t);var r=n("./src/core/errors/ErrorsBase.js");function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=s(r);if(i){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}(this,e)}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=new(function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(n,r["default"]);var t=o(n);function n(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=t.call(this)).MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE=10,e.MANIFEST_LOADER_LOADING_FAILURE_ERROR_CODE=11,e.XLINK_LOADER_LOADING_FAILURE_ERROR_CODE=12,e.SEGMENT_BASE_LOADER_ERROR_CODE=15,e.TIME_SYNC_FAILED_ERROR_CODE=16,e.FRAGMENT_LOADER_LOADING_FAILURE_ERROR_CODE=17,e.FRAGMENT_LOADER_NULL_REQUEST_ERROR_CODE=18,e.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE=19,e.APPEND_ERROR_CODE=20,e.REMOVE_ERROR_CODE=21,e.DATA_UPDATE_FAILED_ERROR_CODE=22,e.CAPABILITY_MEDIASOURCE_ERROR_CODE=23,e.CAPABILITY_MEDIAKEYS_ERROR_CODE=24,e.DOWNLOAD_ERROR_ID_MANIFEST_CODE=25,e.DOWNLOAD_ERROR_ID_SIDX_CODE=26,e.DOWNLOAD_ERROR_ID_CONTENT_CODE=27,e.DOWNLOAD_ERROR_ID_INITIALIZATION_CODE=28,e.DOWNLOAD_ERROR_ID_XLINK_CODE=29,e.MANIFEST_ERROR_ID_PARSE_CODE=31,e.MANIFEST_ERROR_ID_NOSTREAMS_CODE=32,e.TIMED_TEXT_ERROR_ID_PARSE_CODE=33,e.MANIFEST_ERROR_ID_MULTIPLEXED_CODE=34,e.MEDIASOURCE_TYPE_UNSUPPORTED_CODE=35,e.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE="parsing failed for ",e.MANIFEST_LOADER_LOADING_FAILURE_ERROR_MESSAGE="Failed loading manifest: ",e.XLINK_LOADER_LOADING_FAILURE_ERROR_MESSAGE="Failed loading Xlink element: ",e.SEGMENTS_UPDATE_FAILED_ERROR_MESSAGE="Segments update failed",e.SEGMENTS_UNAVAILABLE_ERROR_MESSAGE="no segments are available yet",e.SEGMENT_BASE_LOADER_ERROR_MESSAGE="error loading segment ranges from sidx",e.TIME_SYNC_FAILED_ERROR_MESSAGE="Failed to synchronize client and server time",e.FRAGMENT_LOADER_NULL_REQUEST_ERROR_MESSAGE="request is null",e.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE="Failed to resolve a valid URL",e.APPEND_ERROR_MESSAGE="chunk is not defined",e.REMOVE_ERROR_MESSAGE="Removing data from the SourceBuffer",e.DATA_UPDATE_FAILED_ERROR_MESSAGE="Data update failed",e.CAPABILITY_MEDIASOURCE_ERROR_MESSAGE="mediasource is not supported",e.CAPABILITY_MEDIAKEYS_ERROR_MESSAGE="mediakeys is not supported",e.TIMED_TEXT_ERROR_MESSAGE_PARSE="parsing error :",e.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE="Error creating source buffer of type : ",e}return n}());t.default=l},"./src/core/errors/ErrorsBase.js":function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.r(t);var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return function(e,t,n){t&&r(e.prototype,t),n&&r(e,n)}(e,[{key:"extend",value:function(e,t){if(e){var n=!!t&&t.override,r=!!t&&t.publicOnly;for(var i in e)!e.hasOwnProperty(i)||this[i]&&!n||r&&-1===e[i].indexOf("public_")||(this[i]=e[i])}}}]),e}();t.default=i},"./src/core/events/CoreEvents.js":function(e,t,n){n.r(t);var r=n("./src/core/events/EventsBase.js");function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=s(r);if(i){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}(this,e)}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(n,r["default"]);var t=o(n);function n(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=t.call(this)).ATTEMPT_BACKGROUND_SYNC="attemptBackgroundSync",e.BUFFERING_COMPLETED="bufferingCompleted",e.BUFFER_CLEARED="bufferCleared",e.BYTES_APPENDED_END_FRAGMENT="bytesAppendedEndFragment",e.BUFFER_REPLACEMENT_STARTED="bufferReplacementStarted",e.CHECK_FOR_EXISTENCE_COMPLETED="checkForExistenceCompleted",e.CURRENT_TRACK_CHANGED="currentTrackChanged",e.DATA_UPDATE_COMPLETED="dataUpdateCompleted",e.INBAND_EVENTS="inbandEvents",e.INITIAL_STREAM_SWITCH="initialStreamSwitch",e.INIT_FRAGMENT_LOADED="initFragmentLoaded",e.INIT_FRAGMENT_NEEDED="initFragmentNeeded",e.INTERNAL_MANIFEST_LOADED="internalManifestLoaded",e.ORIGINAL_MANIFEST_LOADED="originalManifestLoaded",e.LOADING_COMPLETED="loadingCompleted",e.LOADING_PROGRESS="loadingProgress",e.LOADING_DATA_PROGRESS="loadingDataProgress",e.LOADING_ABANDONED="loadingAborted",e.MANIFEST_UPDATED="manifestUpdated",e.MEDIA_FRAGMENT_LOADED="mediaFragmentLoaded",e.MEDIA_FRAGMENT_NEEDED="mediaFragmentNeeded",e.QUOTA_EXCEEDED="quotaExceeded",e.SEGMENT_LOCATION_BLACKLIST_ADD="segmentLocationBlacklistAdd",e.SEGMENT_LOCATION_BLACKLIST_CHANGED="segmentLocationBlacklistChanged",e.SERVICE_LOCATION_BLACKLIST_ADD="serviceLocationBlacklistAdd",e.SERVICE_LOCATION_BLACKLIST_CHANGED="serviceLocationBlacklistChanged",e.SET_FRAGMENTED_TEXT_AFTER_DISABLED="setFragmentedTextAfterDisabled",e.SET_NON_FRAGMENTED_TEXT="setNonFragmentedText",e.SOURCE_BUFFER_ERROR="sourceBufferError",e.STREAMS_COMPOSED="streamsComposed",e.STREAM_BUFFERING_COMPLETED="streamBufferingCompleted",e.STREAM_REQUESTING_COMPLETED="streamRequestingCompleted",e.TEXT_TRACKS_QUEUE_INITIALIZED="textTracksQueueInitialized",e.TIME_SYNCHRONIZATION_COMPLETED="timeSynchronizationComplete",e.UPDATE_TIME_SYNC_OFFSET="updateTimeSyncOffset",e.URL_RESOLUTION_FAILED="urlResolutionFailed",e.VIDEO_CHUNK_RECEIVED="videoChunkReceived",e.WALLCLOCK_TIME_UPDATED="wallclockTimeUpdated",e.XLINK_ELEMENT_LOADED="xlinkElementLoaded",e.XLINK_READY="xlinkReady",e.SEEK_TARGET="seekTarget",e}return n}();t.default=l},"./src/core/events/Events.js":function(e,t,n){n.r(t);var r=n("./src/core/events/CoreEvents.js");function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=s(r);if(i){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}(this,e)}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=new(function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(t,r["default"]);var e=o(t);function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.apply(this,arguments)}return t}());t.default=l},"./src/core/events/EventsBase.js":function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.r(t);var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return function(e,t,n){t&&r(e.prototype,t),n&&r(e,n)}(e,[{key:"extend",value:function(e,t){if(e){var n=!!t&&t.override,r=!!t&&t.publicOnly;for(var i in e)!e.hasOwnProperty(i)||this[i]&&!n||r&&-1===e[i].indexOf("public_")||(this[i]=e[i])}}}]),e}();t.default=i},"./src/dash/DashAdapter.js":function(e,t,n){n.r(t);var w=n("./src/dash/constants/DashConstants.js"),S=n("./src/dash/vo/RepresentationInfo.js"),C=n("./src/dash/vo/MediaInfo.js"),x=n("./src/dash/vo/StreamInfo.js"),M=n("./src/dash/vo/ManifestInfo.js"),R=n("./src/dash/vo/Event.js"),r=n("./src/core/FactoryMaker.js"),I=n("./src/dash/models/DashManifestModel.js"),P=n("./src/dash/models/PatchManifestModel.js");function i(){var e,v,s,c,d,y,o,t=this.context;function a(e,t,n){var r,i=v.getAdaptationsForType(c[0].mpd.manifest,e,t);if(!i||0===i.length)return null;if(1<i.length&&n){var a=f(n,t);if(d[n.id]&&d[n.id][t])for(var o=0,s=i.length;o<s;o++)if(h(d[n.id][t],a[o]))return i[o];for(var l=0,u=i.length;l<u;l++)if(r=i[l],v.getRolesForAdaptation(r).filter(function(e){return e.value===w.default.MAIN})[0])return i[l]}return i[0]}function h(e,t){if(!e||!t)return!1;var n=e.id===t.id,r=e.codec===t.codec,i=e.viewpoint===t.viewpoint,a=e.lang===t.lang,o=e.roles.toString()===t.roles.toString(),s=e.accessibility.toString()===t.accessibility.toString(),l=e.audioChannelConfiguration.toString()===t.audioChannelConfiguration.toString();return n&&r&&i&&a&&o&&s&&l}function l(e,t,n,r,i,a){var o,s,l,u,c,d,h=[];if(!r||0===r.length)return[];var f=v.getAdaptationsForPeriod(t);for(u=0,d=r.length;u<d;u++)if(o=r[u],s=_(f[l=v.getIndexForAdaptation(o,e,n.index)]),a){var p=s.accessibility.length;for(c=0;c<p;c++)if(s){var m=s.accessibility[c];if(0===m.indexOf("cea-608:")){var g=m.substring(8).split(";");if("CC"===g[0].substring(0,2))for(c=0;c<g.length;c++)b(s=s||_.call(this,f[l]),g[c].substring(0,3),g[c].substring(4)),h.push(s),s=null;else for(c=0;c<g.length;c++)b(s=s||_.call(this,f[l]),"CC"+(c+1),g[c]),h.push(s),s=null}else 0===m.indexOf("cea-608")&&(b(s,y.CC1,"eng"),h.push(s),s=null)}}else i===y.IMAGE?(s.type=y.IMAGE,h.push(s),s=null):s&&h.push(s);return h}function f(e,t,n){var r=c,i=n,a=[];if(i)E(),r=u(i);else{if(!(0<c.length))return a;i=c[0].mpd.manifest}var o=m(e,r),s=v.getAdaptationsForType(i,e?e.index:null,t);return a=l(i,o,e,s,t),t===y.TEXT&&(s=v.getAdaptationsForType(i,e?e.index:null,y.VIDEO),a=a.concat(l(i,o,e,s,t,!0))),a}function u(e){var t=n(e);return v.getRegularPeriods(t)}function n(e){var t=i(e);return v.getMpd(t)}function r(){c=[],d={}}function i(e){return e||(0<c.length?c[0].mpd.manifest:null)}function p(e){try{var t=m(e.streamInfo,c),n=v.getAdaptationsForPeriod(t);return e&&e.streamInfo&&void 0!==e.streamInfo.id&&n?n[e.index]:null}catch(e){return null}}function m(e,t){for(var n=t.length,r=0;r<n;r++){var i=t[r];if(e&&e.id===i.id)return i}return null}function _(e){if(!e)return null;var t,r=new C.default,n=e.period.mpd.manifest.Period_asArray[e.period.index].AdaptationSet_asArray[e.index];if(r.id=e.id,r.index=e.index,r.type=e.type,r.streamInfo=g(e.period),r.representationCount=v.getRepresentationCount(n),r.labels=v.getLabelsForAdaptation(n),r.lang=v.getLanguageForAdaptation(n),t=v.getViewpointForAdaptation(n),r.viewpoint=t?t.value:void 0,r.accessibility=v.getAccessibilityForAdaptation(n).map(function(e){var t=e.value,n=t;return e.schemeIdUri&&0<=e.schemeIdUri.search("cea-608")&&void 0!==o&&(n=t?"cea-608:"+t:"cea-608",r.embeddedCaptions=!0),n}),r.audioChannelConfiguration=v.getAudioChannelConfigurationForAdaptation(n).map(function(e){return e.value}),0===r.audioChannelConfiguration.length&&Array.isArray(n.Representation_asArray)&&0<n.Representation_asArray.length&&(r.audioChannelConfiguration=v.getAudioChannelConfigurationForRepresentation(n.Representation_asArray[0]).map(function(e){return e.value})),r.roles=v.getRolesForAdaptation(n).map(function(e){return e.value}),r.codec=v.getCodec(n),r.mimeType=v.getMimeType(n),r.contentProtection=v.getContentProtectionData(n),r.bitrateList=v.getBitrateListForAdaptation(n),r.selectionPriority=v.getSelectionPriority(n),r.contentProtection){var i=r.contentProtection.map(function(e){return v.getKID(e)}).filter(function(e){return null!==e});if(i.length){var a=i[0];r.contentProtection.forEach(function(e){e.keyId=a})}}return r.isText=v.getIsText(n),r.supplementalProperties=v.getSupplementalProperties(n),r.isFragmented=v.getIsFragmented(n),r.isEmbedded=!1,r}function b(e,t,n){e.id=t,e.index=100+parseInt(t.substring(2,3)),e.type=y.TEXT,e.codec="cea-608-in-SEI",e.isEmbedded=!0,e.isFragmented=!1,e.lang=n,e.roles=["caption"]}function g(e){var t=new x.default;return t.id=e.id,t.index=e.index,t.start=e.start,t.duration=e.duration,t.manifestInfo=function(e){var t=new M.default;return t.dvrWindowSize=e.timeShiftBufferDepth,t.loadedTime=e.manifest.loadedTime,t.availableFrom=e.availabilityStartTime,t.minBufferTime=e.manifest.minBufferTime,t.maxFragmentDuration=e.maxSegmentDuration,t.duration=v.getDuration(e.manifest),t.isDynamic=v.getIsDynamic(e.manifest),t.serviceDescriptions=v.getServiceDescriptions(e.manifest),t.protocol=e.manifest.protocol,t}(e.mpd),t.isLast=1===e.mpd.manifest.Period_asArray.length||Math.abs(t.start+t.duration-t.manifestInfo.duration)<1,t}function E(){if(!y)throw new Error("setConfig function has to be called previously")}function T(e){return 0<c.length?c[0].mpd.manifest.Period_asArray[e]:null}function A(e,t,n){var r,i,a,o,s;if(e)for(r=e.AdaptationSet_asArray,o=0;o<r.length;o+=1)for(a=r[o].Representation_asArray,s=0;s<a.length;s+=1)if(t===(i=a[s]).id)return n?s:i;return null}return e={getBandwidthForRepresentation:function(e,t){var n;return(n=A(T(t),e))?n.bandwidth:null},getIndexForRepresentation:function(e,t){return function(e,t){var n=A(e,t,!0);return null!==n?n:-1}(T(t),e)},getMaxIndexForBufferType:function(e,t){return function(e,t){var n,r,i,a;if(!e||!t)return-1;for(r=e.AdaptationSet_asArray,a=0;a<r.length;a+=1)if(n=r[a],i=n.Representation_asArray,v.getIsTypeOf(n,t))return i.length;return-1}(T(t),e)},convertRepresentationToRepresentationInfo:function(e){if(e){var t=new S.default,n=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index],r=v.getRepresentationFor(e.index,n);return t.id=e.id,t.quality=e.index,t.bandwidth=v.getBandwidth(r),t.fragmentDuration=e.segmentDuration||(e.segments&&0<e.segments.length?e.segments[0].duration:NaN),t.MSETimeOffset=e.MSETimeOffset,t.mediaInfo=_(e.adaptation),t}return null},getStreamsInfo:function(e,t){var n=[],r=c;if(e&&(E(),r=u(e)),0<r.length){(!t||t>r.length)&&(t=r.length);for(var i=0;i<t;i++)n.push(g(r[i]))}return n},getMediaInfoForType:function(e,t){if(0===c.length||!e)return null;var n=m(e,c);if(!n)return null;var r=v.getAdaptationsForPeriod(n),i=a(e.index,t,e);return i?_(r[v.getIndexForAdaptation(i,c[0].mpd.manifest,e.index)]):null},getAllMediaInfoForType:f,getAdaptationForType:a,getRealAdaptation:function(e,t){var n,r,i=m(e,c);return n=t?t.id:null,0<c.length&&i&&(r=n?v.getAdaptationForId(n,c[0].mpd.manifest,i.index):v.getAdaptationForIndex(t?t.index:null,c[0].mpd.manifest,i.index)),r},getRealPeriodByIndex:function(e){return v.getRealPeriodForIndex(e,c[0].mpd.manifest)},getEssentialPropertiesForRepresentation:function(e){try{return v.getEssentialPropertiesForRepresentation(e)}catch(e){return[]}},getVoRepresentations:function(e){var t=p(e);return v.getRepresentationsForAdaptation(t)},getEventsFor:function(e,t){var n=[];if(0<c.length){var r=c[0].mpd.manifest;e instanceof x.default?n=v.getEventsForPeriod(m(e,c)):e instanceof C.default?n=v.getEventStreamForAdaptationSet(r,p(e)):e instanceof S.default&&(n=v.getEventStreamForRepresentation(r,t))}return n},getEvent:function(e,t,n,r){try{if(!e||!t||isNaN(n)||!r)return null;var i=e.scheme_id_uri,a=e.value;if(!t[i+"/"+a])return null;var o,s=new R.default,l=e.timescale||1,u=r.adaptation.period.start,c=t[i+"/"+a],d=isNaN(r.presentationTimeOffset)?isNaN(c.presentationTimeOffset)?0:c.presentationTimeOffset:r.presentationTimeOffset,h=e.presentation_time_delta/l;o=0===e.version?u+n-d+h:u-d+h;var f=e.event_duration,p=e.id,m=e.message_data;return s.eventStream=c,s.eventStream.value=a,s.eventStream.timescale=l,s.duration=f,s.id=p,s.calculatedPresentationTime=o,s.messageData=m,s.presentationTimeDelta=h,s}catch(e){return null}},getMpd:n,setConfig:function(e){e&&(e.constants&&(y=e.constants),e.cea608parser&&(o=e.cea608parser),e.errHandler&&v.setConfig({errHandler:e.errHandler}),e.BASE64&&v.setConfig({BASE64:e.BASE64}))},updatePeriods:function(e){if(!e)return null;E(),c=u(e)},getIsTextTrack:function(e){return v.getIsText(e)},getUTCTimingSources:function(){var e=i();return v.getUTCTimingSources(e)},getSuggestedPresentationDelay:function(){var e=0<c.length?c[0].mpd:null;return v.getSuggestedPresentationDelay(e)},getAvailabilityStartTime:function(e){var t=n(e);return v.getAvailabilityStartTime(t)},getIsTypeOf:function(e,t){return v.getIsTypeOf(e,t)},getIsDynamic:function(e){var t=i(e);return v.getIsDynamic(t)},getDuration:function(e){var t=i(e);return v.getDuration(t)},getRegularPeriods:u,getLocation:function(e){return v.getLocation(e)},getPatchLocation:function(e){var t=v.getPatchLocation(e),n=v.getPublishTime(e);if(!t||!n)return null;if(t.hasOwnProperty("ttl")&&n){var r=1e3*parseFloat(t.ttl);if(n.getTime()+r<=(new Date).getTime())return null}return t.__text},getManifestUpdatePeriod:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return v.getManifestUpdatePeriod(e,t)},getPublishTime:function(e){return v.getPublishTime(e)},getIsDVB:function(e){return v.hasProfile(e,"urn:dvb:dash:profile:dvb-dash:2014")},getIsPatch:function(e){return s.getIsPatch(e)},getBaseURLsFromElement:function(e){return v.getBaseURLsFromElement(e)},getRepresentationSortFunction:function(){return v.getRepresentationSortFunction()},getCodec:function(e,t,n){return v.getCodec(e,t,n)},getPeriodById:function(t){if(!t||0===c.length)return null;var e=c.filter(function(e){return e.id===t});return e&&0<e.length?e[0]:null},setCurrentMediaInfo:function(e,t,n){d[e]=d[e]||{},d[e][t]=d[e][t]||{},d[e][t]=n},isPatchValid:function(e,t){var n=v.getId(e),r=s.getMpdId(t),i=v.getPublishTime(e),a=s.getPublishTime(t),o=s.getOriginalPublishTime(t);return!!(n&&r&&n==r&&i&&o&&i.getTime()==o.getTime()&&a&&i.getTime()<a.getTime())},applyPatchToManifest:function(r,e){s.getPatchOperations(e).forEach(function(i){var e=i.getMpdTarget(r);if(null!==e){var a=e.name,o=e.target,t=e.leaf;if(i.xpath.findsAttribute())switch(i.action){case"add":case"replace":o[a]=i.value;break;case"remove":delete o[a]}else{var s=(o[a+"_asArray"]||[]).indexOf(t),l="prepend"===i.position||"before"===i.position;if(("remove"===i.action||"replace"===i.action)&&(delete o[a],-1!=s)){var n=o[a+"_asArray"];n.splice(s,1),1<n.length?o[a]=n:1==n.length?o[a]=n[0]:delete o[a+"_asArray"]}"add"!==i.action&&"replace"!==i.action||Object.keys(i.value).forEach(function(e){var t=i.value[e],n=o[e+"_asArray"]||[];if(0===n.length&&o[e]&&n.push(o[e]),0===n.length)n=t;else{var r=n.length;r=e==a&&-1!=s?s+(l?0:1)+("replace"==i.action?-1:0):l?0:n.length,n.splice.apply(n,[r,0].concat(t))}o[e+"_asArray"]=n,o[e]=1==n.length?n[0]:n})}}})},areMediaInfosEqual:h,reset:r},v=Object(I.default)(t).getInstance(),s=Object(P.default)(t).getInstance(),r(),e}i.__dashjs_factory_name="DashAdapter",t.default=r.default.getSingletonFactory(i)},"./src/dash/DashHandler.js":function(e,t,n){n.r(t);var b=n("./src/streaming/vo/FragmentRequest.js"),E=n("./src/streaming/vo/metrics/HTTPRequest.js"),r=n("./src/core/FactoryMaker.js"),T=n("./src/streaming/MediaPlayerEvents.js"),A=n("./src/dash/utils/SegmentsUtils.js"),w=n("./src/dash/constants/DashConstants.js");function i(e){var t,a,o,s,l,n=(e=e||{}).eventBus,r=e.debug,u=e.urlUtils,i=e.type,c=e.streamInfo,d=e.segmentsController,h=e.timelineConverter,f=e.baseURLController;function p(){return i}function m(){o=null}function g(e,t,n){var r,i,a=f.resolve(n.path);return a&&t!==a.url&&u.isRelative(t)?(r=a.url,i=a.serviceLocation,t&&(r=u.resolve(t,r))):r=t,!u.isRelative(r)&&(e.url=r,e.serviceLocation=i,!0)}function v(e,t){if(null==t)return null;var n=new b.default,r=t.representation,i=r.adaptation.period.mpd.manifest.Period_asArray[r.adaptation.period.index].AdaptationSet_asArray[r.adaptation.index].Representation_asArray[r.index].bandwidth,a=t.media;return a=Object(A.replaceTokenForTemplate)(a,"Number",t.replacementNumber),a=Object(A.replaceTokenForTemplate)(a,"Time",t.replacementTime),a=Object(A.replaceTokenForTemplate)(a,"Bandwidth",i),a=Object(A.replaceIDForTemplate)(a,r.id),a=Object(A.unescapeDollarsInTemplate)(a),n.mediaType=p(),n.type=E.HTTPRequest.MEDIA_SEGMENT_TYPE,n.range=t.mediaRange,n.startTime=t.presentationStartTime,n.mediaStartTime=t.mediaStartTime,n.duration=t.duration,n.timescale=r.timescale,n.availabilityStartTime=t.availabilityStartTime,n.availabilityEndTime=t.availabilityEndTime,n.wallStartTime=t.wallStartTime,n.quality=r.index,n.index=t.index,n.mediaInfo=e,n.adaptationIndex=r.adaptation.index,n.representationId=r.id,g(n,a,r)?n:void 0}function y(e,t,n){var r=null;if(!t||!t.segmentInfoType)return r;var i=d.getSegmentByTime(t,n);return i&&(o=i,a.debug("Index for time "+n+" is "+i.index),r=v(e,i)),r}function _(){a.debug("Dynamic stream complete"),l=!0}return t={initialize:function(e){s=e,l=!1,d.initialize(e)},getStreamId:function(){return c.id},getType:p,getStreamInfo:function(){return c},getInitRequest:function(e,t){return t?function(e,t,n){var r=new b.default,i=t.adaptation.period,a=i.start;if(r.mediaType=n,r.type=E.HTTPRequest.INIT_SEGMENT_TYPE,r.range=t.range,r.availabilityStartTime=h.calcAvailabilityStartTimeFromPresentationTime(a,t,s),r.availabilityEndTime=h.calcAvailabilityEndTimeFromPresentationTime(a+i.duration,t,s),r.quality=t.index,r.mediaInfo=e,r.representationId=t.id,g(r,t.initialization,t))return r.url=Object(A.replaceTokenForTemplate)(r.url,"Bandwidth",t.bandwidth),r}(e,t,p()):null},getSegmentRequestForTime:y,getCurrentIndex:function(){return o?o.index:-1},getNextSegmentRequest:function(e,t){var n=null;if(!t||!t.segmentInfoType)return null;var r=o?o.index+1:0,i=d.getSegmentByIndex(t,r,o?o.mediaStartTime:-1);if(i)n=v(e,i),o=i;else{if(s&&!l)return a.debug(p()+" No segment found at index: "+r+". Wait for next loop"),null;l=!0}return n},isLastSegmentRequested:function(e,t){if(!e||!o)return!1;if(l)return!0;if(!isFinite(e.adaptation.period.duration))return!1;if(o.presentationStartTime+o.duration>t)return!1;if(e.mediaFinishedInformation&&!isNaN(e.mediaFinishedInformation.numberOfSegments)&&!isNaN(o.index)&&o.index>=e.mediaFinishedInformation.numberOfSegments-1){if(!s||e.segmentInfoType===w.default.SEGMENT_TEMPLATE)return!0;if(s&&e.segmentInfoType===w.default.SEGMENT_LIST&&e.adaptation.period.nextPeriodId)return!0}return!!(s&&e.adaptation.period.nextPeriodId&&e.segmentInfoType===w.default.SEGMENT_TIMELINE&&e.mediaFinishedInformation&&!isNaN(e.mediaFinishedInformation.mediaTimeOfLastSignaledSegment)&&o&&!isNaN(o.mediaStartTime)&&!isNaN(o.duration)&&o.mediaStartTime+o.duration>=e.mediaFinishedInformation.mediaTimeOfLastSignaledSegment-.05)},reset:function(){m(),n.off(T.default.DYNAMIC_TO_STATIC,_,t)},getNextSegmentRequestIdempotent:function(e,t){var n=o?o.index+1:0,r=d.getSegmentByIndex(t,n,o?o.mediaStartTime:-1);return r?v(e,r):null},getValidSeekTimeCloseToTargetTime:function(e,t,n,r){try{if(isNaN(e)||!t||!n)return NaN;if(e<0&&(e=0),isNaN(r)&&(r=.5),y(t,n,e))return e;for(var i=n.adaptation.period.start,a=n.adaptation.period.start+n.adaptation.period.duration,o=Math.min(e+r,a),s=Math.max(e-r,i),l=NaN,u=null;o<=a||i<=s;){var c=null,d=null;if(o<=a&&(c=y(t,n,o)),i<=s&&(d=y(t,n,s)),d){l=s,u=d;break}if(c){l=o,u=c;break}o+=r,s-=r}if(u){var h=u.startTime+u.duration;return e>=u.startTime&&r<h-e?e:e<u.startTime?u.startTime:Math.min(h-r,l)}return l}catch(e){return NaN}}},a=r.getLogger(t),m(),n.on(T.default.DYNAMIC_TO_STATIC,_,t),t}i.__dashjs_factory_name="DashHandler",t.default=r.default.getClassFactory(i)},"./src/dash/DashMetrics.js":function(e,t,n){n.r(t);var c=n("./src/streaming/constants/Constants.js"),d=n("./src/streaming/vo/metrics/HTTPRequest.js"),r=n("./src/core/FactoryMaker.js"),h=n("./src/streaming/constants/MetricsConstants.js"),f=n("./src/dash/utils/Round10.js"),p=n("./src/streaming/models/MetricsModel.js"),m=n("./src/core/Utils.js"),g=n("./src/streaming/vo/metrics/PlayList.js");function i(e){e=e||{};var t,i,a,o,n=this.context,s=e.metricsModel;function l(e){var t=s.getMetricsFor(e,!0);if(!t)return null;var n,r=t.HttpList,i=null;if(!r||r.length<=0)return null;for(n=r.length-1;0<=n;){if(r[n].responsecode){i=r[n];break}n--}return i}function u(e){var t=s.getMetricsFor(e,!0);return t&&t.HttpList?t.HttpList:[]}function r(e,t){if(!e)return null;var n=e[t];return n&&0!==n.length?n[n.length-1]:null}return t={getCurrentRepresentationSwitch:function(e){return r(s.getMetricsFor(e,!0),h.default.TRACK_SWITCH)},getCurrentBufferState:function(e){return r(s.getMetricsFor(e,!0),h.default.BUFFER_STATE)},getCurrentBufferLevel:function(e){var t=r(s.getMetricsFor(e,!0),h.default.BUFFER_LEVEL);return t?f.default.round10(t.level/1e3,-3):0},getCurrentHttpRequest:l,getHttpRequests:u,getCurrentDroppedFrames:function(){return r(s.getMetricsFor(c.default.VIDEO,!0),h.default.DROPPED_FRAMES)},getCurrentSchedulingInfo:function(e){return r(s.getMetricsFor(e,!0),h.default.SCHEDULING_INFO)},getCurrentDVRInfo:function(e){return r(e?s.getMetricsFor(e,!0):s.getMetricsFor(c.default.VIDEO,!0)||s.getMetricsFor(c.default.AUDIO,!0),h.default.DVR_INFO)},getCurrentManifestUpdate:function(){return r(s.getMetricsFor(c.default.STREAM),h.default.MANIFEST_UPDATE)},getLatestFragmentRequestHeaderValueByID:function(e,t){if(!t)return null;var n={},r=l(e);r&&(n=m.default.parseHttpHeaders(r._responseHeaders));var i=n[t.toLowerCase()];return void 0===i?null:i},getLatestMPDRequestHeaderValueByID:function(e){if(!e)return null;var t,n,r,i={};for(r=(t=u(c.default.STREAM)).length-1;0<=r;r--)if((n=t[r]).type===d.HTTPRequest.MPD_TYPE){i=m.default.parseHttpHeaders(n._responseHeaders);break}var a=i[e.toLowerCase()];return void 0===a?null:a},addRepresentationSwitch:function(e,t,n,r,i){s.addRepresentationSwitch(e,t,n,r,i)},addDVRInfo:function(e,t,n,r){s.addDVRInfo(e,t,n,r)},updateManifestUpdateInfo:function(e){var t=this.getCurrentManifestUpdate();s.updateManifestUpdateInfo(t,e)},addManifestUpdateStreamInfo:function(e){if(e){var t=this.getCurrentManifestUpdate();s.addManifestUpdateStreamInfo(t,e.id,e.index,e.start,e.duration)}},addManifestUpdateRepresentationInfo:function(e,t){if(e){var n=this.getCurrentManifestUpdate();s.addManifestUpdateRepresentationInfo(n,e.id,e.index,e.streamIndex,t,e.presentationTimeOffset,e.startNumber,e.fragmentInfoType)}},addManifestUpdate:function(e){s.addManifestUpdate(c.default.STREAM,e.type,e.requestStartDate,e.requestEndDate)},addHttpRequest:function(e,t,n,r,i){s.addHttpRequest(e.mediaType,null,e.type,e.url,e.quality,t,e.serviceLocation||null,e.range||null,e.requestStartDate,e.firstByteDate,e.requestEndDate,n,e.duration,r,i)},addSchedulingInfo:function(e,t){s.addSchedulingInfo(e.mediaType,new Date,e.type,e.startTime,e.availabilityStartTime,e.duration,e.quality,e.range,t)},addRequestsQueue:function(e,t,n){s.addRequestsQueue(e,t,n)},addBufferLevel:function(e,t,n){s.addBufferLevel(e,t,n)},addBufferState:function(e,t,n){s.addBufferState(e,t,n)},addDroppedFrames:function(e){s.addDroppedFrames(c.default.VIDEO,e)},addPlayList:function(){o&&(s.addPlayList(o),o=null)},addDVBErrors:function(e){s.addDVBErrors(e)},createPlaylistMetrics:function(e,t){(o=new g.PlayList).start=new Date,o.mstart=e,o.starttype=t},createPlaylistTraceMetrics:function(e,t,n){!0===i&&(i=!1,(a=new g.PlayListTrace).representationid=e,a.start=new Date,a.mstart=t,a.playbackspeed=null!==n?n.toString():null)},updatePlayListTraceMetrics:function(e){if(a)for(var t in a)a[t]=e[t]},pushPlayListTraceMetrics:function(e,t){if(!1===i&&o&&a&&a.start){var n=a.start,r=e.getTime()-n.getTime();a.duration=r,a.stopreason=t,o.trace.push(a),i=!0}},clearAllCurrentMetrics:function(){s.clearAllCurrentMetrics()}},s=s||Object(p.default)(n).getInstance({settings:e.settings}),i=!0,o=a=null,t}i.__dashjs_factory_name="DashMetrics",t.default=r.default.getSingletonFactory(i)},"./src/dash/SegmentBaseLoader.js":function(e,t,n){n.r(t);var p=n("./src/dash/vo/Segment.js"),m=n("./src/streaming/vo/DashJSError.js"),r=n("./src/core/FactoryMaker.js"),g=n("./src/streaming/vo/FragmentRequest.js"),v=n("./src/streaming/net/URLLoader.js");function i(){var t,A,n,w,r,i,a,d,o,s,l,u,h,e=this.context;function c(e,t,n){n({segments:e,representation:t,error:e?void 0:new m.default(o.SEGMENT_BASE_LOADER_ERROR_CODE,o.SEGMENT_BASE_LOADER_ERROR_MESSAGE)})}function S(e,t){for(var n,r,i,a,o=e.references,s=o.length,l=e.timescale,u=e.earliest_presentation_time,c=t.range.start+e.offset+e.first_offset+e.size,d=[],h=0;h<s;h++)i=o[h].subsegment_duration,a=o[h].referenced_size,(n=new p.default).duration=i,n.startTime=u,n.timescale=l,r=c+a-1,n.mediaRange=c+"-"+r,d.push(n),u+=i,c+=a;return d}function f(e){if(e.url){var t=new g.default;return t.setInfo(e),t}}return t={setConfig:function(e){e.baseURLController&&(h=e.baseURLController),e.dashMetrics&&(i=e.dashMetrics),e.mediaPlayerModel&&(a=e.mediaPlayerModel),e.errHandler&&(n=e.errHandler),e.boxParser&&(w=e.boxParser),e.debug&&(A=e.debug.getLogger(t)),e.requestModifier&&(r=e.requestModifier),e.errors&&(o=e.errors),e.urlUtils&&(u=e.urlUtils),e.constants&&(s=e.constants),e.dashConstants&&(l=e.dashConstants)},initialize:function(){d=Object(v.default)(e).create({errHandler:n,dashMetrics:i,mediaPlayerModel:a,requestModifier:r,boxParser:w,errors:o,urlUtils:u,constants:s,dashConstants:l})},loadInitialization:function(t,n){return new Promise(function(e){!function t(n,r,i,e){var a=null;var o=n?h.resolve(n.path):null;var s=e||{init:!0,url:o?o.url:void 0,range:{start:0,end:1500},searching:!1,bytesLoaded:0,bytesToLoad:1500,mediaType:r};A.debug("Start searching for initialization.");var l=f(s);var u=function(e){if(s.bytesLoaded=s.range.end,!(a=w.findInitRange(e)))return s.range.end=s.bytesLoaded+s.bytesToLoad,t(n,r,i,s);n.range=a,i(n)};var c=function(){i(n)};d.load({request:l,success:u,error:c});A.debug("Perform init search: "+s.url)}(t,n,e)})},loadSegments:function(t,n,r){return new Promise(function(e){!function m(g,v,e,y,_,t){if(e&&(void 0===e.start||void 0===e.end)){var n=e?e.toString().split("-"):null;e=n?{start:parseFloat(n[0]),end:parseFloat(n[1])}:null}_=_||c;var b=null;var E=null;var r=!!e;var i=g?h.resolve(g.path):null;var T={init:!1,url:i?i.url:void 0,range:r?e:{start:0,end:1500},searching:!r,bytesLoaded:t?t.bytesLoaded:0,bytesToLoad:1500,mediaType:v};var a=f(T);var o=function(e){var t=T.bytesToLoad,n=e.byteLength;if(T.bytesLoaded=T.range.end-T.range.start,b=w.parse(e),(E=b.getBox("sidx"))&&E.isComplete){var r,i,a=E.references;if(null!=a&&0<a.length&&(r=1===a[0].reference_type),r){var o,s,l,u;A.debug("Initiate multiple SIDX load."),T.range.end=T.range.start+E.size;var c=[],d=0,h=(E.offset||T.range.start)+E.size,f=function(e){e?(c=c.concat(e),s<=++d&&(c.sort(function(e,t){return e.startTime-t.startTime<0?-1:0}),_(c,g,y))):_(null,g,y)};for(o=0,s=a.length;o<s;o++)u=(l=h)+a[o].referenced_size-1,h+=a[o].referenced_size,m(g,v,{start:l,end:u},y,f,T)}else A.debug("Parsing segments from SIDX. representation "+v+" - id: "+g.id+" for range : "+T.range.start+" - "+T.range.end),i=S(E,T),_(i,g,y)}else{if(E)T.range.start=E.offset||T.range.start,T.range.end=T.range.start+(E.size||t);else{if(n<T.bytesLoaded)return void _(null,g,y);var p=b.getLastBox();p&&p.size?(T.range.start=p.offset+p.size,T.range.end=T.range.start+t):T.range.end+=t}m(g,v,T.range,y,null,T)}};var s=function(){_(null,g,y)};d.load({request:a,success:o,error:s});A.debug("Perform SIDX load for type ".concat(v," : ").concat(T.url," with range ").concat(T.range.start," - ").concat(T.range.end))}(t,n,r,e)})},reset:function(){d&&(d.abort(),d=null)}}}i.__dashjs_factory_name="SegmentBaseLoader",t.default=r.default.getSingletonFactory(i)},"./src/dash/WebmSegmentBaseLoader.js":function(e,t,n){n.r(t);var b=n("./src/streaming/utils/EBMLParser.js"),o=n("./src/streaming/constants/Constants.js"),r=n("./src/core/FactoryMaker.js"),h=n("./src/dash/vo/Segment.js"),u=n("./src/streaming/vo/FragmentRequest.js"),c=n("./src/streaming/net/URLLoader.js"),d=n("./src/streaming/vo/DashJSError.js");function i(){var t,p,m,n,r,i,a,g,s,l,v=this.context;function y(e,t,n,r){var i,a,o,s,l,u,c,d;for(o=[],l=0,u=(a=function(e){var t,n,r=[],i=Object(b.default)(v).create({data:e});for(i.consumeTagAndSize(m.Segment.Cues);i.moreData()&&i.consumeTagAndSize(m.Segment.Cues.CuePoint,!0);){for((t={}).CueTime=i.parseTag(m.Segment.Cues.CuePoint.CueTime),t.CueTracks=[];i.moreData()&&i.consumeTag(m.Segment.Cues.CuePoint.CueTrackPositions,!0);){var a=i.getMatroskaCodedNum(),o=i.getPos();if((n={}).Track=i.parseTag(m.Segment.Cues.CuePoint.CueTrackPositions.CueTrack),0===n.Track)throw new Error("Cue track cannot be 0");n.ClusterPosition=i.parseTag(m.Segment.Cues.CuePoint.CueTrackPositions.CueClusterPosition),t.CueTracks.push(n),i.setPos(o+a)}if(0===t.CueTracks.length)throw new Error("Mandatory cuetrack not found");r.push(t)}if(0===r.length)throw new Error("mandatory cuepoint not found");return r}(e)).length;l<u;l+=1)s=new h.default,i=0,i=l<a.length-1?a[l+1].CueTime-a[l].CueTime:r-a[l].CueTime,s.duration=i,s.startTime=a[l].CueTime,s.timescale=1e3,c=a[l].CueTracks[0].ClusterPosition+t,d=l<a.length-1?a[l+1].CueTracks[0].ClusterPosition+t-1:n-1,s.mediaRange=c+"-"+d,o.push(s);return p.debug("Parsed cues: "+o.length+" cues."),o}function _(e){var t=new u.default;return t.setInfo(e),t}return t={setConfig:function(e){if(!(e.baseURLController&&e.dashMetrics&&e.mediaPlayerModel&&e.errHandler))throw new Error(o.default.MISSING_CONFIG_ERROR);l=e.baseURLController,i=e.dashMetrics,a=e.mediaPlayerModel,n=e.errHandler,s=e.errors,p=e.debug.getLogger(t),r=e.requestModifier},initialize:function(){g=Object(c.default)(v).create({errHandler:n,dashMetrics:i,mediaPlayerModel:a,requestModifier:r,errors:s})},loadInitialization:function(a,o){return new Promise(function(e){var t=null,n=a?l.resolve(a.path):null,r=a?a.range.split("-"):null,i={range:{start:r?parseFloat(r[0]):null,end:r?parseFloat(r[1]):null},request:t,url:n?n.url:void 0,init:!0,mediaType:o};p.info("Start loading initialization."),t=_(i);g.load({request:t,success:function(){e(a)},error:function(){e(a)}}),p.debug("Perform init load: "+i.url)})},loadSegments:function(i,a,o){return new Promise(function(t){var e=null,n=i?l.resolve(i.path):null,r=n?n.url:void 0;e=_({bytesLoaded:0,bytesToLoad:8192,range:{start:0,end:8192},request:e,url:r,init:!1,mediaType:a}),p.debug("Parsing ebml header");g.load({request:e,success:function(e){!function(e,t,n,r){if(e&&0!==e.byteLength){var i,a,o,s,l=Object(b.default)(v).create({data:e}),u=n?n.split("-"):null,c=null,d={url:t,range:{start:u?parseFloat(u[0]):null,end:u?parseFloat(u[1]):null},request:c};for(p.debug("Parse EBML header: "+d.url),l.skipOverElement(m.EBML),l.consumeTag(m.Segment),o=l.getMatroskaCodedNum(),o+=l.getPos(),s=l.getPos();l.moreData()&&!l.consumeTagAndSize(m.Segment.Info,!0);)if(!(l.skipOverElement(m.Segment.SeekHead,!0)||l.skipOverElement(m.Segment.Tracks,!0)||l.skipOverElement(m.Segment.Cues,!0)||l.skipOverElement(m.Void,!0)))throw new Error("no valid top level element found");for(;void 0===i;){var h=l.getMatroskaCodedNum(!0),f=l.getMatroskaCodedNum();switch(h){case m.Segment.Info.Duration.tag:i=l[m.Segment.Info.Duration.parse](f);break;default:l.setPos(l.getPos()+f)}}c=_(d);g.load({request:c,success:function(e){a=y(e,s,o,i),r(a)},error:function(){p.error("Download Error: Cues "+d.url),r(null)}}),p.debug("Perform cues load: "+d.url+" bytes="+d.range.start+"-"+d.range.end)}else r(null)}(e,r,o,function(e){t({segments:e,representation:i,error:e?void 0:new d.default(s.SEGMENT_BASE_LOADER_ERROR_CODE,s.SEGMENT_BASE_LOADER_ERROR_MESSAGE)})})},error:function(){t({representation:i,error:new d.default(s.SEGMENT_BASE_LOADER_ERROR_CODE,s.SEGMENT_BASE_LOADER_ERROR_MESSAGE)})}})})},reset:function(){g&&(g.abort(),g=null)}},m={EBML:{tag:440786851,required:!0},Segment:{tag:408125543,required:!0,SeekHead:{tag:290298740,required:!0},Info:{tag:357149030,required:!0,TimecodeScale:{tag:2807729,required:!0,parse:"getMatroskaUint"},Duration:{tag:17545,required:!0,parse:"getMatroskaFloat"}},Tracks:{tag:374648427,required:!0},Cues:{tag:475249515,required:!0,CuePoint:{tag:187,required:!0,CueTime:{tag:179,required:!0,parse:"getMatroskaUint"},CueTrackPositions:{tag:183,required:!0,CueTrack:{tag:247,required:!0,parse:"getMatroskaUint"},CueClusterPosition:{tag:241,required:!0,parse:"getMatroskaUint"}}}}},Void:{tag:236,required:!0}},t}i.__dashjs_factory_name="WebmSegmentBaseLoader",t.default=r.default.getSingletonFactory(i)},"./src/dash/constants/DashConstants.js":function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.r(t);var i=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init()}return function(e,t,n){t&&r(e.prototype,t),n&&r(e,n)}(e,[{key:"init",value:function(){this.BASE_URL="BaseURL",this.SEGMENT_BASE="SegmentBase",this.SEGMENT_TEMPLATE="SegmentTemplate",this.SEGMENT_LIST="SegmentList",this.SEGMENT_URL="SegmentURL",this.SEGMENT_TIMELINE="SegmentTimeline",this.SEGMENT_PROFILES="segmentProfiles",this.ADAPTATION_SET="AdaptationSet",this.REPRESENTATION="Representation",this.REPRESENTATION_INDEX="RepresentationIndex",this.SUB_REPRESENTATION="SubRepresentation",this.INITIALIZATION="Initialization",this.INITIALIZATION_MINUS="initialization",this.MPD="MPD",this.PERIOD="Period",this.ASSET_IDENTIFIER="AssetIdentifier",this.EVENT_STREAM="EventStream",this.ID="id",this.PROFILES="profiles",this.SERVICE_LOCATION="serviceLocation",this.RANGE="range",this.INDEX="index",this.MEDIA="media",this.BYTE_RANGE="byteRange",this.INDEX_RANGE="indexRange",this.MEDIA_RANGE="mediaRange",this.VALUE="value",this.CONTENT_TYPE="contentType",this.MIME_TYPE="mimeType",this.BITSTREAM_SWITCHING="BitstreamSwitching",this.BITSTREAM_SWITCHING_MINUS="bitstreamSwitching",this.CODECS="codecs",this.DEPENDENCY_ID="dependencyId",this.MEDIA_STREAM_STRUCTURE_ID="mediaStreamStructureId",this.METRICS="Metrics",this.METRICS_MINUS="metrics",this.REPORTING="Reporting",this.WIDTH="width",this.HEIGHT="height",this.SAR="sar",this.FRAMERATE="frameRate",this.AUDIO_SAMPLING_RATE="audioSamplingRate",this.MAXIMUM_SAP_PERIOD="maximumSAPPeriod",this.START_WITH_SAP="startWithSAP",this.MAX_PLAYOUT_RATE="maxPlayoutRate",this.CODING_DEPENDENCY="codingDependency",this.SCAN_TYPE="scanType",this.FRAME_PACKING="FramePacking",this.AUDIO_CHANNEL_CONFIGURATION="AudioChannelConfiguration",this.CONTENT_PROTECTION="ContentProtection",this.ESSENTIAL_PROPERTY="EssentialProperty",this.SUPPLEMENTAL_PROPERTY="SupplementalProperty",this.INBAND_EVENT_STREAM="InbandEventStream",this.ACCESSIBILITY="Accessibility",this.ROLE="Role",this.RATING="Rating",this.CONTENT_COMPONENT="ContentComponent",this.SUBSET="Subset",this.LANG="lang",this.VIEWPOINT="Viewpoint",this.ROLE_ASARRAY="Role_asArray",this.ACCESSIBILITY_ASARRAY="Accessibility_asArray",this.AUDIOCHANNELCONFIGURATION_ASARRAY="AudioChannelConfiguration_asArray",this.CONTENTPROTECTION_ASARRAY="ContentProtection_asArray",this.MAIN="main",this.DYNAMIC="dynamic",this.STATIC="static",this.MEDIA_PRESENTATION_DURATION="mediaPresentationDuration",this.MINIMUM_UPDATE_PERIOD="minimumUpdatePeriod",this.CODEC_PRIVATE_DATA="codecPrivateData",this.BANDWITH="bandwidth",this.SOURCE_URL="sourceURL",this.TIMESCALE="timescale",this.DURATION="duration",this.START_NUMBER="startNumber",this.PRESENTATION_TIME_OFFSET="presentationTimeOffset",this.AVAILABILITY_START_TIME="availabilityStartTime",this.AVAILABILITY_END_TIME="availabilityEndTime",this.TIMESHIFT_BUFFER_DEPTH="timeShiftBufferDepth",this.MAX_SEGMENT_DURATION="maxSegmentDuration",this.PRESENTATION_TIME="presentationTime",this.MIN_BUFFER_TIME="minBufferTime",this.MAX_SUBSEGMENT_DURATION="maxSubsegmentDuration",this.START="start",this.AVAILABILITY_TIME_OFFSET="availabilityTimeOffset",this.AVAILABILITY_TIME_COMPLETE="availabilityTimeComplete",this.CENC_DEFAULT_KID="cenc:default_KID",this.DVB_PRIORITY="dvb:priority",this.DVB_WEIGHT="dvb:weight",this.SUGGESTED_PRESENTATION_DELAY="suggestedPresentationDelay",this.SERVICE_DESCRIPTION="ServiceDescription",this.SERVICE_DESCRIPTION_SCOPE="Scope",this.SERVICE_DESCRIPTION_LATENCY="Latency",this.SERVICE_DESCRIPTION_PLAYBACK_RATE="PlaybackRate",this.PATCH_LOCATION="PatchLocation",this.PUBLISH_TIME="publishTime",this.ORIGINAL_PUBLISH_TIME="originalPublishTime",this.ORIGINAL_MPD_ID="mpdId"}}]),e}());t.default=i},"./src/dash/controllers/RepresentationController.js":function(e,t,n){n.r(t);var M=n("./src/streaming/constants/Constants.js"),r=n("./src/core/FactoryMaker.js"),R=n("./src/streaming/MediaPlayerEvents.js"),I=n("./src/dash/utils/SegmentsUtils.js");function i(e){var t,u,c,d,o,r=(e=e||{}).eventBus,n=e.events,s=e.abrController,l=e.dashMetrics,h=e.playbackController,f=e.timelineConverter,p=e.type,m=e.streamInfo,g=e.dashConstants,v=e.segmentsController,y=e.isDynamic;function _(){return p}function b(){if(!(s&&l&&h&&f))throw new Error(M.default.MISSING_CONFIG_ERROR)}function E(){return c}function T(){return o}function i(){c=!(u=null),d=[]}function A(a){return new Promise(function(t,n){var e=a.hasInitialization(),r=a.hasSegments(),i=[];i.push(v.updateInitData(a,e)),i.push(v.updateSegmentData(a,r)),Promise.all(i).then(function(e){e[0]&&!e[0].error&&(a=function(e,t){return t&&!t.error&&t.representation?t.representation:e}(a,e[0])),e[1]&&!e[1].error&&(a=function(e,t){if(!t||t.error)return;var n,r,i,a,o=t.segments,s=[],l=0;for(n=0,r=o?o.length:0;n<r;n++)i=o[n],(a=Object(I.getTimeBasedSegment)(f,y,e,i.startTime,i.duration,i.timescale,i.media,i.mediaRange,l))&&(s.push(a),a=null,l++);0<s.length&&(e.segments=s);return e}(a,e[1])),function(e){e.mediaFinishedInformation=v.getMediaFinishedInformation(e)}(a),function(e){if(!E())return;var t,n=l.getCurrentManifestUpdate(),r=!1;if(n){for(var i=0;i<n.representationInfo.length;i++)if((t=n.representationInfo[i]).index===e.index&&t.mediaType===_()){r=!0;break}r||l.addManifestUpdateRepresentationInfo(e,_())}if(function(){for(var e=0,t=d.length;e<t;e++){var n=d[e].segmentInfoType;if(!d[e].hasInitialization()||(n===g.SEGMENT_BASE||n===g.BASE_URL)&&!d[e].segments)return!1}return!0}()){s.setPlaybackQuality(p,m,function(e){return d.indexOf(e)}(o));var a=l.getCurrentDVRInfo(p);a&&l.updateManifestUpdateInfo({latency:a.range.end-h.getTime()}),l.getCurrentRepresentationSwitch(T().adaptation.type)||w(),C()}}(a),t()}).catch(function(e){n(e)})})}function w(){b();var e=new Date,t=T(),n=1e3*h.getTime();t&&l.addRepresentationSwitch(t.adaptation.type,e,n,t.id),r.trigger(R.default.REPRESENTATION_SWITCH,{mediaType:p,streamId:m.id,currentRepresentation:t,numberOfRepresentations:d.length},{streamId:m.id,mediaType:p})}function S(e){return null==e||e>=d.length?null:d[e]}function C(e){c=!1,r.trigger(n.DATA_UPDATE_COMPLETED,{data:u,currentRepresentation:o,error:e},{streamId:m.id,mediaType:p})}function x(e){o=e}function a(e){if(e.newDuration){var t=T();if(t&&t.adaptation.period)t.adaptation.period.duration=e.newDuration}}return t={getStreamId:function(){return m.id},getType:_,getData:function(){return u},isUpdating:E,updateData:function(e,t,n,r,i){if(b(),c=!0,d=t,x(S(i)),u=e,n!==M.default.VIDEO&&n!==M.default.AUDIO&&(n!==M.default.TEXT||!r))return C(),Promise.resolve();for(var a=[],o=0,s=d.length;o<s;o++){var l=d[o];a.push(A(l))}return Promise.all(a)},getCurrentRepresentation:T,getRepresentationForQuality:S,prepareQualityChange:function(e){x(S(e)),w()},reset:function(){r.off(R.default.MANIFEST_VALIDITY_CHANGED,a,t),i()}},i(),r.on(R.default.MANIFEST_VALIDITY_CHANGED,a,t),t}i.__dashjs_factory_name="RepresentationController",t.default=r.default.getClassFactory(i)},"./src/dash/controllers/SegmentBaseController.js":function(e,t,n){n.r(t);var r=n("./src/core/FactoryMaker.js"),g=n("./src/dash/SegmentBaseLoader.js"),v=n("./src/dash/WebmSegmentBaseLoader.js");function i(e){e=e||{};var t,n,r,i=this.context,a=e.eventBus,o=e.events,s=e.dashMetrics,l=e.mediaPlayerModel,u=e.errHandler,c=e.baseURLController,d=e.debug,h=e.boxParser,f=e.requestModifier,p=e.errors;function m(e){return"webm"===(e?e.split("/")[1]:"").toLowerCase()}return t={initialize:function(){n.initialize(),r.initialize()},getSegmentBaseInitSegment:function(e){return m(e.representation.mimeType)?r.loadInitialization(e.representation,e.mediaType):n.loadInitialization(e.representation,e.mediaType)},getSegmentList:function(e){return m(e.mimeType)?r.loadSegments(e.representation,e.mediaType,e.representation?e.representation.indexRange:null):n.loadSegments(e.representation,e.mediaType,e.representation?e.representation.indexRange:null)},reset:function(){n.reset(),r.reset()}},n=Object(g.default)(i).getInstance(),r=Object(v.default)(i).getInstance(),n.setConfig({baseURLController:c,dashMetrics:s,mediaPlayerModel:l,errHandler:u,eventBus:a,events:o,errors:p,debug:d,boxParser:h,requestModifier:f}),r.setConfig({baseURLController:c,dashMetrics:s,mediaPlayerModel:l,errHandler:u,eventBus:a,events:o,errors:p,debug:d,requestModifier:f}),t}i.__dashjs_factory_name="SegmentBaseController";var a=r.default.getSingletonFactory(i);t.default=a},"./src/dash/controllers/SegmentsController.js":function(e,t,n){n.r(t);var r=n("./src/core/FactoryMaker.js"),l=n("./src/dash/utils/TimelineSegmentsGetter.js"),u=n("./src/dash/utils/TemplateSegmentsGetter.js"),c=n("./src/dash/utils/ListSegmentsGetter.js"),d=n("./src/dash/utils/SegmentBaseGetter.js");function i(t){t=t||{};var e,n,r=this.context,i=t.dashConstants,a=t.type,o=t.segmentBaseController;function s(e){return e?e.segments?n[i.SEGMENT_BASE]:n[e.segmentInfoType]:null}return e={initialize:function(e){n[i.SEGMENT_TIMELINE]=Object(l.default)(r).create(t,e),n[i.SEGMENT_TEMPLATE]=Object(u.default)(r).create(t,e),n[i.SEGMENT_LIST]=Object(c.default)(r).create(t,e),n[i.SEGMENT_BASE]=Object(d.default)(r).create(t,e)},updateInitData:function(e,t){return t?Promise.resolve():o.getSegmentBaseInitSegment({representation:e,mediaType:a})},updateSegmentData:function(e,t){return t?Promise.resolve():o.getSegmentList({mimeType:e.mimeType,representation:e,mediaType:a})},getSegmentByIndex:function(e,t,n){var r=s(e);return r?r.getSegmentByIndex(e,t,n):null},getSegmentByTime:function(e,t){var n=s(e);return n?n.getSegmentByTime(e,t):null},getMediaFinishedInformation:function(e){var t=s(e);return t?t.getMediaFinishedInformation(e):{numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN}}},n={},e}i.__dashjs_factory_name="SegmentsController";var a=r.default.getClassFactory(i);t.default=a},"./src/dash/models/DashManifestModel.js":function(e,t,n){n.r(t);var T=n("./src/streaming/constants/Constants.js"),A=n("./src/dash/constants/DashConstants.js"),w=n("./src/dash/vo/Representation.js"),S=n("./src/dash/vo/AdaptationSet.js"),C=n("./src/dash/vo/Period.js"),i=n("./src/dash/vo/Mpd.js"),x=n("./src/dash/vo/UTCTiming.js"),M=n("./src/dash/vo/Event.js"),R=n("./src/dash/vo/BaseURL.js"),I=n("./src/dash/vo/EventStream.js"),P=n("./src/streaming/utils/ObjectUtils.js"),D=n("./src/streaming/utils/URLUtils.js"),r=n("./src/core/FactoryMaker.js"),L=n("./src/core/Debug.js"),O=n("./src/streaming/vo/DashJSError.js"),N=n("./src/core/errors/Errors.js"),k=n("./src/streaming/thumbnail/ThumbnailTracks.js");function B(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function a(){var e,u,c,d,a=this.context,o=Object(D.default)(a).getInstance(),f=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e};function s(e,t){if(!e)throw new Error("adaptation is not defined");if(!t)throw new Error("type is not defined");if(e.Representation_asArray&&e.Representation_asArray.length){var n=v(e.Representation_asArray[0]);if(n&&0<n.length&&0<=k.THUMBNAILS_SCHEME_ID_URIS.indexOf(n[0].schemeIdUri))return t===T.default.IMAGE}if(e.ContentComponent_asArray&&0<e.ContentComponent_asArray.length){if(1<e.ContentComponent_asArray.length)return t===T.default.MUXED;if(e.ContentComponent_asArray[0].contentType===t)return!0}var r=t===T.default.TEXT?new RegExp("(ttml|vtt|wvtt|stpp)"):new RegExp(t);if(e.Representation_asArray&&e.Representation_asArray.length){var i=e.Representation_asArray[0].codecs;if(r.test(i))return!0}if(e.hasOwnProperty(A.default.MIME_TYPE))return r.test(e.mimeType);if(e.Representation_asArray)for(var a,o=0;o<e.Representation_asArray.length;o++)if((a=e.Representation_asArray[o]).hasOwnProperty(A.default.MIME_TYPE))return r.test(a.mimeType);return!1}function p(e){if(!e)throw new Error("adaptation is not defined");if(e.hasOwnProperty(A.default.SEGMENT_TEMPLATE)||e.hasOwnProperty(A.default.SEGMENT_TIMELINE)||e.hasOwnProperty(A.default.SEGMENT_LIST)||e.hasOwnProperty(A.default.SEGMENT_BASE))return!0;if(e.Representation_asArray&&0<e.Representation_asArray.length){var t=e.Representation_asArray[0];if(t.hasOwnProperty(A.default.SEGMENT_TEMPLATE)||t.hasOwnProperty(A.default.SEGMENT_TIMELINE)||t.hasOwnProperty(A.default.SEGMENT_LIST)||t.hasOwnProperty(A.default.SEGMENT_BASE))return!0}return!1}function m(e){return s(e,T.default.TEXT)}function t(){return function(e,t){return e.bandwidth-t.bandwidth}}function g(e){return e&&Array.isArray(e.Representation_asArray)&&e.Representation_asArray.sort(function(e,t){return e.bandwidth-t.bandwidth}),e}function l(e,t){return e&&e.Period_asArray&&f(t)&&e.Period_asArray[t]?e.Period_asArray[t].AdaptationSet_asArray:[]}function r(e){return e&&e.Period_asArray?e.Period_asArray:[]}function h(e){var t=!1;return e&&e.hasOwnProperty("type")&&(t=e.type===A.default.DYNAMIC),t}function v(e){return e&&e.EssentialProperty_asArray&&e.EssentialProperty_asArray.length?e.EssentialProperty_asArray.map(function(e){return{schemeIdUri:e.schemeIdUri,value:e.value}}):null}function y(e){if(!e||!e.S_asArray)return NaN;var t=e.S_asArray[0],n=e.S_asArray[1];return t.hasOwnProperty("d")?t.d:n.t-t.t}function _(e,t){if(!e)throw new Error("Period cannot be null or undefined");var n=C.default.DEFAULT_ID+"_"+t;return e.hasOwnProperty(A.default.ID)&&0<e.id.length&&"__proto__"!==e.id&&(n=e.id),n}function b(e,t){var n,r=[];if(!e)return r;for(n=0;n<e.length;n++){var i=new I.default;if(i.timescale=1,i.representation=t,!e[n].hasOwnProperty(T.default.SCHEME_ID_URI))throw new Error("Invalid EventStream. SchemeIdUri has to be set");i.schemeIdUri=e[n].schemeIdUri,e[n].hasOwnProperty(A.default.TIMESCALE)&&(i.timescale=e[n].timescale),e[n].hasOwnProperty(A.default.VALUE)&&(i.value=e[n].value),r.push(i)}return r}function E(r){var i=[],e=r.BaseURL_asArray||[r.baseUri],a=!1;return e.some(function(e){if(e){var t=new R.default,n=e.__text||e;return o.isRelative(n)&&(a=!0,r.baseUri&&(n=o.resolve(n,r.baseUri))),t.url=n,e.hasOwnProperty(A.default.SERVICE_LOCATION)&&e.serviceLocation.length?t.serviceLocation=e.serviceLocation:t.serviceLocation=n,e.hasOwnProperty(A.default.DVB_PRIORITY)&&(t.dvb_priority=e[A.default.DVB_PRIORITY]),e.hasOwnProperty(A.default.DVB_WEIGHT)&&(t.dvb_weight=e[A.default.DVB_WEIGHT]),e.hasOwnProperty(A.default.AVAILABILITY_TIME_OFFSET)&&(t.availabilityTimeOffset=e[A.default.AVAILABILITY_TIME_OFFSET]),e.hasOwnProperty(A.default.AVAILABILITY_TIME_COMPLETE)&&(t.availabilityTimeComplete="false"!==e[A.default.AVAILABILITY_TIME_COMPLETE]),i.push(t),a}}),i}return e={getIsTypeOf:s,getIsText:m,getIsFragmented:p,getLanguageForAdaptation:function(e){var t="";return e&&e.hasOwnProperty(A.default.LANG)&&(t=e.lang.replace(/[^A-Za-z0-9-]/g,"")),t},getViewpointForAdaptation:function(e){return e&&e.hasOwnProperty(A.default.VIEWPOINT)?e.Viewpoint:null},getRolesForAdaptation:function(e){return e&&e.hasOwnProperty(A.default.ROLE_ASARRAY)?e.Role_asArray:[]},getAccessibilityForAdaptation:function(e){return e&&e.hasOwnProperty(A.default.ACCESSIBILITY_ASARRAY)?e.Accessibility_asArray:[]},getAudioChannelConfigurationForAdaptation:function(e){return e&&e.hasOwnProperty(A.default.AUDIOCHANNELCONFIGURATION_ASARRAY)?e.AudioChannelConfiguration_asArray:[]},getAudioChannelConfigurationForRepresentation:function(e){return e&&e.hasOwnProperty(A.default.AUDIOCHANNELCONFIGURATION_ASARRAY)?e.AudioChannelConfiguration_asArray:[]},getAdaptationForIndex:function(e,t,n){var r=l(t,n);return 0<r.length&&f(e)?r[e]:null},getIndexForAdaptation:function(e,t,n){if(!e)return-1;for(var r=l(t,n),i=0;i<r.length;i++){if(Object(P.default)(a).getInstance().areEqual(r[i],e))return i}return-1},getAdaptationForId:function(e,t,n){var r,i,a=l(t,n);for(r=0,i=a.length;r<i;r++)if(a[r].hasOwnProperty(A.default.ID)&&a[r].id===e)return a[r];return null},getAdaptationsForType:function(e,t,n){var r,i,a=l(e,t),o=[];for(r=0,i=a.length;r<i;r++)s(a[r],n)&&o.push(g(a[r]));return o},getRealPeriods:r,getRealPeriodForIndex:function(e,t){var n=r(t);return 0<n.length&&f(e)?n[e]:null},getCodec:function(e,t,n){var r=null;if(e&&e.Representation_asArray&&0<e.Representation_asArray.length){var i=f(t)&&0<=t&&t<e.Representation_asArray.length?e.Representation_asArray[t]:e.Representation_asArray[0];i&&(r=i.mimeType+';codecs="'+i.codecs+'"',n&&void 0!==i.width&&(r+=';width="'+i.width+'";height="'+i.height+'"'))}return r=r&&r.replace(/\sprofiles=[^;]*/g,"")},getSelectionPriority:function(e){try{var t=e&&void 0!==e.selectionPriority?parseInt(e.selectionPriority):1;return isNaN(t)?1:t}catch(e){return 1}},getMimeType:function(e){return e&&e.Representation_asArray&&0<e.Representation_asArray.length?e.Representation_asArray[0].mimeType:null},getKID:function(e){return e&&e.hasOwnProperty(A.default.CENC_DEFAULT_KID)?e[A.default.CENC_DEFAULT_KID]:null},getLabelsForAdaptation:function(e){if(!e||!Array.isArray(e.Label_asArray))return[];for(var t=[],n=0;n<e.Label_asArray.length;n++)t.push({lang:e.Label_asArray[n].lang,text:e.Label_asArray[n].__text||e.Label_asArray[n]});return t},getContentProtectionData:function(e){return e&&e.hasOwnProperty(A.default.CONTENTPROTECTION_ASARRAY)&&0!==e.ContentProtection_asArray.length?e.ContentProtection_asArray:null},getIsDynamic:h,getId:function(e){return e&&e[A.default.ID]||null},hasProfile:function(e,t){var n=!1;return e&&e.profiles&&0<e.profiles.length&&(n=-1!==e.profiles.indexOf(t)),n},getDuration:function(e){return e&&e.hasOwnProperty(A.default.MEDIA_PRESENTATION_DURATION)?e.mediaPresentationDuration:e&&"dynamic"==e.type?Number.POSITIVE_INFINITY:Number.MAX_SAFE_INTEGER||Number.MAX_VALUE},getBandwidth:function(e){return e&&e.bandwidth?e.bandwidth:NaN},getManifestUpdatePeriod:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=NaN;return e&&e.hasOwnProperty(A.default.MINIMUM_UPDATE_PERIOD)&&(n=e.minimumUpdatePeriod),isNaN(n)?n:Math.max(n-t,1)},getPublishTime:function(e){return e&&e.hasOwnProperty(A.default.PUBLISH_TIME)?new Date(e[A.default.PUBLISH_TIME]):null},getRepresentationCount:function(e){return e&&Array.isArray(e.Representation_asArray)?e.Representation_asArray.length:0},getBitrateListForAdaptation:function(e){var t=g(e);return(t&&Array.isArray(t.Representation_asArray)?t.Representation_asArray:[]).map(function(e){return{bandwidth:e.bandwidth,width:e.width||0,height:e.height||0,scanType:e.scanType||null,id:e.id||null}})},getRepresentationFor:function(e,t){return t&&t.Representation_asArray&&0<t.Representation_asArray.length&&f(e)?t.Representation_asArray[e]:null},getRepresentationsForAdaptation:function(e){var t,n,r,i,a=[],o=function(e){if(e&&e.period&&f(e.period.index)){var t=e.period.mpd.manifest.Period_asArray[e.period.index];if(t&&t.AdaptationSet_asArray&&f(e.index))return g(t.AdaptationSet_asArray[e.index])}}(e);if(o&&o.Representation_asArray){if(e&&e.period&&f(e.period.index)){var s=E(e.period.mpd.manifest);s&&(n=s[0])}for(var l=0,u=o.Representation_asArray.length;l<u;++l){var c=o.Representation_asArray[l],d=new w.default;if(d.index=l,d.adaptation=e,c.hasOwnProperty(A.default.ID)&&(d.id=c.id),c.hasOwnProperty(A.default.CODECS)&&(d.codecs=c.codecs),c.hasOwnProperty(A.default.MIME_TYPE)&&(d.mimeType=c[A.default.MIME_TYPE]),c.hasOwnProperty(A.default.CODEC_PRIVATE_DATA)&&(d.codecPrivateData=c.codecPrivateData),c.hasOwnProperty(A.default.BANDWITH)&&(d.bandwidth=c.bandwidth),c.hasOwnProperty(A.default.WIDTH)&&(d.width=c.width),c.hasOwnProperty(A.default.HEIGHT)&&(d.height=c.height),c.hasOwnProperty(A.default.SCAN_TYPE)&&(d.scanType=c.scanType),c.hasOwnProperty(A.default.MAX_PLAYOUT_RATE)&&(d.maxPlayoutRate=c.maxPlayoutRate),c.hasOwnProperty(A.default.SEGMENT_BASE)?(t=c.SegmentBase,d.segmentInfoType=A.default.SEGMENT_BASE):c.hasOwnProperty(A.default.SEGMENT_LIST)?(t=c.SegmentList).hasOwnProperty(A.default.SEGMENT_TIMELINE)?d.segmentInfoType=A.default.SEGMENT_TIMELINE:d.segmentInfoType=A.default.SEGMENT_LIST:c.hasOwnProperty(A.default.SEGMENT_TEMPLATE)?((t=c.SegmentTemplate).hasOwnProperty(A.default.SEGMENT_TIMELINE)?d.segmentInfoType=A.default.SEGMENT_TIMELINE:d.segmentInfoType=A.default.SEGMENT_TEMPLATE,t.hasOwnProperty(A.default.INITIALIZATION_MINUS)&&(d.initialization=t.initialization.split("$Bandwidth$").join(c.bandwidth).split("$RepresentationID$").join(c.id))):d.segmentInfoType=A.default.BASE_URL,d.essentialProperties=v(c),t){if(t.hasOwnProperty(A.default.INITIALIZATION)){var h=t.Initialization;h.hasOwnProperty(A.default.SOURCE_URL)&&(d.initialization=h.sourceURL),h.hasOwnProperty(A.default.RANGE)&&(d.range=h.range)}else m(o)&&p(o)&&o.mimeType&&-1===o.mimeType.indexOf("application/mp4")&&(d.range=0);t.hasOwnProperty(A.default.TIMESCALE)&&(d.timescale=t.timescale),t.hasOwnProperty(A.default.DURATION)?d.segmentDuration=t.duration/d.timescale:c.hasOwnProperty(A.default.SEGMENT_TEMPLATE)&&(t=c.SegmentTemplate).hasOwnProperty(A.default.SEGMENT_TIMELINE)&&(d.segmentDuration=y(t.SegmentTimeline)/d.timescale),t.hasOwnProperty(A.default.MEDIA)&&(d.media=t.media),t.hasOwnProperty(A.default.START_NUMBER)&&(d.startNumber=t.startNumber),t.hasOwnProperty(A.default.INDEX_RANGE)&&(d.indexRange=t.indexRange),t.hasOwnProperty(A.default.PRESENTATION_TIME_OFFSET)&&(d.presentationTimeOffset=t.presentationTimeOffset/d.timescale),t.hasOwnProperty(A.default.AVAILABILITY_TIME_OFFSET)?d.availabilityTimeOffset=t.availabilityTimeOffset:n&&void 0!==n.availabilityTimeOffset&&(d.availabilityTimeOffset=n.availabilityTimeOffset),t.hasOwnProperty(A.default.AVAILABILITY_TIME_COMPLETE)?d.availabilityTimeComplete="false"!==t.availabilityTimeComplete:n&&void 0!==n.availabilityTimeComplete&&(d.availabilityTimeComplete=n.availabilityTimeComplete)}d.MSETimeOffset=(void 0,i=(r=d).presentationTimeOffset,r.adaptation.period.start-i),d.path=[e.period.index,e.index,l],a.push(d)}}return a},getAdaptationsForPeriod:function(e){var t,n,r,i=e&&f(e.index)?e.mpd.manifest.Period_asArray[e.index]:null,a=[];if(i&&i.AdaptationSet_asArray)for(r=0;r<i.AdaptationSet_asArray.length;r++)n=i.AdaptationSet_asArray[r],t=new S.default,n.hasOwnProperty(A.default.ID)&&(t.id=n.id),t.index=r,t.period=e,s(n,T.default.MUXED)?t.type=T.default.MUXED:s(n,T.default.AUDIO)?t.type=T.default.AUDIO:s(n,T.default.VIDEO)?t.type=T.default.VIDEO:m(n)?t.type=T.default.TEXT:s(n,T.default.IMAGE)?t.type=T.default.IMAGE:u.warn("Unknown Adaptation stream type"),a.push(t);return a},getRegularPeriods:function(e){var t,n,r=!!e&&h(e.manifest),i=[],a=null,o=null,s=null,l=null;for(n=0,t=e&&e.manifest&&e.manifest.Period_asArray?e.manifest.Period_asArray.length:0;n<t;n++)(o=e.manifest.Period_asArray[n]).hasOwnProperty(A.default.START)?(l=new C.default).start=o.start:null!==a&&a.hasOwnProperty(A.default.DURATION)&&null!==s?(l=new C.default).start=parseFloat((s.start+s.duration).toFixed(5)):0!==n||r||((l=new C.default).start=0),null!==s&&isNaN(s.duration)&&(null!==l?s.duration=parseFloat((l.start-s.start).toFixed(5)):u.warn("First period duration could not be calculated because lack of start and duration period properties. This will cause timing issues during playback")),null!==l&&(l.id=_(o,n),l.index=n,l.mpd=e,o.hasOwnProperty(A.default.DURATION)&&(l.duration=o.duration),s&&(s.nextPeriodId=l.id),i.push(l),a=o,s=l),l=o=null;return 0===i.length||null!==s&&isNaN(s.duration)&&(s.duration=parseFloat((function(e){!function(){if(!c||!c.hasOwnProperty("error"))throw new Error(T.default.MISSING_CONFIG_ERROR)}();var t,n=h(e.mpd.manifest);e.mpd.manifest.mediaPresentationDuration?t=e.mpd.manifest.mediaPresentationDuration:e.duration?t=e.duration:n?t=Number.POSITIVE_INFINITY:c.error(new O.default(N.default.MANIFEST_ERROR_ID_PARSE_CODE,"Must have @mediaPresentationDuration on MPD or an explicit @duration on the last period.",e));return t}(s)-s.start).toFixed(5))),i},getMpd:function(e){var t=new i.default;return e&&((t.manifest=e).hasOwnProperty(A.default.AVAILABILITY_START_TIME)?t.availabilityStartTime=new Date(e.availabilityStartTime.getTime()):e.loadedTime&&(t.availabilityStartTime=new Date(e.loadedTime.getTime())),e.hasOwnProperty(A.default.AVAILABILITY_END_TIME)&&(t.availabilityEndTime=new Date(e.availabilityEndTime.getTime())),e.hasOwnProperty(A.default.MINIMUM_UPDATE_PERIOD)&&(t.minimumUpdatePeriod=e.minimumUpdatePeriod),e.hasOwnProperty(A.default.MEDIA_PRESENTATION_DURATION)&&(t.mediaPresentationDuration=e.mediaPresentationDuration),e.hasOwnProperty(A.default.SUGGESTED_PRESENTATION_DELAY)&&(t.suggestedPresentationDelay=e.suggestedPresentationDelay),e.hasOwnProperty(A.default.TIMESHIFT_BUFFER_DEPTH)&&(t.timeShiftBufferDepth=e.timeShiftBufferDepth),e.hasOwnProperty(A.default.MAX_SEGMENT_DURATION)&&(t.maxSegmentDuration=e.maxSegmentDuration),e.hasOwnProperty(A.default.PUBLISH_TIME)&&(t.publishTime=new Date(e.publishTime))),t},getEventsForPeriod:function(e){var t,n,r=e&&e.mpd&&e.mpd.manifest?e.mpd.manifest:null,i=r?r.Period_asArray:null,a=i&&e&&f(e.index)?i[e.index].EventStream_asArray:null,o=[];if(a)for(t=0;t<a.length;t++){var s=new I.default;if(s.period=e,s.timescale=1,!a[t].hasOwnProperty(T.default.SCHEME_ID_URI))throw new Error("Invalid EventStream. SchemeIdUri has to be set");for(s.schemeIdUri=a[t][T.default.SCHEME_ID_URI],a[t].hasOwnProperty(A.default.TIMESCALE)&&(s.timescale=a[t][A.default.TIMESCALE]),a[t].hasOwnProperty(A.default.VALUE)&&(s.value=a[t][A.default.VALUE]),a[t].hasOwnProperty(A.default.PRESENTATION_TIME_OFFSET)&&(s.presentationTimeOffset=a[t][A.default.PRESENTATION_TIME_OFFSET]),n=0;a[t].Event_asArray&&n<a[t].Event_asArray.length;n++){var l=a[t].Event_asArray[n],u=new M.default;if(u.presentationTime=0,u.eventStream=s,l.hasOwnProperty(A.default.PRESENTATION_TIME)){u.presentationTime=l.presentationTime;var c=s.presentationTimeOffset?s.presentationTimeOffset/s.timescale:0;u.calculatedPresentationTime=u.presentationTime/s.timescale+e.start-c}l.hasOwnProperty(A.default.DURATION)&&(u.duration=l.duration/s.timescale),l.hasOwnProperty(A.default.ID)&&(u.id=l.id),l.Signal&&l.Signal.Binary?u.messageData=d.decodeArray(l.Signal.Binary.toString()):u.messageData=l.messageData||l.__text,o.push(u)}}return o},getEssentialPropertiesForRepresentation:v,getEventStreamForAdaptationSet:function(e,t){var n,r,i;return e&&e.Period_asArray&&t&&t.period&&f(t.period.index)&&(r=e.Period_asArray[t.period.index])&&r.AdaptationSet_asArray&&f(t.index)&&(i=r.AdaptationSet_asArray[t.index])&&(n=i.InbandEventStream_asArray),b(n,null)},getEventStreamForRepresentation:function(e,t){var n,r,i,a;return e&&e.Period_asArray&&t&&t.adaptation&&t.adaptation.period&&f(t.adaptation.period.index)&&(r=e.Period_asArray[t.adaptation.period.index])&&r.AdaptationSet_asArray&&f(t.adaptation.index)&&(i=r.AdaptationSet_asArray[t.adaptation.index])&&i.Representation_asArray&&f(t.index)&&(a=i.Representation_asArray[t.index])&&(n=a.InbandEventStream_asArray),b(n,t)},getUTCTimingSources:function(e){var t=h(e),n=!!e&&e.hasOwnProperty(A.default.AVAILABILITY_START_TIME),r=e?e.UTCTiming_asArray:null,i=[];return(t||n)&&r&&r.forEach(function(e){var t=new x.default;e.hasOwnProperty(T.default.SCHEME_ID_URI)&&(t.schemeIdUri=e.schemeIdUri,e.hasOwnProperty(A.default.VALUE)&&(t.value=e.value.toString(),i.push(t)))}),i},getBaseURLsFromElement:E,getRepresentationSortFunction:t,getLocation:function(e){if(e&&e.hasOwnProperty(T.default.LOCATION))return e.Location=e.Location_asArray[0],e.Location},getPatchLocation:function(e){if(e&&e.hasOwnProperty(A.default.PATCH_LOCATION))return e.PatchLocation=e.PatchLocation_asArray[0],e.PatchLocation},getSuggestedPresentationDelay:function(e){return e&&e.hasOwnProperty(A.default.SUGGESTED_PRESENTATION_DELAY)?e.suggestedPresentationDelay:null},getAvailabilityStartTime:function(e){return e&&e.hasOwnProperty(A.default.AVAILABILITY_START_TIME)&&null!==e.availabilityStartTime?e.availabilityStartTime.getTime():null},getServiceDescriptions:function(e){var t=[];if(e&&e.hasOwnProperty(A.default.SERVICE_DESCRIPTION)){var n,r=B(e.ServiceDescription_asArray);try{for(r.s();!(n=r.n()).done;){var i=n.value,a=void 0,o=void 0,s=void 0,l=void 0;for(var u in i)i.hasOwnProperty(u)&&(u===A.default.ID?a=i[u]:u===A.default.SERVICE_DESCRIPTION_SCOPE?o=i[u].schemeIdUri:u===A.default.SERVICE_DESCRIPTION_LATENCY?s={target:i[u].target,max:i[u].max,min:i[u].min}:u===A.default.SERVICE_DESCRIPTION_PLAYBACK_RATE&&(l={max:i[u].max,min:i[u].min}));o===T.default.SERVICE_DESCRIPTION_LL_SCHEME&&(s||l)&&t.push({id:a,schemeIdUri:o,latency:s,playbackRate:l})}}catch(e){r.e(e)}finally{r.f()}}return t},getSupplementalProperties:function(e){var t={};if(e&&e.hasOwnProperty(A.default.SUPPLEMENTAL_PROPERTY)){var n,r=B(e.SupplementalProperty_asArray);try{for(r.s();!(n=r.n()).done;){var i=n.value;i.hasOwnProperty(T.default.SCHEME_ID_URI)&&i.hasOwnProperty(A.default.VALUE)&&(t[i[T.default.SCHEME_ID_URI]]=i[A.default.VALUE])}}catch(e){r.e(e)}finally{r.f()}}return t},setConfig:function(e){e&&(e.errHandler&&(c=e.errHandler),e.BASE64&&(d=e.BASE64))}},u=Object(L.default)(a).getInstance().getLogger(e),e}a.__dashjs_factory_name="DashManifestModel",t.default=r.default.getSingletonFactory(a)},"./src/dash/models/PatchManifestModel.js":function(e,t,n){n.r(t);var r=n("./src/dash/constants/DashConstants.js"),i=n("./src/core/FactoryMaker.js"),a=n("./src/core/Debug.js"),l=n("./src/dash/vo/SimpleXPath.js"),u=n("./src/dash/vo/PatchOperation.js");function o(){var e,s,t=this.context;return e={getIsPatch:function(e){return e&&e.hasOwnProperty(r.default.ORIGINAL_MPD_ID)||!1},getPublishTime:function(e){return e&&e.hasOwnProperty(r.default.PUBLISH_TIME)?new Date(e[r.default.PUBLISH_TIME]):null},getOriginalPublishTime:function(e){return e&&e.hasOwnProperty(r.default.ORIGINAL_PUBLISH_TIME)?new Date(e[r.default.ORIGINAL_PUBLISH_TIME]):null},getMpdId:function(e){return e&&e[r.default.ORIGINAL_MPD_ID]||null},getPatchOperations:function(e){return e?(e.__children||[]).map(function(e){var t=Object.keys(e)[0];if("add"!==t&&"remove"!==t&&"replace"!==t)return s.warn("Ignoring node of invalid action: ".concat(t)),null;var n=e[t],r=n.sel;if("add"===t&&n.type){if(!n.type.startsWith("@"))return s.warn("Ignoring add action for prefixed namespace declaration: ".concat(n.type,"=").concat(n.__text)),null;r="".concat(r,"/").concat(n.type)}var i=new l.default(r);if(!i.isValid())return s.warn("Ignoring action with invalid selector: ".concat(t," - ").concat(r)),null;var a=null;i.findsAttribute()?a=n.__text||"":"remove"!==t&&(a=n.__children.reduce(function(e,t){var n=Object.keys(t)[0];return"#text"!==n&&(e[n]=e[n]||[],e[n].push(t[n])),e},{}));var o=new u.default(t,i,a);return"add"===t&&(o.position=n.pos),o}).filter(function(e){return!!e}):[]}},s=Object(a.default)(t).getInstance().getLogger(e),e}o.__dashjs_factory_name="PatchManifestModel",t.default=i.default.getSingletonFactory(o)},"./src/dash/parser/DashParser.js":function(e,t,n){n.r(t);var r=n("./src/core/FactoryMaker.js"),l=n("./src/dash/parser/objectiron.js"),u=n("./externals/xml2json.js"),c=n("./src/dash/parser/matchers/StringMatcher.js"),d=n("./src/dash/parser/matchers/DurationMatcher.js"),h=n("./src/dash/parser/matchers/DateTimeMatcher.js"),f=n("./src/dash/parser/matchers/NumericMatcher.js"),p=n("./src/dash/parser/maps/RepresentationBaseValuesMap.js"),m=n("./src/dash/parser/maps/SegmentValuesMap.js");function i(e){e=e||{};var t,a,n,o,s,r=this.context,i=e.debug;return t={parse:function(e){var t,n=window.performance.now();if(!(t=o.xml_str2json(e)))throw new Error("parsing the manifest failed");var r=window.performance.now();t.Patch?((t=t.Patch).add_asArray&&t.add_asArray.forEach(function(e){return s.run(e)}),t.replace_asArray&&t.replace_asArray.forEach(function(e){return s.run(e)})):(t=t.MPD,s.run(t));var i=window.performance.now();return a.info("Parsing complete: ( xml2json: "+(r-n).toPrecision(3)+"ms, objectiron: "+(i-r).toPrecision(3)+"ms, total: "+((i-n)/1e3).toPrecision(3)+"s)"),t.protocol="DASH",t},getMatchers:function(){return n},getIron:function(){return s}},a=i.getLogger(t),n=[new d.default,new h.default,new f.default,new c.default],o=new u.default({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!0,ignoreRoot:!1,matchers:n}),s=Object(l.default)(r).create({adaptationset:new p.default,period:new m.default}),t}i.__dashjs_factory_name="DashParser",t.default=r.default.getClassFactory(i)},"./src/dash/parser/maps/CommonProperty.js":function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.r(t);var i=function(){function n(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var t;this._name=e,this._merge=(t=e)&&t.length&&t.charAt(0)===t.charAt(0).toUpperCase()}return function(e,t,n){t&&r(e.prototype,t),n&&r(e,n)}(n,[{key:"name",get:function(){return this._name}},{key:"merge",get:function(){return this._merge}}]),n}();t.default=i},"./src/dash/parser/maps/MapNode.js":function(e,t,n){n.r(t);var a=n("./src/dash/parser/maps/CommonProperty.js");function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=function(){function i(e,t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),this._name=e||"",this._properties=[],this._children=n||[],Array.isArray(t)&&t.forEach(function(e){r._properties.push(new a.default(e))})}return function(e,t,n){t&&r(e.prototype,t),n&&r(e,n)}(i,[{key:"name",get:function(){return this._name}},{key:"children",get:function(){return this._children}},{key:"properties",get:function(){return this._properties}}]),i}();t.default=i},"./src/dash/parser/maps/RepresentationBaseValuesMap.js":function(e,t,n){n.r(t);var r=n("./src/dash/parser/maps/MapNode.js"),i=n("./src/dash/constants/DashConstants.js");function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=l(r);if(i){var n=l(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}(this,e)}}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var u=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(n,r["default"]);var t=s(n);function n(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var e=[i.default.PROFILES,i.default.WIDTH,i.default.HEIGHT,i.default.SAR,i.default.FRAMERATE,i.default.AUDIO_SAMPLING_RATE,i.default.MIME_TYPE,i.default.SEGMENT_PROFILES,i.default.CODECS,i.default.MAXIMUM_SAP_PERIOD,i.default.START_WITH_SAP,i.default.MAX_PLAYOUT_RATE,i.default.CODING_DEPENDENCY,i.default.SCAN_TYPE,i.default.FRAME_PACKING,i.default.AUDIO_CHANNEL_CONFIGURATION,i.default.CONTENT_PROTECTION,i.default.ESSENTIAL_PROPERTY,i.default.SUPPLEMENTAL_PROPERTY,i.default.INBAND_EVENT_STREAM];return t.call(this,i.default.ADAPTATION_SET,e,[new r.default(i.default.REPRESENTATION,e,[new r.default(i.default.SUB_REPRESENTATION,e)])])}return n}();t.default=u},"./src/dash/parser/maps/SegmentValuesMap.js":function(e,t,n){n.r(t);var r=n("./src/dash/parser/maps/MapNode.js"),i=n("./src/dash/constants/DashConstants.js");function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=l(r);if(i){var n=l(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}(this,e)}}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var u=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(n,r["default"]);var t=s(n);function n(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var e=[i.default.SEGMENT_BASE,i.default.SEGMENT_TEMPLATE,i.default.SEGMENT_LIST];return t.call(this,i.default.PERIOD,e,[new r.default(i.default.ADAPTATION_SET,e,[new r.default(i.default.REPRESENTATION,e)])])}return n}();t.default=u},"./src/dash/parser/matchers/BaseMatcher.js":function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.r(t);var i=function(){function n(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),this._test=e,this._converter=t}return function(e,t,n){t&&r(e.prototype,t),n&&r(e,n)}(n,[{key:"test",get:function(){return this._test}},{key:"converter",get:function(){return this._converter}}]),n}();t.default=i},"./src/dash/parser/matchers/DateTimeMatcher.js":function(e,t,n){n.r(t);var r=n("./src/dash/parser/matchers/BaseMatcher.js");function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=s(r);if(i){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}(this,e)}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+-])([0-9]{2})(?::?)([0-9]{2}))?/,u=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(t,r["default"]);var e=o(t);function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.call(this,function(e){return l.test(e.value)},function(e){var t,n=l.exec(e);if(t=Date.UTC(parseInt(n[1],10),parseInt(n[2],10)-1,parseInt(n[3],10),parseInt(n[4],10),parseInt(n[5],10),n[6]&&parseInt(n[6],10)||0,n[7]&&1e3*parseFloat(n[7])||0),n[9]&&n[10]){var r=60*parseInt(n[9],10)+parseInt(n[10],10);t+=("+"===n[8]?-1:1)*r*60*1e3}return new Date(t)})}return t}();t.default=u},"./src/dash/parser/matchers/DurationMatcher.js":function(e,t,n){n.r(t);var r=n("./src/dash/parser/matchers/BaseMatcher.js"),i=n("./src/streaming/constants/Constants.js"),a=n("./src/dash/constants/DashConstants.js");function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=u(r);if(i){var n=u(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}(this,e)}}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var c=/^([-])?P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/,d=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(t,r["default"]);var e=l(t);function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.call(this,function(e){for(var t=[a.default.MIN_BUFFER_TIME,a.default.MEDIA_PRESENTATION_DURATION,a.default.MINIMUM_UPDATE_PERIOD,a.default.TIMESHIFT_BUFFER_DEPTH,a.default.MAX_SEGMENT_DURATION,a.default.MAX_SUBSEGMENT_DURATION,a.default.SUGGESTED_PRESENTATION_DELAY,a.default.START,i.default.START_TIME,a.default.DURATION],n=t.length,r=0;r<n;r++)if(e.nodeName===t[r])return c.test(e.value);return!1},function(e){var t=c.exec(e),n=31536e3*parseFloat(t[3]||0)+2592e3*parseFloat(t[5]||0)+86400*parseFloat(t[7]||0)+3600*parseFloat(t[9]||0)+60*parseFloat(t[11]||0)+parseFloat(t[13]||0);return void 0!==t[1]&&(n=-n),n})}return t}();t.default=d},"./src/dash/parser/matchers/NumericMatcher.js":function(e,t,n){n.r(t);var r=n("./src/dash/parser/matchers/BaseMatcher.js");function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=s(r);if(i){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}(this,e)}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=/^[-+]?[0-9]+[.]?[0-9]*([eE][-+]?[0-9]+)?$/,u=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(t,r["default"]);var e=o(t);function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.call(this,function(e){return l.test(e.value)},function(e){return parseFloat(e)})}return t}();t.default=u},"./src/dash/parser/matchers/StringMatcher.js":function(e,t,n){n.r(t);var r=n("./src/dash/parser/matchers/BaseMatcher.js"),a=n("./src/dash/constants/DashConstants.js");function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=u(r);if(i){var n=u(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}(this,e)}}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var c=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(t,r["default"]);var e=l(t);function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e.call(this,function(e,t){var n,r=(s(n={},a.default.MPD,[a.default.ID,a.default.PROFILES]),s(n,a.default.PERIOD,[a.default.ID]),s(n,a.default.BASE_URL,[a.default.SERVICE_LOCATION,a.default.BYTE_RANGE]),s(n,a.default.SEGMENT_BASE,[a.default.INDEX_RANGE]),s(n,a.default.INITIALIZATION,[a.default.RANGE]),s(n,a.default.REPRESENTATION_INDEX,[a.default.RANGE]),s(n,a.default.SEGMENT_LIST,[a.default.INDEX_RANGE]),s(n,a.default.BITSTREAM_SWITCHING,[a.default.RANGE]),s(n,a.default.SEGMENT_URL,[a.default.MEDIA_RANGE,a.default.INDEX_RANGE]),s(n,a.default.SEGMENT_TEMPLATE,[a.default.INDEX_RANGE,a.default.MEDIA,a.default.INDEX,a.default.INITIALIZATION_MINUS,a.default.BITSTREAM_SWITCHING_MINUS]),s(n,a.default.ASSET_IDENTIFIER,[a.default.VALUE,a.default.ID]),s(n,a.default.EVENT_STREAM,[a.default.VALUE]),s(n,a.default.ADAPTATION_SET,[a.default.PROFILES,a.default.MIME_TYPE,a.default.SEGMENT_PROFILES,a.default.CODECS,a.default.CONTENT_TYPE]),s(n,a.default.FRAME_PACKING,[a.default.VALUE,a.default.ID]),s(n,a.default.AUDIO_CHANNEL_CONFIGURATION,[a.default.VALUE,a.default.ID]),s(n,a.default.CONTENT_PROTECTION,[a.default.VALUE,a.default.ID]),s(n,a.default.ESSENTIAL_PROPERTY,[a.default.VALUE,a.default.ID]),s(n,a.default.SUPPLEMENTAL_PROPERTY,[a.default.VALUE,a.default.ID]),s(n,a.default.INBAND_EVENT_STREAM,[a.default.VALUE,a.default.ID]),s(n,a.default.ACCESSIBILITY,[a.default.VALUE,a.default.ID]),s(n,a.default.ROLE,[a.default.VALUE,a.default.ID]),s(n,a.default.RATING,[a.default.VALUE,a.default.ID]),s(n,a.default.VIEWPOINT,[a.default.VALUE,a.default.ID]),s(n,a.default.CONTENT_COMPONENT,[a.default.CONTENT_TYPE]),s(n,a.default.REPRESENTATION,[a.default.ID,a.default.DEPENDENCY_ID,a.default.MEDIA_STREAM_STRUCTURE_ID]),s(n,a.default.SUBSET,[a.default.ID]),s(n,a.default.METRICS,[a.default.METRICS_MINUS]),s(n,a.default.REPORTING,[a.default.VALUE,a.default.ID]),n);if(r.hasOwnProperty(t)){var i=r[t];return void 0!==i&&0<=i.indexOf(e.name)}return!1},function(e){return String(e)})}return t}();t.default=c},"./src/dash/parser/objectiron.js":function(e,t,n){n.r(t);var r=n("./src/core/FactoryMaker.js");function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(c){function l(e,t){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}function u(e,t,n){for(var r=0,i=e.length;r<i;++r){var a=e[r];if(t[a.name])if(n[a.name]){if(a.merge){var o=t[a.name],s=n[a.name];"object"===h(o)&&"object"===h(s)?l(o,s):n[a.name]=o+s}}else n[a.name]=t[a.name]}}function d(e,t){for(var n=0,r=e.children.length;n<r;++n){var i=e.children[n],a=t[i.name+"_asArray"];if(a)for(var o=0,s=a.length;o<s;++o){var l=a[o];u(e.properties,t,l),d(i,l)}}}return{run:function(e){if(null===e||"object"!==h(e))return e;if(e.Period_asArray&&"period"in c)for(var t=c.period,n=e.Period_asArray,r=0,i=n.length;r<i;++r){var a=n[r];if(d(t,a),"adaptationset"in c){var o=a.AdaptationSet_asArray;if(o)for(var s=c.adaptationset,l=0,u=o.length;l<u;++l)d(s,o[l])}}return e}}}i.__dashjs_factory_name="ObjectIron";var a=r.default.getClassFactory(i);t.default=a},"./src/dash/utils/ListSegmentsGetter.js":function(e,t,n){n.r(t);var r=n("./src/core/FactoryMaker.js"),a=n("./src/streaming/constants/Constants.js"),h=n("./src/dash/utils/SegmentsUtils.js");function i(e,u){var c=(e=e||{}).timelineConverter;function d(){if(!c||!c.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(a.default.MISSING_CONFIG_ERROR)}function i(e,t){if(d(),!e)return null;var n=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList,r=n.SegmentURL_asArray.length,i=e&&!isNaN(e.startNumber)?e.startNumber:1,a=Math.max(i-1,0),o=Math.max(t-a,0),s=null;if(o<r){var l=n.SegmentURL_asArray[o];(s=Object(h.getIndexBasedSegment)(c,u,e,t))&&(s.replacementTime=(i+t-1)*e.segmentDuration,s.media=l.media?l.media:"",s.mediaRange=l.mediaRange,s.indexRange=l.indexRange)}return s}return{getSegmentByIndex:i,getSegmentByTime:function(e,t){if(d(),!e)return null;var n=e.segmentDuration;if(isNaN(n))return null;var r=c.calcPeriodRelativeTimeFromMpdRelativeTime(e,t);return i(e,Math.floor(r/n))},getMediaFinishedInformation:function(e){var t={numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN};if(!e)return t;var n=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList,r=e&&!isNaN(e.startNumber)?e.startNumber:1,i=Math.max(r-1,0);return t.numberOfSegments=i+n.SegmentURL_asArray.length,t}}}i.__dashjs_factory_name="ListSegmentsGetter";var o=r.default.getClassFactory(i);t.default=o},"./src/dash/utils/Round10.js":function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.r(t),n.d(t,"default",function(){return i});var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return function(e,t,n){t&&r(e.prototype,t),n&&r(e,n)}(e,null,[{key:"round10",value:function(e,t){return function(e,t,n){return void 0!==n&&0!=+n?(n=+n,null===(t=+t)||isNaN(t)||"number"!=typeof n||n%1!=0?NaN:(t=t.toString().split("e"),+((t=(t=Math[e](+(t[0]+"e"+(t[1]?t[1]-n:-n)))).toString().split("e"))[0]+"e"+(t[1]?+t[1]+n:n)))):Math[e](t)}("round",e,t)}}]),e}()},"./src/dash/utils/SegmentBaseGetter.js":function(e,t,n){n.r(t);var r=n("./src/core/FactoryMaker.js"),i=n("./src/streaming/constants/Constants.js");function a(e){var t=(e=e||{}).timelineConverter;function a(){if(!t||!t.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(i.default.MISSING_CONFIG_ERROR)}function n(e,t){if(a(),!e)return null;var n,r=e.segments?e.segments.length:-1;if(t<r&&(n=e.segments[t])&&n.index===t)return n;for(var i=0;i<r;i++)if((n=e.segments[i])&&n.index===t)return n;return null}return{getSegmentByIndex:n,getSegmentByTime:function(e,t){return a(),n(e,function(e,t){if(!e)return-1;var n,r,i,a,o,s=e.segments,l=s?s.length:null,u=-1;if(s&&0<l)for(o=0;o<l;o++)if(r=s[o],i=r.presentationStartTime,a=r.duration,i<=t+(n=a/2)&&t-n<i+a){u=r.index;break}return u}(e,t))},getMediaFinishedInformation:function(e){var t={numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN};return e&&e.segments&&(t.numberOfSegments=e.segments.length),t}}}a.__dashjs_factory_name="SegmentBaseGetter";var o=r.default.getClassFactory(a);t.default=o},"./src/dash/utils/SegmentsUtils.js":function(e,t,n){n.r(t),n.d(t,"unescapeDollarsInTemplate",function(){return r}),n.d(t,"replaceIDForTemplate",function(){return i}),n.d(t,"replaceTokenForTemplate",function(){return p}),n.d(t,"getIndexBasedSegment",function(){return a}),n.d(t,"getTimeBasedSegment",function(){return o});var u=n("./src/dash/vo/Segment.js");function d(e,t){for(;e.length<t;)e="0"+e;return e}function r(e){return e?e.split("$$").join("$"):e}function i(e,t){if(!t||!e||-1===e.indexOf("$RepresentationID$"))return e;var n=t.toString();return e.split("$RepresentationID$").join(n)}function p(e,t,n){var r,i,a,o,s,l,u=t.length,c="%0".length;if(!e)return e;for(;;){if((r=e.indexOf("$"+t))<0)return e;if((i=e.indexOf("$",r+u))<0)return e;if(r<(a=e.indexOf("%0",r+u))&&a<i)switch(o=e.charAt(i-1),s=parseInt(e.substring(a+c,i-1),10),o){case"d":case"i":case"u":l=d(n.toString(),s);break;case"x":l=d(n.toString(16),s);break;case"X":l=d(n.toString(16),s).toUpperCase();break;case"o":l=d(n.toString(8),s);break;default:return e}else l=n;e=e.substring(0,r)+l+e.substring(i+1)}}function m(e,t,n,r,i,a,o,s){var l=new u.default;return l.representation=e,l.duration=t,l.presentationStartTime=n,l.mediaStartTime=r,l.availabilityStartTime=i.calcAvailabilityStartTimeFromPresentationTime(a,e,o),l.availabilityEndTime=i.calcAvailabilityEndTimeFromPresentationTime(a+t,e,o),l.wallStartTime=i.calcWallTimeForSegment(l,o),l.replacementNumber=function(e,t){return e.representation.startNumber+t}(l,s),l.index=s,l}function g(e,t,n,r){var i=t.adaptation.period;if(isFinite(i.duration)&&i.start+i.duration<=n.presentationStartTime)return!1;if(r){if("INF"===t.availabilityTimeOffset)return!0;var a=e.getClientReferenceTime();return n.availabilityStartTime.getTime()<=a&&(!isFinite(n.availabilityEndTime)||n.availabilityEndTime.getTime()>=a)}return!0}function a(e,t,n,r){var i,a,o;i=n.segmentDuration,isNaN(i)&&(i=n.adaptation.period.duration),a=parseFloat((n.adaptation.period.start+r*i).toFixed(5)),o=parseFloat((a+i).toFixed(5));var s=m(n,i,a,e.calcMediaTimeFromPresentationTime(a,n),e,o,t,r);return g(e,n,s,t)?s:null}function o(e,t,n,r,i,a,o,s,l,u){var c,d,h=r/a,f=i/a;return c=e.calcPresentationTimeFromMediaTime(h,n),g(e,n,d=m(n,f,c,h,e,c+f,t,l),t)?(d.replacementTime=u||r,o=p(o,"Number",d.replacementNumber),o=p(o,"Time",d.replacementTime),d.media=o,d.mediaRange=s,d):null}},"./src/dash/utils/TemplateSegmentsGetter.js":function(e,t,n){n.r(t);var r=n("./src/core/FactoryMaker.js"),l=n("./src/streaming/constants/Constants.js"),u=n("./src/dash/utils/SegmentsUtils.js");function i(e,a){var o=(e=e||{}).timelineConverter;function s(){if(!o||!o.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(l.default.MISSING_CONFIG_ERROR)}function i(e,t){if(s(),!e)return null;var n=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate;t=Math.max(t,0);var r=Object(u.getIndexBasedSegment)(o,a,e,t);if(r){r.replacementTime=Math.round((t-1)*e.segmentDuration*e.timescale,10);var i=n.media;i=Object(u.replaceTokenForTemplate)(i,"Number",r.replacementNumber),i=Object(u.replaceTokenForTemplate)(i,"Time",r.replacementTime),r.media=i}return r}return{getSegmentByIndex:i,getSegmentByTime:function(e,t){if(s(),!e)return null;var n=e.segmentDuration;if(isNaN(n))return null;var r=o.calcPeriodRelativeTimeFromMpdRelativeTime(e,t);return i(e,Math.floor(r/n))},getMediaFinishedInformation:function(e){var t={numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN};if(!e)return t;var n=e.segmentDuration;return isNaN(n)?t.numberOfSegments=1:t.numberOfSegments=Math.ceil(e.adaptation.period.duration/n),t}}}i.__dashjs_factory_name="TemplateSegmentsGetter";var a=r.default.getClassFactory(i);t.default=a},"./src/dash/utils/TimelineConverter.js":function(e,t,n){n.r(t);var v=n("./src/core/EventBus.js"),y=n("./src/core/events/Events.js"),r=n("./src/core/FactoryMaker.js"),_=n("./src/dash/constants/DashConstants.js"),b=n("./src/dash/models/DashManifestModel.js"),E=n("./src/core/Settings.js"),T=n("./src/streaming/constants/Constants.js"),A=n("./src/streaming/MediaPlayerEvents.js"),w=n("./src/streaming/constants/ConformanceViolationConstants.js");function i(){var e,h,n,r,t=this.context,s=Object(v.default)(t).getInstance(),l=Object(E.default)(t).getInstance();function i(e){r=e}function a(e,t,n,r){var i,a=t.adaptation.period.mpd,o=a.availabilityStartTime;if(r)i=n&&a.timeShiftBufferDepth!==Number.POSITIVE_INFINITY?new Date(o.getTime()+1e3*(e+a.timeShiftBufferDepth)):a.availabilityEndTime;else if(n){var s=t.availabilityTimeOffset;i=new Date(o.getTime()+1e3*(e-s))}else i=o;return i}function u(e,t){return(e.getTime()-t.mpd.availabilityStartTime.getTime()+1e3*r)/1e3}function f(e,t){return e+(t.adaptation.period.start-t.presentationTimeOffset)}function c(e){var o={start:NaN,end:NaN},t=e[0].getAdapter().getRegularPeriods()[0],s=u(new Date,t);if(!e||0===e.length)return{range:o,now:s};e.forEach(function(e){var t=e.getAdapter(),n=t.getMediaInfoForType(e.getStreamInfo(),T.default.VIDEO)||t.getMediaInfoForType(e.getStreamInfo(),T.default.AUDIO),r=t.getVoRepresentations(n)[0],i={start:NaN,end:NaN};if(r)if(r.segmentInfoType===_.default.SEGMENT_TIMELINE)i=function(e){var t,n,r,i,a=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index],o=h.getRepresentationFor(e.index,a),s=o.SegmentTemplate.SegmentTimeline,l=o.SegmentTemplate.timescale,u=s.S_asArray,c={start:0,end:0},d=0;for(c.start=f(u[0].t/l,e),r=0,i=u.length;r<i;r++)t=u[r],n=0,t.hasOwnProperty("r")&&(n=t.r),d+=t.d/l*(1+n);return c.end=c.start+d,c}(r);else{var a=r.adaptation.period;i.start=a.start,i.end=Math.max(s,a.start+a.duration)}!isNaN(i.start)&&(isNaN(o.start)||o.start>i.start)&&(o.start=i.start),!isNaN(i.end)&&(isNaN(o.end)||o.end<i.end)&&(o.end=i.end)}),o.end=Math.min(s,o.end);var n=p(e,o.end,!0);return o.end=isNaN(n)?o.end:n,o.start=t&&t.mpd&&t.mpd.timeShiftBufferDepth&&!isNaN(t.mpd.timeShiftBufferDepth)&&!isNaN(o.end)?Math.max(o.end-t.mpd.timeShiftBufferDepth,o.start):o.start,o.start=p(e,o.start),{range:o,now:s}}function d(e,t){n=e-t.end}function p(e,t,n){var r=2<arguments.length&&void 0!==n&&n;try{for(var i=0,a=!1,o=NaN;!a&&i<e.length;){var s=e[i].getStreamInfo();s.start<=t&&(!isFinite(s.duration)||s.start+s.duration>=t)?(o=t,a=!0):!r&&s.start>t&&(isNaN(o)||s.start<o)?o=s.start:r&&s.start+s.duration<t&&(isNaN(o)||s.start+s.duration>o)&&(o=s.start+s.duration),i+=1}return o}catch(e){return t}}function o(e){void 0===e.offset||isNaN(e.offset)||i(e.offset/1e3)}function m(){n=r=0}function g(){s.off(y.default.UPDATE_TIME_SYNC_OFFSET,o,this),m()}return e={initialize:function(){m(),s.on(y.default.UPDATE_TIME_SYNC_OFFSET,o,this)},getClientTimeOffset:function(){return r},setClientTimeOffset:i,getClientReferenceTime:function(){return Date.now()-1e3*n+1e3*r},calcAvailabilityStartTimeFromPresentationTime:function(e,t,n){return a(e,t,n)},calcAvailabilityEndTimeFromPresentationTime:function(e,t,n){return a(e,t,n,!0)},calcPresentationTimeFromWallTime:u,calcPresentationTimeFromMediaTime:f,calcPeriodRelativeTimeFromMpdRelativeTime:function(e,t){return t-e.adaptation.period.start},calcMediaTimeFromPresentationTime:function(e,t){return e-t.adaptation.period.start+t.presentationTimeOffset},calcWallTimeForSegment:function(e,t){var n,r,i;return t&&(n=e.representation.adaptation.period.mpd.suggestedPresentationDelay,r=e.presentationStartTime+n,i=new Date(e.availabilityStartTime.getTime()+1e3*r)),i},calcTimeShiftBufferWindow:function(e,t){if(!t)return function(e){var t={start:NaN,end:NaN},n=0,r=NaN;return e.forEach(function(e){var t=e.getStreamInfo();n+=t.duration,(isNaN(r)||t.start<r)&&(r=t.start)}),t.start=r,t.end=r+n,t}(e);if(l.get().streaming.timeShiftBuffer.calcFromSegmentTimeline){var n=c(e);return d(n.now,n.range),n.range}return function(e){var t={start:NaN,end:NaN};if(!e||0===e.length)return t;var n=e[0].getAdapter().getRegularPeriods()[0],r=u(new Date,n),i=n.mpd.timeShiftBufferDepth,a=isNaN(i)?0:r-i;t.start=p(e,a),t.end=!isNaN(t.start)&&r<t.start?r:p(e,r,!0),!isNaN(i)&&t.end<r-i&&(t.end=NaN);if(l.get().streaming.timeShiftBuffer.fallbackToSegmentTimeline){var o=c(e);if(o.range.end<t.start)return s.trigger(A.default.CONFORMANCE_VIOLATION,{level:w.default.LEVELS.WARNING,event:w.default.EVENTS.INVALID_DVR_WINDOW}),d(o.now,o.range),o.range}return t}(e)},reset:g},h=Object(b.default)(t).getInstance(),g(),e}i.__dashjs_factory_name="TimelineConverter",t.default=r.default.getSingletonFactory(i)},"./src/dash/utils/TimelineSegmentsGetter.js":function(e,t,n){n.r(t);var r=n("./src/core/FactoryMaker.js"),i=n("./src/streaming/constants/Constants.js"),v=n("./src/dash/utils/SegmentsUtils.js");function a(e,p){var m=(e=e||{}).timelineConverter,l=e.dashMetrics;function t(){if(!m)throw new Error(i.default.MISSING_CONFIG_ERROR)}function n(e,t){var n,r,i,a,o,s,l,u=e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate||e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList,c=u.SegmentTimeline,d=u.SegmentURL_asArray,h=0,f=0,p=-1;l=e.timescale;var m=!1;for(i=0,a=(n=c.S_asArray).length;i<a&&!m;i++){if(s=0,(r=n[i]).hasOwnProperty("r")&&(s=r.r),r.hasOwnProperty("t")&&(f=(h=r.t)/l),s<0)s=g(e,n[i+1],r,l,f);for(o=0;o<=s&&!m;o++)(m=t(h,f,u,d,r,l,++p,i))&&(e.segmentDuration=r.d/l),f=(h+=r.d)/l}}function g(e,t,n,r,i){var a;if(t&&t.hasOwnProperty("t"))a=t.t/r;else try{var o=0;if(isNaN(e.adaptation.period.start)||isNaN(e.adaptation.period.duration)||!isFinite(e.adaptation.period.duration)){var s=l.getCurrentDVRInfo();o=isNaN(s.end)?0:s.end}else o=e.adaptation.period.start+e.adaptation.period.duration;a=m.calcMediaTimeFromPresentationTime(o,e),e.segmentDuration=n.d/r}catch(e){a=0}return Math.max(Math.ceil((a-i)/(n.d/r))-1,0)}return{getSegmentByIndex:function(c,e,d){if(t(),!c)return null;var h=null,f=!1;return n(c,function(e,t,n,r,i,a,o,s){if(f||d<0){var l=n.media,u=i.mediaRange;return r&&(l=r[s].media||"",u=r[s].mediaRange),h=Object(v.getTimeBasedSegment)(m,p,c,e,i.d,a,l,u,o,i.tManifest),!0}return t>=d-.5*i.d/a&&(f=!0),!1}),h},getSegmentByTime:function(c,e){if(t(),!c)return null;void 0===e&&(e=null);var d=null,h=m.calcMediaTimeFromPresentationTime(e,c);return n(c,function(e,t,n,r,i,a,o,s){if(h<t+i.d/a){var l=n.media,u=i.mediaRange;return r&&(l=r[s].media||"",u=r[s].mediaRange),d=Object(v.getTimeBasedSegment)(m,p,c,e,i.d,a,l,u,o,i.tManifest),!0}return!1}),d},getMediaFinishedInformation:function(e){if(!e)return 0;var t,n,r,i,a,o,s,l=(e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentTemplate||e.adaptation.period.mpd.manifest.Period_asArray[e.adaptation.period.index].AdaptationSet_asArray[e.adaptation.index].Representation_asArray[e.index].SegmentList).SegmentTimeline,u=0,c=0,d=0;for(s=e.timescale,i=(t=l.S_asArray).length,r=0;r<i;r++){if(o=0,(n=t[r]).hasOwnProperty("r")&&(o=n.r),n.hasOwnProperty("t")&&(c=(u=n.t)/s),o<0)o=g(e,t[r+1],n,s,c);for(a=0;a<=o;a++)d++,c=(u+=n.d)/s}return{numberOfSegments:d,mediaTimeOfLastSignaledSegment:c}}}}a.__dashjs_factory_name="TimelineSegmentsGetter";var o=r.default.getClassFactory(a);t.default=o},"./src/dash/vo/AdaptationSet.js":function(e,t,n){n.r(t);t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.period=null,this.index=-1,this.type=null}},"./src/dash/vo/BaseURL.js":function(e,t,n){n.r(t);function i(e,t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),this.url=e||"",this.serviceLocation=t||e||"",this.dvb_priority=n||1,this.dvb_weight=r||1,this.availabilityTimeOffset=0,this.availabilityTimeComplete=!0}i.DEFAULT_DVB_PRIORITY=1,i.DEFAULT_DVB_WEIGHT=1,t.default=i},"./src/dash/vo/Event.js":function(e,t,n){n.r(t);t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.duration=NaN,this.presentationTime=NaN,this.id=NaN,this.messageData="",this.eventStream=null,this.presentationTimeDelta=NaN}},"./src/dash/vo/EventStream.js":function(e,t,n){n.r(t);t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.adaptionSet=null,this.representation=null,this.period=null,this.timescale=1,this.value="",this.schemeIdUri="",this.presentationTimeOffset=0}},"./src/dash/vo/ManifestInfo.js":function(e,t,n){n.r(t);t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dvrWindowSize=NaN,this.loadedTime=null,this.availableFrom=null,this.minBufferTime=NaN,this.duration=NaN,this.isDynamic=!1,this.maxFragmentDuration=null}},"./src/dash/vo/MediaInfo.js":function(e,t,n){n.r(t);t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.index=null,this.type=null,this.streamInfo=null,this.representationCount=0,this.labels=null,this.lang=null,this.viewpoint=null,this.accessibility=null,this.audioChannelConfiguration=null,this.roles=null,this.codec=null,this.mimeType=null,this.contentProtection=null,this.KID=null,this.bitrateList=null,this.isFragmented=null,this.isEmbedded=null,this.selectionPriority=1}},"./src/dash/vo/Mpd.js":function(e,t,n){n.r(t);t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.manifest=null,this.suggestedPresentationDelay=0,this.availabilityStartTime=null,this.availabilityEndTime=Number.POSITIVE_INFINITY,this.timeShiftBufferDepth=Number.POSITIVE_INFINITY,this.maxSegmentDuration=Number.POSITIVE_INFINITY,this.publishTime=null,this.minimumUpdatePeriod=NaN,this.mediaPresentationDuration=NaN}},"./src/dash/vo/PatchOperation.js":function(e,t,n){function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.r(t);var r=function(){function r(e,t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this.action=e,this.xpath=t,this.value=n,this.position=null}return function(e,t,n){t&&i(e.prototype,t),n&&i(e,n)}(r,[{key:"getMpdTarget",value:function(e){var t="remove"===this.action||"replace"===this.action||"before"===this.position||"after"===this.position;return this.xpath.getMpdTarget(e,t)}}]),r}();t.default=r},"./src/dash/vo/Period.js":function(e,t,n){n.r(t);function r(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this.id=null,this.index=-1,this.duration=NaN,this.start=NaN,this.mpd=null,this.nextPeriodId=null}r.DEFAULT_ID="defaultId",t.default=r},"./src/dash/vo/Representation.js":function(e,t,n){n.r(t);var r=n("./src/dash/constants/DashConstants.js");function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.index=-1,this.adaptation=null,this.segmentInfoType=null,this.initialization=null,this.codecs=null,this.mimeType=null,this.codecPrivateData=null,this.segmentDuration=NaN,this.timescale=1,this.startNumber=1,this.indexRange=null,this.range=null,this.presentationTimeOffset=0,this.MSETimeOffset=NaN,this.mediaFinishedInformation={numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN},this.bandwidth=NaN,this.width=NaN,this.height=NaN,this.scanType=null,this.maxPlayoutRate=NaN,this.availabilityTimeOffset=0,this.availabilityTimeComplete=!0}return function(e,t,n){t&&i(e.prototype,t),n&&i(e,n)}(e,[{key:"hasInitialization",value:function(){return null!==this.initialization||null!==this.range}},{key:"hasSegments",value:function(){return this.segmentInfoType!==r.default.BASE_URL&&this.segmentInfoType!==r.default.SEGMENT_BASE&&!this.indexRange}}]),e}();t.default=a},"./src/dash/vo/RepresentationInfo.js":function(e,t,n){n.r(t);t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.quality=null,this.fragmentDuration=null,this.mediaInfo=null,this.MSETimeOffset=null}},"./src/dash/vo/Segment.js":function(e,t,n){n.r(t);t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.indexRange=null,this.index=null,this.mediaRange=null,this.media=null,this.duration=NaN,this.replacementTime=null,this.replacementNumber=NaN,this.mediaStartTime=NaN,this.presentationStartTime=NaN,this.availabilityStartTime=NaN,this.availabilityEndTime=NaN,this.wallStartTime=NaN,this.representation=null}},"./src/dash/vo/SimpleXPath.js":function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.r(t);var i=function(){function t(e){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.valid="/"==e[0],this.path=e.split("/").filter(function(e){return 0!==e.length}).map(function(e){var t={name:e},n=e.indexOf("[");if(-1!=n){t.name=e.substring(0,n);var r=e.substring(n+1,e.length-1);a.valid=a.valid&&-1==r.indexOf("[");var i=r.indexOf("=");-1!=i?(t.attribute={name:r.substring(1,i),value:r.substring(i+1)},-1!=["'",'"'].indexOf(t.attribute.value[0])&&(t.attribute.value=t.attribute.value.substring(1,t.attribute.value.length-1))):t.position=parseInt(r,10)-1}return t})}return function(e,t,n){t&&r(e.prototype,t),n&&r(e,n)}(t,[{key:"isValid",value:function(){return this.valid}},{key:"findsElement",value:function(){return!this.findsAttribute()}},{key:"findsAttribute",value:function(){return this.path[this.path.length-1].name.startsWith("@")}},{key:"getMpdTarget",value:function(e,t){for(var n=null,r=e,i=1,a="MPD";i<this.path.length&&null!==r;){n=r;var o=this.path[i];if(a=o.name,i!==this.path.length-1||!a.startsWith("@")){var s=n[a+"_asArray"]||[];0===s.length&&n[a]&&s.push(n[a]),o.position?r=s[o.position]||null:o.attribute?function(){var t=o.attribute;r=s.filter(function(e){return e[t.name]==t.value})[0]||null}():r=s[0]||null}i++}return null===r?null:a.startsWith("@")?{name:a.substring(1),leaf:r,target:r}:{name:a,leaf:r,target:t?n:r}}}]),t}();t.default=i},"./src/dash/vo/StreamInfo.js":function(e,t,n){n.r(t);t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=null,this.index=null,this.start=NaN,this.duration=NaN,this.manifestInfo=null,this.isLast=!0}},"./src/dash/vo/UTCTiming.js":function(e,t,n){n.r(t);t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.schemeIdUri="",this.value=""}},"./src/streaming/FragmentLoader.js":function(e,t,n){n.r(t);var r=n("./src/streaming/constants/Constants.js"),c=n("./src/streaming/net/URLLoader.js"),d=n("./src/streaming/vo/HeadRequest.js"),h=n("./src/streaming/vo/DashJSError.js"),i=n("./src/core/FactoryMaker.js");function a(e){e=e||{};var i,a,t=this.context,o=e.eventBus,s=e.events,n=e.urlUtils,l=e.errors,u=e.streamId;return i={checkForExistence:function(t){function e(e){o.trigger(s.CHECK_FOR_EXISTENCE_COMPLETED,{request:t,exists:e})}if(t){var n=new d.default(t.url);a.load({request:n,success:function(){e(!0)},error:function(){e(!1)}})}else e(!1)},load:function(n){function r(e,t){o.trigger(s.LOADING_COMPLETED,{request:n,response:e||null,error:t||null,sender:i})}n?a.load({request:n,progress:function(e){o.trigger(s.LOADING_PROGRESS,{request:n,stream:e.stream,streamId:u}),e.data&&o.trigger(s.LOADING_DATA_PROGRESS,{request:n,response:e.data||null,error:null,sender:i})},success:function(e){r(e)},error:function(e,t,n){r(void 0,new h.default(l.FRAGMENT_LOADER_LOADING_FAILURE_ERROR_CODE,n,t))},abort:function(e){e&&o.trigger(s.LOADING_ABANDONED,{mediaType:e.mediaType,request:e,sender:i})}}):r(void 0,new h.default(l.FRAGMENT_LOADER_NULL_REQUEST_ERROR_CODE,l.FRAGMENT_LOADER_NULL_REQUEST_ERROR_MESSAGE))},abort:function(){a&&a.abort()},reset:function(){a&&(a.abort(),a=null)}},a=Object(c.default)(t).create({errHandler:e.errHandler,errors:l,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,urlUtils:n,constants:r.default,boxParser:e.boxParser,dashConstants:e.dashConstants,requestTimeout:e.settings.get().streaming.fragmentRequestTimeout}),i}a.__dashjs_factory_name="FragmentLoader",t.default=i.default.getClassFactory(a)},"./src/streaming/ManifestLoader.js":function(e,t,n){n.r(t);var m=n("./src/streaming/constants/Constants.js"),a=n("./src/dash/constants/DashConstants.js"),o=n("./src/streaming/controllers/XlinkController.js"),g=n("./src/streaming/net/URLLoader.js"),v=n("./src/streaming/utils/URLUtils.js"),y=n("./src/streaming/vo/TextRequest.js"),_=n("./src/streaming/vo/DashJSError.js"),b=n("./src/streaming/vo/metrics/HTTPRequest.js"),E=n("./src/core/EventBus.js"),T=n("./src/core/events/Events.js"),A=n("./src/core/errors/Errors.js"),r=n("./src/core/FactoryMaker.js"),w=n("./src/dash/parser/DashParser.js");function i(e){e=e||{};var t,s,n,l,u,c=this.context,d=e.debug,h=Object(E.default)(c).getInstance(),f=Object(v.default)(c).getInstance(),p=e.mssHandler,r=e.errHandler;function i(e){h.trigger(T.default.INTERNAL_MANIFEST_LOADED,{manifest:e.manifest})}return t={load:function(o){var e=new y.default(o,b.HTTPRequest.MPD_TYPE);n.load({request:e,success:function(e,t,n){var r,i,a;if(l)if(n&&n!==o?(i=f.parseBaseUrl(n),r=n):(f.isRelative(o)&&(o=f.resolve(o,window.location.href)),i=f.parseBaseUrl(o)),"No Content"!=t)if(null===u&&(u=function(e){var t=null;return-1<e.indexOf("SmoothStreamingMedia")?(p&&(t=p.createMssParser(),p.registerEvents()),t):-1<e.indexOf("MPD")||-1<e.indexOf("Patch")?Object(w.default)(c).create({debug:d}):t}(e)),null!==u){l.setMatchers(u.getMatchers()),l.setIron(u.getIron());try{a=u.parse(e)}catch(e){return void h.trigger(T.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new _.default(A.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,A.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+"".concat(o))})}a?(a.url=r||o,a.originalUrl||(a.originalUrl=a.url),a.hasOwnProperty(m.default.LOCATION)&&(i=f.parseBaseUrl(a.Location_asArray[0]),s.debug("BaseURI set by Location to: "+i)),a.baseUri=i,a.loadedTime=new Date,l.resolveManifestOnLoad(a),h.trigger(T.default.ORIGINAL_MANIFEST_LOADED,{originalManifest:e})):h.trigger(T.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new _.default(A.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,A.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+"".concat(o))})}else h.trigger(T.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new _.default(A.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,A.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+"".concat(o))});else h.trigger(T.default.INTERNAL_MANIFEST_LOADED,{manifest:null})},error:function(e,t,n){h.trigger(T.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new _.default(A.default.MANIFEST_LOADER_LOADING_FAILURE_ERROR_CODE,A.default.MANIFEST_LOADER_LOADING_FAILURE_ERROR_MESSAGE+"".concat(o,", ").concat(n))})}})},reset:function(){h.off(T.default.XLINK_READY,i,t),p&&p.reset(),l&&(l.reset(),l=null),n&&(n.abort(),n=null)}},s=d.getLogger(t),h.on(T.default.XLINK_READY,i,t),n=Object(g.default)(c).create({errHandler:e.errHandler,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,urlUtils:f,constants:m.default,dashConstants:a.default,errors:A.default}),l=Object(o.default)(c).create({errHandler:r,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,settings:e.settings}),u=null,t}i.__dashjs_factory_name="ManifestLoader";var s=r.default.getClassFactory(i);t.default=s},"./src/streaming/ManifestUpdater.js":function(e,t,n){n.r(t);var S=n("./src/core/EventBus.js"),C=n("./src/core/events/Events.js"),x=n("./src/streaming/MediaPlayerEvents.js"),r=n("./src/core/FactoryMaker.js"),M=n("./src/core/Debug.js"),R=n("./src/core/errors/Errors.js"),I=n("./src/dash/constants/DashConstants.js"),P=n("./src/streaming/utils/URLUtils.js");function i(){var e,l,u,t,c,d,h,a,f,p,n,r,i=this.context,m=Object(S.default)(i).getInstance(),o=Object(P.default)(i).getInstance();function s(){u=NaN,d=!(c=!(h=!1)),g()}function g(){null!==t&&(clearTimeout(t),t=null)}function v(e){g(),d||(isNaN(e)&&!isNaN(u)&&(e=1e3*u),isNaN(e)||(l.debug("Refresh manifest in "+e+" milliseconds."),t=setTimeout(b,e)))}function y(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0];h=!0;var t=f.getValue(),n=t.url,r=p.getPatchLocation(t),i=p.getLocation(t);r&&!e?n=r:i&&(n=i),o.isRelative(n)&&(n=o.resolve(n,t.url)),a.load(n)}function _(e){if(e){if(p.getIsPatch(e)){var t=e;e=f.getValue();var n=p.isPatchValid(e,t),r=n;if(n){var i=p.getPublishTime(e);r=p.applyPatchToManifest(e,t);var a=p.getPublishTime(e);r=i.getTime()!=a.getTime()}if(!r)return l.debug("Patch provided is invalid, performing full manifest refresh"),void y(!0);e.loadedTime=new Date}}else(e=f.getValue()).loadedTime=new Date;if(f.getValue()&&f.getValue().type===I.default.DYNAMIC&&e.type===I.default.STATIC)return m.trigger(C.default.DYNAMIC_TO_STATIC),void(d=!(h=!1));f.setValue(e);var o=new Date,s=(o.getTime()-e.loadedTime.getTime())/1e3;2147483647<1e3*(u=p.getManifestUpdatePeriod(e,s))&&(u=2147483.647),m.trigger(C.default.MANIFEST_UPDATED,{manifest:e}),l.info("Manifest has been refreshed at "+o+"["+o.getTime()/1e3+"] "),c||v()}function b(){c||(h?v(r.get().streaming.manifestUpdateRetryInterval):y())}function E(e){e.error?e.error.code===R.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE&&n.error(e.error):_(e.manifest)}function T(){c=!1,v()}function A(){(c=!r.get().streaming.scheduling.scheduleWhilePaused)&&g()}function w(){h=!1}return e={initialize:function(){s(),m.on(C.default.STREAMS_COMPOSED,w,this),m.on(x.default.PLAYBACK_STARTED,T,this),m.on(x.default.PLAYBACK_PAUSED,A,this),m.on(C.default.INTERNAL_MANIFEST_LOADED,E,this)},setManifest:function(e){_(e)},refreshManifest:y,getIsUpdating:function(){return h},setConfig:function(e){e&&(e.manifestModel&&(f=e.manifestModel),e.adapter&&(p=e.adapter),e.manifestLoader&&(a=e.manifestLoader),e.errHandler&&(n=e.errHandler),e.settings&&(r=e.settings))},reset:function(){m.off(x.default.PLAYBACK_STARTED,T,this),m.off(x.default.PLAYBACK_PAUSED,A,this),m.off(C.default.STREAMS_COMPOSED,w,this),m.off(C.default.INTERNAL_MANIFEST_LOADED,E,this),s()}},l=Object(M.default)(i).getInstance().getLogger(e),e}i.__dashjs_factory_name="ManifestUpdater",t.default=r.default.getClassFactory(i)},"./src/streaming/MediaPlayer.js":function(e,t,n){n.r(t);var r=n("./externals/cea608-parser.js"),fe=n.n(r),pe=n("./src/streaming/constants/Constants.js"),me=n("./src/dash/constants/DashConstants.js"),ge=n("./src/streaming/constants/MetricsConstants.js"),ve=n("./src/streaming/controllers/PlaybackController.js"),ye=n("./src/streaming/controllers/StreamController.js"),_e=n("./src/streaming/controllers/GapController.js"),be=n("./src/streaming/controllers/MediaController.js"),Ee=n("./src/streaming/controllers/BaseURLController.js"),Te=n("./src/streaming/ManifestLoader.js"),Ae=n("./src/streaming/utils/ErrorHandler.js"),we=n("./src/streaming/utils/Capabilities.js"),Se=n("./src/streaming/utils/CapabilitiesFilter.js"),Ce=n("./src/streaming/utils/RequestModifier.js"),xe=n("./src/streaming/models/URIFragmentModel.js"),Me=n("./src/streaming/models/ManifestModel.js"),Re=n("./src/streaming/models/MediaPlayerModel.js"),Ie=n("./src/streaming/controllers/AbrController.js"),Pe=n("./src/streaming/net/SchemeLoaderFactory.js"),De=n("./src/streaming/models/VideoModel.js"),Le=n("./src/streaming/models/CmcdModel.js"),Oe=n("./src/streaming/utils/DOMStorage.js"),Ne=n("./src/core/Debug.js"),ke=n("./src/core/errors/Errors.js"),Be=n("./src/core/EventBus.js"),Fe=n("./src/core/events/Events.js"),je=n("./src/streaming/MediaPlayerEvents.js"),Ue=n("./src/core/FactoryMaker.js"),He=n("./src/core/Settings.js"),Ge=n("./src/core/Version.js"),Ve=n("./src/dash/controllers/SegmentBaseController.js"),ze=n("./src/dash/DashAdapter.js"),We=n("./src/dash/DashMetrics.js"),qe=n("./src/dash/utils/TimelineConverter.js"),Ye=n("./src/streaming/vo/metrics/HTTPRequest.js"),i=n("./externals/base64.js"),Ke=n.n(i),a=n("./node_modules/codem-isoboxer/dist/iso_boxer.js"),Xe=n.n(a),Qe=n("./src/streaming/vo/DashJSError.js"),Ze=n("./src/streaming/utils/SupervisorTools.js"),Je=n("./src/streaming/ManifestUpdater.js"),$e=n("./src/streaming/utils/URLUtils.js"),et=n("./src/streaming/utils/BoxParser.js"),tt=n("./src/streaming/text/TextController.js");function o(){var e,i,t,n,r,a,o,s,l,u,c,d,h,f,p,m,g,v,y,_,b,E,T,A,w,S,C,x,M,R,I,P,D,L,O,N,k="You must first call initialize() and set a source before calling this method",B="You must first call initialize() and set a valid source and view before calling this method",F="You must first call attachView() to set the video element before calling this method",j="You must first call attachSource() with a valid source before calling this method",U="MediaPlayer not initialized!",H=this.context,G=Object(Be.default)(H).getInstance(),V=Object(He.default)(H).getInstance(),z=Object(Ne.default)(H).getInstance({settings:V});function W(){ae(null),ne(null),n=null,h&&(h.reset(),h=null),f&&(f.reset(),f=null),V.reset(),m&&(m.reset(),m=null)}function q(){return!!t&&!!R.getElement()}function Y(){return Object(Ge.getVersionString)()}function K(){if(!o)throw B;return S.isPaused()}function X(e){var t=T&&T.hasVideoTrack()?pe.default.VIDEO:pe.default.AUDIO,n=C.getCurrentDVRInfo(t);if(!n)return 0;var r=S.getLiveDelay(),i=n.range.start+e;return i>n.range.end-r&&(i=n.range.end-r),i}function Q(e){if(!o)throw B;var t=te().currentTime;if(void 0!==e)t=T.getTimeRelativeToStreamId(t,e);else if(S.getIsDynamic()){var n=T&&T.hasVideoTrack()?pe.default.VIDEO:pe.default.AUDIO,r=C.getCurrentDVRInfo(n);t=null===r||0===t?0:Math.max(0,t-r.range.start)}return t}function Z(){if(!o)throw B;var e=te().duration;if(S.getIsDynamic()){var t=T&&T.hasVideoTrack()?pe.default.VIDEO:pe.default.AUDIO,n=C.getCurrentDVRInfo(t);e=n?n.range.end-n.range.start:0}return e}function J(e){Object(Ze.checkParameterType)(e,"boolean"),s=e}function $(){v.restoreDefaultUTCTimingSources()}function ee(){return C}function te(){if(!R.getElement())throw F;return R.getElement()}function ne(e){if(!r)throw U;R.setElement(e),e&&(ue(),function(){if(f)return;var e=dashjs.MetricsReporting;if("function"==typeof e){var t=e(H).create();f=t.createMetricsReporting({debug:z,eventBus:G,mediaElement:te(),adapter:g,dashMetrics:C,events:Fe.default,constants:pe.default,metricsConstants:ge.default})}}(),function(){if(p)return;var e=dashjs.MssHandler;"function"==typeof e&&(ke.default.extend(e.errors),p=e(H).create({eventBus:G,mediaPlayerModel:v,dashMetrics:C,manifestModel:x,playbackController:S,streamController:T,protectionController:h,baseURLController:_,errHandler:y,events:Fe.default,constants:pe.default,debug:z,initSegmentType:Ye.HTTPRequest.INIT_SEGMENT_TYPE,BASE64:Ke.a,ISOBoxer:Xe.a,settings:V}))}(),T&&T.switchToVideoElement()),o&&se(),he()}function re(e){if(!a)throw k;var t=T.getActiveStreamInfo();return t?d.getTracksFor(e,t.id):[]}function ie(e,n){var r=-1;e.some(function(e,t){if(e===n)return r=t,!0}),r<0||e.splice(r,1)}function ae(e){if(!r)throw U;"string"==typeof e&&I.initialize(e),t=e,(a||o)&&se(),q()&&he()}function oe(){if(!a)throw k;var e=T.getActiveStreamInfo();return e?T.getStreamById(e.id):null}function se(){a=o=!1,g.reset(),T.reset(),w.reset(),S.reset(),l.reset(),d.reset(),D.reset(),h&&(V.get().streaming.protection.keepProtectionMediaKeys?h.stop():(h.reset(),h=null,ue())),A.reset(),M.reset()}function le(){return Object(Te.default)(H).create({debug:z,errHandler:y,dashMetrics:C,mediaPlayerModel:v,requestModifier:Object(Ce.default)(H).getInstance(),mssHandler:p,settings:V})}function ue(){if(h)return h;var e=dashjs.Protection;if("function"!=typeof e)return null;var t=e(H).create();return Fe.default.extend(e.events),je.default.extend(e.events,{publicOnly:!0}),ke.default.extend(e.errors),b=b||Object(we.default)(H).getInstance(),(h=t.createProtectionSystem({debug:z,errHandler:y,videoModel:R,capabilities:b,eventBus:G,events:Fe.default,BASE64:Ke.a,constants:pe.default,cmcdModel:M,settings:V}))&&(h.setLicenseRequestFilters(L),h.setLicenseResponseFilters(O)),h}function ce(){if(!r)throw U;if(m)return m;var e=dashjs.OfflineController;if("function"!=typeof e)return null;Fe.default.extend(e.events),je.default.extend(e.events,{publicOnly:!0}),ke.default.extend(e.errors);var t=le(),n=Object(Je.default)(H).create();return n.setConfig({manifestModel:x,adapter:g,manifestLoader:t,errHandler:y}),m=e(H).create({debug:z,manifestUpdater:n,baseURLController:_,manifestLoader:t,manifestModel:x,mediaPlayerModel:v,abrController:l,playbackController:S,adapter:g,errHandler:y,dashMetrics:C,timelineConverter:c,segmentBaseController:D,schemeLoaderFactory:u,eventBus:G,events:Fe.default,errors:ke.default,constants:pe.default,settings:V,dashConstants:me.default,urlUtils:Object($e.default)(H).getInstance()})}function de(e){var t=T&&T.hasVideoTrack()?pe.default.VIDEO:pe.default.AUDIO,n=C.getCurrentDVRInfo(t);return n?e+(n.manifestInfo.availableFrom.getTime()/1e3+n.range.start):0}function he(){m&&m.resetRecords(),!a&&t&&(a=!0,i.info("Streaming Initialized"),function(){var e=le();T=T||Object(ye.default)(H).getInstance(),A=A||Object(tt.default)(H).create({errHandler:y,manifestModel:x,adapter:g,mediaController:d,videoModel:R,settings:V}),E.setConfig({capabilities:b,adapter:g,settings:V,manifestModel:x,errHandler:y}),E.setCustomCapabilitiesFilters(N),T.setConfig({capabilities:b,capabilitiesFilter:E,manifestLoader:e,manifestModel:x,mediaPlayerModel:v,protectionController:h,textController:A,adapter:g,dashMetrics:C,errHandler:y,timelineConverter:c,videoModel:R,playbackController:S,abrController:l,mediaController:d,settings:V,baseURLController:_,uriFragmentModel:I,segmentBaseController:D}),w.setConfig({settings:V,playbackController:S,streamController:T,videoModel:R,timelineConverter:c,adapter:g}),S.setConfig({streamController:T,dashMetrics:C,mediaPlayerModel:v,adapter:g,videoModel:R,timelineConverter:c,settings:V}),l.setConfig({streamController:T,domStorage:P,mediaPlayerModel:v,dashMetrics:C,adapter:g,videoModel:R,settings:V}),M.setConfig({abrController:l,dashMetrics:C,playbackController:S}),l.initialize(),T.initialize(s,n),A.initialize(),w.initialize(),M.initialize(),D.initialize()}(),"string"==typeof t?T.load(t):T.loadWithManifest(t)),!o&&q()&&(o=!0,i.info("Playback Initialized"))}return e={initialize:function(e,t,n){b||(b=Object(we.default)(H).getInstance()).setConfig({settings:V}),y=y||Object(Ae.default)(H).getInstance(),b.supportsMediaSource()?(r||(r=!0,c=Object(qe.default)(H).getInstance(),l||(l=Object(Ie.default)(H).getInstance()).setConfig({settings:V}),u=u||Object(Pe.default)(H).getInstance(),S=S||Object(ve.default)(H).getInstance(),d=d||Object(be.default)(H).getInstance(),T=T||Object(ye.default)(H).getInstance(),w=w||Object(_e.default)(H).getInstance(),E=E||Object(Se.default)(H).getInstance(),g=Object(ze.default)(H).getInstance(),x=Object(Me.default)(H).getInstance(),M=Object(Le.default)(H).getInstance(),C=Object(We.default)(H).getInstance({settings:V}),P=Object(Oe.default)(H).getInstance({settings:V}),g.setConfig({constants:pe.default,cea608parser:fe.a,errHandler:y,BASE64:Ke.a}),(_=_||Object(Ee.default)(H).create()).setConfig({adapter:g}),D=D||Object(Ve.default)(H).getInstance({dashMetrics:C,mediaPlayerModel:v,errHandler:y,baseURLController:_,events:Fe.default,eventBus:G,debug:z,boxParser:Object(et.default)(H).getInstance(),requestModifier:Object(Ce.default)(H).getInstance(),errors:ke.default}),d.setConfig({domStorage:P,settings:V}),$(),J(void 0===n||n),ce()),e&&ne(e),t&&ae(t),i.info("[dash.js "+Y()+"] MediaPlayer has been initialized")):y.error(new Qe.default(ke.default.CAPABILITY_MEDIASOURCE_ERROR_CODE,ke.default.CAPABILITY_MEDIASOURCE_ERROR_MESSAGE))},setConfig:function(e){e&&(e.capabilities&&(b=e.capabilities),e.capabilitiesFilter&&(E=e.capabilitiesFilter),e.streamController&&(T=e.streamController),e.textController&&(A=e.textController),e.gapController&&(w=e.gapController),e.playbackController&&(S=e.playbackController),e.mediaPlayerModel&&(v=e.mediaPlayerModel),e.abrController&&(l=e.abrController),e.schemeLoaderFactory&&(u=e.schemeLoaderFactory),e.mediaController&&(d=e.mediaController),e.settings&&(V=e.settings))},on:function(e,t,n,r){G.on(e,t,n,r)},off:function(e,t,n){G.off(e,t,n)},extend:function(e,t,n){Ue.default.extend(e,t,n,H)},attachView:ne,attachSource:ae,isReady:q,play:function(){if(!o)throw B;(!s||K()&&o)&&S.play()},isPaused:K,pause:function(){if(!o)throw B;S.pause()},isSeeking:function(){if(!o)throw B;return S.isSeeking()},isDynamic:function(){if(!o)throw B;return S.getIsDynamic()},seek:function(e){if(!o)throw B;if(Object(Ze.checkParameterType)(e,"number"),isNaN(e))throw pe.default.BAD_ARGUMENT_ERROR;var t=S.getIsDynamic()?X(e):e;S.seek(t)},setPlaybackRate:function(e){te().playbackRate=e},getPlaybackRate:function(){return te().playbackRate},setMute:function(e){Object(Ze.checkParameterType)(e,"boolean"),te().muted=e},isMuted:function(){return te().muted},setVolume:function(e){if("number"!=typeof e||isNaN(e)||e<0||1<e)throw pe.default.BAD_ARGUMENT_ERROR;te().volume=e},getVolume:function(){return te().volume},time:Q,duration:Z,timeAsUTC:function(){if(!o)throw B;return Q()<0?NaN:de(Q())},durationAsUTC:function(){if(!o)throw B;return de(Z())},getActiveStream:oe,getDVRWindowSize:function(){var e=T&&T.hasVideoTrack()?pe.default.VIDEO:pe.default.AUDIO,t=C.getCurrentDVRInfo(e);return t?t.manifestInfo.dvrWindowSize:0},getDVRSeekOffset:X,convertToTimeCode:function(e){e=Math.max(e,0);var t=Math.floor(e/3600),n=Math.floor(e%3600/60),r=Math.floor(e%3600%60);return(0===t?"":t<10?"0"+t.toString()+":":t.toString()+":")+(n<10?"0"+n.toString():n.toString())+":"+(r<10?"0"+r.toString():r.toString())},formatUTC:function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]&&arguments[3],i=new Date(1e3*e),a=i.toLocaleDateString(t),o=i.toLocaleTimeString(t,{hour12:n});return r?o+" "+a:o},getVersion:Y,getDebug:function(){return z},getBufferLength:function(e){var t=[pe.default.VIDEO,pe.default.AUDIO,pe.default.TEXT];if(e){if(-1===t.indexOf(e))return i.warn("getBufferLength requested for invalid type"),NaN;var n=ee().getCurrentBufferLevel(e);return n||NaN}var r=t.map(function(e){return 0<re(e).length?ee().getCurrentBufferLevel(e):Number.MAX_VALUE}).reduce(function(e,t){return Math.min(e,t)});return r===Number.MAX_VALUE?NaN:r},getTTMLRenderingDiv:function(){return R?R.getTTMLRenderingDiv():null},getVideoElement:te,getSource:function(){if(!t)throw j;return t},getCurrentLiveLatency:function(){if(!r)throw U;return o?S.getCurrentLiveLatency():NaN},getTopBitrateInfoFor:function(e){if(!a)throw k;return l.getTopBitrateInfoFor(e)},setAutoPlay:J,getAutoPlay:function(){return s},getDashMetrics:ee,getQualityFor:function(e){if(!a)throw k;if(e!==pe.default.IMAGE)return l.getQualityFor(e);var t=oe();if(!t)return-1;var n=t.getThumbnailController();return n?n.getCurrentTrackIndex():-1},setQualityFor:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2];if(!a)throw k;if(e===pe.default.IMAGE){var r=oe();if(!r)return;var i=r.getThumbnailController();i&&i.setTrackByIndex(t)}l.setPlaybackQuality(e,T.getActiveStreamInfo(),t,{forceReplace:n})},updatePortalSize:function(){l.setElementSize(),l.setWindowResizeEventCalled(!0)},enableText:function(e){var t=T.getActiveStreamInfo();return!(!t||!A)&&A.enableText(t.id,e)},enableForcedTextStreaming:function(e){return!(!T.getActiveStreamInfo()||!A)&&A.enableForcedTextStreaming(e)},isTextEnabled:function(){var e=T.getActiveStreamInfo();return!(!e||!A)&&A.isTextEnabled(e)},setTextTrack:function(e){if(!o)throw B;var t=T.getActiveStreamInfo();t&&A&&A.setTextTrack(t.id,e)},getBitrateInfoListFor:function(e){if(!a)throw k;var t=oe();return t?t.getBitrateListFor(e):[]},getStreamsFromManifest:function(e){if(!a)throw k;return g.getStreamsInfo(e)},getTracksFor:re,getTracksForTypeFromManifest:function(e,t,n){if(!a)throw k;return(n=n||g.getStreamsInfo(t,1)[0])?g.getAllMediaInfoForType(n,e,t):[]},getCurrentTrackFor:function(e){if(!a)throw k;var t=T.getActiveStreamInfo();return d.getCurrentTrackFor(e,t.id)},setInitialMediaSettingsFor:function(e,t){if(!r)throw U;d.setInitialSettings(e,t)},getInitialMediaSettingsFor:function(e){if(!r)throw U;return d.getInitialSettings(e)},setCurrentTrack:function(e){if(!a)throw k;d.setTrack(e)},addABRCustomRule:function(e,t,n){v.addABRCustomRule(e,t,n)},removeABRCustomRule:function(e){v.removeABRCustomRule(e)},removeAllABRCustomRule:function(){v.removeABRCustomRule()},getAverageThroughput:function(e){var t=l.getThroughputHistory(),n=S.getIsDynamic();return t?t.getAverageThroughput(e,n):0},retrieveManifest:function(e,n){var r=le(),i=this;G.on(Fe.default.INTERNAL_MANIFEST_LOADED,function e(t){t.error?n(null,t.error):n(t.manifest),G.off(Fe.default.INTERNAL_MANIFEST_LOADED,e,i),r.reset()},i),I.initialize(e),r.load(e)},addUTCTimingSource:function(e,t){v.addUTCTimingSource(e,t)},removeUTCTimingSource:function(e,t){v.removeUTCTimingSource(e,t)},clearDefaultUTCTimingSources:function(){v.clearDefaultUTCTimingSources()},restoreDefaultUTCTimingSources:$,setXHRWithCredentialsForType:function(e,t){v.setXHRWithCredentialsForType(e,t)},getXHRWithCredentialsForType:function(e){return v.getXHRWithCredentialsForType(e)},getProtectionController:function(){return ue()},attachProtectionController:function(e){h=e},setProtectionData:function(e){n=e,T&&T.setProtectionData(n)},registerLicenseRequestFilter:function(e){L.push(e),h&&h.setLicenseRequestFilters(L)},registerLicenseResponseFilter:function(e){O.push(e),h&&h.setLicenseResponseFilters(O)},unregisterLicenseRequestFilter:function(e){ie(L,e),h&&h.setLicenseRequestFilters(L)},unregisterLicenseResponseFilter:function(e){ie(O,e),h&&h.setLicenseResponseFilters(O)},registerCustomCapabilitiesFilter:function(e){N.push(e),E&&E.setCustomCapabilitiesFilters(N)},unregisterCustomCapabilitiesFilter:function(e){ie(N,e),E&&E.setCustomCapabilitiesFilters(N)},setCustomInitialTrackSelectionFunction:function(e){d&&d.setCustomInitialTrackSelectionFunction(e)},resetCustomInitialTrackSelectionFunction:function(){d&&d.setCustomInitialTrackSelectionFunction(null)},attachTTMLRenderingDiv:function(e){if(!R.getElement())throw F;R.setTTMLRenderingDiv(e)},getCurrentTextTrackIndex:function(){var e=T.getActiveStreamInfo();if(e&&A)return A.getCurrentTrackIdx(e.id)},provideThumbnail:function(e,t){if("function"==typeof t)if(e<0)t(null);else{var n=S.getIsDynamic()?X(e):e,r=T.getStreamForTime(n);if(null!==r){var i=r.getThumbnailController();if(i){var a=T.getTimeRelativeToStreamId(n,r.getId());return i.provide(a,t)}t(null)}else t(null)}},getDashAdapter:function(){return g},getOfflineController:function(){return ce()},getSettings:function(){return V.get()},updateSettings:function(e){V.update(e)},resetSettings:function(){V.reset()},reset:W,destroy:function(){W(),L=[],O=[],N=[],Ue.default.deleteSingletonInstances(H)}},i=z.getLogger(e),s=!(a=o=r=!1),D=g=n=m=h=null,Fe.default.extend(je.default),v=Object(Re.default)(H).getInstance(),R=Object(De.default)(H).getInstance(),I=Object(xe.default)(H).getInstance(),L=[],O=[],N=[],e}o.__dashjs_factory_name="MediaPlayer";var s=Ue.default.getClassFactory(o);s.events=je.default,s.errors=ke.default,Ue.default.updateClassFactory(o.__dashjs_factory_name,s),t.default=s},"./src/streaming/MediaPlayerEvents.js":function(e,t,n){n.r(t);var r=n("./src/core/events/EventsBase.js");function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=s(r);if(i){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}(this,e)}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=new(function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(n,r["default"]);var t=o(n);function n(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=t.call(this)).AST_IN_FUTURE="astInFuture",e.BUFFER_EMPTY="bufferStalled",e.BUFFER_LOADED="bufferLoaded",e.BUFFER_LEVEL_STATE_CHANGED="bufferStateChanged",e.BUFFER_LEVEL_UPDATED="bufferLevelUpdated",e.DYNAMIC_TO_STATIC="dynamicToStatic",e.ERROR="error",e.FRAGMENT_LOADING_COMPLETED="fragmentLoadingCompleted",e.FRAGMENT_LOADING_PROGRESS="fragmentLoadingProgress",e.FRAGMENT_LOADING_STARTED="fragmentLoadingStarted",e.FRAGMENT_LOADING_ABANDONED="fragmentLoadingAbandoned",e.LOG="log",e.MANIFEST_LOADED="manifestLoaded",e.METRICS_CHANGED="metricsChanged",e.METRIC_CHANGED="metricChanged",e.METRIC_ADDED="metricAdded",e.METRIC_UPDATED="metricUpdated",e.PERIOD_SWITCH_STARTED="periodSwitchStarted",e.PERIOD_SWITCH_COMPLETED="periodSwitchCompleted",e.QUALITY_CHANGE_REQUESTED="qualityChangeRequested",e.QUALITY_CHANGE_RENDERED="qualityChangeRendered",e.TRACK_CHANGE_RENDERED="trackChangeRendered",e.STREAM_INITIALIZING="streamInitializing",e.STREAM_UPDATED="streamUpdated",e.STREAM_ACTIVATED="streamActivated",e.STREAM_DEACTIVATED="streamDeactivated",e.STREAM_INITIALIZED="streamInitialized",e.STREAM_TEARDOWN_COMPLETE="streamTeardownComplete",e.TEXT_TRACKS_ADDED="allTextTracksAdded",e.TEXT_TRACK_ADDED="textTrackAdded",e.TTML_PARSED="ttmlParsed",e.TTML_TO_PARSE="ttmlToParse",e.CAPTION_RENDERED="captionRendered",e.CAPTION_CONTAINER_RESIZE="captionContainerResize",e.CAN_PLAY="canPlay",e.CAN_PLAY_THROUGH="canPlayThrough",e.PLAYBACK_ENDED="playbackEnded",e.PLAYBACK_ERROR="playbackError",e.PLAYBACK_NOT_ALLOWED="playbackNotAllowed",e.PLAYBACK_METADATA_LOADED="playbackMetaDataLoaded",e.PLAYBACK_LOADED_DATA="playbackLoadedData",e.PLAYBACK_PAUSED="playbackPaused",e.PLAYBACK_PLAYING="playbackPlaying",e.PLAYBACK_PROGRESS="playbackProgress",e.PLAYBACK_RATE_CHANGED="playbackRateChanged",e.PLAYBACK_SEEKED="playbackSeeked",e.PLAYBACK_SEEKING="playbackSeeking",e.PLAYBACK_SEEK_ASKED="playbackSeekAsked",e.PLAYBACK_STALLED="playbackStalled",e.PLAYBACK_STARTED="playbackStarted",e.PLAYBACK_TIME_UPDATED="playbackTimeUpdated",e.PLAYBACK_WAITING="playbackWaiting",e.MANIFEST_VALIDITY_CHANGED="manifestValidityChanged",e.EVENT_MODE_ON_START="eventModeOnStart",e.EVENT_MODE_ON_RECEIVE="eventModeOnReceive",e.CONFORMANCE_VIOLATION="conformanceViolation",e.REPRESENTATION_SWITCH="representationSwitch",e}return n}());t.default=l},"./src/streaming/MediaPlayerFactory.js":function(e,t,n){n.r(t);var a=n("./src/streaming/MediaPlayer.js");var o,u,r,i=(u="application/dash+xml",{create:c,createAll:function(e,t){var n=[];e=e||"[data-dashjs-player]";for(var r=(t=t||document).querySelectorAll(e),i=0;i<r.length;i++){var a=c(r[i],null);n.push(a)}for(var o=t.querySelectorAll('source[type="'+u+'"]'),s=0;s<o.length;s++){var l=c(d(o[s]),null);n.push(l)}return n}});function c(e,t,n){if(!e||!/^VIDEO$/i.test(e.nodeName))return null;if(e._dashjs_player)return e._dashjs_player;var r,i=e.id||e.name||"video element";if(!(t=t||[].slice.call(e.querySelectorAll("source")).filter(function(e){return e.type==u})[0])&&e.src)(t=document.createElement("source")).src=e.src;else if(!t&&!e.src)return null;return n=n||{},(r=Object(a.default)(n).create()).initialize(e,t.src,e.autoplay),(o=o||r.getDebug().getLogger()).debug("Converted "+i+" to dash.js player and added content: "+t.src),e._dashjs_player=r}function d(e){return/^VIDEO$/i.test(e.nodeName)?e:d(e.parentNode)}"undefined"!=typeof window&&window&&window.dashjs&&window.dashjs.skipAutoCreate||"undefined"==typeof window||!window||!window.addEventListener||("complete"===window.document.readyState?window.dashjs?i.createAll():r=window.setInterval(function(){window.dashjs&&(window.clearInterval(r),i.createAll())},500):window.addEventListener("load",function e(){window.removeEventListener("load",e),i.createAll()})),t.default=i},"./src/streaming/SourceBufferSink.js":function(e,t,n){n.r(t);var C=n("./src/core/Debug.js"),x=n("./src/streaming/vo/DashJSError.js"),r=n("./src/core/FactoryMaker.js"),M=n("./src/core/errors/Errors.js"),R=n("./src/core/Settings.js"),I=n("./src/streaming/constants/Constants.js"),P=n("./src/streaming/vo/metrics/HTTPRequest.js"),D=n("./src/core/events/Events.js");function i(e){var t,a,o,s,l,n,r=this.context,i=Object(R.default)(r).getInstance(),u=e.textController,c=e.eventBus,d=[],h=[],f=!1,p=e.mediaSource,m=null;function g(t){return new Promise(function(e){S(function(){s.changeType&&s.changeType(t),e()})})}function v(e){return s=u.getTextSourceBuffer(e),Promise.resolve()}function y(){if("function"==typeof s.addEventListener)try{s.addEventListener("updateend",A,!1),s.addEventListener("error",w,!1),s.addEventListener("abort",w,!1)}catch(e){n=setInterval(A,50)}else n=setInterval(A,50)}function _(r){return new Promise(function(n){s&&i.get().streaming.buffer.useAppendWindow?S(function(){try{if(!s)return void n();var e=p.duration,t=0;r&&!isNaN(r.start)&&!isNaN(r.duration)&&isFinite(r.duration)&&(e=r.start+r.duration),r&&!isNaN(r.start)&&(t=r.start),s.appendWindowEnd===e&&s.appendWindowStart===t||(s.appendWindowStart=0,s.appendWindowEnd=e+.01,s.appendWindowStart=Math.max(t-.1,0),o.debug("Updated append window for ".concat(l.type,". Set start to ").concat(s.appendWindowStart," and end to ").concat(s.appendWindowEnd))),n()}catch(e){o.warn("Failed to set append window"),n()}}):n()})}function b(e){return new Promise(function(t){s?S(function(){try{s.timestampOffset===e||isNaN(e)||(s.timestampOffset=e,o.debug("Set MSE timestamp offset to ".concat(e))),t()}catch(e){t()}}):t()})}function E(){return new Promise(function(n){S(function(){var e=s.appendWindowStart,t=s.appendWindowEnd;s&&(s.abort(),s.appendWindowStart=e,s.appendWindowEnd=t),n()})})}function T(){0<d.length&&(s.updating||(d.shift()(),T()))}function A(){s.updating||T()}function w(e){var t=e.target||{};!function(e,t){var n=t||{};c.trigger(e,n,{streamId:l.streamInfo.id,mediaType:a})}(D.default.SOURCE_BUFFER_ERROR,{error:t,lastRequestAppended:m})}function S(e){d.push(e),s.updating||T()}return t={getType:function(){return a},getAllBufferRanges:function(){try{return s.buffered}catch(e){return o.error("getAllBufferRanges exception: "+e.message),null}},getBuffer:function(){return s},append:function(n){var r=this,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return new Promise(function(e,t){n?(h.push({data:n,promise:{resolve:e,reject:t},request:i}),S(function t(){if(f)return;if(0<h.length){f=!0;var n=h[0];h.splice(0,1);var e=function(){f=!1,0<h.length&&t.call(this),n&&n.data&&n.data.segmentType&&n.data.segmentType!==P.HTTPRequest.INIT_SEGMENT_TYPE&&delete n.data.bytes,n.promise.resolve({chunk:n.data})};try{m=n.request,0===n.data.bytes.byteLength?e.call(this):(s.appendBuffer?s.appendBuffer(n.data.bytes):s.append(n.data.bytes,n.data),S(e.bind(this)))}catch(e){o.fatal('SourceBuffer append failed "'+e+'"'),0<h.length?t():f=!1,delete n.data.bytes,n.promise.reject({chunk:n.data,error:new x.default(e.code,e.message)})}}}.bind(r))):t({chunk:n,error:new x.default(M.default.APPEND_ERROR_CODE,M.default.APPEND_ERROR_MESSAGE)})})},remove:function(i){return new Promise(function(e,t){var n=i.start,r=i.end;0<=n&&n<r?S(function(){try{s.remove(n,r),S(function(){e({from:n,to:r,unintended:!1}),i.resolve&&i.resolve()})}catch(e){t({from:n,to:r,unintended:!1,error:new x.default(M.default.REMOVE_ERROR_CODE,M.default.REMOVE_ERROR_MESSAGE)}),i.reject&&i.reject(e)}}):e()})},abort:function(){return new Promise(function(t){try{h=[],"open"===p.readyState?S(function(){try{s&&s.abort(),t()}catch(e){t()}}):(s&&s.setTextTrack&&"ended"===p.readyState&&s.abort(),t())}catch(e){t()}})},reset:function(){if(s){try{d=[],function(){try{"function"==typeof s.removeEventListener&&(s.removeEventListener("updateend",A,!1),s.removeEventListener("error",w,!1),s.removeEventListener("abort",w,!1)),clearInterval(n)}catch(e){o.error(e)}}(),f=!1,h=[],s.getClassName&&"TextSourceBuffer"===s.getClassName()||(o.debug("Removing sourcebuffer from media source"),p.removeSourceBuffer(s))}catch(e){}s=null}m=null},updateTimestampOffset:b,initializeForStreamSwitch:function(e,t,n){a=(l=e).type;var r=l.codec;!function(e){s=e.getBuffer()}(n),y();var i=[];return i.push(E),i.push(_(l.streamInfo)),i.push(g(r)),t&&void 0!==t.MSETimeOffset&&i.push(b(t.MSETimeOffset)),Promise.all(i)},initializeForFirstUse:function(t,e,n){a=(l=e).type;var r=l.codec;try{if(r.match(/application\/mp4;\s*codecs="(stpp|wvtt).*"/i))return v(t);s=p.addSourceBuffer(r),y();var i=[];return i.push(_(l.streamInfo)),n&&void 0!==n.MSETimeOffset&&i.push(b(n.MSETimeOffset)),Promise.all(i)}catch(e){return l.type==I.default.TEXT&&!l.isFragmented||-1!==r.indexOf('codecs="stpp')||-1!==r.indexOf('codecs="vtt')?v(t):Promise.reject(e)}},updateAppendWindow:_,changeType:g},o=Object(C.default)(r).getInstance().getLogger(t),t}i.__dashjs_factory_name="SourceBufferSink";var a=r.default.getClassFactory(i);t.default=a},"./src/streaming/Stream.js":function(e,t,n){n.r(t);var le=n("./src/streaming/constants/Constants.js"),ue=n("./src/dash/constants/DashConstants.js"),ce=n("./src/streaming/StreamProcessor.js"),de=n("./src/streaming/controllers/FragmentController.js"),he=n("./src/streaming/thumbnail/ThumbnailController.js"),fe=n("./src/core/EventBus.js"),pe=n("./src/core/events/Events.js"),me=n("./src/core/Debug.js"),ge=n("./src/core/errors/Errors.js"),r=n("./src/core/FactoryMaker.js"),ve=n("./src/streaming/vo/DashJSError.js"),ye=n("./src/streaming/utils/BoxParser.js"),_e=n("./src/streaming/utils/URLUtils.js"),be=n("./src/streaming/controllers/BlacklistController.js"),Ee=[le.default.VIDEO,le.default.AUDIO,le.default.TEXT,le.default.MUXED,le.default.IMAGE];function i(u){u=u||{};var t,c,d,s,a,o,h,f,l,p,m,g,v,n,y,_,r,b,E=this.context,T=Object(fe.default)(E).getInstance(),e=Object(_e.default)(E).getInstance(),A=u.manifestModel,w=u.mediaPlayerModel,i=u.dashMetrics,S=u.manifestUpdater,C=u.adapter,x=u.timelineConverter,M=u.capabilities,R=u.errHandler,I=u.abrController,P=u.playbackController,D=u.eventController,L=u.mediaController,O=u.protectionController,N=u.textController,k=u.videoModel,B=u.streamInfo,F=u.settings;function j(i,e){return new Promise(function(n,t){Y(),p=!0,X();var r=k.getElement();Ee.forEach(function(e){(e!==le.default.VIDEO||!r||r&&/^VIDEO$/i.test(r.nodeName))&&function(e,t){var n,r=C.getAllMediaInfoForType(B,e),i=[],a=null;if(!r||0===r.length)return c.info("No "+e+" data.");e===le.default.VIDEO&&(h=!0);e===le.default.AUDIO&&(f=!0);for(var o=0,s=r.length;o<s;o++)a=r[o],e===le.default.TEXT&&a.isEmbedded&&(N.addEmbeddedTrack(B,a),i.push(a)),U(a)&&L.addTrack(a);0<i.length&&(L.setInitialMediaSettingsForType(e,B),N.setInitialSettings(L.getInitialSettings(e)),N.addMediaInfosToBuffer(B,e,i));if(0===(r=r.filter(function(e){return!e.isEmbedded})).length)return;if(e===le.default.IMAGE)return(g=Object(he.default)(E).create({streamInfo:B,adapter:C,baseURLController:u.baseURLController,timelineConverter:u.timelineConverter,debug:_,eventBus:T,events:pe.default,dashConstants:ue.default,dashMetrics:u.dashMetrics,segmentBaseController:u.segmentBaseController})).initialize();T.trigger(pe.default.STREAM_INITIALIZING,{streamInfo:B,mediaInfo:a}),L.setInitialMediaSettingsForType(e,B);var l=function(e,t){var n=e&&0<e.length?e[0]:null,r=m.getModel(n?n.type:null),i=n?n.type:null,a=n?n.mimeType:null,o=n?n.isFragmented:null,s=Object(ce.default)(E).create({streamInfo:B,type:i,mimeType:a,timelineConverter:x,adapter:C,manifestModel:A,mediaPlayerModel:w,fragmentModel:r,dashMetrics:u.dashMetrics,baseURLController:u.baseURLController,segmentBaseController:u.segmentBaseController,abrController:I,playbackController:P,mediaController:L,textController:N,errHandler:R,settings:F,boxParser:y,segmentBlacklistController:v});s.initialize(t,h,o),d.push(s);for(var l=0;l<e.length;l++)s.addMediaInfo(e[l]);i===le.default.TEXT&&N.addMediaInfosToBuffer(B,i,e,r);return s}(r,t);(n=L.getCurrentTrackFor(e,B.id))&&(I.updateTopQualityIndex(n),l.selectMediaInfo(e===le.default.TEXT&&n.isEmbedded?r[0]:n))}(e,i)}),function(r){return new Promise(function(t){var n={},e=d.map(function(e){return e.createBufferSinks(r)});Promise.all(e).then(function(e){e.forEach(function(e){e&&(n[e.getType()]=e)}),t(n)}).catch(function(){t(n)})})}(e).then(function(e){if(p=!1,0===d.length){var t="No streams to play.";R.error(new ve.default(ge.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,t,A.getValue())),c.fatal(t)}else Q();N.createTracks(B),n(e)}).catch(function(e){t(e)})})}function U(e){var t,n=e?e.type:null;return n===le.default.MUXED?(t="Multiplexed representations are intentionally not supported, as they are not compliant with the DASH-AVC/264 guidelines",c.fatal(t),R.error(new ve.default(ge.default.MANIFEST_ERROR_ID_MULTIPLEXED_CODE,t,A.getValue())),!1):n===le.default.TEXT||n===le.default.IMAGE||(!(e.contentProtection&&!M.supportsEncryptedMedia())||(R.error(new ve.default(ge.default.CAPABILITY_MEDIAKEYS_ERROR_CODE,ge.default.CAPABILITY_MEDIAKEYS_ERROR_MESSAGE)),!1))}function H(e){for(var t=d?d.length:0,n=0;n<t;n++){var r=d[n].getFragmentModel();r.abortRequests(),r.resetInitialSettings(),d[n].reset(!1,e)}N&&N.deactivateStream(B),oe(o=a=!(d=[])),V(!1),T.trigger(pe.default.STREAM_DEACTIVATED,{streamInfo:B})}function G(e){H(e),f=h=s=!1,r=p=!(l={}),b=[]}function V(e){r=e}function z(){return B?B.start:NaN}function W(){return B?B.id:null}function q(){return B}function Y(){if(!k||!I)throw new Error(le.default.MISSING_CONFIG_ERROR)}function K(e){e.error&&(R.error(e.error),c.fatal(e.error.message))}function X(){if(D){var e=C.getEventsFor(B);D.addInlineEvents(e)}}function Q(){for(var e=d.length,t=!!l.audio||!!l.video?new ve.default(ge.default.DATA_UPDATE_FAILED_ERROR_CODE,ge.default.DATA_UPDATE_FAILED_ERROR_MESSAGE):null,n=0;n<e;n++)if(d[n].isUpdating()||p)return;if(O){O.clearMediaInfoArray();for(var r=0;r<e&&d[r];r++){var i=d[r].getType(),a=d[r].getMediaInfo();if(i===le.default.AUDIO||i===le.default.VIDEO||i===le.default.TEXT&&a.isFragmented){var o=d[r].getMediaInfo();o&&O.initializeForMedia(o)}}}t?R.error(t):s||(s=!0,T.trigger(pe.default.STREAM_INITIALIZED,{streamInfo:B}))}function Z(){var e=ne(),t=e.length;if(0!==t){for(var n=0;n<t;n++)if(!e[n].isBufferingCompleted()&&(e[n].getType()===le.default.AUDIO||e[n].getType()===le.default.VIDEO))return void c.debug("onBufferingCompleted - One streamProcessor has finished but",e[n].getType(),"one is not buffering completed");c.debug("onBufferingCompleted - trigger STREAM_BUFFERING_COMPLETED"),o=!0,T.trigger(pe.default.STREAM_BUFFERING_COMPLETED,{streamInfo:B},{streamInfo:B})}else c.warn("onBufferingCompleted - can't trigger STREAM_BUFFERING_COMPLETED because no streamProcessor is defined")}function J(e){l[e.mediaType]=e.error,Q()}function $(e){D&&D.addInbandEvents(e.events)}function ee(e){return e&&e.type?te(e.type):null}function te(t){return t?ne().filter(function(e){return e.getType()===t})[0]:null}function ne(){for(var e,t,n=[],r=0;r<d.length;r++)(e=(t=d[r]).getType())!==le.default.AUDIO&&e!==le.default.VIDEO&&e!==le.default.TEXT||n.push(t);return n}function re(e,t){var n=q(),r=t.getStreamInfo();if(!r||!n)return!0;var i=C.getAdaptationForType(r.index,e,r),a=C.getAdaptationForType(n.index,e,n);return i&&a?!(!ie(a)&&ie(i)):!i&&!a}function ie(e){return!!e&&!!(e.ContentProtection||e.Representation&&0<e.Representation.length&&e.Representation[0].ContentProtection)}function ae(e,t,n){var r=2<arguments.length&&void 0!==n?n:null;if(!e||!e.hasOwnProperty("getStreamInfo"))return!1;var i=e.getStreamInfo(),a=r?r.getStreamInfo():q();if(!i||!a)return!1;var o=C.getAdaptationForType(i.index,t,i),s=C.getAdaptationForType(a.index,t,a);if(!o||!s)return!o&&!s;var l=o&&s&&o.mimeType===s.mimeType,u=s.Representation_asArray.map(function(e){return e.codecs}),c=o.Representation_asArray.map(function(e){return e.codecs}),d=c.some(function(e){return-1<u.indexOf(e)}),h=c.some(function(t){return u.some(function(e){return M.codecRootCompatibleWithCodec(e,t)})});return d||h&&l}function oe(e){n=e}function se(){return n}return t={initialize:function(){T.on(pe.default.BUFFERING_COMPLETED,Z,t),T.on(pe.default.DATA_UPDATE_COMPLETED,J,t),T.on(pe.default.INBAND_EVENTS,$,t),O&&(T.on(pe.default.KEY_ERROR,K,t),T.on(pe.default.SERVER_CERTIFICATE_UPDATED,K,t),T.on(pe.default.LICENSE_REQUEST_COMPLETE,K,t),T.on(pe.default.KEY_SYSTEM_SELECTED,K,t),T.on(pe.default.KEY_SESSION_CREATED,K,t),T.on(pe.default.KEY_STATUSES_CHANGED,K,t)),N.initializeForStream(B),T.trigger(pe.default.STREAM_UPDATED,{streamInfo:B})},getStreamId:function(){return B?B.id:null},activate:function(e,r){return new Promise(function(t,n){if(!a)return se()?(a=!0,T.trigger(pe.default.STREAM_ACTIVATED,{streamInfo:B}),void t(r)):void function(e,t){return j(e,t)}(e,r).then(function(e){a=!0,T.trigger(pe.default.STREAM_ACTIVATED,{streamInfo:B}),t(e)}).catch(function(e){n(e)});t(r)})},deactivate:H,getIsActive:function(){return a},getDuration:function(){return B?B.duration:NaN},getStartTime:z,getId:W,getStreamInfo:q,getHasAudioTrack:function(){return f},getHasVideoTrack:function(){return h},startPreloading:function(n,r){return new Promise(function(t,e){se()?e():(c.info("[startPreloading] Preloading next stream with id ".concat(W())),oe(!0),j(n,r).then(function(){for(var e=0;e<d.length&&d[e];e++)d[e].setExplicitBufferingTime(z()),d[e].getScheduleController().startScheduleTimer();t()}).catch(function(){oe(!1),e()}))})},getThumbnailController:function(){return g},getBitrateListFor:function(e){if(Y(),e===le.default.IMAGE)return g?g.getBitrateList():[];var t=function(e){for(var t=null,n=0;n<d.length;n++)if((t=d[n]).getType()===e)return t.getMediaInfo();return null}(e);return I.getBitrateList(t)},updateData:function(u){return new Promise(function(e){p=!0,B=u,D&&X();for(var r=[],t=0,n=d.length;t<n;t++){var i=d[t],a=i.getMediaInfo();r.push(i.updateStreamInfo(B));var o=C.getAllMediaInfoForType(B,i.getType());if(o){i.clearMediaInfoArray();for(var s=0;s<o.length;s++){var l=o[s];i.addMediaInfo(o[s]),C.areMediaInfosEqual(a,l)&&(I.updateTopQualityIndex(l),r.push(i.selectMediaInfo(l)))}}}Promise.all(r).then(function(){for(r=[];0<b.length;){var e=b.pop(),t=e.newMediaInfo,n=ee(e.oldMediaInfo);if(!n)return;r.push(n.prepareTrackSwitch()),n.selectMediaInfo(t)}return Promise.all(r)}).then(function(){p=!1,Q(),T.trigger(pe.default.STREAM_UPDATED,{streamInfo:B}),e()})})},reset:function(e){m&&(m.reset(),m=null),I&&B&&I.clearDataForStream(B.id),v&&(v.reset(),v=null),G(e),B=null,T.off(pe.default.DATA_UPDATE_COMPLETED,J,t),T.off(pe.default.BUFFERING_COMPLETED,Z,t),T.off(pe.default.INBAND_EVENTS,$,t),O&&(T.off(pe.default.KEY_ERROR,K,t),T.off(pe.default.SERVER_CERTIFICATE_UPDATED,K,t),T.off(pe.default.LICENSE_REQUEST_COMPLETE,K,t),T.off(pe.default.KEY_SYSTEM_SELECTED,K,t),T.off(pe.default.KEY_SESSION_CREATED,K,t),T.off(pe.default.KEY_STATUSES_CHANGED,K,t))},getProcessors:ne,setMediaSource:function(e){for(var t=0;t<d.length;)U(d[t].getMediaInfo())?(d[t].setMediaSource(e),t++):(d[t].reset(),d.splice(t,1));if(0===d.length){var n="No streams to play.";R.error(new ve.default(ge.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,n+"nostreams",A.getValue())),c.fatal(n)}},isMediaCodecCompatible:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return ae(e,le.default.VIDEO,t)&&ae(e,le.default.AUDIO,t)},isProtectionCompatible:function(e){return!e||re(le.default.VIDEO,e)&&re(le.default.AUDIO,e)},getPreloaded:se,getIsEndedEventSignaled:function(){return r},setIsEndedEventSignaled:V,getAdapter:function(){return C},getHasFinishedBuffering:function(){return o},setPreloaded:oe,startScheduleControllers:function(){for(var e=d.length,t=0;t<e&&d[t];t++)d[t].getScheduleController().startScheduleTimer()},prepareTrackChange:function(e){if(a&&B){o=!1;var t=e.newMediaInfo,n=A.getValue();C.setCurrentMediaInfo(B.id,t.type,t);var r=ee(t);if(r){var i=P.getTime();c.info("Stream -  Process track changed at current time "+i),n.refreshManifestOnSwitchTrack?(b.push(e),S.getIsUpdating()||(c.debug("Stream -  Refreshing manifest for switch track"),S.refreshManifest())):r.selectMediaInfo(t).then(function(){t.type!==le.default.VIDEO&&t.type!==le.default.AUDIO||I.updateTopQualityIndex(t),r.prepareTrackSwitch()})}}},prepareQualityChange:function(e){var t=te(e.mediaType);t&&t.prepareQualityChange(e)}},function(){try{_=Object(me.default)(E).getInstance(),c=_.getLogger(t),G(),y=Object(ye.default)(E).getInstance(),v=Object(be.default)(E).create({updateEventName:pe.default.SEGMENT_LOCATION_BLACKLIST_CHANGED,addBlacklistEventName:pe.default.SEGMENT_LOCATION_BLACKLIST_ADD}),m=Object(de.default)(E).create({streamInfo:B,mediaPlayerModel:w,dashMetrics:i,errHandler:R,settings:F,boxParser:y,dashConstants:ue.default,urlUtils:e})}catch(e){throw e}}(),t}i.__dashjs_factory_name="Stream",t.default=r.default.getClassFactory(i)},"./src/streaming/StreamProcessor.js":function(e,t,n){n.r(t);var oe=n("./src/streaming/constants/Constants.js"),se=n("./src/dash/constants/DashConstants.js"),le=n("./src/streaming/constants/MetricsConstants.js"),ue=n("./src/streaming/models/FragmentModel.js"),ce=n("./src/streaming/controllers/BufferController.js"),de=n("./src/streaming/text/NotFragmentedTextBufferController.js"),he=n("./src/streaming/controllers/ScheduleController.js"),fe=n("./src/dash/controllers/RepresentationController.js"),r=n("./src/core/FactoryMaker.js"),pe=n("./src/streaming/utils/SupervisorTools.js"),me=n("./src/core/EventBus.js"),ge=n("./src/core/events/Events.js"),ve=n("./src/dash/DashHandler.js"),ye=n("./src/core/errors/Errors.js"),_e=n("./src/streaming/vo/DashJSError.js"),be=n("./src/core/Debug.js"),Ee=n("./src/streaming/utils/RequestModifier.js"),Te=n("./src/streaming/utils/URLUtils.js"),Ae=n("./src/streaming/utils/BoxParser.js"),we=n("./src/streaming/vo/metrics/PlayList.js"),Se=n("./src/dash/controllers/SegmentsController.js"),Ce=n("./src/streaming/vo/metrics/HTTPRequest.js");function i(r){r=r||{};var i,a,l,u,o,s,c,y,d,h,f,p,m,_=this.context,g=Object(me.default)(_).getInstance(),v=r.streamInfo,b=r.type,E=r.errHandler,T=r.mimeType,A=r.timelineConverter,w=r.adapter,S=r.manifestModel,C=r.mediaPlayerModel,x=r.fragmentModel,M=r.abrController,R=r.playbackController,I=r.mediaController,P=r.textController,D=r.dashMetrics,L=r.settings,O=r.boxParser,N=r.segmentBlacklistController;function n(){return v.id}function k(){return b}function B(){return w.getIsTextTrack(y.getData())}function F(){u=null,m=0,h=d=!(o=[])}function j(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];if(e.sender)if(R.getIsManifestUpdateInProgress())H();else if((!B()||P.isTextEnabled())&&s&&e.representationId&&!s.appendInitSegmentFromCache(e.representationId)){var n=y.getCurrentRepresentation();if(0===n.range)return void U();var r=f?f.getInitRequest(u,n):null;r?x.executeRequest(r):t&&(c.setInitSegmentRequired(!0),H())}}function U(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];if(R.getIsManifestUpdateInProgress()||s.getIsPruningInProgress())H();else{var n=function(){var e,t=ee();if(isNaN(m)||k()===oe.default.TEXT&&!P.isTextEnabled())return null;var n=d;if(f){var r=y&&t?y.getRepresentationForQuality(t.quality):null;e=n?f.getSegmentRequestForTime(u,r,m):f.getNextSegmentRequest(u,r)}return e}();n?(d=!1,function(e){isNaN(e.startTime+e.duration)||(m=e.startTime+e.duration);e.delayLoadingTime=(new Date).getTime()+c.getTimeToLoadDelay(),c.setTimeToLoadDelay(0),function(e){var t=e.url;e.range&&(t=t.concat("_",e.range));return N.contains(t)}(e)?(a.warn("Fragment request url ".concat(e.url," for stream id ").concat(v.id," and media type ").concat(b," is on the ignore list and will be skipped")),H()):(a.debug("Next fragment request url for stream id ".concat(v.id," and media type ").concat(b," is ").concat(e.url)),x.executeRequest(e))}(n)):function(e){var t=y.getCurrentRepresentation();if(L.get().streaming.gaps.enableSeekFix&&!l&&d&&R.isSeeking()){var n=f.getValidSeekTimeCloseToTargetTime(m,u,t,L.get().streaming.gaps.threshold);if(!isNaN(n))return R.seek(n,!1,!1)}if(f.isLastSegmentRequested(t,m)){var r=f.getCurrentIndex();return a.debug("Segment requesting for stream ".concat(v.id," has finished")),g.trigger(ge.default.STREAM_REQUESTING_COMPLETED,{segmentIndex:r},{streamId:v.id,mediaType:b}),s.segmentRequestingCompleted(r),c.clearScheduleTimer()}e&&H()}(t)}}function H(){c.startScheduleTimer(L.get().streaming.lowLatencyEnabled?L.get().streaming.scheduling.lowLatencyTimeout:L.get().streaming.scheduling.defaultTimeout)}function G(e){e.error||(c.setCurrentRepresentation(w.convertRepresentationToRepresentationInfo(e.currentRepresentation)),s.getIsBufferingCompleted()||s.updateBufferTimestampOffset(e.currentRepresentation))}function V(e){D.addBufferState(b,e.state,c.getBufferTarget()),e.state!==le.default.BUFFER_EMPTY||R.isSeeking()||(a.info("Buffer is empty! Stalling!"),D.pushPlayListTraceMetrics(new Date,we.PlayListTrace.REBUFFERING_REASON))}function z(e){x.syncExecutedRequestsWithBufferedRange(s.getBuffer().getAllBufferRanges(),v.duration),e.quotaExceeded&&e.from>R.getTime()&&ae(e.from),e.hasEnoughSpaceToAppend&&e.quotaExceeded&&c.startScheduleTimer()}function W(e){if(e&&e.lastRequestAppended&&e.lastRequestAppended.url){var t=e.lastRequestAppended.url;e.lastRequestAppended.range&&(t=t.concat("_",e.lastRequestAppended.range)),a.warn("Blacklisting segment with url ".concat(t)),N.add(t)}}function q(){re(),h=!1}function Y(e){a.info("onFragmentLoadingAbandoned request: "+e.request.url+" has been aborted"),R.isSeeking()||c.getSwitchStrack()||h||(a.info("onFragmentLoadingAbandoned request: "+e.request.url+" has to be downloaded again, origin is not seeking process or switch track call"),e.request&&e.request.isInitializationRequest()?c.setInitSegmentRequired(!0):ae(e.request.startTime+e.request.duration/2),c.startScheduleTimer(0))}function K(e){a.info("OnFragmentLoadingCompleted for stream id "+v.id+" and media type "+b+" - Url:",e.request?e.request.url:"undefined",e.request.range?", Range:"+e.request.range:""),B()&&c.startScheduleTimer(0),e.error&&e.request.serviceLocation&&function(e){if(a.info("Fragment loading completed with an error"),!e||!e.request||!e.request.type)return;e.request.type===Ce.HTTPRequest.INIT_SEGMENT_TYPE?j({representationId:e.request.representationId,sender:{}},!1):e.request.type===Ce.HTTPRequest.MEDIA_SEGMENT_TYPE&&(ae(e.request.startTime+e.request.duration/2),U({},!1))}(e)}function X(){ae(R.getTime()),e().startScheduleTimer()}function Q(e){var t=e.currentTrackInfo;if(t){var n=o.find(function(e){return e.index===t.index&&e.lang===t.lang});n&&$(n).then(function(){s.setIsBufferingCompleted(!1),ae(R.getTime()),c.setInitSegmentRequired(!0),c.startScheduleTimer()})}}function Z(e){ae(e.quotaExceededTime),c.clearScheduleTimer()}function J(){return s?s.getBuffer():null}function $(e){e===u||e&&u&&e.type!==u.type||(u=e);var t=w.getRealAdaptation(v,u),n=w.getVoRepresentations(u);if(y){var r,i=y.getData(),a=M.getMaxAllowedIndexFor(b,v.id),o=M.getMinAllowedIndexFor(b,v.id),s=null;return r=null!==i&&i.id===t.id||b===oe.default.TEXT?M.getQualityFor(b,v.id):(s=M.getThroughputHistory().getAverageThroughput(b,l)||M.getInitialBitrateFor(b,v.id),M.getQualityForBitrate(u,s,v.id)),void 0!==o&&r<o&&(r=o),a<r&&(r=a),y.updateData(t,n,b,u.isFragmented,r)}return Promise.resolve()}function e(){return c}function ee(e){var t;return t=void 0!==e?(Object(pe.checkInteger)(e),y?y.getRepresentationForQuality(e):null):y?y.getCurrentRepresentation():null,w.convertRepresentationToRepresentationInfo(t)}function t(){return!!s&&s.getIsBufferingCompleted()}function te(e){var t=e.chunk,n=t.bytes,r=t.quality,i=ee(r),a=y&&i?y.getRepresentationForQuality(i.quality):null;if(i&&a){var o=w.getEventsFor(i.mediaInfo),s=w.getEventsFor(i,a);if(o&&0<o.length||s&&0<s.length){var l=function(e,t,n,r){try{for(var i={},a=[],o=n.concat(r),s=0,l=o.length;s<l;s++)i[o[s].schemeIdUri+"/"+o[s].value]=o[s];var u=Object(Ae.default)(_).getInstance().parse(e),c=u.getBoxes("emsg");if(!c||0===c.length)return a;for(var d=u.getBox("sidx"),h=!d||isNaN(d.earliest_presentation_time)||isNaN(d.timescale)?t&&!isNaN(t.mediaStartTime)?t.mediaStartTime:0:d.earliest_presentation_time/d.timescale,f=Math.max(h,0),p=y.getCurrentRepresentation(),m=0,g=c.length;m<g;m++){var v=w.getEvent(c[m],i,f,p);v&&a.push(v)}return a}catch(e){return[]}}(n,x.getRequests({state:ue.default.FRAGMENT_MODEL_EXECUTED,quality:r,index:t.index})[0],o,s);g.trigger(ge.default.INBAND_EVENTS,{events:l},{streamId:v.id})}}}function ne(){var e=R.getTime();L.get().streaming.buffer.flushBufferAtTrackSwitch&&R.seek(e+.001,!1,!0),ae(e),s.setSeekTarget(e),c.startScheduleTimer()}function re(){var e=R.getTime();ae(s.getContinuousBufferTimeForTargetTime(e)),c.startScheduleTimer()}function ie(e){e&&!isNaN(e.time)&&(ae(e.time),s.setSeekTarget(e.time))}function ae(e){m=e,d=!0}return i={initialize:function(e,t,n){p=Object(Se.default)(_).create({events:ge.default,eventBus:g,streamInfo:v,timelineConverter:A,dashConstants:se.default,segmentBaseController:r.segmentBaseController,type:b}),f=Object(ve.default)(_).create({streamInfo:v,type:b,timelineConverter:A,dashMetrics:D,mediaPlayerModel:C,baseURLController:r.baseURLController,errHandler:E,segmentsController:p,settings:L,boxParser:O,events:ge.default,eventBus:g,errors:ye.default,debug:Object(be.default)(_).getInstance(),requestModifier:Object(Ee.default)(_).getInstance(),dashConstants:se.default,constants:oe.default,urlUtils:Object(Te.default)(_).getInstance()}),l=v.manifestInfo.isDynamic,f.initialize(l),M.registerStreamType(b,i),y=Object(fe.default)(_).create({streamInfo:v,type:b,abrController:M,dashMetrics:D,playbackController:R,timelineConverter:A,dashConstants:se.default,events:ge.default,eventBus:g,errors:ye.default,isDynamic:l,segmentsController:p}),(s=function(e,t){var n=null;if(!e)return E.error(new _e.default(ye.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,ye.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+"not properly defined")),null;n=e!==oe.default.TEXT||t?Object(ce.default)(_).create({streamInfo:v,type:e,mediaPlayerModel:C,manifestModel:S,fragmentModel:x,errHandler:E,mediaController:I,representationController:y,adapter:w,textController:P,abrController:M,playbackController:R,settings:L}):Object(de.default)(_).create({streamInfo:v,type:e,mimeType:T,fragmentModel:x,textController:P,errHandler:E,settings:L});return n}(b,n))&&s.initialize(e),(c=Object(he.default)(_).create({streamInfo:v,type:b,mimeType:T,adapter:w,dashMetrics:D,mediaPlayerModel:C,fragmentModel:x,abrController:M,playbackController:R,textController:P,mediaController:I,bufferController:s,settings:L})).initialize(t),m=0,d=!1},getStreamId:n,getType:k,isUpdating:function(){return!!y&&y.isUpdating()},getBufferController:function(){return s},getFragmentModel:function(){return x},getScheduleController:e,getRepresentationController:function(){return y},getRepresentationInfo:ee,getBufferLevel:function(){return s?s.getBufferLevel():0},isBufferingCompleted:t,createBufferSinks:function(e){var t=J();return t?Promise.resolve(t):s?s.createBufferSink(u,e):Promise.resolve(null)},updateStreamInfo:function(e){return v=e,t()?Promise.resolve():s.updateAppendWindow()},getStreamInfo:function(){return v},selectMediaInfo:$,clearMediaInfoArray:function(){o=[]},addMediaInfo:function(e){-1===o.indexOf(e)&&o.push(e)},prepareTrackSwitch:function(){return new Promise(function(e){a.debug("Preparing track switch for type ".concat(b));var t=b===oe.default.TEXT||L.get().streaming.trackSwitchMode[b]===oe.default.TRACK_SWITCH_MODE_ALWAYS_REPLACE&&R.getTimeToStreamEnd(v)>L.get().streaming.buffer.stallThreshold;if(s.getIsBufferingCompleted()&&!t)return s.prepareForNonReplacementTrackSwitch(u.codec).then(function(){g.trigger(ge.default.BUFFERING_COMPLETED,{},{streamId:v.id,mediaType:b})}).catch(function(){g.trigger(ge.default.BUFFERING_COMPLETED,{},{streamId:v.id,mediaType:b})}),void e();c.clearScheduleTimer(),c.setSwitchTrack(!0),t?(g.trigger(ge.default.BUFFER_REPLACEMENT_STARTED,{mediaType:b,streamId:v.id},{mediaType:b,streamId:v.id}),x.abortRequests(),s.prepareForReplacementTrackSwitch(u.codec).then(function(){var e=ee();return s.updateBufferTimestampOffset(e)}).then(function(){ne(),e()}).catch(function(){ne(),e()})):s.prepareForNonReplacementTrackSwitch(u.codec).then(function(){re(),e()}).catch(function(){re(),e()})})},prepareQualityChange:function(e){a.debug("Preparing quality switch for type ".concat(b));var t=e.newQuality;h=!0,c.clearScheduleTimer();var n=ee(t);c.setCurrentRepresentation(n),y.prepareQualityChange(t),x.abortRequests(),s.updateBufferTimestampOffset(n).then(function(){e.reason&&e.reason.forceReplace?(g.trigger(ge.default.BUFFER_REPLACEMENT_STARTED,{mediaType:b,streamId:v.id},{mediaType:b,streamId:v.id}),s.prepareForReplacementQualitySwitch().then(function(){ne(),h=!1}).catch(function(){ne(),h=!1})):L.get().streaming.buffer.fastSwitchEnabled?function(e){var t=R.getTime(),n=x.getRequests({state:ue.default.FRAGMENT_MODEL_EXECUTED,time:t+1.5,threshold:0})[0];if(n&&!B()){var r=s.getBufferLevel(),i=M.getAbandonmentStateFor(v.id,b);if(n.quality<e.quality&&1.5<=r&&i!==le.default.ABANDON_LOAD)ae(t+1.5),c.setCheckPlaybackQuality(!1),c.startScheduleTimer();else q()}else c.startScheduleTimer();h=!1}(n):q(),D.pushPlayListTraceMetrics(new Date,we.PlayListTrace.REPRESENTATION_SWITCH_STOP_REASON),D.createPlaylistTraceMetrics(n.id,1e3*R.getTime(),R.getPlaybackRate())})},getMediaInfo:function(){return u},getMediaSource:function(){return s.getMediaSource()},setMediaSource:function(e){s.setMediaSource(e)},getBuffer:J,setExplicitBufferingTime:ae,finalisePlayList:function(e,t){D.pushPlayListTraceMetrics(e,t)},probeNextRequest:function(){var e=ee(),t=y&&e?y.getRepresentationForQuality(e.quality):null;return f.getNextSegmentRequestIdempotent(u,t)},prepareInnerPeriodPlaybackSeeking:function(i){return new Promise(function(r){c.clearScheduleTimer(),x.abortRequests(),s.prepareForPlaybackSeek().then(function(){var e=s.getAllRangesWithSafetyFactor(i.seekTime);return s.clearBuffers(e)}).then(function(){var e=s.getContinuousBufferTimeForTargetTime(i.seekTime);if(!isNaN(v.duration)&&isFinite(v.duration)&&e>=v.start+v.duration)s.setIsBufferingCompleted(!0),r();else{ae(e),s.setSeekTarget(e);var t=[];t.push(s.updateAppendWindow());var n=ee();t.push(s.updateBufferTimestampOffset(n)),Promise.all(t).then(function(){c.setInitSegmentRequired(!0),c.setCheckPlaybackQuality(!1),c.startScheduleTimer(),r()})}}).catch(function(e){a.error(e)})})},prepareOuterPeriodPlaybackSeeking:function(){return new Promise(function(e,t){try{c.clearScheduleTimer(),x.abortRequests(),s.prepareForPlaybackSeek().then(function(){return s.pruneAllSafely()}).then(function(){e()})}catch(e){t(e)}})},reset:function(e,t){f&&f.reset(),s&&(s.reset(e,t),s=null),c&&(c.reset(),c=null),y&&(y.reset(),y=null),p=p&&null,M&&M.unRegisterStreamType(n(),b),g.off(ge.default.DATA_UPDATE_COMPLETED,G,i),g.off(ge.default.INIT_FRAGMENT_NEEDED,j,i),g.off(ge.default.MEDIA_FRAGMENT_NEEDED,U,i),g.off(ge.default.MEDIA_FRAGMENT_LOADED,te,i),g.off(ge.default.BUFFER_LEVEL_STATE_CHANGED,V,i),g.off(ge.default.BUFFER_CLEARED,z,i),g.off(ge.default.SEEK_TARGET,ie,i),g.off(ge.default.FRAGMENT_LOADING_ABANDONED,Y,i),g.off(ge.default.FRAGMENT_LOADING_COMPLETED,K,i),g.off(ge.default.SET_FRAGMENTED_TEXT_AFTER_DISABLED,X,i),g.off(ge.default.SET_NON_FRAGMENTED_TEXT,Q,i),g.off(ge.default.QUOTA_EXCEEDED,Z,i),g.off(ge.default.SOURCE_BUFFER_ERROR,W,i),F(),v=b=null}},a=Object(be.default)(_).getInstance().getLogger(i),F(),g.on(ge.default.DATA_UPDATE_COMPLETED,G,i,{priority:me.default.EVENT_PRIORITY_HIGH}),g.on(ge.default.INIT_FRAGMENT_NEEDED,j,i),g.on(ge.default.MEDIA_FRAGMENT_NEEDED,U,i),g.on(ge.default.MEDIA_FRAGMENT_LOADED,te,i),g.on(ge.default.BUFFER_LEVEL_STATE_CHANGED,V,i),g.on(ge.default.BUFFER_CLEARED,z,i),g.on(ge.default.SEEK_TARGET,ie,i),g.on(ge.default.FRAGMENT_LOADING_ABANDONED,Y,i),g.on(ge.default.FRAGMENT_LOADING_COMPLETED,K,i),g.on(ge.default.QUOTA_EXCEEDED,Z,i),g.on(ge.default.SET_FRAGMENTED_TEXT_AFTER_DISABLED,X,i),g.on(ge.default.SET_NON_FRAGMENTED_TEXT,Q,i),g.on(ge.default.SOURCE_BUFFER_ERROR,W,i),i}i.__dashjs_factory_name="StreamProcessor",t.default=r.default.getClassFactory(i)},"./src/streaming/XlinkLoader.js":function(e,t,n){n.r(t);var l=n("./src/streaming/vo/DashJSError.js"),r=n("./src/streaming/net/URLLoader.js"),u=n("./src/streaming/vo/metrics/HTTPRequest.js"),c=n("./src/streaming/vo/TextRequest.js"),i=n("./src/core/EventBus.js"),d=n("./src/core/events/Events.js"),a=n("./src/core/FactoryMaker.js"),h=n("./src/core/errors/Errors.js");function o(e){e=e||{};var a="urn:mpeg:dash:resolve-to-zero:2013",t=this.context,o=Object(i.default)(t).getInstance(),s=Object(r.default)(t).create({errHandler:e.errHandler,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,errors:h.default});return{load:function(n,r,i){function t(e,t){r.resolved=!0,r.resolvedContent=e||null,o.trigger(d.default.XLINK_ELEMENT_LOADED,{element:r,resolveObject:i,error:e||t?null:new l.default(h.default.XLINK_LOADER_LOADING_FAILURE_ERROR_CODE,h.default.XLINK_LOADER_LOADING_FAILURE_ERROR_MESSAGE+n)})}if(n===a)t(null,!0);else{var e=new c.default(n,u.HTTPRequest.XLINK_EXPANSION_TYPE);s.load({request:e,success:function(e){t(e)},error:function(){t(null)}})}},reset:function(){s&&(s.abort(),s=null)}}}o.__dashjs_factory_name="XlinkLoader",t.default=a.default.getClassFactory(o)},"./src/streaming/constants/ConformanceViolationConstants.js":function(e,t,n){n.r(t),t.default={LEVELS:{SUGGESTION:"Suggestion",WARNING:"Warning",ERROR:"Error"},EVENTS:{NO_UTC_TIMING_ELEMENT:{key:"NO_UTC_TIMING_ELEMENT",message:"No UTCTiming element is present in the manifest. You may experience playback failures. For a detailed validation use https://conformance.dashif.org/"},NON_COMPLIANT_SMPTE_IMAGE_ATTRIBUTE:{key:"NON_COMPLIANT_SMPTE_IMAGE_ATTRIBUTE",message:'SMPTE 2052-1:2013 defines the attribute name as "imageType" and does not define "imagetype"'},INVALID_DVR_WINDOW:{key:"INVALID_DVR_WINDOW",message:"No valid segment found when applying a specification compliant DVR window calculation. Using SegmentTimeline entries as a fallback."}}}},"./src/streaming/constants/Constants.js":function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.r(t);var i=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init()}return function(e,t,n){t&&r(e.prototype,t),n&&r(e,n)}(e,[{key:"init",value:function(){this.STREAM="stream",this.VIDEO="video",this.AUDIO="audio",this.TEXT="text",this.MUXED="muxed",this.IMAGE="image",this.STPP="stpp",this.TTML="ttml",this.VTT="vtt",this.WVTT="wvtt",this.ABR_STRATEGY_DYNAMIC="abrDynamic",this.ABR_STRATEGY_BOLA="abrBola",this.ABR_STRATEGY_L2A="abrL2A",this.ABR_STRATEGY_LoLP="abrLoLP",this.ABR_STRATEGY_THROUGHPUT="abrThroughput",this.ABR_FETCH_THROUGHPUT_CALCULATION_DOWNLOADED_DATA="abrFetchThroughputCalculationDownloadedData",this.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING="abrFetchThroughputCalculationMoofParsing",this.ABR_FETCH_THROUGHPUT_CALCULATION_AAST="abrFetchThroughputCalculationAAST",this.LIVE_CATCHUP_MODE_DEFAULT="liveCatchupModeDefault",this.LIVE_CATCHUP_MODE_LOLP="liveCatchupModeLoLP",this.MOVING_AVERAGE_SLIDING_WINDOW="slidingWindow",this.MOVING_AVERAGE_EWMA="ewma",this.BAD_ARGUMENT_ERROR="Invalid Arguments",this.MISSING_CONFIG_ERROR="Missing config parameter(s)",this.TRACK_SWITCH_MODE_ALWAYS_REPLACE="alwaysReplace",this.TRACK_SWITCH_MODE_NEVER_REPLACE="neverReplace",this.TRACK_SELECTION_MODE_FIRST_TRACK="firstTrack",this.TRACK_SELECTION_MODE_HIGHEST_BITRATE="highestBitrate",this.TRACK_SELECTION_MODE_HIGHEST_EFFICIENCY="highestEfficiency",this.TRACK_SELECTION_MODE_WIDEST_RANGE="widestRange",this.TRACK_SELECTION_MODE_HIGHEST_SELECTION_PRIORITY="highestSelectionPriority",this.CMCD_MODE_QUERY="query",this.CMCD_MODE_HEADER="header",this.LOCATION="Location",this.INITIALIZE="initialize",this.TEXT_SHOWING="showing",this.TEXT_HIDDEN="hidden",this.CC1="CC1",this.CC3="CC3",this.UTF8="utf-8",this.SCHEME_ID_URI="schemeIdUri",this.START_TIME="starttime",this.SERVICE_DESCRIPTION_LL_SCHEME="urn:dvb:dash:lowlatency:scope:2019",this.SUPPLEMENTAL_PROPERTY_LL_SCHEME="urn:dvb:dash:lowlatency:critical:2019",this.XML="XML",this.ARRAY_BUFFER="ArrayBuffer",this.DVB_REPORTING_URL="dvb:reportingUrl",this.DVB_PROBABILITY="dvb:probability",this.VIDEO_ELEMENT_READY_STATES={HAVE_NOTHING:0,HAVE_METADATA:1,HAVE_CURRENT_DATA:2,HAVE_FUTURE_DATA:3,HAVE_ENOUGH_DATA:4}}}]),e}());t.default=i},"./src/streaming/constants/MetricsConstants.js":function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.r(t);var i=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init()}return function(e,t,n){t&&r(e.prototype,t),n&&r(e,n)}(e,[{key:"init",value:function(){this.TCP_CONNECTION="TcpList",this.HTTP_REQUEST="HttpList",this.TRACK_SWITCH="RepSwitchList",this.BUFFER_LEVEL="BufferLevel",this.BUFFER_LOADED="bufferLoaded",this.ABANDON_LOAD="abandonload",this.ALLOW_LOAD="allowload",this.BUFFER_EMPTY="bufferStalled",this.BUFFER_STATE="BufferState",this.DVR_INFO="DVRInfo",this.DROPPED_FRAMES="DroppedFrames",this.SCHEDULING_INFO="SchedulingInfo",this.REQUESTS_QUEUE="RequestsQueue",this.MANIFEST_UPDATE="ManifestUpdate",this.MANIFEST_UPDATE_STREAM_INFO="ManifestUpdatePeriodInfo",this.MANIFEST_UPDATE_TRACK_INFO="ManifestUpdateRepresentationInfo",this.PLAY_LIST="PlayList",this.DVB_ERRORS="DVBErrors"}}]),e}());t.default=i},"./src/streaming/constants/ProtectionConstants.js":function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.r(t);var i=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init()}return function(e,t,n){t&&r(e.prototype,t),n&&r(e,n)}(e,[{key:"init",value:function(){this.CLEARKEY_KEYSTEM_STRING="org.w3.clearkey",this.WIDEVINE_KEYSTEM_STRING="com.widevine.alpha",this.PLAYREADY_KEYSTEM_STRING="com.microsoft.playready",this.INITIALIZATION_DATA_TYPE_CENC="cenc",this.INITIALIZATION_DATA_TYPE_KEYIDS="keyids",this.INITIALIZATION_DATA_TYPE_WEBM="webm"}}]),e}());t.default=i},"./src/streaming/controllers/AbrController.js":function(e,t,n){n.r(t);var a=n("./src/streaming/rules/abr/ABRRulesCollection.js"),H=n("./src/streaming/constants/Constants.js"),G=n("./src/streaming/constants/MetricsConstants.js"),V=n("./src/streaming/vo/BitrateInfo.js"),z=n("./src/streaming/models/FragmentModel.js"),W=n("./src/core/EventBus.js"),q=n("./src/core/events/Events.js"),r=n("./src/core/FactoryMaker.js"),Y=n("./src/streaming/rules/RulesContext.js"),K=n("./src/streaming/rules/SwitchRequest.js"),X=n("./src/streaming/rules/SwitchRequestHistory.js"),Q=n("./src/streaming/rules/DroppedFramesHistory.js"),Z=n("./src/streaming/rules/ThroughputHistory.js"),J=n("./src/core/Debug.js"),$=n("./src/streaming/vo/metrics/HTTPRequest.js"),ee=n("./src/streaming/utils/SupervisorTools.js"),te=n("./src/streaming/MediaPlayerEvents.js");function i(){var u,d,c,s,o,h,f,p,l,m,g,v,y,_,b,E,T,A,w,S,C,x,M,R,I,P=this.context,e=Object(J.default)(P).getInstance(),D=Object(W.default)(P).getInstance();function t(){o={},h={},p={},f={},A={},C={},x={},M={},void 0===m&&(m=!1),w&&w.reset(),S=w=T=void 0,clearTimeout(l),l=null}function n(e){var t=e.request.mediaType,n=e.streamId;if(t&&n&&f[n]&&I.get().streaming.abr.autoSwitchBitrate[t]){var r=f[n][t];if(r){var i=Object(Y.default)(P).create({abrController:u,streamProcessor:r,currentRequest:e.request,useBufferOccupancyABR:C[t],useL2AABR:x[t],useLoLPABR:M[t],videoModel:_}),a=c.shouldAbandonFragment(i,n);if(a.quality>K.default.NO_CHANGE){var o=r.getFragmentModel();o.getRequests({state:z.default.FRAGMENT_MODEL_LOADING,index:e.request.index})[0]&&(o.abortRequests(),p[n][t].state=G.default.ABANDON_LOAD,A[n][t].reset(),A[n][t].push({oldValue:N(t,n),newValue:a.quality,confidence:1,reason:a.reason}),k(t,s.getActiveStreamInfo(),a.quality,a.reason),clearTimeout(l),l=setTimeout(function(){p[n][t].state=G.default.ALLOW_LOAD,l=null},I.get().streaming.abandonLoadTimeout))}}}}function r(e){e.mediaType===H.default.VIDEO&&(void 0!==T&&w.push(e.streamId,T,_.getPlaybackQuality()),T=e.newQuality)}function i(e){e.metric!==G.default.HTTP_REQUEST||!e.value||e.value.type!==$.HTTPRequest.MEDIA_SEGMENT_TYPE||e.mediaType!==H.default.AUDIO&&e.mediaType!==H.default.VIDEO||S.push(e.mediaType,e.value,I.get().streaming.abr.useDeadTimeLatency),e.metric!==G.default.BUFFER_LEVEL||e.mediaType!==H.default.AUDIO&&e.mediaType!==H.default.VIDEO||function(e,t){I.get().streaming.abr.ABRStrategy===H.default.ABR_STRATEGY_DYNAMIC&&function(e,t){var n=b.getStableBufferTime(),r=n,i=.5*n,a=C[e],o=(a?i:r)<t;(C[e]=o)!==a&&(o?d.info("["+e+"] switching from throughput to buffer occupancy ABR rule (buffer: "+t.toFixed(3)+")."):d.info("["+e+"] switching from buffer occupancy to throughput ABR rule (buffer: "+t.toFixed(3)+")."))}(e,t)}(e.mediaType,.001*e.value.level)}function L(e,t){try{return o[t]=o[t]||{},o[t].hasOwnProperty(e)||(o[t][e]=0),function(e,t,n){if(t!==H.default.VIDEO||!I.get().streaming.abr.limitBitrateByPortal||!f[n]||!f[n][t])return e;m||U();var r=f[n][t].getStreamInfo(),i=y.getAdaptationForType(r.index,t,r).Representation,a=e;if(0<g&&0<v){for(;0<a&&i[a]&&g<i[a].width&&g-i[a-1].width<i[a].width-g;)a-=1;for(;a<i.length-1&&i[a].width===i[a+1].width;)a+=1}return a}(function(e,t,n){var r=o[n][t],i=I.get().streaming.abr.maxRepresentationRatio[t];if(isNaN(i)||1<=i||i<0)return e;return Math.min(e,Math.round(r*i))}(function(e,t){var n=o[t][e],r=n;if(!f[t]||!f[t][e])return r;var i=O(e,t);void 0!==i&&(r=Math.max(n,i));var a=function(e,t){try{var n=I.get().streaming.abr.maxBitrate[e];return-1<n?F(f[t][e].getMediaInfo(),n,t):void 0}catch(e){return}}(e,t);void 0!==a&&(r=Math.min(r,a));return r}(e,t),e,t),e,t)}catch(e){return}}function O(e,t){try{return function(e,t){try{var n=I.get().streaming.abr.minBitrate[e];if(-1<n){var r=f[t][e].getMediaInfo(),i=j(r),a=F(r,n,t);return i[a]&&a<i.length-1&&i[a].bitrate<1e3*n&&a++,a}return}catch(e){return}}(e,t)}catch(e){return}}function N(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;try{if(t=t||s.getActiveStreamInfo().id,e&&f[t]&&f[t][e])if(t)return h[t]=h[t]||{},h[t].hasOwnProperty(e)||(h[t][e]=0),h[t][e];return 0}catch(e){return 0}}function k(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;if(t&&t.id&&e){var i=t.id,a=N(e,i);Object(ee.checkInteger)(n);var o=L(e,i);n!==a&&0<=n&&n<=o&&B(e,a,n,o,r,i)}}function B(e,t,n,r,i,a){if(e&&f[a]&&f[a][e]){var o=f[a][e].getStreamInfo(),s=o&&o.manifestInfo&&o.manifestInfo.isDynamic,l=R.getCurrentBufferLevel(e);d.info("Stream ID: "+a+" ["+e+"] switch from "+t+" to "+n+"/"+r+" (buffer: "+l+") "+(i?JSON.stringify(i):".")),h[a]=h[a]||{};var u=function(e,t,n){if(t&&f&&f[e]&&f[e][t]){var r=j(f[e][t].getMediaInfo());return r[n]?r[n]:null}return null}(a,e,h[a][e]=n);D.trigger(q.default.QUALITY_CHANGE_REQUESTED,{oldQuality:t,newQuality:n,reason:i,streamInfo:o,bitrateInfo:u,maxIdx:r,mediaType:e},{streamId:o.id,mediaType:e});var c=S.getAverageThroughput(e,s);isNaN(c)||E.setSavedBitrateSettings(e,c)}}function F(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,i=e&&e.type?f[n][e.type].getRepresentationInfo():null;if(I.get().streaming.abr.useDeadTimeLatency&&r&&i&&i.fragmentDuration){r/=1e3;var a=i.fragmentDuration;if(a<r)return 0;t*=1-r/a}for(var o=j(e),s=o.length-1;0<=s;s--){if(1e3*t>=o[s].bitrate)return s}return 0}function j(e){var t=[];if(!e||!e.bitrateList)return t;for(var n,r=e.bitrateList,i=e.type,a=0,o=r.length;a<o;a++)(n=new V.default).mediaType=i,n.qualityIndex=a,n.bitrate=r[a].bandwidth,n.width=r[a].width,n.height=r[a].height,n.scanType=r[a].scanType,t.push(n);return t}function U(){if(_){var e=I.get().streaming.abr.usePixelRatioInLimitBitrateByPortal&&window.hasOwnProperty("devicePixelRatio")?window.devicePixelRatio:1;g=_.getClientWidth()*e,v=_.getClientHeight()*e}}return u={initialize:function(){w=Object(Q.default)(P).create(),S=Object(Z.default)(P).create({settings:I}),(c=Object(a.default)(P).create({dashMetrics:R,mediaPlayerModel:b,settings:I})).initialize(),D.on(te.default.QUALITY_CHANGE_RENDERED,r,u),D.on(te.default.METRIC_ADDED,i,u),D.on(q.default.LOADING_PROGRESS,n,u)},isPlayingAtTopQuality:function(e){var t=e?e.id:null,n=N(H.default.AUDIO,t),r=N(H.default.VIDEO,t);return n===L(H.default.AUDIO,t)&&r===L(H.default.VIDEO,t)},updateTopQualityIndex:function(e){var t=e.type,n=e.streamInfo.id,r=e.representationCount-1;return o[n]=o[n]||{},o[n][t]=r},clearDataForStream:function(e){w&&w.clearForStream(e),f[e]&&delete f[e],A[e]&&delete A[e],p[e]&&delete p[e]},getThroughputHistory:function(){return S},getBitrateList:j,getQualityForBitrate:F,getTopBitrateInfoFor:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if(t=t||s.getActiveStreamInfo().id,e&&f&&f[t]&&f[t][e]){var n=L(e,t),r=j(f[t][e].getMediaInfo());return r[n]?r[n]:null}return null},getMinAllowedIndexFor:O,getMaxAllowedIndexFor:L,getInitialBitrateFor:function(e,t){if(!function(){if(!E||!E.hasOwnProperty("getSavedBitrateSettings"))throw new Error(H.default.MISSING_CONFIG_ERROR)}(),e===H.default.TEXT)return NaN;var n=E.getSavedBitrateSettings(e),r=I.get().streaming.abr.initialBitrate[e],i=I.get().streaming.abr.initialRepresentationRatio[e];if(-1===r)if(-1<i){var a=f[t][e].getStreamInfo(),o=y.getAdaptationForType(a.index,e,a).Representation;if(Array.isArray(o))r=o[Math.max(Math.round(o.length*i)-1,0)].bandwidth/1e3;else r=0}else r=isNaN(n)?e===H.default.VIDEO?1e3:100:n;return r},getQualityFor:N,getAbandonmentStateFor:function(e,t){return p[e]&&p[e][t]?p[e][t].state:null},setPlaybackQuality:k,checkPlaybackQuality:function(e,t){try{if(!(e&&f&&f[t]&&f[t][e]))return!1;if(w){var n=_.getPlaybackQuality();n&&w.push(t,T,n)}if(!I.get().streaming.abr.autoSwitchBitrate[e])return!1;var r=N(e,t),i=Object(Y.default)(P).create({abrController:u,switchHistory:A[t][e],droppedFramesHistory:w,streamProcessor:f[t][e],currentValue:r,useBufferOccupancyABR:C[e],useL2AABR:x[e],useLoLPABR:M[e],videoModel:_}),a=O(e,t),o=L(e,t),s=c.getMaxQuality(i),l=s.quality;return void 0!==a&&(l>K.default.NO_CHANGE?l:r)<a&&(l=a),o<l&&(l=o),A[t][e].push({oldValue:r,newValue:l}),l>K.default.NO_CHANGE&&l!==r&&(p[t][e].state===G.default.ALLOW_LOAD||r<l)&&(B(e,r,l,o,s.reason,t),!0)}catch(e){return!1}},setElementSize:U,setWindowResizeEventCalled:function(e){m=e},registerStreamType:function(e,t){var n=t.getStreamInfo().id;f[n]||(f[n]={}),A[n]||(A[n]={}),p[n]||(p[n]={}),A[n][e]=Object(X.default)(P).create(),f[n][e]=t,p[n][e]={},p[n][e].state=G.default.ALLOW_LOAD,function(e){var t=I.get().streaming.abr.ABRStrategy;t===H.default.ABR_STRATEGY_L2A?(C[e]=!1,M[e]=!1,x[e]=!0):t===H.default.ABR_STRATEGY_LoLP?(C[e]=!1,M[e]=!0,x[e]=!1):t===H.default.ABR_STRATEGY_BOLA?(C[e]=!0,M[e]=!1,x[e]=!1):t===H.default.ABR_STRATEGY_THROUGHPUT?(C[e]=!1,M[e]=!1,x[e]=!1):t===H.default.ABR_STRATEGY_DYNAMIC&&(C[e]=!(!C||!C[e])&&C[e],M[e]=!1,x[e]=!1)}(e),e===H.default.VIDEO&&U()},unRegisterStreamType:function(e,t){try{f[e]&&f[e][t]&&delete f[e][t],A[e]&&A[e][t]&&delete A[e][t],p[e]&&p[e][t]&&delete p[e][t]}catch(e){}},setConfig:function(e){e&&(e.streamController&&(s=e.streamController),e.domStorage&&(E=e.domStorage),e.mediaPlayerModel&&(b=e.mediaPlayerModel),e.dashMetrics&&(R=e.dashMetrics),e.adapter&&(y=e.adapter),e.videoModel&&(_=e.videoModel),e.settings&&(I=e.settings))},reset:function(){t(),D.off(q.default.LOADING_PROGRESS,n,u),D.off(te.default.QUALITY_CHANGE_RENDERED,r,u),D.off(te.default.METRIC_ADDED,i,u),c&&c.reset()}},d=e.getLogger(u),t(),u}i.__dashjs_factory_name="AbrController";var o=r.default.getSingletonFactory(i);o.QUALITY_DEFAULT=0,r.default.updateSingletonFactory(i.__dashjs_factory_name,o),t.default=o},"./src/streaming/controllers/BaseURLController.js":function(e,t,n){n.r(t);var l=n("./src/streaming/models/BaseURLTreeModel.js"),u=n("./src/streaming/utils/BaseURLSelector.js"),c=n("./src/streaming/utils/URLUtils.js"),d=n("./src/dash/vo/BaseURL.js"),r=n("./src/core/FactoryMaker.js"),h=n("./src/core/EventBus.js"),f=n("./src/core/events/Events.js");function i(){var e,t,n,r,i=this.context,a=Object(h.default)(i).getInstance(),o=Object(c.default)(i).getInstance();function s(e){n.invalidateSelectedIndexes(e.entry)}return e={reset:function(){n.reset(),r.reset()},initialize:function(e){n.setConfig({adapter:t}),function(e){n.update(e),r.chooseSelector(t.getIsDVB(e))}(e)},resolve:function(e){var t=n.getForPath(e).reduce(function(e,t){var n=r.select(t);return n?(o.isRelative(n.url)?e.url=o.resolve(n.url,e.url):(e.url=n.url,e.serviceLocation=n.serviceLocation),e.availabilityTimeOffset=n.availabilityTimeOffset,e.availabilityTimeComplete=n.availabilityTimeComplete,e):new d.default},new d.default);if(!o.isRelative(t.url))return t},setConfig:function(e){e.baseURLTreeModel&&(n=e.baseURLTreeModel),e.baseURLSelector&&(r=e.baseURLSelector),e.adapter&&(t=e.adapter)}},n=Object(l.default)(i).create(),r=Object(u.default)(i).create(),a.on(f.default.SERVICE_LOCATION_BLACKLIST_CHANGED,s,e),e}i.__dashjs_factory_name="BaseURLController",t.default=r.default.getClassFactory(i)},"./src/streaming/controllers/BlacklistController.js":function(e,t,n){n.r(t);var r=n("./src/core/FactoryMaker.js"),l=n("./src/core/EventBus.js");function i(e){var t;e=e||{};var n=[],r=Object(l.default)(this.context).getInstance(),i=e.updateEventName,a=e.addBlacklistEventName;function o(e){-1===n.indexOf(e)&&(n.push(e),r.trigger(i,{entry:e}))}function s(e){o(e.entry)}return t={add:o,contains:function(e){return!!(n.length&&e&&e.length)&&-1!==n.indexOf(e)},reset:function(){n=[]}},a&&r.on(a,s,t),t}i.__dashjs_factory_name="BlackListController",t.default=r.default.getClassFactory(i)},"./src/streaming/controllers/BufferController.js":function(e,t,n){n.r(t);var se=n("./src/streaming/constants/Constants.js"),le=n("./src/streaming/constants/MetricsConstants.js"),ue=n("./src/streaming/models/FragmentModel.js"),ce=n("./src/streaming/SourceBufferSink.js"),de=n("./src/core/EventBus.js"),he=n("./src/core/events/Events.js"),r=n("./src/core/FactoryMaker.js"),fe=n("./src/core/Debug.js"),pe=n("./src/streaming/utils/InitCache.js"),me=n("./src/streaming/vo/DashJSError.js"),ge=n("./src/core/errors/Errors.js"),ve=n("./src/streaming/vo/metrics/HTTPRequest.js"),ye=n("./src/streaming/MediaPlayerEvents.js"),_e="BufferController";function i(e){e=e||{};var t,a,n,r,o,s,i,l,d,u,c,h,f,p,m,g,v,y,_=this.context,b=Object(de.default)(_).getInstance(),E=e.errHandler,T=e.fragmentModel,A=e.representationController,w=e.adapter,S=e.textController,C=e.abrController,x=e.playbackController,M=e.streamInfo,R=e.type,I=e.settings;function P(e){s=e}function D(e){return w.convertRepresentationToRepresentationInfo(A.getRepresentationForQuality(e))}function L(e){I.get().streaming.cacheInitSegments&&(a.info("Init fragment finished loading saving to",R+"'s init cache"),m.save(e.chunk)),a.debug("Append Init fragment",R," with representationId:",e.chunk.representationId," and quality:",e.chunk.quality,", data size:",e.chunk.bytes.byteLength),N(e.chunk)}function O(e){N(e.chunk,e.request)}function N(e,t){var n=1<arguments.length&&void 0!==t?t:null;d.append(e,n).then(function(e){B(e)}).catch(function(e){B(e)}),e.mediaInfo.type===se.default.VIDEO&&ae(he.default.VIDEO_CHUNK_RECEIVED,{chunk:e})}function k(e){if(e&&0<e.length)for(var t=0,n=e.length;t<n;t++)a.debug("Buffered range: "+e.start(t)+" - "+e.end(t)+", currentTime = ",x.getTime())}function B(e){if(e.error)return 22===e.error.code&&function(){if(p=!0,o=.8*re(),a.warn("Quota exceeded, Critical Buffer: "+o),0<o){var e=Math.max(.2*o,1),t=o-e,n=Math.min(I.get().streaming.buffer.bufferTimeAtTopQuality,.9*t),r=Math.min(I.get().streaming.buffer.bufferTimeAtTopQualityLongForm,.9*t),i={streaming:{buffer:{bufferToKeep:parseFloat(e.toFixed(5)),bufferTimeAtTopQuality:parseFloat(n.toFixed(5)),bufferTimeAtTopQualityLongForm:parseFloat(r.toFixed(5))}}};I.update(i)}}(),void(22!==e.error.code&&ie()||(a.warn("Clearing playback buffer to overcome quota exceed situation"),ae(he.default.QUOTA_EXCEEDED,{criticalBufferLevel:o,quotaExceededTime:e.chunk.start}),X(K())));if(d&&(z(),p=!1,(c=e.chunk)&&c.endFragment)){c&&!isNaN(c.index)&&(i=Math.max(c.index,i),W());var t=d.getAllBufferRanges();c.segmentType===ve.HTTPRequest.MEDIA_SEGMENT_TYPE&&(k(t),U(),function(){if(isNaN(y))return;if(R!==se.default.AUDIO&&R!==se.default.VIDEO)return y=NaN;var e=x.getTime(),t=V(y,0);if(e===y&&t)return y=NaN;var n=A.getCurrentRepresentation().segmentDuration;if(!(t=V(y,n)))return;I.get().streaming.buffer.enableSeekDecorrelationFix&&Math.abs(e-y)>n?y<=t.end&&(x.seek(Math.max(y,t.start),!1,!0),y=NaN):e<t.start&&(x.seek(t.start,!1,!0),y=NaN)}()),c&&ae(he.default.BYTES_APPENDED_END_FRAGMENT,{quality:c.quality,startTime:c.start,index:c.index,bufferedRanges:t,segmentType:c.segmentType,mediaType:R})}}function F(){return new Promise(function(e,t){var n=j();if(!n||0===n.length)return U(),void e();X(n).then(function(){e()}).catch(function(e){t(e)})})}function j(e){var t=[],n=d.getAllBufferRanges();if(!n||0===n.length)return t;if(!e&&0!==e||isNaN(e))t.push({start:n.start(0),end:n.end(n.length-1)+.5});else{var r=function(e,t){var n=I.get().streaming.buffer.bufferToKeep,r=t.start(0);if(n<e-r){var i=Math.max(0,e-n),a=T.getRequests({state:ue.default.FRAGMENT_MODEL_EXECUTED,time:e,threshold:.01})[0];if(a&&(i=Math.min(a.startTime,i)),0<i)return{start:r,end:i}}return null}(e,n),i=function(e,t){var n=t.end(t.length-1)+.5,r=M.manifestInfo.duration>=I.get().streaming.buffer.longFormContentDurationThreshold?I.get().streaming.buffer.bufferTimeAtTopQualityLongForm:I.get().streaming.buffer.bufferTimeAtTopQuality;if(r<n-e){var i=e+r,a=T.getRequests({state:ue.default.FRAGMENT_MODEL_EXECUTED,time:e,threshold:.01})[0];if(a&&(i=Math.max(a.startTime+a.duration,i)),i<n)return{start:i,end:n}}return null}(e,n);r&&t.push(r),i&&t.push(i)}return t}function U(){(!v||R===se.default.TEXT&&S.isTextEnabled())&&z()}function H(){q()}function G(){q(),y=NaN}function V(e,t){var n,r,i=d.getAllBufferRanges(),a=0,o=0,s=null,l=null,u=0,c=isNaN(t)?.15:t;if(null!=i){for(r=0,n=i.length;r<n;r++)if(a=i.start(r),o=i.end(r),null===s)u=Math.abs(a-e),a<=e&&e<o?(s=a,l=o):u<=c&&(s=a,l=o);else{if(!((u=a-l)<=c))break;l=o}if(null!==s)return{start:s,end:l}}return null}function z(){if(x){var e=I.get().streaming.gaps.jumpGaps&&!isNaN(I.get().streaming.gaps.smallGapLimit)?I.get().streaming.gaps.smallGapLimit:NaN;r=Math.max(function(e,t){var n;return I.get().streaming.gaps.jumpGaps&&(t=I.get().streaming.gaps.smallGapLimit),null===(n=V(e,t))?0:n.end-e}(x.getTime()||0,e),0),ae(he.default.BUFFER_LEVEL_UPDATED,{mediaType:R,bufferLevel:r}),q()}}function W(){var e=l-1<=i,t=x.getTimeToStreamEnd(M)-r<=0;!e&&!t||n||(ne(!0),a.debug("checkIfBufferingCompleted trigger BUFFERING_COMPLETED for stream id ".concat(M.id," and type ").concat(R)))}function q(){R!==se.default.AUDIO&&R!==se.default.VIDEO||((!I.get().streaming.lowLatencyEnabled&&r<I.get().streaming.buffer.stallThreshold||0===r)&&!n?Y(le.default.BUFFER_EMPTY):(n||r>=I.get().streaming.buffer.stallThreshold||I.get().streaming.lowLatencyEnabled&&0<r)&&Y(le.default.BUFFER_LOADED))}function Y(e){u===e||e===le.default.BUFFER_EMPTY&&0===x.getTime()||R===se.default.TEXT&&!S.isTextEnabled()||(u=e,ae(he.default.BUFFER_LEVEL_STATE_CHANGED,{state:e}),ae(e===le.default.BUFFER_LOADED?he.default.BUFFER_LOADED:he.default.BUFFER_EMPTY),a.debug(e===le.default.BUFFER_LOADED?"Got enough buffer to start":"Waiting for more buffer before starting playback"))}function K(){var e=[],t=d.getAllBufferRanges();if(!t||0===t.length)return e;var n=x.getTime(),r=Math.max(0,n-I.get().streaming.buffer.bufferToKeep),i=T.getRequests({state:ue.default.FRAGMENT_MODEL_EXECUTED,time:n,threshold:.01})[0];if(i)r=Math.min(i.startTime,r);else if(0===n&&x.getIsDynamic())return[];if(t.start(0)<=r){for(var a={start:0,end:r},o=0;o<t.length&&t.end(o)<=r;o++)a.end=t.end(o);a.start<a.end&&e.push(a)}return e}function X(r){return new Promise(function(e,t){if(r&&d&&0!==r.length){var n=[];r.forEach(function(e){n.push(function(n){return new Promise(function(e,t){n.resolve=e,n.reject=t,g.push(n)})}(e))}),f||Q(),Promise.all(n).then(function(){e()}).catch(function(e){t(e)})}else e()})}function Q(){try{if(0===g.length||!d)return a.debug("Nothing to prune, halt pruning"),void(f=!(g=[]));var e=d.getBuffer();if(!e||!e.buffered||0===e.buffered.length)return a.debug("SourceBuffer is empty (or does not exist), halt pruning"),void(f=!(g=[]));var t=g.shift();a.debug("".concat(R,": Removing buffer from: ").concat(t.start," to ").concat(t.end)),f=!0,x.getTime()<t.end&&ne(!1),d.remove(t).then(function(e){Z(e)}).catch(function(e){Z(e)})}catch(e){f=!1}}function Z(e){a.debug("onRemoved buffer from:",e.from,"to",e.to),k(d.getAllBufferRanges()),0===g.length&&(f=!1,z()),e.unintended&&(a.warn("Detected unintended removal from:",e.from,"to",e.to,"setting streamprocessor time to",e.from),ae(he.default.SEEK_TARGET,{time:e.from})),f?Q():(v?v=!1:z(),ae(he.default.BUFFER_CLEARED,{from:e.from,to:e.to,unintended:e.unintended,hasEnoughSpaceToAppend:ie(),quotaExceeded:p}))}function J(t){return new Promise(function(e){t&&void 0!==t.MSETimeOffset&&d&&d.updateTimestampOffset?d.updateTimestampOffset(t.MSETimeOffset).then(function(){e()}).catch(function(){e()}):e()})}function $(){return d&&!n?d.updateAppendWindow(M):Promise.resolve()}function ee(){++h*(I.get().streaming.wallclockTimeUpdateInterval/1e3)>=I.get().streaming.buffer.bufferPruningInterval&&(h=0,d&&R!==se.default.TEXT&&(n||X(K())))}function te(){q()}function ne(e){n!==e&&((n=e)?ae(he.default.BUFFERING_COMPLETED):l=Number.POSITIVE_INFINITY)}function re(){try{var e,t,n=d.getAllBufferRanges(),r=0;if(!n)return r;for(t=0,e=n.length;t<e;t++)r+=n.end(t)-n.start(t);return r}catch(e){return 0}}function ie(){var e=re();return isNaN(e)||e<o}function ae(e,t){var n=t||{};b.trigger(e,n,{streamId:M.id,mediaType:R})}function oe(e,t){o=Number.POSITIVE_INFINITY,u=void 0,l=Number.POSITIVE_INFINITY,c=null,p=f=n=!1,h=r=i=0,g=[],y=NaN,d&&(e||t?d=null:d.abort().then(function(){d.reset(t),d=null})),v=!1}return t={initialize:function(e){P(e),b.on(he.default.INIT_FRAGMENT_LOADED,L,t),b.on(he.default.MEDIA_FRAGMENT_LOADED,O,t),b.on(he.default.WALLCLOCK_TIME_UPDATED,ee,t),b.on(ye.default.PLAYBACK_PLAYING,G,t),b.on(ye.default.PLAYBACK_PROGRESS,U,t),b.on(ye.default.PLAYBACK_TIME_UPDATED,U,t),b.on(ye.default.PLAYBACK_RATE_CHANGED,te,t),b.on(ye.default.PLAYBACK_STALLED,H,t)},getStreamId:function(){return M.id},getType:function(){return R},getBufferControllerType:function(){return _e},createBufferSink:function(r){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];return new Promise(function(e,t){if(m&&r&&s){var n=C.getQualityFor(R,M.id);d=Object(ce.default)(_).create({mediaSource:s,textController:S,eventBus:b}),function(e,t,n){var r=D(n);return t&&t[R]&&(R===se.default.VIDEO||R===se.default.AUDIO)?d.initializeForStreamSwitch(e,r,t[R]):d.initializeForFirstUse(M,e,r)}(r,i,n).then(function(){return J(D(n))}).then(function(){e(d)}).catch(function(e){a.fatal("Caught error on create SourceBuffer: "+e),E.error(new me.default(ge.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,ge.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+R)),t(e)})}else e(null)})},getBuffer:function(){return d},getBufferLevel:function(){return r},getRangeAt:V,setMediaSource:P,getMediaSource:function(){return s},appendInitSegmentFromCache:function(e){var t=m.extract(M.id,e);return!!t&&(a.info("Append Init fragment",R," with representationId:",t.representationId," and quality:",t.quality,", data size:",t.bytes.byteLength),N(t),!0)},getIsBufferingCompleted:function(){return n},setIsBufferingCompleted:ne,getIsPruningInProgress:function(){return f},reset:function(e,t){b.off(he.default.INIT_FRAGMENT_LOADED,L,this),b.off(he.default.MEDIA_FRAGMENT_LOADED,O,this),b.off(he.default.WALLCLOCK_TIME_UPDATED,ee,this),b.off(ye.default.PLAYBACK_PLAYING,G,this),b.off(ye.default.PLAYBACK_PROGRESS,U,this),b.off(ye.default.PLAYBACK_TIME_UPDATED,U,this),b.off(ye.default.PLAYBACK_RATE_CHANGED,te,this),b.off(ye.default.PLAYBACK_STALLED,H,this),oe(e,t)},prepareForPlaybackSeek:function(){return n&&ne(!1),d.abort()},prepareForReplacementTrackSwitch:function(n){return new Promise(function(e,t){d.abort().then(function(){return $()}).then(function(){return d.changeType(n)}).then(function(){return F()}).then(function(){ne(!1),e()}).catch(function(e){t(e)})})},prepareForNonReplacementTrackSwitch:function(n){return new Promise(function(e,t){$().then(function(){return d.changeType(n)}).then(function(){e()}).catch(function(e){t(e)})})},prepareForReplacementQualitySwitch:function(){return new Promise(function(e,t){d.abort().then(function(){return $()}).then(function(){return F()}).then(function(){ne(!1),e()}).catch(function(e){t(e)})})},updateAppendWindow:$,getAllRangesWithSafetyFactor:j,getContinuousBufferTimeForTargetTime:function(e){try{var t=e,n=d.getAllBufferRanges();if(!n||0===n.length)return e;for(var r=0;t===e&&r<n.length;){var i=n.start(r),a=n.end(r);i<=t&&t<=a&&(t=a),r+=1}return t}catch(e){}},clearBuffers:X,pruneAllSafely:F,updateBufferTimestampOffset:J,setSeekTarget:function(e){y=e},segmentRequestingCompleted:function(e){isNaN(e)||(l=e,W())}},a=Object(fe.default)(_).getInstance().getLogger(t),m=Object(pe.default)(_).getInstance(),oe(),t}i.__dashjs_factory_name=_e,t.default=r.default.getClassFactory(i)},"./src/streaming/controllers/EventController.js":function(e,t,n){n.r(t);var r=n("./src/core/FactoryMaker.js"),I=n("./src/core/Debug.js"),P=n("./src/core/EventBus.js"),D=n("./src/streaming/MediaPlayerEvents.js"),L=n("./src/streaming/net/XHRLoader.js");function i(){var e,a,i,r,t,n,o,s,l,u,c,d="urn:mpeg:dash:event:2012",h=1,f="urn:mpeg:dash:event:callback:2015",p=1,m=300,g={DISCARDED:"discarded",UPDATED:"updated",ADDED:"added"},v=this.context,y=Object(P.default)(v).getInstance();function _(){if(!o||!s)throw new Error("setConfig function has to be called previously")}function b(){c=!1,i={},t=null,u=!(r={}),n=Date.now()/1e3}function E(){try{null!==t&&c&&(clearInterval(t),t=null,c=!1,function(){try{C(r),C(i)}catch(e){}}())}catch(e){throw e}}function T(e,t,n){var r=2<arguments.length&&void 0!==n&&n,i=e.eventStream.schemeIdUri,a=e.eventStream.value,o=e.id,s=g.DISCARDED;t[i]||(t[i]=[]);var l=t[i].findIndex(function(e){return(!a||e.eventStream.value&&e.eventStream.value===a)&&e.id===o});return-1===l?(t[i].push(e),s=g.ADDED):r&&(t[i][l]=e,s=g.UPDATED),s}function A(e){try{if(e.eventStream.value==h){var t,n=e.calculatedPresentationTime;t=4294967295==e.calculatedPresentationTime?NaN:e.calculatedPresentationTime+e.duration,y.trigger(D.default.MANIFEST_VALIDITY_CHANGED,{id:e.id,validUntil:n,newDuration:t,newManifestValidAfter:NaN},{mode:D.default.EVENT_MODE_ON_START})}}catch(e){}}function w(){try{if(!u){u=!0;var e=s.getTime(),t=e-n;t=0<n?Math.max(0,t):0,S(r,t,e),S(i,t,e),n=e,u=!1}}catch(e){u=!1}}function S(n,r,i){try{x(n,function(e){if(void 0!==e){var t=isNaN(e.duration)?0:e.duration;e.calculatedPresentationTime<=i&&e.calculatedPresentationTime+r+t>=i?M(e,n,D.default.EVENT_MODE_ON_START):(function(e,t,n){try{return n<e-t}catch(e){return!1}}(i,t+r,e.calculatedPresentationTime)||function(e){try{var t=e.eventStream.period.start+e.eventStream.period.duration;return e.calculatedPresentationTime>t}catch(e){return!1}}(e))&&(a.debug("Deleting event ".concat(e.id," as it is expired or invalid")),R(n,e))}})}catch(e){}}function C(i){try{var a=s.getTime();x(i,function(e){var t=e.eventStream&&e.eventStream.period&&!isNaN(e.eventStream.period.duration)?e.eventStream.period.duration:NaN,n=e.eventStream&&e.eventStream.period&&!isNaN(e.eventStream.period.start)?e.eventStream.period.start:NaN;if(!isNaN(t)&&!isNaN(n)){var r=e.calculatedPresentationTime;Math.abs(r-a)<m&&M(e,i,D.default.EVENT_MODE_ON_START)}})}catch(e){}}function x(e,t){try{if(e)for(var n=Object.keys(e),r=0;r<n.length;r++){e[n[r]].forEach(function(e){void 0!==e&&t(e)})}}catch(e){}}function M(e,t,n){try{var r=s.getTime(),i=e.id;if(n===D.default.EVENT_MODE_ON_RECEIVE)return a.debug("Received event ".concat(i)),void y.trigger(e.eventStream.schemeIdUri,{event:e},{mode:n});e.eventStream.schemeIdUri===d&&e.eventStream.value==h?0===e.duration&&0===e.presentationTimeDelta||(a.debug("Starting manifest refresh event ".concat(i," at ").concat(r)),R(t,e),function(){try{_(),o.refreshManifest()}catch(e){}}()):e.eventStream.schemeIdUri===f&&e.eventStream.value==p?(a.debug("Starting callback event ".concat(i," at ").concat(r)),R(t,e),function(e){try{Object(L.default)(v).create({}).load({method:"get",url:e,request:{responseType:"arraybuffer"}})}catch(e){throw e}}(e.messageData)):(a.debug("Starting event ".concat(i," at ").concat(r)),R(t,e),y.trigger(e.eventStream.schemeIdUri,{event:e},{mode:n}))}catch(e){}}function R(e,t){var n=t.eventStream.schemeIdUri,r=t.eventStream.value,i=t.id;e[n]=e[n].filter(function(e){return r&&e.eventStream.value&&e.eventStream.value!==r||e.id!==i}),0===e[n].length&&delete e[n]}return e={addInlineEvents:function(e){try{if(_(),e)for(var t=0;t<e.length;t++){var n=e[t],r=T(n,i,!0);r===g.ADDED?(a.debug("Added inline event with id ".concat(n.id)),M(n,e,D.default.EVENT_MODE_ON_RECEIVE)):r===g.UPDATED&&a.debug("Updated inline event with id ".concat(n.id))}}catch(e){throw e}},addInbandEvents:function(e){try{_();for(var t=0;t<e.length;t++){var n=e[t];T(n,r,!1)===g.ADDED?(n.eventStream.schemeIdUri===d&&void 0===r[n.id]&&A(n),a.debug("Added inband event with id "+n.id),M(n,e,D.default.EVENT_MODE_ON_RECEIVE)):a.debug("Inband event with scheme_id_uri ".concat(n.eventStream.schemeIdUri,", value ").concat(n.eventStream.value," and id ").concat(n.id," was ignored because it has been added before."))}w()}catch(e){throw e}},getInbandEvents:function(){return r},getInlineEvents:function(){return i},start:function(){try{_(),a.debug("Start Event Controller");var e=l.get().streaming.eventControllerRefreshDelay;c||isNaN(e)||(c=!0,t=setInterval(w,e))}catch(e){throw e}},setConfig:function(e){try{if(!e)return;e.manifestUpdater&&(o=e.manifestUpdater),e.playbackController&&(s=e.playbackController),e.settings&&(l=e.settings)}catch(e){throw e}},reset:function(){E(),b()}},a=Object(I.default)(v).getInstance().getLogger(e),b(),e}i.__dashjs_factory_name="EventController",t.default=r.default.getSingletonFactory(i)},"./src/streaming/controllers/FragmentController.js":function(e,t,n){n.r(t);var p=n("./src/streaming/constants/Constants.js"),m=n("./src/streaming/vo/DataChunk.js"),g=n("./src/streaming/models/FragmentModel.js"),v=n("./src/streaming/FragmentLoader.js"),y=n("./src/streaming/utils/RequestModifier.js"),_=n("./src/core/EventBus.js"),b=n("./src/core/events/Events.js"),E=n("./src/streaming/MediaPlayerEvents.js"),T=n("./src/core/errors/Errors.js"),r=n("./src/core/FactoryMaker.js"),A=n("./src/core/Debug.js");function i(n){n=n||{};var e,o,r,i=this.context,s=Object(_.default)(i).getInstance(),a=n.errHandler,l=n.mediaPlayerModel,u=n.dashMetrics,c=Object(A.default)(i).getInstance(),d=n.streamInfo;function h(){return d.id}function t(){for(var e in r)r[e].reset();r={}}function f(e){if(e.sender){var t=e.request,n=e.response,r=t.isInitializationRequest(),i=t.mediaInfo.streamInfo;if(e.error&&(t.mediaType===p.default.AUDIO||t.mediaType===p.default.VIDEO||t.mediaType===p.default.TEXT&&t.mediaInfo.isFragmented)&&s.trigger(b.default.SERVICE_LOCATION_BLACKLIST_ADD,{entry:e.request.serviceLocation}),n&&i){var a=function(e,t,n,r){var i=new m.default;return i.streamId=n,i.mediaInfo=t.mediaInfo,i.segmentType=t.type,i.start=t.startTime,i.duration=t.duration,i.end=i.start+i.duration,i.bytes=e,i.index=t.index,i.quality=t.quality,i.representationId=t.representationId,i.endFragment=r,i}(n,t,d.id,e.type!==b.default.FRAGMENT_LOADING_PROGRESS);s.trigger(r?b.default.INIT_FRAGMENT_LOADED:b.default.MEDIA_FRAGMENT_LOADED,{chunk:a,request:t},{streamId:i.id,mediaType:t.mediaType})}else o.warn("No "+t.mediaType+" bytes to push or stream is inactive.")}}return e={getStreamId:h,getModel:function(e){var t=r[e];return t||(t=Object(g.default)(i).create({streamInfo:d,type:e,dashMetrics:u,fragmentLoader:Object(v.default)(i).create({dashMetrics:u,mediaPlayerModel:l,errHandler:a,requestModifier:Object(y.default)(i).getInstance(),settings:n.settings,boxParser:n.boxParser,eventBus:s,events:b.default,errors:T.default,dashConstants:n.dashConstants,urlUtils:n.urlUtils,streamId:h()}),debug:c,eventBus:s,events:b.default}),r[e]=t),t},reset:function(){s.off(E.default.FRAGMENT_LOADING_COMPLETED,f,this),s.off(E.default.FRAGMENT_LOADING_PROGRESS,f,this),t()}},o=c.getLogger(e),t(),s.on(E.default.FRAGMENT_LOADING_COMPLETED,f,e),s.on(E.default.FRAGMENT_LOADING_PROGRESS,f,e),e}i.__dashjs_factory_name="FragmentController",t.default=r.default.getClassFactory(i)},"./src/streaming/controllers/GapController.js":function(e,t,n){n.r(t);var r=n("./src/core/FactoryMaker.js"),m=n("./src/core/Debug.js"),g=n("./src/core/events/Events.js"),v=n("./src/core/EventBus.js");function i(){var e,t,y,n,r,_,b,E,T,A,i,w,a=this.context,o=Object(v.default)(a).getInstance();function s(){w.debug("Stopping the gap controller"),r&&(clearInterval(r),r=null),function(){o.off(g.default.WALLCLOCK_TIME_UPDATED,h,this),o.off(g.default.INITIAL_STREAM_SWITCH,d,this),o.off(g.default.PLAYBACK_SEEKING,l,this),o.off(g.default.BUFFER_REPLACEMENT_STARTED,u,e),o.off(g.default.TRACK_CHANGE_RENDERED,c,e)}(),_=NaN,n=0,A=r=null,i={}}function l(){A&&(clearTimeout(A),A=null)}function u(e){try{if(e.streamId!==E.getActiveStreamInfo().id||!e.mediaType)return;e.streamId===E.getActiveStreamInfo().id&&(i[e.mediaType]=!0)}catch(e){w.error(e)}}function c(e){e&&e.mediaType&&(i[e.mediaType]=!1)}function d(){r||function(){try{r||(w.debug("Starting the gap controller"),r=setInterval(function(){f()&&p(b.getTime())},100))}catch(e){}}()}function h(){if(f(y.get().streaming.gaps.enableSeekFix)&&10<=++n){var e=b.getTime();t===e?p(e,!0):(t=e,_=NaN),n=0}}function f(e){var t=0<arguments.length&&void 0!==e&&e,n=Object.keys(i).some(function(e){return i[e]}),r=!!t&&function(){var e=E.getActiveStream(),t=parseFloat((e.getStartTime()+e.getDuration()).toFixed(5));return b.getTime()+y.get().streaming.gaps.threshold>=t}();return!n&&y.get().streaming.gaps.jumpGaps&&0<E.getActiveStreamProcessors().length&&(!b.isSeeking()||r)&&!b.isPaused()&&!E.getIsStreamSwitchInProgress()&&!E.getHasMediaOrInitialisationError()}function p(e,t){var n,r=1<arguments.length&&void 0!==t&&t,i=y.get().streaming.gaps.smallGapLimit,a=y.get().streaming.gaps.jumpLargeGaps,o=T.getBufferRange(),s=NaN,l=!1;if(n=function(e,t){try{if(!e||e.length<=1&&0<t)return NaN;for(var n=NaN,r=0;isNaN(n)&&r<e.length;){var i=0<r?e.end(r-1):0;t<e.start(r)&&i-t<y.get().streaming.gaps.threshold&&(n=r),r+=1}return n}catch(e){return null}}(o,e),!isNaN(n)){var u=o.start(n),c=u-e;0<c&&(c<=i||a)&&(s=u)}var d=b.getTimeToStreamEnd();if(isNaN(s)&&r&&isFinite(d)&&!isNaN(d)&&d<i&&(s=parseFloat(b.getStreamEndTime().toFixed(5)),l=!0),0<s&&_!==s&&e<s&&!A){var h=s-e;if(l){var f=E.getStreamForTime(s),p=f&&!!f.getPreloaded();w.warn("Jumping to end of stream because of gap from ".concat(e," to ").concat(s,". Gap duration: ").concat(h)),b.seek(s,!0,p)}else{var m=b.getIsDynamic(),g=0<n?o.end(n-1):e,v=m?1e3*Math.max(0,h-.1):0;A=window.setTimeout(function(){b.seek(s,!0,!0),w.warn("Jumping gap occuring in period ".concat(E.getActiveStream().getStreamId()," starting at ").concat(g," and ending at ").concat(s,". Jumping by: ").concat(h-v/1e3)),A=null},v)}_=s}}return e={reset:s,setConfig:function(e){e&&(e.settings&&(y=e.settings),e.playbackController&&(b=e.playbackController),e.streamController&&(E=e.streamController),e.videoModel&&(T=e.videoModel))},initialize:function(){!function(){o.on(g.default.WALLCLOCK_TIME_UPDATED,h,this),o.on(g.default.INITIAL_STREAM_SWITCH,d,this),o.on(g.default.PLAYBACK_SEEKING,l,this),o.on(g.default.BUFFER_REPLACEMENT_STARTED,u,e),o.on(g.default.TRACK_CHANGE_RENDERED,c,e)}()}},w=Object(m.default)(a).getInstance().getLogger(e),s(),e}i.__dashjs_factory_name="GapController",t.default=r.default.getSingletonFactory(i)},"./src/streaming/controllers/MediaController.js":function(e,t,n){n.r(t);var A=n("./src/streaming/constants/Constants.js"),w=n("./src/core/events/Events.js"),S=n("./src/core/EventBus.js"),r=n("./src/core/FactoryMaker.js"),C=n("./src/core/Debug.js");function i(){var e,i,o,s,n,l,u,a,t=this.context,c=Object(S.default)(t).getInstance();function d(e,t){return e&&o[t]&&o[t][e]?o[t][e].list:[]}function h(e,t){return e&&o[t]&&o[t][e]?o[t][e].current:null}function f(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(e&&e.streamInfo){var n=e.type,r=e.streamInfo.id,i=h(n,r);if(o[r]&&o[r][n]&&!g(e,i)&&(o[r][n].current=e,o[r][n].current&&(n!==A.default.TEXT||n===A.default.TEXT&&e.isFragmented)&&c.trigger(w.default.CURRENT_TRACK_CHANGED,{oldMediaInfo:i,newMediaInfo:e,switchMode:s.get().streaming.trackSwitchMode[n]},{streamId:r}),!t)){var a=function(e){var t={lang:e.lang,viewpoint:e.viewpoint,roles:e.roles,accessibility:e.accessibility,audioChannelConfiguration:e.audioChannelConfiguration};return t.lang||t.viewpoint||t.role&&0<t.role.length||t.accessibility&&0<t.accessibility.length||t.audioChannelConfiguration&&0<t.audioChannelConfiguration.length?t:null}(e);if(!a||!o[r][n].storeLastSettings)return;a.roles&&(a.role=a.roles[0],delete a.roles),a.accessibility&&(a.accessibility=a.accessibility[0]),a.audioChannelConfiguration&&(a.audioChannelConfiguration=a.audioChannelConfiguration[0]),l[n]=a,u.setSavedMediaSettings(n,a)}}}function p(e,t){e&&t&&(n[e]=t)}function m(e){return e?n[e]:null}function g(e,t){if(!e&&!t)return!0;if(!e||!t)return!1;var n=e.id===t.id,r=e.viewpoint===t.viewpoint,i=e.lang===t.lang,a=e.codec===t.codec,o=e.roles.toString()===t.roles.toString(),s=e.accessibility.toString()===t.accessibility.toString(),l=e.audioChannelConfiguration.toString()===t.audioChannelConfiguration.toString();return n&&a&&r&&i&&o&&s&&l}function r(){o={},l={},n={audio:a=null,video:null,text:null}}function v(t,e){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2],r=!t.lang||e.lang.match(t.lang),i=void 0===t.index||null===t.index||e.index===t.index,a=!t.viewpoint||t.viewpoint===e.viewpoint,o=!t.role||!!e.roles.filter(function(e){return e===t.role})[0],s=!t.accessibility||!!e.accessibility.filter(function(e){return e===t.accessibility})[0],l=!t.audioChannelConfiguration||!!e.audioChannelConfiguration.filter(function(e){return e===t.audioChannelConfiguration})[0];return r&&i&&a&&(o||e.type===A.default.AUDIO&&n)&&s&&l}function y(e){var t,n=0,r=[];return e.forEach(function(e){t=Math.max.apply(Math,e.bitrateList.map(function(e){return e.bandwidth})),n<t?(n=t,r=[e]):t===n&&r.push(e)}),r}function _(e){var n,r=1/0,i=[];return e.forEach(function(e){var t=e.bitrateList.reduce(function(e,t){var n=Math.max(1,t.width*t.height);return e+t.bandwidth/n},0);(n=t/e.bitrateList.length)<r?(r=n,i=[e]):n===r&&i.push(e)}),i}function b(e){var t,n=0,r=[];return e.forEach(function(e){t=e.representationCount,n<t?(n=t,r=[e]):t===n&&r.push(e)}),r}function E(e,t){if(e===A.default.TEXT)return t[0];var n,r=s.get().streaming.selectionModeForInitialTrack;if(a&&"function"==typeof a)n=a(t);else switch(r){case A.default.TRACK_SELECTION_MODE_HIGHEST_SELECTION_PRIORITY:n=function(e){var t=function(e){var t=0,n=[];return e.forEach(function(e){isNaN(e.selectionPriority)||(e.selectionPriority>t?(t=e.selectionPriority,n=[e]):e.selectionPriority===t&&n.push(e))}),n}(e);1<t.length&&(t=y(t));1<t.length&&(t=b(t));return t}(t);break;case A.default.TRACK_SELECTION_MODE_HIGHEST_BITRATE:n=function(e){var t=y(e);1<t.length&&(t=b(t));return t}(t);break;case A.default.TRACK_SELECTION_MODE_FIRST_TRACK:n=T(t);break;case A.default.TRACK_SELECTION_MODE_HIGHEST_EFFICIENCY:n=function(e){var t=_(e);1<t.length&&(t=y(t));return t}(t);break;case A.default.TRACK_SELECTION_MODE_WIDEST_RANGE:n=function(e){var t=b(e);1<t.length&&(t=y(e));return t}(t);break;default:i.warn("Track selection mode ".concat(r," is not supported. Falling back to TRACK_SELECTION_MODE_FIRST_TRACK")),n=T(t)}return 0<n.length?n[0]:t[0]}function T(e){return e[0]}return e={setInitialMediaSettingsForType:function(t,e){var n=l[t]||m(t),r=d(t,e.id),i=[];n||(n=u.getSavedMediaSettings(t),p(t,n)),r&&0!==r.length&&(n&&r.forEach(function(e){v(n,e,!!l[t])&&i.push(e)}),0===i.length?f(E(t,r),!0):1<i.length?f(E(t,i,l[t])):f(i[0]))},addTrack:function(e){if(e){var t=e.type;if(function(e){return e===A.default.AUDIO||e===A.default.VIDEO||e===A.default.TEXT||e===A.default.IMAGE}(t)){var n=e.streamInfo.id;o[n]||(o[n]={audio:{list:[],storeLastSettings:!0,current:null},video:{list:[],storeLastSettings:!0,current:null},text:{list:[],storeLastSettings:!0,current:null},image:{list:[],storeLastSettings:!0,current:null}});for(var r=o[n][t].list,i=0,a=r.length;i<a;++i)if(g(r[i],e))return;r.push(e)}}},getTracksFor:d,getCurrentTrackFor:h,isCurrentTrack:function(e){if(!e)return!1;var t=e.type,n=e.streamInfo.id;return o[n]&&o[n][t]&&g(o[n][t].current,e)},setTrack:f,selectInitialTrack:E,setCustomInitialTrackSelectionFunction:function(e){a=e},setInitialSettings:p,getInitialSettings:m,getTracksWithHighestBitrate:y,getTracksWithHighestEfficiency:_,getTracksWithWidestRange:b,isTracksEqual:g,matchSettings:v,saveTextSettingsDisabled:function(){u.setSavedMediaSettings(A.default.TEXT,null)},setConfig:function(e){e&&(e.domStorage&&(u=e.domStorage),e.settings&&(s=e.settings))},reset:r},i=Object(C.default)(t).getInstance().getLogger(e),r(),e}i.__dashjs_factory_name="MediaController";var a=r.default.getSingletonFactory(i);r.default.updateSingletonFactory(i.__dashjs_factory_name,a),t.default=a},"./src/streaming/controllers/MediaSourceController.js":function(e,t,n){n.r(t);var r=n("./src/core/FactoryMaker.js"),i=n("./src/core/Debug.js");function a(){var e,n,r,t=this.context;return e={createMediaSource:function(){var e="WebKitMediaSource"in window;return"MediaSource"in window?n=new MediaSource:e&&(n=new WebKitMediaSource),n},attachMediaSource:function(e){var t=window.URL.createObjectURL(n);return e.setSource(t),t},detachMediaSource:function(e){e.setSource(null)},setDuration:function e(t){n&&"open"===n.readyState&&(null===t&&isNaN(t)||n.duration!==t&&(function(e){for(var t=e.sourceBuffers,n=0;n<t.length;n++)if(t[n].updating)return 1;return 0}(n)?setTimeout(e.bind(null,t),50):(r.info("Set MediaSource duration:"+t),n.duration=t)))},setSeekable:function(e,t){n&&"function"==typeof n.setLiveSeekableRange&&"function"==typeof n.clearLiveSeekableRange&&"open"===n.readyState&&0<=e&&e<t&&(n.clearLiveSeekableRange(),n.setLiveSeekableRange(e,t))},signalEndOfStream:function(e){if(e&&"open"===e.readyState){for(var t=e.sourceBuffers,n=0;n<t.length;n++){if(t[n].updating)return;if(0===t[n].buffered.length)return}r.info("call to mediaSource endOfStream"),e.endOfStream()}}},r=Object(i.default)(t).getInstance().getLogger(e),e}a.__dashjs_factory_name="MediaSourceController",t.default=r.default.getSingletonFactory(a)},"./src/streaming/controllers/PlaybackController.js":function(e,t,n){n.r(t);var ge=n("./src/streaming/constants/Constants.js"),ve=n("./src/streaming/constants/MetricsConstants.js"),ye=n("./src/core/EventBus.js"),_e=n("./src/core/events/Events.js"),r=n("./src/core/FactoryMaker.js"),be=n("./src/core/Debug.js"),Ee=n("./src/streaming/MediaPlayerEvents.js");function i(){var n,f,u,c,l,d,r,i,h,p,a,m,o,t,g,s,v,y,_,b,E,T,e=this.context,A=Object(ye.default)(e).getInstance();function w(){return parseFloat((S(0<arguments.length&&void 0!==arguments[0]?arguments[0]:null)-P()).toFixed(5))}function S(e){var t=e||p;return t.start+t.duration}function C(){p&&d&&d.getElement()?d.play():o=!0}function x(){return p&&d?d.isPaused():null}function M(){p&&d&&d.pause()}function R(){return p&&d?d.isSeeking():null}function I(e,t,n){p&&d&&e!==(isNaN(s)?d.getTime():s)&&((v=!0===n)||(s=e,A.trigger(_e.default.PLAYBACK_SEEK_ASKED)),f.info("Requesting seek to time: "+e+(v?" (internal)":"")),d.setCurrentTime(e,t))}function P(){return p&&d?d.getTime():null}function D(){var e=P();if(a&&!isNaN(g)){var t=g/1e3;t<e&&(e-=t)}return e}function L(){return p&&d?d.getPlaybackRate():null}function O(){return p&&d?d.getEnded():null}function N(){return a}function k(){if(!a||isNaN(g))return NaN;var e=D();if(isNaN(e)||0===e)return 0;var t=(new Date).getTime()+1e3*r.getClientTimeOffset();return Math.max(((t-g-1e3*e)/1e3).toFixed(3),0)}function B(){M(),g=h=0,E=o=!1,s=NaN,d&&(A.off(_e.default.DATA_UPDATE_COMPLETED,H,n),A.off(_e.default.LOADING_PROGRESS,ue,n),A.off(_e.default.MANIFEST_UPDATED,pe,n),A.off(_e.default.STREAMS_COMPOSED,me,n),A.off(Ee.default.BUFFER_LEVEL_STATE_CHANGED,ce,n),A.off(Ee.default.PLAYBACK_PROGRESS,ie,n),A.off(Ee.default.PLAYBACK_TIME_UPDATED,ie,n),A.off(Ee.default.PLAYBACK_ENDED,ne,n),A.off(Ee.default.STREAM_INITIALIZING,he,n),A.off(Ee.default.REPRESENTATION_SWITCH,fe,n),d.setPlaybackRate(1,!0),j(),d.removeEventListener("canplay",G),d.removeEventListener("canplaythrough",V),d.removeEventListener("play",z),d.removeEventListener("waiting",W),d.removeEventListener("playing",q),d.removeEventListener("pause",Y),d.removeEventListener("error",re),d.removeEventListener("seeking",K),d.removeEventListener("seeked",X),d.removeEventListener("timeupdate",Q),d.removeEventListener("progress",Z),d.removeEventListener("ratechange",J),d.removeEventListener("loadedmetadata",$),d.removeEventListener("loadeddata",ee),d.removeEventListener("stalled",de),d.removeEventListener("ended",te)),a=p=d=i=null}function F(){if(null===i){i=setInterval(function(){A.trigger(_e.default.WALLCLOCK_TIME_UPDATED,{isDynamic:a,time:new Date}),N()&&(u.addDVRMetric(),x()?function(){var e=Date.now();(!t||t+500<e)&&(t=e,Q())}():U())},T.get().streaming.wallclockTimeUpdateInterval)}}function j(){clearInterval(i),i=null}function U(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;if(!x()&&a&&0!==d.getReadyState()&&!R()&&!E){e=e||(u.hasVideoTrack()?ge.default.VIDEO:ge.default.AUDIO);var t=D(),n=function(e,t){var n=c.getCurrentDVRInfo(t),r=n?n.range:null;return r?e>r.end?Math.max(r.end-h,r.start):0<e&&e+.25<r.start&&Math.abs(e-r.start)<31536e4?T.get().streaming.lowLatencyEnabled?Math.max(r.end-h,r.start):r.start:e:NaN}(t,e);!isNaN(n)&&n!==t&&!R()&&(p&&d&&d.isStalled()||_||1===d.getReadyState())&&(f.debug("UpdateCurrentTime: Seek to actual time: ".concat(n," from currentTime: ").concat(t)),I(n))}}function H(e){var t=l.convertRepresentationToRepresentationInfo(e.currentRepresentation),n=t?t.mediaInfo.streamInfo:null;null!==n&&p.id===n.id&&(p=n)}function G(){A.trigger(_e.default.CAN_PLAY)}function V(){A.trigger(_e.default.CAN_PLAY_THROUGH)}function z(){f.info("Native video element event: play"),U(),F(),A.trigger(_e.default.PLAYBACK_STARTED,{startTime:P()})}function W(){f.info("Native video element event: waiting"),A.trigger(_e.default.PLAYBACK_WAITING,{playingTime:P()})}function q(){f.info("Native video element event: playing"),A.trigger(_e.default.PLAYBACK_PLAYING,{playingTime:P()})}function Y(){f.info("Native video element event: pause"),A.trigger(_e.default.PLAYBACK_PAUSED,{ended:O()})}function K(){if(v)v=!1;else{var e=P();isNaN(s)||s===e||(e=s),s=NaN,f.info("Seeking to: "+e),F(),A.trigger(_e.default.PLAYBACK_SEEKING,{seekTime:e,streamId:p.id})}}function X(){f.info("Native video element event: seeked"),A.trigger(_e.default.PLAYBACK_SEEKED)}function Q(){p&&A.trigger(_e.default.PLAYBACK_TIME_UPDATED,{timeToEnd:w(),time:P(),streamId:p.id})}function Z(){A.trigger(_e.default.PLAYBACK_PROGRESS,{streamId:p.id})}function J(){var e=L();f.info("Native video element event: ratechange: ",e),A.trigger(_e.default.PLAYBACK_RATE_CHANGED,{playbackRate:e})}function $(){f.info("Native video element event: loadedmetadata"),A.trigger(_e.default.PLAYBACK_METADATA_LOADED),F()}function ee(){f.info("Native video element event: loadeddata"),A.trigger(_e.default.PLAYBACK_LOADED_DATA)}function te(){f.info("Native video element event: ended"),M(),j();var e=u?u.getActiveStreamInfo():null;e&&A.trigger(_e.default.PLAYBACK_ENDED,{isLast:e.isLast})}function ne(e){if(i&&e.isLast){f.info("onPlaybackEnded -- PLAYBACK_ENDED but native video element didn't fire ended");var t=e.seekTime?e.seekTime:S();d.setCurrentTime(t),M(),j()}}function re(e){var t=e.target||e.srcElement;A.trigger(_e.default.PLAYBACK_ERROR,{error:t.error})}function ie(){a&&ae()&&0<T.get().streaming.liveCatchup.playbackRate&&!x()&&!R()&&(function(){try{if(ae()&&0<T.get().streaming.liveCatchup.playbackRate&&0<P()){var e=se(),t=k(),n=m.getLiveDelay(),r=m.getLiveCatchupLatencyThreshold(),i=T.get().streaming.liveCatchup.minDrift;if(e!==ge.default.LIVE_CATCHUP_MODE_LOLP)return function(e,t,n,r){try{var i=Math.abs(e-t);return r<i&&(isNaN(n)||e<=n)}catch(e){return!1}}(t,n,r,i);var a=oe(),o=T.get().streaming.liveCatchup.playbackBufferMin;return function(e,t,n,r,i,a){try{var o=Math.abs(e-t);return(isNaN(a)||e<=a)&&(n<o||r<i)}catch(e){return!1}}(t,n,i,a,o,r)}}catch(e){return!1}}()?function(){if(d){var e,t=d.getPlaybackRate(),n=T.get().streaming.liveCatchup.playbackRate,r=k(),i=m.getLiveDelay(),a=oe();if(se()===ge.default.LIVE_CATCHUP_MODE_LOLP){T.get().streaming.liveCatchup.minDrift;var o=T.get().streaming.liveCatchup.playbackBufferMin;e=function(e,t,n,r,i,a,o){var s,l=e;if(a<i){var u=5*(a-i),c=2*l/(1+Math.pow(Math.E,-u));s=1-l+c,f.debug("[LoL+ playback control_buffer-based] bufferLevel: "+a+", newRate: "+s)}else{if(Math.abs(t-n)<=.02*n)s=1;else{var d=5*(t-n),h=2*l/(1+Math.pow(Math.E,-d));s=1-l+h}f.debug("[LoL+ playback control_latency-based] latency: "+t+", newRate: "+s)}_&&n/2<a&&(_=!1);Math.abs(o-s)<=b&&(s=null);return{newRate:s}}(n,r,i,0,o,a,t)}else e=function(e,t,n,r,i){var a=e,o=t-n,s=5*o,l=2*a/(1+Math.pow(Math.E,-s)),u=1-a+l;_&&(n/2<r?_=!1:0<o&&(u=1));Math.abs(i-u)<=b&&(u=null);return{newRate:u}}(n,r,i,a,t);var s=e.newRate;s&&d.setPlaybackRate(s);var l=r-i;0<T.get().streaming.liveCatchup.maxDrift&&!y&&l>T.get().streaming.liveCatchup.maxDrift?(f.info("Low Latency catchup mechanism. Latency too high, doing a seek to live point"),y=!0,function(){var e=u&&u.hasVideoTrack()?ge.default.VIDEO:ge.default.AUDIO,t=c.getCurrentDVRInfo(e),n=t?t.range:null;n&&!isNaN(n.end)&&I(n.end-m.getLiveDelay(),!0,!1)}()):y=!1}}():le())}function ae(){return T.get().streaming.liveCatchup.enabled||T.get().streaming.lowLatencyEnabled}function oe(){var n=null;return u.getActiveStreamProcessors().forEach(function(e){var t=e.getBufferLevel();n=null===n?t:Math.min(n,t)}),n}function se(){var e=T.get().streaming.liveCatchup.playbackBufferMin;return T.get().streaming.liveCatchup.mode!==ge.default.LIVE_CATCHUP_MODE_LOLP||null===e||isNaN(e)?ge.default.LIVE_CATCHUP_MODE_DEFAULT:ge.default.LIVE_CATCHUP_MODE_LOLP}function le(){d&&d.setPlaybackRate(1)}function ue(e){if(!1===e.stream&&T.get().streaming.lowLatencyEnabled&&!isNaN(e.request.duration)){var t=1.2*e.request.duration;t>m.getLiveDelay()&&(f.warn("Browser does not support fetch API with StreamReader. Increasing live delay to be 20% higher than segment duration:",t.toFixed(2)),T.update({streaming:{delay:{liveDelay:t}}}))}}function ce(e){e.streamId===p.id&&(ae()?e.state!==ve.default.BUFFER_EMPTY||R()||_||(_=!0,le()):T.get().streaming.buffer.setStallState&&d.setStallState(e.mediaType,e.state===ve.default.BUFFER_EMPTY))}function de(e){A.trigger(_e.default.PLAYBACK_STALLED,{e:e})}function he(e){!function(e){e&&e.supplementalProperties&&"true"===e.supplementalProperties[ge.default.SUPPLEMENTAL_PROPERTY_LL_SCHEME]&&(f.debug("Low Latency critical SupplementalProperty set: Enabling low Latency"),T.update({streaming:{lowLatencyEnabled:!0}}))}(e.mediaInfo)}function fe(e){var t=u.getActiveStreamInfo();if(T.get().streaming.lowLatencyEnabledByManifest&&e&&t&&e.currentRepresentation&&e.streamId&&e.streamId===t.id&&e.mediaType&&(e.mediaType===ge.default.VIDEO||e.mediaType===ge.default.AUDIO)){var n=!e.currentRepresentation.availabilityTimeComplete;n&&T.update({streaming:{lowLatencyEnabled:n}})}}function pe(){E=!0}function me(){E=!1}return n={initialize:function(e,t){p=e,!0!==t&&function(){d.addEventListener("canplay",G),d.addEventListener("canplaythrough",V),d.addEventListener("play",z),d.addEventListener("waiting",W),d.addEventListener("playing",q),d.addEventListener("pause",Y),d.addEventListener("error",re),d.addEventListener("seeking",K),d.addEventListener("seeked",X),d.addEventListener("timeupdate",Q),d.addEventListener("progress",Z),d.addEventListener("ratechange",J),d.addEventListener("loadedmetadata",$),d.addEventListener("loadeddata",ee),d.addEventListener("stalled",de),d.addEventListener("ended",te),a=p.manifestInfo.isDynamic,v=_=y=!1;var e="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"",t=/safari/.test(e)&&!/chrome/.test(e);b=t?.25:.02,A.on(_e.default.DATA_UPDATE_COMPLETED,H,n),A.on(_e.default.LOADING_PROGRESS,ue,n),A.on(_e.default.MANIFEST_UPDATED,pe,n),A.on(_e.default.STREAMS_COMPOSED,me,n),A.on(Ee.default.BUFFER_LEVEL_STATE_CHANGED,ce,n),A.on(Ee.default.PLAYBACK_PROGRESS,ie,n),A.on(Ee.default.PLAYBACK_TIME_UPDATED,ie,n),A.on(Ee.default.PLAYBACK_ENDED,ne,n,{priority:ye.default.EVENT_PRIORITY_HIGH}),A.on(Ee.default.STREAM_INITIALIZING,he,n),A.on(Ee.default.REPRESENTATION_SWITCH,fe,n),o&&(o=!1,C())}()},setConfig:function(e){e&&(e.streamController&&(u=e.streamController),e.dashMetrics&&(c=e.dashMetrics),e.mediaPlayerModel&&(m=e.mediaPlayerModel),e.adapter&&(l=e.adapter),e.videoModel&&(d=e.videoModel),e.timelineConverter&&(r=e.timelineConverter),e.settings&&(T=e.settings))},getTimeToStreamEnd:w,getBufferLevel:oe,getTime:P,getNormalizedTime:D,getIsManifestUpdateInProgress:function(){return E},getPlaybackRate:L,getPlayedRanges:function(){return p&&d?d.getPlayedRanges():null},getEnded:O,getIsDynamic:N,getStreamController:function(){return u},computeAndSetLiveDelay:function(e,t){var n,r,i,a=!isNaN(e)&&isFinite(e)?e:NaN,o=l.getSuggestedPresentationDelay();if(T.get().streaming.delay.applyServiceDescription&&isNaN(T.get().streaming.delay.liveDelay)&&isNaN(T.get().streaming.delay.liveDelayFragmentCount)&&function(e){if(!e||!e.serviceDescriptions)return;for(var t=null,n=0;n<e.serviceDescriptions.length;n++){var r=e.serviceDescriptions[n];if(r.schemeIdUri===ge.default.SERVICE_DESCRIPTION_LL_SCHEME){t=r;break}}t&&(t.latency&&0<t.latency.target&&(f.debug("Apply LL properties coming from service description. Target Latency (ms):",t.latency.target),T.update({streaming:{delay:{liveDelay:t.latency.target/1e3},liveCatchup:{minDrift:(t.latency.target+500)/1e3,maxDrift:t.latency.max>t.latency.target?(t.latency.max-t.latency.target+500)/1e3:void 0}}})),t.playbackRate&&1<t.playbackRate.max&&(f.debug("Apply LL properties coming from service description. Max PlaybackRate:",t.playbackRate.max),T.update({streaming:{liveCatchup:{playbackRate:t.playbackRate.max-1}}})))}(t),n=m.getLiveDelay()?m.getLiveDelay():null===T.get().streaming.delay.liveDelayFragmentCount||isNaN(T.get().streaming.delay.liveDelayFragmentCount)||isNaN(a)?!0===T.get().streaming.delay.useSuggestedPresentationDelay&&null!==o&&!isNaN(o)&&0<o?o:isNaN(a)?t&&!isNaN(t.minBufferTime)?4*t.minBufferTime:4*p.manifestInfo.minBufferTime:4*a:a*T.get().streaming.delay.liveDelayFragmentCount,null!==(i=l.getAvailabilityStartTime())&&(g=i),t&&0<t.dvrWindowSize){var s=Math.max(t.dvrWindowSize-10,t.dvrWindowSize/2);r=Math.min(n,s)}else r=n;return h=r},getLiveDelay:function(){return h},getCurrentLiveLatency:k,play:C,isPaused:x,pause:M,isSeeking:R,getStreamEndTime:S,seek:I,reset:B,updateCurrentTime:U,getAvailabilityStartTime:function(){return g}},f=Object(be.default)(e).getInstance().getLogger(n),B(),n}i.__dashjs_factory_name="PlaybackController",t.default=r.default.getSingletonFactory(i)},"./src/streaming/controllers/ScheduleController.js":function(e,t,n){n.r(t);var k=n("./src/streaming/constants/Constants.js"),B=n("./src/streaming/models/FragmentModel.js"),F=n("./src/core/EventBus.js"),j=n("./src/core/events/Events.js"),r=n("./src/core/FactoryMaker.js"),U=n("./src/core/Debug.js"),H=n("./src/streaming/constants/MetricsConstants.js"),G=n("./src/streaming/MediaPlayerEvents.js");function i(e){e=e||{};var t,n,r,i,a,o,s,l,u,c,d,h,f,p=this.context,m=Object(F.default)(p).getInstance(),g=e.dashMetrics,v=e.mediaPlayerModel,y=e.fragmentModel,_=e.abrController,b=e.playbackController,E=e.textController,T=e.type,A=e.bufferController,w=e.settings;function S(e){if(!A.getIsBufferingCompleted()){C();var t=isNaN(e)?0:e;o=setTimeout(x,t)}}function C(){o&&(clearTimeout(o),o=null)}function x(){try{if(function(){try{return T===k.default.TEXT&&!E.isTextEnabled()||b.isPaused()&&(!b.getStreamController().getInitialPlayback()||!b.getStreamController().getAutoPlay())&&!w.get().streaming.scheduling.scheduleWhilePaused}catch(e){return!1}}())return void C();if(function(){try{return i&&(isNaN(c)||d||function(){var e=n.id,t=_.getMaxAllowedIndexFor(T,e);return!(!isNaN(u)&&u==t)&&(r.info("Top quality "+T+" index has changed from "+u+" to "+t),u=t,!0)}()||!T||!i||g.getCurrentBufferLevel(T)<M())}catch(e){return!1}}()){var e=!1;f&&(e=_.checkPlaybackQuality(T,n.id)),e||(h||i.quality!==c||d?(d?(r.debug("Switch track for "+T+", representation id = "+i.id),d=!1):r.debug("Quality has changed, get init request for representationid = "+i.id),m.trigger(j.default.INIT_FRAGMENT_NEEDED,{representationId:i.id,sender:t},{streamId:n.id,mediaType:T}),h=f=!1):(r.debug("Media segment needed for ".concat(T," and stream id ").concat(n.id)),m.trigger(j.default.MEDIA_FRAGMENT_NEEDED,{},{streamId:n.id,mediaType:T}),f=!0))}else S(w.get().streaming.lowLatencyEnabled?w.get().streaming.scheduling.lowLatencyTimeout:w.get().streaming.scheduling.defaultTimeout)}catch(e){S(w.get().streaming.lowLatencyEnabled?w.get().streaming.scheduling.lowLatencyTimeout:w.get().streaming.scheduling.defaultTimeout)}}function M(){var e=NaN;return T&&i?e=T===k.default.TEXT?function(){try{if(E.isTextEnabled()){if(isNaN(i.fragmentDuration)){var e=g.getCurrentSchedulingInfo(H.default.SCHEDULING_INFO);return e?e.duration:0}return i.fragmentDuration}return 0}catch(e){return 0}}():T===k.default.AUDIO&&s?function(){try{var e=g.getCurrentBufferLevel(k.default.VIDEO);return isNaN(i.fragmentDuration)?e+1:Math.max(e+1,i.fragmentDuration)}catch(e){return 0}}():function(){try{var e=i.mediaInfo.streamInfo;return _.isPlayingAtTopQuality(e)?e.manifestInfo.duration>=w.get().streaming.buffer.longFormContentDurationThreshold?w.get().streaming.buffer.bufferTimeAtTopQualityLongForm:w.get().streaming.buffer.bufferTimeAtTopQuality:v.getStableBufferTime()}catch(e){return v.getStableBufferTime()}}():e}function R(){I(!0)}function I(e){if(b&&y){var t=y.getRequests({state:B.default.FRAGMENT_MODEL_EXECUTED,time:b.getTime(),threshold:0})[0];t&&b.getTime()>=t.startTime&&((!l.mediaInfo||t.mediaInfo.type===l.mediaInfo.type&&t.mediaInfo.id!==l.mediaInfo.id)&&e&&m.trigger(j.default.TRACK_CHANGE_RENDERED,{mediaType:T,oldMediaInfo:l.mediaInfo,newMediaInfo:t.mediaInfo,streamId:n.id}),t.quality===l.quality&&t.adaptationIndex===l.adaptationIndex||!e||(r.debug("Quality change rendered for streamId ".concat(n.id," and type ").concat(T)),m.trigger(j.default.QUALITY_CHANGE_RENDERED,{mediaType:T,oldQuality:l.quality,newQuality:t.quality,streamId:n.id})),l={mediaInfo:t.mediaInfo,quality:t.quality,adaptationIndex:t.adaptationIndex})}}function P(e){r.debug("Appended bytes for ".concat(e.mediaType," and stream id ").concat(n.id)),(isNaN(e.index)||isNaN(c))&&(c=e.quality,r.info("["+T+"] lastInitializedRepresentationInfo changed to "+e.quality)),S(0)}function D(){y.abortRequests(),C()}function L(){w.get().streaming.scheduling.scheduleWhilePaused||S()}function O(e){g.updatePlayListTraceMetrics({playbackspeed:e.playbackRate.toString()})}function N(){f=!0,u=c=NaN,h=d=!(l={mediaInfo:void(a=0),quality:NaN,adaptationIndex:NaN})}return t={initialize:function(e){s=e,m.on(j.default.BYTES_APPENDED_END_FRAGMENT,P,t),m.on(j.default.URL_RESOLUTION_FAILED,D,t),m.on(G.default.PLAYBACK_STARTED,L,t),m.on(G.default.PLAYBACK_RATE_CHANGED,O,t),m.on(G.default.PLAYBACK_TIME_UPDATED,R,t)},getType:function(){return T},getStreamId:function(){return n.id},setCurrentRepresentation:function(e){i=e},setTimeToLoadDelay:function(e){a=e},getTimeToLoadDelay:function(){return a},setSwitchTrack:function(e){d=e},getSwitchStrack:function(){return d},startScheduleTimer:S,clearScheduleTimer:C,reset:function(){m.off(j.default.BYTES_APPENDED_END_FRAGMENT,P,t),m.off(j.default.URL_RESOLUTION_FAILED,D,t),m.off(G.default.PLAYBACK_STARTED,L,t),m.off(G.default.PLAYBACK_RATE_CHANGED,O,t),m.off(G.default.PLAYBACK_TIME_UPDATED,R,t),C(),I(!1),N(),n=null},getBufferTarget:M,getPlaybackController:function(){return b},setCheckPlaybackQuality:function(e){f=e},setInitSegmentRequired:function(e){h=e}},r=Object(U.default)(p).getInstance().getLogger(t),N(),n=e.streamInfo,t}i.__dashjs_factory_name="ScheduleController",t.default=r.default.getClassFactory(i)},"./src/streaming/controllers/StreamController.js":function(e,t,n){n.r(t);var Ne=n("./src/streaming/constants/Constants.js"),ke=n("./src/streaming/constants/MetricsConstants.js"),Be=n("./src/streaming/Stream.js"),Fe=n("./src/streaming/ManifestUpdater.js"),je=n("./src/core/EventBus.js"),Ue=n("./src/core/events/Events.js"),r=n("./src/core/FactoryMaker.js"),He=n("./src/streaming/vo/metrics/PlayList.js"),Ge=n("./src/core/Debug.js"),Ve=n("./src/streaming/utils/InitCache.js"),ze=n("./src/streaming/utils/URLUtils.js"),We=n("./src/streaming/MediaPlayerEvents.js"),qe=n("./src/streaming/controllers/TimeSyncController.js"),Ye=n("./src/streaming/controllers/MediaSourceController.js"),Ke=n("./src/streaming/vo/DashJSError.js"),Xe=n("./src/core/errors/Errors.js"),Qe=n("./src/streaming/controllers/EventController.js"),Ze=n("./src/streaming/constants/ConformanceViolationConstants.js");function Je(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function a(){var n,u,r,a,i,o,s,c,d,l,h,f,p,m,g,v,y,_,b,E,T,A,w,S,C,x,M,R,I,P,D,L,O,N,t,k,e,B,F,j,U,H,G,V,z=this.context,W=Object(je.default)(z).getInstance();function q(){!function(){try{var e=c.getStreamsInfo();if(!w&&0===e.length)throw new Error("There are no streams");w&&d.updateManifestUpdateInfo({currentTime:O.getTime(),buffered:L.getBufferRange(),presentationStartTime:e[0].start,clientTimeOffset:T.getClientTimeOffset()}),0<A.length&&function(n){A=A.filter(function(t){var e=0<n.filter(function(e){return e.id===t.getId()}).length||t.getId()===w.getId();return e||(u.debug("Removing stream ".concat(t.getId())),t.reset(!0)),e})}(e);for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n];t.push(K(i)),d.addManifestUpdateStreamInfo(i)}Promise.all(t).then(function(){w||!function e(t){ae();var n=d.getCurrentDVRInfo().range;if(n.end<n.start){G&&clearTimeout(G);var r=Math.min(1e3*(-1*(n.end-n.start)+2),2147483647);return u.debug("Waiting for ".concat(r," ms before playback can start")),W.trigger(Ue.default.AST_IN_FUTURE,{delay:r}),void(G=setTimeout(function(){e(t)},r))}if(c.getIsDynamic()&&A.length){var i=t[0].manifestInfo,a=be(t,i);O.computeAndSetLiveDelay(a,i)}var o=ye();var s=ie(o);var l=null!==s?s:A[0];W.trigger(Ue.default.INITIAL_STREAM_SWITCH,{startTime:o});X(l,null,o);fe()}(e),W.trigger(Ue.default.STREAMS_COMPOSED),he()}).catch(function(e){throw e})}catch(e){E.error(new Ke.default(Xe.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,e.message+"nostreamscomposed",s.getValue())),P=!0,De()}}()}function Y(){H=!0}function K(e){var t=Me(e.id);return t?t.updateData(e):(t=Object(Be.default)(z).create({manifestModel:s,mediaPlayerModel:N,dashMetrics:d,manifestUpdater:i,adapter:c,timelineConverter:T,capabilities:r,capabilitiesFilter:a,errHandler:E,baseURLController:f,segmentBaseController:p,textController:C,abrController:g,playbackController:O,eventController:y,mediaController:v,protectionController:S,videoModel:L,streamInfo:e,settings:U}),A.push(t),t.initialize(),Promise.resolve())}function X(e,t,n){try{if(R||!e||t===e&&e.getIsActive())return;R=!0,W.trigger(Ue.default.PERIOD_SWITCH_STARTED,{fromStreamInfo:t?t.getStreamInfo():null,toStreamInfo:e.getStreamInfo()});var r=!1;w=e,t&&(r=ne(e,t),t.deactivate(r)),n=isNaN(n)?!r&&t?e.getStreamInfo().start:NaN:n,u.info("Switch to stream ".concat(e.getId(),". Seektime is ").concat(n,", current playback time is ").concat(O.getTime(),". Seamless period switch is set to ").concat(r)),F=F.filter(function(e){return e.getId()!==w.getId()}),O.initialize(xe(),!!t),L.getElement()&&Q(n,r)}catch(e){R=!1}}function Q(t,n){var r;function i(){if(D&&"open"===D.readyState){u.debug("MediaSource is open!"),window.URL.revokeObjectURL(r),D.removeEventListener("sourceopen",i),D.removeEventListener("webkitsourceopen",i),ve();var e=d.getCurrentDVRInfo();l.setSeekable(e.range.start,e.range.end),Z(t,n)}}function e(){D.addEventListener("sourceopen",i,!1),D.addEventListener("webkitsourceopen",i,!1),r=l.attachMediaSource(L),u.debug("MediaSource attached to element.  Waiting on open...")}D?n?Z(t,n):(l.detachMediaSource(L),e()):(D=l.createMediaSource(),e())}function Z(n,e){w.activate(D,e?B:void 0,n).then(function(e){if(e){var t=Object.keys(e);0<t.length&&e[t[0]].getBuffer().changeType&&(j=!0),B=e}isNaN(n)||(W.trigger(Ue.default.SEEK_TARGET,{time:n},{streamId:w.getId()}),O.seek(n,!1,!0),w.startScheduleControllers()),R=!1,W.trigger(Ue.default.PERIOD_SWITCH_COMPLETED,{toStreamInfo:xe()})})}function J(e){var t=O.getTime(),n=e.seekTime,r=ie(n);r&&r!==w?r&&r!==w&&($(t,n,r),function(t,e){var n=t&&!isNaN(t.seekTime)?t.seekTime:NaN,r=w.getProcessors().map(function(e){return e.prepareOuterPeriodPlaybackSeeking(t)});Promise.all(r).then(function(){X(e,w,n)}).catch(function(e){E.error(e)})}(e,r)):($(t,n),function(t){w.getProcessors().forEach(function(e){return e.prepareInnerPeriodPlaybackSeeking(t)}),we(He.PlayListTrace.USER_REQUEST_STOP_REASON)}(e)),Se(He.PlayList.SEEK_START_REASON)}function $(e,t,n){ee()}function ee(){F&&0<F.length&&(F.forEach(function(e){e.deactivate(!0)}),F=[])}function te(e){e.newMediaInfo.streamInfo.id===w.getId()&&(ee(),w.prepareTrackChange(e))}function ne(e,t){try{return U.get().streaming.buffer.reuseExistingSourceBuffers&&(t.isProtectionCompatible(e)||H)&&(j||t.isMediaCodecCompatible(e,t))}catch(e){return!1}}function re(e,t){var n=1<arguments.length&&void 0!==t?t:null;D&&!e.getPreloaded()&&ne(e,n)&&e.startPreloading(D,B).then(function(){F.push(e)})}function ie(e){if(isNaN(e))return null;for(var t=A.length,n=0;n<t;n++){var r=A[n];if(e<parseFloat((r.getStartTime()+r.getDuration()).toFixed(5)))return r}return null}function ae(){try{var e=c.getIsDynamic(),t=c.getStreamsInfo()[0].manifestInfo,n=O.getTime(),r=T.calcTimeShiftBufferWindow(A,e),i=me();if(void 0===r.start||void 0===r.end)return;i&&0!==i.length?i.forEach(function(e){d.addDVRInfo(e.getType(),n,t,r)}):d.addDVRInfo(Ne.default.VIDEO,n,t,r)}catch(e){}}function oe(e){if(k&&M){var t=N.getInitialBufferLevel();(isNaN(t)||t<=O.getBufferLevel()||c.getIsDynamic()&&t>O.getLiveDelay())&&(k=!1,Se(He.PlayList.INITIAL_PLAYOUT_START_REASON),O.play())}e&&e.mediaType&&d.addBufferLevel(e.mediaType,new Date,1e3*e.bufferLevel)}function se(e){e.streamInfo.id===w.getId()&&e.reason&&e.reason.forceReplace&&ee(),Me(e.streamInfo.id).prepareQualityChange(e)}function le(){if(Te()){var e=L.getPlaybackQuality();e&&d.addDroppedFrames(e)}}function ue(){u.debug("[onPlaybackStarted]"),!k&&t&&Se(He.PlayList.RESUME_FROM_PAUSE_START_REASON),k=k&&!1,t=!1}function ce(e){u.debug("[onPlaybackPaused]"),e.ended||(t=!0,we(He.PlayListTrace.USER_REQUEST_STOP_REASON))}function de(e){u.debug("Stream with id ".concat(e.streamInfo.id," finished buffering"));var t=e.streamInfo.isLast;D&&t?(u.info("[onStreamBufferingCompleted] calls signalEndOfStream of mediaSourceController."),l.signalEndOfStream(D)):he()}function he(){if(w&&w.getHasFinishedBuffering())for(var e=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;try{var t=e||(w||null);if(t){var n=t.getStreamInfo();return A.filter(function(e){var t=e.getStreamInfo();return t.start>n.start&&n.id!==t.id})}}catch(e){return[]}}(w),t=0;t<e.length;){var n=e[t],r=0===t?w:e[t-1];!n.getPreloaded()&&r.getHasFinishedBuffering()&&D&&re(n,r),t+=1}}function fe(){e=e||setInterval(function(){!R&&O.getTimeToStreamEnd()<=0&&!O.isSeeking()&&W.trigger(Ue.default.PLAYBACK_ENDED,{isLast:xe().isLast})},200)}function pe(){e&&(clearInterval(e),e=null)}function me(){return w?w.getProcessors():[]}function ge(e){if(w&&!w.getIsEndedEventSignaled()){w.setIsEndedEventSignaled(!0);var t=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=e||(w||null);if(!t)return null;var n=t.getStreamInfo(),r=n.start,i=0,a=-1,o=NaN;for(;i<A.length;){var s=A[i].getStreamInfo(),l=s.start-r;0<l&&(isNaN(o)||l<o)&&n.id!==s.id&&(o=l,a=i),i+=1}if(0<=a)return A[a];return null}();t?(u.debug("StreamController onEnded, found next stream with id ".concat(t.getStreamInfo().id,". Switching from ").concat(w.getStreamInfo().id," to ").concat(t.getStreamInfo().id)),X(t,w,NaN)):(u.debug("StreamController no next stream found"),w.setIsEndedEventSignaled(!1)),we(t?He.PlayListTrace.END_OF_PERIOD_STOP_REASON:He.PlayListTrace.END_OF_CONTENT_STOP_REASON)}e&&e.isLast&&pe()}function ve(e){var t=e||xe().manifestInfo.duration;l.setDuration(t)}function ye(){var e;if(c.getIsDynamic()){var t=d.getCurrentDVRInfo();e=(t&&t.range?t.range.end:0)-O.getLiveDelay();var n=t?t.range:null;if(n){var r=_e(!0);isNaN(r)||(u.info("Start time from URI parameters: "+r),e=Math.max(Math.min(e,r),n.start))}}else{e=Oe()[0].getStreamInfo().start;var i=_e(!1);isNaN(i)||(u.info("Start time from URI parameters: "+i),e=Math.max(e,i))}return e}function _e(e){var t=m.getURIFragmentData();if(!t||!t.t)return NaN;var n=Oe()[0].getStreamInfo().start;t.t=t.t.split(",")[0];var r=-1!==t.t.indexOf("posix:")?"now"===t.t.substring(6)?Date.now()/1e3:parseInt(t.t.substring(6)):NaN;return e&&!isNaN(r)?r-O.getAvailabilityStartTime()/1e3:parseInt(t.t)+n}function be(e,t){try{var n=NaN;if(t&&!isNaN(t.maxFragmentDuration)&&isFinite(t.maxFragmentDuration))return t.maxFragmentDuration;if(e&&1===e.length){var r=e[0],i=[Ne.default.VIDEO,Ne.default.AUDIO,Ne.default.TEXT].reduce(function(e,t){var n=c.getMediaInfoForType(r,t);return n&&!1!==n.isFragmented&&e.push(n),e},[]).reduce(function(t,e){var n=c.getVoRepresentations(e);return n&&0<n.length&&n.forEach(function(e){e&&t.push(e)}),t},[]).reduce(function(e,t){var n=c.convertRepresentationToRepresentationInfo(t);return n&&n.fragmentDuration&&!isNaN(n.fragmentDuration)&&e.push(n.fragmentDuration),e},[]);n=Math.max.apply(Math,Je(i))}return isFinite(n)?n:NaN}catch(e){return NaN}}function Ee(e){if(e.error)P=!0,De();else{u.info("Manifest updated... updating data system wide.");var t=e.manifest;c.updatePeriods(t);var n=c.getUTCTimingSources();!c.getIsDynamic()||n&&0!==n.length||W.trigger(We.default.CONFORMANCE_VIOLATION,{level:Ze.default.LEVELS.WARNING,event:Ze.default.EVENTS.NO_UTC_TIMING_ELEMENT});var r=c.getIsDynamic()?n.concat(N.getUTCTimingSources()):n,i=b.isHTTPS(e.manifest.url);r.forEach(function(e){e.value.replace(/.*?:\/\//g,"")===N.getDefaultUtcTimingSource().value.replace(/.*?:\/\//g,"")&&(e.value=e.value.replace(i?new RegExp(/^(http:)?\/\//i):new RegExp(/^(https:)?\/\//i),i?"https://":"http://"),u.debug("Matching default timing source protocol to manifest protocol: ",e.value))}),a.filterUnsupportedFeatures(t).then(function(){f.initialize(t),h.attemptSync(r,c.getIsDynamic())})}}function Te(){return!!w&&w.getHasVideoTrack()}function Ae(){return!!w&&w.getHasAudioTrack()}function we(t,n){n=n||new Date,me().forEach(function(e){e.finalisePlayList(n,t)}),d.addPlayList()}function Se(e){d.createPlaylistMetrics(1e3*O.getTime(),e)}function Ce(e){if(e.error){var t="";switch(e.error.code){case 1:t="MEDIA_ERR_ABORTED";break;case 2:t="MEDIA_ERR_NETWORK";break;case 3:t="MEDIA_ERR_DECODE",V.counts.mediaErrorDecode+=1;break;case 4:t="MEDIA_ERR_SRC_NOT_SUPPORTED";break;case 5:t="MEDIA_ERR_ENCRYPTED";break;default:t="UNKNOWN"}"MEDIA_ERR_DECODE"===t&&U.get().errors.recoverAttempts.mediaErrorDecode>=V.counts.mediaErrorDecode?function(){u.warn("A MEDIA_ERR_DECODE occured: Resetting the MediaSource");var e=O.getTime();w.deactivate(!1),u.warn("MediaSource has been resetted. Resuming playback from time ".concat(e)),Q(e,!1)}():(I=!0,e.error.message&&(t+=" ("+e.error.message+")"),e.error.msExtendedCode&&(t+=" (0x"+(e.error.msExtendedCode>>>0).toString(16).toUpperCase()+")"),u.fatal("Video Element Error: "+t),e.error&&u.fatal(e.error),E.error(new Ke.default(e.error.code,t)),De())}}function xe(){return w?w.getStreamInfo():null}function Me(e){for(var t=0,n=A.length;t<n;t++)if(A[t].getId()===e)return A[t];return null}function Re(){if(!(o&&o.hasOwnProperty("load")&&T&&T.hasOwnProperty("initialize")&&T.hasOwnProperty("reset")&&T.hasOwnProperty("getClientTimeOffset")&&s&&E&&d&&O))throw new Error(Ne.default.MISSING_CONFIG_ERROR)}function Ie(e){isNaN(e.newDuration)||ve(e.newDuration)}function Pe(){j=H=!(M=!(t=!(k=!(P=I=R=!(A=[]))))),F=[],G=e=w=S=null,V={counts:{mediaErrorDecode:0}}}function De(){Re(),h.reset(),we(I||P?He.PlayListTrace.FAILURE_STOP_REASON:He.PlayListTrace.USER_REQUEST_STOP_REASON);for(var e=0,t=A?A.length:0;e<t;e++){A[e].reset(I)}W.off(We.default.PLAYBACK_TIME_UPDATED,le,n),W.off(We.default.PLAYBACK_SEEKING,J,n),W.off(We.default.PLAYBACK_ERROR,Ce,n),W.off(We.default.PLAYBACK_STARTED,ue,n),W.off(We.default.PLAYBACK_PAUSED,ce,n),W.off(We.default.PLAYBACK_ENDED,ge,n),W.off(We.default.METRIC_ADDED,Le,n),W.off(We.default.MANIFEST_VALIDITY_CHANGED,Ie,n),W.off(We.default.BUFFER_LEVEL_UPDATED,oe,n),W.off(We.default.QUALITY_CHANGE_REQUESTED,se,n),Ue.default.KEY_SESSION_UPDATED&&W.off(Ue.default.KEY_SESSION_UPDATED,Y,n),W.off(Ue.default.MANIFEST_UPDATED,Ee,n),W.off(Ue.default.STREAM_BUFFERING_COMPLETED,de,n),W.off(Ue.default.TIME_SYNCHRONIZATION_COMPLETED,q,n),W.off(Ue.default.CURRENT_TRACK_CHANGED,te,n),f.reset(),i.reset(),y.reset(),d.clearAllCurrentMetrics(),s.setValue(null),o.reset(),T.reset(),_.reset(),D&&(l.detachMediaSource(L),D=null),L=null,S&&(x=S=null,s.getValue()&&W.trigger(Ue.default.PROTECTION_DESTROYED,{data:s.getValue().url})),pe(),W.trigger(Ue.default.STREAM_TEARDOWN_COMPLETE),Pe()}function Le(e){if(e.metric===ke.default.DVR_INFO){var t=Ae()?Ne.default.AUDIO:Ne.default.VIDEO;e.mediaType===t&&l.setSeekable(e.value.range.start,e.value.range.end)}}function Oe(){return A}return n={initialize:function(e,t){Re(),M=e,x=t,T.initialize(),(i=Object(Fe.default)(z).create()).setConfig({manifestModel:s,adapter:c,manifestLoader:o,errHandler:E,settings:U}),i.initialize(),(y=Object(Qe.default)(z).getInstance()).setConfig({manifestUpdater:i,playbackController:O,settings:U}),y.start(),h.setConfig({dashMetrics:d,baseURLController:f,errHandler:E,settings:U}),h.initialize(),S&&(W.trigger(Ue.default.PROTECTION_CREATED,{controller:S}),S.setMediaElement(L.getElement()),x&&S.setProtectionData(x)),function(){W.on(We.default.PLAYBACK_TIME_UPDATED,le,n),W.on(We.default.PLAYBACK_SEEKING,J,n),W.on(We.default.PLAYBACK_ERROR,Ce,n),W.on(We.default.PLAYBACK_STARTED,ue,n),W.on(We.default.PLAYBACK_PAUSED,ce,n),W.on(We.default.PLAYBACK_ENDED,ge,n),W.on(We.default.METRIC_ADDED,Le,n),W.on(We.default.MANIFEST_VALIDITY_CHANGED,Ie,n),W.on(We.default.BUFFER_LEVEL_UPDATED,oe,n),W.on(We.default.QUALITY_CHANGE_REQUESTED,se,n),Ue.default.KEY_SESSION_UPDATED&&W.on(Ue.default.KEY_SESSION_UPDATED,Y,n);W.on(Ue.default.MANIFEST_UPDATED,Ee,n),W.on(Ue.default.STREAM_BUFFERING_COMPLETED,de,n),W.on(Ue.default.TIME_SYNCHRONIZATION_COMPLETED,q,n),W.on(Ue.default.CURRENT_TRACK_CHANGED,te,n)}()},getActiveStreamInfo:xe,addDVRMetric:ae,hasVideoTrack:Te,hasAudioTrack:Ae,getStreamById:Me,getStreamForTime:ie,getTimeRelativeToStreamId:function(e,t){for(var n=null,r=0,i=0,a=null,o=0;o<A.length;o++){if(i=(n=A[o]).getStartTime(),a=n.getDuration(),Number.isFinite(i)&&(r=i),n.getId()===t)return e-r;Number.isFinite(a)&&(r+=a)}return null},load:function(e){Re(),o.load(e)},loadWithManifest:function(e){!function(){if(!i||!i.hasOwnProperty("setManifest"))throw new Error("initialize function has to be called previously")}(),i.setManifest(e)},getActiveStreamProcessors:me,setConfig:function(e){e&&(e.capabilities&&(r=e.capabilities),e.capabilitiesFilter&&(a=e.capabilitiesFilter),e.manifestLoader&&(o=e.manifestLoader),e.manifestModel&&(s=e.manifestModel),e.mediaPlayerModel&&(N=e.mediaPlayerModel),e.protectionController&&(S=e.protectionController),e.adapter&&(c=e.adapter),e.dashMetrics&&(d=e.dashMetrics),e.errHandler&&(E=e.errHandler),e.timelineConverter&&(T=e.timelineConverter),e.videoModel&&(L=e.videoModel),e.playbackController&&(O=e.playbackController),e.textController&&(C=e.textController),e.abrController&&(g=e.abrController),e.mediaController&&(v=e.mediaController),e.settings&&(U=e.settings),e.baseURLController&&(f=e.baseURLController),e.uriFragmentModel&&(m=e.uriFragmentModel),e.segmentBaseController&&(p=e.segmentBaseController))},setProtectionData:function(e){x=e,S&&S.setProtectionData(x)},getIsStreamSwitchInProgress:function(){return R},switchToVideoElement:function(e){w&&(O.initialize(xe()),Q(e,!1))},getHasMediaOrInitialisationError:function(){return I||P},getStreams:Oe,getActiveStream:function(){return w},getInitialPlayback:function(){return k},getAutoPlay:function(){return M},reset:De},u=Object(Ge.default)(z).getInstance().getLogger(n),h=Object(qe.default)(z).getInstance(),l=Object(Ye.default)(z).getInstance(),_=Object(Ve.default)(z).getInstance(),b=Object(ze.default)(z).getInstance(),Pe(),n}a.__dashjs_factory_name="StreamController",t.default=r.default.getSingletonFactory(a)},"./src/streaming/controllers/TimeSyncController.js":function(e,t,n){n.r(t);var L=n("./src/streaming/vo/DashJSError.js"),O=n("./src/streaming/vo/metrics/HTTPRequest.js"),N=n("./src/core/EventBus.js"),k=n("./src/core/events/Events.js"),B=n("./src/core/errors/Errors.js"),r=n("./src/core/FactoryMaker.js"),F=n("./src/core/Debug.js"),j=n("./src/streaming/utils/URLUtils.js");function i(){var e,s,r,t,l,o,i,u,a,c,n,d,h,f,p,m,g=this.context,v=Object(N.default)(g).getInstance(),y=Object(j.default)(g).getInstance();function _(){u=[],h=n=c=null,d=NaN,t=r=!(a=[]),f=l.get().streaming.utcSynchronization.timeBetweenSyncAttempts}function b(){l.get().streaming.utcSynchronization.enabled&&!r&&!t&&h&&h.value&&h.schemeIdUri&&!isNaN(d)&&!isNaN(l.get().streaming.utcSynchronization.backgroundAttempts)&&(n&&(Date.now()-n)/1e3<30||(u=[],t=!0,function r(i){try{if(i<=0)return void P();var a=Date.now();o[h.schemeIdUri](h.value,function(e){var t=Date.now(),n=E(a,t,e);u.push(n),r(i-1)},function(){P()})}catch(e){P()}}(isNaN(l.get().streaming.utcSynchronization.backgroundAttempts)?2:l.get().streaming.utcSynchronization.backgroundAttempts)))}function E(e,t,n){return n-(t-(t-e)/2)}function T(e){var t=0<arguments.length&&void 0!==e?e:NaN,n=isNaN(t);n&&l.get().streaming.utcSynchronization.useManifestDateHeaderTimeSource?function(){var e=i.getLatestMPDRequestHeaderValueByID("Date"),t=null!==e?new Date(e).getTime():Number.NaN;if(isNaN(t))I(!0);else{I(!1,t-Date.now())}}():I(n,t)}function A(e){var t=Date.parse(e);return isNaN(t)&&(t=function(e){var t,n,r=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+\-])([0-9]{2})([0-9]{2}))?/.exec(e);return t=Date.UTC(parseInt(r[1],10),parseInt(r[2],10)-1,parseInt(r[3],10),parseInt(r[4],10),parseInt(r[5],10),r[6]&&(parseInt(r[6],10)||0),r[7]&&1e3*parseFloat(r[7])||0),r[9]&&r[10]&&(n=60*parseInt(r[9],10)+parseInt(r[10],10),t+=("+"===r[8]?-1:1)*n*60*1e3),new Date(t).getTime()}(e)),t}function w(e){return Date.parse(e)}function S(e){return Date.parse(e)}function C(e,t,n){n()}function x(e,t,n){var r=A(e);isNaN(r)?n():t(r)}function M(n,e,r,t,i){var a,o,s=!1,l=new XMLHttpRequest,u=i?O.HTTPRequest.HEAD:O.HTTPRequest.GET,c=e.match(/\S+/g);if(e=c.shift(),a=function(){s||(s=!0,c.length?M(n,c.join(" "),r,t,i):t())},o=function(){var e,t;200===l.status&&(e=i?l.getResponseHeader("Date"):l.response,t=n(e),isNaN(t)||(r(t),s=!0))},y.isRelative(e)){var d=m.resolve();d&&(e=y.resolve(e,d.url))}l.open(u,e),l.timeout=5e3,l.onload=o,l.onloadend=a,l.send()}function R(e,t,n){M(S,e,t,n,!0)}function I(e,t){if(isNaN(d)||isNaN(t)||e||function(e){try{var t,n=D(e),r=isNaN(f)?30:f,i=isNaN(l.get().streaming.utcSynchronization.timeBetweenSyncAttemptsAdjustmentFactor)?2:l.get().streaming.utcSynchronization.timeBetweenSyncAttemptsAdjustmentFactor,a=isNaN(l.get().streaming.utcSynchronization.maximumTimeBetweenSyncAttempts)?600:l.get().streaming.utcSynchronization.maximumTimeBetweenSyncAttempts,o=isNaN(l.get().streaming.utcSynchronization.minimumTimeBetweenSyncAttempts)?2:l.get().streaming.utcSynchronization.minimumTimeBetweenSyncAttempts;n?(t=Math.min(r*i,a),s.debug("Increasing timeBetweenSyncAttempts to ".concat(t))):(t=Math.max(r/i,o),s.debug("Decreasing timeBetweenSyncAttempts to ".concat(t))),f=t}catch(e){}}(t),!e&&!isNaN(t)){c=Date.now(),r=!1;var n=isNaN(d);d=t,n&&b(),s.debug("Completed UTC sync. Setting client - server offset to ".concat(t))}e&&(h=null,r=!1,p.error(new L.default(B.default.TIME_SYNC_FAILED_ERROR_CODE,B.default.TIME_SYNC_FAILED_ERROR_MESSAGE))),v.trigger(k.default.UPDATE_TIME_SYNC_OFFSET,{offset:t}),v.trigger(k.default.TIME_SYNCHRONIZATION_COMPLETED)}function P(){if(u&&0!==u.length){var e=u.reduce(function(e,t){return e+t},0)/u.length;D(e)?s.debug("Completed background UTC sync. Offset is within allowed threshold and is not adjusted."):(s.debug("Completed background UTC sync. Setting client - server offset to ".concat(e)),d=e,v.trigger(k.default.UPDATE_TIME_SYNC_OFFSET,{offset:d})),t=!1,n=Date.now()}}function D(e){try{if(isNaN(d))return!0;var t=l.get().streaming.utcSynchronization.maximumAllowedDrift&&!isNaN(l.get().streaming.utcSynchronization.maximumAllowedDrift)?l.get().streaming.utcSynchronization.maximumAllowedDrift:100;return d-t<=e&&e<=d+t}catch(e){return!0}}return e={initialize:function(){_(),o={"urn:mpeg:dash:utc:http-head:2014":R,"urn:mpeg:dash:utc:http-xsdate:2014":M.bind(null,A),"urn:mpeg:dash:utc:http-iso:2014":M.bind(null,w),"urn:mpeg:dash:utc:direct:2014":x,"urn:mpeg:dash:utc:http-head:2012":R,"urn:mpeg:dash:utc:http-xsdate:2012":M.bind(null,A),"urn:mpeg:dash:utc:http-iso:2012":M.bind(null,w),"urn:mpeg:dash:utc:direct:2012":x,"urn:mpeg:dash:utc:http-ntp:2014":C,"urn:mpeg:dash:utc:ntp:2014":C,"urn:mpeg:dash:utc:sntp:2014":C}},attemptSync:function(e,t){a=e,r||(!function(e){try{if(!e||!l.get().streaming.utcSynchronization.enabled)return!1;var t=isNaN(f)?30:f;return!(c&&t&&!isNaN(t))||(Date.now()-c)/1e3>=t}catch(e){return!0}}(t)?v.trigger(k.default.TIME_SYNCHRONIZATION_COMPLETED):(r=!0,function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;var n=t||0;if(!a||0===a.length||n>=a.length)return void T();var r=a[n];if(r)if(o.hasOwnProperty(r.schemeIdUri)){var i=(new Date).getTime();o[r.schemeIdUri](r.value,function(e){var t=(new Date).getTime(),n=E(i,t,e);h=r,T(n)},function(){e(n+1)})}else e(n+1);else T()}()))},setConfig:function(e){e&&(e.dashMetrics&&(i=e.dashMetrics),e.baseURLController&&(m=e.baseURLController),e.errHandler&&(p=e.errHandler),e.settings&&(l=e.settings))},reset:function(){_(),v.off(k.default.ATTEMPT_BACKGROUND_SYNC,b,e)}},s=Object(F.default)(g).getInstance().getLogger(e),v.on(k.default.ATTEMPT_BACKGROUND_SYNC,b,e),e}i.__dashjs_factory_name="TimeSyncController";var a=r.default.getSingletonFactory(i);a.HTTP_TIMEOUT_MS=5e3,r.default.updateSingletonFactory(i.__dashjs_factory_name,a),t.default=a},"./src/streaming/controllers/XlinkController.js":function(e,t,n){n.r(t);var p=n("./src/streaming/XlinkLoader.js"),m=n("./src/core/EventBus.js"),g=n("./src/core/events/Events.js"),r=n("./src/core/FactoryMaker.js"),v=n("./externals/xml2json.js"),y=n("./src/streaming/utils/URLUtils.js"),_=n("./src/dash/constants/DashConstants.js"),b="onLoad";function i(e){e=e||{};var t,n,l,u,a,s,r=this.context,i=Object(m.default)(r).getInstance(),c=Object(y.default)(r).getInstance();function o(e,t,n){var r,i,a={};a.elements=e,a.type=t,a.resolveType=n,0===a.elements.length&&h(a);for(var o=0;o<a.elements.length;o++)r=a.elements[o],i=c.isHTTPURL(r.url)?r.url:r.originalContent.BaseURL+r.url,s.load(i,r,a)}function d(e){var t,n,r="";if(t=e.element,n=e.resolveObject,t.resolvedContent){var i=0;0===t.resolvedContent.indexOf("<?xml")&&(i=t.resolvedContent.indexOf("?>")+2),r=t.resolvedContent.substr(0,i)+"<response>"+t.resolvedContent.substr(i)+"</response>",t.resolvedContent=a.xml_str2json(r)}!function(e){var t;for(t=0;t<e.elements.length;t++)if(!1===e.elements[t].resolved)return!1;return!0}(n)||h(n)}function h(e){var t,n,r=[];if(!function(e){var t,n,r,i,a,o,s=[];for(i=e.elements.length-1;0<=i;i--){if(t=e.elements[i],n=t.type+"_asArray",t.resolvedContent){if(t.resolvedContent)for(a=0;a<t.resolvedContent[n].length;a++)r=t.resolvedContent[n][a],s.push(r)}else delete t.originalContent["xlink:actuate"],delete t.originalContent["xlink:href"],s.push(t.originalContent);for(t.parentElement[n].splice(t.index,1),o=0;o<s.length;o++)t.parentElement[n].splice(t.index+o,0,s[o]);s=[]}0<e.elements.length&&l.run(u)}(e),"onActuate"===e.resolveType&&i.trigger(g.default.XLINK_READY,{manifest:u}),e.resolveType===b)switch(e.type){case _.default.PERIOD:for(t=0;t<u[_.default.PERIOD+"_asArray"].length;t++)(n=u[_.default.PERIOD+"_asArray"][t]).hasOwnProperty(_.default.ADAPTATION_SET+"_asArray")&&(r=r.concat(f(n[_.default.ADAPTATION_SET+"_asArray"],n,_.default.ADAPTATION_SET,b))),n.hasOwnProperty(_.default.EVENT_STREAM+"_asArray")&&(r=r.concat(f(n[_.default.EVENT_STREAM+"_asArray"],n,_.default.EVENT_STREAM,b)));o(r,_.default.ADAPTATION_SET,b);break;case _.default.ADAPTATION_SET:i.trigger(g.default.XLINK_READY,{manifest:u})}}function f(e,t,n,r){var i,a,o,s=[];for(a=e.length-1;0<=a;a--)(i=e[a]).hasOwnProperty("xlink:href")&&"urn:mpeg:dash:resolve-to-zero:2013"===i["xlink:href"]&&e.splice(a,1);for(a=0;a<e.length;a++)(i=e[a]).hasOwnProperty("xlink:href")&&i.hasOwnProperty("xlink:actuate")&&i["xlink:actuate"]===r&&(o={url:i["xlink:href"],parentElement:t,type:n,index:a,resolveType:r,originalContent:i,resolvedContent:null,resolved:!1},s.push(o));return s}return t={resolveManifestOnLoad:function(e){a=new v.default({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!1,ignoreRoot:!0,matchers:n}),(u=e).Period_asArray?o(f(u.Period_asArray,u,_.default.PERIOD,b),_.default.PERIOD,b):i.trigger(g.default.XLINK_READY,{manifest:u})},setMatchers:function(e){e&&(n=e)},setIron:function(e){e&&(l=e)},reset:function(){i.off(g.default.XLINK_ELEMENT_LOADED,d,t),s&&(s.reset(),s=null)}},i.on(g.default.XLINK_ELEMENT_LOADED,d,t),s=Object(p.default)(r).create({errHandler:e.errHandler,dashMetrics:e.dashMetrics,mediaPlayerModel:e.mediaPlayerModel,requestModifier:e.requestModifier,settings:e.settings}),t}i.__dashjs_factory_name="XlinkController",t.default=r.default.getClassFactory(i)},"./src/streaming/metrics/MetricsReporting.js":function(e,t,n){n.r(t);var r=n("./src/streaming/metrics/utils/DVBErrorsTranslator.js"),i=n("./src/streaming/metrics/MetricsReportingEvents.js"),a=n("./src/streaming/metrics/controllers/MetricsCollectionController.js"),o=n("./src/streaming/metrics/metrics/MetricsHandlerFactory.js"),s=n("./src/streaming/metrics/reporting/ReportingFactory.js");function l(){var t=this.context;return{createMetricsReporting:function(e){return Object(r.default)(t).getInstance({eventBus:e.eventBus,dashMetrics:e.dashMetrics,metricsConstants:e.metricsConstants,events:e.events}).initialise(),Object(a.default)(t).create(e)},getReportingFactory:function(){return Object(s.default)(t).getInstance()},getMetricsHandlerFactory:function(){return Object(o.default)(t).getInstance()}}}l.__dashjs_factory_name="MetricsReporting";var u=dashjs.FactoryMaker.getClassFactory(l);u.events=i.default,dashjs.FactoryMaker.updateClassFactory(l.__dashjs_factory_name,u),t.default=u},"./src/streaming/metrics/MetricsReportingEvents.js":function(e,t,n){n.r(t);var r=n("./src/core/events/EventsBase.js");function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=s(r);if(i){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}(this,e)}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=new(function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(n,r["default"]);var t=o(n);function n(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=t.call(this)).METRICS_INITIALISATION_COMPLETE="internal_metricsReportingInitialized",e.BECAME_REPORTING_PLAYER="internal_becameReportingPlayer",e.CMCD_DATA_GENERATED="cmcdDataGenerated",e}return n}());t.default=l},"./src/streaming/metrics/controllers/MetricsCollectionController.js":function(e,t,n){n.r(t);var l=n("./src/streaming/metrics/controllers/MetricsController.js"),u=n("./src/streaming/metrics/utils/ManifestParsing.js"),c=n("./src/streaming/metrics/MetricsReportingEvents.js");function r(i){var e;i=i||{};var a={},o=this.context,t=i.eventBus,n=i.events;function r(e){if(!e.error){var r=Object.keys(a);Object(u.default)(o).getInstance({adapter:i.adapter,constants:i.constants}).getMetrics(e.manifest).forEach(function(e){var t=JSON.stringify(e);if(a.hasOwnProperty(t))r.splice(t,1);else try{var n=Object(l.default)(o).create(i);n.initialize(e),a[t]=n}catch(e){}}),r.forEach(function(e){a[e].reset(),delete a[e]}),t.trigger(c.default.METRICS_INITIALISATION_COMPLETE)}}function s(){Object.keys(a).forEach(function(e){a[e].reset()}),a={}}return e={reset:function(){t.off(n.MANIFEST_UPDATED,r,e),t.off(n.STREAM_TEARDOWN_COMPLETE,s,e)}},t.on(n.MANIFEST_UPDATED,r,e),t.on(n.STREAM_TEARDOWN_COMPLETE,s,e),e}r.__dashjs_factory_name="MetricsCollectionController",t.default=dashjs.FactoryMaker.getClassFactory(r)},"./src/streaming/metrics/controllers/MetricsController.js":function(e,t,n){n.r(t);var s=n("./src/streaming/metrics/controllers/RangeController.js"),l=n("./src/streaming/metrics/controllers/ReportingController.js"),u=n("./src/streaming/metrics/controllers/MetricsHandlersController.js");function r(t){var n,r,i;t=t||{};var a=this.context;function o(){n&&n.reset(),r&&r.reset(),i&&i.reset()}return{initialize:function(e){try{(i=Object(s.default)(a).create({mediaElement:t.mediaElement})).initialize(e.Range),(r=Object(l.default)(a).create({debug:t.debug,metricsConstants:t.metricsConstants})).initialize(e.Reporting,i),(n=Object(u.default)(a).create({debug:t.debug,eventBus:t.eventBus,metricsConstants:t.metricsConstants,events:t.events})).initialize(e.metrics,r)}catch(e){throw o(),e}},reset:o}}r.__dashjs_factory_name="MetricsController",t.default=dashjs.FactoryMaker.getClassFactory(r)},"./src/streaming/metrics/controllers/MetricsHandlersController.js":function(e,t,n){n.r(t);var a=n("./src/streaming/metrics/metrics/MetricsHandlerFactory.js");function r(e){e=e||{};var t,o=[],n=this.context,r=e.eventBus,i=e.events,s=Object(a.default)(n).getInstance({debug:e.debug,eventBus:e.eventBus,metricsConstants:e.metricsConstants});function l(t){o.forEach(function(e){e.handleNewMetric(t.metric,t.value,t.mediaType)})}return t={initialize:function(e,a){e.split(",").forEach(function(e,t,n){var r;if(-1!==e.indexOf("(")&&-1===e.indexOf(")")){var i=n[t+1];i&&-1===i.indexOf("(")&&-1!==i.indexOf(")")&&(e+=","+i,delete n[t+1])}(r=s.create(e,a))&&o.push(r)}),r.on(i.METRIC_ADDED,l,t),r.on(i.METRIC_UPDATED,l,t)},reset:function(){r.off(i.METRIC_ADDED,l,t),r.off(i.METRIC_UPDATED,l,t),o.forEach(function(e){return e.reset()}),o=[]}}}r.__dashjs_factory_name="MetricsHandlersController",t.default=dashjs.FactoryMaker.getClassFactory(r)},"./src/streaming/metrics/controllers/RangeController.js":function(e,t,n){n.r(t);var r=n("./src/streaming/utils/CustomTimeRanges.js");function i(e){e=e||{};var t,a,o=!1,n=this.context,s=e.mediaElement;return t={initialize:function(e){e&&e.length&&(e.forEach(function(e){var t=e.starttime,n=t+e.duration;a.add(t,n)}),o=!!e[0]._useWallClockTime)},reset:function(){a.clear()},isEnabled:function(){var e,t=a.length;if(!t)return!0;e=o?(new Date).getTime()/1e3:s.currentTime;for(var n=0;n<t;n+=1){var r=a.start(n),i=a.end(n);if(r<=e&&e<i)return!0}return!1}},a=Object(r.default)(n).create(),t}i.__dashjs_factory_name="RangeController",t.default=dashjs.FactoryMaker.getClassFactory(i)},"./src/streaming/metrics/controllers/ReportingController.js":function(e,t,n){n.r(t);var a=n("./src/streaming/metrics/reporting/ReportingFactory.js");function r(e){var r=[],i=Object(a.default)(this.context).getInstance(e);return{initialize:function(e,n){e.some(function(e){var t=i.create(e,n);if(t)return r.push(t),!0})},reset:function(){r.forEach(function(e){return e.reset()}),r=[]},report:function(t,n){r.forEach(function(e){return e.report(t,n)})}}}r.__dashjs_factory_name="ReportingController",t.default=dashjs.FactoryMaker.getClassFactory(r)},"./src/streaming/metrics/metrics/MetricsHandlerFactory.js":function(e,t,n){n.r(t);var r=n("./src/streaming/metrics/metrics/handlers/BufferLevelHandler.js"),u=n("./src/streaming/metrics/metrics/handlers/DVBErrorsHandler.js"),c=n("./src/streaming/metrics/metrics/handlers/HttpListHandler.js"),d=n("./src/streaming/metrics/metrics/handlers/GenericMetricHandler.js");function i(i){var e,a=(i=i||{}).debug?i.debug.getLogger(e):{},o=/([a-zA-Z]*)(\(([0-9]*)(\,\s*([a-zA-Z]*))?\))?/,s=this.context,l={BufferLevel:r.default,DVBErrors:u.default,HttpList:c.default,PlayList:d.default,RepSwitchList:d.default,TcpList:d.default};return e={create:function(e,t){var n,r=e.match(o);if(r){try{(n=l[r[1]](s).create({eventBus:i.eventBus,metricsConstants:i.metricsConstants})).initialize(r[1],t,r[3],r[5])}catch(e){n=null,a.error("MetricsHandlerFactory: Could not create handler for type ".concat(r[1]," with args ").concat(r[3],", ").concat(r[5]," (").concat(e.message,")"))}return n}},register:function(e,t){l[e]=t},unregister:function(e){delete l[e]}}}i.__dashjs_factory_name="MetricsHandlerFactory",t.default=dashjs.FactoryMaker.getSingletonFactory(i)},"./src/streaming/metrics/metrics/handlers/BufferLevelHandler.js":function(e,t,n){n.r(t);var d=n("./src/streaming/metrics/utils/HandlerHelpers.js");function r(e){var r,i,a,o,t;e=e||{};var n=this.context,s=Object(d.default)(n).getInstance(),l=[],u=e.metricsConstants;function c(){var e=function(){try{return Object.keys(l).map(function(e){return l[e]}).reduce(function(e,t){return e.level<t.level?e:t})}catch(e){return}}();e&&t!==e.t&&(t=e.t,r.report(a,e))}return{initialize:function(e,t,n){t&&(i=s.validateN(n),r=t,a=s.reconstructFullMetricName(e,n),o=setInterval(c,i))},reset:function(){clearInterval(o),i=0,t=r=o=null},handleNewMetric:function(e,t,n){e===u.BUFFER_LEVEL&&(l[n]=t)}}}r.__dashjs_factory_name="BufferLevelHandler",t.default=dashjs.FactoryMaker.getClassFactory(r)},"./src/streaming/metrics/metrics/handlers/DVBErrorsHandler.js":function(e,t,n){n.r(t);var o=n("./src/streaming/metrics/MetricsReportingEvents.js");t.default=dashjs.FactoryMaker.getClassFactory(function(e){var n,r=(e=e||{}).eventBus,i=e.metricsConstants;function a(){r.off(o.default.METRICS_INITIALISATION_COMPLETE,a,this),r.trigger(o.default.BECAME_REPORTING_PLAYER)}return{initialize:function(e,t){t&&(n=t,r.on(o.default.METRICS_INITIALISATION_COMPLETE,a,this))},reset:function(){n=null},handleNewMetric:function(e,t){e===i.DVB_ERRORS&&n&&n.report(e,t)}}})},"./src/streaming/metrics/metrics/handlers/GenericMetricHandler.js":function(e,t,n){function r(){var n,r;return{initialize:function(e,t){n=e,r=t},reset:function(){r=null,n=void 0},handleNewMetric:function(e,t){e===n&&r&&r.report(n,t)}}}n.r(t),r.__dashjs_factory_name="GenericMetricHandler",t.default=dashjs.FactoryMaker.getClassFactory(r)},"./src/streaming/metrics/metrics/handlers/HttpListHandler.js":function(e,t,n){n.r(t);var d=n("./src/streaming/metrics/utils/HandlerHelpers.js");function r(e){var i,a,o,s,l;e=e||{};var n=[],u=Object(d.default)(this.context).getInstance(),r=e.metricsConstants;function c(){var e=n;e.length&&i&&i.report(s,e),n=[]}return{initialize:function(e,t,n,r){t&&(a=u.validateN(n),i=t,r&&r.length&&(o=r),s=u.reconstructFullMetricName(e,n,r),l=setInterval(c,a))},reset:function(){clearInterval(l),n=[],i=o=a=l=null},handleNewMetric:function(e,t){e===r.HTTP_REQUEST&&(o&&o!==t.type||n.push(t))}}}r.__dashjs_factory_name="HttpListHandler",t.default=dashjs.FactoryMaker.getClassFactory(r)},"./src/streaming/metrics/reporting/ReportingFactory.js":function(e,t,n){n.r(t);var s=n("./src/streaming/metrics/reporting/reporters/DVBReporting.js");function r(e){e=e||{};var t,r={"urn:dvb:dash:reporting:2014":s.default},i=this.context,a=e.debug?e.debug.getLogger(t):{},o=e.metricsConstants;return t={create:function(t,e){var n;try{(n=r[t.schemeIdUri](i).create({metricsConstants:o})).initialize(t,e)}catch(e){n=null,a.error("ReportingFactory: could not create Reporting with schemeIdUri ".concat(t.schemeIdUri," (").concat(e.message,")"))}return n},register:function(e,t){r[e]=t},unregister:function(e){delete r[e]}}}r.__dashjs_factory_name="ReportingFactory",t.default=dashjs.FactoryMaker.getSingletonFactory(r)},"./src/streaming/metrics/reporting/reporters/DVBReporting.js":function(e,t,n){n.r(t);var f=n("./src/streaming/metrics/utils/MetricSerialiser.js"),p=n("./src/streaming/metrics/utils/RNG.js");function r(e){var t;e=e||{};var r,i,a,o,s,l,n=this.context,u=[],c=e.metricsConstants;function d(e,t,n){function r(){var e=u.indexOf(i);-1!==e&&(u.splice(e,1),200<=i.status&&i.status<300?t&&t():n&&n())}var i=new XMLHttpRequest;u.push(i);try{i.open("GET",e),i.onloadend=r,i.onerror=r,i.send()}catch(e){i.onerror()}}function h(){o=a=!1,l=s=null}return t={report:function(n,e){Array.isArray(e)||(e=[e]),o&&l.isEnabled()&&e.forEach(function(e){var t=r.serialise(e);n!==c.DVB_ERRORS&&(t="metricname=".concat(n,"&").concat(t)),d(t="".concat(s,"?").concat(t),null,function(){o=!1})})},initialize:function(e,t){var n;if(l=t,!(s=e.dvb_reportingUrl))throw new Error("required parameter missing (dvb:reportingUrl)");a||((n=e.dvb_probability)&&(1e3===n||n/1e3>=i.random())&&(o=!0),a=!0)},reset:function(){h()}},r=Object(f.default)(n).getInstance(),i=Object(p.default)(n).getInstance(),h(),t}r.__dashjs_factory_name="DVBReporting",t.default=dashjs.FactoryMaker.getClassFactory(r)},"./src/streaming/metrics/utils/DVBErrorsTranslator.js":function(e,t,n){n.r(t);var f=n("./src/streaming/metrics/vo/DVBErrors.js"),p=n("./src/streaming/metrics/MetricsReportingEvents.js");function r(e){var t,r,n=(e=e||{}).eventBus,i=e.dashMetrics,a=e.metricsConstants,o=e.events;function s(e){var t=new f.default;if(r){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.mpdurl||(t.mpdurl=r.originalUrl||r.url),t.terror||(t.terror=new Date),i.addDVBErrors(t)}}function l(e){e.error||(r=e.manifest)}function u(e){s({errorcode:f.default.BASE_URL_CHANGED,servicelocation:e.entry})}function c(){s({errorcode:f.default.BECAME_REPORTER})}function d(e){switch(e.metric){case a.HTTP_REQUEST:!function(e){(0===e.responsecode||null==e.responsecode||400<=e.responsecode||e.responsecode<100||600<=e.responsecode)&&s({errorcode:e.responsecode||f.default.CONNECTION_ERROR,url:e.url,terror:e.tresponse,servicelocation:e._serviceLocation})}(e.value)}}function h(e){var t;switch(e.error?e.error.code:0){case MediaError.MEDIA_ERR_NETWORK:t=f.default.CONNECTION_ERROR;break;case MediaError.MEDIA_ERR_DECODE:t=f.default.CORRUPT_MEDIA_OTHER;break;default:return}s({errorcode:t})}return t={initialise:function(){n.on(o.MANIFEST_UPDATED,l,t),n.on(o.SERVICE_LOCATION_BLACKLIST_CHANGED,u,t),n.on(o.METRIC_ADDED,d,t),n.on(o.METRIC_UPDATED,d,t),n.on(o.PLAYBACK_ERROR,h,t),n.on(p.default.BECAME_REPORTING_PLAYER,c,t)},reset:function(){n.off(o.MANIFEST_UPDATED,l,t),n.off(o.SERVICE_LOCATION_BLACKLIST_CHANGED,u,t),n.off(o.METRIC_ADDED,d,t),n.off(o.METRIC_UPDATED,d,t),n.off(o.PLAYBACK_ERROR,h,t),n.off(p.default.BECAME_REPORTING_PLAYER,c,t)}}}r.__dashjs_factory_name="DVBErrorsTranslator",t.default=dashjs.FactoryMaker.getSingletonFactory(r)},"./src/streaming/metrics/utils/HandlerHelpers.js":function(e,t,n){function r(){return{reconstructFullMetricName:function(e,t,n){var r=e;return t&&(r+="("+t,n&&n.length&&(r+=","+n),r+=")"),r},validateN:function(e){if(!e)throw new Error("missing n");if(isNaN(e))throw new Error("n is NaN");if(e<0)throw new Error("n must be positive");return e}}}n.r(t),r.__dashjs_factory_name="HandlerHelpers",t.default=dashjs.FactoryMaker.getSingletonFactory(r)},"./src/streaming/metrics/utils/ManifestParsing.js":function(e,t,n){n.r(t);var a=n("./src/streaming/metrics/vo/Metrics.js"),l=n("./src/streaming/metrics/vo/Range.js"),u=n("./src/streaming/metrics/vo/Reporting.js");function r(e){var o=(e=e||{}).adapter,s=e.constants;return{getMetrics:function(i){var t=[];return i&&i.Metrics_asArray&&i.Metrics_asArray.forEach(function(e){var n=new a.default,r=o.getIsDynamic(i);e.hasOwnProperty("metrics")&&(n.metrics=e.metrics,e.Range_asArray&&e.Range_asArray.forEach(function(e){var t=new l.default;t.starttime=function(e,t,n){var r,i,a=0;return t?a=o.getAvailabilityStartTime(e)/1e3:(r=o.getRegularPeriods(e)).length&&(a=r[0].start),i=a,n&&n.hasOwnProperty(s.START_TIME)&&(i+=n.starttime),i}(i,r,e),e.hasOwnProperty("duration")?t.duration=e.duration:t.duration=o.getDuration(i),t._useWallClockTime=r,n.Range.push(t)}),e.Reporting_asArray&&(e.Reporting_asArray.forEach(function(e){var t=new u.default;e.hasOwnProperty(s.SCHEME_ID_URI)&&(t.schemeIdUri=e.schemeIdUri,e.hasOwnProperty("value")&&(t.value=e.value),e.hasOwnProperty(s.DVB_REPORTING_URL)&&(t.dvb_reportingUrl=e[s.DVB_REPORTING_URL]),e.hasOwnProperty(s.DVB_PROBABILITY)&&(t.dvb_probability=e[s.DVB_PROBABILITY]),n.Reporting.push(t))}),t.push(n)))}),t}}}r.__dashjs_factory_name="ManifestParsing",t.default=dashjs.FactoryMaker.getSingletonFactory(r)},"./src/streaming/metrics/utils/MetricSerialiser.js":function(e,t,n){function r(){return{serialise:function n(e){var t,r,i=[],a=[];for(t in e)if(e.hasOwnProperty(t)&&0!==t.indexOf("_")){if(null==(r=e[t])&&(r=""),Array.isArray(r)){if(!r.length)continue;a=[],r.forEach(function(e){var t="Object"!==Object.prototype.toString.call(e).slice(8,-1);a.push(t?e:n(e))}),r=a.map(encodeURIComponent).join(",")}else"string"==typeof r?r=encodeURIComponent(r):r instanceof Date?r=r.toISOString():"number"==typeof r&&(r=Math.round(r));i.push(t+"="+r)}return i.join("&")}}}n.r(t),r.__dashjs_factory_name="MetricSerialiser",t.default=dashjs.FactoryMaker.getSingletonFactory(r)},"./src/streaming/metrics/utils/RNG.js":function(e,t,n){function r(){var r,i,e,a=window.crypto||window.msCrypto,t=Uint32Array,o=Math.pow(2,8*t.BYTES_PER_ELEMENT)-1,n=10;function s(){a&&(r=r||new t(n),a.getRandomValues(r),i=0)}return e={random:function(e,t){var n;return e=e||0,t=t||1,a?(i===r.length&&s(),n=r[i]/o,i+=1):n=Math.random(),n*(t-e)+e}},s(),e}n.r(t),r.__dashjs_factory_name="RNG",t.default=dashjs.FactoryMaker.getSingletonFactory(r)},"./src/streaming/metrics/vo/DVBErrors.js":function(e,t,n){n.r(t);function r(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this.mpdurl=null,this.errorcode=null,this.terror=null,this.url=null,this.ipaddress=null,this.servicelocation=null}r.SSL_CONNECTION_FAILED_PREFIX="SSL",r.DNS_RESOLUTION_FAILED="C00",r.HOST_UNREACHABLE="C01",r.CONNECTION_REFUSED="C02",r.CONNECTION_ERROR="C03",r.CORRUPT_MEDIA_ISOBMFF="M00",r.CORRUPT_MEDIA_OTHER="M01",r.BASE_URL_CHANGED="F00",r.BECAME_REPORTER="S00",t.default=r},"./src/streaming/metrics/vo/Metrics.js":function(e,t,n){n.r(t);t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.metrics="",this.Range=[],this.Reporting=[]}},"./src/streaming/metrics/vo/Range.js":function(e,t,n){n.r(t);t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.starttime=0,this.duration=1/0,this._useWallClockTime=!1}},"./src/streaming/metrics/vo/Reporting.js":function(e,t,n){n.r(t);t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.schemeIdUri="",this.value="",this.dvb_reportingUrl="",this.dvb_probability=1e3}},"./src/streaming/models/BaseURLTreeModel.js":function(e,t,n){n.r(t);var l=n("./src/streaming/utils/ObjectUtils.js"),r=n("./src/core/FactoryMaker.js");function u(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),this.data={baseUrls:e||null,selectedIdx:t||NaN},this.children=[]}function i(){var e,i,a,t=this.context,o=Object(l.default)(t).getInstance();function s(e,t,n){var r=a.getBaseURLsFromElement(n);e[t]?o.areEqual(r,e[t].data.baseUrls)||(e[t].data.baseUrls=r,e[t].data.selectedIdx=NaN):e[t]=new u(r)}function n(e){!function(){if(!a||!a.hasOwnProperty("getBaseURLsFromElement")||!a.hasOwnProperty("getRepresentationSortFunction"))throw new Error("setConfig function has to be called previously")}();var t=a.getBaseURLsFromElement(e);o.areEqual(t,i.data.baseUrls)||(i.data.baseUrls=t,i.data.selectedIdx=NaN),e&&e.Period_asArray&&e.Period_asArray.forEach(function(e,r){s(i.children,r,e),e.AdaptationSet_asArray&&e.AdaptationSet_asArray.forEach(function(e,n){s(i.children[r].children,n,e),e.Representation_asArray&&e.Representation_asArray.sort(a.getRepresentationSortFunction()).forEach(function(e,t){s(i.children[r].children[n].children,t,e)})})})}function r(){i=new u}return e={reset:r,update:function(e){n(e)},getForPath:function(e){var t=i,n=[t.data];return e&&e.forEach(function(e){(t=t.children[e])&&n.push(t.data)}),n.filter(function(e){return e.baseUrls.length})},invalidateSelectedIndexes:function(t){!function t(n,e){var r=e||i;n(r.data),r.children&&r.children.forEach(function(e){return t(n,e)})}(function(e){isNaN(e.selectedIdx)||t===e.baseUrls[e.selectedIdx].serviceLocation&&(e.selectedIdx=NaN)})},setConfig:function(e){e.adapter&&(a=e.adapter)}},r(),e}i.__dashjs_factory_name="BaseURLTreeModel",t.default=r.default.getClassFactory(i)},"./src/streaming/models/CmcdModel.js":function(e,t,n){n.r(t);var S=n("./src/core/EventBus.js"),C=n("./src/streaming/MediaPlayerEvents.js"),x=n("./src/streaming/metrics/MetricsReportingEvents.js"),r=n("./src/core/FactoryMaker.js"),M=n("./src/core/Settings.js"),R=n("./src/streaming/constants/Constants.js"),I=n("./src/streaming/vo/metrics/HTTPRequest.js"),P=n("./src/dash/models/DashManifestModel.js"),D=n("./src/core/Utils.js");function L(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var O="m",N="a",k="v",B="i",F="c",j="tt",U="k",H="o",G="d",V="s",z="v",W="l";function i(){var r,e,h,f,p,m,g,v,y,_,t=this.context,s=Object(S.default)(t).getInstance(),b=Object(M.default)(t).getInstance();function n(){h={pr:1,nor:null,st:null,sf:null,sid:"".concat(D.default.generateUuid()),cid:null},y={},v={},_={},a()}function i(){a()}function a(){if(m){var e=m.getStreamController();if(e&&"function"==typeof e.getActiveStream){var t=e.getActiveStream();t&&(g=t.getProcessors())}}}function l(e,t){var n,r={},i=L(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;e[a]&&(r[a]=e[a])}}catch(e){i.e(e)}finally{i.f()}return r}function u(e){try{return e.type===I.HTTPRequest.MPD_TYPE?function(){var e=E();return e.ot=O,e}():e.type===I.HTTPRequest.MEDIA_SEGMENT_TYPE?(function(e){_.hasOwnProperty(e)||(_[e]=!1);v.hasOwnProperty(e)||(v[e]=!1);y.hasOwnProperty(e)||(y[e]=!1)}(e.mediaType),function(e){var t,n=E(),r=function(e){try{var t=e.quality,n=e.mediaInfo.bitrateList;return parseInt(n[t].bandwidth/1e3)}catch(e){return null}}(e),i=function(e){try{return isNaN(e.duration)?null:Math.round(1e3*e.duration)}catch(e){return null}}(e),a=function(e){try{return 100*parseInt(f.getThroughputHistory().getSafeAverageThroughput(e)/100)}catch(e){return null}}(e.mediaType),o=function(e){try{var t=h.pr,n=p.getCurrentBufferLevel(e);return isNaN(t)||isNaN(n)?null:100*parseInt(n/t*10)}catch(e){return null}}(e.mediaType),s=T(e.mediaType),l=function(e){try{var t=f.getTopBitrateInfoFor(e);return Math.round(t.bitrate/1e3)}catch(e){return null}}(e.mediaType),u=h.pr,c=function(e){if(!g||0===g.length)return;var t,n=L(g);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.getType()===e)return r.probeNextRequest()}}catch(e){n.e(e)}finally{n.f()}}(e.mediaType);e.mediaType===R.default.VIDEO&&(t=k);e.mediaType===R.default.AUDIO&&(t=N);e.mediaType===R.default.TEXT&&(t="application/mp4"===e.mediaInfo.mimeType?j:F);var d=b.get().streaming.cmcd.rtp;d=d||function(e){var t=m.getPlaybackRate();t=t||1;var n=e.quality,r=e.mediaType,i=e.mediaInfo,a=e.duration,o=T(r);0===o&&(o=500);var s=i.bitrateList[n].bandwidth*a/1e3/(o/t/1e3),l=b.get().streaming.cmcd.rtpSafetyFactor&&!isNaN(b.get().streaming.cmcd.rtpSafetyFactor)?b.get().streaming.cmcd.rtpSafetyFactor:5;return 100*(parseInt(s*l/100)+1)}(e);n.rtp=d,c&&(e.url!==c.url?n.nor=encodeURIComponent(D.default.getRelativeUrl(e.url,c.url)):c.range&&(n.nrr=c.range));r&&(n.br=r);t&&(n.ot=t);isNaN(i)||(n.d=i);isNaN(a)||(n.mtp=a);isNaN(o)||(n.dl=o);isNaN(s)||(n.bl=s);isNaN(l)||(n.tb=l);isNaN(u)||1===u||(n.pr=u);y[e.mediaType]&&(n.bs=!0,y[e.mediaType]=!1);!v[e.mediaType]&&_[e.mediaType]||(n.su=!0,v[e.mediaType]=!1,_[e.mediaType]=!0);return n}(e)):e.type===I.HTTPRequest.INIT_SEGMENT_TYPE?function(){var e=E();return e.ot=B,e.su=!0,e}():e.type===I.HTTPRequest.OTHER_TYPE||e.type===I.HTTPRequest.XLINK_EXPANSION_TYPE?function(){var e=E();return e.ot=H,e}():e.type===I.HTTPRequest.LICENSE?function(){var e=E();return e.ot=U,e}():null}catch(e){return null}}function E(){var e={},t=b.get().streaming.cmcd.cid?b.get().streaming.cmcd.cid:h.cid;return e.v=1,e.sid=b.get().streaming.cmcd.sid?b.get().streaming.cmcd.sid:h.sid,e.sid="".concat(e.sid),t&&(e.cid="".concat(t)),isNaN(h.pr)||1===h.pr||null===h.pr||(e.pr=h.pr),h.st&&(e.st=h.st),h.sf&&(e.sf=h.sf),e}function T(e){try{var t=p.getCurrentBufferLevel(e);return isNaN(t)?null:100*parseInt(10*t)}catch(e){return null}}function o(e){try{h.pr=e.playbackRate}catch(e){}}function c(e){try{var t=r.getIsDynamic(e.data)?W:z,n=e.protocol&&"MSS"===e.protocol?V:G;h.st="".concat(t),h.sf="".concat(n)}catch(e){}}function d(e){try{e.state&&e.mediaType&&e.state===C.default.BUFFER_EMPTY&&(y[e.mediaType]||(y[e.mediaType]=!0),v[e.mediaType]||(v[e.mediaType]=!0))}catch(e){}}function A(){for(var e in y)y.hasOwnProperty(e)&&(y[e]=!0);for(var t in v)v.hasOwnProperty(t)&&(v[t]=!0)}function w(i){try{if(!i)return null;var e=Object.keys(i).sort(function(e,t){return e.localeCompare(t)}),a=e.length,t=e.reduce(function(e,t,n){if("v"===t&&1===i[t])return e;if("string"==typeof i[t]&&"ot"!==t&&"sf"!==t&&"st"!==t){var r=i[t].replace(/"/g,'"');e+="".concat(t,'="').concat(r,'"')}else e+="".concat(t,"=").concat(i[t]);return n<a-1&&(e+=","),e},"");return t=(t=t.replace(/=true/g,"")).replace(/,\s*$/,"")}catch(e){return null}}return e={getQueryParameter:function(e){try{if(b.get().streaming.cmcd&&b.get().streaming.cmcd.enabled){var t=u(e),n=w(t);return s.trigger(x.default.CMCD_DATA_GENERATED,{url:e.url,mediaType:e.mediaType,cmcdData:t,cmcdString:n}),{key:"CMCD",value:n}}return null}catch(e){return null}},getHeaderParameters:function(e){try{if(b.get().streaming.cmcd&&b.get().streaming.cmcd.enabled){var t=u(e),n=l(t,["br","d","ot","tb"]),r=l(t,["bl","dl","mtp","nor","nrr","su"]),i=l(t,["bs","rtp"]),a=l(t,["cid","pr","sf","sid","st","v"]),o={"CMCD-Object":w(n),"CMCD-Request":w(r),"CMCD-Status":w(i),"CMCD-Session":w(a)};return s.trigger(x.default.CMCD_DATA_GENERATED,{url:e.url,mediaType:e.mediaType,cmcdData:t,headers:o}),o}return null}catch(e){return null}},setConfig:function(e){e&&(e.abrController&&(f=e.abrController),e.dashMetrics&&(p=e.dashMetrics),e.playbackController&&(m=e.playbackController))},reset:function(){s.off(C.default.PLAYBACK_RATE_CHANGED,o,this),s.off(C.default.MANIFEST_LOADED,c,this),s.off(C.default.BUFFER_LEVEL_STATE_CHANGED,d,e),s.off(C.default.PLAYBACK_SEEKED,A,e),n()},initialize:function(){s.on(C.default.PLAYBACK_RATE_CHANGED,o,e),s.on(C.default.MANIFEST_LOADED,c,e),s.on(C.default.BUFFER_LEVEL_STATE_CHANGED,d,e),s.on(C.default.PLAYBACK_SEEKED,A,e),s.on(C.default.PERIOD_SWITCH_COMPLETED,i,e)}},r=Object(P.default)(t).getInstance(),n(),e}i.__dashjs_factory_name="CmcdModel",t.default=r.default.getSingletonFactory(i)},"./src/streaming/models/FragmentModel.js":function(e,t,n){n.r(t);var r=n("./src/core/FactoryMaker.js"),E=n("./src/streaming/vo/FragmentRequest.js"),T="loading",A="executed";function i(e){var t,n,i,a,r=(e=e||{}).eventBus,o=e.events,s=e.dashMetrics,l=e.fragmentLoader,u=e.debug,c=e.streamInfo,d=e.type;function h(t){var n;return!!t&&(n=!1,i.some(function(e){if(function(e,t){return!isNaN(e.index)&&e.startTime===t.startTime&&e.adaptationIndex===t.adaptationIndex&&e.type===t.type}(t,e)||function(e,t){return isNaN(e.index)&&isNaN(t.index)&&e.quality===t.quality}(t,e)||function(e,t){return e.action===E.default.ACTION_COMPLETE&&e.action===t.action}(t,e))return n=!0}),n)}function f(e){return isNaN(e.duration)?.25:Math.min(e.duration/8,.5)}function p(n){i=i.filter(function(e){var t=f(e);return isNaN(e.startTime)||void 0!==n&&e.startTime>=n-t})}function m(n,r){r<=n+.5||(i=i.filter(function(e){var t=f(e);return isNaN(e.startTime)||e.startTime>=r-t||isNaN(e.duration)||e.startTime+e.duration<=n+t}))}function g(e,t){s.addSchedulingInfo(e,t),s.addRequestsQueue(e.mediaType,a,i)}function v(e){e.sender===l&&(a.splice(a.indexOf(e.request),1),e.response&&!e.error&&i.push(e.request),g(e.request,e.error?"failed":A),r.trigger(o.FRAGMENT_LOADING_COMPLETED,{request:e.request,response:e.response,error:e.error,sender:this},{streamId:c.id,mediaType:d}))}function y(e){e.sender===l&&r.trigger(o.FRAGMENT_LOADING_PROGRESS,{request:e.request,response:e.response,error:e.error,sender:this},{streamId:c.id,mediaType:d})}function _(e){e.sender===l&&r.trigger(o.FRAGMENT_LOADING_ABANDONED,{request:e.request},{streamId:c.id,mediaType:d})}function b(){i=[],a=[]}return t={getStreamId:function(){return c.id},getType:function(){return d},getRequests:function(n){var e=n?n.state instanceof Array?n.state:[n.state]:[],r=[];return e.forEach(function(e){var t=function(e){var t;switch(e){case T:t=a;break;case A:t=i;break;default:t=[]}return t}(e);r=r.concat(function(e,n){if(n.hasOwnProperty("time"))return[function(e,t,n){for(var r=e.length-1;0<=r;r--){var i=e[r],a=i.startTime,o=a+i.duration;if(n=isNaN(n)?f(i):n,!isNaN(a)&&!isNaN(o)&&a<=t+n&&t-n<o||isNaN(a)&&isNaN(t))return i}return null}(e,n.time,n.threshold)];return e.filter(function(e){for(var t in n)if("state"!==t&&n.hasOwnProperty(t)&&e[t]!=n[t])return!1;return!0})}(t,n))}),r},isFragmentLoaded:h,isFragmentLoadedOrPending:function(e){var t,n=!1,r=0;if(!(n=h(e)))for(r=0;r<a.length;r++)t=a[r],e.url===t.url&&e.startTime===t.startTime&&(n=!0);return n},removeExecutedRequestsBeforeTime:p,removeExecutedRequestsAfterTime:function(t){i=i.filter(function(e){return isNaN(e.startTime)||void 0!==t&&e.startTime<t})},syncExecutedRequestsWithBufferedRange:function(e,t){if(e&&0!==e.length){for(var n=0,r=0,i=e.length;r<i;r++)m(n,e.start(r)),n=e.end(r);0<t&&m(n,t)}else p()},abortRequests:function(){n.debug("abort requests"),l.abort(),a=[]},executeRequest:function(e){switch(e.action){case E.default.ACTION_DOWNLOAD:g(e,T),a.push(e),function(e){r.trigger(o.FRAGMENT_LOADING_STARTED,{request:e},{streamId:c.id,mediaType:d}),l.load(e)}(e);break;default:n.warn("Unknown request action.")}},reset:function(){r.off(o.LOADING_COMPLETED,v,this),r.off(o.LOADING_DATA_PROGRESS,y,this),r.off(o.LOADING_ABANDONED,_,this),l&&l.reset(),b()},resetInitialSettings:b,addExecutedRequest:function(e){i.push(e)}},n=u.getLogger(t),b(),r.on(o.LOADING_COMPLETED,v,t),r.on(o.LOADING_DATA_PROGRESS,y,t),r.on(o.LOADING_ABANDONED,_,t),t}i.__dashjs_factory_name="FragmentModel";var a=r.default.getClassFactory(i);a.FRAGMENT_MODEL_LOADING=T,a.FRAGMENT_MODEL_EXECUTED=A,a.FRAGMENT_MODEL_CANCELED="canceled",a.FRAGMENT_MODEL_FAILED="failed",r.default.updateClassFactory(i.__dashjs_factory_name,a),t.default=a},"./src/streaming/models/LowLatencyThroughputModel.js":function(e,t,n){n.r(t);var r=n("./src/core/Debug.js"),i=n("./src/core/FactoryMaker.js");function a(){var e,m,t=this.context,g={};function n(){m=Object(r.default)(t).getInstance().getLogger(e)}function v(e){var t,n=!0,r=e.reduce(function(e,t){return e+t.bufferLevelAtSegmentEnd},0)/e.length;return e.forEach(function(e){Math.abs(e.bufferLevelAtSegmentEnd/e.bufferLevelAtSegmentStart)<.95&&(n=!1),e.bufferLevelAtSegmentEnd/r<.8&&(n=!1),t?t>e.bitrate&&(n=!1):t=e.bitrate}),n}return e={setup:n,addMeasurement:function(t,e,n,r,i){t&&t.mediaType&&!g[t.mediaType]&&(g[t.mediaType]=[]);var a=t.mediaInfo.bitrateList.find(function(e){return e.id===t.representationId});g[t.mediaType].push({index:t.index,repId:t.representationId,mediaType:t.mediaType,requestTimeMS:r,adjustedAvailabilityStartTimeMS:t.availabilityStartTime.getTime(),segDurationMS:1e3*t.duration,chunksDurationMS:n.reduce(function(e,t){return e+t.chunkDownloadDurationMS},0),segmentBytes:n.reduce(function(e,t){return e+t.chunkBytes},0),bitrate:a&&a.bandwidth,bitrateList:t.mediaInfo.bitrateList,chunkMeasurements:n,fetchDownloadDurationMS:e,throughputCapacityDelayMS:i,getEstimatedBufferLevel:function(e){for(var t={},n=0,r=0,i=0,a=0,o=e.length,s=0;s<o;++s)n+=e[s].chunkDownloadTimeRelativeMS,r+=e[s].bufferLevel,i+=e[s].chunkDownloadTimeRelativeMS*e[s].bufferLevel,a+=e[s].chunkDownloadTimeRelativeMS*e[s].chunkDownloadTimeRelativeMS;return t.m=(i-n*r/o)/(a-n*n/o),t.b=r/o-t.m*n/o,function(e){return t.m*e+t.b}}(n.slice(1))}),10<g[t.mediaType].length&&g[t.mediaType].shift()},getThroughputCapacityDelayMS:function(e,t){var n=g[e.mediaType]&&g[e.mediaType].slice(-3);return!n||n.length<3?0:v(n)?250<t/4?250:t/4:0},getEstimatedDownloadDurationMS:function(e){var t=g[e.mediaType].slice(-1).pop(),n=g[e.mediaType].slice(-3),r=t.chunkMeasurements.slice(-1).pop().chunkDownloadTimeRelativeMS;t.bufferLevelAtSegmentStart=t.getEstimatedBufferLevel(r/2),t.bufferLevelAtSegmentEnd=t.getEstimatedBufferLevel(r);var i=v(n),a=i?.6:.8;if(t.isBufferStable&&1.05*t.segDurationMS<t.fetchDownloadDurationMS)return t.fetchDownloadDurationMS;if(!i||t.segDurationMS<t.fetchDownloadDurationMS)return.8*t.fetchDownloadDurationMS;if(t.adjustedAvailabilityStartTimeMS<=t.requestTimeMS+t.throughputCapacityDelayMS-t.segDurationMS)return.8*t.fetchDownloadDurationMS;for(var o=t.requestTimeMS+t.throughputCapacityDelayMS-t.adjustedAvailabilityStartTimeMS,s=0,l=0,u=0,c=0;c<t.chunkMeasurements.length;c++){var d=t.chunkMeasurements[c];if(o<l+d.chunkDownloadDurationMS)break;l+=d.chunkDownloadDurationMS,s+=d.chunkBytes,u++}if(o<0&&m.warn("request time was before adjusted availibitly start time"),s&&l&&u>.2*t.chunkMeasurements.length){var h=s/l,f=t.segmentBytes/h;return t.fetchDownloadDurationMS<f?t.fetchDownloadDurationMS*a:f*a}var p=t.bitrate;return t.bitrateList.some(function(e){if(e.bandwidth>t.bitrate)return p=e.bandwidth,!0}),p===t.bitrate?t.fetchDownloadDurationMS*a:a*t.segmentBytes*8*1e3/p}},n(),e}a.__dashjs_factory_name="LowLatencyThroughputModel",t.default=i.default.getSingletonFactory(a)},"./src/streaming/models/ManifestModel.js":function(e,t,n){n.r(t);var r=n("./src/core/EventBus.js"),i=n("./src/core/events/Events.js"),a=n("./src/core/FactoryMaker.js");function o(){var t,e=this.context,n=Object(r.default)(e).getInstance();return{getValue:function(){return t},setValue:function(e){(t=e)&&n.trigger(i.default.MANIFEST_LOADED,{data:e})}}}o.__dashjs_factory_name="ManifestModel",t.default=a.default.getSingletonFactory(o)},"./src/streaming/models/MediaPlayerModel.js":function(e,t,n){n.r(t);var d=n("./src/dash/vo/UTCTiming.js"),r=n("./src/core/FactoryMaker.js"),h=n("./src/streaming/constants/Constants.js"),f=n("./src/streaming/rules/abr/ABRRulesCollection.js"),p=n("./src/core/Settings.js"),m=n("./src/streaming/utils/SupervisorTools.js");function i(){var e,i,r,a,t=this.context,o=Object(p.default)(t).getInstance();function s(e){var t;for(t=0;t<a.length;t++)if(a[t].rulename===e)return t;return-1}function n(){if(o.get().streaming.lowLatencyEnabled)return l();var e=o.get().streaming.buffer.stableBufferTime;return 0<e?e:o.get().streaming.buffer.fastSwitchEnabled?20:12}function l(){return o.get().streaming.lowLatencyEnabled?o.get().streaming.delay.liveDelay||3:o.get().streaming.delay.liveDelay}function u(e,t){c(e,t);var n=new d.default;n.schemeIdUri=e,n.value=t,i.push(n)}function c(n,r){Object(m.checkParameterType)(n,"string"),Object(m.checkParameterType)(r,"string"),i.forEach(function(e,t){e.schemeIdUri===n&&e.value===r&&i.splice(t,1)})}return e={getABRCustomRules:function(){return a},addABRCustomRule:function(e,t,n){if("string"!=typeof e||e!==f.default.ABANDON_FRAGMENT_RULES&&e!==f.default.QUALITY_SWITCH_RULES||"string"!=typeof t)throw h.default.BAD_ARGUMENT_ERROR;var r=s(t);-1===r?a.push({type:e,rulename:t,rule:n}):(a[r].type=e,a[r].rule=n)},removeABRCustomRule:function(e){if(e){var t=s(e);-1!==t&&a.splice(t,1)}else a=[]},getStableBufferTime:n,getInitialBufferLevel:function(){var e=o.get().streaming.buffer.initialBufferLevel;return isNaN(e)||e<0?0:Math.min(n(),e)},getRetryAttemptsForType:function(e){var t=isNaN(o.get().streaming.retryAttempts.lowLatencyMultiplyFactor)?5:o.get().streaming.retryAttempts.lowLatencyMultiplyFactor;return o.get().streaming.lowLatencyEnabled?o.get().streaming.retryAttempts[e]*t:o.get().streaming.retryAttempts[e]},getRetryIntervalsForType:function(e){var t=isNaN(o.get().streaming.retryIntervals.lowLatencyReductionFactor)?10:o.get().streaming.retryIntervals.lowLatencyReductionFactor;return o.get().streaming.lowLatencyEnabled?o.get().streaming.retryIntervals[e]/t:o.get().streaming.retryIntervals[e]},getLiveDelay:l,getLiveCatchupLatencyThreshold:function(){try{var e=o.get().streaming.liveCatchup.latencyThreshold,t=l();if(null!==e&&!isNaN(e))return Math.max(e,t);var n=o.get().streaming.liveCatchup.minDrift,r=!isNaN(t)&&t?isNaN(n)?l():o.get().streaming.liveCatchup.minDrift+l():NaN;return r&&!isNaN(r)?Math.max(4*r,5):NaN}catch(e){return NaN}},addUTCTimingSource:u,removeUTCTimingSource:c,getUTCTimingSources:function(){return i},clearDefaultUTCTimingSources:function(){i=[]},restoreDefaultUTCTimingSources:function(){var e=o.get().streaming.utcSynchronization.defaultTimingSource;u(e.scheme,e.value)},setXHRWithCredentialsForType:function t(e,n){e?r[e]=!!n:Object.keys(r).forEach(function(e){t(e,n)})},getXHRWithCredentialsForType:function(e){var t=r[e];return void 0===t?r.default:t},getDefaultUtcTimingSource:function(){return o.get().streaming.utcSynchronization.defaultTimingSource},reset:function(){}},r={default:!(i=[])},a=[],e}i.__dashjs_factory_name="MediaPlayerModel",t.default=r.default.getSingletonFactory(i)},"./src/streaming/models/MetricsModel.js":function(e,t,n){n.r(t);var f=n("./src/streaming/constants/Constants.js"),y=n("./src/streaming/constants/MetricsConstants.js"),c=n("./src/streaming/vo/MetricsList.js"),_=n("./src/streaming/vo/metrics/HTTPRequest.js"),p=n("./src/streaming/vo/metrics/RepresentationSwitch.js"),m=n("./src/streaming/vo/metrics/BufferLevel.js"),g=n("./src/streaming/vo/metrics/BufferState.js"),b=n("./src/streaming/vo/metrics/DVRInfo.js"),E=n("./src/streaming/vo/metrics/DroppedFrames.js"),T=n("./src/streaming/vo/metrics/ManifestUpdate.js"),A=n("./src/streaming/vo/metrics/SchedulingInfo.js"),w=n("./src/core/EventBus.js"),S=n("./src/streaming/vo/metrics/RequestsQueue.js"),C=n("./src/core/events/Events.js"),r=n("./src/core/FactoryMaker.js");function i(e){var t,r,i=(e=e||{}).settings,n=this.context,a=Object(w.default)(n).getInstance();function o(){a.trigger(C.default.METRICS_CHANGED)}function s(e){a.trigger(C.default.METRIC_CHANGED,{mediaType:e}),o()}function u(e,t,n){a.trigger(C.default.METRIC_UPDATED,{mediaType:e,metric:t,value:n}),s(e)}function d(e,t,n){a.trigger(C.default.METRIC_ADDED,{mediaType:e,metric:t,value:n}),s(e)}function l(e,t){var n=null;return e&&(r.hasOwnProperty(e)?n=r[e]:t||(n=new c.default,r[e]=n)),n}function h(e,t,n){var r=l(e);null!==r&&(r[t].push(n),r[t].length>i.get().streaming.metrics.maxListDepth&&r[t].shift())}function v(e,t,n){h(e,t,n),d(e,t,n)}return t={clearCurrentMetricsForType:function(e){delete r[e],s(e)},clearAllCurrentMetrics:function(){r={},o()},getMetricsFor:l,addHttpRequest:function e(t,n,r,i,a,o,s,l,u,c,d,h,f,p,m){var g=new _.HTTPRequest;o&&o!==i&&(e(t,null,r,i,a,null,null,l,u,null,null,null,f,null,null),g.actualurl=o),g.tcpid=n,g.type=r,g.url=i,g.range=l,g.trequest=u,g.tresponse=c,g.responsecode=h,g._tfinish=d,g._stream=t,g._mediaduration=f,g._quality=a,g._responseHeaders=p,g._serviceLocation=s,m?m.forEach(function(e){!function(e,t,n,r,i){var a=new _.HTTPRequestTrace;a.s=t,a.d=n,a.b=r,a.t=i,e.trace.push(a),e.interval||(e.interval=0),e.interval+=n}(g,e.s,e.d,e.b,e.t)}):(delete g.interval,delete g.trace),v(t,y.default.HTTP_REQUEST,g)},addRepresentationSwitch:function(e,t,n,r,i){var a=new p.default;a.t=t,a.mt=n,a.to=r,i?a.lto=i:delete a.lto,v(e,y.default.TRACK_SWITCH,a)},addBufferLevel:function(e,t,n){var r=new m.default;r.t=t,r.level=n,v(e,y.default.BUFFER_LEVEL,r)},addBufferState:function(e,t,n){var r=new g.default;r.target=n,r.state=t,v(e,y.default.BUFFER_STATE,r)},addDVRInfo:function(e,t,n,r){var i=new b.default;i.time=t,i.range=r,i.manifestInfo=n,v(e,y.default.DVR_INFO,i)},addDroppedFrames:function(e,t){var n=new E.default,r=l(e).DroppedFrames;t&&(n.time=t.creationTime,n.droppedFrames=t.droppedVideoFrames,0<r.length&&r[r.length-1]==n||v(e,y.default.DROPPED_FRAMES,n))},addSchedulingInfo:function(e,t,n,r,i,a,o,s,l){var u=new A.default;u.mediaType=e,u.t=t,u.type=n,u.startTime=r,u.availabilityStartTime=i,u.duration=a,u.quality=o,u.range=s,u.state=l,v(e,y.default.SCHEDULING_INFO,u)},addRequestsQueue:function(e,t,n){var r=new S.default;r.loadingRequests=t,r.executedRequests=n,l(e).RequestsQueue=r,d(e,y.default.REQUESTS_QUEUE,r)},addManifestUpdate:function(e,t,n,r,i,a,o,s,l,u){var c=new T.ManifestUpdate;c.mediaType=e,c.type=t,c.requestTime=n,c.fetchTime=r,c.availabilityStartTime=i,c.presentationStartTime=a,c.clientTimeOffset=o,c.currentTime=s,c.buffered=l,c.latency=u,h(f.default.STREAM,y.default.MANIFEST_UPDATE,c),d(e,y.default.MANIFEST_UPDATE,c)},updateManifestUpdateInfo:function(e,t){if(e){for(var n in t)e[n]=t[n];u(e.mediaType,y.default.MANIFEST_UPDATE,e)}},addManifestUpdateStreamInfo:function(e,t,n,r,i){if(e){var a=new T.ManifestUpdateStreamInfo;a.id=t,a.index=n,a.start=r,a.duration=i,e.streamInfo.push(a),u(e.mediaType,y.default.MANIFEST_UPDATE_STREAM_INFO,e)}},addManifestUpdateRepresentationInfo:function(e,t,n,r,i,a,o,s){if(e&&e.representationInfo){var l=new T.ManifestUpdateRepresentationInfo;l.id=t,l.index=n,l.streamIndex=r,l.mediaType=i,l.startNumber=o,l.fragmentInfoType=s,l.presentationTimeOffset=a,e.representationInfo.push(l),u(e.mediaType,y.default.MANIFEST_UPDATE_TRACK_INFO,e)}},addPlayList:function(e){e.trace&&Array.isArray(e.trace)?e.trace.forEach(function(e){e.hasOwnProperty("subreplevel")&&!e.subreplevel&&delete e.subreplevel}):delete e.trace,v(f.default.STREAM,y.default.PLAY_LIST,e)},addDVBErrors:function(e){v(f.default.STREAM,y.default.DVB_ERRORS,e)}},r={},t}i.__dashjs_factory_name="MetricsModel",t.default=r.default.getSingletonFactory(i)},"./src/streaming/models/URIFragmentModel.js":function(e,t,n){n.r(t);var u=n("./src/streaming/vo/URIFragmentData.js"),r=n("./src/core/FactoryMaker.js");function i(){var l;return{initialize:function(e){if(l=new u.default,!e)return null;var t=e.indexOf("#");if(-1!==t)for(var n=e.substr(t+1).split("&"),r=0,i=n.length;r<i;++r){var a=n[r],o=a.indexOf("=");if(-1!==o){var s=a.substring(0,o);l.hasOwnProperty(s)&&(l[s]=a.substr(o+1))}}},getURIFragmentData:function(){return l}}}i.__dashjs_factory_name="URIFragmentModel",t.default=r.default.getSingletonFactory(i)},"./src/streaming/models/VideoModel.js":function(e,t,n){n.r(t);var r=n("./src/core/FactoryMaker.js"),g=n("./src/core/EventBus.js"),v=n("./src/core/events/Events.js"),y=n("./src/core/Debug.js"),_=n("./src/streaming/constants/Constants.js"),b=new Map([[_.default.VIDEO_ELEMENT_READY_STATES.HAVE_METADATA,"loadedmetadata"],[_.default.VIDEO_ELEMENT_READY_STATES.HAVE_CURRENT_DATA,"loadeddata"],[_.default.VIDEO_ELEMENT_READY_STATES.HAVE_FUTURE_DATA,"canplay"],[_.default.VIDEO_ELEMENT_READY_STATES.HAVE_ENOUGH_DATA,"canplaythrough"]]);function i(){var e,t,o,n,r="element is not video or audio DOM type!",i=this.context,a=Object(g.default)(i).getInstance(),s=[];function l(){o&&(o.playbackRate=1,o.removeEventListener("canplay",l))}function u(){return 0<s.length}function c(){if(o&&u()&&0===o.playbackRate){var e=document.createEvent("Event");e.initEvent("waiting",!0,!1),o.dispatchEvent(e)}}function d(e,t){o&&o.addEventListener(e,t)}function h(e,t){o&&o.removeEventListener(e,t)}function f(){return o?o.readyState:NaN}function p(){return o?o.buffered:null}function m(e,t,n,r,i){if(o)for(var a=0;a<o.textTracks.length;a++)if(o.textTracks[a].kind===e&&(!t||o.textTracks[a].label==t)&&o.textTracks[a].language===n&&o.textTracks[a].isTTML===r&&o.textTracks[a].isEmbedded===i)return o.textTracks[a];return null}return e={initialize:function(){a.on(v.default.PLAYBACK_PLAYING,c,this)},setCurrentTime:function(t,e){!function(e,t){if(e===_.default.VIDEO_ELEMENT_READY_STATES.HAVE_NOTHING||f()>=e)t();else{!function(t,n){d(t,function e(){h(t,e),n(t)})}(b.get(e),t)}}(_.default.VIDEO_ELEMENT_READY_STATES.HAVE_METADATA,function(){if(o){if(o.currentTime===t)return;try{t=e?function(e){var t=p(),n=e,r=9999999999;if(t)for(var i=0;i<t.length;i++){var a=t.start(i),o=t.end(i),s=Math.abs(a-e),l=Math.abs(o-e);if(a<=e&&e<=o)return e;s<r&&(r=s,n=a),l<r&&(r=l,n=o)}return n}(t):t,o.currentTime=t}catch(e){0===o.readyState&&e.code===e.INVALID_STATE_ERR&&setTimeout(function(){o.currentTime=t},400)}}})},play:function(){if(o){o.autoplay=!0;var e=o.play();e&&e.catch&&"undefined"!=typeof Promise&&e.catch(function(e){"NotAllowedError"===e.name&&a.trigger(v.default.PLAYBACK_NOT_ALLOWED),t.warn("Caught pending play exception - continuing (".concat(e,")"))})}},isPaused:function(){return o?o.paused:null},pause:function(){o&&(o.pause(),o.autoplay=!1)},isStalled:u,isSeeking:function(){return o?o.seeking:null},getTime:function(){return o?o.currentTime:null},getPlaybackRate:function(){return o?o.playbackRate:null},setPlaybackRate:function(e){o&&(!(1<arguments.length&&void 0!==arguments[1]&&arguments[1])&&o.readyState<=2&&0<e?o.addEventListener("canplay",l):o.playbackRate=e)},getPlayedRanges:function(){return o?o.played:null},getEnded:function(){return o?o.ended:null},setStallState:function(e,t){!function(e,t){t?function(e){if(null===e||!o||o.seeking||-1!==s.indexOf(e))return;s.push(e)}(e):function(e){var t=s.indexOf(e);if(null===e)return;-1!==t&&s.splice(t,1)}(e)}(e,t)},getElement:function(){return o},setElement:function(e){if(!(null==e||e&&/^(VIDEO|AUDIO)$/i.test(e.nodeName)))throw r;(o=e)&&(o.preload="auto")},setSource:function(e){o&&(e?o.src=e:(o.removeAttribute("src"),o.load()))},getSource:function(){return o?o.src:null},getTTMLRenderingDiv:function(){return n},setTTMLRenderingDiv:function(e){(n=e).style.position="absolute",n.style.display="flex",n.style.overflow="hidden",n.style.pointerEvents="none",n.style.top=0,n.style.left=0},getPlaybackQuality:function(){if(!o)return null;var e="webkitDroppedFrameCount"in o&&"webkitDecodedFrameCount"in o,t=null;return"getVideoPlaybackQuality"in o?t=o.getVideoPlaybackQuality():e&&(t={droppedVideoFrames:o.webkitDroppedFrameCount,totalVideoFrames:o.webkitDroppedFrameCount+o.webkitDecodedFrameCount,creationTime:new Date}),t},addEventListener:d,removeEventListener:h,getReadyState:f,getBufferRange:p,getClientWidth:function(){return o?o.clientWidth:NaN},getClientHeight:function(){return o?o.clientHeight:NaN},getTextTracks:function(){return o?o.textTracks:[]},getTextTrack:m,addTextTrack:function(e,t,n,r,i){if(!o)return null;var a=m(e,t,n,r,i);return a||((a=o.addTextTrack(e,t,n)).isEmbedded=i,a.isTTML=r),a},appendChild:function(e){o&&(o.appendChild(e),void 0!==e.isTTML&&(o.textTracks[o.textTracks.length-1].isTTML=e.isTTML,o.textTracks[o.textTracks.length-1].isEmbedded=e.isEmbedded))},removeChild:function(e){o&&o.removeChild(e)},getVideoWidth:function(){return o?o.videoWidth:NaN},getVideoHeight:function(){return o?o.videoHeight:NaN},getVideoRelativeOffsetTop:function(){var e=o.parentNode.host||o.parentNode;return e?o.getBoundingClientRect().top-e.getBoundingClientRect().top:NaN},getVideoRelativeOffsetLeft:function(){var e=o.parentNode.host||o.parentNode;return e?o.getBoundingClientRect().left-e.getBoundingClientRect().left:NaN},reset:function(){a.off(v.default.PLAYBACK_PLAYING,c,this)}},t=Object(y.default)(i).getInstance().getLogger(e),e}i.__dashjs_factory_name="VideoModel",t.default=r.default.getSingletonFactory(i)},"./src/streaming/net/FetchLoader.js":function(e,t,n){n.r(t);var r=n("./src/core/FactoryMaker.js"),i=n("./src/core/Settings.js"),D=n("./src/streaming/constants/Constants.js");function L(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||O(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function o(e){e=e||{};var x,t=this.context,o=e.requestModifier,M=e.lowLatencyThroughputModel,R=e.boxParser,s=Object(i.default)(t).getInstance();function I(t,e){t.reader.read().then(e).catch(function(e){t.onerror&&200===t.response.status&&t.onerror(e)})}function P(i,t){try{if(1<(i=i.filter(function(e){return e.bytes>t/4/i.length})).length){var a=0,o=(i[i.length-1].ts-i[0].ts)/i.length;return i.forEach(function(e,t){var n=i[t+1];if(n){var r=n.ts-e.ts;a+=r<o?r:0}}),a}return null}catch(e){return null}}return{load:function(T){var e,t=new Date,A=T.request,n=new Headers;if(A.range&&n.append("Range","bytes="+A.range),T.headers)for(var r in T.headers){var i=T.headers[r];i&&n.append(r,i)}A.requestStartDate||(A.requestStartDate=t),o&&o.modifyRequestHeader({setRequestHeader:function(e,t){n.append(e,t)}}),"function"==typeof window.AbortController&&(e=new AbortController,(T.abortController=e).signal.onabort=T.onabort);var a={method:T.method,headers:n,credentials:T.withCredentials?"include":void 0,signal:e?e.signal:void 0},w=s.get().streaming.abr.fetchThroughputCalculationMode,S=Date.now(),C=0;new Promise(function(e){if(w===D.default.ABR_FETCH_THROUGHPUT_CALCULATION_AAST&&M&&(C=M.getThroughputCapacityDelayMS(A,1e3*x.getCurrentBufferLevel(A.mediaType))))return setTimeout(e,C);e()}).then(function(){var E=Date.now();fetch(T.url,a).then(function(e){T.response||(T.response={}),T.response.status=e.status,T.response.statusText=e.statusText,T.response.responseURL=e.url,e.ok||T.onerror();var t,l="",n=function(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=O(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}(e.headers.keys());try{for(n.s();!(t=n.n()).done;){var r=t.value;l+=r+": "+e.headers.get(r)+"\r\n"}}catch(e){n.e(e)}finally{n.f()}if(T.response.responseHeaders=l,!e.body)return e.arrayBuffer().then(function(e){var t={loaded:(T.response.response=e).byteLength,total:e.byteLength,stream:!1};T.progress(t),T.onload(),T.onend()});var u,c,s=parseInt(e.headers.get("Content-Length"),10),d=0,h=!1,f=new Uint8Array,p=0;if(w===D.default.ABR_FETCH_THROUGHPUT_CALCULATION_AAST&&M){var m=E,g=0,i=L(e.body.tee(),2),a=i[0],o=i[1];u=a.getReader(),c=[],u.read().then(function e(t){var n=t.value,r=t.done;if(g=Date.now(),n&&n.length){var i=g-m,a=n.length;c.push({chunkDownloadTimeRelativeMS:g-E,chunkDownloadDurationMS:i,chunkBytes:a,kbps:Math.round(8*a/(i/1e3)),bufferLevel:x.getCurrentBufferLevel(A.mediaType)})}if(r){var o=g-E,s=c.reduce(function(e,t){return e+t.chunkBytes},0);return M.addMeasurement(A,o,c,S,C,l),void T.progress({loaded:s,total:s,lengthComputable:!0,time:M.getEstimatedDownloadDurationMS(A),stream:!0})}return m=Date.now(),u.read().then(e)}),T.reader=o.getReader()}else T.reader=e.body.getReader();var v=[],y=[],_=[],b=!0;I(T,function e(t){var n=t.value;if(t.done){if(f){if(w!==D.default.ABR_FETCH_THROUGHPUT_CALCULATION_AAST){var r=null;w===D.default.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING&&(r=function(n,r){try{var e,t;e=n.filter(function(e,t){return t<n.length-1}),t=r.filter(function(e,t){return t<r.length-1});var i=[];if(1<e.length){for(var a=0,o=0,s=0;s<e.length;s++)if(e[s]&&t[s]){var l=t[s].ts-e[s].ts;if(1<l)i.push(8*t[s].bytes/l);else{0===o&&(o=e[s].ts);var u=t[s].ts-o;1<u?(i.push(8*a/u),o=a=0):a+=t[s].bytes}}if(0<i.length)return i.reduce(function(e,t){return e+t},0)/i.length}return null}catch(e){return null}}(y,_)),T.progress({loaded:d,total:isNaN(s)?d:s,lengthComputable:!0,time:P(v,d),throughput:r,stream:!0})}T.response.response=f.buffer}return T.onload(),void T.onend()}if(n&&0<n.length){if(f=function(e,t){if(0===e.length)return t;var n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}(f,n),d+=n.length,v.push({ts:Date.now(),bytes:n.length}),w===D.default.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING&&b)R.findLastTopIsoBoxCompleted(["moof"],f,p).found&&(b=!1,y.push({ts:performance.now(),bytes:n.length}));var i=R.findLastTopIsoBoxCompleted(["moov","mdat"],f,p);if(i.found){var a,o=i.lastCompletedOffset+i.size;w!==D.default.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING||b||(b=!0,_.push({ts:performance.now(),bytes:f.length})),f=o===f.length?(a=f,new Uint8Array):(a=new Uint8Array(f.subarray(0,o)),f.subarray(o)),T.progress({data:a.buffer,lengthComputable:!1,noTrace:!0}),p=0}else p=i.lastCompletedOffset,h||(T.progress({lengthComputable:!1,noTrace:!0}),h=!0)}I(T,e)})}).catch(function(e){T.onerror&&T.onerror(e)})})},abort:function(e){if(e.abortController)e.abortController.abort();else if(e.reader)try{e.reader.cancel(),e.onabort()}catch(e){}},calculateDownloadedTime:P,setup:function(e){x=e.dashMetrics}}}o.__dashjs_factory_name="FetchLoader";var s=r.default.getClassFactory(o);t.default=s},"./src/streaming/net/HTTPLoader.js":function(e,t,n){n.r(t);var F=n("./src/streaming/net/XHRLoader.js"),j=n("./src/streaming/net/FetchLoader.js"),U=n("./src/streaming/vo/metrics/HTTPRequest.js"),r=n("./src/core/FactoryMaker.js"),H=n("./src/streaming/vo/DashJSError.js"),i=n("./src/streaming/models/CmcdModel.js"),G=n("./src/core/Utils.js"),a=n("./src/core/Debug.js"),o=n("./src/core/EventBus.js"),V=n("./src/core/events/Events.js"),s=n("./src/core/Settings.js"),z=n("./src/streaming/constants/Constants.js"),l=n("./src/streaming/models/LowLatencyThroughputModel.js");function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e){e=e||{};var t,E,T,A,w,S,C,x,n,M=this.context,R=e.errHandler,I=e.dashMetrics,P=e.mediaPlayerModel,D=e.requestModifier,L=e.boxParser,r=e.errors,O=e.requestTimeout||0,N=Object(o.default)(M).getInstance(),k=Object(s.default)(M).getInstance();function B(n,t){var i,a=n.request,o=[],r=!0,s=!0,l=new Date,u=l,c=0;if(!D||!I||!R)throw new Error("config object is not correct or missing");function d(e){if(s=!1,a.requestStartDate=l,a.requestEndDate=new Date,a.firstByteDate=a.firstByteDate||l,!a.checkExistenceOnly){var t=i.response?i.response.responseURL:null,n=i.response?i.response.status:null,r=i.response&&i.response.getAllResponseHeaders?i.response.getAllResponseHeaders():i.response?i.response.responseHeaders:[];I.addHttpRequest(a,t,n,r,e?o:null),a.type===U.HTTPRequest.MPD_TYPE&&I.addManifestUpdate(a)}}function e(){if(-1!==E.indexOf(i)&&(E.splice(E.indexOf(i),1),s))if(d(!1),0<t){try{if(k.get().streaming.utcSynchronization.enableBackgroundSyncAfterSegmentDownloadError&&a.type===U.HTTPRequest.MEDIA_SEGMENT_TYPE)P.getRetryAttemptsForType(U.HTTPRequest.MEDIA_SEGMENT_TYPE)===t&&N.trigger(V.default.ATTEMPT_BACKGROUND_SYNC)}catch(e){}t--;var e={config:n};A.push(e),e.timeout=setTimeout(function(){-1!==A.indexOf(e)&&(A.splice(A.indexOf(e),1),B(n,t))},P.getRetryIntervalsForType(a.type))}else{if(a.type===U.HTTPRequest.MSS_FRAGMENT_INFO_SEGMENT_TYPE)return;R.error(new H.default(w[a.type],a.url+" is not available",{request:a,response:i.response})),n.error&&n.error(a,"error",i.response.statusText),n.complete&&n.complete(a,i.response.statusText)}}var h;k.get().streaming.lowLatencyEnabled&&window.fetch&&"arraybuffer"===a.responseType&&a.type===U.HTTPRequest.MEDIA_SEGMENT_TYPE?(h=Object(j.default)(M).create({requestModifier:D,lowLatencyThroughputModel:C,boxParser:L})).setup({dashMetrics:I}):h=Object(F.default)(M).create({requestModifier:D});var f=null,p=D.modifyRequestURL(a.url);if(k.get().streaming.cmcd&&k.get().streaming.cmcd.enabled){var m=k.get().streaming.cmcd.mode;if(m===z.default.CMCD_MODE_QUERY){var g=function(e){try{var t=[],n=S.getQueryParameter(e);return n&&t.push(n),t}catch(e){return[]}}(a);p=G.default.addAditionalQueryParameterToUrl(p,g)}else m===z.default.CMCD_MODE_HEADER&&(f=S.getHeaderParameters(a))}a.url=p;var v=a.checkExistenceOnly?U.HTTPRequest.HEAD:U.HTTPRequest.GET,y=P.getXHRWithCredentialsForType(a.type);i={url:p,method:v,withCredentials:y,request:a,onload:function(){200<=i.response.status&&i.response.status<=299&&(d(!0),n.success&&n.success(i.response.response,i.response.statusText,i.response.responseURL),n.complete&&n.complete(a,i.response.statusText))},onend:e,onerror:e,progress:function(e){var t=new Date;r&&(r=!1,(!e.lengthComputable||e.lengthComputable&&e.total!==e.loaded)&&(a.firstByteDate=t)),e.lengthComputable&&(a.bytesLoaded=e.loaded,a.bytesTotal=e.total),e.noTrace||(o.push({s:u,d:e.time?e.time:t.getTime()-u.getTime(),b:[e.loaded?e.loaded-c:0],t:e.throughput}),u=t,c=e.loaded),n.progress&&e&&n.progress(e)},onabort:function(){n.abort&&n.abort(a)},ontimeout:function(e){var t;if(e.lengthComputable){var n=e.loaded/e.total*100;t="Request timeout: loaded: "+e.loaded+", out of: "+e.total+" : "+n.toFixed(3)+"% Completed"}else t="Request timeout: non-computable download size";x.warn(t)},loader:h,timeout:O,headers:f};var _=(new Date).getTime();if(isNaN(a.delayLoadingTime)||_>=a.delayLoadingTime)E.push(i),h.load(i);else{var b={httpRequest:i};T.push(b),b.delayTimeout=setTimeout(function(){if(-1!==T.indexOf(b)){T.splice(T.indexOf(b),1);try{l=new Date,u=l,E.push(b.httpRequest),h.load(b.httpRequest)}catch(e){b.httpRequest.onerror()}}},a.delayLoadingTime-_)}}return t={load:function(e){e.request?B(e,P.getRetryAttemptsForType(e.request.type)):e.error&&e.error(e.request,"error")},abort:function(){A.forEach(function(e){clearTimeout(e.timeout),e.config.request&&e.config.abort&&e.config.abort(e.config.request)}),A=[],T.forEach(function(e){return clearTimeout(e.delayTimeout)}),T=[],E.forEach(function(e){e.request.type!==U.HTTPRequest.MSS_FRAGMENT_INFO_SEGMENT_TYPE&&(e.onloadend=e.onerror=e.onprogress=void 0,e.loader.abort(e))}),E=[]}},x=Object(a.default)(M).getInstance().getLogger(t),E=[],T=[],A=[],S=Object(i.default)(M).getInstance(),C=Object(l.default)(M).getInstance(),u(n={},U.HTTPRequest.MPD_TYPE,r.DOWNLOAD_ERROR_ID_MANIFEST_CODE),u(n,U.HTTPRequest.XLINK_EXPANSION_TYPE,r.DOWNLOAD_ERROR_ID_XLINK_CODE),u(n,U.HTTPRequest.INIT_SEGMENT_TYPE,r.DOWNLOAD_ERROR_ID_INITIALIZATION_CODE),u(n,U.HTTPRequest.MEDIA_SEGMENT_TYPE,r.DOWNLOAD_ERROR_ID_CONTENT_CODE),u(n,U.HTTPRequest.INDEX_SEGMENT_TYPE,r.DOWNLOAD_ERROR_ID_CONTENT_CODE),u(n,U.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,r.DOWNLOAD_ERROR_ID_CONTENT_CODE),u(n,U.HTTPRequest.OTHER_TYPE,r.DOWNLOAD_ERROR_ID_CONTENT_CODE),w=n,t}c.__dashjs_factory_name="HTTPLoader";var d=r.default.getClassFactory(c);t.default=d},"./src/streaming/net/SchemeLoaderFactory.js":function(e,t,n){n.r(t);var r=n("./src/core/FactoryMaker.js"),i=n("./src/streaming/net/HTTPLoader.js");function a(){var n;function e(){n={}}function t(){e()}return t(),{getLoader:function(e){for(var t in n)if(n.hasOwnProperty(t)&&e.startsWith(t))return n[t];return i.default},registerLoader:function(e,t){n[e]=t},unregisterLoader:function(e){n[e]&&delete n[e]},unregisterAllLoader:e,reset:t}}a.__dashjs_factory_name="SchemeLoaderFactory";var o=r.default.getSingletonFactory(a);t.default=o},"./src/streaming/net/URLLoader.js":function(e,t,n){n.r(t);var r=n("./src/core/FactoryMaker.js"),o=n("./src/streaming/net/SchemeLoaderFactory.js");function i(n){n=n||{};var r,i,a=this.context;return r=Object(o.default)(a).getInstance(),{load:function(e){if(!i){var t=r.getLoader(e&&e.request?e.request.url:null);i=t(a).create({errHandler:n.errHandler,mediaPlayerModel:n.mediaPlayerModel,requestModifier:n.requestModifier,dashMetrics:n.dashMetrics,boxParser:n.boxParser?n.boxParser:null,constants:n.constants?n.constants:null,dashConstants:n.dashConstants?n.dashConstants:null,urlUtils:n.urlUtils?n.urlUtils:null,requestTimeout:isNaN(n.requestTimeout)?0:n.requestTimeout,errors:n.errors})}i.load(e)},abort:function(){i&&i.abort()}}}i.__dashjs_factory_name="URLLoader";var a=r.default.getClassFactory(i);t.default=a},"./src/streaming/net/XHRLoader.js":function(e,t,n){n.r(t);var r=n("./src/core/FactoryMaker.js");function i(e){var o=(e=e||{}).requestModifier;return{load:function(e){var t=new Date,n=e.request,r=new XMLHttpRequest;if(r.open(e.method,e.url,!0),n.responseType&&(r.responseType=n.responseType),n.range&&r.setRequestHeader("Range","bytes="+n.range),n.requestStartDate||(n.requestStartDate=t),o&&(r=o.modifyRequestHeader(r)),e.headers)for(var i in e.headers){var a=e.headers[i];a&&r.setRequestHeader(i,a)}r.withCredentials=e.withCredentials,r.onload=e.onload,r.onloadend=e.onend,r.onerror=e.onerror,r.onprogress=e.progress,r.onabort=e.onabort,r.ontimeout=e.ontimeout,r.timeout=e.timeout,r.send(),e.response=r},abort:function(e){var t=e.response;t.onloadend=t.onerror=t.onprogress=void 0,t.abort()}}}i.__dashjs_factory_name="XHRLoader";var a=r.default.getClassFactory(i);t.default=a},"./src/streaming/protection/CommonEncryption.js":function(e,t,n){function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.r(t);var h={attributes:["Laurl","laurl"],prefixes:["clearkey","dashif"]},r=function(){function r(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r)}return function(e,t,n){t&&i(e.prototype,t),n&&i(e,n)}(r,null,[{key:"findCencContentProtection",value:function(e){for(var t=null,n=0;n<e.length;++n){var r=e[n];"urn:mpeg:dash:mp4protection:2011"!==r.schemeIdUri.toLowerCase()||"cenc"!==r.value.toLowerCase()&&"cbcs"!==r.value.toLowerCase()||(t=r)}return t}},{key:"getPSSHData",value:function(e){var t=8,n=new DataView(e),r=n.getUint8(t);return t+=20,0<r&&(t+=4+16*n.getUint32(t)),t+=4,e.slice(t)}},{key:"getPSSHForKeySystem",value:function(e,t){var n=r.parsePSSHList(t);return e&&n.hasOwnProperty(e.uuid.toLowerCase())?n[e.uuid.toLowerCase()]:null}},{key:"parseInitDataFromContentProtection",value:function(e,t){return"pssh"in e?(e.pssh.__text=e.pssh.__text.replace(/\r?\n|\r/g,"").replace(/\s+/g,""),t.decodeArray(e.pssh.__text).buffer):null}},{key:"parsePSSHList",value:function(e){if(null==e)return[];for(var t=new DataView(e.buffer||e),n={},r=0;;){var i,a,o=void 0,s=r;if(r>=t.buffer.byteLength)break;if(i=r+t.getUint32(r),r+=4,1886614376===t.getUint32(r))if(r+=4,0===(a=t.getUint8(r))||1===a){r++,r+=3,o="";var l=void 0,u=void 0;for(l=0;l<4;l++)o+=1===(u=t.getUint8(r+l).toString(16)).length?"0"+u:u;for(r+=4,o+="-",l=0;l<2;l++)o+=1===(u=t.getUint8(r+l).toString(16)).length?"0"+u:u;for(r+=2,o+="-",l=0;l<2;l++)o+=1===(u=t.getUint8(r+l).toString(16)).length?"0"+u:u;for(r+=2,o+="-",l=0;l<2;l++)o+=1===(u=t.getUint8(r+l).toString(16)).length?"0"+u:u;for(r+=2,o+="-",l=0;l<6;l++)o+=1===(u=t.getUint8(r+l).toString(16)).length?"0"+u:u;r+=6,r+=4,n[o=o.toLowerCase()]=t.buffer.slice(s,i),r=i}else r=i;else r=i}return n}},{key:"getLicenseServerUrlFromMediaInfo",value:function(e,t){try{if(!e||0===e.length)return null;for(var n=0,r=null;n<e.length&&!r;){var i=e[n];if(i&&i.contentProtection&&0<i.contentProtection.length){var a=i.contentProtection.filter(function(e){return e.schemeIdUri&&e.schemeIdUri===t});if(a&&0<a.length)for(var o=0;o<a.length&&!r;){for(var s=a[o],l=0;l<h.attributes.length&&!r;){for(var u=0,c=h.attributes[l];u<h.prefixes.length&&!r;){var d=h.prefixes[u];s[c]&&s[c].__prefix&&s[c].__prefix===d&&s[c].__text&&(r=s[c].__text),u+=1}l+=1}o+=1}}n+=1}return r}catch(e){return null}}}]),r}();t.default=r},"./src/streaming/protection/Protection.js":function(e,t,n){n.r(t);var i=n("./src/streaming/protection/controllers/ProtectionController.js"),a=n("./src/streaming/protection/controllers/ProtectionKeyController.js"),r=n("./src/streaming/protection/ProtectionEvents.js"),o=n("./src/streaming/protection/errors/ProtectionErrors.js"),u=n("./src/streaming/protection/models/ProtectionModel_21Jan2015.js"),c=n("./src/streaming/protection/models/ProtectionModel_3Feb2014.js"),d=n("./src/streaming/protection/models/ProtectionModel_01b.js"),h=[{generateKeyRequest:"generateKeyRequest",addKey:"addKey",cancelKeyRequest:"cancelKeyRequest",needkey:"needkey",keyerror:"keyerror",keyadded:"keyadded",keymessage:"keymessage"},{generateKeyRequest:"webkitGenerateKeyRequest",addKey:"webkitAddKey",cancelKeyRequest:"webkitCancelKeyRequest",needkey:"webkitneedkey",keyerror:"webkitkeyerror",keyadded:"webkitkeyadded",keymessage:"webkitkeymessage"}],f=[{setMediaKeys:"setMediaKeys",MediaKeys:"MediaKeys",release:"close",needkey:"needkey",error:"keyerror",message:"keymessage",ready:"keyadded",close:"keyclose"},{setMediaKeys:"msSetMediaKeys",MediaKeys:"MSMediaKeys",release:"close",needkey:"msneedkey",error:"mskeyerror",message:"mskeymessage",ready:"mskeyadded",close:"mskeyclose"}];function s(){var o,s=this.context;function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];if("function"==typeof e[r[Object.keys(r)[0]]])return r}return null}return o={createProtectionSystem:function(e){var t=null,n=Object(a.default)(s).getInstance();n.setConfig({debug:e.debug,BASE64:e.BASE64}),n.initialize();var r=function(e){var t=e.debug,n=t.getLogger(o),r=e.eventBus,i=e.errHandler,a=e.videoModel?e.videoModel.getElement():null;return a&&void 0===a.onencrypted||a&&void 0===a.mediaKeys?l(a,f)?(n.info("EME detected on this user agent! (ProtectionModel_3Feb2014)"),Object(c.default)(s).create({debug:t,eventBus:r,events:e.events,api:l(a,f)})):l(a,h)?(n.info("EME detected on this user agent! (ProtectionModel_01b)"),Object(d.default)(s).create({debug:t,eventBus:r,errHandler:i,events:e.events,api:l(a,h)})):(n.warn("No supported version of EME detected on this user agent! - Attempts to play encrypted content will fail!"),null):(n.info("EME detected on this user agent! (ProtectionModel_21Jan2015)"),Object(u.default)(s).create({debug:t,eventBus:r,events:e.events}))}(e);return!t&&r&&(t=Object(i.default)(s).create({protectionModel:r,protectionKeyController:n,eventBus:e.eventBus,debug:e.debug,events:e.events,BASE64:e.BASE64,constants:e.constants,cmcdModel:e.cmcdModel,settings:e.settings}),e.capabilities.setEncryptedMediaSupported(!0)),t}}}s.__dashjs_factory_name="Protection";var l=dashjs.FactoryMaker.getClassFactory(s);l.events=r.default,l.errors=o.default,dashjs.FactoryMaker.updateClassFactory(s.__dashjs_factory_name,l),t.default=l},"./src/streaming/protection/ProtectionEvents.js":function(e,t,n){n.r(t);var r=n("./src/core/events/EventsBase.js");function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=s(r);if(i){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}(this,e)}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=new(function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(n,r["default"]);var t=o(n);function n(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=t.call(this)).INTERNAL_KEY_MESSAGE="internalKeyMessage",e.INTERNAL_KEY_STATUS_CHANGED="internalkeyStatusChanged",e.KEY_ADDED="public_keyAdded",e.KEY_ERROR="public_keyError",e.KEY_MESSAGE="public_keyMessage",e.KEY_SESSION_CLOSED="public_keySessionClosed",e.KEY_SESSION_CREATED="public_keySessionCreated",e.KEY_SESSION_REMOVED="public_keySessionRemoved",e.KEY_STATUSES_CHANGED="public_keyStatusesChanged",e.KEY_SYSTEM_ACCESS_COMPLETE="public_keySystemAccessComplete",e.KEY_SYSTEM_SELECTED="public_keySystemSelected",e.LICENSE_REQUEST_COMPLETE="public_licenseRequestComplete",e.LICENSE_REQUEST_SENDING="public_licenseRequestSending",e.NEED_KEY="needkey",e.PROTECTION_CREATED="public_protectioncreated",e.PROTECTION_DESTROYED="public_protectiondestroyed",e.SERVER_CERTIFICATE_UPDATED="serverCertificateUpdated",e.TEARDOWN_COMPLETE="protectionTeardownComplete",e.VIDEO_ELEMENT_SELECTED="videoElementSelected",e.KEY_SESSION_UPDATED="public_keySessionUpdated",e}return n}());t.default=l},"./src/streaming/protection/controllers/ProtectionController.js":function(e,t,n){n.r(t);var F=n("./src/streaming/protection/CommonEncryption.js"),j=n("./src/streaming/protection/vo/MediaCapability.js"),U=n("./src/streaming/protection/vo/KeySystemConfiguration.js"),H=n("./src/streaming/protection/errors/ProtectionErrors.js"),G=n("./src/streaming/vo/DashJSError.js"),V=n("./src/streaming/protection/vo/LicenseRequest.js"),z=n("./src/streaming/protection/vo/LicenseResponse.js"),W=n("./src/streaming/vo/metrics/HTTPRequest.js"),q=n("./src/core/Utils.js"),Y=n("./src/streaming/constants/Constants.js"),r=n("./src/core/FactoryMaker.js");function K(e){return(K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){var t,T,o,A,a,s,u,w,l,S,C,x=(e=e||{}).protectionKeyController,M=e.protectionModel,R=e.eventBus,I=e.events,n=e.debug,c=e.BASE64,d=e.constants,h=[],P=e.cmcdModel,D=e.settings;function r(){if(!(R&&R.hasOwnProperty("on")&&x&&x.hasOwnProperty("getSupportedKeySystemsFromContentProtection")))throw new Error("Missing config parameter(s)")}function f(e,t){l?o.push(e):w?w&&function(e){var t=e.findIndex(function(e){return e.ks===w}),n=e[t];if(-1===t||!n.initData)return;p(n)}(e):function(e,t){l=!0;var i,n=[];o.push(e);for(var r=0;r<e.length;r++){var a=_(e[r]);n.push({ks:e[r].ks,configs:[a]})}M.requestKeySystemAccess(n).then(function(e){return i=e.data,T.info("DRM: KeySystem Access Granted ("+i.keySystem.systemString+")!  Selecting key system..."),M.selectKeySystem(i)}).then(function(e){if(w=e,l=!1,M){R.trigger(I.KEY_SYSTEM_SELECTED,{data:i});var t,n=g(w);n&&n.serverCertificate&&0<n.serverCertificate.length&&M.setServerCertificate(c.decodeArray(n.serverCertificate).buffer);for(var r=0;r<o.length;r++)for(t=0;t<o[r].length;t++)if(w===o[r][t].ks){p(o[r][t]);break}}}).catch(function(e){w=null,l=!1,t||R.trigger(I.KEY_SYSTEM_SELECTED,{data:null,error:new G.default(H.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE,H.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE+"Error selecting key system! -- "+e.error)})})}(e,t)}function p(e){if(x.isClearKey(w)&&e.protData&&e.protData.hasOwnProperty("clearkeys")){var t={kids:Object.keys(e.protData.clearkeys)};e.initData=(new TextEncoder).encode(JSON.stringify(t))}e.sessionId?i(e):null!==e.initData&&m(e)}function i(e){r(),M.loadKeySession(e)}function m(e){var t=F.default.getPSSHForKeySystem(w,e?e.initData:null);if(t){if(function(e){if(!e)return!1;try{for(var t=M.getSessions(),n=0;n<t.length;n++)if(t[n].getKeyId()===e)return!0;return!1}catch(e){return!1}}(e.keyId))return;if(v(t))return;try{e.initData=t,M.createKeySession(e)}catch(e){R.trigger(I.KEY_SESSION_CREATED,{data:null,error:new G.default(H.default.KEY_SESSION_CREATED_ERROR_CODE,H.default.KEY_SESSION_CREATED_ERROR_MESSAGE+e.message)})}}else e&&e.initData?M.createKeySession(e):R.trigger(I.KEY_SESSION_CREATED,{data:null,error:new G.default(H.default.KEY_SESSION_CREATED_ERROR_CODE,H.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Selected key system is "+(w?w.systemString:null)+".  needkey/encrypted event contains no initData corresponding to that key system!")})}function g(e){if(e){var t=e.systemString;if(a)return t in a?a[t]:null}return null}function v(e){if(!e)return!1;try{for(var t=M.getAllInitData(),n=0;n<t.length;n++)if(x.initDataEquals(e,t[n]))return T.debug("DRM: Ignoring initData because we have already seen it!"),!0;return!1}catch(e){return!1}}function y(e){r(),e?(M.setMediaElement(e),R.on(I.NEED_KEY,B,t)):null===e&&(M.setMediaElement(e),R.off(I.NEED_KEY,B,t))}function _(e){var t=e.protData,n=[],r=[],i=t&&t.audioRobustness&&0<t.audioRobustness.length?t.audioRobustness:u,a=t&&t.videoRobustness&&0<t.videoRobustness.length?t.videoRobustness:u,o=e.sessionType,s=t&&t.distinctiveIdentifier?t.distinctiveIdentifier:"optional",l=t&&t.persistentState?t.persistentState:"temporary"===o?"optional":"required";return A.forEach(function(e){e.type===d.AUDIO?n.push(new j.default(e.codec,i)):e.type===d.VIDEO&&r.push(new j.default(e.codec,a))}),new U.default(n,r,s,l,[o])}function b(e){e.error?R.trigger(I.KEY_STATUSES_CHANGED,{data:null,error:e.error}):T.debug("DRM: key status = "+e.status)}function E(e){T.debug("DRM: onKeyMessage");var t=e.data;R.trigger(I.KEY_MESSAGE,{data:t});var n=t.messageType?t.messageType:"license-request",r=t.message,i=t.sessionToken,a=g(w),o=x.getLicenseServerModelInstance(w,a,n),s={sessionToken:i,messageType:n};if(r&&0!==r.byteLength){if(!o)return T.debug("DRM: License server request not required for this message (type = "+e.data.messageType+").  Session ID = "+i.getSessionId()),void L(s);if(x.isClearKey(w)){var l=x.processClearKeyLicenseRequest(w,a,r);if(l)return T.debug("DRM: ClearKey license request handled by application!"),L(s),void M.updateKeySession(i,l)}!function(e,r,t){var i=e.sessionToken,a=e.messageType?e.messageType:"license-request",o={sessionToken:i,messageType:a},s=w?w.systemString:null,n=function(e,t,n,r,i){var a=null,o=r.message;if(e&&e.serverURL){var s=e.serverURL;"string"==typeof s&&""!==s?a=s:"object"===K(s)&&s.hasOwnProperty(t)&&(a=s[t])}else if(e&&e.laURL&&""!==e.laURL)a=e.laURL;else if(!(a=F.default.getLicenseServerUrlFromMediaInfo(A,w.schemeIdURI))&&!x.isClearKey(w)){var l=F.default.getPSSHData(n.initData);a=(a=w.getLicenseServerURLFromInitData(l))||r.laURL}return a=i.getServerURLFromMessage(a,o,t)}(t,a,i,e,r);if(!n)return L(o,new G.default(H.default.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_CODE,H.default.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_MESSAGE));var l={},u=!1;t&&O(l,t.httpRequestHeaders);var c=e.message,d=w.getRequestHeadersFromMessage(c);O(l,d),Object.keys(l).forEach(function(e){"authorization"===e.toLowerCase()&&(u=!0)}),t&&"boolean"==typeof t.withCredentials&&(u=t.withCredentials);function h(t){if(M)if(200<=t.status&&t.status<=299){var e=q.default.parseHttpHeaders(t.getAllResponseHeaders?t.getAllResponseHeaders():null),n=new z.default(t.responseURL,e,t.response);k(C,n).then(function(){var e=r.getLicenseMessage(n.data,s,a);null!==e?(L(o),M.updateKeySession(i,e)):N(t,o,s,a,r)})}else N(t,o,s,a,r)}function f(e){L(o,new G.default(H.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,H.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+s+' update, XHR aborted. status is "'+e.statusText+'" ('+e.status+"), readyState is "+e.readyState))}function p(e){L(o,new G.default(H.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,H.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+s+' update, XHR error. status is "'+e.statusText+'" ('+e.status+"), readyState is "+e.readyState))}var m=w.getLicenseRequestFromMessage(c),g=r.getHTTPMethod(a),v=r.getResponseType(s,a),y=t&&!isNaN(t.httpTimeout)?t.httpTimeout:8e3,_=i.getSessionId()||null,b=new V.default(n,g,v,l,u,a,_,m),E=isNaN(D.get().streaming.retryAttempts[W.HTTPRequest.LICENSE])?3:D.get().streaming.retryAttempts[W.HTTPRequest.LICENSE];k(S,b).then(function(){!function t(n,r,i,a,o,s){var e=new XMLHttpRequest;if(D.get().streaming.cmcd&&D.get().streaming.cmcd.enabled){var l=D.get().streaming.cmcd.mode;if(l===Y.default.CMCD_MODE_QUERY){var u=P.getQueryParameter({url:n.url,type:W.HTTPRequest.LICENSE});u&&(n.url=q.default.addAditionalQueryParameterToUrl(n.url,[u]))}}e.open(n.method,n.url,!0);e.responseType=n.responseType;e.withCredentials=n.withCredentials;0<i&&(e.timeout=i);for(var c in n.headers)e.setRequestHeader(c,n.headers[c]);if(D.get().streaming.cmcd&&D.get().streaming.cmcd.enabled){var d=D.get().streaming.cmcd.mode;if(d===Y.default.CMCD_MODE_HEADER){var h=P.getHeaderParameters({url:n.url,type:W.HTTPRequest.LICENSE});if(h)for(var f in h){var p=h[f];p&&e.setRequestHeader(f,p)}}}var m=function(){r--;var e=isNaN(D.get().streaming.retryIntervals[W.HTTPRequest.LICENSE])?1e3:D.get().streaming.retryIntervals[W.HTTPRequest.LICENSE];setTimeout(function(){t(n,r,i,a,o,s)},e)};e.onload=function(){200<=this.status&&this.status<=299||r<=0?a(this):(T.warn("License request failed ("+this.status+"). Retrying it... Pending retries: "+r),m())};e.ontimeout=e.onerror=function(){r<=0?s(this):(T.warn("License request network request failed . Retrying it... Pending retries: "+r),m())};e.onabort=function(){o(this)};R.trigger(I.LICENSE_REQUEST_SENDING,{url:n.url,headers:n.headers,payload:n.data,sessionId:n.sessionId});e.send(n.data)}(b,E,y,h,f,p)})}(t,o,a)}else L(s,new G.default(H.default.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_CODE,H.default.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_MESSAGE))}function L(e,t){R.trigger(I.LICENSE_REQUEST_COMPLETE,{data:e,error:t})}function O(e,t){if(t)for(var n in t)e[n]=t[n]}function N(e,t,n,r,i){var a=e.response?i.getErrorResponse(e.response,n,r):"NONE";L(t,new G.default(H.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,H.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+n+' update, XHR complete. status is "'+e.statusText+'" ('+e.status+"), readyState is "+e.readyState+".  Response is "+a))}function k(e,n){return e?e.reduce(function(e,t){return e.then(function(){return t(n)})},Promise.resolve()):Promise.resolve()}function B(e,t){if(!D.get().streaming.protection.ignoreEmeEncryptedEvent){if(T.debug("DRM: onNeedKey"),"cenc"!==e.key.initDataType)return void T.warn("DRM:  Only 'cenc' initData is supported!  Ignoring initData of type: "+e.key.initDataType);if(0===A.length&&(T.warn("DRM: onNeedKey called before initializeForMedia, wait until initialized"),(t=void 0===t?1:t+1)<5))return void h.push(setTimeout(function(){B(e,t)},500));var n=e.key.initData;if(ArrayBuffer.isView(n)&&(n=n.buffer),w){var r=F.default.getPSSHForKeySystem(w,n);if(r&&v(r))return}T.debug("DRM: initData:",String.fromCharCode.apply(null,new Uint8Array(n)));var i=x.getSupportedKeySystemsFromSegmentPssh(n,a,s);if(0===i.length)return void T.debug("DRM: Received needkey event with initData, but we don't support any of the key systems!");f(i,!1)}}return t={initializeForMedia:function(e){if(!e)throw new Error("mediaInfo can not be null or undefined");r(),A.push(e);var n=x.getSupportedKeySystemsFromContentProtection(e.contentProtection,a,s);(n=n.sort(function(e,t){return(a&&a[e.ks.systemString]&&0<=a[e.ks.systemString].priority?a[e.ks.systemString].priority:n.length)-(a&&a[t.ks.systemString]&&0<=a[t.ks.systemString].priority?a[t.ks.systemString].priority:n.length)}))&&0<n.length&&f(n,!0)},clearMediaInfoArray:function(){A=[]},createKeySession:m,loadKeySession:i,removeKeySession:function(e){r(),M.removeKeySession(e)},closeKeySession:function(e){r(),M.closeKeySession(e)},setServerCertificate:function(e){r(),M.setServerCertificate(e)},setMediaElement:y,setSessionType:function(e){s=e},setRobustnessLevel:function(e){u=e},setProtectionData:function(e){a=e,x.setProtectionData(e)},getSupportedKeySystemsFromContentProtection:function(e){return r(),x.getSupportedKeySystemsFromContentProtection(e,a,s)},getKeySystems:function(){return x?x.getKeySystems():[]},setKeySystems:function(e){x&&x.setKeySystems(e)},setLicenseRequestFilters:function(e){S=e},setLicenseResponseFilters:function(e){C=e},stop:function(){M&&M.stop()},reset:function(){R.off(I.INTERNAL_KEY_MESSAGE,E,t),R.off(I.INTERNAL_KEY_STATUS_CHANGED,b,t),r(),S=[],C=[],y(null),w=null,l=!1,M&&(M.reset(),M=null),h.forEach(function(e){return clearTimeout(e)}),h=[],A=[],o=[]}},T=n.getLogger(t),o=[],A=[],s="temporary",u="",S=[],C=[],R.on(I.INTERNAL_KEY_MESSAGE,E,t),R.on(I.INTERNAL_KEY_STATUS_CHANGED,b,t),t}i.__dashjs_factory_name="ProtectionController",t.default=r.default.getClassFactory(i)},"./src/streaming/protection/controllers/ProtectionKeyController.js":function(e,t,n){n.r(t);var m=n("./src/streaming/protection/CommonEncryption.js"),l=n("./src/streaming/protection/drm/KeySystemClearKey.js"),u=n("./src/streaming/protection/drm/KeySystemW3CClearKey.js"),c=n("./src/streaming/protection/drm/KeySystemWidevine.js"),g=n("./src/streaming/protection/drm/KeySystemPlayReady.js"),v=n("./src/streaming/protection/servers/DRMToday.js"),y=n("./src/streaming/protection/servers/PlayReady.js"),_=n("./src/streaming/protection/servers/Widevine.js"),b=n("./src/streaming/protection/servers/ClearKey.js"),E=n("./src/streaming/constants/ProtectionConstants.js");function r(){var t,n,r,d,i,a,o,s=this.context;function h(e,t){return t&&e in t?t[e]:null}function f(e,t){return e&&e.sessionId?e.sessionId:t&&t.sessionId?t.sessionId:null}function p(e,t){return e&&e.sessionType?e.sessionType:t}return t={initialize:function(){var e;d=[],e=Object(g.default)(s).getInstance({BASE64:i}),d.push(e),e=Object(c.default)(s).getInstance({BASE64:i}),d.push(e),e=Object(l.default)(s).getInstance({BASE64:i}),d.push(e),a=e,e=Object(u.default)(s).getInstance({BASE64:i,debug:n}),d.push(e),o=e},setProtectionData:function(e){for(var t,n,r=0;r<d.length;r++){var i=d[r];i.hasOwnProperty("init")&&i.init((t=i.systemString,n=void 0,n=null,e&&(n=t in e?e[t]:null),n))}},isClearKey:function(e){return e===a||e===o},initDataEquals:function(e,t){if(e.byteLength!==t.byteLength)return!1;for(var n=new Uint8Array(e),r=new Uint8Array(t),i=0;i<n.length;i++)if(n[i]!==r[i])return!1;return!0},getKeySystems:function(){return d},setKeySystems:function(e){d=e},getKeySystemBySystemString:function(e){for(var t=0;t<d.length;t++)if(d[t].systemString===e)return d[t];return null},getSupportedKeySystemsFromContentProtection:function(e,t,n){var r,i,a,o,s=[];if(e){var l=m.default.findCencContentProtection(e);for(a=0;a<d.length;++a){var u=h((i=d[a]).systemString,t);for(o=0;o<e.length;++o)if((r=e[o]).schemeIdUri.toLowerCase()===i.schemeIdURI){var c=i.getInitData(r,l);s.push({ks:d[a],keyId:r.keyId,initData:c,protData:u,cdmData:i.getCDMData(u?u.cdmData:null),sessionId:f(u,r),sessionType:p(u,n)})}}}return s},getSupportedKeySystemsFromSegmentPssh:function(e,t,n){for(var r,i=[],a=m.default.parsePSSHList(e),o=0;o<d.length;++o){var s=h((r=d[o]).systemString,t);r.uuid in a&&i.push({ks:r,initData:a[r.uuid],protData:s,cdmData:r.getCDMData(s?s.cdmData:null),sessionId:f(s),sessionType:p(s,n)})}return i},getLicenseServerModelInstance:function(e,t,n){if("license-release"===n||"individualization-request"===n)return null;var r=null;return t&&t.hasOwnProperty("drmtoday")?r=Object(v.default)(s).getInstance({BASE64:i}):e.systemString===E.default.WIDEVINE_KEYSTEM_STRING?r=Object(_.default)(s).getInstance():e.systemString===E.default.PLAYREADY_KEYSTEM_STRING?r=Object(y.default)(s).getInstance():e.systemString===E.default.CLEARKEY_KEYSTEM_STRING&&(r=Object(b.default)(s).getInstance()),r},processClearKeyLicenseRequest:function(e,t,n){try{return e.getClearKeysFromProtectionData(t,n)}catch(e){return r.error("Failed to retrieve clearkeys from ProtectionData"),null}},setConfig:function(e){e&&(e.debug&&(n=e.debug,r=n.getLogger(t)),e.BASE64&&(i=e.BASE64))}}}r.__dashjs_factory_name="ProtectionKeyController",t.default=dashjs.FactoryMaker.getSingletonFactory(r)},"./src/streaming/protection/drm/KeySystemClearKey.js":function(e,t,n){n.r(t);var l=n("./src/streaming/protection/vo/KeyPair.js"),u=n("./src/streaming/protection/vo/ClearKeyKeySet.js"),a=n("./src/streaming/protection/CommonEncryption.js"),r=n("./src/streaming/constants/ProtectionConstants.js"),o="e2719d58-a985-b3c9-781a-b030af78d30e",s=r.default.CLEARKEY_KEYSTEM_STRING;function i(e){var i=(e=e||{}).BASE64;return{uuid:o,schemeIdURI:"urn:uuid:e2719d58-a985-b3c9-781a-b030af78d30e",systemString:s,getInitData:function(e,t){try{var n=a.default.parseInitDataFromContentProtection(e,i);if(!n&&t){var r={kids:[function(e){try{var t=e.replace(/-/g,"");return(t=btoa(t.match(/\w{2}/g).map(function(e){return String.fromCharCode(parseInt(e,16))}).join(""))).replace(/=/g,"")}catch(e){return null}}(t["cenc:default_KID"])]};n=(new TextEncoder).encode(JSON.stringify(r))}return n}catch(e){return null}},getRequestHeadersFromMessage:function(){return{"Content-Type":"application/json"}},getLicenseRequestFromMessage:function(e){return JSON.parse(String.fromCharCode.apply(null,new Uint8Array(e)))},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null},getClearKeysFromProtectionData:function(e,t){var n=null;if(e){for(var r=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t))),i=[],a=0;a<r.kids.length;a++){var o=r.kids[a],s=e.clearkeys&&e.clearkeys.hasOwnProperty(o)?e.clearkeys[o]:null;if(!s)throw new Error("DRM: ClearKey keyID ("+o+") is not known!");i.push(new l.default(o,s))}n=new u.default(i)}return n}}}i.__dashjs_factory_name="KeySystemClearKey",t.default=dashjs.FactoryMaker.getSingletonFactory(i)},"./src/streaming/protection/drm/KeySystemPlayReady.js":function(e,t,n){n.r(t);var h=n("./src/streaming/protection/CommonEncryption.js"),r=n("./src/streaming/constants/ProtectionConstants.js"),i="9a04f079-9840-4286-ab92-e65be0885f95",a=r.default.PLAYREADY_KEYSTEM_STRING;function o(e){var u="utf-16",c=(e=e||{}).BASE64;function d(){if(!c||!c.hasOwnProperty("decodeArray")||!c.hasOwnProperty("decodeArray"))throw new Error("Missing config parameter(s)")}return{uuid:i,schemeIdURI:"urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95",systemString:a,getInitData:function(e){var t,n,r,i,a,o=new Uint8Array([112,115,115,104,0,0,0,0]),s=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),l=0,u=null;if(d(),!e)return null;if("pssh"in e)return h.default.parseInitDataFromContentProtection(e,c);if("pro"in e)u=c.decodeArray(e.pro.__text);else{if(!("prheader"in e))return null;u=c.decodeArray(e.prheader.__text)}return t=u.length,n=4+o.length+s.length+4+t,r=new ArrayBuffer(n),i=new Uint8Array(r),(a=new DataView(r)).setUint32(l,n),l+=4,i.set(o,l),l+=o.length,i.set(s,l),l+=s.length,a.setUint32(l,t),l+=4,i.set(u,l),l+=t,i.buffer},getRequestHeadersFromMessage:function(e){var t,n,r={},i=new DOMParser,a="utf-16"===u?new Uint16Array(e):new Uint8Array(e);t=String.fromCharCode.apply(null,a);for(var o=(n=i.parseFromString(t,"application/xml")).getElementsByTagName("name"),s=n.getElementsByTagName("value"),l=0;l<o.length;l++)r[o[l].childNodes[0].nodeValue]=s[l].childNodes[0].nodeValue;return r.hasOwnProperty("Content")&&(r["Content-Type"]=r.Content,delete r.Content),r.hasOwnProperty("Content-Type")||(r["Content-Type"]="text/xml; charset=utf-8"),r},getLicenseRequestFromMessage:function(e){var t=null,n=new DOMParser,r="utf-16"===u?new Uint16Array(e):new Uint8Array(e);d();var i=String.fromCharCode.apply(null,r),a=n.parseFromString(i,"application/xml");if(!a.getElementsByTagName("PlayReadyKeyMessage")[0])return e;var o=a.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue;return o&&(t=c.decode(o)),t},getLicenseServerURLFromInitData:function(e){if(e)for(var t=new DataView(e),n=t.getUint16(4,!0),r=6,i=new DOMParser,a=0;a<n;a++){var o=t.getUint16(r,!0);r+=2;var s=t.getUint16(r,!0);if(r+=2,1===o){var l=e.slice(r,r+s),u=String.fromCharCode.apply(null,new Uint16Array(l)),c=i.parseFromString(u,"application/xml");if(c.getElementsByTagName("LA_URL")[0]){var d=c.getElementsByTagName("LA_URL")[0].childNodes[0].nodeValue;if(d)return d}if(c.getElementsByTagName("LUI_URL")[0]){var h=c.getElementsByTagName("LUI_URL")[0].childNodes[0].nodeValue;if(h)return h}}else r+=s}return null},getCDMData:function(e){var t,n,r,i;if(d(),!e)return null;for(t=[],i=0;i<e.length;++i)t.push(e.charCodeAt(i)),t.push(0);for(t=String.fromCharCode.apply(null,t),t=c.encode(t),n='<PlayReadyCDMData type="LicenseAcquisition"><LicenseAcquisition version="1.0" Proactive="false"><CustomData encoding="base64encoded">%CUSTOMDATA%</CustomData></LicenseAcquisition></PlayReadyCDMData>'.replace("%CUSTOMDATA%",t),r=[],i=0;i<n.length;++i)r.push(n.charCodeAt(i)),r.push(0);return new Uint8Array(r).buffer},setPlayReadyMessageFormat:function(e){if("utf-8"!==e&&"utf-16"!==e)throw new Error('Specified message format is not one of "utf-8" or "utf-16"');u=e}}}o.__dashjs_factory_name="KeySystemPlayReady",t.default=dashjs.FactoryMaker.getSingletonFactory(o)},"./src/streaming/protection/drm/KeySystemW3CClearKey.js":function(e,t,n){n.r(t);var u=n("./src/streaming/protection/vo/KeyPair.js"),c=n("./src/streaming/protection/vo/ClearKeyKeySet.js"),r=n("./src/streaming/protection/CommonEncryption.js"),i=n("./src/streaming/constants/ProtectionConstants.js"),a="1077efec-c0b2-4d02-ace3-3c1e52e2fb4b",o=i.default.CLEARKEY_KEYSTEM_STRING;function s(e){var t,n=e.BASE64,l=e.debug.getLogger(t);return t={uuid:a,schemeIdURI:"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b",systemString:o,getInitData:function(e){return r.default.parseInitDataFromContentProtection(e,n)},getRequestHeadersFromMessage:function(){return null},getLicenseRequestFromMessage:function(e){return new Uint8Array(e)},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null},getClearKeysFromProtectionData:function(e,t){var n=null;if(e){for(var r=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(t))),i=[],a=0;a<r.kids.length;a++){var o=r.kids[a],s=e.clearkeys&&e.clearkeys.hasOwnProperty(o)?e.clearkeys[o]:null;if(!s)throw new Error("DRM: ClearKey keyID ("+o+") is not known!");i.push(new u.default(o,s))}n=new c.default(i),l.warn("ClearKey schemeIdURI is using W3C Common PSSH systemID (1077efec-c0b2-4d02-ace3-3c1e52e2fb4b) in Content Protection. See DASH-IF IOP v4.1 section 7.6.2.4")}return n}}}s.__dashjs_factory_name="KeySystemW3CClearKey",t.default=dashjs.FactoryMaker.getSingletonFactory(s)},"./src/streaming/protection/drm/KeySystemWidevine.js":function(e,t,n){n.r(t);var r=n("./src/streaming/protection/CommonEncryption.js"),i=n("./src/streaming/constants/ProtectionConstants.js"),a="edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",o=i.default.WIDEVINE_KEYSTEM_STRING;function s(e){var t=(e=e||{}).BASE64;return{uuid:a,schemeIdURI:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",systemString:o,getInitData:function(e){return r.default.parseInitDataFromContentProtection(e,t)},getRequestHeadersFromMessage:function(){return null},getLicenseRequestFromMessage:function(e){return new Uint8Array(e)},getLicenseServerURLFromInitData:function(){return null},getCDMData:function(){return null}}}s.__dashjs_factory_name="KeySystemWidevine",t.default=dashjs.FactoryMaker.getSingletonFactory(s)},"./src/streaming/protection/errors/ProtectionErrors.js":function(e,t,n){n.r(t);var r=n("./src/core/errors/ErrorsBase.js");function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=s(r);if(i){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}(this,e)}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=new(function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(n,r["default"]);var t=o(n);function n(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=t.call(this)).MEDIA_KEYERR_CODE=100,e.MEDIA_KEYERR_UNKNOWN_CODE=101,e.MEDIA_KEYERR_CLIENT_CODE=102,e.MEDIA_KEYERR_SERVICE_CODE=103,e.MEDIA_KEYERR_OUTPUT_CODE=104,e.MEDIA_KEYERR_HARDWARECHANGE_CODE=105,e.MEDIA_KEYERR_DOMAIN_CODE=106,e.MEDIA_KEY_MESSAGE_ERROR_CODE=107,e.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_CODE=108,e.SERVER_CERTIFICATE_UPDATED_ERROR_CODE=109,e.KEY_STATUS_CHANGED_EXPIRED_ERROR_CODE=110,e.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_CODE=111,e.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE=112,e.KEY_SESSION_CREATED_ERROR_CODE=113,e.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE=114,e.MEDIA_KEYERR_UNKNOWN_MESSAGE="An unspecified error occurred. This value is used for errors that don't match any of the other codes.",e.MEDIA_KEYERR_CLIENT_MESSAGE="The Key System could not be installed or updated.",e.MEDIA_KEYERR_SERVICE_MESSAGE="The message passed into update indicated an error from the license service.",e.MEDIA_KEYERR_OUTPUT_MESSAGE="There is no available output device with the required characteristics for the content protection system.",e.MEDIA_KEYERR_HARDWARECHANGE_MESSAGE="A hardware configuration change caused a content protection error.",e.MEDIA_KEYERR_DOMAIN_MESSAGE="An error occurred in a multi-device domain licensing configuration. The most common error is a failure to join the domain.",e.MEDIA_KEY_MESSAGE_ERROR_MESSAGE="Multiple key sessions were creates with a user-agent that does not support sessionIDs!! Unpredictable behavior ahead!",e.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_MESSAGE="DRM: Empty key message from CDM",e.SERVER_CERTIFICATE_UPDATED_ERROR_MESSAGE="Error updating server certificate -- ",e.KEY_STATUS_CHANGED_EXPIRED_ERROR_MESSAGE="DRM: KeyStatusChange error! -- License has expired",e.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_MESSAGE="DRM: No license server URL specified!",e.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE="DRM: KeySystem Access Denied! -- ",e.KEY_SESSION_CREATED_ERROR_MESSAGE="DRM: unable to create session! --",e.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE="DRM: licenser error! --",e}return n}());t.default=l},"./src/streaming/protection/models/ProtectionModel_01b.js":function(e,t,n){n.r(t);var b=n("./src/streaming/protection/controllers/ProtectionKeyController.js"),E=n("./src/streaming/protection/vo/NeedKey.js"),T=n("./src/streaming/vo/DashJSError.js"),A=n("./src/streaming/protection/vo/KeyMessage.js"),w=n("./src/streaming/protection/vo/KeySystemConfiguration.js"),S=n("./src/streaming/protection/vo/KeySystemAccess.js"),C=n("./src/streaming/protection/errors/ProtectionErrors.js");function r(e){e=e||{};var t,o,g,i,v,s,l,u,n,r=this.context,y=e.eventBus,_=e.events,a=e.debug,c=e.api,d=e.errHandler;function h(){g&&m();for(var e=0;e<l.length;e++)f(l[e]);y.trigger(_.TEARDOWN_COMPLETE)}function f(t){try{g[c.cancelKeyRequest](i.systemString,t.sessionId)}catch(e){y.trigger(_.KEY_SESSION_CLOSED,{data:null,error:"Error closing session ("+t.sessionId+") "+e.message})}}function p(e,t){if(t&&e){for(var n=e.length,r=0;r<n;r++)if(e[r].sessionId==t)return e[r];return null}return null}function m(){g.removeEventListener(c.keyerror,n),g.removeEventListener(c.needkey,n),g.removeEventListener(c.keymessage,n),g.removeEventListener(c.keyadded,n)}return t={getAllInitData:function(){for(var e=[],t=0;t<s.length;t++)e.push(s[t].initData);for(var n=0;n<l.length;n++)e.push(l[n].initData);return e},getSessions:function(){return l.concat(s)},requestKeySystemAccess:function(m){return new Promise(function(e,t){var n=g;n=n||document.createElement("video");for(var r=!1,i=0;i<m.length;i++)for(var a=m[i].ks.systemString,o=m[i].configs,s=null,l=0;l<o.length;l++){var u=o[l].videoCapabilities;if(u&&0!==u.length){s=[];for(var c=0;c<u.length;c++)""!==n.canPlayType(u[c].contentType,a)&&s.push(u[c])}if(s&&(!s||0!==s.length)){r=!0;var d=new w.default(null,s),h=v.getKeySystemBySystemString(a),f=new S.default(h,d);y.trigger(_.KEY_SYSTEM_ACCESS_COMPLETE,{data:f}),e({data:f});break}}if(!r){var p="Key system access denied! -- No valid audio/video content configurations detected!";y.trigger(_.KEY_SYSTEM_ACCESS_COMPLETE,{error:p}),t({error:p})}})},selectKeySystem:function(e){return i=e.keySystem,Promise.resolve(i)},setMediaElement:function(e){if(g!==e){if(g){m();for(var t=0;t<l.length;t++)f(l[t]);l=[]}(g=e)&&(g.addEventListener(c.keyerror,n),g.addEventListener(c.needkey,n),g.addEventListener(c.keymessage,n),g.addEventListener(c.keyadded,n),y.trigger(_.VIDEO_ELEMENT_SELECTED))}},createKeySession:function(e){if(!i)throw new Error("Can not create sessions until you have selected a key system");if(u||0===l.length){var t={sessionId:null,keyId:e.keyId,initData:e.initData,getKeyId:function(){return this.keyId},getSessionId:function(){return this.sessionId},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"}};return s.push(t),g[c.generateKeyRequest](i.systemString,new Uint8Array(e.initData)),t}throw new Error("Multiple sessions not allowed!")},updateKeySession:function(e,t){var n=e.sessionId;if(v.isClearKey(i))for(var r=0;r<t.keyPairs.length;r++)g[c.addKey](i.systemString,t.keyPairs[r].key,t.keyPairs[r].keyID,n);else g[c.addKey](i.systemString,new Uint8Array(t),new Uint8Array(e.initData),n);y.trigger(_.KEY_SESSION_UPDATED)},closeKeySession:f,setServerCertificate:function(){},loadKeySession:function(){},removeKeySession:function(){},stop:h,reset:h},o=a.getLogger(t),i=g=null,s=[],l=[],v=Object(b.default)(r).getInstance(),n={handleEvent:function(e){var t=null;switch(e.type){case c.needkey:var n=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;y.trigger(_.NEED_KEY,{key:new E.default(n,"cenc")});break;case c.keyerror:if(t=(t=p(l,e.sessionId))||p(s,e.sessionId)){var r=C.default.MEDIA_KEYERR_CODE,i="";switch(e.errorCode.code){case 1:r=C.default.MEDIA_KEYERR_UNKNOWN_CODE,i+="MEDIA_KEYERR_UNKNOWN - "+C.default.MEDIA_KEYERR_UNKNOWN_MESSAGE;break;case 2:r=C.default.MEDIA_KEYERR_CLIENT_CODE,i+="MEDIA_KEYERR_CLIENT - "+C.default.MEDIA_KEYERR_CLIENT_MESSAGE;break;case 3:r=C.default.MEDIA_KEYERR_SERVICE_CODE,i+="MEDIA_KEYERR_SERVICE - "+C.default.MEDIA_KEYERR_SERVICE_MESSAGE;break;case 4:r=C.default.MEDIA_KEYERR_OUTPUT_CODE,i+="MEDIA_KEYERR_OUTPUT - "+C.default.MEDIA_KEYERR_OUTPUT_MESSAGE;break;case 5:r=C.default.MEDIA_KEYERR_HARDWARECHANGE_CODE,i+="MEDIA_KEYERR_HARDWARECHANGE - "+C.default.MEDIA_KEYERR_HARDWARECHANGE_MESSAGE;break;case 6:r=C.default.MEDIA_KEYERR_DOMAIN_CODE,i+="MEDIA_KEYERR_DOMAIN - "+C.default.MEDIA_KEYERR_DOMAIN_MESSAGE}i+="  System Code = "+e.systemCode,y.trigger(_.KEY_ERROR,{error:new T.default(r,i,t)})}else o.error("No session token found for key error");break;case c.keyadded:(t=(t=p(l,e.sessionId))||p(s,e.sessionId))?(o.debug("DRM: Key added."),y.trigger(_.KEY_ADDED,{data:t})):o.debug("No session token found for key added");break;case c.keymessage:if((u=null!==e.sessionId&&void 0!==e.sessionId)?!(t=p(l,e.sessionId))&&0<s.length&&(t=s.shift(),l.push(t),t.sessionId=e.sessionId,y.trigger(_.KEY_SESSION_CREATED,{data:t})):0<s.length&&(t=s.shift(),l.push(t),0!==s.length&&d.error(new T.default(C.default.MEDIA_KEY_MESSAGE_ERROR_CODE,C.default.MEDIA_KEY_MESSAGE_ERROR_MESSAGE))),t){var a=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;t.keyMessage=a,y.trigger(_.INTERNAL_KEY_MESSAGE,{data:new A.default(t,a,e.defaultURL)})}else o.warn("No session token found for key message")}}},t}r.__dashjs_factory_name="ProtectionModel_01b",t.default=dashjs.FactoryMaker.getClassFactory(r)},"./src/streaming/protection/models/ProtectionModel_21Jan2015.js":function(e,t,n){n.r(t);var v=n("./src/streaming/protection/controllers/ProtectionKeyController.js"),y=n("./src/streaming/protection/vo/NeedKey.js"),_=n("./src/streaming/protection/errors/ProtectionErrors.js"),b=n("./src/streaming/vo/DashJSError.js"),E=n("./src/streaming/protection/vo/KeyMessage.js"),T=n("./src/streaming/protection/vo/KeySystemAccess.js"),A=n("./src/streaming/constants/ProtectionConstants.js");function r(e){e=e||{};var t,a,o,i,s,l,u,r,n=this.context,c=e.eventBus,d=e.events,h=e.debug;function f(e){var t=e.session;return t.removeEventListener("keystatuseschange",e),t.removeEventListener("message",e),t.close()}function p(e){for(var t=0;t<l.length;t++)if(l[t]===e){l.splice(t,1);break}}function m(e){var t,n;return e&&0<e.length&&(e[0]&&("string"==typeof e[0]?t=e[0]:n=e[0]),e[1]&&("string"==typeof e[1]?t=e[1]:n=e[1])),{status:t,keyId:n}}function g(t,e){var n={session:t,keyId:e.keyId,initData:e.initData,sessionId:e.sessionId,sessionType:e.sessionType,handleEvent:function(e){switch(e.type){case"keystatuseschange":c.trigger(d.KEY_STATUSES_CHANGED,{data:this}),e.target.keyStatuses.forEach(function(){var e=m(arguments);switch(e.status){case"expired":c.trigger(d.INTERNAL_KEY_STATUS_CHANGED,{error:new b.default(_.default.KEY_STATUS_CHANGED_EXPIRED_ERROR_CODE,_.default.KEY_STATUS_CHANGED_EXPIRED_ERROR_MESSAGE)});break;default:c.trigger(d.INTERNAL_KEY_STATUS_CHANGED,e)}});break;case"message":var t=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;c.trigger(d.INTERNAL_KEY_MESSAGE,{data:new E.default(this,t,void 0,e.messageType)})}},getKeyId:function(){return this.keyId},getSessionId:function(){return t.sessionId},getSessionType:function(){return this.sessionType},getExpirationTime:function(){return t.expiration},getKeyStatuses:function(){return t.keyStatuses},getUsable:function(){var e=!1;return t.keyStatuses.forEach(function(){"usable"===m(arguments).status&&(e=!0)}),e}};return t.addEventListener("keystatuseschange",n),t.addEventListener("message",n),t.closed.then(function(){p(n),a.debug("DRM: Session closed.  SessionID = "+n.getSessionId()),c.trigger(d.KEY_SESSION_CLOSED,{data:n.getSessionId()})}),l.push(n),n}return t={getAllInitData:function(){for(var e=[],t=0;t<l.length;t++)l[t].initData&&e.push(l[t].initData);return e},getSessions:function(){return l},requestKeySystemAccess:function(n){return new Promise(function(e,t){!function n(r,i,a,o){if(void 0===navigator.requestMediaKeySystemAccess||"function"!=typeof navigator.requestMediaKeySystemAccess){var e="Insecure origins are not allowed";return c.trigger(d.KEY_SYSTEM_ACCESS_COMPLETE,{error:e}),void o({error:e})}var s=r[i].ks;var t=r[i].configs;var l=s.systemString;l===A.default.PLAYREADY_KEYSTEM_STRING&&"required"===t[0].persistentState&&(l+=".recommendation");navigator.requestMediaKeySystemAccess(l,t).then(function(e){var t="function"==typeof e.getConfiguration?e.getConfiguration():null,n=new T.default(s,t);n.mksa=e,c.trigger(d.KEY_SYSTEM_ACCESS_COMPLETE,{data:n}),a({data:n})}).catch(function(e){if(i+1<r.length)n(r,i+1,a,o);else{var t="Key system access denied! ";c.trigger(d.KEY_SYSTEM_ACCESS_COMPLETE,{error:t+e.message}),o({error:t+e.message})}})}(n,0,e,t)})},selectKeySystem:function(n){return new Promise(function(e,t){n.mksa.createMediaKeys().then(function(e){return o=n.keySystem,s=e,i?i.setMediaKeys(s):Promise.resolve()}).then(function(){e(o)}).catch(function(){t({error:"Error selecting keys system ("+n.keySystem.systemString+")! Could not create MediaKeys -- TODO"})})})},setMediaElement:function(e){i!==e&&(i&&(i.removeEventListener("encrypted",u),i.setMediaKeys&&i.setMediaKeys(null)),(i=e)&&(i.addEventListener("encrypted",u),i.setMediaKeys&&s&&i.setMediaKeys(s)))},setServerCertificate:function(e){if(!o||!s)throw new Error("Can not set server certificate until you have selected a key system");s.setServerCertificate(e).then(function(){a.info("DRM: License server certificate successfully updated."),c.trigger(d.SERVER_CERTIFICATE_UPDATED)}).catch(function(e){c.trigger(d.SERVER_CERTIFICATE_UPDATED,{error:new b.default(_.default.SERVER_CERTIFICATE_UPDATED_ERROR_CODE,_.default.SERVER_CERTIFICATE_UPDATED_ERROR_MESSAGE+e.name)})})},createKeySession:function(e){if(!o||!s)throw new Error("Can not create sessions until you have selected a key system");var t=s.createSession(e.sessionType),n=g(t,e),r=o.systemString===A.default.CLEARKEY_KEYSTEM_STRING&&(e.initData||e.protData&&e.protData.clearkeys)?A.default.INITIALIZATION_DATA_TYPE_KEYIDS:A.default.INITIALIZATION_DATA_TYPE_CENC;t.generateRequest(r,e.initData).then(function(){a.debug("DRM: Session created.  SessionID = "+n.getSessionId()),c.trigger(d.KEY_SESSION_CREATED,{data:n})}).catch(function(e){p(n),c.trigger(d.KEY_SESSION_CREATED,{data:null,error:new b.default(_.default.KEY_SESSION_CREATED_ERROR_CODE,_.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Error generating key request -- "+e.name)})})},updateKeySession:function(t,e){var n=t.session;r.isClearKey(o)&&(e=e.toJWK()),n.update(e).then(function(){c.trigger(d.KEY_SESSION_UPDATED)}).catch(function(e){c.trigger(d.KEY_ERROR,{error:new b.default(_.default.MEDIA_KEYERR_CODE,"Error sending update() message! "+e.name,t)})})},loadKeySession:function(e){if(!o||!s)throw new Error("Can not load sessions until you have selected a key system");for(var t=e.sessionId,n=0;n<l.length;n++)if(t===l[n].sessionId)return void a.warn("DRM: Ignoring session ID because we have already seen it!");var r=s.createSession(e.sessionType),i=g(r,e);r.load(t).then(function(e){e?(a.debug("DRM: Session loaded.  SessionID = "+i.getSessionId()),c.trigger(d.KEY_SESSION_CREATED,{data:i})):(p(i),c.trigger(d.KEY_SESSION_CREATED,{data:null,error:new b.default(_.default.KEY_SESSION_CREATED_ERROR_CODE,_.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Could not load session! Invalid Session ID ("+t+")")}))}).catch(function(e){p(i),c.trigger(d.KEY_SESSION_CREATED,{data:null,error:new b.default(_.default.KEY_SESSION_CREATED_ERROR_CODE,_.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Could not load session ("+t+")! "+e.name)})})},removeKeySession:function(t){t.session.remove().then(function(){a.debug("DRM: Session removed.  SessionID = "+t.getSessionId()),c.trigger(d.KEY_SESSION_REMOVED,{data:t.getSessionId()})},function(e){c.trigger(d.KEY_SESSION_REMOVED,{data:null,error:"Error removing session ("+t.getSessionId()+"). "+e.name})})},closeKeySession:function(t){f(t).catch(function(e){p(t),c.trigger(d.KEY_SESSION_CLOSED,{data:null,error:"Error closing session ("+t.getSessionId()+") "+e.name})})},stop:function(){for(var e,t=0;t<l.length;t++)(e=l[t]).getUsable()||f(e).catch(function(){p(e)})},reset:function(){var n,r=l.length;0!==r?function(){for(var t=function(e){p(e),0===l.length&&(i?(i.removeEventListener("encrypted",u),i.setMediaKeys(null).then(function(){c.trigger(d.TEARDOWN_COMPLETE)})):c.trigger(d.TEARDOWN_COMPLETE))},e=0;e<r;e++)!function(e){n.session.closed.then(function(){t(e)}),f(n).catch(function(){t(e)})}(n=l[e])}():c.trigger(d.TEARDOWN_COMPLETE)}},a=h.getLogger(t),s=i=o=null,l=[],r=Object(v.default)(n).getInstance(),u={handleEvent:function(e){switch(e.type){case"encrypted":if(e.initData){var t=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;c.trigger(d.NEED_KEY,{key:new y.default(t,e.initDataType)})}}}},t}r.__dashjs_factory_name="ProtectionModel_21Jan2015",t.default=dashjs.FactoryMaker.getClassFactory(r)},"./src/streaming/protection/models/ProtectionModel_3Feb2014.js":function(e,t,n){n.r(t);var p=n("./src/streaming/protection/controllers/ProtectionKeyController.js"),m=n("./src/streaming/protection/vo/NeedKey.js"),g=n("./src/streaming/vo/DashJSError.js"),v=n("./src/streaming/protection/errors/ProtectionErrors.js"),T=n("./src/streaming/protection/vo/KeyMessage.js"),A=n("./src/streaming/protection/vo/KeySystemConfiguration.js"),w=n("./src/streaming/protection/vo/KeySystemAccess.js");function r(e){e=e||{};var t,a,r,o,s,l,u,n,y,i=this.context,_=e.eventBus,b=e.events,c=e.debug,E=e.api;function d(){try{for(var e=0;e<u.length;e++)h(u[e]);r&&r.removeEventListener(E.needkey,n),_.trigger(b.TEARDOWN_COMPLETE)}catch(e){_.trigger(b.TEARDOWN_COMPLETE,{error:"Error tearing down key sessions and MediaKeys! -- "+e.message})}}function h(e){var t=e.session;t.removeEventListener(E.error,e),t.removeEventListener(E.message,e),t.removeEventListener(E.ready,e),t.removeEventListener(E.close,e);for(var n=0;n<u.length;n++)if(u[n]===e){u.splice(n,1);break}t[E.release]()}function f(){function e(){r.removeEventListener("loadedmetadata",t),r[E.setMediaKeys](s),_.trigger(b.VIDEO_ELEMENT_SELECTED)}var t=null;1<=r.readyState?e():(t=e.bind(this),r.addEventListener("loadedmetadata",t))}return t={getAllInitData:function(){for(var e=[],t=0;t<u.length;t++)e.push(u[t].initData);return e},getSessions:function(){return u},requestKeySystemAccess:function(v){return new Promise(function(e,t){for(var n=!1,r=0;r<v.length;r++)for(var i=v[r].ks.systemString,a=v[r].configs,o=null,s=null,l=0;l<a.length;l++){var u=a[l].audioCapabilities,c=a[l].videoCapabilities;if(u&&0!==u.length){o=[];for(var d=0;d<u.length;d++)window[E.MediaKeys].isTypeSupported(i,u[d].contentType)&&o.push(u[d])}if(c&&0!==c.length){s=[];for(var h=0;h<c.length;h++)window[E.MediaKeys].isTypeSupported(i,c[h].contentType)&&s.push(c[h])}if(!(!o&&!s||o&&0===o.length||s&&0===s.length)){n=!0;var f=new A.default(o,s),p=y.getKeySystemBySystemString(i),m=new w.default(p,f);_.trigger(b.KEY_SYSTEM_ACCESS_COMPLETE,{data:m}),e({data:m});break}}if(!n){var g="Key system access denied! -- No valid audio/video content configurations detected!";_.trigger(b.KEY_SYSTEM_ACCESS_COMPLETE,{error:g}),t({error:g})}})},selectKeySystem:function(n){return new Promise(function(e,t){try{s=n.mediaKeys=new window[E.MediaKeys](n.keySystem.systemString),o=n.keySystem,l=n,r&&f(),e(o)}catch(e){t({error:"Error selecting keys system ("+o.systemString+")! Could not create MediaKeys -- TODO"})}})},setMediaElement:function(e){r!==e&&(r&&r.removeEventListener(E.needkey,n),(r=e)&&(r.addEventListener(E.needkey,n),s&&f()))},createKeySession:function(e){if(!o||!s||!l)throw new Error("Can not create sessions until you have selected a key system");var t=null;if(l.ksConfiguration.videoCapabilities&&0<l.ksConfiguration.videoCapabilities.length&&(t=l.ksConfiguration.videoCapabilities[0]),null===t&&l.ksConfiguration.audioCapabilities&&0<l.ksConfiguration.audioCapabilities.length&&(t=l.ksConfiguration.audioCapabilities[0]),null===t)throw new Error("Can not create sessions for unknown content types.");var n=t.contentType,r=s.createSession(n,new Uint8Array(e.initData),e.cdmData?new Uint8Array(e.cdmData):null),i=function(e,t){return{session:e,keyId:t.keyId,initData:t.initData,getKeyId:function(){return this.keyId},getSessionId:function(){return this.session.sessionId},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"},handleEvent:function(e){switch(e.type){case E.error:_.trigger(b.KEY_ERROR,{error:new g.default(v.default.MEDIA_KEYERR_CODE,"KeyError",this)});break;case E.message:var t=ArrayBuffer.isView(e.message)?e.message.buffer:e.message;_.trigger(b.INTERNAL_KEY_MESSAGE,{data:new T.default(this,t,e.destinationURL)});break;case E.ready:a.debug("DRM: Key added."),_.trigger(b.KEY_ADDED);break;case E.close:a.debug("DRM: Session closed.  SessionID = "+this.getSessionId()),_.trigger(b.KEY_SESSION_CLOSED,{data:this.getSessionId()})}}}}(r,e);r.addEventListener(E.error,i),r.addEventListener(E.message,i),r.addEventListener(E.ready,i),r.addEventListener(E.close,i),u.push(i),a.debug("DRM: Session created.  SessionID = "+i.getSessionId()),_.trigger(b.KEY_SESSION_CREATED,{data:i})},updateKeySession:function(e,t){var n=e.session;y.isClearKey(o)?n.update(new Uint8Array(t.toJWK())):n.update(new Uint8Array(t)),_.trigger(b.KEY_SESSION_UPDATED)},closeKeySession:h,setServerCertificate:function(){},loadKeySession:function(){},removeKeySession:function(){},stop:d,reset:d},a=c.getLogger(t),l=s=o=r=null,u=[],y=Object(p.default)(i).getInstance(),n={handleEvent:function(e){switch(e.type){case E.needkey:if(e.initData){var t=ArrayBuffer.isView(e.initData)?e.initData.buffer:e.initData;_.trigger(b.NEED_KEY,{key:new m.default(t,"cenc")})}}}},t}r.__dashjs_factory_name="ProtectionModel_3Feb2014",t.default=dashjs.FactoryMaker.getClassFactory(r)},"./src/streaming/protection/servers/ClearKey.js":function(e,t,n){n.r(t);var o=n("./src/streaming/protection/vo/KeyPair.js"),s=n("./src/streaming/protection/vo/ClearKeyKeySet.js");function r(){return{getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(){return"json"},getLicenseMessage:function(e){if(!e.hasOwnProperty("keys"))return null;for(var t=[],n=0;n<e.keys.length;n++){var r=e.keys[n],i=r.kid.replace(/=/g,""),a=r.k.replace(/=/g,"");t.push(new o.default(i,a))}return new s.default(t)},getErrorResponse:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}}}r.__dashjs_factory_name="ClearKey",t.default=dashjs.FactoryMaker.getSingletonFactory(r)},"./src/streaming/protection/servers/DRMToday.js":function(e,t,n){n.r(t);var i=n("./src/streaming/constants/ProtectionConstants.js");function r(e){var n=(e=e||{}).BASE64,r={};return r[i.default.WIDEVINE_KEYSTEM_STRING]={responseType:"json",getLicenseMessage:function(e){return n.decodeArray(e.license)},getErrorResponse:function(e){return e}},r[i.default.PLAYREADY_KEYSTEM_STRING]={responseType:"arraybuffer",getLicenseMessage:function(e){return e},getErrorResponse:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}},{getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(e){return r[e].responseType},getLicenseMessage:function(e,t){return function(){if(!n||!n.hasOwnProperty("decodeArray"))throw new Error("Missing config parameter(s)")}(),r[t].getLicenseMessage(e)},getErrorResponse:function(e,t){return r[t].getErrorResponse(e)}}}r.__dashjs_factory_name="DRMToday",t.default=dashjs.FactoryMaker.getSingletonFactory(r)},"./src/streaming/protection/servers/PlayReady.js":function(e,t,n){function r(){var m="http://schemas.xmlsoap.org/soap/envelope/";function g(e){var t=String.fromCharCode.apply(null,new Uint8Array(e));return decodeURIComponent(escape(t))}return{getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(){return"arraybuffer"},getLicenseMessage:function(e){return function(e){if(window.DOMParser){var t=g(e),n=(new window.DOMParser).parseFromString(t,"text/xml"),r=n?n.getElementsByTagNameNS(m,"Envelope")[0]:null,i=r?r.getElementsByTagNameNS(m,"Body")[0]:null;if(i?i.getElementsByTagNameNS(m,"Fault")[0]:null)return null}return e}.call(this,e)},getErrorResponse:function(e){return function(e){var t="",n="",r="",i=-1,a=-1;if(window.DOMParser){var o=g(e),s=(new window.DOMParser).parseFromString(o,"text/xml"),l=s?s.getElementsByTagNameNS(m,"Envelope")[0]:null,u=l?l.getElementsByTagNameNS(m,"Body")[0]:null,c=u?u.getElementsByTagNameNS(m,"Fault")[0]:null,d=c?c.getElementsByTagName("detail")[0]:null,h=d?d.getElementsByTagName("Exception")[0]:null,f=null;if(null===c)return o;t=(f=c.getElementsByTagName("faultstring")[0].firstChild)?f.nodeValue:null,null!==h&&(n=(f=h.getElementsByTagName("StatusCode")[0])?f.firstChild.nodeValue:null,i=(r=(f=h.getElementsByTagName("Message")[0])?f.firstChild.nodeValue:null)?r.lastIndexOf("[")+1:-1,a=r?r.indexOf("]"):-1,r=r?r.substring(i,a):"")}var p="code: ".concat(n,", name: ").concat(t);return r&&(p+=", message: ".concat(r)),p}.call(this,e)}}}n.r(t),r.__dashjs_factory_name="PlayReady",t.default=dashjs.FactoryMaker.getSingletonFactory(r)},"./src/streaming/protection/servers/Widevine.js":function(e,t,n){function r(){return{getServerURLFromMessage:function(e){return e},getHTTPMethod:function(){return"POST"},getResponseType:function(){return"arraybuffer"},getLicenseMessage:function(e){return e},getErrorResponse:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}}}n.r(t),r.__dashjs_factory_name="Widevine",t.default=dashjs.FactoryMaker.getSingletonFactory(r)},"./src/streaming/protection/vo/ClearKeyKeySet.js":function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.r(t);var i=function(){function n(e,t){if(!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t&&"persistent"!==t&&"temporary"!==t)throw new Error("Invalid ClearKey key set type!  Must be one of 'persistent' or 'temporary'");this.keyPairs=e,this.type=t}return function(e,t,n){t&&r(e.prototype,t),n&&r(e,n)}(n,[{key:"toJWK",value:function(){var e,t=this.keyPairs.length,n={keys:[]};for(e=0;e<t;e++){var r={kty:"oct",alg:"A128KW",kid:this.keyPairs[e].keyID,k:this.keyPairs[e].key};n.keys.push(r)}this.type&&(n.type=this.type);var i=JSON.stringify(n),a=i.length,o=new ArrayBuffer(a),s=new Uint8Array(o);for(e=0;e<a;e++)s[e]=i.charCodeAt(e);return o}}]),n}();t.default=i},"./src/streaming/protection/vo/KeyMessage.js":function(e,t,n){n.r(t);t.default=function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sessionToken=t,this.message=n,this.defaultURL=r,this.messageType=i||"license-request"}},"./src/streaming/protection/vo/KeyPair.js":function(e,t,n){n.r(t);t.default=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.keyID=t,this.key=n}},"./src/streaming/protection/vo/KeySystemAccess.js":function(e,t,n){n.r(t);t.default=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.keySystem=t,this.ksConfiguration=n}},"./src/streaming/protection/vo/KeySystemConfiguration.js":function(e,t,n){n.r(t);t.default=function e(t,n,r,i,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.initDataTypes=["cenc"],t&&t.length&&(this.audioCapabilities=t),n&&n.length&&(this.videoCapabilities=n),this.distinctiveIdentifier=r,this.persistentState=i,this.sessionTypes=a}},"./src/streaming/protection/vo/LicenseRequest.js":function(e,t,n){n.r(t);t.default=function e(t,n,r,i,a,o,s,l){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=t,this.method=n,this.responseType=r,this.headers=i,this.withCredentials=a,this.messageType=o,this.sessionId=s,this.data=l}},"./src/streaming/protection/vo/LicenseResponse.js":function(e,t,n){n.r(t);t.default=function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=t,this.headers=n,this.data=r}},"./src/streaming/protection/vo/MediaCapability.js":function(e,t,n){n.r(t);t.default=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.contentType=t,this.robustness=n}},"./src/streaming/protection/vo/NeedKey.js":function(e,t,n){n.r(t);t.default=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.initData=t,this.initDataType=n}},"./src/streaming/rules/DroppedFramesHistory.js":function(e,t,n){n.r(t);var r=n("./src/core/FactoryMaker.js");function i(){var l={},u={},c={};return{push:function(e,t,n){if(t){l[e]||(l[e]=[],u[e]=0,c[e]=0);var r=n&&n.droppedVideoFrames?n.droppedVideoFrames:0,i=n&&n.totalVideoFrames?n.totalVideoFrames:0,a=r-u;u[e]=r;var o=i-c;c[e]=i;var s=l[e];isNaN(t)||(s[t]?(s[t].droppedVideoFrames+=a,s[t].totalVideoFrames+=o):s[t]={droppedVideoFrames:a,totalVideoFrames:o})}},getFrameHistory:function(e){return l[e]},clearForStream:function(e){try{delete l[e],delete u[e],delete c[e]}catch(e){}},reset:function(){l={},u={},c={}}}}i.__dashjs_factory_name="DroppedFramesHistory";var a=r.default.getClassFactory(i);t.default=a},"./src/streaming/rules/RulesContext.js":function(e,t,n){n.r(t);var r=n("./src/core/FactoryMaker.js");function i(e){var t=(e=e||{}).abrController,n=e.switchHistory,r=e.droppedFramesHistory,i=e.currentRequest,a=e.useBufferOccupancyABR,o=e.useL2AABR,s=e.useLoLPABR,l=e.streamProcessor?e.streamProcessor.getScheduleController():null,u=e.streamProcessor?e.streamProcessor.getRepresentationInfo():null,c=e.videoModel?e.videoModel:null;function d(){return u?u.mediaInfo:null}return{getMediaType:function(){var e=d();return e?e.type:null},getMediaInfo:d,getDroppedFramesHistory:function(){return r},getCurrentRequest:function(){return i},getSwitchHistory:function(){return n},getStreamInfo:function(){var e=d();return e?e.streamInfo:null},getScheduleController:function(){return l},getAbrController:function(){return t},getRepresentationInfo:function(){return u},useBufferOccupancyABR:function(){return a},useL2AABR:function(){return o},useLoLPABR:function(){return s},getVideoModel:function(){return c}}}i.__dashjs_factory_name="RulesContext",t.default=r.default.getClassFactory(i)},"./src/streaming/rules/SwitchRequest.js":function(e,t,n){n.r(t);var r=n("./src/core/FactoryMaker.js"),a={DEFAULT:.5,STRONG:1,WEAK:0};function i(e,t,n){var r,i;return(r=n)!==(i=a.DEFAULT)&&r!==a.STRONG&&r!==a.WEAK||(i=r),{quality:void 0===e?-1:e,reason:void 0===t?null:t,priority:i}}i.__dashjs_factory_name="SwitchRequest";var o=r.default.getClassFactory(i);o.NO_CHANGE=-1,o.PRIORITY=a,r.default.updateClassFactory(i.__dashjs_factory_name,o),t.default=o},"./src/streaming/rules/SwitchRequestHistory.js":function(e,t,n){n.r(t);var r=n("./src/core/FactoryMaker.js"),l=n("./src/streaming/rules/SwitchRequest.js");function i(){var o=[],s=[];return{push:function(e){e.newValue===l.default.NO_CHANGE&&(e.newValue=e.oldValue),o[e.oldValue]||(o[e.oldValue]={noDrops:0,drops:0,dropSize:0});var t=e.newValue-e.oldValue,n=t<0?1:0,r=n?-t:0,i=n?0:1;if(o[e.oldValue].drops+=n,o[e.oldValue].dropSize+=r,o[e.oldValue].noDrops+=i,s.push({idx:e.oldValue,noDrop:i,drop:n,dropSize:r}),8<s.length){var a=s.shift();o[a.idx].drops-=a.drop,o[a.idx].dropSize-=a.dropSize,o[a.idx].noDrops-=a.noDrop}},getSwitchRequests:function(){return o},reset:function(){o=[],s=[]}}}i.__dashjs_factory_name="SwitchRequestHistory";var a=r.default.getClassFactory(i);t.default=a},"./src/streaming/rules/ThroughputHistory.js":function(e,t,n){n.r(t);var b=n("./src/streaming/constants/Constants.js"),r=n("./src/core/FactoryMaker.js");function i(e){var u,c,d,h,f,s=3,l=4,p=4,m=1.3,g=1.3,v=(e=e||{}).settings;function y(e,t,n,r){var i=Math.pow(.5,n/r.fast);e.fastEstimate=(1-i)*t+i*e.fastEstimate;var a=Math.pow(.5,n/r.slow);e.slowEstimate=(1-a)*t+a*e.slowEstimate,e.totalWeight+=n}function n(e,t,n){return v.get().streaming.abr.movingAverageMethod!==b.default.MOVING_AVERAGE_SLIDING_WINDOW?function(e,t){var n=e?f.throughputHalfLife:f.latencyHalfLife,r=e?d[t]:h[t];if(!r||r.totalWeight<=0)return NaN;var i=r.fastEstimate/(1-Math.pow(.5,r.totalWeight/n.fast)),a=r.slowEstimate/(1-Math.pow(.5,r.totalWeight/n.slow));return e?Math.min(i,a):Math.max(i,a)}(e,t):function(e,t,n){var r=function(e,t,n){var r,i;if(i=e?(r=u[t],n?s:l):(r=c[t],p),r){if(i>=r.length)i=r.length;else if(e)for(var a=1;a<i;++a){var o=r[r.length-a]/r[r.length-a-1];if((g<=o||o<=1/m)&&(i+=1)===r.length)break}}else i=0;return i}(e,t,n),i=(e?u:c)[t];return 0!==r&&i&&0!==i.length?(i=i.slice(-r)).reduce(function(e,t){return e+t})/i.length:NaN}(e,t,n)}function r(e,t){return n(!0,e,t)}function _(e){u[e]=u[e]||[],c[e]=c[e]||[],d[e]=d[e]||{fastEstimate:0,slowEstimate:0,totalWeight:0},h[e]=h[e]||{fastEstimate:0,slowEstimate:0,totalWeight:0}}function t(){u={},c={},d={},h={}}var i={push:function(e,t,n){if(t.trace&&t.trace.length){var r=t.tresponse.getTime()-t.trequest.getTime()||1,i=t._tfinish.getTime()-t.tresponse.getTime()||1,a=t.trace.reduce(function(e,t){return e+t.b[0]},0),o=0,s=0;if(v.get().streaming.lowLatencyEnabled){if(v.get().streaming.abr.fetchThroughputCalculationMode===b.default.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING){var l=t.trace.reduce(function(e,t){return e+t.t},0);s=Math.round(l/t.trace.length)}0===s&&(o=t.trace.reduce(function(e,t){return e+t.d},0))}else o=n?i:r+i;if(0!==o&&(s=Math.round(8*a/o)),_(e),function(e,t,n){return e===b.default.VIDEO?n<v.get().streaming.cacheLoadThresholds[b.default.VIDEO]:e===b.default.AUDIO?n<v.get().streaming.cacheLoadThresholds[b.default.AUDIO]:void 0}(e,0,i)){if(0<u[e].length&&!u[e].hasCachedEntries)return;u[e].hasCachedEntries=!0}else u[e]&&u[e].hasCachedEntries&&function(e){delete u[e],delete c[e],delete d[e],delete h[e],_(e)}(e);u[e].push(s),20<u[e].length&&u[e].shift(),c[e].push(r),20<c[e].length&&c[e].shift(),y(d[e],s,.001*i,f.throughputHalfLife),y(h[e],r,1,f.latencyHalfLife)}},getAverageThroughput:r,getSafeAverageThroughput:function(e,t){var n=r(e,t);return isNaN(n)||(n*=v.get().streaming.abr.bandwidthSafetyFactor),n},getAverageLatency:function(e){return n(!1,e)},reset:t};return f={throughputHalfLife:{fast:3,slow:8},latencyHalfLife:{fast:1,slow:2}},t(),i}i.__dashjs_factory_name="ThroughputHistory",t.default=r.default.getClassFactory(i)},"./src/streaming/rules/abr/ABRRulesCollection.js":function(e,t,n){n.r(t);var u=n("./src/streaming/rules/abr/ThroughputRule.js"),c=n("./src/streaming/rules/abr/InsufficientBufferRule.js"),d=n("./src/streaming/rules/abr/AbandonRequestsRule.js"),h=n("./src/streaming/rules/abr/DroppedFramesRule.js"),f=n("./src/streaming/rules/abr/SwitchHistoryRule.js"),p=n("./src/streaming/rules/abr/BolaRule.js"),m=n("./src/streaming/rules/abr/L2ARule.js"),g=n("./src/streaming/rules/abr/lolp/LoLpRule.js"),r=n("./src/core/FactoryMaker.js"),v=n("./src/streaming/rules/SwitchRequest.js"),y=n("./src/streaming/constants/Constants.js"),_="qualitySwitchRules",b="abandonFragmentRules";function i(e){e=e||{};var n,r,l=this.context,t=e.mediaPlayerModel,i=e.dashMetrics,a=e.settings;function o(e){return e.filter(function(e){return e.quality>v.default.NO_CHANGE})}function s(e){var t,n,r,i,a,o={},s=null;if(0!==e.length){for(o[v.default.PRIORITY.STRONG]={quality:v.default.NO_CHANGE,reason:null},o[v.default.PRIORITY.WEAK]={quality:v.default.NO_CHANGE,reason:null},o[v.default.PRIORITY.DEFAULT]={quality:v.default.NO_CHANGE,reason:null},t=0,n=e.length;t<n;t+=1)(r=e[t]).quality!==v.default.NO_CHANGE&&(o[r.priority].quality===v.default.NO_CHANGE||o[r.priority].quality>r.quality)&&(o[r.priority].quality=r.quality,o[r.priority].reason=r.reason||null);return o[v.default.PRIORITY.WEAK].quality!==v.default.NO_CHANGE&&(s=o[v.default.PRIORITY.WEAK]),o[v.default.PRIORITY.DEFAULT].quality!==v.default.NO_CHANGE&&(s=o[v.default.PRIORITY.DEFAULT]),o[v.default.PRIORITY.STRONG].quality!==v.default.NO_CHANGE&&(s=o[v.default.PRIORITY.STRONG]),s&&(i=s.quality,a=s.reason),Object(v.default)(l).create(i,a)}}return{initialize:function(){n=[],r=[],a.get().streaming.abr.useDefaultABRRules&&(a.get().streaming.abr.ABRStrategy===y.default.ABR_STRATEGY_L2A?n.push(Object(m.default)(l).create({dashMetrics:i,mediaPlayerModel:t,settings:a})):a.get().streaming.abr.ABRStrategy===y.default.ABR_STRATEGY_LoLP?n.push(Object(g.default)(l).create({dashMetrics:i})):(n.push(Object(p.default)(l).create({dashMetrics:i,mediaPlayerModel:t,settings:a})),n.push(Object(u.default)(l).create({dashMetrics:i})),a.get().streaming.abr.additionalAbrRules.insufficientBufferRule&&n.push(Object(c.default)(l).create({dashMetrics:i,settings:a})),a.get().streaming.abr.additionalAbrRules.switchHistoryRule&&n.push(Object(f.default)(l).create()),a.get().streaming.abr.additionalAbrRules.droppedFramesRule&&n.push(Object(h.default)(l).create()),a.get().streaming.abr.additionalAbrRules.abandonRequestsRule&&r.push(Object(d.default)(l).create({dashMetrics:i,mediaPlayerModel:t,settings:a})))),t.getABRCustomRules().forEach(function(e){e.type===_&&n.push(e.rule(l).create()),e.type===b&&r.push(e.rule(l).create())})},reset:function(){[n,r].forEach(function(e){e&&e.length&&e.forEach(function(e){return e.reset&&e.reset()})}),n=[],r=[]},getMaxQuality:function(t){return s(o(n.map(function(e){return e.getMaxIndex(t)})))||Object(v.default)(l).create()},getMinSwitchRequest:s,shouldAbandonFragment:function(t,n){return s(o(r.map(function(e){return e.shouldAbandon(t,n)})))||Object(v.default)(l).create()},getQualitySwitchRules:function(){return n}}}i.__dashjs_factory_name="ABRRulesCollection";var a=r.default.getClassFactory(i);a.QUALITY_SWITCH_RULES=_,a.ABANDON_FRAGMENT_RULES=b,r.default.updateSingletonFactory(i.__dashjs_factory_name,a),t.default=a},"./src/streaming/rules/abr/AbandonRequestsRule.js":function(e,t,n){n.r(t);var A=n("./src/streaming/rules/SwitchRequest.js"),r=n("./src/core/FactoryMaker.js"),i=n("./src/core/Debug.js");function w(e){e=e||{};var t,m,g,v,y,_=this.context,b=e.mediaPlayerModel,E=e.dashMetrics,T=e.settings;function n(){g={},v={},y=[]}return t={shouldAbandon:function(e){var t=Object(A.default)(_).create(A.default.NO_CHANGE,{name:w.__dashjs_factory_name});if(!(e&&e.hasOwnProperty("getMediaInfo")&&e.hasOwnProperty("getMediaType")&&e.hasOwnProperty("getCurrentRequest")&&e.hasOwnProperty("getRepresentationInfo")&&e.hasOwnProperty("getAbrController")))return t;var n=e.getMediaInfo(),r=e.getMediaType(),i=e.getStreamInfo(),a=i?i.id:null,o=e.getCurrentRequest();if(!isNaN(o.index)){if(!function(e,t){g[e]=g[e]||{},g[e][t]=g[e][t]||{}}(r,o.index),b.getStableBufferTime()<E.getCurrentBufferLevel(r))return t;var s=g[r][o.index];if(null===s||null===o.firstByteDate||v.hasOwnProperty(s.id))return t;if(void 0===s.firstByteTime&&(y[r]=[],s.firstByteTime=o.firstByteDate.getTime(),s.segmentDuration=o.duration,s.bytesTotal=o.bytesTotal,s.id=o.index),s.bytesLoaded=o.bytesLoaded,s.elapsedTime=(new Date).getTime()-s.firstByteTime,0<s.bytesLoaded&&0<s.elapsedTime&&function(e,t){y[e]=y[e]||[],y[e].push(t)}(r,Math.round(8*s.bytesLoaded/s.elapsedTime)),5<=y[r].length&&500<s.elapsedTime&&s.bytesLoaded<s.bytesTotal){var l=y[r].reduce(function(e,t){return e+t},0);if(s.measuredBandwidthInKbps=Math.round(l/y[r].length),s.estimatedTimeOfDownload=+(8*s.bytesTotal/s.measuredBandwidthInKbps/1e3).toFixed(2),s.estimatedTimeOfDownload<1.8*s.segmentDuration||0===e.getRepresentationInfo().quality)return t;if(!v.hasOwnProperty(s.id)){var u=e.getAbrController(),c=s.bytesTotal-s.bytesLoaded,d=u.getBitrateList(n),h=u.getQualityForBitrate(n,s.measuredBandwidthInKbps*T.get().streaming.abr.bandwidthSafetyFactor,a),f=u.getMinAllowedIndexFor(r,a),p=void 0!==f?Math.max(f,h):h;s.bytesTotal*d[p].bitrate/d[u.getQualityFor(r,a)].bitrate<c&&(t.quality=p,t.reason.throughput=s.measuredBandwidthInKbps,t.reason.fragmentID=s.id,v[s.id]=s,m.debug("["+r+"] frag id",s.id," is asking to abandon and switch to quality to ",p," measured bandwidth was",s.measuredBandwidthInKbps),delete g[r][s.id])}}else s.bytesLoaded===s.bytesTotal&&delete g[r][s.id]}return t},reset:n},m=Object(i.default)(_).getInstance().getLogger(t),n(),t}w.__dashjs_factory_name="AbandonRequestsRule",t.default=r.default.getClassFactory(w)},"./src/streaming/rules/abr/BolaRule.js":function(e,t,n){n.r(t);var f=n("./src/streaming/constants/MetricsConstants.js"),M=n("./src/streaming/rules/SwitchRequest.js"),r=n("./src/core/FactoryMaker.js"),p=n("./src/streaming/vo/metrics/HTTPRequest.js"),m=n("./src/core/EventBus.js"),g=n("./src/core/events/Events.js"),v=n("./src/core/Debug.js"),y=n("./src/streaming/MediaPlayerEvents.js");function i(e){e=e||{};var t,_,b,E=this.context,T=e.dashMetrics,o=e.mediaPlayerModel,n=Object(m.default)(E).getInstance();function s(e,t,r){var n=r.reduce(function(e,t,n){return t>r[e]?n:e},0);if(0===n)return null;var i=Math.max(e,10+2*t.length),a=(r[n]-1)/(i/10-1);return{gp:a,Vp:10/a}}function A(e){var t={},n=e.getMediaInfo().bitrateList.map(function(e){return e.bandwidth}),r=function(e){return e.map(function(e){return Math.log(e)})}(n);r=r.map(function(e){return e-r[0]+1});var i=o.getStableBufferTime(),a=s(i,n,r);return a?(t.state=1,t.bitrates=n,t.utilities=r,t.stableBufferTime=i,t.Vp=a.Vp,t.gp=a.gp,t.lastQuality=0,w(t)):t.state=0,t}function w(e){e.placeholderBuffer=0,e.mostAdvancedSegmentStart=NaN,e.lastSegmentWasReplacement=!1,e.lastSegmentStart=NaN,e.lastSegmentDurationS=NaN,e.lastSegmentRequestTimeMs=NaN,e.lastSegmentFinishTimeMs=NaN}function S(e,t){var n=o.getStableBufferTime();if(e.stableBufferTime!==n){var r=s(n,e.bitrates,e.utilities);if(r.Vp!==e.Vp||r.gp!==e.gp){var i=T.getCurrentBufferLevel(t),a=i+e.placeholderBuffer;a-=10,a*=r.Vp/e.Vp,a+=10,e.stableBufferTime=n,e.Vp=r.Vp,e.gp=r.gp,e.placeholderBuffer=Math.max(0,a-i)}}}function C(e,t){return e.Vp*(e.utilities[t]+e.gp)}function x(e,t){for(var n=e.bitrates[t],r=e.utilities[t],i=0,a=t-1;0<=a;--a)if(e.utilities[a]<e.utilities[t]){var o=e.bitrates[a],s=e.utilities[a],l=e.Vp*(e.gp+(n*s-o*r)/(n-o));i=Math.max(i,l)}return i}function r(){for(var e in b)b.hasOwnProperty(e)&&2===b[e].state&&(b[e].placeholderBuffer=0)}function i(){for(var e in b)if(b.hasOwnProperty(e)){var t=b[e];0!==t.state&&(t.state=1,w(t))}}function a(e){if(e&&e.chunk&&e.chunk.mediaInfo){var t=b[e.chunk.mediaInfo.type];if(t&&0!==t.state){var n=e.chunk.start;isNaN(t.mostAdvancedSegmentStart)||n>t.mostAdvancedSegmentStart?(t.mostAdvancedSegmentStart=n,t.lastSegmentWasReplacement=!1):t.lastSegmentWasReplacement=!0,t.lastSegmentStart=n,t.lastSegmentDurationS=e.chunk.duration,t.lastQuality=e.chunk.quality,u(t,e.chunk.mediaInfo.type)}}}function l(e){if(e&&e.metric===f.default.HTTP_REQUEST&&e.value&&e.value.type===p.HTTPRequest.MEDIA_SEGMENT_TYPE&&e.value.trace&&e.value.trace.length){var t=b[e.mediaType];t&&0!==t.state&&(t.lastSegmentRequestTimeMs=e.value.trequest.getTime(),t.lastSegmentFinishTimeMs=e.value._tfinish.getTime(),u(t,e.mediaType))}}function u(e,t){if(!isNaN(e.lastSegmentStart)&&!isNaN(e.lastSegmentRequestTimeMs)&&!isNaN(e.placeholderBuffer)){if(e.placeholderBuffer*=.99,!isNaN(e.lastSegmentFinishTimeMs)){var n=T.getCurrentBufferLevel(t)+.001*(e.lastSegmentFinishTimeMs-e.lastSegmentRequestTimeMs),r=C(e,e.lastQuality),i=Math.max(0,r-n);e.placeholderBuffer=Math.min(i,e.placeholderBuffer)}e.lastSegmentWasReplacement&&!isNaN(e.lastSegmentDurationS)&&(e.placeholderBuffer+=e.lastSegmentDurationS),e.lastSegmentStart=NaN,e.lastSegmentRequestTimeMs=NaN}}function c(e){if(e){var t=b[e.mediaType];t&&0!==t.state&&(t.abrQuality=e.newQuality)}}function d(e){if(e){var t=b[e.mediaType];if(t&&0!==t.state){var n,r=T.getCurrentBufferLevel(e.mediaType);n=0<t.abrQuality?x(t,t.abrQuality):10;var i=Math.max(0,n-r);t.placeholderBuffer=Math.min(t.placeholderBuffer,i)}}}function h(){b={}}return t={getMaxIndex:function(e){var t=Object(M.default)(E).create();if(!(e&&e.hasOwnProperty("getMediaInfo")&&e.hasOwnProperty("getMediaType")&&e.hasOwnProperty("getScheduleController")&&e.hasOwnProperty("getStreamInfo")&&e.hasOwnProperty("getAbrController")&&e.hasOwnProperty("useBufferOccupancyABR")))return t;var n=e.getMediaInfo(),r=e.getMediaType(),i=e.getScheduleController(),a=e.getStreamInfo(),o=e.getAbrController(),s=o.getThroughputHistory(),l=a?a.id:null,u=a&&a.manifestInfo&&a.manifestInfo.isDynamic,c=e.useBufferOccupancyABR();if(t.reason=t.reason||{},!c)return t;i.setTimeToLoadDelay(0);var d=function(e){var t=e.getMediaType(),n=b[t];return n?0!==n.state&&S(n,t):(n=A(e),b[t]=n),n}(e);if(0===d.state)return t;var h,f=T.getCurrentBufferLevel(r),p=s.getAverageThroughput(r,u),m=s.getSafeAverageThroughput(r,u),g=s.getAverageLatency(r);if(t.reason.state=d.state,t.reason.throughput=p,t.reason.latency=g,isNaN(p))return t;switch(d.state){case 1:h=o.getQualityForBitrate(n,m,l,g),t.quality=h,t.reason.throughput=m,d.placeholderBuffer=Math.max(0,x(d,h)-f),d.lastQuality=h,!isNaN(d.lastSegmentDurationS)&&f>=d.lastSegmentDurationS&&(d.state=2);break;case 2:!function(e,t){var n=Date.now();if(isNaN(e.lastSegmentFinishTimeMs)){if(!isNaN(e.lastCallTimeMs)){var r=.001*(n-e.lastCallTimeMs);e.placeholderBuffer+=Math.max(0,r)}}else{var i=.001*(n-e.lastSegmentFinishTimeMs);e.placeholderBuffer+=Math.max(0,i)}e.lastCallTimeMs=n,e.lastSegmentStart=NaN,e.lastSegmentRequestTimeMs=NaN,e.lastSegmentFinishTimeMs=NaN,S(e,t)}(d,r),h=function(e,t){for(var n=e.bitrates.length,r=NaN,i=NaN,a=0;a<n;++a){var o=(e.Vp*(e.utilities[a]+e.gp)-t)/e.bitrates[a];(isNaN(i)||i<=o)&&(i=o,r=a)}return r}(d,f+d.placeholderBuffer);var v=o.getQualityForBitrate(n,m,l,g);h>d.lastQuality&&v<h&&(h=Math.max(v,d.lastQuality));var y=Math.max(0,f+d.placeholderBuffer-C(d,h));y<=d.placeholderBuffer?(d.placeholderBuffer-=y,y=0):(y-=d.placeholderBuffer,d.placeholderBuffer=0,h<o.getMaxAllowedIndexFor(r,l)?i.setTimeToLoadDelay(1e3*y):y=0),t.quality=h,t.reason.throughput=p,t.reason.latency=g,t.reason.bufferLevel=f,t.reason.placeholderBuffer=d.placeholderBuffer,t.reason.delay=y,d.lastQuality=h;break;default:_.debug("BOLA ABR rule invoked in bad state."),t.quality=o.getQualityForBitrate(n,m,l,g),t.reason.state=d.state,t.reason.throughput=m,t.reason.latency=g,d.state=1,w(d)}return t},reset:function(){h(),n.off(y.default.BUFFER_EMPTY,r,t),n.off(y.default.PLAYBACK_SEEKING,i,t),n.off(y.default.METRIC_ADDED,l,t),n.off(y.default.QUALITY_CHANGE_REQUESTED,c,t),n.off(y.default.FRAGMENT_LOADING_ABANDONED,d,t),n.off(g.default.MEDIA_FRAGMENT_LOADED,a,t)}},_=Object(v.default)(E).getInstance().getLogger(t),h(),n.on(y.default.BUFFER_EMPTY,r,t),n.on(y.default.PLAYBACK_SEEKING,i,t),n.on(y.default.METRIC_ADDED,l,t),n.on(y.default.QUALITY_CHANGE_REQUESTED,c,t),n.on(y.default.FRAGMENT_LOADING_ABANDONED,d,t),n.on(g.default.MEDIA_FRAGMENT_LOADED,a,t),t}i.__dashjs_factory_name="BolaRule",t.default=r.default.getClassFactory(i)},"./src/streaming/rules/abr/DroppedFramesRule.js":function(e,t,n){n.r(t);var r=n("./src/core/FactoryMaker.js"),d=n("./src/streaming/rules/SwitchRequest.js"),i=n("./src/core/Debug.js");function a(){var e,u,c=this.context;return e={getMaxIndex:function(e){var t=Object(d.default)(c).create();if(!e||!e.hasOwnProperty("getDroppedFramesHistory"))return t;var n=e.getDroppedFramesHistory(),r=e.getStreamInfo().id;if(n){var i=n.getFrameHistory(r);if(!i||0===i.length)return t;for(var a=0,o=0,s=d.default.NO_CHANGE,l=1;l<i.length;l++)if(i[l]&&(a=i[l].droppedVideoFrames,375<(o=i[l].totalVideoFrames)&&.15<a/o)){s=l-1,u.debug("index: "+s+" Dropped Frames: "+a+" Total Frames: "+o);break}return Object(d.default)(c).create(s,{droppedFrames:a})}return t}},u=Object(i.default)(c).getInstance().getLogger(e),e}a.__dashjs_factory_name="DroppedFramesRule",t.default=r.default.getClassFactory(a)},"./src/streaming/rules/abr/InsufficientBufferRule.js":function(e,t,n){n.r(t);var s=n("./src/core/EventBus.js"),l=n("./src/core/events/Events.js"),r=n("./src/core/FactoryMaker.js"),u=n("./src/core/Debug.js"),E=n("./src/streaming/rules/SwitchRequest.js"),T=n("./src/streaming/constants/Constants.js"),A=n("./src/streaming/constants/MetricsConstants.js"),c=n("./src/streaming/MediaPlayerEvents.js");function i(e){e=e||{};var t,m,g,v=.5,n=2,y=this.context,r=Object(s.default)(y).getInstance(),_=e.dashMetrics,b=e.settings;function i(){(g={})[T.default.VIDEO]={ignoreCount:n},g[T.default.AUDIO]={ignoreCount:n}}function a(){i()}function o(e){isNaN(e.startTime)||e.mediaType!==T.default.AUDIO&&e.mediaType!==T.default.VIDEO||0<g[e.mediaType].ignoreCount&&g[e.mediaType].ignoreCount--}return t={getMaxIndex:function(e){var t=Object(E.default)(y).create();if(!e||!e.hasOwnProperty("getMediaType"))return t;!function(){if(!_||!_.hasOwnProperty("getCurrentBufferLevel")||!_.hasOwnProperty("getCurrentBufferState"))throw new Error(T.default.MISSING_CONFIG_ERROR)}();var n=e.getMediaType(),r=_.getCurrentBufferState(n),i=e.getRepresentationInfo().fragmentDuration,a=e.getStreamInfo(),o=a?a.id:null,s=a&&a.manifestInfo&&a.manifestInfo.isDynamic;if(function(e){return!b.get().streaming.lowLatencyEnabled&&0<g[e].ignoreCount}(n)||!i)return t;if(r&&r.state===A.default.BUFFER_EMPTY)m.debug("["+n+"] Switch to index 0; buffer is empty."),t.quality=0,t.reason="InsufficientBufferRule: Buffer is empty";else{var l=e.getMediaInfo(),u=e.getAbrController(),c=u.getThroughputHistory(),d=_.getCurrentBufferLevel(n),h=c.getAverageThroughput(n,s),f=c.getAverageLatency(n),p=h*(d/i)*v;t.quality=u.getQualityForBitrate(l,p,o,f),t.reason="InsufficientBufferRule: being conservative to avoid immediate rebuffering"}return t},reset:function(){i(),r.off(c.default.PLAYBACK_SEEKING,a,t),r.off(l.default.BYTES_APPENDED_END_FRAGMENT,o,t)}},m=Object(u.default)(y).getInstance().getLogger(t),i(),r.on(c.default.PLAYBACK_SEEKING,a,t),r.on(l.default.BYTES_APPENDED_END_FRAGMENT,o,t),t}i.__dashjs_factory_name="InsufficientBufferRule",t.default=r.default.getClassFactory(i)},"./src/streaming/rules/abr/L2ARule.js":function(e,t,n){n.r(t);var u=n("./src/streaming/constants/MetricsConstants.js"),H=n("./src/streaming/rules/SwitchRequest.js"),r=n("./src/core/FactoryMaker.js"),c=n("./src/streaming/vo/metrics/HTTPRequest.js"),d=n("./src/core/EventBus.js"),h=n("./src/core/events/Events.js"),f=n("./src/core/Debug.js"),G=n("./src/streaming/constants/Constants.js");function i(e){e=e||{};var t,L,O,N,k=this.context,B=e.dashMetrics,n=Object(d.default)(k).getInstance();function F(e){var t={},n=e.getMediaInfo(),r=n.bitrateList.map(function(e){return e.bandwidth/1e3});return t.state=1,t.bitrates=r,t.lastQuality=0,function(e){if(!e||!e.type)return;O[e.type]={},O[e.type].w=[],O[e.type].prev_w=[],O[e.type].Q=0,O[e.type].segment_request_start_s=0,O[e.type].segment_download_finish_s=0,O[e.type].B_target=1.5}(n),j(t),t}function j(e){e.placeholderBuffer=0,e.mostAdvancedSegmentStart=NaN,e.lastSegmentWasReplacement=!1,e.lastSegmentStart=NaN,e.lastSegmentDurationS=NaN,e.lastSegmentRequestTimeMs=NaN,e.lastSegmentFinishTimeMs=NaN}function r(){for(var e in L)if(L.hasOwnProperty(e)){var t=L[e];0!==t.state&&(t.state=1,j(t))}}function i(e){if(e&&e.chunk&&e.chunk.mediaInfo){var t=L[e.chunk.mediaInfo.type],n=O[e.chunk.mediaInfo.type];if(t&&0!==t.state){var r=e.chunk.start;isNaN(t.mostAdvancedSegmentStart)||r>t.mostAdvancedSegmentStart?(t.mostAdvancedSegmentStart=r,t.lastSegmentWasReplacement=!1):t.lastSegmentWasReplacement=!0,t.lastSegmentStart=r,t.lastSegmentDurationS=e.chunk.duration,t.lastQuality=e.chunk.quality,o(t,n)}}}function a(e){if(e&&e.metric===u.default.HTTP_REQUEST&&e.value&&e.value.type===c.HTTPRequest.MEDIA_SEGMENT_TYPE&&e.value.trace&&e.value.trace.length){var t=L[e.mediaType],n=O[e.mediaType];t&&0!==t.state&&(t.lastSegmentRequestTimeMs=e.value.trequest.getTime(),t.lastSegmentFinishTimeMs=e.value._tfinish.getTime(),o(t,n))}}function o(e,t){isNaN(e.lastSegmentStart)||isNaN(e.lastSegmentRequestTimeMs)||(t.segment_request_start_s=.001*e.lastSegmentRequestTimeMs,t.segment_download_finish_s=.001*e.lastSegmentFinishTimeMs,e.lastSegmentStart=NaN,e.lastSegmentRequestTimeMs=NaN)}function s(e){if(e&&e.mediaType){var t=L[e.mediaType];t&&0!==t.state&&(t.abrQuality=e.newQuality)}}function U(e,t){if(e.length!==t.length)return-1;for(var n=0,r=0;r<e.length;r++)n+=e[r]*t[r];return n}function l(){L={},O={}}return t={getMaxIndex:function(e){var t,n=Object(H.default)(k).create(),r=Math.pow(4,.99),i=Math.max(Math.pow(4,1),r*Math.sqrt(4)),a=e.getMediaInfo(),o=e.getMediaType(),s=a.bitrateList.map(function(e){return e.bandwidth}),l=s.length,u=e.getScheduleController(),c=e.getStreamInfo(),d=e.getAbrController(),h=d.getThroughputHistory(),f=c&&c.manifestInfo&&c.manifestInfo.isDynamic,p=e.useL2AABR(),m=B.getCurrentBufferLevel(o,!0),g=h.getSafeAverageThroughput(o,f),v=h.getAverageThroughput(o,f),y=h.getAverageLatency(o),_=e.getVideoModel().getPlaybackRate();if(!(e&&e.hasOwnProperty("getMediaInfo")&&e.hasOwnProperty("getMediaType")&&e.hasOwnProperty("getScheduleController")&&e.hasOwnProperty("getStreamInfo")&&e.hasOwnProperty("getAbrController")&&e.hasOwnProperty("useL2AABR")))return n;if(n.reason=n.reason||{},!p||o===G.default.AUDIO)return n;u.setTimeToLoadDelay(0);var b=function(e){var t=e.getMediaType(),n=L[t];return n||(n=F(e),L[t]=n),n}(e);if(0===b.state)return n;var E=O[o];if(!E)return n;if(n.reason.state=b.state,n.reason.throughput=v,n.reason.latency=y,isNaN(v))return n;switch(b.state){case 1:if(t=d.getQualityForBitrate(a,g,c.id,y),n.quality=t,n.reason.throughput=g,b.lastQuality=t,!isNaN(b.lastSegmentDurationS)&&m>=E.B_target){b.state=2,E.Q=r;for(var T=0;T<l;++T)T===b.lastQuality?E.prev_w[T]=1:E.prev_w[T]=0}break;case 2:var A=[],w=B.getCurrentHttpRequest(o).trace.reduce(function(e,t){return e+t.d},0),S=B.getCurrentHttpRequest(o).trace.reduce(function(e,t){return e+t.b[0]},0),C=Math.round(8*S/w);C<1&&(C=1);for(var x=b.lastSegmentDurationS,M=1,R=0;R<l;++R)s[R]=s[R]/1e3,_*s[R]>C&&(M=-1),E.w[R]=E.prev_w[R]+M*(x/(2*i))*((E.Q+r)*(_*s[R]/C));E.w=function(e){for(var t=e.length,n=!1,r=[],i=0;i<t;++i)r[i]=e[i];for(var a=e.sort(function(e,t){return t-e}),o=0,s=0,l=[],u=0;u<t-1;++u)if((s=((o+=a[u])-1)/(u+1))>=a[u+1]){n=!0;break}n||(s=(o+a[t-1]-1)/t);for(var c=0;c<t;++c)l[c]=Math.max(r[c]-s,0);return l}(E.w);for(var I=0;I<l;++I)A[I]=E.w[I]-E.prev_w[I],E.prev_w[I]=E.w[I];E.Q=Math.max(0,E.Q-x+x*_*((U(s,E.prev_w)+U(s,A))/C));for(var P=[],D=0;D<l;++D)P[D]=Math.abs(s[D]-U(E.w,s));(t=P.indexOf(Math.min.apply(Math,P)))>b.lastQuality&&s[b.lastQuality+1]<=C&&(t=b.lastQuality+1),s[t]>=C&&(E.Q=2*Math.max(r,E.Q)),n.quality=t,n.reason.throughput=v,n.reason.latency=y,n.reason.bufferLevel=m,b.lastQuality=n.quality;break;default:N.debug("L2A ABR rule invoked in bad state."),n.quality=d.getQualityForBitrate(a,g,c.id,y),n.reason.state=b.state,n.reason.throughput=g,n.reason.latency=y,b.state=1,j(b)}return n},reset:function(){l(),n.off(h.default.PLAYBACK_SEEKING,r,t),n.off(h.default.MEDIA_FRAGMENT_LOADED,i,t),n.off(h.default.METRIC_ADDED,a,t),n.off(h.default.QUALITY_CHANGE_REQUESTED,s,t)}},N=Object(f.default)(k).getInstance().getLogger(t),l(),n.on(h.default.PLAYBACK_SEEKING,r,t),n.on(h.default.MEDIA_FRAGMENT_LOADED,i,t),n.on(h.default.METRIC_ADDED,a,t),n.on(h.default.QUALITY_CHANGE_REQUESTED,s,t),t}i.__dashjs_factory_name="L2ARule",t.default=r.default.getClassFactory(i)},"./src/streaming/rules/abr/SwitchHistoryRule.js":function(e,t,n){n.r(t);var r=n("./src/core/FactoryMaker.js"),i=n("./src/core/Debug.js"),c=n("./src/streaming/rules/SwitchRequest.js");function a(){var e,l,u=this.context;return e={getMaxIndex:function(e){for(var t=e?e.getSwitchHistory():null,n=t?t.getSwitchRequests():[],r=0,i=0,a=0,o=Object(c.default)(u).create(),s=0;s<n.length;s++)if(void 0!==n[s]&&(r+=n[s].drops,i+=n[s].noDrops,a+=n[s].dropSize,6<=r+i&&.075<r/i)){o.quality=0<s&&0<n[s].drops?s-1:s,o.reason={index:o.quality,drops:r,noDrops:i,dropSize:a},l.debug("Switch history rule index: "+o.quality+" samples: "+(r+i)+" drops: "+r);break}return o}},l=Object(i.default)(u).getInstance().getLogger(e),e}a.__dashjs_factory_name="SwitchHistoryRule",t.default=r.default.getClassFactory(a)},"./src/streaming/rules/abr/ThroughputRule.js":function(e,t,n){n.r(t);var r=n("./src/core/FactoryMaker.js"),g=n("./src/streaming/rules/SwitchRequest.js"),v=n("./src/streaming/constants/Constants.js"),y=n("./src/streaming/constants/MetricsConstants.js");function i(e){e=e||{};var p=this.context,m=e.dashMetrics;return{getMaxIndex:function(e){var t=Object(g.default)(p).create();if(!(e&&e.hasOwnProperty("getMediaInfo")&&e.hasOwnProperty("getMediaType")&&e.hasOwnProperty("useBufferOccupancyABR")&&e.hasOwnProperty("getAbrController")&&e.hasOwnProperty("getScheduleController")))return t;!function(){if(!m||!m.hasOwnProperty("getCurrentBufferState"))throw new Error(v.default.MISSING_CONFIG_ERROR)}();var n=e.getMediaInfo(),r=e.getMediaType(),i=m.getCurrentBufferState(r),a=e.getScheduleController(),o=e.getAbrController(),s=e.getStreamInfo(),l=s?s.id:null,u=s&&s.manifestInfo?s.manifestInfo.isDynamic:null,c=o.getThroughputHistory(),d=c.getSafeAverageThroughput(r,u),h=c.getAverageLatency(r),f=e.useBufferOccupancyABR();return isNaN(d)||!i||f||o.getAbandonmentStateFor(l,r)!==y.default.ABANDON_LOAD&&(i.state!==y.default.BUFFER_LOADED&&!u||(t.quality=o.getQualityForBitrate(n,d,l,h),a.setTimeToLoadDelay(0),t.reason={throughput:d,latency:h})),t},reset:function(){}}}i.__dashjs_factory_name="ThroughputRule",t.default=r.default.getClassFactory(i)},"./src/streaming/rules/abr/lolp/LearningAbrController.js":function(e,t,n){n.r(t);var r=n("./src/core/FactoryMaker.js"),i=n("./src/core/Debug.js"),j="manual_weight_selection",U="random_weight_selection",H="dynamic_weight_selection";function a(){var e,x,M,R,I,P,D,L,O,t=this.context;function n(){R=1,I=100,P=0,L=D=M=null,O=H}function N(){var e=0;if(M)for(var t=0;t<M.length;t++){var n=M[t];n.state.throughput>e&&(e=n.state.throughput)}return e}function k(e,n,r){var t=e.map(function(e,t){return r[t]*Math.pow(e-n[t],2)}).reduce(function(e,t){return e+t});return(t<0?-1:1)*Math.sqrt(Math.abs(t))}function B(e,t,n){for(var r=0;r<t.length;r++){var i=t[r],a=(s=e,k([(o=i).state.throughput,o.state.latency,o.state.rebuffer,o.state.switch],[s.state.throughput,s.state.latency,s.state.rebuffer,s.state.switch],[1,1,1,1]));l(i,n,Math.exp(-1*Math.pow(a,2)/(2*Math.pow(.1,2))))}var o,s}function l(e,t,n){var r=e.state,i=[.01,.01,.01,.01];r.throughput=r.throughput+(t[0]-r.throughput)*i[0]*n,r.latency=r.latency+(t[1]-r.latency)*i[1]*n,r.rebuffer=r.rebuffer+(t[2]-r.rebuffer)*i[2]*n,r.switch=r.switch+(t[3]-r.switch)*i[3]*n}function F(e,t,n,r,i,a,o){D=D||L[L.length-1];var s=e.findWeightVector(t,n,r,i,a,o);null!==s&&-1!==s&&(D=s)}return e={getNextQuality:function(e,t,n,r,i,a,o){var s=n,l=r,u=t,c=function(e){if(!M){M=[];var t=e.bitrateList,n=[];P=t[0].bandwidth,t.forEach(function(e){n.push(e.bandwidth),e.bandwidth<P&&(P=e.bandwidth)}),R=function(e){var t=e.map(function(e){return Math.pow(e,2)}).reduce(function(e,t){return e+t});return Math.sqrt(t)}(n);for(var r=0;r<t.length;r++){var i={qualityIndex:r,bitrate:t[r].bandwidth,state:{throughput:t[r].bandwidth/R,latency:0,rebuffer:0,switch:0}};M.push(i)}L=function(e){var t=[],n=function(e){for(var t=[],n=0;n<e;n++){var r=[Math.random()*N(),Math.random(),Math.random(),Math.random()];t.push(r)}return t}(Math.pow(e.length,2));t.push(n[0]);for(var r=[1,1,1,1],i=1;i<e.length;i++){for(var a=null,o=null,s=0;s<n.length;s++){for(var l=n[s],u=null,c=0;c<t.length;c++){var d=k(l,t[c],r);(null===u||d<u)&&(u=d)}(null===o||o<u)&&(a=l,o=u)}t.push(a)}for(var h=null,f=null,p=0;p<t.length;p++){for(var m=0,g=0;g<t.length;g++)p!==g&&(m+=k(t[p],t[g],r));(null===h||h<m)&&(h=m,f=p)}var v=[];v.push(t[f]),t.splice(f,1);for(;0<t.length;){for(var y=null,_=null,b=0;b<t.length;b++){var E=k(v[0],t[b],r);(null===y||E<y)&&(y=E,_=b)}v.push(t[_]),t.splice(_,1)}return v}(M)}return M}(e),d=t/R;1<d&&(d=N()),n/=I,x.debug("getNextQuality called throughput:".concat(d," latency:").concat(n," bufferSize:").concat(r," currentQualityIndex:").concat(a," playbackRate:").concat(i));var h=c[a],f=h.bitrate*o.getSegmentDuration()/u,p=Math.max(0,f-l);if(l-f<o.getMinBuffer())return x.debug("Buffer is low for bitrate= ".concat(h.bitrate," downloadTime=").concat(f," currentBuffer=").concat(l," rebuffer=").concat(p)),function(e,t){var n=0,r=e;if(M)for(var i=0;i<M.length;i++){var a=M[i];a.bitrate<e.bitrate&&a.bitrate>n&&t>a.bitrate&&(n=a.bitrate,r=a)}return r}(h,u).qualityIndex;switch(O){case j:D=[.4,.4,.4,.4];break;case U:!function(e){D=function(e,t){for(var n=[],r=Math.sqrt(2/e),i=0;i<t;i++)n.push(Math.random()*r);return D=n}(e.length,4)}(c);break;case H:F(o,c,s,l,p,u,i);break;default:F(o,c,s,l,p,u,i)}for(var m=null,g=null,v=null,y=0;y<c.length;y++){var _=c[y],b=_.state,E=[b.throughput,b.latency,b.rebuffer,b.switch],T=D.slice(),A=o.getNextBufferWithBitrate(_.bitrate,l,u),w=A<o.getMinBuffer();w&&x.debug("Buffer is low for bitrate=".concat(_.bitrate," downloadTime=").concat(f," currentBuffer=").concat(l," nextBuffer=").concat(A)),(_.bitrate>t-1e4||w)&&_.bitrate!==P&&(T[0]=100);var S=k(E,[d,0,0,0],T);(null===m||S<m)&&(m=S,g=_.qualityIndex,v=_)}var C=Math.abs(h.bitrate-v.bitrate)/R;return B(h,c,[d,n,p,C]),B(v,c,[d,0,0,C]),g},reset:function(){n()}},x=Object(i.default)(t).getInstance().getLogger(e),n(),e}a.__dashjs_factory_name="LearningAbrController",t.default=r.default.getClassFactory(a)},"./src/streaming/rules/abr/lolp/LoLpQoEEvaluator.js":function(e,t,n){n.r(t);var r=n("./src/core/FactoryMaker.js"),c=n("./src/streaming/rules/abr/lolp/QoeInfo.js");function i(){var e,i,a,o,s;function t(){s=o=a=i=null}function l(e,t,n,r){var i=new c.default;return i.type=e,i.weights.bitrateReward=t||1,i.weights.bitrateSwitchPenalty=1,i.weights.rebufferPenalty=n||1e3,i.weights.latencyPenalty=[],i.weights.latencyPenalty.push({threshold:1.1,penalty:.05*r}),i.weights.latencyPenalty.push({threshold:1e8,penalty:.1*n}),i.weights.playbackSpeedPenalty=r||200,i}function u(e,t,n,r,i){i.bitrateWSum+=i.weights.bitrateReward*e,i.lastBitrate&&(i.bitrateSwitchWSum+=i.weights.bitrateSwitchPenalty*Math.abs(e-i.lastBitrate)),i.lastBitrate=e,i.rebufferWSum+=i.weights.rebufferPenalty*t;for(var a=0;a<i.weights.latencyPenalty.length;a++){var o=i.weights.latencyPenalty[a];if(n<=o.threshold){i.latencyWSum+=o.penalty*n;break}}i.playbackSpeedWSum+=i.weights.playbackSpeedPenalty*Math.abs(1-r),i.totalQoe=i.bitrateWSum-i.bitrateSwitchWSum-i.rebufferWSum-i.latencyWSum-i.playbackSpeedWSum}return e={setupPerSegmentQoe:function(e,t,n){i=l("segment",e,t,n),a=e,o=t,s=n},logSegmentMetrics:function(e,t,n,r){i&&u(e,t,n,r,i)},getPerSegmentQoe:function(){return i},calculateSingleUseQoe:function(e,t,n,r){var i=null;return a&&o&&s&&(i=l("segment",a,o,s)),i?(u(e,t,n,r,i),i.totalQoe):0},reset:function(){t()}},t(),e}i.__dashjs_factory_name="LoLpQoeEvaluator",t.default=r.default.getClassFactory(i)},"./src/streaming/rules/abr/lolp/LoLpRule.js":function(e,t,n){n.r(t);var r=n("./src/core/Debug.js"),i=n("./src/core/FactoryMaker.js"),a=n("./src/streaming/rules/abr/lolp/LearningAbrController.js"),o=n("./src/streaming/rules/abr/lolp/LoLpQoEEvaluator.js"),P=n("./src/streaming/rules/SwitchRequest.js"),D=n("./src/streaming/constants/MetricsConstants.js"),L=n("./src/streaming/rules/abr/lolp/LoLpWeightSelector.js"),O=n("./src/streaming/constants/Constants.js");function s(e){var C,t,x,M,R=(e=e||{}).dashMetrics,I=this.context;return t={getMaxIndex:function(e){try{var t=Object(P.default)(I).create(),n=e.getMediaInfo().type,r=e.getAbrController(),i=e.getStreamInfo(),a=r.getQualityFor(n,i.id),o=e.getMediaInfo(),s=R.getCurrentBufferState(n),l=e.getScheduleController(),u=R.getCurrentBufferLevel(n,!0),c=i&&i.manifestInfo?i.manifestInfo.isDynamic:null,d=l.getPlaybackController(),h=d.getCurrentLiveLatency();if(!e.useLoLPABR()||n===O.default.AUDIO)return t;h=h||0;var f=d.getPlaybackRate(),p=r.getThroughputHistory().getSafeAverageThroughput(n,c);if(C.debug("Throughput ".concat(Math.round(p)," kbps")),isNaN(p)||!s)return t;if(r.getAbandonmentStateFor(i.id,n)===D.default.ABANDON_LOAD)return t;for(var m=o.bitrateList,g=e.getRepresentationInfo().fragmentDuration,v=m[0].bandwidth/1e3,y=m[m.length-1].bandwidth/1e3,_=0;_<m.length;_++){var b=m[_].bandwidth/1e3;y<b?y=b:b<v&&(v=b)}var E=m[a].bandwidth/1e3,T=R.getCurrentHttpRequest(n,!0),A=(T.tresponse.getTime()-T.trequest.getTime())/1e3,w=g<A?A-g:0;M.setupPerSegmentQoe(g,y,v),M.logSegmentMetrics(E,w,h,f);var S=Object(L.default)(I).create({targetLatency:1.5,bufferMin:.3,segmentDuration:g,qoeEvaluator:M});return t.quality=x.getNextQuality(o,1e3*p,h,u,f,a,S),t.reason={throughput:p,latency:h},t.priority=P.default.PRIORITY.STRONG,l.setTimeToLoadDelay(0),t.quality!==a&&console.log("[TgcLearningRule]["+n+"] requesting switch to index: ",t.quality,"Average throughput",Math.round(p),"kbps"),t}catch(e){throw e}},reset:function(){x.reset(),M.reset()}},C=Object(r.default)(I).getInstance().getLogger(t),x=Object(a.default)(I).create(),M=Object(o.default)(I).create(),t}s.__dashjs_factory_name="LoLPRule",t.default=i.default.getClassFactory(s)},"./src/streaming/rules/abr/lolp/LoLpWeightSelector.js":function(e,t,n){n.r(t);var r=n("./src/core/FactoryMaker.js");function i(e){var t,n,r,v=e.targetLatency,y=e.bufferMin,_=e.segmentDuration,b=e.qoeEvaluator;function i(){return _}function E(e,t){var n=i();return n<t?e-n:e+n-t}return t={getMinBuffer:function(){return y},getSegmentDuration:i,getNextBufferWithBitrate:function(e,t,n){return E(t,e*_/n)},getNextBuffer:E,findWeightVector:function(e,u,c,t,d,h){var f=null,p=null,m=null,g=Math.abs(u-r);return e.forEach(function(l){n.forEach(function(e){e[0];var t=e[1],n=e[2],r=(e[3],l.bitrate*_/d),i=E(c,r),a=(0===n?10:1/n)*Math.max(1e-5,r-i),o=(0===t?10:1/t)*l.state.latency,s=b.calculateSingleUseQoe(l.bitrate,a,o,h);(null===f||f<s)&&function(e,t,n){if(v+n<e)return!1;return y<=t}(u,i,g)&&(f=s,p=e,m=l.bitrate)})}),null===p&&null===m&&(p=-1),r=u,p}},n=function(l,e){return function e(t,n,r){if(r===n)return t;for(var i=t.length,a=0;a<i;a++)for(var o=t.shift(),s=0;s<l.length;s++)t.push(o.concat(l[s]));return e(t,n,r+1)}(l.map(function(e){return[e]}),e,1)}([.2,.4,.6,.8,1],4),r=0,t}i.__dashjs_factory_name="LoLpWeightSelector",t.default=r.default.getClassFactory(i)},"./src/streaming/rules/abr/lolp/QoeInfo.js":function(e,t,n){n.r(t);t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type=null,this.lastBitrate=null,this.weights={},this.weights.bitrateReward=null,this.weights.bitrateSwitchPenalty=null,this.weights.rebufferPenalty=null,this.weights.latencyPenalty=null,this.weights.playbackSpeedPenalty=null,this.bitrateWSum=0,this.bitrateSwitchWSum=0,this.rebufferWSum=0,this.latencyWSum=0,this.playbackSpeedWSum=0,this.totalQoe=0}},"./src/streaming/text/EmbeddedTextHtmlRender.js":function(e,t,n){n.r(t);var r=n("./src/core/FactoryMaker.js");function i(){var U=0;function H(e){for(var t="",n=0;n<e.length;++n){t+=e[n].uchar}return t.length-t.replace(/^\s+/,"").length}function r(e){return"red"===e?"rgb(255, 0, 0)":"green"===e?"rgb(0, 255, 0)":"blue"===e?"rgb(0, 0, 255)":"cyan"===e?"rgb(0, 255, 255)":"magenta"===e?"rgb(255, 0, 255)":"yellow"===e?"rgb(255, 255, 0)":"white"===e?"rgb(255, 255, 255)":"black"===e?"rgb(0, 0, 0)":e}function G(e,t){var n=e.videoHeight/15;return t?"font-size: "+n+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; color: "+(t.foreground?r(t.foreground):"rgb(255, 255, 255)")+"; font-style: "+(t.italics?"italic":"normal")+"; text-decoration: "+(t.underline?"underline":"none")+"; white-space: pre; background-color: "+(t.background?r(t.background):"transparent")+";":"font-size: "+n+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; justify-content: flex-start; text-align: left; color: rgb(255, 255, 255); font-style: normal; white-space: pre; line-height: normal; font-weight: normal; text-decoration: none; width: 100%; display: flex;"}return{createHTMLCaptionsFromScreen:function(e,t,n,r){var i,a,o=null,s=!1,l=-1,u={start:t,end:n,spans:[]},c="style_cea608_white_black",d={},h={},f=[];for(i=0;i<15;++i){var p=r.rows[i],m="",g=null;if(!1===p.isEmpty()){var v=H(p.chars);null===o&&(o={x:v,y1:i,y2:i+1,p:[]}),v!==l&&s&&(o.p.push(u),u={start:t,end:n,spans:[]},o.y2=i,o.name="region_"+o.x+"_"+o.y1+"_"+o.y2,!1===d.hasOwnProperty(o.name)?(f.push(o),d[o.name]=o):d[o.name].p.contat(o.p),o={x:v,y1:i,y2:i+1,p:[]});for(var y=0;y<p.chars.length;++y){var _=p.chars[y],b=_.penState;if(null===g||!b.equals(g)){0<m.trim().length&&(u.spans.push({name:c,line:m,row:i}),m="");var E="style_cea608_"+b.foreground+"_"+b.background;b.underline&&(E+="_underline"),b.italics&&(E+="_italics"),h.hasOwnProperty(E)||(h[E]=JSON.parse(JSON.stringify(b))),g=b,c=E}m+=_.uchar}0<m.trim().length&&u.spans.push({name:c,line:m,row:i}),s=!0,l=v}else s=!1,l=-1,o&&(o.p.push(u),u={start:t,end:n,spans:[]},o.y2=i,o.name="region_"+o.x+"_"+o.y1+"_"+o.y2,!1===d.hasOwnProperty(o.name)?(f.push(o),d[o.name]=o):d[o.name].p.contat(o.p),o=null)}o&&(o.p.push(u),o.y2=i+1,o.name="region_"+o.x+"_"+o.y1+"_"+o.y2,!1===d.hasOwnProperty(o.name)?(f.push(o),d[o.name]=o):d[o.name].p.contat(o.p),o=null);var T,A=[];for(i=0;i<f.length;++i){var w=f[i],S="sub_cea608_"+U++,C=document.createElement("div");C.id=S;var x="left: "+3.125*(T=w).x+"%; top: "+6.66*T.y1+"%; width: "+(100-3.125*T.x)+"%; height: "+6.66*Math.max(T.y2-1-T.y1,1)+"%; align-items: flex-start; overflow: visible; -webkit-writing-mode: horizontal-tb;";C.style.cssText="position: absolute; margin: 0; display: flex; box-sizing: border-box; pointer-events: none;"+x;var M=document.createElement("div");M.className="paragraph bodyStyle",M.style.cssText=G(e);var R=document.createElement("div");R.className="cueUniWrapper",R.style.cssText="unicode-bidi: normal; direction: ltr;";for(var I=0;I<w.p.length;++I){var P=w.p[I],D=0;for(a=0;a<P.spans.length;++a){var L=P.spans[a];if(0<L.line.length){if(0!==a&&D!=L.row){var O=document.createElement("br");O.className="lineBreak",R.appendChild(O)}var N=!1;D===L.row&&(N=!0),D=L.row;var k=h[L.name],B=document.createElement("span");B.className="spanPadding "+L.name+" customSpanColor",B.style.cssText=G(e,k),0!==a&&N?a===P.spans.length-1?B.textContent=L.line.replace(/\s+$/g,""):B.textContent=L.line:1<P.spans.length&&a<P.spans.length-1&&L.row===P.spans[a+1].row?B.textContent=L.line.replace(/^\s+/g,""):B.textContent=L.line.trim(),R.appendChild(B)}}}M.appendChild(R),C.appendChild(M);var F={bodyStyle:["%",90]};for(var j in h)h.hasOwnProperty(j)&&(F[j]=["%",90]);A.push({type:"html",start:t,end:n,cueHTMLElement:C,cueID:S,cellResolution:[32,15],isFromCEA608:!0,fontSize:F,lineHeight:{},linePadding:{}})}return A}}}i.__dashjs_factory_name="EmbeddedTextHtmlRender",t.default=r.default.getSingletonFactory(i)},"./src/streaming/text/NotFragmentedTextBufferController.js":function(e,t,n){n.r(t);var g=n("./src/core/EventBus.js"),v=n("./src/core/events/Events.js"),r=n("./src/core/FactoryMaker.js"),y=n("./src/streaming/utils/InitCache.js"),_=n("./src/streaming/SourceBufferSink.js"),b=n("./src/streaming/vo/DashJSError.js"),E=n("./src/core/errors/Errors.js"),T="NotFragmentedTextBufferController";function i(e){e=e||{};var t,n,r,i,a,o,s=this.context,l=Object(g.default)(s).getInstance(),u=e.textController,c=e.errHandler,d=e.streamInfo,h=e.type;function f(e){i=e}function p(e){n!==e&&(n=e)&&function(e,t){var n=t||{};l.trigger(e,n,{streamId:d.id,mediaType:h})}(v.default.BUFFERING_COMPLETED)}function m(e){e.chunk.bytes&&!n&&(o.save(e.chunk),a.append(e.chunk),p(!0))}return t={initialize:function(e){f(e)},getStreamId:function(){return d.id},getType:function(){return h},getBufferControllerType:function(){return T},createBufferSink:function(n){return new Promise(function(e,t){try{(a=Object(_.default)(s).create({mediaSource:i,textController:u,eventBus:l})).initializeForFirstUse(d,n),r||(a.getBuffer()&&"function"==typeof a.getBuffer().initialize&&a.getBuffer().initialize(),r=!0),e(a)}catch(e){c.error(new b.default(E.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,E.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+h)),t(e)}})},getBuffer:function(){return a},getBufferLevel:function(){return 0},getRangeAt:function(){return null},getAllRangesWithSafetyFactor:function(){return[]},getContinuousBufferTimeForTargetTime:function(){return Number.POSITIVE_INFINITY},setMediaSource:f,getMediaSource:function(){return i},appendInitSegmentFromCache:function(e){return null!==o.extract(d.id,e)},getIsBufferingCompleted:function(){return n},setIsBufferingCompleted:p,getIsPruningInProgress:function(){return!1},reset:function(e){l.off(v.default.INIT_FRAGMENT_LOADED,m,t),!e&&a&&(a.abort(),a.reset(),a=null)},clearBuffers:function(){return Promise.resolve()},prepareForPlaybackSeek:function(){return Promise.resolve()},prepareForReplacementTrackSwitch:function(){return n=!1,Promise.resolve()},setSeekTarget:function(){},updateAppendWindow:function(){return Promise.resolve()},pruneAllSafely:function(){return Promise.resolve()},updateBufferTimestampOffset:function(){return Promise.resolve()},segmentRequestingCompleted:function(){}},i=null,n=r=!1,o=Object(y.default)(s).getInstance(),l.on(v.default.INIT_FRAGMENT_LOADED,m,t),t}i.__dashjs_factory_name=T,t.default=r.default.getClassFactory(i)},"./src/streaming/text/TextController.js":function(e,t,n){n.r(t);var x=n("./src/streaming/constants/Constants.js"),r=n("./src/core/FactoryMaker.js"),M=n("./src/streaming/text/TextSourceBuffer.js"),R=n("./src/streaming/text/TextTracks.js"),I=n("./src/streaming/utils/VTTParser.js"),P=n("./src/streaming/utils/TTMLParser.js"),D=n("./src/core/EventBus.js"),L=n("./src/core/events/Events.js"),O=n("./src/streaming/MediaPlayerEvents.js"),N=n("./src/streaming/utils/SupervisorTools.js");function i(e){var t,i,s,l,a,o,u,c,n,d,r,h,f,p=this.context,m=e.adapter,g=e.errHandler,v=e.manifestModel,y=e.mediaController,_=e.videoModel,b=e.settings;function E(e){var t=e.tracks,n=e.index,r=e.streamId;!1===b.get().streaming.text.defaultEnabled&&!A()||f?w(r,-1):(c&&t.some(function(e,t){if(y.matchSettings(c,e))return w(r,t),n=t,!0}),d=!1),i[r].lastEnabledIndex=n,u.trigger(O.default.TEXT_TRACKS_ADDED,{enabled:A(),index:n,tracks:t,streamId:r}),h=!0}function T(e){if(!n&&e&&e.newMediaInfo){var t=e.newMediaInfo;t.type===x.default.TEXT&&(c={lang:t.lang,role:t.roles[0],index:t.index,codec:t.codec,accessibility:t.accessibility[0]})}}function A(){var e=!0;return d&&!r&&(e=!1),e}function w(e,t){(d=-1===t)&&y&&y.saveTextSettingsDisabled();var n=S(e);if(n!==t&&l[e]){l[e].setModeForTrackIdx(n,x.default.TEXT_HIDDEN),l[e].setCurrentTrackIdx(t),l[e].setModeForTrackIdx(t,x.default.TEXT_SHOWING);var r=l[e].getCurrentTrackInfo();r&&r.isFragmented&&!r.isEmbedded?function(e,t,n){if(!s[e])return;for(var r=s[e].getConfig().fragmentedTracks,i=0;i<r.length;i++){var a=r[i];if(t.lang===a.lang&&(a.id?t.id===a.id:t.index===a.index)){var o=y.getCurrentTrackFor(x.default.TEXT,e);(a.id?o.id!==a.id:o.index!==a.index)?(l[e].deleteCuesFromTrackIdx(n),s[e].setCurrentFragmentedTrackIdx(i)):-1===n&&u.trigger(L.default.SET_FRAGMENTED_TEXT_AFTER_DISABLED,{},{streamId:e,mediaType:x.default.TEXT})}}}(e,r,n):r&&!r.isFragmented&&function(e,t){u.trigger(L.default.SET_NON_FRAGMENTED_TEXT,{currentTrackInfo:t},{streamId:e,mediaType:x.default.TEXT})}(e,r),y.setTrack(r)}}function S(e){return l[e].getCurrentTrackIdx()}function C(){s={},l={},i={},f=h=!(d=!0)}return t={deactivateStream:function(e){if(e){var t=e.id;s[t]&&s[t].resetMediaInfos(),l[t]&&l[t].deleteAllTextTracks()}},initialize:function(){u.on(L.default.CURRENT_TRACK_CHANGED,T,t),u.on(L.default.TEXT_TRACKS_QUEUE_INITIALIZED,E,t)},initializeForStream:function(e){var t=e.id,n=Object(R.default)(p).create({videoModel:_,streamInfo:e});n.initialize(),l[t]=n;var r=Object(M.default)(p).create({errHandler:g,adapter:m,manifestModel:v,mediaController:y,videoModel:_,textTracks:n,vttParser:a,ttmlParser:o,streamInfo:e});r.initialize(),s[t]=r,i[t]={},i[t].lastEnabledIndex=-1},createTracks:function(e){var t=e.id;l[t]&&l[t].createTracks()},getTextSourceBuffer:function(e){var t=e.id;if(s&&s[t])return s[t]},getAllTracksAreDisabled:function(){return d},addEmbeddedTrack:function(e,t){var n=e.id;s[n]&&s[n].addEmbeddedTrack(t)},setInitialSettings:function(e){c=e,n=!0},enableText:function(e,t){Object(N.checkParameterType)(t,"boolean"),A()!==t&&(t&&w(e,i[e].lastEnabledIndex),t||(i[e].lastEnabledIndex=S(e),h?w(e,-1):f=!0))},isTextEnabled:A,setTextTrack:w,getCurrentTrackIdx:S,enableForcedTextStreaming:function(e){Object(N.checkParameterType)(e,"boolean"),r=e},addMediaInfosToBuffer:function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,i=e.id;s[i]&&s[i].addMediaInfos(t,n,r)},reset:function(){C(),u.off(L.default.CURRENT_TRACK_CHANGED,T,t),u.off(L.default.TEXT_TRACKS_QUEUE_INITIALIZED,E,t),Object.keys(s).forEach(function(e){s[e].resetEmbedded(),s[e].reset()})}},c=null,f=n=h=r=!1,a=Object(I.default)(p).getInstance(),o=Object(P.default)(p).getInstance(),u=Object(D.default)(p).getInstance(),C(),t}i.__dashjs_factory_name="TextController",t.default=r.default.getClassFactory(i)},"./src/streaming/text/TextSourceBuffer.js":function(e,t,n){n.r(t);var B=n("./src/streaming/constants/Constants.js"),F=n("./src/streaming/vo/metrics/HTTPRequest.js"),j=n("./src/streaming/vo/TextTrackInfo.js"),U=n("./src/streaming/utils/BoxParser.js"),H=n("./src/streaming/utils/CustomTimeRanges.js"),r=n("./src/core/FactoryMaker.js"),G=n("./src/core/Debug.js"),V=n("./src/streaming/text/EmbeddedTextHtmlRender.js"),i=n("./node_modules/codem-isoboxer/dist/iso_boxer.js"),z=n.n(i),a=n("./externals/cea608-parser.js"),W=n.n(a),q=n("./src/core/EventBus.js"),Y=n("./src/core/events/Events.js"),K=n("./src/streaming/vo/DashJSError.js"),X=n("./src/core/errors/Errors.js");function o(e){var y,_,u,b,o,E,s,T,l,g,A,c,f,d,h,a,p=e.errHandler,w=e.manifestModel,m=e.mediaController,v=e.videoModel,S=e.textTracks,n=e.vttParser,r=e.ttmlParser,C=e.streamInfo,x=this.context,t=Object(q.default)(x).getInstance(),i=!1;function M(){T=NaN,g=E=null,s=!(l=[]),o=[],b=null}function R(e){var t=new j.default;for(var n in e)t[n]=e[n];t.labels=e.labels,t.defaultTrack=function(e){var t=!1;1<c.length&&e.isEmbedded?t=e.id&&e.id===B.default.CC1:1===c.length?e.id&&"string"==typeof e.id&&"CC"===e.id.substring(0,2)&&(t=!0):0===c.length&&(t=e.index===o[0].index);return t}(e),t.isFragmented=e.isFragmented,t.isEmbedded=!!e.isEmbedded,t.isTTML=function(e){return e.codec&&0<=e.codec.search(B.default.STPP)||e.mimeType&&0<=e.mimeType.search(B.default.TTML)}(e),t.kind=function(e,t){var n=e.roles&&0<e.roles.length?t[e.roles[0]]:t.caption;return n=n===t.caption||n===t.subtitle?n:t.caption}(e,{subtitle:"subtitles",caption:"captions"}),S.addTextTrack(t)}function I(e){var t=e.chunk;t.mediaInfo.embeddedCaptions&&D(t.bytes,t)}function P(e){A=e}function D(e,t){var n=t.mediaInfo,r=n.type,i=n.mimeType,a=n.codec||i;a?-1!==n.codec.indexOf("application/mp4")?function(e,t,n){var r,i;if("InitializationSegment"===t.segmentType)s=!0,T=u.getMediaTimescaleFromMoov(e);else{if(!s)return;i=u.getSamplesInfo(e),0<(r=i.sampleList).length&&(g=r[0].cts-t.start*T),0<=n.search(B.default.STPP)?function(e,t,n){var r,i;for(b=null!==b?b:N(n),r=0;r<t.length;r++){var a=t[r],o=a.cts,s=O(),l=s+o/T,u=l+a.duration/T;y.buffered.add(l,u);var c=new DataView(e,a.offset,a.subSizes[0]),d=z.a.Utils.dataViewToString(c,B.default.UTF8),h=[],f=a.offset+a.subSizes[0];for(i=1;i<a.subSizes.length;i++){var p=new Uint8Array(e,f,a.subSizes[i]),m=String.fromCharCode.apply(null,p);h.push(m),f+=a.subSizes[i]}try{var g=w.getValue().ttmlTimeIsRelative?o/T:0,v=b.parse(d,g,o/T,(o+a.duration)/T,h);S.addCaptions(A,s,v)}catch(e){E.removeExecutedRequestsBeforeTime(),this.remove(),_.error("TTML parser error: "+e.message)}}}(e,r,n):function(e,t){var n,r,i,a=[];for(n=0;n<t.length;n++){var o=t[n];o.cts-=g;var s=O()+o.cts/T,l=s+o.duration/T;y.buffered.add(s,l);var u=e.slice(o.offset,o.offset+o.size),c=z.a.parseBuffer(u);for(r=0;r<c.boxes.length;r++){var d=c.boxes[r];if(_.debug("VTT box1: "+d.type),"vtte"!==d.type&&"vttc"===d.type)for(_.debug("VTT vttc boxes.length = "+d.boxes.length),i=0;i<d.boxes.length;i++){var h=d.boxes[i];if(_.debug("VTT box2: "+h.type),"payl"===h.type){var f=h.cue_text;_.debug("VTT cue_text = "+f);var p=o.cts/T,m=(o.cts+o.duration)/T;a.push({start:p,end:m,data:f,styles:{}}),_.debug("VTT "+p+"-"+m+" : "+f)}}}}0<a.length&&S.addCaptions(A,0,a)}(e,r)}}(e,t,a):r===B.default.VIDEO?function(e,t){var n,r;if(t.segmentType===F.HTTPRequest.INIT_SEGMENT_TYPE)0===f&&(f=u.getMediaTimescaleFromMoov(e));else if(t.segmentType===F.HTTPRequest.MEDIA_SEGMENT_TYPE){if(0===f)return _.warn("CEA-608: No timescale for embeddedTextTrack yet");var i=(r=u.getSamplesInfo(e)).lastSequenceNumber;if(h[0]||h[1]||function(){for(var e,t=0;t<c.length;t++){if(-1===(e=S.getTrackIdxForId(c[t].id)))return _.warn("CEA-608: data before track is ready.");var n=L(e);h[t]=new W.a.Cea608Parser(t+1,{newCue:n},null)}}(),f){if(null!==d&&i!==d+r.numSequences)for(n=0;n<h.length;n++)h[n]&&h[n].reset();for(var a=function(e,t){if(0===t.length)return null;for(var n={splits:[],fields:[[],[]]},r=new DataView(e),i=0;i<t.length;i++)for(var a=t[i],o=W.a.findCea608Nalus(r,a.offset,a.size),s=null,l=0,u=0;u<o.length;u++)for(var c=W.a.extractCea608DataFromRange(r,o[u]),d=0;d<2;d++)if(0<c[d].length){a.cts!==s?l=0:l+=1;var h=O();n.fields[d].push([a.cts+h*f,c[d],l]),s=a.cts}return n.fields.forEach(function(e){e.sort(function(e,t){return e[0]===t[0]?e[2]-t[2]:e[0]-t[0]})}),n}(e,r.sampleList),o=0;o<h.length;o++){var s=a.fields[o],l=h[o];if(l)for(n=0;n<s.length;n++)l.addData(s[n][0]/f,s[n][1])}d=i}}}(e,t):function(e,t,n){var r,i,a=new DataView(e,0,e.byteLength);i=z.a.Utils.dataViewToString(a,B.default.UTF8);try{r=N(n).parse(i,0),S.addCaptions(S.getCurrentTrackIdx(),0,r),y.buffered&&y.buffered.add(t.start,t.end)}catch(e){p.error(new K.default(X.default.TIMED_TEXT_ERROR_ID_PARSE_CODE,X.default.TIMED_TEXT_ERROR_MESSAGE_PARSE+e.message,i))}}(e,t,a):_.error("No text type defined")}function L(i){return function(e,t,n){var r;r=v.getTTMLRenderingDiv()?a.createHTMLCaptionsFromScreen(v.getElement(),e,t,n):[{start:e,end:t,data:n.getDisplayText(),styles:{}}],r&&S.addCaptions(i,0,r)}}function O(){return isNaN(y.timestampOffset)?0:y.timestampOffset}function N(e){var t;return 0<=e.search(B.default.VTT)?t=n:(0<=e.search(B.default.TTML)||0<=e.search(B.default.STPP))&&(t=r),t}function k(n){c.forEach(function(e){var t=S.getTrackIdxForId(e.id);0<=t&&S.deleteCuesFromTrackIdx(t,n.from,n.to)})}return y={initialize:function(){i||(c=[],h=[],d=A=null,i=!(f=0),a=Object(V.default)(x).getInstance(),t.on(Y.default.VIDEO_CHUNK_RECEIVED,I,y),t.on(Y.default.BUFFER_CLEARED,k,y))},addMediaInfos:function(e,t,n){if(o=o.concat(t),e===B.default.TEXT&&t[0].isFragmented&&!t[0].isEmbedded){E=n,y.buffered=Object(H.default)(x).create(),l=m.getTracksFor(B.default.TEXT,C.id).filter(function(e){return e.isFragmented});for(var r=m.getCurrentTrackFor(B.default.TEXT,C.id),i=0;i<l.length;i++)if(l[i]===r){P(i);break}}for(var a=0;a<t.length;a++)R(t[a])},resetMediaInfos:function(){o=[]},getStreamId:function(){return C.id},append:D,abort:function(){},addEmbeddedTrack:function(e){if(i&&e)if(e.id===B.default.CC1||e.id===B.default.CC3){for(var t=0;t<c.length;t++)if(c[t].id===e.id)return;c.push(e)}else _.warn("Embedded track "+e.id+" not supported!")},resetEmbedded:function(){t.off(Y.default.VIDEO_CHUNK_RECEIVED,I,y),t.off(Y.default.BUFFER_CLEARED,k,y),S&&S.deleteAllTextTracks(),i=!1,c=[],h=[null,null],d=null},getConfig:function(){return{fragmentModel:E,fragmentedTracks:l,videoModel:v}},setCurrentFragmentedTrackIdx:P,remove:function(e,t){void 0===e&&e===t&&(e=y.buffered.start(0),t=y.buffered.end(y.buffered.length-1)),y.buffered.remove(e,t),S.deleteCuesFromTrackIdx(A,e,t)},reset:function(){M(),o=[],u=null}},_=Object(G.default)(x).getInstance().getLogger(y),u=Object(U.default)(x).getInstance(),M(),y}o.__dashjs_factory_name="TextSourceBuffer",t.default=r.default.getClassFactory(o)},"./src/streaming/text/TextTracks.js":function(e,t,n){n.r(t);var D=n("./src/streaming/constants/Constants.js"),L=n("./src/core/EventBus.js"),O=n("./src/core/events/Events.js"),N=n("./src/streaming/MediaPlayerEvents.js"),r=n("./src/core/FactoryMaker.js"),k=n("./src/core/Debug.js"),B=n("./node_modules/imsc/src/main/js/main.js");function i(e){var t,l,u,h,f,p,b,E,T,A,w,r,S,C,n,x,i,a=this.context,M=Object(L.default)(a).getInstance(),R=e.videoModel,m=e.streamInfo;function g(e,t){var n=R.getClientWidth(),r=R.getClientHeight(),i=R.getVideoWidth(),a=R.getVideoHeight(),o=R.getVideoRelativeOffsetTop(),s=R.getVideoRelativeOffsetLeft();if(0!==i&&0!==a){var l=i/a,u=!1;e.isFromCEA608&&(l=3.5/3,u=!0);var c=function(e,t,n,r,i,a){var o=0,s=0;n/r<e/t?o=(s=t)/r*n:s=(o=e)/n*r;var l,u,c=0,d=0;return i<o/s?c=(d=s)*i:d=(c=o)/i,l=(e-c)/2,u=(t-d)/2,a?{x:l+.1*c,y:u+.1*d,w:.8*c,h:.8*d}:{x:l,y:u,w:c,h:d}}.call(this,n,r,i,a,l,u),d=c.w,h=c.h,f=c.x,p=c.y;if(d!=T||h!=A||f!=b||p!=E||t){if(b=f+s,E=p+o,T=d,A=h,w){var m=w.style;m&&(m.left=b+"px",m.top=E+"px",m.width=T+"px",m.height=A+"px",m.zIndex=S&&document[S]||C?x:null,M.trigger(N.default.CAPTION_CONTAINER_RESIZE))}var g=e.activeCues;if(g)for(var v=g.length,y=0;y<v;++y){var _=g[y];_.scaleCue(_)}}}}function c(e){var t,n,r,i,a,o=T,s=A;if(e.cellResolution){var l=[o/e.cellResolution[0],s/e.cellResolution[1]];if(e.linePadding)for(t in e.linePadding)if(e.linePadding.hasOwnProperty(t)){n=(e.linePadding[t]*l[0]).toString();for(var u=document.getElementsByClassName("spanPadding"),c=0;c<u.length;c++)u[c].style.cssText=u[c].style.cssText.replace(/(padding-left\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+n),u[c].style.cssText=u[c].style.cssText.replace(/(padding-right\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+n)}if(e.fontSize){for(t in e.fontSize)if(e.fontSize.hasOwnProperty(t)){"%"===e.fontSize[t][0]?r=e.fontSize[t][1]/100:"c"===e.fontSize[t][0]&&(r=e.fontSize[t][1]),n=(r*l[1]).toString(),a="defaultFontSize"!==t?document.getElementsByClassName(t):document.getElementsByClassName("paragraph");for(var d=0;d<a.length;d++)a[d].style.cssText=a[d].style.cssText.replace(/(font-size\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+n)}if(e.lineHeight)for(t in e.lineHeight)if(e.lineHeight.hasOwnProperty(t)){"%"===e.lineHeight[t][0]?i=e.lineHeight[t][1]/100:"c"===e.fontSize[t][0]&&(i=e.lineHeight[t][1]),n=(i*l[1]).toString(),a=document.getElementsByClassName(t);for(var h=0;h<a.length;h++)a[h].style.cssText=a[h].style.cssText.replace(/(line-height\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+n)}}}if(e.isd){var f=document.getElementById(e.cueID);f&&w.removeChild(f),v(e)}}function v(o){if(w){var e=document.createElement("div");w.appendChild(e),n=Object(B.renderHTML)(o.isd,e,function(e){var t=/^(urn:)(mpeg:[a-z0-9][a-z0-9-]{0,31}:)(subs:)([0-9]+)$/,n=/^#(.*)$/;if(t.test(e)){var r=t.exec(e),i=parseInt(r[4],10)-1;return"data:image/png;base64,"+btoa(o.images[i])}if(n.test(e)){var a=n.exec(e)[1];return"data:image/png;base64,"+o.embeddedImages[a]}return null},w.clientHeight,w.clientWidth,!1,function(e){l.info("renderCaption :",e)},n,!0),e.id=o.cueID,M.trigger(N.default.CAPTION_RENDERED,{captionDiv:e,currentTrackIdx:p})}}function y(e,t,n){var r=_(e),i=this;if(r&&Array.isArray(n)&&0!==n.length)for(var a=0;a<n.length;a++){var o=void 0,s=n[a];r.cellResolution=s.cellResolution,r.isFromCEA608=s.isFromCEA608,"html"!==s.type||!w||isNaN(s.start)||isNaN(s.end)?!s.data||isNaN(s.start)||isNaN(s.end)||(o=new u(s.start-t,s.end-t,s.data),s.styles&&(void 0!==s.styles.align&&"align"in o&&(o.align=s.styles.align),void 0!==s.styles.line&&"line"in o&&(o.line=s.styles.line),void 0!==s.styles.position&&"position"in o&&(o.position=s.styles.position),void 0!==s.styles.size&&"size"in o&&(o.size=s.styles.size)),o.onenter=function(){r.mode===D.default.TEXT_SHOWING&&M.trigger(N.default.CAPTION_RENDERED,{currentTrackIdx:p})}):((o=new u(s.start+t,s.end+t,"")).cueHTMLElement=s.cueHTMLElement,o.isd=s.isd,o.images=s.images,o.embeddedImages=s.embeddedImages,o.cueID=s.cueID,o.scaleCue=c.bind(i),o.cellResolution=s.cellResolution,o.lineHeight=s.lineHeight,o.linePadding=s.linePadding,o.fontSize=s.fontSize,w.style.left=b+"px",w.style.top=E+"px",w.style.width=T+"px",w.style.height=A+"px",o.onenter=function(){r.mode===D.default.TEXT_SHOWING&&(this.isd?(v(this),l.debug("Cue enter id:"+this.cueID)):(w.appendChild(this.cueHTMLElement),c.call(i,this),M.trigger(N.default.CAPTION_RENDERED,{captionDiv:this.cueHTMLElement,currentTrackIdx:p})))},o.onexit=function(){if(w)for(var e=w.childNodes,t=0;t<e.length;++t)e[t].id===this.cueID&&(l.debug("Cue exit id:"+e[t].id),w.removeChild(e[t]),--t)});try{o?d(r,o)||r.addCue(o):l.error("impossible to display subtitles.")}catch(e){throw P(r),r.addCue(o),e}}}function _(e){return 0<=e&&h[e]?R.getTextTrack(h[e].kind,h[e].id,h[e].lang,h[e].isTTML,h[e].isEmbedded):null}function I(e){var t=this;if(e!==p){var n=_(p=e);(function(e){s.call(this),e&&"html"===e.renderingType?function(){var e=document.getElementById("native-cue-style");if(e)return;(e=document.createElement("style")).id="native-cue-style",document.head.appendChild(e);var t=e.sheet,n=R.getElement();try{n&&(n.id?t.insertRule("#"+n.id+"::cue {background: transparent}",0):0!==n.classList.length?t.insertRule("."+n.className+"::cue {background: transparent}",0):t.insertRule("video::cue {background: transparent}",0))}catch(e){l.info(""+e.message)}}.call(this):o.call(this)}).call(this,n),r&&(clearInterval(r),r=null),n&&"html"===n.renderingType&&(g.call(this,n,!0),window.ResizeObserver?(i=new window.ResizeObserver(function(){g.call(t,n,!0)})).observe(R.getElement()):r=setInterval(g.bind(this,n),500))}}function d(e,t){if(!e.cues)return!1;for(var n=0;n<e.cues.length;n++)if(e.cues[n].startTime===t.startTime&&e.cues[n].endTime===t.endTime)return!0;return!1}function P(e,t,n){if(e.cues)for(var r=e.cues,i=r.length-1;0<=i;i--)a=r[i],o=t,s=n,(isNaN(o)||a.startTime>=o)&&(isNaN(s)||a.endTime<=s)&&(r[i].onexit&&r[i].onexit(),e.removeCue(r[i]));var a,o,s}function o(){var e=document.getElementById("native-cue-style");e&&document.head.removeChild(e)}function s(){if(w)for(;w.firstChild;)w.removeChild(w.firstChild)}return t={initialize:function(){"undefined"!=typeof window&&"undefined"!=typeof navigator&&(u=window.VTTCue||window.TextTrackCue,h=[],f=[],C=!(p=-1),x=2147483647,n=r=w=null,void(A=T=E=b=0)!==document.fullscreenElement?S="fullscreenElement":void 0!==document.webkitIsFullScreen?S="webkitIsFullScreen":document.msFullscreenElement?S="msFullscreenElement":document.mozFullScreen&&(S="mozFullScreen"))},getStreamId:function(){return m.id},addTextTrack:function(e){h.push(e)},addCaptions:y,createTracks:function(){h.sort(function(e,t){return e.index-t.index}),w=R.getTTMLRenderingDiv();for(var e,t,n,r,i,a,o=-1,s=0;s<h.length;s++){var l=(e=h[s],void 0,t=e.kind,n=void 0!==e.id?e.id:e.lang,r=e.lang,i=e.isTTML,a=e.isEmbedded,R.addTextTrack(t,n,r,i,a));f.push(l),h[s].defaultTrack&&(l.default=!0,o=s);var u=_(s);u&&(u.mode=D.default.TEXT_SHOWING,w&&(h[s].isTTML||h[s].isEmbedded)?u.renderingType="html":u.renderingType="default"),y(s,0,h[s].captionData),M.trigger(N.default.TEXT_TRACK_ADDED)}if(I.call(this,o),0<=o){M.on(N.default.PLAYBACK_METADATA_LOADED,function e(){var t=_(o);t&&"html"===t.renderingType&&g.call(this,t,!0),M.off(N.default.PLAYBACK_METADATA_LOADED,e,this)},this);for(var c=0;c<h.length;c++){var d=_(c);d&&(d.mode=c===o?D.default.TEXT_SHOWING:D.default.TEXT_HIDDEN)}}M.trigger(O.default.TEXT_TRACKS_QUEUE_INITIALIZED,{index:p,tracks:h,streamId:m.id})},getCurrentTrackIdx:function(){return p},setCurrentTrackIdx:I,getTrackIdxForId:function(e){for(var t=-1,n=0;n<h.length;n++)if(h[n].id===e){t=n;break}return t},getCurrentTrackInfo:function(){return h[p]},setModeForTrackIdx:function(e,t){var n=_(e);n&&n.mode!==t&&(n.mode=t)},deleteCuesFromTrackIdx:function(e,t,n){var r=_(e);r&&P(r,t,n)},deleteAllTextTracks:function(){for(var e=f?f.length:0,t=0;t<e;t++){var n=_(t);n&&P.call(this,n,m.start,m.start+m.duration)}f=[],h=[],r&&(clearInterval(r),r=null),i&&R&&(i.unobserve(R.getElement()),i=null),p=-1,s.call(this)},deleteTextTrack:function(e){R.removeChild(f[e]),f.splice(e,1)}},l=Object(k.default)(a).getInstance().getLogger(t),t}i.__dashjs_factory_name="TextTracks",t.default=r.default.getClassFactory(i)},"./src/streaming/thumbnail/ThumbnailController.js":function(e,t,n){n.r(t);var r=n("./src/core/FactoryMaker.js"),o=n("./src/streaming/constants/Constants.js"),u=n("./src/streaming/vo/Thumbnail.js"),s=n("./src/streaming/thumbnail/ThumbnailTracks.js"),c=n("./src/streaming/vo/BitrateInfo.js"),d=n("./src/dash/utils/SegmentsUtils.js");function i(e){var t,l,n=this.context,r=e.streamInfo;function i(e){l.setTrackByIndex(e)}function a(){l&&l.reset()}return t={getStreamId:function(){return r.id},initialize:function(){l.addTracks();var e=l.getTracks();e&&0<e.length&&i(0)},provide:function(e,t){if("function"==typeof t){var n,r,i=l.getCurrentTrack();if(!i||i.segmentDuration<=0||null==e)t(null);else{(r=l.getThumbnailRequestForTime(e))&&(i.segmentDuration=r.duration),n=e%i.segmentDuration;var a=Math.floor(n*i.tilesHor*i.tilesVert/i.segmentDuration),o=new u.default;if(o.width=Math.floor(i.widthPerTile),o.height=Math.floor(i.heightPerTile),o.x=Math.floor(a%i.tilesHor)*i.widthPerTile,o.y=Math.floor(a/i.tilesHor)*i.heightPerTile,"readThumbnail"in i)return i.readThumbnail(e,function(e){o.url=e,t(o)});if(r)o.url=r.url,i.segmentDuration=NaN;else{var s=Math.floor(e/i.segmentDuration);o.url=function(e,t){var n=t+e.startNumber,r=Object(d.replaceTokenForTemplate)(e.templateUrl,"Number",n);return r=Object(d.replaceTokenForTemplate)(r,"Time",(n-1)*e.segmentDuration*e.timescale),r=Object(d.replaceTokenForTemplate)(r,"Bandwidth",e.bandwidth),Object(d.unescapeDollarsInTemplate)(r)}(i,s)}t(o)}}},setTrackByIndex:i,getCurrentTrackIndex:function(){return l.getCurrentTrackIndex()},getBitrateList:function(){var e=l.getTracks(),n=0;return e.map(function(e){var t=new c.default;return t.mediaType=o.default.IMAGE,t.qualityIndex=n++,t.bitrate=e.bitrate,t.width=e.width,t.height=e.height,t})},reset:a},a(),l=Object(s.default)(n).create({streamInfo:r,adapter:e.adapter,baseURLController:e.baseURLController,timelineConverter:e.timelineConverter,debug:e.debug,eventBus:e.eventBus,events:e.events,dashConstants:e.dashConstants,dashMetrics:e.dashMetrics,segmentBaseController:e.segmentBaseController}),t}i.__dashjs_factory_name="ThumbnailController",t.default=r.default.getClassFactory(i)},"./src/streaming/thumbnail/ThumbnailTracks.js":function(e,t,n){n.r(t),n.d(t,"THUMBNAILS_SCHEME_ID_URIS",function(){return I});var E=n("./src/streaming/constants/Constants.js"),T=n("./src/dash/constants/DashConstants.js"),r=n("./src/core/FactoryMaker.js"),A=n("./src/streaming/vo/ThumbnailTrackInfo.js"),w=n("./src/streaming/utils/URLUtils.js"),S=n("./src/dash/utils/SegmentsUtils.js"),C=n("./src/streaming/utils/BoxParser.js"),x=n("./src/streaming/net/XHRLoader.js"),M=n("./src/dash/DashHandler.js"),R=n("./src/dash/controllers/SegmentsController.js"),I=["http://dashif.org/thumbnail_tile","http://dashif.org/guidelines/thumbnail_tile"];function i(e){var t,i,a,o,s,r,l,u,n=this.context,c=e.adapter,d=e.baseURLController,h=e.streamInfo,f=e.timelineConverter,p=e.debug,m=e.eventBus,g=e.events,v=e.dashConstants,y=Object(w.default)(n).getInstance();function _(t,e){var n=new A.default;n.id=t.id,n.bitrate=t.bandwidth,n.width=t.width,n.height=t.height,n.tilesHor=1,n.tilesVert=1,t.essentialProperties&&t.essentialProperties.forEach(function(e){if(0<=I.indexOf(e.schemeIdUri)&&e.value){var t=e.value.split("x");2!==t.length||isNaN(t[0])||isNaN(t[1])||(n.tilesHor=parseInt(t[0],10),n.tilesVert=parseInt(t[1],10))}}),e?r.updateSegmentData(t).then(function(e){!function(e,r,t){var o=[],n=function(e,t){var n,r,i,a,o=[],s=0;for(n=0,r=e.segments.length;n<r;n++)i=e.segments[n],(a=Object(S.getTimeBasedSegment)(f,c.getIsDynamic(),t,i.startTime,i.duration,i.timescale,i.media,i.mediaRange,s))&&(o.push(a),a=null,s++);return o}(t,r);r.segments=n,e.segmentDuration=r.segments[0].duration,e.readThumbnail=function(t,a){var n=null;o.some(function(e){if(e.start<=t&&e.end>t)return n=e.url,!0}),n?a(n):r.segments.some(function(i){if(i.mediaStartTime<=t&&i.mediaStartTime+i.duration>t){var e=d.resolve(r.path);return l.load({method:"get",url:e.url,request:{range:i.mediaRange,responseType:"arraybuffer"},onload:function(e){var t=u.getSamplesInfo(e.target.response),n=new Blob([e.target.response.slice(t.sampleList[0].offset,t.sampleList[0].offset+t.sampleList[0].size)],{type:"image/jpeg"}),r=window.URL.createObjectURL(n);o.push({start:i.mediaStartTime,end:i.mediaStartTime+i.duration,url:r}),a&&a(r)}}),!0}})}}(n,t,e)}):(n.startNumber=t.startNumber,n.segmentDuration=t.segmentDuration,n.timescale=t.timescale,n.templateUrl=function(e){var t=y.isRelative(e.media)?y.resolve(e.media,d.resolve(e.path).url):e.media;return t?Object(S.replaceIDForTemplate)(t,e.id):""}(t)),0<n.tilesHor&&0<n.tilesVert&&(n.widthPerTile=n.width/n.tilesHor,n.heightPerTile=n.height/n.tilesVert,i.push(n))}function b(){i=[],o=-1,s=null}return t={getTracks:function(){return i},addTracks:function(){if(h&&c&&(s=c.getMediaInfoForType(h,E.default.IMAGE))){var e=c.getVoRepresentations(s);e&&0<e.length&&e.forEach(function(e){(e.segmentInfoType===T.default.SEGMENT_TEMPLATE&&0<e.segmentDuration&&e.media||e.segmentInfoType===T.default.SEGMENT_TIMELINE)&&_(e),e.segmentInfoType===T.default.SEGMENT_BASE&&_(e,!0)}),0<i.length&&i.sort(function(e,t){return e.bitrate-t.bitrate})}},reset:b,setTrackByIndex:function(e){i&&0!==i.length&&(e>=i.length&&(e=i.length-1),o=e)},getCurrentTrack:function(){return o<0?null:i[o]},getCurrentTrackIndex:function(){return o},getThumbnailRequestForTime:function(e){for(var t,n=c.getVoRepresentations(s),r=0;r<n.length;r++)if(i[o].id===n[r].id){t=n[r];break}return a.getSegmentRequestForTime(s,t,e)}},b(),l=Object(x.default)(n).create({}),u=Object(C.default)(n).getInstance(),r=Object(R.default)(n).create({events:g,eventBus:m,streamInfo:h,timelineConverter:f,dashConstants:v,dashMetrics:e.dashMetrics,segmentBaseController:e.segmentBaseController,type:E.default.IMAGE}),(a=Object(M.default)(n).create({streamInfo:h,type:E.default.IMAGE,timelineConverter:f,segmentsController:r,baseURLController:d,debug:p,eventBus:m,events:g,dashConstants:v,urlUtils:y})).initialize(!!c&&c.getIsDynamic()),t}i.__dashjs_factory_name="ThumbnailTracks",t.default=r.default.getClassFactory(i)},"./src/streaming/utils/BaseURLSelector.js":function(e,t,n){n.r(t);var l=n("./src/core/errors/Errors.js"),u=n("./src/core/EventBus.js"),c=n("./src/core/events/Events.js"),d=n("./src/streaming/controllers/BlacklistController.js"),h=n("./src/streaming/utils/baseUrlResolution/DVBSelector.js"),f=n("./src/streaming/utils/baseUrlResolution/BasicSelector.js"),r=n("./src/core/FactoryMaker.js"),p=n("./src/streaming/vo/DashJSError.js"),m=n("./src/streaming/utils/SupervisorTools.js");function i(){var e,t,i,n,a,r=this.context,o=Object(u.default)(r).getInstance();function s(){t.reset()}return e={chooseSelector:function(e){Object(m.checkParameterType)(e,"boolean"),a=e?n:i},select:function(e){if(e){var t=e.baseUrls,n=e.selectedIdx;if(!isNaN(n))return t[n];var r=a.select(t);return r?(e.selectedIdx=t.indexOf(r),r):(o.trigger(c.default.URL_RESOLUTION_FAILED,{error:new p.default(l.default.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE,l.default.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE)}),void(a===i&&s()))}},reset:s,setConfig:function(e){e.selector&&(a=e.selector)}},t=Object(d.default)(r).create({updateEventName:c.default.SERVICE_LOCATION_BLACKLIST_CHANGED,addBlacklistEventName:c.default.SERVICE_LOCATION_BLACKLIST_ADD}),i=Object(f.default)(r).create({blacklistController:t}),n=Object(h.default)(r).create({blacklistController:t}),a=i,e}i.__dashjs_factory_name="BaseURLSelector",t.default=r.default.getClassFactory(i)},"./src/streaming/utils/BoxParser.js":function(e,t,n){n.r(t);var i=n("./src/core/Debug.js"),o=n("./src/streaming/utils/IsoFile.js"),r=n("./src/core/FactoryMaker.js"),a=n("./node_modules/codem-isoboxer/dist/iso_boxer.js"),s=n.n(a),c=n("./src/streaming/vo/IsoBoxSearchInfo.js");function l(){var a,e,r=this.context;function L(e){if(!e)return null;void 0===e.fileStart&&(e.fileStart=0);var t=s.a.parseBuffer(e),n=Object(o.default)(r).create();return n.setData(t),n}function l(e,t){return e[t+3]>>>0|e[t+2]<<8>>>0|e[t+1]<<16>>>0|e[t]<<24>>>0}function u(e,t){return String.fromCharCode(e[t++])+String.fromCharCode(e[t++])+String.fromCharCode(e[t++])+String.fromCharCode(e[t])}return e={parse:L,findLastTopIsoBoxCompleted:function(e,t,n){if(void 0===n&&(n=0),!t||n+8>=t.byteLength)return new c.default(0,!1);for(var r,i=t instanceof ArrayBuffer?new Uint8Array(t):t,a=0;n<i.byteLength;){var o=l(i,n),s=u(i,n+4);if(0===o)break;n+o<=i.byteLength&&(0<=e.indexOf(s)?r=new c.default(n,!0,o):a=n+o),n+=o}return r||new c.default(a,!1)},getMediaTimescaleFromMoov:function(e){var t=L(e),n=t?t.getBox("mdhd"):void 0;return n?n.timescale:NaN},getSamplesInfo:function(e){if(!e||0===e.byteLength)return{sampleList:[],lastSequenceNumber:NaN,totalDuration:NaN,numSequences:NaN};var t,n,r,i,a,o,s,l,u,c,d,h,f,p,m,g,v=L(e),y=v.getBoxes("moof"),_=v.getBoxes("mfhd");m=v.getBoxes("moof").length,p=_[_.length-1].sequence_number,a=[];var b=-1,E=-1;for(c=n=0;c<y.length;c++){var T=y[c],A=T.getChildBoxes("traf");for(l=0;l<A.length;l++){var w=A[l],S=w.getChildBox("tfhd"),C=w.getChildBox("tfdt");i=C.baseMediaDecodeTime;var x=w.getChildBoxes("trun"),M=w.getChildBoxes("subs");for(u=0;u<x.length;u++){var R=x[u];for(n=R.sample_count,f=(S.base_data_offset||0)+(R.data_offset||0),s=0;s<n;s++){t=void 0!==(o=R.samples[s]).sample_duration?o.sample_duration:S.default_sample_duration,r=void 0!==o.sample_size?o.sample_size:S.default_sample_size;var I={dts:i,cts:i+(void 0!==o.sample_composition_time_offset?o.sample_composition_time_offset:0),duration:t,offset:T.offset+f,size:r,subSizes:[r]};if(M)for(d=0;d<M.length;d++){var P=M[d];if(b<P.entry_count-1&&E<s&&(b++,E+=P.entries[b].sample_delta),s==E){I.subSizes=[];var D=P.entries[b];for(h=0;h<D.subsample_count;h++)I.subSizes.push(D.subsamples[h].subsample_size)}}a.push(I),f+=r,i+=t}}g=i-C.baseMediaDecodeTime}}return{sampleList:a,lastSequenceNumber:p,totalDuration:g,numSequences:m}},findInitRange:function(e){var t=null,n=L(e);if(!n)return t;var r=n.getBox("ftyp"),i=n.getBox("moov");return a.debug("Searching for initialization."),i&&i.isComplete&&(t=(r?r.offset:i.offset)+"-"+(i.offset+i.size-1),a.debug("Found the initialization.  Range: "+t)),t},parsePayload:function(e,t,n){if(void 0===n&&(n=0),!t||n+8>=t.byteLength)return new c.default(0,!1);for(var r,i=t instanceof ArrayBuffer?new Uint8Array(t):t,a=0;n<i.byteLength;){var o=l(i,n),s=u(i,n+4);if(0===o)break;n+o<=i.byteLength&&(0<=e.indexOf(s)?r=new c.default(n,!0,o,s):a=n+o),n+=o}return r||new c.default(a,!1)}},a=Object(i.default)(r).getInstance().getLogger(e),e}l.__dashjs_factory_name="BoxParser",t.default=r.default.getSingletonFactory(l)},"./src/streaming/utils/Capabilities.js":function(e,t,n){n.r(t),n.d(t,"supportsMediaSource",function(){return s});var r=n("./src/core/FactoryMaker.js"),i=n("./src/streaming/thumbnail/ThumbnailTracks.js"),a=n("./src/streaming/constants/Constants.js"),o=[{codec:"avc1",compatibleCodecs:["avc3"]},{codec:"avc3",compatibleCodecs:["avc1"]}];function s(){var e="WebKitMediaSource"in window,t="MediaSource"in window;return e||t}function l(){var e,n,t;return t=!(e={setConfig:function(e){e&&e.settings&&(n=e.settings)},supportsMediaSource:s,supportsEncryptedMedia:function(){return t},supportsCodec:function(e,t){return t!==a.default.AUDIO&&t!==a.default.VIDEO?Promise.resolve(!0):function(e,t){return n.get().streaming.capabilities.useMediaCapabilitiesApi&&navigator.mediaCapabilities&&navigator.mediaCapabilities.decodingInfo&&(e.codec&&t===a.default.AUDIO||t===a.default.VIDEO&&e.codec&&e.width&&e.height&&e.bitrate&&e.framerate)}(e,t)?function(n,r){return new Promise(function(t){if(n&&n.codec){var e={type:"media-source"};e[r]={},e[r].contentType=n.codec,e[r].width=n.width,e[r].height=n.height,e[r].bitrate=parseInt(n.bitrate),e[r].framerate=parseFloat(n.framerate),navigator.mediaCapabilities.decodingInfo(e).then(function(e){t(e.supported)}).catch(function(){t(!1)})}else t(!1)})}(e,t):function(n){return new Promise(function(e){if(n&&n.codec){var t=n.codec;n.width&&n.height&&(t+=';width="'+n.width+'";height="'+n.height+'"'),"MediaSource"in window&&MediaSource.isTypeSupported(t)?e(!0):"WebKitMediaSource"in window&&WebKitMediaSource.isTypeSupported(t)?e(!0):e(!1)}else e(!1)})}(e)},setEncryptedMediaSupported:function(e){t=e},supportsEssentialProperty:function(e){try{return-1!==i.THUMBNAILS_SCHEME_ID_URIS.indexOf(e.schemeIdUri)}catch(e){return!0}},codecRootCompatibleWithCodec:function(e,t){for(var n,r=e.split(".")[0],i=0===t.indexOf(r),a=0;a<o.length;a++)if(o[a].codec===r){n=o[a];break}return n?i||n.compatibleCodecs.some(function(e){return 0===t.indexOf(e)}):i}}),e}l.__dashjs_factory_name="Capabilities",t.default=r.default.getSingletonFactory(l)},"./src/streaming/utils/CapabilitiesFilter.js":function(e,t,n){n.r(t);var r=n("./src/core/FactoryMaker.js"),o=n("./src/core/Debug.js"),d=n("./src/streaming/constants/Constants.js");function i(){var e,l,u,r,c,i,t=this.context;function a(t,e){if(!e||!e.Period_asArray||0===e.Period_asArray.length)return Promise.resolve();var n=[];return e.Period_asArray.forEach(function(e){n.push(function(n,r){return new Promise(function(e){if(n&&n.AdaptationSet_asArray&&0!==n.AdaptationSet_asArray.length){var t=[];n.AdaptationSet_asArray.forEach(function(e){l.getIsTypeOf(e,r)&&t.push(function(o,s){return new Promise(function(e){if(o.Representation_asArray&&0!==o.Representation_asArray.length){var i=[],a=[];o.Representation_asArray.forEach(function(e,t){var n=l.getCodec(o,t,!1),r=function(e,t,n){switch(e){case d.default.VIDEO:return function(e,t){var n=e.width||null,r=e.height||null,i=e.frameRate||null,a=e.bandwidth||null;return{codec:t,width:n,height:r,framerate:i,bitrate:a}}(t,n);case d.default.AUDIO:return function(e,t){var n=e.audioSamplingRate||null,r=e.bandwidth||null;return{codec:t,bitrate:r,samplerate:n}}(t,n);default:return null}}(s,e,n);a.push(r),i.push(u.supportsCodec(r,s))}),Promise.all(i).then(function(n){o.Representation_asArray=o.Representation_asArray.filter(function(e,t){return n[t]||c.debug("[Stream] Codec ".concat(a[t].codec," not supported ")),n[t]}),e()}).catch(function(){e()})}else e()})}(e,r))}),Promise.all(t).then(function(){n.AdaptationSet_asArray=n.AdaptationSet_asArray.filter(function(e){var t=e.Representation_asArray&&0<e.Representation_asArray.length;return t||c.warn("AdaptationSet has been removed because of no supported Representation"),t}),e()}).catch(function(){e()})}else e()})}(e,t))}),Promise.all(n)}return e={setConfig:function(e){e&&(e.adapter&&(l=e.adapter),e.capabilities&&(u=e.capabilities),e.settings&&(r=e.settings))},filterUnsupportedFeatures:function(n){return new Promise(function(e){var t=[];t.push(a(d.default.VIDEO,n)),t.push(a(d.default.AUDIO,n)),Promise.all(t).then(function(){r.get().streaming.capabilities.filterUnsupportedEssentialProperties&&function(e){if(!e||!e.Period_asArray||0===e.Period_asArray.length)return;e.Period_asArray.forEach(function(e){e.AdaptationSet_asArray=e.AdaptationSet_asArray.filter(function(e){return!e.Representation_asArray||0===e.Representation_asArray.length||(e.Representation_asArray=e.Representation_asArray.filter(function(e){var t=l.getEssentialPropertiesForRepresentation(e);if(t&&0<t.length)for(var n=0;n<t.length;){if(!u.supportsEssentialProperty(t[n]))return c.debug("[Stream] EssentialProperty not supported: "+t[n].schemeIdUri),!1;n+=1}return!0}),e.Representation_asArray&&0<e.Representation_asArray.length)})})}(n),function(e){if(!i||0===i.length||!e||!e.Period_asArray||0===e.Period_asArray.length)return;e.Period_asArray.forEach(function(e){e.AdaptationSet_asArray=e.AdaptationSet_asArray.filter(function(e){return!e.Representation_asArray||0===e.Representation_asArray.length||(e.Representation_asArray=e.Representation_asArray.filter(function(t){return!i.some(function(e){return!e(t)})}),e.Representation_asArray&&0<e.Representation_asArray.length)})})}(n),e()}).catch(function(){e()})})},setCustomCapabilitiesFilters:function(e){i=e}},c=Object(o.default)(t).getInstance().getLogger(e),e}i.__dashjs_factory_name="CapabilitiesFilter",t.default=r.default.getSingletonFactory(i)},"./src/streaming/utils/CustomTimeRanges.js":function(e,t,n){n.r(t);var r=n("./src/core/FactoryMaker.js"),i=n("./src/streaming/utils/SupervisorTools.js");function a(){return{customTimeRangeArray:[],length:0,add:function(e,t){var n=0;for(n=0;n<this.customTimeRangeArray.length&&e>this.customTimeRangeArray[n].start;n++);for(this.customTimeRangeArray.splice(n,0,{start:e,end:t}),n=0;n<this.customTimeRangeArray.length-1;n++)this.mergeRanges(n,n+1)&&n--;this.length=this.customTimeRangeArray.length},clear:function(){this.customTimeRangeArray=[],this.length=0},remove:function(e,t){for(var n=0;n<this.customTimeRangeArray.length;n++)if(e<=this.customTimeRangeArray[n].start&&t>=this.customTimeRangeArray[n].end)this.customTimeRangeArray.splice(n,1),n--;else{if(e>this.customTimeRangeArray[n].start&&t<this.customTimeRangeArray[n].end){this.customTimeRangeArray.splice(n+1,0,{start:t,end:this.customTimeRangeArray[n].end}),this.customTimeRangeArray[n].end=e;break}e>this.customTimeRangeArray[n].start&&e<this.customTimeRangeArray[n].end?this.customTimeRangeArray[n].end=e:t>this.customTimeRangeArray[n].start&&t<this.customTimeRangeArray[n].end&&(this.customTimeRangeArray[n].start=t)}this.length=this.customTimeRangeArray.length},mergeRanges:function(e,t){var n=this.customTimeRangeArray[e],r=this.customTimeRangeArray[t];return n.start<=r.start&&r.start<=n.end&&n.end<=r.end?(n.end=r.end,this.customTimeRangeArray.splice(t,1),!0):r.start<=n.start&&n.start<=r.end&&r.end<=n.end?(n.start=r.start,this.customTimeRangeArray.splice(t,1),!0):r.start<=n.start&&n.start<=r.end&&n.end<=r.end?(this.customTimeRangeArray.splice(e,1),!0):n.start<=r.start&&r.start<=n.end&&r.end<=n.end&&(this.customTimeRangeArray.splice(t,1),!0)},start:function(e){return Object(i.checkInteger)(e),e>=this.customTimeRangeArray.length||e<0?NaN:this.customTimeRangeArray[e].start},end:function(e){return Object(i.checkInteger)(e),e>=this.customTimeRangeArray.length||e<0?NaN:this.customTimeRangeArray[e].end}}}a.__dashjs_factory_name="CustomTimeRanges",t.default=r.default.getClassFactory(a)},"./src/streaming/utils/DOMStorage.js":function(e,t,n){n.r(t);var r=n("./src/core/FactoryMaker.js"),c=n("./src/core/Debug.js"),d=n("./src/streaming/constants/Constants.js"),h=[{oldKey:"dashjs_vbitrate",newKey:"dashjs_video_bitrate"},{oldKey:"dashjs_abitrate",newKey:"dashjs_audio_bitrate"},{oldKey:"dashjs_vsettings",newKey:"dashjs_video_settings"},{oldKey:"dashjs_asettings",newKey:"dashjs_audio_settings"}],f="dashjs_?_bitrate",p="dashjs_?_settings",m="localStorage",g="lastBitrate",v="lastMediaSettings";function i(e){e=e||{};var t,o,n,r=this.context,s=e.settings;function i(e){if(void 0!==n)return n;n=!1;var t;try{"undefined"!=typeof window&&(t=window[e])}catch(e){return o.warn("DOMStorage access denied: "+e.message),n}if(!t||e!==m&&"sessionStorage"!==e)return n;try{t.setItem("1","1"),t.removeItem("1"),n=!0}catch(e){o.warn("DOMStorage is supported, but cannot be used: "+e.message)}return n}function a(){return 6e5*Math.round((new Date).getTime()/6e5)}function l(e,t){return i(e)&&s.get().streaming[t+"CachingInfo"].enabled}function u(){if(!s)throw new Error(d.default.MISSING_CONFIG_ERROR)}return t={getSavedBitrateSettings:function(e){var t=NaN;if(u(),l(m,g)){var n=f.replace(/\?/,e);try{var r=JSON.parse(localStorage.getItem(n))||{},i=(new Date).getTime()-parseInt(r.timestamp,10)>=s.get().streaming.lastBitrateCachingInfo.ttl||!1,a=parseFloat(r.bitrate);isNaN(a)||i?i&&localStorage.removeItem(n):(t=a,o.debug("Last saved bitrate for "+e+" was "+a))}catch(e){return null}}return t},setSavedBitrateSettings:function(e,t){if(l(m,g)&&t){var n=f.replace(/\?/,e);try{localStorage.setItem(n,JSON.stringify({bitrate:t.toFixed(3),timestamp:a()}))}catch(e){o.error(e.message)}}},getSavedMediaSettings:function(e){var t=null;if(u(),l(m,v)){var n=p.replace(/\?/,e);try{var r=JSON.parse(localStorage.getItem(n))||{},i=(new Date).getTime()-parseInt(r.timestamp,10)>=s.get().streaming.lastMediaSettingsCachingInfo.ttl||!1;t=r.settings,i&&(localStorage.removeItem(n),t=null)}catch(e){return null}}return t},setSavedMediaSettings:function(e,t){if(l(m,v)){var n=p.replace(/\?/,e);try{localStorage.setItem(n,JSON.stringify({settings:t,timestamp:a()}))}catch(e){o.error(e.message)}}}},o=Object(c.default)(r).getInstance().getLogger(t),i(m)&&h.forEach(function(e){var t=localStorage.getItem(e.oldKey);if(t){localStorage.removeItem(e.oldKey);try{localStorage.setItem(e.newKey,t)}catch(e){o.error(e.message)}}}),t}i.__dashjs_factory_name="DOMStorage";var a=r.default.getSingletonFactory(i);t.default=a},"./src/streaming/utils/DefaultURLUtils.js":function(e,t,n){n.r(t);var r=n("./src/core/FactoryMaker.js");function i(){function e(t,e){try{return new window.URL(t,e).toString()}catch(e){return t}}function t(e,t){var n=s;if(!t)return e;if(!c(e))return e;d(e)&&(n=l),h(e)&&(n=u);var r=n(t),i="/"!==r.charAt(r.length-1)&&"/"!==e.charAt(0)?"/":"";return[r,e].join(i)}var n,r=/^[a-z][a-z0-9+\-_.]*:/i,i=/^https?:\/\//i,a=/^https:\/\//i,o=/^([a-z][a-z0-9+\-_.]*:\/\/[^\/]+)\/?/i;function s(e){var t=e.indexOf("/"),n=e.lastIndexOf("/");return-1!==t?n===t+1?e:(-1!==e.indexOf("?")&&(e=e.substring(0,e.indexOf("?"))),e.substring(0,n+1)):""}function l(e){var t=e.match(o);return t?t[1]:""}function u(e){var t=e.match(r);return t?t[0]:""}function c(e){return!r.test(e)}function d(e){return c(e)&&"/"===e.charAt(0)}function h(e){return 0===e.indexOf("//")}return function(){try{new window.URL("x","http://y");n=e}catch(e){}finally{n=n||t}}(),{parseBaseUrl:s,parseOrigin:l,parseScheme:u,isRelative:c,isPathAbsolute:d,isSchemeRelative:h,isHTTPURL:function(e){return i.test(e)},isHTTPS:function(e){return a.test(e)},removeHostname:function(e){return/^(?:\w+\:\/\/)?([^\/]+)(.*)$/.exec(e)[2].substring(1)},resolve:function(e,t){return n(e,t)}}}i.__dashjs_factory_name="DefaultURLUtils",t.default=r.default.getSingletonFactory(i)},"./src/streaming/utils/EBMLParser.js":function(e,t,n){n.r(t);var r=n("./src/core/FactoryMaker.js");function i(e){var n;e=e||{};var s=new DataView(e.data),l=0;function i(e,t){var n=!0,r=0;if(void 0===t&&(t=!1),r=16777215<e.tag?(s.getUint32(l)!==e.tag&&(n=!1),4):65535<e.tag?(256*s.getUint16(l)+s.getUint8(l+2)!==e.tag&&(n=!1),3):255<e.tag?(s.getUint16(l)!==e.tag&&(n=!1),2):(s.getUint8(l)!==e.tag&&(n=!1),1),!n&&e.required&&!t)throw new Error("required tag not found");return n&&(l+=r),n}function a(e){var t=1,n=128,r=-1,i=0,a=s.getUint8(l),o=0;for(o=0;o<8;o+=1){if((a&n)===n){i=void 0===e?a&~n:a,r=o;break}n>>=1}for(o=0;o<r;o+=1,t+=1)i=i<<8|255&s.getUint8(l+t);return l+=t,i}return n={getPos:function(){return l},setPos:function(e){l=e},consumeTag:i,consumeTagAndSize:function(e,t){var n=i(e,t);return n&&a(),n},parseTag:function(e){var t;return i(e),t=a(),n[e.parse](t)},skipOverElement:function(e,t){var n,r=i(e,t);return r&&(n=a(),l+=n),r},getMatroskaCodedNum:a,getMatroskaFloat:function(e){var t;switch(e){case 4:t=s.getFloat32(l),l+=4;break;case 8:t=s.getFloat64(l),l+=8}return t},getMatroskaUint:function(e){for(var t=0,n=0;n<e;n+=1)t<<=8,t|=255&s.getUint8(l+n);return l+=e,t},moreData:function(){return l<s.byteLength}}}i.__dashjs_factory_name="EBMLParser",t.default=r.default.getClassFactory(i)},"./src/streaming/utils/ErrorHandler.js":function(e,t,n){n.r(t);var r=n("./src/core/EventBus.js"),i=n("./src/core/events/Events.js"),a=n("./src/core/FactoryMaker.js");function o(){var e=this.context,t=Object(r.default)(e).getInstance();return{error:function(e){t.trigger(i.default.ERROR,{error:e})}}}o.__dashjs_factory_name="ErrorHandler",t.default=a.default.getSingletonFactory(o)},"./src/streaming/utils/InitCache.js":function(e,t,n){n.r(t);var r=n("./src/core/FactoryMaker.js");function i(){var r={};return{save:function(e){var t=e.streamId,n=e.representationId;r[t]=r[t]||{},r[t][n]=e},extract:function(e,t){return r&&r[e]&&r[e][t]?r[e][t]:null},reset:function(){r={}}}}i.__dashjs_factory_name="InitCache",t.default=r.default.getSingletonFactory(i)},"./src/streaming/utils/IsoFile.js":function(e,t,n){n.r(t);var r=n("./src/streaming/vo/IsoBox.js"),i=n("./src/core/FactoryMaker.js");function a(){var o;function t(e){var t=[];if(!e||!o||"function"!=typeof o.fetchAll)return t;for(var n,r=o.fetchAll(e),i=0,a=r.length;i<a;i++)(n=s(r[i]))&&t.push(n);return t}function s(e){if(!e)return null;var t=new r.default(e);return e.hasOwnProperty("_incomplete")&&(t.isComplete=!e._incomplete),t}return{getBox:function(e){return e&&o&&o.boxes&&0!==o.boxes.length&&"function"==typeof o.fetch?s(o.fetch(e)):null},getBoxes:t,setData:function(e){o=e},getLastBox:function(){if(!o||!o.boxes||!o.boxes.length)return null;var e=t(o.boxes[o.boxes.length-1].type);return 0<e.length?e[e.length-1]:null}}}a.__dashjs_factory_name="IsoFile",t.default=i.default.getClassFactory(a)},"./src/streaming/utils/ObjectUtils.js":function(e,t,n){n.r(t);var r=n("./src/core/FactoryMaker.js"),i=n("./node_modules/fast-deep-equal/index.js"),a=n.n(i);function o(){return{areEqual:function(e,t){return a()(e,t)}}}o.__dashjs_factory_name="ObjectUtils",t.default=r.default.getSingletonFactory(o)},"./src/streaming/utils/RequestModifier.js":function(e,t,n){n.r(t);var r=n("./src/core/FactoryMaker.js");function i(){return{modifyRequestURL:function(e){return e},modifyRequestHeader:function(e){return e}}}i.__dashjs_factory_name="RequestModifier",t.default=r.default.getSingletonFactory(i)},"./src/streaming/utils/SupervisorTools.js":function(e,t,n){n.r(t),n.d(t,"checkParameterType",function(){return a}),n.d(t,"checkInteger",function(){return o}),n.d(t,"checkRange",function(){return s}),n.d(t,"checkIsVideoOrAudioType",function(){return l});var r=n("./src/streaming/constants/Constants.js");function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){if(i(e)!==t)throw r.default.BAD_ARGUMENT_ERROR}function o(e){if(!(null!==e&&!isNaN(e)&&e%1==0))throw r.default.BAD_ARGUMENT_ERROR+" : argument is not an integer"}function s(e,t,n){if(e<t||n<e)throw r.default.BAD_ARGUMENT_ERROR+" : argument out of range"}function l(e){if("string"!=typeof e||e!==r.default.AUDIO&&e!==r.default.VIDEO)throw r.default.BAD_ARGUMENT_ERROR}},"./src/streaming/utils/TTMLParser.js":function(e,t,n){n.r(t);var r=n("./src/core/FactoryMaker.js"),i=n("./src/core/Debug.js"),a=n("./src/core/EventBus.js"),T=n("./src/core/events/Events.js"),A=n("./node_modules/imsc/src/main/js/main.js"),w=n("./src/streaming/MediaPlayerEvents.js"),S=n("./src/streaming/constants/ConformanceViolationConstants.js");function o(){var e,_,t=this.context,b=Object(a.default)(t).getInstance(),E=0;return e={parse:function(e,t,n,r,i){var a,o,s,l="",u=[],c={},d={},h="",f="",p={onOpenTag:function(e,t,n){if(n[" imagetype"]&&!n[" imageType"]&&(b.trigger(w.default.CONFORMANCE_VIOLATION,{level:S.default.LEVELS.ERROR,event:S.default.EVENTS.NON_COMPLIANT_SMPTE_IMAGE_ATTRIBUTE}),n[" imageType"]=n[" imagetype"]),"image"===t&&("http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt"===e||"http://www.smpte-ra.org/schemas/2052-1/2013/smpte-tt"===e)){if(!n[" imageType"]||"PNG"!==n[" imageType"].value)return void _.warn("smpte-tt imageType != PNG. Discarded");h=n["http://www.w3.org/XML/1998/namespace id"].value}},onCloseTag:function(){h&&(d[h]=f.trim()),h=f=""},onText:function(e){h&&(f+=e)}};if(!e)throw l="no ttml data to parse",new Error(l);c.data=e,b.trigger(T.default.TTML_TO_PARSE,c);var m=Object(A.fromXML)(c.data,function(e){l=e},p);b.trigger(T.default.TTML_PARSED,{ttmlString:c.data,ttmlDoc:m});var g,v=m.getMediaTimeEvents();for(s=0;s<v.length;s++){var y=Object(A.generateISD)(m,v[s],function(e){l=e});y.contents.some(function(e){return e.contents.length})&&(a=v[s]+t<n?n:v[s]+t)<(o=v[s+1]+t>r?r:v[s+1]+t)&&u.push({start:a,end:o,type:"html",cueID:(void 0,g="cue_TTML_"+E,E++,g),isd:y,images:i,embeddedImages:d})}if(""!==l)throw _.error(l),new Error(l);return u}},_=Object(i.default)(t).getInstance().getLogger(e),e}o.__dashjs_factory_name="TTMLParser",t.default=r.default.getSingletonFactory(o)},"./src/streaming/utils/URLUtils.js":function(e,t,n){n.r(t);var r=n("./src/core/FactoryMaker.js"),o=n("./src/streaming/utils/DefaultURLUtils.js");function i(){var i,a=[],e=this.context;function n(e,t,n){var r=function(e){var t;for(t=0;t<a.length;t++){if(a[t].regex.test(e))return a[t].utils}return i}(n||t);return r&&"function"==typeof r[e]?r[e](t,n):i[e](t,n)}return i=Object(o.default)(e).getInstance(),{registerUrlRegex:function(e,t){a.push({regex:e,utils:t})},parseBaseUrl:function(e){return n("parseBaseUrl",e)},parseOrigin:function(e){return n("parseOrigin",e)},parseScheme:function(e){return n("parseScheme",e)},isRelative:function(e){return n("isRelative",e)},isPathAbsolute:function(e){return n("isPathAbsolute",e)},isSchemeRelative:function(e){return n("isSchemeRelative",e)},isHTTPURL:function(e){return n("isHTTPURL",e)},isHTTPS:function(e){return n("isHTTPS",e)},removeHostname:function(e){return n("removeHostname",e)},resolve:function(e,t){return n("resolve",e,t)}}}i.__dashjs_factory_name="URLUtils";var a=r.default.getSingletonFactory(i);t.default=a},"./src/streaming/utils/VTTParser.js":function(e,t,n){n.r(t);var r=n("./src/core/FactoryMaker.js"),i=n("./src/core/Debug.js");function a(){var e,h,f,p,m,r,t=this.context;function g(e){var t=e.split(":"),n=t.length-1;return e=60*parseInt(t[n-1],10)+parseFloat(t[n]),2==n&&(e+=3600*parseInt(t[0],10)),e}function v(e){var t=e.split(p),n=t[1].split(r);return n.shift(),t[1]=n[0],n.shift(),{cuePoints:t,styles:function(e){var n={};return e.forEach(function(e){if(1<e.split(/:/).length){var t=e.split(/:/)[1];t&&-1!=t.search(/%/)&&(t=parseInt(t.replace(/%/,""),10)),(e.match(/align/)||e.match(/A/))&&(n.align=t),(e.match(/line/)||e.match(/L/))&&(n.line=t),(e.match(/position/)||e.match(/P/))&&(n.position=t),(e.match(/size/)||e.match(/S/))&&(n.size=t)}}),n}(n)}}function y(e,t){for(var n,r=t,i="",a="";""!==e[r]&&r<e.length;)r++;if(1<(n=r-t))for(var o=0;o<n;o++){if((a=e[t+o]).match(p)){i="";break}i+=a,o!==n-1&&(i+="\n")}else(a=e[t]).match(p)||(i=a);return i}return e={parse:function(e){var t,n,r=[];if(!e)return r;t=(e=e.split(f)).length,n=-1;for(var i=0;i<t;i++){var a=e[i];if(0<a.length&&"WEBVTT"!==a&&a.match(p)){var o=v(a),s=o.cuePoints,l=o.styles,u=y(e,i+1),c=g(s[0].replace(m,"")),d=g(s[1].replace(m,""));!isNaN(c)&&!isNaN(d)&&n<=c&&c<d?""!==u?(n=c,r.push({start:c,end:d,data:u,styles:l})):h.error("Skipping cue due to empty/malformed cue text"):h.error("Skipping cue due to incorrect cue timing")}}return r}},h=Object(i.default)(t).getInstance().getLogger(e),f=/(?:\r\n|\r|\n)/gm,p=/-->/,m=/(^[\s]+|[\s]+$)/g,r=/\s\b/g,e}a.__dashjs_factory_name="VTTParser",t.default=r.default.getSingletonFactory(a)},"./src/streaming/utils/baseUrlResolution/BasicSelector.js":function(e,t,n){n.r(t);var r=n("./src/core/FactoryMaker.js");function i(e){var r=(e=e||{}).blacklistController;return{select:function(e){var t,n=0;return e&&e.some(function(e,t){return n=t,!r.contains(e.serviceLocation)})&&(t=e[n]),t}}}i.__dashjs_factory_name="BasicSelector",t.default=r.default.getClassFactory(i)},"./src/streaming/utils/baseUrlResolution/DVBSelector.js":function(e,t,n){n.r(t);var r=n("./src/core/FactoryMaker.js");function i(e){var n=(e=e||{}).blacklistController;return{select:function(e){return e&&function(e){var n,t,r=0,i=[],a=0;if((t=e.sort(function(e,t){var n=e.dvb_priority-t.dvb_priority;return isNaN(n)?0:n}).filter(function(e,t,n){return!t||n[0].dvb_priority&&e.dvb_priority&&n[0].dvb_priority===e.dvb_priority})).length)return 1<t.length&&(t.forEach(function(e){r+=e.dvb_weight,i.push(r)}),n=Math.floor(Math.random()*(r-1)),i.every(function(e,t){return a=t,!(n<e)})),t[a]}(function(e){var t=[];return e.filter(function(e){return!n.contains(e.serviceLocation)||(e.dvb_priority&&t.push(e.dvb_priority),!1)}).filter(function(e){return!t.length||!e.dvb_priority||-1===t.indexOf(e.dvb_priority)})}(e))}}}i.__dashjs_factory_name="DVBSelector",t.default=r.default.getClassFactory(i)},"./src/streaming/vo/BitrateInfo.js":function(e,t,n){n.r(t);t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mediaType=null,this.bitrate=null,this.width=null,this.height=null,this.scanType=null,this.qualityIndex=NaN}},"./src/streaming/vo/DashJSError.js":function(e,t,n){n.r(t);t.default=function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.code=t||null,this.message=n||null,this.data=r||null}},"./src/streaming/vo/DataChunk.js":function(e,t,n){n.r(t);t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.streamId=null,this.mediaInfo=null,this.segmentType=null,this.quality=NaN,this.index=NaN,this.bytes=null,this.start=NaN,this.end=NaN,this.duration=NaN,this.representationId=null,this.endFragment=null}},"./src/streaming/vo/FragmentRequest.js":function(e,t,n){n.r(t);var r=n("./src/streaming/vo/metrics/HTTPRequest.js");function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.action=t.ACTION_DOWNLOAD,this.startTime=NaN,this.mediaStartTime=NaN,this.mediaType=null,this.mediaInfo=null,this.type=null,this.duration=NaN,this.timescale=NaN,this.range=null,this.url=e||null,this.serviceLocation=null,this.requestStartDate=null,this.firstByteDate=null,this.requestEndDate=null,this.quality=NaN,this.index=NaN,this.availabilityStartTime=null,this.availabilityEndTime=null,this.wallStartTime=null,this.bytesLoaded=NaN,this.bytesTotal=NaN,this.delayLoadingTime=NaN,this.responseType="arraybuffer",this.representationId=null}return function(e,t,n){t&&i(e.prototype,t),n&&i(e,n)}(t,[{key:"isInitializationRequest",value:function(){return this.type&&this.type===r.HTTPRequest.INIT_SEGMENT_TYPE}},{key:"setInfo",value:function(e){this.type=e&&e.init?r.HTTPRequest.INIT_SEGMENT_TYPE:r.HTTPRequest.MEDIA_SEGMENT_TYPE,this.url=e&&e.url?e.url:null,this.range=e&&e.range?e.range.start+"-"+e.range.end:null,this.mediaType=e&&e.mediaType?e.mediaType:null}}]),t}();a.ACTION_DOWNLOAD="download",a.ACTION_COMPLETE="complete",t.default=a},"./src/streaming/vo/HeadRequest.js":function(e,t,n){n.r(t);var i=n("./src/streaming/vo/FragmentRequest.js");function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=l(r);if(i){var n=l(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}(this,e)}}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var r=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(r,i["default"]);var n=s(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=n.call(this,e)).checkForExistenceOnly=!0,t}return r}();t.default=r},"./src/streaming/vo/IsoBox.js":function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.r(t);var i=function(){function s(e){if(!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),this.offset=e._offset,this.type=e.type,this.size=e.size,this.boxes=[],e.boxes)for(var t=0;t<e.boxes.length;t++)this.boxes.push(new s(e.boxes[t]));switch(this.isComplete=!0,e.type){case"sidx":if(this.timescale=e.timescale,this.earliest_presentation_time=e.earliest_presentation_time,this.first_offset=e.first_offset,this.references=e.references,e.references){this.references=[];for(var n=0;n<e.references.length;n++){var r={reference_type:e.references[n].reference_type,referenced_size:e.references[n].referenced_size,subsegment_duration:e.references[n].subsegment_duration};this.references.push(r)}}break;case"emsg":this.id=e.id,this.version=1===e.version?1:0,this.value=e.value,this.timescale=e.timescale,this.scheme_id_uri=e.scheme_id_uri,this.presentation_time_delta=1===e.version?e.presentation_time:e.presentation_time_delta,this.event_duration=e.event_duration,this.message_data=e.message_data;break;case"mdhd":this.timescale=e.timescale;break;case"mfhd":this.sequence_number=e.sequence_number;break;case"subs":this.entry_count=e.entry_count,this.entries=e.entries;break;case"tfhd":this.base_data_offset=e.base_data_offset,this.sample_description_index=e.sample_description_index,this.default_sample_duration=e.default_sample_duration,this.default_sample_size=e.default_sample_size,this.default_sample_flags=e.default_sample_flags,this.flags=e.flags;break;case"tfdt":this.version=e.version,this.baseMediaDecodeTime=e.baseMediaDecodeTime,this.flags=e.flags;break;case"trun":if(this.sample_count=e.sample_count,this.first_sample_flags=e.first_sample_flags,this.data_offset=e.data_offset,this.flags=e.flags,this.samples=e.samples,e.samples){this.samples=[];for(var i=0,a=e.samples.length;i<a;i++){var o={sample_size:e.samples[i].sample_size,sample_duration:e.samples[i].sample_duration,sample_composition_time_offset:e.samples[i].sample_composition_time_offset};this.samples.push(o)}}}}return function(e,t,n){t&&r(e.prototype,t),n&&r(e,n)}(s,[{key:"getChildBox",value:function(e){for(var t=0;t<this.boxes.length;t++)if(this.boxes[t].type===e)return this.boxes[t]}},{key:"getChildBoxes",value:function(e){for(var t=[],n=0;n<this.boxes.length;n++)this.boxes[n].type===e&&t.push(this.boxes[n]);return t}}]),s}();t.default=i},"./src/streaming/vo/IsoBoxSearchInfo.js":function(e,t,n){n.r(t);t.default=function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.lastCompletedOffset=t,this.found=n,this.size=r}},"./src/streaming/vo/MetricsList.js":function(e,t,n){n.r(t);t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.TcpList=[],this.HttpList=[],this.RepSwitchList=[],this.BufferLevel=[],this.BufferState=[],this.PlayList=[],this.DroppedFrames=[],this.SchedulingInfo=[],this.DVRInfo=[],this.ManifestUpdate=[],this.RequestsQueue=null,this.DVBErrors=[]}},"./src/streaming/vo/TextRequest.js":function(e,t,n){n.r(t);var a=n("./src/streaming/constants/Constants.js"),o=n("./src/streaming/vo/FragmentRequest.js");function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=c(r);if(i){var n=c(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}(this,e)}}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var r=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(i,o["default"]);var r=u(i);function i(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(n=r.call(this)).url=e||null,n.type=t||null,n.mediaType=a.default.STREAM,n.responseType="",n}return i}();t.default=r},"./src/streaming/vo/TextTrackInfo.js":function(e,t,n){n.r(t);var r=n("./src/dash/vo/MediaInfo.js");function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=s(r);if(i){var n=s(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}(this,e)}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(n,r["default"]);var t=o(n);function n(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=t.call(this)).captionData=null,e.label=null,e.defaultTrack=!1,e.kind=null,e.isFragmented=!1,e.isEmbedded=!1,e.isTTML=null,e}return n}();t.default=l},"./src/streaming/vo/Thumbnail.js":function(e,t,n){n.r(t);t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=null,this.width=null,this.height=null,this.x=null,this.y=null}},"./src/streaming/vo/ThumbnailTrackInfo.js":function(e,t,n){n.r(t);t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.bitrate=0,this.width=0,this.height=0,this.tilesHor=0,this.tilesVert=0,this.widthPerTile=0,this.heightPerTile=0,this.startNumber=0,this.segmentDuration=0,this.timescale=0,this.templateUrl="",this.id=""}},"./src/streaming/vo/URIFragmentData.js":function(e,t,n){n.r(t);t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.t=null,this.xywh=null,this.track=null,this.id=null,this.s=null,this.r=null}},"./src/streaming/vo/metrics/BufferLevel.js":function(e,t,n){n.r(t);t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.t=null,this.level=null}},"./src/streaming/vo/metrics/BufferState.js":function(e,t,n){n.r(t);var r=n("./src/streaming/constants/MetricsConstants.js");t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.target=null,this.state=r.default.BUFFER_EMPTY}},"./src/streaming/vo/metrics/DVRInfo.js":function(e,t,n){n.r(t);t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.time=null,this.range=null,this.manifestInfo=null}},"./src/streaming/vo/metrics/DroppedFrames.js":function(e,t,n){n.r(t);t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.time=null,this.droppedFrames=null}},"./src/streaming/vo/metrics/HTTPRequest.js":function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.r(t),n.d(t,"HTTPRequest",function(){return i}),n.d(t,"HTTPRequestTrace",function(){return a});var i=function e(){r(this,e),this.tcpid=null,this.type=null,this.url=null,this.actualurl=null,this.range=null,this.trequest=null,this.tresponse=null,this.responsecode=null,this.interval=null,this.trace=[],this._stream=null,this._tfinish=null,this._mediaduration=null,this._quality=null,this._responseHeaders=null,this._serviceLocation=null},a=function e(){r(this,e),this.s=null,this.d=null,this.b=[],this.t=null};i.GET="GET",i.HEAD="HEAD",i.MPD_TYPE="MPD",i.XLINK_EXPANSION_TYPE="XLinkExpansion",i.INIT_SEGMENT_TYPE="InitializationSegment",i.INDEX_SEGMENT_TYPE="IndexSegment",i.MEDIA_SEGMENT_TYPE="MediaSegment",i.BITSTREAM_SWITCHING_SEGMENT_TYPE="BitstreamSwitchingSegment",i.MSS_FRAGMENT_INFO_SEGMENT_TYPE="FragmentInfoSegment",i.LICENSE="license",i.OTHER_TYPE="other"},"./src/streaming/vo/metrics/ManifestUpdate.js":function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.r(t),n.d(t,"ManifestUpdate",function(){return i}),n.d(t,"ManifestUpdateStreamInfo",function(){return a}),n.d(t,"ManifestUpdateRepresentationInfo",function(){return o});var i=function e(){r(this,e),this.mediaType=null,this.type=null,this.requestTime=null,this.fetchTime=null,this.availabilityStartTime=null,this.presentationStartTime=0,this.clientTimeOffset=0,this.currentTime=null,this.buffered=null,this.latency=0,this.streamInfo=[],this.representationInfo=[]},a=function e(){r(this,e),this.id=null,this.index=null,this.start=null,this.duration=null},o=function e(){r(this,e),this.id=null,this.index=null,this.mediaType=null,this.streamIndex=null,this.presentationTimeOffset=null,this.startNumber=null,this.fragmentInfoType=null}},"./src/streaming/vo/metrics/PlayList.js":function(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.r(t),n.d(t,"PlayList",function(){return i}),n.d(t,"PlayListTrace",function(){return a});var i=function e(){r(this,e),this.start=null,this.mstart=null,this.starttype=null,this.trace=[]};i.INITIAL_PLAYOUT_START_REASON="initial_playout",i.SEEK_START_REASON="seek",i.RESUME_FROM_PAUSE_START_REASON="resume",i.METRICS_COLLECTION_START_REASON="metrics_collection_start";var a=function e(){r(this,e),this.representationid=null,this.subreplevel=null,this.start=null,this.mstart=null,this.duration=null,this.playbackspeed=null,this.stopreason=null};a.REPRESENTATION_SWITCH_STOP_REASON="representation_switch",a.REBUFFERING_REASON="rebuffering",a.USER_REQUEST_STOP_REASON="user_request",a.END_OF_PERIOD_STOP_REASON="end_of_period",a.END_OF_CONTENT_STOP_REASON="end_of_content",a.METRICS_COLLECTION_STOP_REASON="metrics_collection_end",a.FAILURE_STOP_REASON="failure"},"./src/streaming/vo/metrics/RepresentationSwitch.js":function(e,t,n){n.r(t);t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.t=null,this.mt=null,this.to=null,this.lto=null}},"./src/streaming/vo/metrics/RequestsQueue.js":function(e,t,n){n.r(t);t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.loadingRequests=[],this.executedRequests=[]}},"./src/streaming/vo/metrics/SchedulingInfo.js":function(e,t,n){n.r(t);t.default=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mediaType=null,this.t=null,this.type=null,this.startTime=null,this.availabilityStartTime=null,this.duration=null,this.quality=null,this.range=null,this.state=null}},0:function(e,t){},1:function(e,t){}},i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/dist/",i(i.s="./index.js")).default;function i(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,i),t.l=!0,t.exports}var n,r},e.exports=n()}(e={exports:{}},e.exports),e.exports),d=(t=r)&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t;function o(e,t){e.dash.mediaPlayer.on(d.MediaPlayer.events.PLAYBACK_METADATA_LOADED,function(e,t){var r=e.dash.mediaPlayer;e.dashQualityLevels=r.getBitrateInfoListFor("video"),e.trigger("dashQualityLevels"),e.on("dashQualityLevelsSelected",function(e){var t=e.target.player.dashQualityLevelsSelected,n={streaming:{abr:{autoSwitchBitrate:{}}}};n.streaming.abr.autoSwitchBitrate.video=!1,r.updateSettings(n),r.setQualityFor("video",t,!0)}),e.on("dashQualityLevelsSelectAuto",function(e){var t={streaming:{abr:{autoSwitchBitrate:{}}}};t.streaming.abr.autoSwitchBitrate.video=!0,r.updateSettings(t)})}.bind(null,e,t))}function u(i,e){var r=i.dash.mediaPlayer,a=r.getTracksFor("audio"),o=i.audioTracks();function s(e){return"dash-audio-"+e}function l(e,t){return e.find(function(e){return s(e.index)===t.id})}o.length&&e.clearTracks(["audio"]);var u=r.getCurrentTrackFor("audio");a.forEach(function(e){var t,n;if(Array.isArray(e.labels))for(var r=0;r<e.labels.length;r++)if(e.labels[r].lang&&-1!==i.language().indexOf(e.labels[r].lang.toLowerCase())){t=e.labels[r];break}t?n=t.text:Array.isArray(e.labels)&&1===e.labels.length?n=e.labels[0].text:(n=e.lang,e.roles&&e.roles.length&&(n+=" ("+e.roles.join(", ")+")")),o.addTrack(new c.AudioTrack({enabled:e===u,id:s(e.index),kind:e.kind||"main",label:n,language:e.lang}))});function t(){for(var e=0;e<o.length;e++){var t=o[e];if(t.enabled){var n=l(a,t);r.setCurrentTrack(n)}else;}}o.addEventListener("change",t),i.dash.mediaPlayer.on(d.MediaPlayer.events.STREAM_TEARDOWN_COMPLETE,function(){o.removeEventListener("change",t)})}function h(o,e,s){var l=[],t=s.map(function(e){var t;if(Array.isArray(e.labels))for(var n=0;n<e.labels.length;n++)if(e.labels[n].lang&&-1!==o.language().indexOf(e.labels[n].lang.toLowerCase())){t=e.labels[n];break}return{dashTrack:e,trackConfig:{label:t?t.text:Array.isArray(e.labels)&&1===e.labels.length?e.labels[0].text:e.lang||e.label,language:e.lang,srclang:e.lang,kind:e.kind}}}).map(function(e){var t=e.trackConfig,n=e.dashTrack;if(n.isTTML&&!o.getChild("TTMLTextTrackDisplay"))return null;var r=o.addRemoteTextTrack(t,!1);return l.push({textTrack:r.track,dashTrack:n}),r}).filter(function(e){return null!==e});function n(){for(var e=o.dash.mediaPlayer,i=o.textTracks(),a=-1,t=function(e){var t=i[e];if("showing"===t.mode){var n=function(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return e[n]}(l,function(e){return e.textTrack===t}),r=n?n.dashTrack:null;r&&(a=s.indexOf(r))}},n=0;n<i.length;n+=1)t(n);a!==e.getCurrentTextTrackIndex()&&e.setTextTrack(a)}return o.textTracks().on("change",n),o.dash.mediaPlayer.on(d.MediaPlayer.events.STREAM_TEARDOWN_COMPLETE,function(){o.textTracks().off("change",n)}),n(),t}function f(n,e,t){l.VTTCue&&!/\[native code\]/.test(l.VTTCue.toString())&&(l.VTTCue=!1);var r=[];if(e.featuresNativeTextTracks)c.log.error("You must pass {html: {nativeCaptions: false}} in the videojs constructor to use text tracks in videojs-contrib-dash");else{var i=n.dash.mediaPlayer;i.on(d.MediaPlayer.events.TEXT_TRACKS_ADDED,a),i.on(d.MediaPlayer.events.CAN_PLAY,function(){i.off(d.MediaPlayer.events.TEXT_TRACKS_ADDED,a)})}function a(e){e.index;var t=e.tracks;i.off(d.MediaPlayer.events.TEXT_TRACKS_ADDED,a),r.forEach(n.removeRemoteTextTrack.bind(n)),r=[],t.length&&(r=h(n,0,t))}}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var m=c.getComponent("Component"),g={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function v(e,t,n){try{e.style[t]=n}catch(e){return}}function y(e,t){var n;if(4===e.length)n=e[1]+e[1]+e[2]+e[2]+e[3]+e[3];else{if(7!==e.length)throw new Error("Invalid color code provided, "+e+"; must be formatted as e.g. #f0e or #f604e2.");n=e.slice(1)}return"rgba("+parseInt(n.slice(0,2),16)+","+parseInt(n.slice(2,4),16)+","+parseInt(n.slice(4,6),16)+","+t+")"}var _=function(o){function e(e,t,n){var r;r=o.call(this,e,c.mergeOptions(t,{playerOptions:{}}),n)||this;for(var i=e.getChild("TextTrackSettings").$$("select"),a=0;a<i.length;a++)r.on(i[a],"change",r.updateStyle.bind(p(r)));return e.dash.mediaPlayer.on(d.MediaPlayer.events.CAPTION_RENDERED,r.updateStyle.bind(p(r))),r}!function(e,t){e.prototype=Object.create(t.prototype),i(e.prototype.constructor=e,t)}(e,o);var t=e.prototype;return t.createEl=function(){var e=o.prototype.createEl.call(this,"div",{className:"vjs-text-track-display-ttml"},{"aria-live":"off","aria-atomic":"true"});return e.style.position="absolute",e.style.left="0",e.style.right="0",e.style.top="0",e.style.bottom="0",e.style.margin="1.5%",e},t.updateStyle=function(e){var t=e.captionDiv;if(this.player_.textTrackSettings){var n=this.player_.textTrackSettings.getValues();if(t=t||this.player_.getChild("TTMLTextTrackDisplay").el().firstChild){!function e(t){for(var n in t.style&&(t.style.left=null,t.style.width="100%"),t.children)e(t.children[n])}(t);for(var r=t.getElementsByTagName("span"),i=0;i<r.length;i++){var a=r[i];if(a.parentNode.style.textAlign="center",n.color&&(a.style.color=n.color),n.textOpacity&&v(a,"color",y(n.color||"#fff",n.textOpacity)),n.backgroundColor&&(a.style.backgroundColor=n.backgroundColor),n.backgroundOpacity&&v(a,"backgroundColor",y(n.backgroundColor||"#000",n.backgroundOpacity)),n.windowColor&&(n.windowOpacity?v(a.parentNode,"backgroundColor",y(n.windowColor,n.windowOpacity)):a.parent.style.backgroundColor=n.windowColor),n.edgeStyle&&("dropshadow"===n.edgeStyle?a.style.textShadow="2px 2px 3px #222, 2px 2px 4px #222, 2px 2px 5px #222":"raised"===n.edgeStyle?a.style.textShadow="1px 1px #222, 2px 2px #222, 3px 3px #222":"depressed"===n.edgeStyle?a.style.textShadow="1px 1px #ccc, 0 1px #ccc, -1px -1px #222, 0 -1px #222":"uniform"===n.edgeStyle&&(a.style.textShadow="0 0 4px #222, 0 0 4px #222, 0 0 4px #222, 0 0 4px #222")),n.fontPercent&&1!==n.fontPercent){var o=l.parseFloat(a.style.fontSize);a.style.fontSize=o*n.fontPercent+"px",a.style.height="auto",a.style.top="auto",a.style.bottom="2px"}n.fontFamily&&"default"!==n.fontFamily&&("small-caps"===n.fontFamily?a.style.fontVariant="small-caps":a.style.fontFamily=g[n.fontFamily])}}}},e}(m);c.registerComponent("TTMLTextTrackDisplay",_);var b=function(){function r(t,e,i){var a=this;if(i=i||e.options_,this.player=c(i.playerId),this.player.dash=this.player.dash||{},this.tech_=e,this.el_=e.el(),this.elParent_=this.el_.parentNode,this.hasFiniteDuration_=!1,t.src){e.isReady_=!1,r.updateSourceData&&(c.log.warn('updateSourceData has been deprecated. Please switch to using hook("updatesource", callback).'),t=r.updateSourceData(t)),r.hooks("updatesource").forEach(function(e){t=e(t)});var n=t.src;this.keySystemOptions_=r.buildDashJSProtData(t.keySystemOptions),this.player.dash.mediaPlayer=d.MediaPlayer().create(),this.mediaPlayer_=this.player.dash.mediaPlayer,r.useVideoJSDebug&&(c.log.warn('useVideoJSDebug has been deprecated. Please switch to using hook("beforeinitialize", callback).'),r.useVideoJSDebug(this.mediaPlayer_)),r.beforeInitialize&&(c.log.warn('beforeInitialize has been deprecated. Please switch to using hook("beforeinitialize", callback).'),r.beforeInitialize(this.player,this.mediaPlayer_)),r.hooks("beforeinitialize").forEach(function(e){e(a.player,a.mediaPlayer_)}),this.mediaPlayer_.initialize(),this.retriggerError_=function(e){if("capability"===e.error&&"mediasource"===e.event)a.player.error({code:4,message:"The media cannot be played because it requires a feature that your browser does not support."});else if("manifestError"!==e.error||"createParser"!==e.event.id&&"codec"!==e.event.id&&"nostreams"!==e.event.id&&"nostreamscomposed"!==e.event.id&&"parse"!==e.event.id&&"multiplexedrep"!==e.event.id)if("mediasource"===e.error)e.event.match("MEDIA_ERR_ABORTED")?a.player.error({code:1,message:e.event}):e.event.match("MEDIA_ERR_NETWORK")?a.player.error({code:2,message:e.event}):e.event.match("MEDIA_ERR_DECODE")?a.player.error({code:3,message:e.event}):e.event.match("MEDIA_ERR_SRC_NOT_SUPPORTED")?a.player.error({code:4,message:e.event}):e.event.match("MEDIA_ERR_ENCRYPTED")?a.player.error({code:5,message:e.event}):(e.event.match("UNKNOWN"),a.player.error({code:4,message:e.event}));else if("capability"===e.error&&"encryptedmedia"===e.event)a.player.error({code:5,message:"The media cannot be played because it requires encryption features that your browser does not support."});else if("key_session"===e.error)a.player.error({code:5,message:e.event});else if("download"===e.error)a.player.error({code:2,message:"The media playback was aborted because too many consecutive download errors occurred."});else{if("mssError"!==e.error)return;a.player.error({code:3,message:e.event})}else a.player.error({code:4,message:e.event.message});setTimeout(function(){a.mediaPlayer_.reset()},10)},this.mediaPlayer_.on(d.MediaPlayer.events.ERROR,this.retriggerError_),this.getDuration_=function(e){var t=e.data.Period_asArray,n=a.hasFiniteDuration_;e.data.mediaPresentationDuration||t[t.length-1].duration?a.hasFiniteDuration_=!0:a.hasFiniteDuration_=!1,a.hasFiniteDuration_!==n&&a.player.trigger("durationchange")},this.mediaPlayer_.on(d.MediaPlayer.events.MANIFEST_LOADED,this.getDuration_),i.dash&&Object.keys(i.dash).forEach(function(e){var t;if("useTTML"!==e){var n="set"+e.charAt(0).toUpperCase()+e.slice(1),r=i.dash[e];a.mediaPlayer_.hasOwnProperty(n)&&(c.log.warn("Using dash options in videojs-contrib-dash without the set prefix has been deprecated. Change '"+e+"' to '"+n+"'"),e=n),a.mediaPlayer_.hasOwnProperty(e)?(Array.isArray(r)||(r=[r]),(t=a.mediaPlayer_)[e].apply(t,r)):c.log.warn("Warning: dash configuration option unrecognized: "+e)}}),this.mediaPlayer_.attachView(this.el_),i.dash&&i.dash.useTTML&&(this.ttmlContainer_=this.player.addChild("TTMLTextTrackDisplay"),this.mediaPlayer_.attachTTMLRenderingDiv(this.ttmlContainer_.el())),this.mediaPlayer_.setAutoPlay(!1),o.call(null,this.player,e),function(e,t){e.dash.mediaPlayer.on(d.MediaPlayer.events.PLAYBACK_METADATA_LOADED,u.bind(null,e,t))}.call(null,this.player,e),f.call(null,this.player,e,i),this.mediaPlayer_.setProtectionData(this.keySystemOptions_),this.mediaPlayer_.attachSource(n),this.tech_.triggerReady()}}r.buildDashJSProtData=function(e){var t={};if(!e||!Array.isArray(e))return null;for(var n=0;n<e.length;n++){var r=e[n],i=c.mergeOptions({},r.options);i.licenseUrl&&(i.serverURL=i.licenseUrl,delete i.licenseUrl),t[r.name]=i}return t};var e=r.prototype;return e.dispose=function(){this.mediaPlayer_&&(this.mediaPlayer_.off(d.MediaPlayer.events.ERROR,this.retriggerError_),this.mediaPlayer_.off(d.MediaPlayer.events.MANIFEST_LOADED,this.getDuration_),this.mediaPlayer_.reset()),this.player.dash&&delete this.player.dash,this.ttmlContainer_&&(this.ttmlContainer_.dispose(),this.player.removeChild("TTMLTextTrackDisplay"))},e.duration=function(){return this.mediaPlayer_.isDynamic()&&!this.hasFiniteDuration_?1/0:this.mediaPlayer_.duration()},r.hooks=function(e,t){return r.hooks_[e]=r.hooks_[e]||[],t&&(r.hooks_[e]=r.hooks_[e].concat(t)),r.hooks_[e]},r.hook=function(e,t){r.hooks(e,t)},r.removeHook=function(e,t){var n=r.hooks(e).indexOf(t);return-1!==n&&(r.hooks_[e]=r.hooks_[e].slice(),r.hooks_[e].splice(n,1),!0)},r}();b.hooks_={};return c.DashSourceHandler=function(){return{canHandleSource:function(e){return function(t){t=JSON.parse(JSON.stringify(t)),b.updateSourceData&&(c.log.warn('updateSourceData has been deprecated. Please switch to using hook("updatesource", callback).'),t=b.updateSourceData(t)),b.hooks("updatesource").forEach(function(e){t=e(t)});var e=n.createElement("video");return!(t.keySystemOptions&&!l.navigator.requestMediaKeySystemAccess&&!e.msSetMediaKeys)}(e)?c.DashSourceHandler.canPlayType(e.type)?"probably":/\.mpd/i.test(e.src)?"maybe":"":""},handleSource:function(e,t,n){return new b(e,t,n)},canPlayType:function(e){return c.DashSourceHandler.canPlayType(e)}}},c.DashSourceHandler.canPlayType=function(e){return/^application\/dash\+xml/i.test(e)?"probably":""},l.MediaSource&&c.getTech("Html5").registerSourceHandler(c.DashSourceHandler(),0),c.Html5DashJS=b}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("video.js"),require("global/document")):"function"==typeof define&&define.amd?define(["video.js","global/document"],t):e.videojsContribQualityLevels=t(e.videojs,e.document)}(this,function(a,o){"use strict";function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}a=a&&a.hasOwnProperty("default")?a.default:a,o=o&&o.hasOwnProperty("default")?o.default:o;function l(e){var t=this;if(a.browser.IS_IE8)for(var n in t=o.createElement("custom"),l.prototype)"constructor"!==n&&(t[n]=l.prototype[n]);return t.id=e.id,t.label=t.id,t.width=e.width,t.height=e.height,t.bitrate=e.bandwidth,t.enabled_=e.enabled,Object.defineProperty(t,"enabled",{get:function(){return t.enabled_()},set:function(e){t.enabled_(e)}}),t}var i=function(r){function i(){var e,t=s(s(e=r.call(this)||this));if(a.browser.IS_IE8)for(var n in t=o.createElement("custom"),i.prototype)"constructor"!==n&&(t[n]=i.prototype[n]);return t.levels_=[],t.selectedIndex_=-1,Object.defineProperty(t,"selectedIndex",{get:function(){return t.selectedIndex_}}),Object.defineProperty(t,"length",{get:function(){return t.levels_.length}}),t||s(e)}!function(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}(i,r);var e=i.prototype;return e.addQualityLevel=function(e){var t=this.getQualityLevelById(e.id);if(t)return t;var n=this.levels_.length;return t=new l(e),""+n in this||Object.defineProperty(this,n,{get:function(){return this.levels_[n]}}),this.levels_.push(t),this.trigger({qualityLevel:t,type:"addqualitylevel"}),t},e.removeQualityLevel=function(e){for(var t=null,n=0,r=this.length;n<r;n++)if(this[n]===e){t=this.levels_.splice(n,1)[0],this.selectedIndex_===n?this.selectedIndex_=-1:this.selectedIndex_>n&&this.selectedIndex_--;break}return t&&this.trigger({qualityLevel:e,type:"removequalitylevel"}),t},e.getQualityLevelById=function(e){for(var t=0,n=this.length;t<n;t++){var r=this[t];if(r.id===e)return r}return null},e.dispose=function(){this.selectedIndex_=-1,this.levels_.length=0},i}(a.EventTarget);for(var e in i.prototype.allowedEvents_={change:"change",addqualitylevel:"addqualitylevel",removequalitylevel:"removequalitylevel"},i.prototype.allowedEvents_)i.prototype["on"+e]=null;function t(e){return function(t){var n=t.qualityLevels,r=new i;return t.on("dispose",function e(){r.dispose(),t.qualityLevels=n,t.off("dispose",e)}),t.qualityLevels=function(){return r},t.qualityLevels.VERSION="2.1.0",r}(this,a.mergeOptions({},e))}var n=a.registerPlugin||a.plugin;return n("qualityLevels",t),t.VERSION="2.1.0",t}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).videojsS3bubbleMediatailor=t(e.videojs)}(this,function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var o=t(e);function n(e,t,n){return e(n={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&n.path)}},n.exports),n.exports}var i=n(function(e){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.default=e.exports,e.exports.__esModule=!0}),r=n(function(n){function r(e,t){return n.exports=r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n.exports.default=n.exports,n.exports.__esModule=!0,r(e,t)}n.exports=r,n.exports.default=n.exports,n.exports.__esModule=!0}),a=n(function(e){e.exports=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,r(e,t)},e.exports.default=e.exports,e.exports.__esModule=!0});o.default.use("*",function(e){return{setSource:function(r,i){if(r.src.includes(".mediatailor.")){var a=new URL(r.src),e=a.pathname.split("/");e[2]="session",o.default.xhr.post(""+a.origin+e.join("/"),function(e,t){var n=JSON.parse(t.body);r.src=""+a.origin+n.manifestUrl,r.type=n.manifestUrl.includes(".mpd")?"application/dash+xml":"application/x-mpegurl",r.tracking=""+a.origin+n.trackingUrl,i(null,r)})}else i(null,r)}}});var s=o.default.getPlugin("plugin"),l=o.default.getComponent("Component"),u={now:null,then:Date.now(),interval:1e3,delta:null,currentTime:0,countDown:0,currentAd:null,trackingUrl:null,src:null,isSeek:!0,adIsPlaying:!1,played:[],adPositions:[]},c=function(r){function e(e,t){var n;return(n=r.call(this,e)||this).options=o.default.mergeOptions(u,t),n.player.ready(function(){n.player.addClass("vjs-s3bubble-mediatailor")}),n.player.on("loadstart",function(e){n.player.one("loadedmetadata",function(){n.player.currentSource().tracking&&(n.player.markers({markerStyle:{"background-color":"#fbcf03","border-radius":"0px","z-index":"0","pointer-events":"none"},onMarkerReached:function(){},markers:[]}),n.options.trackingUrl=n.player.currentSource().tracking,n.startTracking(),n.buildUi(),n.player.on("timeupdate",n.ssaiTime.bind(i(n),"timeupdate")),n.player.on("playing",n.ssaiPlay.bind(i(n),"playing")),n.player.on("seeking",n.ssaiSeeking.bind(i(n),"seeking")),n.player.on("seeked",n.ssaiSeeked.bind(i(n),"seeked")))})}),n}a(e,r);var t=e.prototype;return t.ssaiPlay=function(){var e=this;setTimeout(function(){e.options.isSeek=!0},2e3)},t.ssaiSeeking=function(){this.options.currentTime<this.player.currentTime()&&this.options.adIsPlaying&&this.player.currentTime(this.options.currentTime)},t.ssaiSeeked=function(){if(this.options.isSeek&&!this.options.adIsPlaying){var e=this.player.currentTime(),t=this.findClosest(e,this.options.adPositions);t&&!this.options.played.includes(t.availId)&&(this.player.currentTime(t.start),this.options.played.push(t.availId),this.options.isSeek=!1)}},t.ssaiTime=function(){var t=this;if(this.options.now=Date.now(),this.options.delta=this.options.now-this.options.then,this.options.delta>this.options.interval&&(this.options.then=this.options.now-this.options.delta%this.options.interval,!this.player.paused())){this.options.currentTime=this.player.currentTime();var e=this.options.adPositions.findIndex(function(e){return t.options.currentTime>=e.start&&t.options.currentTime<=e.end});if(-1!==e){this.options.played.includes(this.options.adPositions[e].availId)||this.options.played.push(this.options.adPositions[e].availId);var n=Math.round(this.options.adPositions[e].end)-Math.round(this.options.adPositions[e].start)-this.options.countDown,r=1<this.options.adPositions[e].data.ads.length?"s":"";this.player.getChild("adBox").addClass("animated"),this.player.getChild("adBox").updateTextContent(this.options.adPositions[e].data.ads.length+" Ad"+r+" "+Math.abs(n)+"s"),this.options.adIsPlaying=!0,this.options.countDown<0?this.player.getChild("adBox").removeClass("animated"):this.options.countDown++}else this.player.getChild("adBox").removeClass("animated"),this.options.countDown=0,this.options.adIsPlaying=!1}},t.findClosest=function(t,e){var n=e.filter(function(e){return t>e.end});return n[n.length-1]},t.startTracking=function(){var i=this;o.default.xhr.get(this.options.trackingUrl,function(e,t){var n=JSON.parse(t.body),r=[];Array.isArray(n.avails)&&n.avails.forEach(function(e){i.options.adPositions.push({data:e,availId:e.availId,start:e.startTimeInSeconds,end:e.startTimeInSeconds+e.durationInSeconds}),r.push({availId:e.availId,time:e.startTimeInSeconds,duration:e.durationInSeconds,text:"Ads"})}),i.player.markers.reset(r)})},t.buildUi=function(){var e=o.default.extend(l,{constructor:function(e,t){l.apply(this,arguments),t.text&&this.updateTextContent(t.text)},createEl:function(){return o.default.createEl("div",{className:"vjs-ad-box"})},updateTextContent:function(e){"string"!=typeof e&&(e=""),o.default.emptyEl(this.el()),o.default.appendContent(this.el(),e)}});o.default.registerComponent("adBox",e),this.player.addChild("adBox",{text:""})},e}(s);return c.defaultState={},c.VERSION="0.0.3",o.default.registerPlugin("s3BubbleMediatailor",c),c}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).videojsS3bubbleBitrateSwitcher=t(e.videojs)}(this,function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var a=t(e);function n(e,t,n){return e(n={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&n.path)}},n.exports),n.exports}var o=n(function(e){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.__esModule=!0,e.exports.default=e.exports}),r=n(function(n){function r(e,t){return n.exports=r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n.exports.__esModule=!0,n.exports.default=n.exports,r(e,t)}n.exports=r,n.exports.__esModule=!0,n.exports.default=n.exports}),s=n(function(e){e.exports=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,r(e,t)},e.exports.__esModule=!0,e.exports.default=e.exports}),l=function(r){function e(e,t){var n;return(n=r.call(this,e,t)||this).player=e,n.label=t.label,n.levels=t.levels,n.bitrate=t.bitrate,"Auto"===n.label&&n.addClass("vjs-selected"),n.setAttribute("data-bitrate",n.bitrate),n}return s(e,r),e.prototype.handleClick=function(){var t=this;this.parentComponent_.children_.forEach(function(e){e.removeClass("vjs-selected")}),this.addClass("vjs-selected"),void 0!==this.levels?(this.player.getChild("streamInfo")&&this.player.getChild("streamInfo").updateTextContent('<div class="vjs-stream-info-box">Playback:'+this.label+"<br/>Type:"+this.player.currentType()+"</div>"),void 0!==this.levels.qualityIndex&&(this.player.dashQualityLevelsSelected=this.levels.qualityIndex,this.player.trigger("dashQualityLevelsSelected")),0<this.levels.length&&this.levels.forEach(function(e){t.bitrate===e.bitrate?e.enabled=!0:e.enabled=!1})):this.player.trigger("dashQualityLevelsSelectAuto")},e}(a.default.getComponent("MenuItem"));a.default.registerComponent("PlayBackRatesBtn",l);var i=a.default.getPlugin("plugin"),u=a.default.getComponent("Component"),c=a.default.getComponent("MenuButton"),d={now:null,then:Date.now(),interval:1e3,frames:0,delta:null,showInfo:!1},h=function(i){function e(e,t){var n;n=i.call(this,e)||this;var r=o(n);return n.options=a.default.mergeOptions(d,t),n.player.ready(function(){n.player.addClass("vjs-s3bubble-bitrate-switcher"),n.options.showInfo&&r.buildUi()}),n.player.on("dashQualityLevels",function(e){e.target.player.dashQualityLevels,r.qualityLevels=e.target.player.dashQualityLevels,1<r.qualityLevels.length&&r.dash()}),n.player.on(a.default.browser.IS_IOS?"canplaythrough":"loadedmetadata",function(e){["m3u8","mpd"].includes(r.getExtension(this.currentSrc()))&&(r.qualityLevels=this.qualityLevels(),1<r.qualityLevels.levels_.length&&r.hls())}),n.player.on("loadstart",function(e){this.getChild("controlBar").getChild("RatesButton")&&(this.getChild("controlBar").removeChild("RatesButton"),this.getChild("streamInfo").updateTextContent(""))}),n}s(e,i);var t=e.prototype;return t.getExtension=function(e){return e.split(/[#?]/)[0].split(".").pop().trim()},t.sortProperties=function(e){e=e.levels_?e.levels_:e;var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(e[n]);return t.sort(function(e,t){return t.hasOwnProperty("height")?e.height-t.height:t.hasOwnProperty("bandwidth")?e.bandwidth-t.bandwidth:void 0}),t.reverse()},t.formatBitrate=function(e){for(var t=-1;t++,1024<(e/=1024););return Math.max(e,.1).toFixed(1)+[" kbps"," Mbps"," Gbps"," Tbps","Pbps","Ebps","Zbps","Ybps"][t]},t.formatRendition=function(e){return e.hasOwnProperty("height")?e.height?e.height+"p, "+this.formatBitrate(e.bitrate):"":""+this.formatBitrate(e.bitrate)},t.hls=function(){var i=this,e=function(n){function e(e,t){return n.call(this,e,t)||this}s(e,n);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-icon-cog "+n.prototype.buildCSSClass.call(this)},t.buildWrapperCSSClass=function(){return"vjs-dash-hls-bitrate-switcher-menu "+n.prototype.buildWrapperCSSClass.call(this)},t.updateSelected=function(t){this.items.forEach(function(e){t.bitrate===parseInt(e.el().getAttribute("data-bitrate"))?e.addClass("vjs-selected"):e.removeClass("vjs-selected")})},t.createItems=function(t){var n=this;void 0===t&&(t=[]);var r=i.sortProperties(i.qualityLevels);return r.forEach(function(e){e.bitrate&&t.push(new l(n.player(),{levels:r,bitrate:e.bitrate,label:""+i.formatRendition(e)}))}),t},e}(c);a.default.registerComponent("RatesButton",e);var t=i.player.getChild("controlBar").children().length;i.player.getChild("controlBar").getChild("fullscreenToggle")?i.player.getChild("controlBar").addChild("ratesButton",{},t-1):i.player.getChild("controlBar").addChild("ratesButton",{},t),i.qualityLevels.on("change",function(){var e=i.qualityLevels[i.qualityLevels.selectedIndex];i.player.getChild("controlBar").getChild("ratesButton").updateSelected(e)});var n=i.qualityLevels[i.qualityLevels.selectedIndex];i.player.getChild("controlBar").getChild("ratesButton").updateSelected(n)},t.dash=function(){var r=this,e=function(n){function e(e,t){return n.call(this,e,t)||this}s(e,n);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-icon-cog "+n.prototype.buildCSSClass.call(this)},t.buildWrapperCSSClass=function(){return"vjs-dash-hls-bitrate-switcher-menu "+n.prototype.buildWrapperCSSClass.call(this)},t.updateSelected=function(t){this.items.forEach(function(e){t.bitrate===parseInt(e.el().getAttribute("data-bitrate"))?e.addClass("vjs-selected"):e.removeClass("vjs-selected")})},t.createItems=function(t){var n=this;return void 0===t&&(t=[]),t.push(new l(this.player(),{levels:void 0,label:"Auto"})),r.sortProperties(r.qualityLevels).forEach(function(e){e.bitrate&&t.push(new l(n.player(),{levels:e,bitrate:e.bitrate,label:""+r.formatRendition(e)}))}),t},e}(c);a.default.registerComponent("RatesButton",e);var t=r.player.getChild("controlBar").children().length;r.player.getChild("controlBar").getChild("fullscreenToggle")?r.player.getChild("controlBar").addChild("ratesButton",{},t-1):r.player.getChild("controlBar").addChild("ratesButton",{},t)},t.buildUi=function(){var e=a.default.extend(u,{constructor:function(e,t){u.apply(this,arguments),t.text&&this.updateTextContent(t.text)},createEl:function(){return a.default.createEl("div",{className:"vjs-stream-info",innerHTML:""})},updateTextContent:function(e){"string"!=typeof e&&(e=""),this.el().innerHTML=e}});window.videojs=a.default,a.default.registerComponent("streamInfo",e),this.player.addChild("streamInfo",{text:""})},e}(i);return h.defaultState={},h.VERSION="0.0.6",a.default.registerPlugin("s3BubbleBitrateSwitcher",h),h}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).videojsS3bubbleSettingsMenu=t(e.videojs)}(this,function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var o=t(e);function n(e,t,n){return e(n={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&n.path)}},n.exports),n.exports}var s=n(function(e){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.__esModule=!0,e.exports.default=e.exports}),r=n(function(n){function r(e,t){return n.exports=r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n.exports.__esModule=!0,n.exports.default=n.exports,r(e,t)}n.exports=r,n.exports.__esModule=!0,n.exports.default=n.exports}),l=n(function(e){e.exports=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,r(e,t)},e.exports.__esModule=!0,e.exports.default=e.exports}),i=o.default.getPlugin("plugin"),a=o.default.getComponent("Component"),u=o.default.getComponent("MenuButton"),c={items:["AudioTrackButton","SubsCapsButton","PlaybackRateMenuButton","RatesButton"],languages:{settings:"Settings",loading:"Loading",back:"Back",captions_off:"Captions Off",default_audio:"Default Audio",audio:"Audio",subtitles:"Subtitles",chapters:"Chapters",speed:"Speed",quality:"Quality"}},d=function(i){function e(e,t){var n;n=i.call(this,e)||this;var r=s(n);return r.playerId=n.player.id(),n.options=o.default.mergeOptions(c,t),n.player.ready(function(){n.player.addClass("vjs-s3bubble-settings-menu"),n.buildUI(),(o.default.browser.IS_IOS||o.default.browser.IS_ANDROID)&&n.mobileBuildUI()}),n.player.on("playbackRateSwitched",function(e){var t=e.target.player.playbackRateSwitched;this.getChild("controlBar").getChild("settingsMenuButton").controlText(t.height+"p, "+r.formatBps(t.bitrate))}),n.player.on("userinactive",function(){document.getElementById(r.playerId).querySelectorAll(".vjs-menu").forEach(function(e){e.classList.remove("vjs-lock-open")})}),n.player.on("click",function(e){"VIDEO"===e.target.tagName&&document.getElementById(r.playerId).querySelectorAll(".vjs-menu").forEach(function(e){e.classList.remove("vjs-lock-open")})}),n.player.on("loadstart",function(e){this.one("canplaythrough",function(e){r.removeElementsByClass("vjs-setting-menu-clear"),o.default.browser.IS_IOS||o.default.browser.IS_ANDROID?r.mobileBuildTopLevelMenu():r.buildTopLevelMenu()})}),n}l(e,i);var t=e.prototype;return t.buildUI=function(){var a=this,e=function(i){function e(e,t){var n;(n=i.call(this,e,t)||this).addClass("vjs-settings-menu"),n.controlText(a.options.languages.loading);var r=s(n);return a.player.one("canplaythrough",function(e){r.controlText(a.options.languages.settings)}),n.menu.contentEl_.id=a.playerId+"-vjs-settings-menu-default",n}return l(e,i),e.prototype.handleClick=function(){o.default.browser.IS_IOS||o.default.browser.IS_ANDROID?a.player.getChild("settingsMenuMobileModal").el().style.display="block":(this.el().classList.toggle("vjs-toogle-btn"),this.menu.el().classList.toggle("vjs-lock-open"))},e}(u);o.default.registerComponent("settingsMenuButton",e),this.player.getChild("controlBar").addChild("settingsMenuButton"),this.player.getChild("controlBar").getChild("fullscreenToggle")&&this.player.getChild("controlBar").el().insertBefore(this.player.getChild("controlBar").getChild("settingsMenuButton").el(),this.player.getChild("controlBar").getChild("fullscreenToggle").el())},t.buildTopLevelMenu=function(){var a=this,e=a.player.getChild("controlBar").getChild("settingsMenuButton");e.menu;var o=e.menu.contentEl_;o.innerHTML="",o.classList.add("vjs-sm-top-level");var t=document.createElement("li");t.className="vjs-sm-top-level-header";var n=document.createElement("span");n.innerHTML=a.options.languages.settings,t.appendChild(n),o.appendChild(t);var r=[],i=!1,s=!1;a.player.textTracks().tracks_&&a.player.textTracks().tracks_.forEach(function(e){"chapters"===e.kind&&(i=!0),"subtitles"!==e.kind&&"captions"!==e.kind||(s=!0)}),i||r.push("ChaptersButton"),s||r.push("SubsCapsButton"),a.options.items.filter(function(e){return!r.includes(e)}).forEach(function(e){if(a.player.getChild("controlBar").getChild(e)){var t=a.setInitialStates(e);a.player.getChild("controlBar").getChild(e).addClass("vjs-hide-settings-menu-item");var n=document.createElement("li");n.innerHTML=t.language,n.setAttribute("data-component",e.toLowerCase()),n.className="vjs-sm-list-item";var r=document.createElement("i");r.className="setting-menu-list-arrow setting-menu-list-arrow-right",n.appendChild(r);var i=document.createElement("span");i.id=a.playerId+"-setting-menu-child-span-"+e.toLowerCase(),i.innerHTML=t.default,n.appendChild(i),o.appendChild(n),setTimeout(function(){a.buildMenuList(e)},"ChaptersButton"===e?1e3:0)}});var l=document.querySelectorAll(".vjs-sm-list-item");Array.from(l).forEach(function(e){e.addEventListener("click",function(e){document.querySelectorAll(".vjs-sm-top-level").forEach(function(e){e.classList.add("vjs-hidden")});var t=document.getElementById(a.playerId+"-setting-menu-child-menu-"+this.getAttribute("data-component"));t.classList.remove("vjs-hidden"),t.classList.add("vjs-lock"),e.preventDefault()})})},t.mobileBuildUI=function(){var e=function(n){function e(e,t){return n.call(this,e,t)||this}return l(e,n),e.prototype.createEl=function(){return o.default.createEl("div",{className:"vjs-settings-menu-mobile"})},e}(a);o.default.registerComponent("settingsMenuMobileModal",e),o.default.dom.prependTo(this.player.addChild("settingsMenuMobileModal").el(),document.body)},t.mobileBuildTopLevelMenu=function(){var t=this,i=this,a=this.player.getChild("settingsMenuMobileModal"),o=document.createElement("ul");o.className="vjs-sm-mob-top-level vjs-setting-menu-clear",a.el().appendChild(o);var e=document.createElement("li");e.className="vjs-setting-menu-mobile-top-header",e.innerHTML=this.options.languages.settings,o.appendChild(e);var n=[],r=!1,s=!1;i.player.textTracks().tracks_&&i.player.textTracks().tracks_.forEach(function(e){"chapters"===e.kind&&(r=!0),"subtitles"!==e.kind&&"captions"!==e.kind||(s=!0)}),r||n.push("ChaptersButton"),s||n.push("SubsCapsButton"),i.options.items.filter(function(e){return!n.includes(e)}).forEach(function(e){if(i.player.getChild("controlBar").getChild(e)){i.player.getChild("controlBar").getChild(e).addClass("vjs-hide-settings-menu-item");var t=i.setInitialStates(e),n=document.createElement("li");n.setAttribute("data-component",e.toLowerCase()),n.innerHTML=t.language,n.className="vjs-sm-top-level-item";var r=document.createElement("span");r.id=i.playerId+"-setting-menu-child-span-"+e.toLowerCase(),r.innerHTML=t.default,n.appendChild(r),o.appendChild(n),setTimeout(function(){i.mobileBuildSecondLevelMenu(e,a.el())},"ChaptersButton"===e?1e3:0)}});var l=document.querySelectorAll(".vjs-sm-top-level-item");Array.from(l).forEach(function(e){e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("data-component");document.querySelectorAll(".vjs-sm-mob-top-level").forEach(function(e){e.classList.add("vjs-hidden")}),document.getElementById(i.playerId+"-mb-comp-"+t).classList.remove("vjs-hidden")})});var u=document.createElement("li");u.innerHTML="Close",u.onclick=function(e){t.player.getChild("settingsMenuMobileModal").el().style.display="none"},u.className="setting-menu-footer-default",o.appendChild(u)},t.mobileBuildSecondLevelMenu=function(e,t){var n=this;if(this.player.getChild("controlBar").getChild("settingsMenuButton"),this.player.getChild("controlBar").getChild(e)){for(var r=this.player.getChild("controlBar").getChild(e).menu.contentEl_,i=0;i<r.children.length;i++){var a=r.children[i].getAttribute("class");"setting-menu-header"!==a&&"vjs-menu-title"!==a||r.children[i].remove()}r.id=n.playerId+"-mb-comp-"+e.toLowerCase(),r.classList.add("vjs-hidden"),r.classList.add("vjs-sm-mob-second-level"),r.classList.add("vjs-setting-menu-clear");var o=document.createElement("li");o.className="setting-menu-header",o.setAttribute("data-component",e.toLowerCase());var s=document.createElement("i");s.className="setting-menu-list-arrow setting-menu-list-arrow-left",o.appendChild(s),o.onclick=function(e){document.querySelectorAll(".vjs-sm-mob-top-level").forEach(function(e){e.classList.remove("vjs-hidden")}),document.querySelectorAll(".vjs-menu-content").forEach(function(e){e.classList.add("vjs-hidden")});var t=document.getElementById(n.playerId+"-mb-comp-"+this.getAttribute("data-component")).querySelectorAll(".vjs-selected");void 0!==t&&0<t.length&&t[0].textContent&&(document.getElementById(n.playerId+"-setting-menu-child-span-"+this.getAttribute("data-component")).innerText=n.cleanDefault(t[0].textContent)),document.querySelectorAll(".vjs-sm-list-item").forEach(function(e){e.classList.remove("vjs-hidden")}),document.querySelectorAll(".vjs-menu-content").forEach(function(e){e.classList.value.includes("vjs-lock")&&(e.classList.remove("vjs-lock"),e.classList.add("vjs-hidden"))})};var l=document.createElement("span");l.innerHTML=n.options.languages.back,o.appendChild(l),r.insertBefore(o,r.firstChild),t.appendChild(r)}},t.buildMenuList=function(e){var n=this,t=this.player.getChild("controlBar").getChild("settingsMenuButton");if(this.player.getChild("controlBar").getChild(e)){for(var r=this.player.getChild("controlBar").getChild(e).menu.contentEl_,i=0;i<r.children.length;i++){var a=r.children[i].getAttribute("class");"setting-menu-header"!==a&&"vjs-menu-title"!==a||r.children[i].remove()}r.id=n.playerId+"-setting-menu-child-menu-"+e.toLowerCase(),r.classList.add("vjs-hidden"),r.classList.add("vjs-setting-menu-clear");var o=document.createElement("li");o.className="setting-menu-header",o.setAttribute("data-component",e.toLowerCase());var s=document.createElement("i");s.className="setting-menu-list-arrow setting-menu-list-arrow-left",o.appendChild(s),o.onclick=function(e){var t=document.getElementById(n.playerId+"-setting-menu-child-menu-"+this.getAttribute("data-component")).querySelectorAll(".vjs-selected");void 0!==t&&0<t.length&&t[0].textContent&&(document.getElementById(n.playerId+"-setting-menu-child-span-"+this.getAttribute("data-component")).innerText=n.cleanDefault(t[0].textContent)),document.querySelectorAll(".vjs-sm-top-level").forEach(function(e){e.classList.remove("vjs-hidden")}),document.querySelectorAll(".vjs-menu-content").forEach(function(e){e.classList.value.includes("vjs-lock")&&(e.classList.remove("vjs-lock"),e.classList.add("vjs-hidden"))})};var l=document.createElement("span");l.innerHTML=n.options.languages.back,o.appendChild(l),r.insertBefore(o,r.firstChild),t.menu.el().appendChild(r)}},t.setInitialStates=function(e){switch(e){case"RatesButton":return{default:"auto",language:this.options.languages.quality};case"PlaybackRateMenuButton":return{default:"1x",language:this.options.languages.speed};case"ChaptersButton":return{default:"",language:this.options.languages.chapters};case"AudioTrackButton":for(var t=this.player.audioTracks(),n=this.options.languages.defaultAudio,r=t.length;r--;)t[r].enabled&&(n=t[r].label);return{default:n,language:this.options.languages.audio};case"SubsCapsButton":for(var i=this.player.textTracks(),a=this.options.languages.captions_off,o=i.length;o--;)"subtitles"===i[o].kind&&"showing"===i[o].mode&&(a=i[o].label);return{default:a,language:this.options.languages.subtitles};default:return{default:"",language:"Menu"}}},t.removeElementsByClass=function(e){document.querySelectorAll(".vjs-sm-top-level").forEach(function(e){e.classList.remove("vjs-hidden")});for(var t=document.getElementsByClassName(e);0<t.length;)t[0].parentNode.removeChild(t[0])},t.cleanDefault=function(e){var t=(e=e.replace(/\s\s+/g," ")).indexOf(",");return e=(e=e.substring(0,-1!=t?t:e.length)).replace(/(<([^>]+)>)/gi,"")},t.formatBps=function(e){for(var t=-1;t++,1024<(e/=1024););return Math.max(e,.1).toFixed(1)+[" kbps"," Mbps"," Gbps"," Tbps","Pbps","Ebps","Zbps","Ybps"][t]},e}(i);return d.defaultState={},d.VERSION="0.0.3",o.default.registerPlugin("s3BubbleSettingsMenu",d),d}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("global/window"),require("global/document"),require("video.js")):"function"==typeof define&&define.amd?define(["global/window","global/document","video.js"],t):(e=e||self).videojsVr=t(e.window,e.document,e.videojs)}(this,function(o,r,s){"use strict";o=o&&o.hasOwnProperty("default")?o.default:o,r=r&&r.hasOwnProperty("default")?r.default:r,s=s&&s.hasOwnProperty("default")?s.default:s;var f="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function t(e,t){return e(t={exports:{}},t.exports),t.exports}var a=e(t(function(e){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.default=e.exports,e.exports.__esModule=!0})),n=t(function(n){function r(e,t){return n.exports=r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n.exports.default=n.exports,n.exports.__esModule=!0,r(e,t)}n.exports=r,n.exports.default=n.exports,n.exports.__esModule=!0});e(n);var l=e(t(function(e){e.exports=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,n(e,t)},e.exports.default=e.exports,e.exports.__esModule=!0})),u=e(t(function(e,t){e.exports=function(){var qe=typeof window!=="undefined"?window:typeof f!=="undefined"?f:typeof self!=="undefined"?self:{};function e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e["default"]:e}function t(e,t){return t={exports:{}},e(t,t.exports),t.exports}var n=function e(){return/Android/i.test(navigator.userAgent)||/iPhone|iPad|iPod/i.test(navigator.userAgent)},i=function e(t,n){for(var r=0,i=t.length;r<i;r++){n[r]=t[r]}},r=function e(t,n){for(var r in n){if(n.hasOwnProperty(r)){t[r]=n[r]}}return t},a,o=e(t(function(n,e){(function(e,t){n.exports=t()})(qe,function(){var n=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};var e=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}return function(e,t,n){if(t)r(e.prototype,t);if(n)r(e,n);return e}}();var l=function(){function n(e,t){var n=[];var r=true;var i=false;var a=undefined;try{for(var o=e[Symbol.iterator](),s;!(r=(s=o.next()).done);r=true){n.push(s.value);if(t&&n.length===t)break}}catch(e){i=true;a=e}finally{try{if(!r&&o["return"])o["return"]()}finally{if(i)throw a}}return n}return function(e,t){if(Array.isArray(e)){return e}else if(Symbol.iterator in Object(e)){return n(e,t)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var a=.001;var o=1;var t=function e(t,n){return"data:"+t+","+encodeURIComponent(n)};var T=function e(t,n,r){return t+(n-t)*r};var f=function(){var e=/iPad|iPhone|iPod/.test(navigator.platform);return function(){return e}}();var p=function(){var e=navigator.userAgent.indexOf("Version")!==-1&&navigator.userAgent.indexOf("Android")!==-1&&navigator.userAgent.indexOf("Chrome")!==-1;return function(){return e}}();var r=function(){var e=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);return function(){return e}}();var s=function(){var e=navigator.userAgent.indexOf("Firefox")!==-1&&navigator.userAgent.indexOf("Android")!==-1;return function(){return e}}();var u=function(){var e=navigator.userAgent.match(/.*Chrome\/([0-9]+)/);var t=e?parseInt(e[1],10):null;return function(){return t}}();var c=function(){var e=false;e=f()&&r()&&navigator.userAgent.indexOf("13_4")!==-1;return function(){return e}}();var d=function(){var e=false;if(u()===65){var t=navigator.userAgent.match(/.*Chrome\/([0-9\.]*)/);if(t){var n=t[1].split("."),r=l(n,4),i=r[0],a=r[1],o=r[2],s=r[3];e=parseInt(o,10)===3325&&parseInt(s,10)<148}}return function(){return e}}();var h=function(){var e=navigator.userAgent.indexOf("R7 Build")!==-1;return function(){return e}}();var m=function e(){var t=window.orientation==90||window.orientation==-90;return h()?!t:t};var i=function e(t){if(isNaN(t)){return false}if(t<=a){return false}if(t>o){return false}return true};var g=function e(){return Math.max(window.screen.width,window.screen.height)*window.devicePixelRatio};var v=function e(){return Math.min(window.screen.width,window.screen.height)*window.devicePixelRatio};var y=function e(t){if(p()){return false}if(t.requestFullscreen){t.requestFullscreen()}else if(t.webkitRequestFullscreen){t.webkitRequestFullscreen()}else if(t.mozRequestFullScreen){t.mozRequestFullScreen()}else if(t.msRequestFullscreen){t.msRequestFullscreen()}else{return false}return true};var _=function e(){if(document.exitFullscreen){document.exitFullscreen()}else if(document.webkitExitFullscreen){document.webkitExitFullscreen()}else if(document.mozCancelFullScreen){document.mozCancelFullScreen()}else if(document.msExitFullscreen){document.msExitFullscreen()}else{return false}return true};var b=function e(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement};var E=function e(t,n,r,i){var a=t.createShader(t.VERTEX_SHADER);t.shaderSource(a,n);t.compileShader(a);var o=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(o,r);t.compileShader(o);var s=t.createProgram();t.attachShader(s,a);t.attachShader(s,o);for(var l in i){t.bindAttribLocation(s,i[l],l)}t.linkProgram(s);t.deleteShader(a);t.deleteShader(o);return s};var A=function e(t,n){var r={};var i=t.getProgramParameter(n,t.ACTIVE_UNIFORMS);var a="";for(var o=0;o<i;o++){var s=t.getActiveUniform(n,o);a=s.name.replace("[0]","");r[a]=t.getUniformLocation(n,a)}return r};var w=function e(t,n,r,i,a,o,s){var l=1/(n-r),u=1/(i-a),c=1/(o-s);t[0]=-2*l;t[1]=0;t[2]=0;t[3]=0;t[4]=0;t[5]=-2*u;t[6]=0;t[7]=0;t[8]=0;t[9]=0;t[10]=2*c;t[11]=0;t[12]=(n+r)*l;t[13]=(a+i)*u;t[14]=(s+o)*c;t[15]=1;return t};var S=function e(){var t=false;(function(e){if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))t=true})(navigator.userAgent||navigator.vendor||window.opera);return t};var C=function e(t,n){for(var r in n){if(n.hasOwnProperty(r)){t[r]=n[r]}}return t};var x=function e(t){if(f()){var n=t.style.width;var r=t.style.height;t.style.width=parseInt(n)+1+"px";t.style.height=parseInt(r)+"px";setTimeout(function(){t.style.width=n;t.style.height=r},100)}window.canvas=t};var M=function(){var c=Math.PI/180;var d=Math.PI*.25;function l(e,t,n,r){var i=Math.tan(t?t.upDegrees*c:d),a=Math.tan(t?t.downDegrees*c:d),o=Math.tan(t?t.leftDegrees*c:d),s=Math.tan(t?t.rightDegrees*c:d),l=2/(o+s),u=2/(i+a);e[0]=l;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=u;e[6]=0;e[7]=0;e[8]=-((o-s)*l*.5);e[9]=(i-a)*u*.5;e[10]=r/(n-r);e[11]=-1;e[12]=0;e[13]=0;e[14]=r*n/(n-r);e[15]=0;return e}function u(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3],s=r+r,l=i+i,u=a+a,c=r*s,d=r*l,h=r*u,f=i*l,p=i*u,m=a*u,g=o*s,v=o*l,y=o*u;e[0]=1-(f+m);e[1]=d+y;e[2]=h-v;e[3]=0;e[4]=d-y;e[5]=1-(c+m);e[6]=p+g;e[7]=0;e[8]=h+v;e[9]=p-g;e[10]=1-(c+f);e[11]=0;e[12]=n[0];e[13]=n[1];e[14]=n[2];e[15]=1;return e}function h(e,t,n){var r=n[0],i=n[1],a=n[2],o,s,l,u,c,d,h,f,p,m,g,v;if(t===e){e[12]=t[0]*r+t[4]*i+t[8]*a+t[12];e[13]=t[1]*r+t[5]*i+t[9]*a+t[13];e[14]=t[2]*r+t[6]*i+t[10]*a+t[14];e[15]=t[3]*r+t[7]*i+t[11]*a+t[15]}else{o=t[0];s=t[1];l=t[2];u=t[3];c=t[4];d=t[5];h=t[6];f=t[7];p=t[8];m=t[9];g=t[10];v=t[11];e[0]=o;e[1]=s;e[2]=l;e[3]=u;e[4]=c;e[5]=d;e[6]=h;e[7]=f;e[8]=p;e[9]=m;e[10]=g;e[11]=v;e[12]=o*r+c*i+p*a+t[12];e[13]=s*r+d*i+m*a+t[13];e[14]=l*r+h*i+g*a+t[14];e[15]=u*r+f*i+v*a+t[15]}return e}function f(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=t[8],d=t[9],h=t[10],f=t[11],p=t[12],m=t[13],g=t[14],v=t[15],y=n*s-r*o,_=n*l-i*o,b=n*u-a*o,E=r*l-i*s,T=r*u-a*s,A=i*u-a*l,w=c*m-d*p,S=c*g-h*p,C=c*v-f*p,x=d*g-h*m,M=d*v-f*m,R=h*v-f*g,I=y*R-_*M+b*x+E*C-T*S+A*w;if(!I){return null}I=1/I;e[0]=(s*R-l*M+u*x)*I;e[1]=(i*M-r*R-a*x)*I;e[2]=(m*A-g*T+v*E)*I;e[3]=(h*T-d*A-f*E)*I;e[4]=(l*C-o*R-u*S)*I;e[5]=(n*R-i*C+a*S)*I;e[6]=(g*b-p*A-v*_)*I;e[7]=(c*A-h*b+f*_)*I;e[8]=(o*M-s*C+u*w)*I;e[9]=(r*C-n*M-a*w)*I;e[10]=(p*T-m*b+v*y)*I;e[11]=(d*b-c*T-f*y)*I;e[12]=(s*S-o*x-l*w)*I;e[13]=(n*x-r*S+i*w)*I;e[14]=(m*_-p*E-g*y)*I;e[15]=(c*E-d*_+h*y)*I;return e}var p=new Float32Array([0,0,0,1]);var m=new Float32Array([0,0,0]);function r(e,t,n,r,i,a){l(e,r||null,a.depthNear,a.depthFar);var o=n.orientation||p;var s=n.position||m;u(t,o,s);if(i)h(t,t,i);f(t,t)}return function(e,t,n){if(!e||!t)return false;e.pose=t;e.timestamp=t.timestamp;r(e.leftProjectionMatrix,e.leftViewMatrix,t,n._getFieldOfView("left"),n._getEyeOffset("left"),n);r(e.rightProjectionMatrix,e.rightViewMatrix,t,n._getFieldOfView("right"),n._getEyeOffset("right"),n);return true}}();var R=function e(){var t=window.self!==window.top;var n=I(document.referrer);var r=I(window.location.href);return t&&n!==r};var I=function e(t){var n;var r=t.indexOf("://");if(r!==-1){n=r+3}else{n=0}var i=t.indexOf("/",n);if(i===-1){i=t.length}return t.substring(0,i)};var P=function e(t){if(t.w>1){console.warn("getQuaternionAngle: w > 1");return 0}var n=2*Math.acos(t.w);return n};var D=function(){var n={};return function(e,t){if(n[e]===undefined){console.warn("webvr-polyfill: "+t);n[e]=true}}}();var L=function e(t,n){var r=n?"Please use "+n+" instead.":"";D(t,t+" has been deprecated. "+"This may not work on native WebVR displays. "+r)};function O(e,t,n){if(!t){n(e);return}var r=[];var i=null;for(var a=0;a<t.length;++a){var o=t[a];switch(o){case e.TEXTURE_BINDING_2D:case e.TEXTURE_BINDING_CUBE_MAP:var s=t[++a];if(s<e.TEXTURE0||s>e.TEXTURE31){console.error("TEXTURE_BINDING_2D or TEXTURE_BINDING_CUBE_MAP must be followed by a valid texture unit");r.push(null,null);break}if(!i){i=e.getParameter(e.ACTIVE_TEXTURE)}e.activeTexture(s);r.push(e.getParameter(o),null);break;case e.ACTIVE_TEXTURE:i=e.getParameter(e.ACTIVE_TEXTURE);r.push(null);break;default:r.push(e.getParameter(o));break}}n(e);for(var a=0;a<t.length;++a){var o=t[a];var l=r[a];switch(o){case e.ACTIVE_TEXTURE:break;case e.ARRAY_BUFFER_BINDING:e.bindBuffer(e.ARRAY_BUFFER,l);break;case e.COLOR_CLEAR_VALUE:e.clearColor(l[0],l[1],l[2],l[3]);break;case e.COLOR_WRITEMASK:e.colorMask(l[0],l[1],l[2],l[3]);break;case e.CURRENT_PROGRAM:e.useProgram(l);break;case e.ELEMENT_ARRAY_BUFFER_BINDING:e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,l);break;case e.FRAMEBUFFER_BINDING:e.bindFramebuffer(e.FRAMEBUFFER,l);break;case e.RENDERBUFFER_BINDING:e.bindRenderbuffer(e.RENDERBUFFER,l);break;case e.TEXTURE_BINDING_2D:var s=t[++a];if(s<e.TEXTURE0||s>e.TEXTURE31)break;e.activeTexture(s);e.bindTexture(e.TEXTURE_2D,l);break;case e.TEXTURE_BINDING_CUBE_MAP:var s=t[++a];if(s<e.TEXTURE0||s>e.TEXTURE31)break;e.activeTexture(s);e.bindTexture(e.TEXTURE_CUBE_MAP,l);break;case e.VIEWPORT:e.viewport(l[0],l[1],l[2],l[3]);break;case e.BLEND:case e.CULL_FACE:case e.DEPTH_TEST:case e.SCISSOR_TEST:case e.STENCIL_TEST:if(l){e.enable(o)}else{e.disable(o)}break;default:console.log("No GL restore behavior for 0x"+o.toString(16));break}if(i){e.activeTexture(i)}}}var N=O;var k=["attribute vec2 position;","attribute vec3 texCoord;","varying vec2 vTexCoord;","uniform vec4 viewportOffsetScale[2];","void main() {","  vec4 viewport = viewportOffsetScale[int(texCoord.z)];","  vTexCoord = (texCoord.xy * viewport.zw) + viewport.xy;","  gl_Position = vec4( position, 1.0, 1.0 );","}"].join("\n");var B=["precision mediump float;","uniform sampler2D diffuse;","varying vec2 vTexCoord;","void main() {","  gl_FragColor = texture2D(diffuse, vTexCoord);","}"].join("\n");function F(e,t,n,r){this.gl=e;this.cardboardUI=t;this.bufferScale=n;this.dirtySubmitFrameBindings=r;this.ctxAttribs=e.getContextAttributes();this.instanceExt=e.getExtension("ANGLE_instanced_arrays");this.meshWidth=20;this.meshHeight=20;this.bufferWidth=e.drawingBufferWidth;this.bufferHeight=e.drawingBufferHeight;this.realBindFramebuffer=e.bindFramebuffer;this.realEnable=e.enable;this.realDisable=e.disable;this.realColorMask=e.colorMask;this.realClearColor=e.clearColor;this.realViewport=e.viewport;if(!f()){this.realCanvasWidth=Object.getOwnPropertyDescriptor(e.canvas.__proto__,"width");this.realCanvasHeight=Object.getOwnPropertyDescriptor(e.canvas.__proto__,"height")}this.isPatched=false;this.lastBoundFramebuffer=null;this.cullFace=false;this.depthTest=false;this.blend=false;this.scissorTest=false;this.stencilTest=false;this.viewport=[0,0,0,0];this.colorMask=[true,true,true,true];this.clearColor=[0,0,0,0];this.attribs={position:0,texCoord:1};this.program=E(e,k,B,this.attribs);this.uniforms=A(e,this.program);this.viewportOffsetScale=new Float32Array(8);this.setTextureBounds();this.vertexBuffer=e.createBuffer();this.indexBuffer=e.createBuffer();this.indexCount=0;this.renderTarget=e.createTexture();this.framebuffer=e.createFramebuffer();this.depthStencilBuffer=null;this.depthBuffer=null;this.stencilBuffer=null;if(this.ctxAttribs.depth&&this.ctxAttribs.stencil){this.depthStencilBuffer=e.createRenderbuffer()}else if(this.ctxAttribs.depth){this.depthBuffer=e.createRenderbuffer()}else if(this.ctxAttribs.stencil){this.stencilBuffer=e.createRenderbuffer()}this.patch();this.onResize()}F.prototype.destroy=function(){var e=this.gl;this.unpatch();e.deleteProgram(this.program);e.deleteBuffer(this.vertexBuffer);e.deleteBuffer(this.indexBuffer);e.deleteTexture(this.renderTarget);e.deleteFramebuffer(this.framebuffer);if(this.depthStencilBuffer){e.deleteRenderbuffer(this.depthStencilBuffer)}if(this.depthBuffer){e.deleteRenderbuffer(this.depthBuffer)}if(this.stencilBuffer){e.deleteRenderbuffer(this.stencilBuffer)}if(this.cardboardUI){this.cardboardUI.destroy()}};F.prototype.onResize=function(){var e=this.gl;var t=this;var n=[e.RENDERBUFFER_BINDING,e.TEXTURE_BINDING_2D,e.TEXTURE0];N(e,n,function(e){t.realBindFramebuffer.call(e,e.FRAMEBUFFER,null);if(t.scissorTest){t.realDisable.call(e,e.SCISSOR_TEST)}t.realColorMask.call(e,true,true,true,true);t.realViewport.call(e,0,0,e.drawingBufferWidth,e.drawingBufferHeight);t.realClearColor.call(e,0,0,0,1);e.clear(e.COLOR_BUFFER_BIT);t.realBindFramebuffer.call(e,e.FRAMEBUFFER,t.framebuffer);e.bindTexture(e.TEXTURE_2D,t.renderTarget);e.texImage2D(e.TEXTURE_2D,0,t.ctxAttribs.alpha?e.RGBA:e.RGB,t.bufferWidth,t.bufferHeight,0,t.ctxAttribs.alpha?e.RGBA:e.RGB,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE);e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t.renderTarget,0);if(t.ctxAttribs.depth&&t.ctxAttribs.stencil){e.bindRenderbuffer(e.RENDERBUFFER,t.depthStencilBuffer);e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.bufferWidth,t.bufferHeight);e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,t.depthStencilBuffer)}else if(t.ctxAttribs.depth){e.bindRenderbuffer(e.RENDERBUFFER,t.depthBuffer);e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,t.bufferWidth,t.bufferHeight);e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t.depthBuffer)}else if(t.ctxAttribs.stencil){e.bindRenderbuffer(e.RENDERBUFFER,t.stencilBuffer);e.renderbufferStorage(e.RENDERBUFFER,e.STENCIL_INDEX8,t.bufferWidth,t.bufferHeight);e.framebufferRenderbuffer(e.FRAMEBUFFER,e.STENCIL_ATTACHMENT,e.RENDERBUFFER,t.stencilBuffer)}if(!e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE){console.error("Framebuffer incomplete!")}t.realBindFramebuffer.call(e,e.FRAMEBUFFER,t.lastBoundFramebuffer);if(t.scissorTest){t.realEnable.call(e,e.SCISSOR_TEST)}t.realColorMask.apply(e,t.colorMask);t.realViewport.apply(e,t.viewport);t.realClearColor.apply(e,t.clearColor)});if(this.cardboardUI){this.cardboardUI.onResize()}};F.prototype.patch=function(){if(this.isPatched){return}var i=this;var n=this.gl.canvas;var a=this.gl;if(!f()){n.width=g()*this.bufferScale;n.height=v()*this.bufferScale;Object.defineProperty(n,"width",{configurable:true,enumerable:true,get:function e(){return i.bufferWidth},set:function e(t){i.bufferWidth=t;i.realCanvasWidth.set.call(n,t);i.onResize()}});Object.defineProperty(n,"height",{configurable:true,enumerable:true,get:function e(){return i.bufferHeight},set:function e(t){i.bufferHeight=t;i.realCanvasHeight.set.call(n,t);i.onResize()}})}this.lastBoundFramebuffer=a.getParameter(a.FRAMEBUFFER_BINDING);if(this.lastBoundFramebuffer==null){this.lastBoundFramebuffer=this.framebuffer;this.gl.bindFramebuffer(a.FRAMEBUFFER,this.framebuffer)}this.gl.bindFramebuffer=function(e,t){i.lastBoundFramebuffer=t?t:i.framebuffer;i.realBindFramebuffer.call(a,e,i.lastBoundFramebuffer)};this.cullFace=a.getParameter(a.CULL_FACE);this.depthTest=a.getParameter(a.DEPTH_TEST);this.blend=a.getParameter(a.BLEND);this.scissorTest=a.getParameter(a.SCISSOR_TEST);this.stencilTest=a.getParameter(a.STENCIL_TEST);a.enable=function(e){switch(e){case a.CULL_FACE:i.cullFace=true;break;case a.DEPTH_TEST:i.depthTest=true;break;case a.BLEND:i.blend=true;break;case a.SCISSOR_TEST:i.scissorTest=true;break;case a.STENCIL_TEST:i.stencilTest=true;break}i.realEnable.call(a,e)};a.disable=function(e){switch(e){case a.CULL_FACE:i.cullFace=false;break;case a.DEPTH_TEST:i.depthTest=false;break;case a.BLEND:i.blend=false;break;case a.SCISSOR_TEST:i.scissorTest=false;break;case a.STENCIL_TEST:i.stencilTest=false;break}i.realDisable.call(a,e)};this.colorMask=a.getParameter(a.COLOR_WRITEMASK);a.colorMask=function(e,t,n,r){i.colorMask[0]=e;i.colorMask[1]=t;i.colorMask[2]=n;i.colorMask[3]=r;i.realColorMask.call(a,e,t,n,r)};this.clearColor=a.getParameter(a.COLOR_CLEAR_VALUE);a.clearColor=function(e,t,n,r){i.clearColor[0]=e;i.clearColor[1]=t;i.clearColor[2]=n;i.clearColor[3]=r;i.realClearColor.call(a,e,t,n,r)};this.viewport=a.getParameter(a.VIEWPORT);a.viewport=function(e,t,n,r){i.viewport[0]=e;i.viewport[1]=t;i.viewport[2]=n;i.viewport[3]=r;i.realViewport.call(a,e,t,n,r)};this.isPatched=true;x(n)};F.prototype.unpatch=function(){if(!this.isPatched){return}var e=this.gl;var t=this.gl.canvas;if(!f()){Object.defineProperty(t,"width",this.realCanvasWidth);Object.defineProperty(t,"height",this.realCanvasHeight)}t.width=this.bufferWidth;t.height=this.bufferHeight;e.bindFramebuffer=this.realBindFramebuffer;e.enable=this.realEnable;e.disable=this.realDisable;e.colorMask=this.realColorMask;e.clearColor=this.realClearColor;e.viewport=this.realViewport;if(this.lastBoundFramebuffer==this.framebuffer){e.bindFramebuffer(e.FRAMEBUFFER,null)}this.isPatched=false;setTimeout(function(){x(t)},1)};F.prototype.setTextureBounds=function(e,t){if(!e){e=[0,0,.5,1]}if(!t){t=[.5,0,.5,1]}this.viewportOffsetScale[0]=e[0];this.viewportOffsetScale[1]=e[1];this.viewportOffsetScale[2]=e[2];this.viewportOffsetScale[3]=e[3];this.viewportOffsetScale[4]=t[0];this.viewportOffsetScale[5]=t[1];this.viewportOffsetScale[6]=t[2];this.viewportOffsetScale[7]=t[3]};F.prototype.submitFrame=function(){var e=this.gl;var r=this;var t=[];if(!this.dirtySubmitFrameBindings){t.push(e.CURRENT_PROGRAM,e.ARRAY_BUFFER_BINDING,e.ELEMENT_ARRAY_BUFFER_BINDING,e.TEXTURE_BINDING_2D,e.TEXTURE0)}N(e,t,function(e){r.realBindFramebuffer.call(e,e.FRAMEBUFFER,null);var t=0;var n=0;if(r.instanceExt){t=e.getVertexAttrib(r.attribs.position,r.instanceExt.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE);n=e.getVertexAttrib(r.attribs.texCoord,r.instanceExt.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE)}if(r.cullFace){r.realDisable.call(e,e.CULL_FACE)}if(r.depthTest){r.realDisable.call(e,e.DEPTH_TEST)}if(r.blend){r.realDisable.call(e,e.BLEND)}if(r.scissorTest){r.realDisable.call(e,e.SCISSOR_TEST)}if(r.stencilTest){r.realDisable.call(e,e.STENCIL_TEST)}r.realColorMask.call(e,true,true,true,true);r.realViewport.call(e,0,0,e.drawingBufferWidth,e.drawingBufferHeight);if(r.ctxAttribs.alpha||f()){r.realClearColor.call(e,0,0,0,1);e.clear(e.COLOR_BUFFER_BIT)}e.useProgram(r.program);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r.indexBuffer);e.bindBuffer(e.ARRAY_BUFFER,r.vertexBuffer);e.enableVertexAttribArray(r.attribs.position);e.enableVertexAttribArray(r.attribs.texCoord);e.vertexAttribPointer(r.attribs.position,2,e.FLOAT,false,20,0);e.vertexAttribPointer(r.attribs.texCoord,3,e.FLOAT,false,20,8);if(r.instanceExt){if(t!=0){r.instanceExt.vertexAttribDivisorANGLE(r.attribs.position,0)}if(n!=0){r.instanceExt.vertexAttribDivisorANGLE(r.attribs.texCoord,0)}}e.activeTexture(e.TEXTURE0);e.uniform1i(r.uniforms.diffuse,0);e.bindTexture(e.TEXTURE_2D,r.renderTarget);e.uniform4fv(r.uniforms.viewportOffsetScale,r.viewportOffsetScale);e.drawElements(e.TRIANGLES,r.indexCount,e.UNSIGNED_SHORT,0);if(r.cardboardUI){r.cardboardUI.renderNoState()}r.realBindFramebuffer.call(r.gl,e.FRAMEBUFFER,r.framebuffer);if(!r.ctxAttribs.preserveDrawingBuffer){r.realClearColor.call(e,0,0,0,0);e.clear(e.COLOR_BUFFER_BIT)}if(!r.dirtySubmitFrameBindings){r.realBindFramebuffer.call(e,e.FRAMEBUFFER,r.lastBoundFramebuffer)}if(r.cullFace){r.realEnable.call(e,e.CULL_FACE)}if(r.depthTest){r.realEnable.call(e,e.DEPTH_TEST)}if(r.blend){r.realEnable.call(e,e.BLEND)}if(r.scissorTest){r.realEnable.call(e,e.SCISSOR_TEST)}if(r.stencilTest){r.realEnable.call(e,e.STENCIL_TEST)}r.realColorMask.apply(e,r.colorMask);r.realViewport.apply(e,r.viewport);if(r.ctxAttribs.alpha||!r.ctxAttribs.preserveDrawingBuffer){r.realClearColor.apply(e,r.clearColor)}if(r.instanceExt){if(t!=0){r.instanceExt.vertexAttribDivisorANGLE(r.attribs.position,t)}if(n!=0){r.instanceExt.vertexAttribDivisorANGLE(r.attribs.texCoord,n)}}});if(f()){var n=e.canvas;if(n.width!=r.bufferWidth||n.height!=r.bufferHeight){r.bufferWidth=n.width;r.bufferHeight=n.height;r.onResize()}}};F.prototype.updateDeviceInfo=function(r){var e=this.gl;var i=this;var t=[e.ARRAY_BUFFER_BINDING,e.ELEMENT_ARRAY_BUFFER_BINDING];N(e,t,function(e){var t=i.computeMeshVertices_(i.meshWidth,i.meshHeight,r);e.bindBuffer(e.ARRAY_BUFFER,i.vertexBuffer);e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW);if(!i.indexCount){var n=i.computeMeshIndices_(i.meshWidth,i.meshHeight);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,i.indexBuffer);e.bufferData(e.ELEMENT_ARRAY_BUFFER,n,e.STATIC_DRAW);i.indexCount=n.length}})};F.prototype.computeMeshVertices_=function(e,t,n){var r=new Float32Array(2*e*t*5);var i=n.getLeftEyeVisibleTanAngles();var a=n.getLeftEyeNoLensTanAngles();var o=n.getLeftEyeVisibleScreenRect(a);var s=0;for(var l=0;l<2;l++){for(var u=0;u<t;u++){for(var c=0;c<e;c++,s++){var d=c/(e-1);var h=u/(t-1);var f=d;var p=h;var m=T(i[0],i[2],d);var g=T(i[3],i[1],h);var v=Math.sqrt(m*m+g*g);var y=n.distortion.distortInverse(v);var _=m*y/v;var b=g*y/v;d=(_-a[0])/(a[2]-a[0]);h=(b-a[3])/(a[1]-a[3]);d=(o.x+d*o.width-.5)*2;h=(o.y+h*o.height-.5)*2;r[s*5+0]=d;r[s*5+1]=h;r[s*5+2]=f;r[s*5+3]=p;r[s*5+4]=l}}var E=i[2]-i[0];i[0]=-(E+i[0]);i[2]=E-i[2];E=a[2]-a[0];a[0]=-(E+a[0]);a[2]=E-a[2];o.x=1-(o.x+o.width)}return r};F.prototype.computeMeshIndices_=function(e,t){var n=new Uint16Array(2*(e-1)*(t-1)*6);var r=e/2;var i=t/2;var a=0;var o=0;for(var s=0;s<2;s++){for(var l=0;l<t;l++){for(var u=0;u<e;u++,a++){if(u==0||l==0)continue;if(u<=r==l<=i){n[o++]=a;n[o++]=a-e-1;n[o++]=a-e;n[o++]=a-e-1;n[o++]=a;n[o++]=a-1}else{n[o++]=a-1;n[o++]=a-e;n[o++]=a;n[o++]=a-e;n[o++]=a-1;n[o++]=a-e-1}}}}return n};F.prototype.getOwnPropertyDescriptor_=function(e,t){var n=Object.getOwnPropertyDescriptor(e,t);if(n.get===undefined||n.set===undefined){n.configurable=true;n.enumerable=true;n.get=function(){return this.getAttribute(t)};n.set=function(e){this.setAttribute(t,e)}}return n};var j=["attribute vec2 position;","uniform mat4 projectionMat;","void main() {","  gl_Position = projectionMat * vec4( position, -1.0, 1.0 );","}"].join("\n");var U=["precision mediump float;","uniform vec4 color;","void main() {","  gl_FragColor = color;","}"].join("\n");var H=Math.PI/180;var G=60;var V=12;var z=20;var W=1;var q=.75;var Y=.3125;var K=4;var X=28;var Q=1.5;function Z(e){this.gl=e;this.attribs={position:0};this.program=E(e,j,U,this.attribs);this.uniforms=A(e,this.program);this.vertexBuffer=e.createBuffer();this.gearOffset=0;this.gearVertexCount=0;this.arrowOffset=0;this.arrowVertexCount=0;this.projMat=new Float32Array(16);this.listener=null;this.onResize()}Z.prototype.destroy=function(){var e=this.gl;if(this.listener){e.canvas.removeEventListener("click",this.listener,false)}e.deleteProgram(this.program);e.deleteBuffer(this.vertexBuffer)};Z.prototype.listen=function(r,i){var a=this.gl.canvas;this.listener=function(e){var t=a.clientWidth/2;var n=X*Q;if(e.clientX>t-n&&e.clientX<t+n&&e.clientY>a.clientHeight-n){r(e)}else if(e.clientX<n&&e.clientY<n){i(e)}};a.addEventListener("click",this.listener,false)};Z.prototype.onResize=function(){var e=this.gl;var m=this;var t=[e.ARRAY_BUFFER_BINDING];N(e,t,function(n){var a=[];var o=n.drawingBufferWidth/2;var e=Math.max(screen.width,screen.height)*window.devicePixelRatio;var t=n.drawingBufferWidth/e;var r=t*window.devicePixelRatio;var i=K*r/2;var s=X*Q*r;var l=X*r/2;var u=(X*Q-X)*r;a.push(o-i,s);a.push(o-i,n.drawingBufferHeight);a.push(o+i,s);a.push(o+i,n.drawingBufferHeight);m.gearOffset=a.length/2;function c(e,t){var n=(90-e)*H;var r=Math.cos(n);var i=Math.sin(n);a.push(Y*r*l+o,Y*i*l+l);a.push(t*r*l+o,t*i*l+l)}for(var d=0;d<=6;d++){var h=d*G;c(h,W);c(h+V,W);c(h+z,q);c(h+(G-z),q);c(h+(G-V),W)}m.gearVertexCount=a.length/2-m.gearOffset;m.arrowOffset=a.length/2;function f(e,t){a.push(u+e,n.drawingBufferHeight-u-t)}var p=i/Math.sin(45*H);f(0,l);f(l,0);f(l+p,p);f(p,l+p);f(p,l-p);f(0,l);f(l,l*2);f(l+p,l*2-p);f(p,l-p);f(0,l);f(p,l-i);f(X*r,l-i);f(p,l+i);f(X*r,l+i);m.arrowVertexCount=a.length/2-m.arrowOffset;n.bindBuffer(n.ARRAY_BUFFER,m.vertexBuffer);n.bufferData(n.ARRAY_BUFFER,new Float32Array(a),n.STATIC_DRAW)})};Z.prototype.render=function(){var e=this.gl;var t=this;var n=[e.CULL_FACE,e.DEPTH_TEST,e.BLEND,e.SCISSOR_TEST,e.STENCIL_TEST,e.COLOR_WRITEMASK,e.VIEWPORT,e.CURRENT_PROGRAM,e.ARRAY_BUFFER_BINDING];N(e,n,function(e){e.disable(e.CULL_FACE);e.disable(e.DEPTH_TEST);e.disable(e.BLEND);e.disable(e.SCISSOR_TEST);e.disable(e.STENCIL_TEST);e.colorMask(true,true,true,true);e.viewport(0,0,e.drawingBufferWidth,e.drawingBufferHeight);t.renderNoState()})};Z.prototype.renderNoState=function(){var e=this.gl;e.useProgram(this.program);e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer);e.enableVertexAttribArray(this.attribs.position);e.vertexAttribPointer(this.attribs.position,2,e.FLOAT,false,8,0);e.uniform4f(this.uniforms.color,1,1,1,1);w(this.projMat,0,e.drawingBufferWidth,0,e.drawingBufferHeight,.1,1024);e.uniformMatrix4fv(this.uniforms.projectionMat,false,this.projMat);e.drawArrays(e.TRIANGLE_STRIP,0,4);e.drawArrays(e.TRIANGLE_STRIP,this.gearOffset,this.gearVertexCount);e.drawArrays(e.TRIANGLE_STRIP,this.arrowOffset,this.arrowVertexCount)};function J(e){this.coefficients=e}J.prototype.distortInverse=function(e){var t=0;var n=1;var r=e-this.distort(t);while(Math.abs(n-t)>1e-4){var i=e-this.distort(n);var a=n-i*((n-t)/(i-r));t=n;n=a;r=i}return n};J.prototype.distort=function(e){var t=e*e;var n=0;for(var r=0;r<this.coefficients.length;r++){n=t*(n+this.coefficients[r])}return(n+1)*e};var $=Math.PI/180;var ee=180/Math.PI;var te=function e(t,n,r){this.x=t||0;this.y=n||0;this.z=r||0};te.prototype={constructor:te,set:function e(t,n,r){this.x=t;this.y=n;this.z=r;return this},copy:function e(t){this.x=t.x;this.y=t.y;this.z=t.z;return this},length:function e(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function e(){var t=this.length();if(t!==0){var n=1/t;this.multiplyScalar(n)}else{this.x=0;this.y=0;this.z=0}return this},multiplyScalar:function e(t){this.x*=t;this.y*=t;this.z*=t},applyQuaternion:function e(t){var n=this.x;var r=this.y;var i=this.z;var a=t.x;var o=t.y;var s=t.z;var l=t.w;var u=l*n+o*i-s*r;var c=l*r+s*n-a*i;var d=l*i+a*r-o*n;var h=-a*n-o*r-s*i;this.x=u*l+h*-a+c*-s-d*-o;this.y=c*l+h*-o+d*-a-u*-s;this.z=d*l+h*-s+u*-o-c*-a;return this},dot:function e(t){return this.x*t.x+this.y*t.y+this.z*t.z},crossVectors:function e(t,n){var r=t.x,i=t.y,a=t.z;var o=n.x,s=n.y,l=n.z;this.x=i*l-a*s;this.y=a*o-r*l;this.z=r*s-i*o;return this}};var ne=function e(t,n,r,i){this.x=t||0;this.y=n||0;this.z=r||0;this.w=i!==undefined?i:1};ne.prototype={constructor:ne,set:function e(t,n,r,i){this.x=t;this.y=n;this.z=r;this.w=i;return this},copy:function e(t){this.x=t.x;this.y=t.y;this.z=t.z;this.w=t.w;return this},setFromEulerXYZ:function e(t,n,r){var i=Math.cos(t/2);var a=Math.cos(n/2);var o=Math.cos(r/2);var s=Math.sin(t/2);var l=Math.sin(n/2);var u=Math.sin(r/2);this.x=s*a*o+i*l*u;this.y=i*l*o-s*a*u;this.z=i*a*u+s*l*o;this.w=i*a*o-s*l*u;return this},setFromEulerYXZ:function e(t,n,r){var i=Math.cos(t/2);var a=Math.cos(n/2);var o=Math.cos(r/2);var s=Math.sin(t/2);var l=Math.sin(n/2);var u=Math.sin(r/2);this.x=s*a*o+i*l*u;this.y=i*l*o-s*a*u;this.z=i*a*u-s*l*o;this.w=i*a*o+s*l*u;return this},setFromAxisAngle:function e(t,n){var r=n/2,i=Math.sin(r);this.x=t.x*i;this.y=t.y*i;this.z=t.z*i;this.w=Math.cos(r);return this},multiply:function e(t){return this.multiplyQuaternions(this,t)},multiplyQuaternions:function e(t,n){var r=t.x,i=t.y,a=t.z,o=t.w;var s=n.x,l=n.y,u=n.z,c=n.w;this.x=r*c+o*s+i*u-a*l;this.y=i*c+o*l+a*s-r*u;this.z=a*c+o*u+r*l-i*s;this.w=o*c-r*s-i*l-a*u;return this},inverse:function e(){this.x*=-1;this.y*=-1;this.z*=-1;this.normalize();return this},normalize:function e(){var t=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);if(t===0){this.x=0;this.y=0;this.z=0;this.w=1}else{t=1/t;this.x=this.x*t;this.y=this.y*t;this.z=this.z*t;this.w=this.w*t}return this},slerp:function e(t,n){if(n===0)return this;if(n===1)return this.copy(t);var r=this.x,i=this.y,a=this.z,o=this.w;var s=o*t.w+r*t.x+i*t.y+a*t.z;if(s<0){this.w=-t.w;this.x=-t.x;this.y=-t.y;this.z=-t.z;s=-s}else{this.copy(t)}if(s>=1){this.w=o;this.x=r;this.y=i;this.z=a;return this}var l=Math.acos(s);var u=Math.sqrt(1-s*s);if(Math.abs(u)<.001){this.w=.5*(o+this.w);this.x=.5*(r+this.x);this.y=.5*(i+this.y);this.z=.5*(a+this.z);return this}var c=Math.sin((1-n)*l)/u,d=Math.sin(n*l)/u;this.w=o*c+this.w*d;this.x=r*c+this.x*d;this.y=i*c+this.y*d;this.z=a*c+this.z*d;return this},setFromUnitVectors:function(){var n,r;var i=1e-6;return function(e,t){if(n===undefined)n=new te;r=e.dot(t)+1;if(r<i){r=0;if(Math.abs(e.x)>Math.abs(e.z)){n.set(-e.y,e.x,0)}else{n.set(0,-e.z,e.y)}}else{n.crossVectors(e,t)}this.x=n.x;this.y=n.y;this.z=n.z;this.w=r;this.normalize();return this}}()};function re(e){this.width=e.width||g();this.height=e.height||v();this.widthMeters=e.widthMeters;this.heightMeters=e.heightMeters;this.bevelMeters=e.bevelMeters}var ie=new re({widthMeters:.11,heightMeters:.062,bevelMeters:.004});var ae=new re({widthMeters:.1038,heightMeters:.0584,bevelMeters:.004});var oe={CardboardV1:new le({id:"CardboardV1",label:"Cardboard I/O 2014",fov:40,interLensDistance:.06,baselineLensDistance:.035,screenLensDistance:.042,distortionCoefficients:[.441,.156],inverseCoefficients:[-.4410035,.42756155,-.4804439,.5460139,-.58821183,.5733938,-.48303202,.33299083,-.17573841,.0651772,-.01488963,.001559834]}),CardboardV2:new le({id:"CardboardV2",label:"Cardboard I/O 2015",fov:60,interLensDistance:.064,baselineLensDistance:.035,screenLensDistance:.039,distortionCoefficients:[.34,.55],inverseCoefficients:[-.33836704,-.18162185,.862655,-1.2462051,1.0560602,-.58208317,.21609078,-.05444823,.009177956,-.0009904169,6183535e-11,-16981803e-13]})};function se(e,t){this.viewer=oe.CardboardV2;this.updateDeviceParams(e);this.distortion=new J(this.viewer.distortionCoefficients);for(var n=0;n<t.length;n++){var r=t[n];oe[r.id]=new le(r)}}se.prototype.updateDeviceParams=function(e){this.device=this.determineDevice_(e)||this.device};se.prototype.getDevice=function(){return this.device};se.prototype.setViewer=function(e){this.viewer=e;this.distortion=new J(this.viewer.distortionCoefficients)};se.prototype.determineDevice_=function(e){if(!e){if(f()){console.warn("Using fallback iOS device measurements.");return ae}else{console.warn("Using fallback Android device measurements.");return ie}}var t=.0254;var n=t/e.xdpi;var r=t/e.ydpi;var i=g();var a=v();return new re({widthMeters:n*i,heightMeters:r*a,bevelMeters:e.bevelMm*.001})};se.prototype.getDistortedFieldOfViewLeftEye=function(){var e=this.viewer;var t=this.device;var n=this.distortion;var r=e.screenLensDistance;var i=(t.widthMeters-e.interLensDistance)/2;var a=e.interLensDistance/2;var o=e.baselineLensDistance-t.bevelMeters;var s=t.heightMeters-o;var l=ee*Math.atan(n.distort(i/r));var u=ee*Math.atan(n.distort(a/r));var c=ee*Math.atan(n.distort(o/r));var d=ee*Math.atan(n.distort(s/r));return{leftDegrees:Math.min(l,e.fov),rightDegrees:Math.min(u,e.fov),downDegrees:Math.min(c,e.fov),upDegrees:Math.min(d,e.fov)}};se.prototype.getLeftEyeVisibleTanAngles=function(){var e=this.viewer;var t=this.device;var n=this.distortion;var r=Math.tan(-$*e.fov);var i=Math.tan($*e.fov);var a=Math.tan($*e.fov);var o=Math.tan(-$*e.fov);var s=t.widthMeters/4;var l=t.heightMeters/2;var u=e.baselineLensDistance-t.bevelMeters-l;var c=e.interLensDistance/2-s;var d=-u;var h=e.screenLensDistance;var f=n.distort((c-s)/h);var p=n.distort((d+l)/h);var m=n.distort((c+s)/h);var g=n.distort((d-l)/h);var v=new Float32Array(4);v[0]=Math.max(r,f);v[1]=Math.min(i,p);v[2]=Math.min(a,m);v[3]=Math.max(o,g);return v};se.prototype.getLeftEyeNoLensTanAngles=function(){var e=this.viewer;var t=this.device;var n=this.distortion;var r=new Float32Array(4);var i=n.distortInverse(Math.tan(-$*e.fov));var a=n.distortInverse(Math.tan($*e.fov));var o=n.distortInverse(Math.tan($*e.fov));var s=n.distortInverse(Math.tan(-$*e.fov));var l=t.widthMeters/4;var u=t.heightMeters/2;var c=e.baselineLensDistance-t.bevelMeters-u;var d=e.interLensDistance/2-l;var h=-c;var f=e.screenLensDistance;var p=(d-l)/f;var m=(h+u)/f;var g=(d+l)/f;var v=(h-u)/f;r[0]=Math.max(i,p);r[1]=Math.min(a,m);r[2]=Math.min(o,g);r[3]=Math.max(s,v);return r};se.prototype.getLeftEyeVisibleScreenRect=function(e){var t=this.viewer;var n=this.device;var r=t.screenLensDistance;var i=(n.widthMeters-t.interLensDistance)/2;var a=t.baselineLensDistance-n.bevelMeters;var o=(e[0]*r+i)/n.widthMeters;var s=(e[1]*r+a)/n.heightMeters;var l=(e[2]*r+i)/n.widthMeters;var u=(e[3]*r+a)/n.heightMeters;return{x:o,y:u,width:l-o,height:s-u}};se.prototype.getFieldOfViewLeftEye=function(e){return e?this.getUndistortedFieldOfViewLeftEye():this.getDistortedFieldOfViewLeftEye()};se.prototype.getFieldOfViewRightEye=function(e){var t=this.getFieldOfViewLeftEye(e);return{leftDegrees:t.rightDegrees,rightDegrees:t.leftDegrees,upDegrees:t.upDegrees,downDegrees:t.downDegrees}};se.prototype.getUndistortedFieldOfViewLeftEye=function(){var e=this.getUndistortedParams_();return{leftDegrees:ee*Math.atan(e.outerDist),rightDegrees:ee*Math.atan(e.innerDist),downDegrees:ee*Math.atan(e.bottomDist),upDegrees:ee*Math.atan(e.topDist)}};se.prototype.getUndistortedViewportLeftEye=function(){var e=this.getUndistortedParams_();var t=this.viewer;var n=this.device;var r=t.screenLensDistance;var i=n.widthMeters/r;var a=n.heightMeters/r;var o=n.width/i;var s=n.height/a;var l=Math.round((e.eyePosX-e.outerDist)*o);var u=Math.round((e.eyePosY-e.bottomDist)*s);return{x:l,y:u,width:Math.round((e.eyePosX+e.innerDist)*o)-l,height:Math.round((e.eyePosY+e.topDist)*s)-u}};se.prototype.getUndistortedParams_=function(){var e=this.viewer;var t=this.device;var n=this.distortion;var r=e.screenLensDistance;var i=e.interLensDistance/2/r;var a=t.widthMeters/r;var o=t.heightMeters/r;var s=a/2-i;var l=(e.baselineLensDistance-t.bevelMeters)/r;var u=e.fov;var c=n.distortInverse(Math.tan($*u));var d=Math.min(s,c);var h=Math.min(i,c);var f=Math.min(l,c);var p=Math.min(o-l,c);return{outerDist:d,innerDist:h,topDist:p,bottomDist:f,eyePosX:s,eyePosY:l}};function le(e){this.id=e.id;this.label=e.label;this.fov=e.fov;this.interLensDistance=e.interLensDistance;this.baselineLensDistance=e.baselineLensDistance;this.screenLensDistance=e.screenLensDistance;this.distortionCoefficients=e.distortionCoefficients;this.inverseCoefficients=e.inverseCoefficients}se.Viewers=oe;var ue=1;var ce="2019-11-09T17:36:14Z";var de=[{type:"android",rules:[{mdmh:"asus/*/Nexus 7/*"},{ua:"Nexus 7"}],dpi:[320.8,323],bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_X00PD/*"},{ua:"ASUS_X00PD"}],dpi:245,bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_X008D/*"},{ua:"ASUS_X008D"}],dpi:282,bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_Z00AD/*"},{ua:"ASUS_Z00AD"}],dpi:[403,404.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 2 XL/*"},{ua:"Pixel 2 XL"}],dpi:537.9,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 3 XL/*"},{ua:"Pixel 3 XL"}],dpi:[558.5,553.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel XL/*"},{ua:"Pixel XL"}],dpi:[537.9,533],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 3/*"},{ua:"Pixel 3"}],dpi:442.4,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 2/*"},{ua:"Pixel 2"}],dpi:441,bw:3,ac:500},{type:"android",rules:[{mdmh:"Google/*/Pixel/*"},{ua:"Pixel"}],dpi:[432.6,436.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC6435LVW/*"},{ua:"HTC6435LVW"}],dpi:[449.7,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC One XL/*"},{ua:"HTC One XL"}],dpi:[315.3,314.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"htc/*/Nexus 9/*"},{ua:"Nexus 9"}],dpi:289,bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One M9/*"},{ua:"HTC One M9"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One_M8/*"},{ua:"HTC One_M8"}],dpi:[449.7,447.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One/*"},{ua:"HTC One"}],dpi:472.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/Nexus 6P/*"},{ua:"Nexus 6P"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/BLN-L24/*"},{ua:"HONORBLN-L24"}],dpi:480,bw:4,ac:500},{type:"android",rules:[{mdmh:"Huawei/*/BKL-L09/*"},{ua:"BKL-L09"}],dpi:403,bw:3.47,ac:500},{type:"android",rules:[{mdmh:"LENOVO/*/Lenovo PB2-690Y/*"},{ua:"Lenovo PB2-690Y"}],dpi:[457.2,454.713],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5X/*"},{ua:"Nexus 5X"}],dpi:[422,419.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS345/*"},{ua:"LGMS345"}],dpi:[221.7,219.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D800/*"},{ua:"LG-D800"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D850/*"},{ua:"LG-D850"}],dpi:[537.9,541.9],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/VS985 4G/*"},{ua:"VS985 4G"}],dpi:[537.9,535.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5/*"},{ua:"Nexus 5 B"}],dpi:[442.4,444.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 4/*"},{ua:"Nexus 4"}],dpi:[319.8,318.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LG-P769/*"},{ua:"LG-P769"}],dpi:[240.6,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS323/*"},{ua:"LGMS323"}],dpi:[206.6,204.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGLS996/*"},{ua:"LGLS996"}],dpi:[403.4,401.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/4560MMX/*"},{ua:"4560MMX"}],dpi:[240,219.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/A250/*"},{ua:"Micromax A250"}],dpi:[480,446.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/Micromax AQ4501/*"},{ua:"Micromax AQ4501"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/G5/*"},{ua:"Moto G (5) Plus"}],dpi:[403.4,403],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/DROID RAZR/*"},{ua:"DROID RAZR"}],dpi:[368.1,256.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT830C/*"},{ua:"XT830C"}],dpi:[254,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1021/*"},{ua:"XT1021"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1023/*"},{ua:"XT1023"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1028/*"},{ua:"XT1028"}],dpi:[326.6,327.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1034/*"},{ua:"XT1034"}],dpi:[326.6,328.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1053/*"},{ua:"XT1053"}],dpi:[315.3,316.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1562/*"},{ua:"XT1562"}],dpi:[403.4,402.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/Nexus 6/*"},{ua:"Nexus 6 B"}],dpi:[494.3,489.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1063/*"},{ua:"XT1063"}],dpi:[295,296.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1064/*"},{ua:"XT1064"}],dpi:[295,295.6],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1092/*"},{ua:"XT1092"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1095/*"},{ua:"XT1095"}],dpi:[422,423.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/G4/*"},{ua:"Moto G (4)"}],dpi:401,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/A0001/*"},{ua:"A0001"}],dpi:[403.4,401],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1001/*"},{ua:"ONE E1001"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1003/*"},{ua:"ONE E1003"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1005/*"},{ua:"ONE E1005"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2001/*"},{ua:"ONE A2001"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2003/*"},{ua:"ONE A2003"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2005/*"},{ua:"ONE A2005"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3000/*"},{ua:"ONEPLUS A3000"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3003/*"},{ua:"ONEPLUS A3003"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3010/*"},{ua:"ONEPLUS A3010"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A5000/*"},{ua:"ONEPLUS A5000 "}],dpi:[403.411,399.737],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A5010/*"},{ua:"ONEPLUS A5010"}],dpi:[403,400],bw:2,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6000/*"},{ua:"ONEPLUS A6000"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6003/*"},{ua:"ONEPLUS A6003"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6010/*"},{ua:"ONEPLUS A6010"}],dpi:401,bw:2,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6013/*"},{ua:"ONEPLUS A6013"}],dpi:401,bw:2,ac:500},{type:"android",rules:[{mdmh:"OPPO/*/X909/*"},{ua:"X909"}],dpi:[442.4,444.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9082/*"},{ua:"GT-I9082"}],dpi:[184.7,185.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G360P/*"},{ua:"SM-G360P"}],dpi:[196.7,205.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Nexus S/*"},{ua:"Nexus S"}],dpi:[234.5,229.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[304.8,303.9],bw:5,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-T230NU/*"},{ua:"SM-T230NU"}],dpi:216,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SGH-T399/*"},{ua:"SGH-T399"}],dpi:[217.7,231.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SGH-M919/*"},{ua:"SGH-M919"}],dpi:[440.8,437.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N9005/*"},{ua:"SM-N9005"}],dpi:[386.4,387],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SM-N900A/*"},{ua:"SAMSUNG-SM-N900A"}],dpi:[386.4,387.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9500/*"},{ua:"GT-I9500"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/GT-I9505/*"},{ua:"GT-I9505"}],dpi:439.4,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900F/*"},{ua:"SM-G900F"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900M/*"},{ua:"SM-G900M"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G800F/*"},{ua:"SM-G800F"}],dpi:326.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G906S/*"},{ua:"SM-G906S"}],dpi:[562.7,572.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[306.7,304.8],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-T535/*"},{ua:"SM-T535"}],dpi:[142.6,136.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-N920C/*"},{ua:"SM-N920C"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920P/*"},{ua:"SM-N920P"}],dpi:[386.3655,390.144],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920W8/*"},{ua:"SM-N920W8"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300I/*"},{ua:"GT-I9300I"}],dpi:[304.8,305.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9195/*"},{ua:"GT-I9195"}],dpi:[249.4,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SPH-L520/*"},{ua:"SPH-L520"}],dpi:[249.4,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SGH-I717/*"},{ua:"SAMSUNG-SGH-I717"}],dpi:285.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SPH-D710/*"},{ua:"SPH-D710"}],dpi:[217.7,204.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-N7100/*"},{ua:"GT-N7100"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SCH-I605/*"},{ua:"SCH-I605"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Galaxy Nexus/*"},{ua:"Galaxy Nexus"}],dpi:[315.3,314.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910H/*"},{ua:"SM-N910H"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910C/*"},{ua:"SM-N910C"}],dpi:[515.2,520.2],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G130M/*"},{ua:"SM-G130M"}],dpi:[165.9,164.8],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G928I/*"},{ua:"SM-G928I"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G920F/*"},{ua:"SM-G920F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G920P/*"},{ua:"SM-G920P"}],dpi:[522.5,577],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G925F/*"},{ua:"SM-G925F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G925V/*"},{ua:"SM-G925V"}],dpi:[522.5,576.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G930F/*"},{ua:"SM-G930F"}],dpi:576.6,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G935F/*"},{ua:"SM-G935F"}],dpi:533,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G950F/*"},{ua:"SM-G950F"}],dpi:[562.707,565.293],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955U/*"},{ua:"SM-G955U"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955F/*"},{ua:"SM-G955F"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G960F/*"},{ua:"SM-G960F"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G9600/*"},{ua:"SM-G9600"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960T/*"},{ua:"SM-G960T"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960N/*"},{ua:"SM-G960N"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960U/*"},{ua:"SM-G960U"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G9608/*"},{ua:"SM-G9608"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960FD/*"},{ua:"SM-G960FD"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960W/*"},{ua:"SM-G960W"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G965F/*"},{ua:"SM-G965F"}],dpi:529,bw:2,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/C6903/*"},{ua:"C6903"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"Sony/*/D6653/*"},{ua:"D6653"}],dpi:[428.6,427.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6653/*"},{ua:"E6653"}],dpi:[428.6,425.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6853/*"},{ua:"E6853"}],dpi:[403.4,401.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/SGP321/*"},{ua:"SGP321"}],dpi:[224.7,224.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"TCT/*/ALCATEL ONE TOUCH Fierce/*"},{ua:"ALCATEL ONE TOUCH Fierce"}],dpi:[240,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"THL/*/thl 5000/*"},{ua:"thl 5000"}],dpi:[480,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Fly/*/IQ4412/*"},{ua:"IQ4412"}],dpi:307.9,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"ZTE/*/ZTE Blade L2/*"},{ua:"ZTE Blade L2"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"BENEVE/*/VR518/*"},{ua:"VR518"}],dpi:480,bw:3,ac:500},{type:"ios",rules:[{res:[640,960]}],dpi:[325.1,328.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[640,1136]}],dpi:[317.1,320.2],bw:3,ac:1e3},{type:"ios",rules:[{res:[750,1334]}],dpi:326.4,bw:4,ac:1e3},{type:"ios",rules:[{res:[1242,2208]}],dpi:[453.6,458.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2001]}],dpi:[410.9,415.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2436]}],dpi:458,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/EML-L29/*"},{ua:"EML-L29"}],dpi:428,bw:3.45,ac:500},{type:"android",rules:[{mdmh:"Nokia/*/Nokia 7.1/*"},{ua:"Nokia 7.1"}],dpi:[432,431.9],bw:3,ac:500},{type:"ios",rules:[{res:[1242,2688]}],dpi:458,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G570M/*"},{ua:"SM-G570M"}],dpi:320,bw:3.684,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G970F/*"},{ua:"SM-G970F"}],dpi:438,bw:2.281,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G973F/*"},{ua:"SM-G973F"}],dpi:550,bw:2.002,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G975F/*"},{ua:"SM-G975F"}],dpi:522,bw:2.054,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G977F/*"},{ua:"SM-G977F"}],dpi:505,bw:2.334,ac:500},{type:"ios",rules:[{res:[828,1792]}],dpi:326,bw:5,ac:500}];var he={format:ue,last_updated:ce,devices:de};function fe(e,t){this.dpdb=he;this.recalculateDeviceParams_();if(e){this.onDeviceParamsUpdated=t;var n=new XMLHttpRequest;var r=this;n.open("GET",e,true);n.addEventListener("load",function(){r.loading=false;if(n.status>=200&&n.status<=299){r.dpdb=JSON.parse(n.response);r.recalculateDeviceParams_()}else{console.error("Error loading online DPDB!")}});n.send()}}fe.prototype.getDeviceParams=function(){return this.deviceParams};fe.prototype.recalculateDeviceParams_=function(){var e=this.calcDeviceParams_();if(e){this.deviceParams=e;if(this.onDeviceParamsUpdated){this.onDeviceParamsUpdated(this.deviceParams)}}else{console.error("Failed to recalculate device parameters.")}};fe.prototype.calcDeviceParams_=function(){var e=this.dpdb;if(!e){console.error("DPDB not available.");return null}if(e.format!=1){console.error("DPDB has unexpected format version.");return null}if(!e.devices||!e.devices.length){console.error("DPDB does not have a devices section.");return null}var t=navigator.userAgent||navigator.vendor||window.opera;var n=g();var r=v();if(!e.devices){console.error("DPDB has no devices section.");return null}for(var i=0;i<e.devices.length;i++){var a=e.devices[i];if(!a.rules){console.warn("Device["+i+"] has no rules section.");continue}if(a.type!="ios"&&a.type!="android"){console.warn("Device["+i+"] has invalid type.");continue}if(f()!=(a.type=="ios"))continue;var o=false;for(var s=0;s<a.rules.length;s++){var l=a.rules[s];if(this.ruleMatches_(l,t,n,r)){o=true;break}}if(!o)continue;var u=a.dpi[0]||a.dpi;var c=a.dpi[1]||a.dpi;return new pe({xdpi:u,ydpi:c,bevelMm:a.bw})}console.warn("No DPDB device match.");return null};fe.prototype.ruleMatches_=function(e,t,n,r){if(!e.ua&&!e.res)return false;if(e.ua&&e.ua.substring(0,2)==="SM")e.ua=e.ua.substring(0,7);if(e.ua&&t.indexOf(e.ua)<0)return false;if(e.res){if(!e.res[0]||!e.res[1])return false;var i=e.res[0];var a=e.res[1];if(Math.min(n,r)!=Math.min(i,a)||Math.max(n,r)!=Math.max(i,a)){return false}}return true};function pe(e){this.xdpi=e.xdpi;this.ydpi=e.ydpi;this.bevelMm=e.bevelMm}function me(e,t){this.set(e,t)}me.prototype.set=function(e,t){this.sample=e;this.timestampS=t};me.prototype.copy=function(e){this.set(e.sample,e.timestampS)};function ge(e,t){this.kFilter=e;this.isDebug=t;this.currentAccelMeasurement=new me;this.currentGyroMeasurement=new me;this.previousGyroMeasurement=new me;if(f()){this.filterQ=new ne(-1,0,0,1)}else{this.filterQ=new ne(1,0,0,1)}this.previousFilterQ=new ne;this.previousFilterQ.copy(this.filterQ);this.accelQ=new ne;this.isOrientationInitialized=false;this.estimatedGravity=new te;this.measuredGravity=new te;this.gyroIntegralQ=new ne}ge.prototype.addAccelMeasurement=function(e,t){this.currentAccelMeasurement.set(e,t)};ge.prototype.addGyroMeasurement=function(e,t){this.currentGyroMeasurement.set(e,t);var n=t-this.previousGyroMeasurement.timestampS;if(i(n)){this.run_()}this.previousGyroMeasurement.copy(this.currentGyroMeasurement)};ge.prototype.run_=function(){if(!this.isOrientationInitialized){this.accelQ=this.accelToQuaternion_(this.currentAccelMeasurement.sample);this.previousFilterQ.copy(this.accelQ);this.isOrientationInitialized=true;return}var e=this.currentGyroMeasurement.timestampS-this.previousGyroMeasurement.timestampS;var t=this.gyroToQuaternionDelta_(this.currentGyroMeasurement.sample,e);this.gyroIntegralQ.multiply(t);this.filterQ.copy(this.previousFilterQ);this.filterQ.multiply(t);var n=new ne;n.copy(this.filterQ);n.inverse();this.estimatedGravity.set(0,0,-1);this.estimatedGravity.applyQuaternion(n);this.estimatedGravity.normalize();this.measuredGravity.copy(this.currentAccelMeasurement.sample);this.measuredGravity.normalize();var r=new ne;r.setFromUnitVectors(this.estimatedGravity,this.measuredGravity);r.inverse();if(this.isDebug){console.log("Delta: %d deg, G_est: (%s, %s, %s), G_meas: (%s, %s, %s)",ee*P(r),this.estimatedGravity.x.toFixed(1),this.estimatedGravity.y.toFixed(1),this.estimatedGravity.z.toFixed(1),this.measuredGravity.x.toFixed(1),this.measuredGravity.y.toFixed(1),this.measuredGravity.z.toFixed(1))}var i=new ne;i.copy(this.filterQ);i.multiply(r);this.filterQ.slerp(i,1-this.kFilter);this.previousFilterQ.copy(this.filterQ)};ge.prototype.getOrientation=function(){return this.filterQ};ge.prototype.accelToQuaternion_=function(e){var t=new te;t.copy(e);t.normalize();var n=new ne;n.setFromUnitVectors(new te(0,0,-1),t);n.inverse();return n};ge.prototype.gyroToQuaternionDelta_=function(e,t){var n=new ne;var r=new te;r.copy(e);r.normalize();n.setFromAxisAngle(r,e.length()*t);return n};function ve(e,t){this.predictionTimeS=e;this.isDebug=t;this.previousQ=new ne;this.previousTimestampS=null;this.deltaQ=new ne;this.outQ=new ne}ve.prototype.getPrediction=function(e,t,n){if(!this.previousTimestampS){this.previousQ.copy(e);this.previousTimestampS=n;return e}var r=new te;r.copy(t);r.normalize();var i=t.length();if(i<$*20){if(this.isDebug){console.log("Moving slowly, at %s deg/s: no prediction",(ee*i).toFixed(1))}this.outQ.copy(e);this.previousQ.copy(e);return this.outQ}var a=i*this.predictionTimeS;this.deltaQ.setFromAxisAngle(r,a);this.outQ.copy(this.previousQ);this.outQ.multiply(this.deltaQ);this.previousQ.copy(e);this.previousTimestampS=n;return this.outQ};function ye(e,t,n,r){this.yawOnly=n;this.accelerometer=new te;this.gyroscope=new te;this.filter=new ge(e,r);this.posePredictor=new ve(t,r);this.isFirefoxAndroid=s();this.isIOS=f();var i=u();this.isDeviceMotionInRadians=!this.isIOS&&i&&i<66;this.isWithoutDeviceMotion=d()||c();this.filterToWorldQ=new ne;if(f()){this.filterToWorldQ.setFromAxisAngle(new te(1,0,0),Math.PI/2)}else{this.filterToWorldQ.setFromAxisAngle(new te(1,0,0),-Math.PI/2)}this.inverseWorldToScreenQ=new ne;this.worldToScreenQ=new ne;this.originalPoseAdjustQ=new ne;this.originalPoseAdjustQ.setFromAxisAngle(new te(0,0,1),-window.orientation*Math.PI/180);this.setScreenTransform_();if(m()){this.filterToWorldQ.multiply(this.inverseWorldToScreenQ)}this.resetQ=new ne;this.orientationOut_=new Float32Array(4);this.start()}ye.prototype.getPosition=function(){return null};ye.prototype.getOrientation=function(){var e=void 0;if(this.isWithoutDeviceMotion&&this._deviceOrientationQ){this.deviceOrientationFixQ=this.deviceOrientationFixQ||function(){var e=(new ne).setFromAxisAngle(new te(0,0,-1),0);var t=new ne;if(window.orientation===-90){t.setFromAxisAngle(new te(0,1,0),Math.PI/-2)}else{t.setFromAxisAngle(new te(0,1,0),Math.PI/2)}return e.multiply(t)}();this.deviceOrientationFilterToWorldQ=this.deviceOrientationFilterToWorldQ||function(){var e=new ne;e.setFromAxisAngle(new te(1,0,0),-Math.PI/2);return e}();e=this._deviceOrientationQ;var t=new ne;t.copy(e);t.multiply(this.deviceOrientationFilterToWorldQ);t.multiply(this.resetQ);t.multiply(this.worldToScreenQ);t.multiplyQuaternions(this.deviceOrientationFixQ,t);if(this.yawOnly){t.x=0;t.z=0;t.normalize()}this.orientationOut_[0]=t.x;this.orientationOut_[1]=t.y;this.orientationOut_[2]=t.z;this.orientationOut_[3]=t.w;return this.orientationOut_}else{var n=this.filter.getOrientation();e=this.posePredictor.getPrediction(n,this.gyroscope,this.previousTimestampS)}var t=new ne;t.copy(this.filterToWorldQ);t.multiply(this.resetQ);t.multiply(e);t.multiply(this.worldToScreenQ);if(this.yawOnly){t.x=0;t.z=0;t.normalize()}this.orientationOut_[0]=t.x;this.orientationOut_[1]=t.y;this.orientationOut_[2]=t.z;this.orientationOut_[3]=t.w;return this.orientationOut_};ye.prototype.resetPose=function(){this.resetQ.copy(this.filter.getOrientation());this.resetQ.x=0;this.resetQ.y=0;this.resetQ.z*=-1;this.resetQ.normalize();if(m()){this.resetQ.multiply(this.inverseWorldToScreenQ)}this.resetQ.multiply(this.originalPoseAdjustQ)};ye.prototype.onDeviceOrientation_=function(e){this._deviceOrientationQ=this._deviceOrientationQ||new ne;var t=e.alpha,n=e.beta,r=e.gamma;t=(t||0)*Math.PI/180;n=(n||0)*Math.PI/180;r=(r||0)*Math.PI/180;this._deviceOrientationQ.setFromEulerYXZ(n,t,-r)};ye.prototype.onDeviceMotion_=function(e){this.updateDeviceMotion_(e)};ye.prototype.updateDeviceMotion_=function(e){var t=e.accelerationIncludingGravity;var n=e.rotationRate;var r=e.timeStamp/1e3;var i=r-this.previousTimestampS;if(i<0){D("fusion-pose-sensor:invalid:non-monotonic","Invalid timestamps detected: non-monotonic timestamp from devicemotion");this.previousTimestampS=r;return}else if(i<=a||i>o){D("fusion-pose-sensor:invalid:outside-threshold","Invalid timestamps detected: Timestamp from devicemotion outside expected range.");this.previousTimestampS=r;return}this.accelerometer.set(-t.x,-t.y,-t.z);if(n){if(h()){this.gyroscope.set(-n.beta,n.alpha,n.gamma)}else{this.gyroscope.set(n.alpha,n.beta,n.gamma)}if(!this.isDeviceMotionInRadians){this.gyroscope.multiplyScalar(Math.PI/180)}this.filter.addGyroMeasurement(this.gyroscope,r)}this.filter.addAccelMeasurement(this.accelerometer,r);this.previousTimestampS=r};ye.prototype.onOrientationChange_=function(e){this.setScreenTransform_()};ye.prototype.onMessage_=function(e){var t=e.data;if(!t||!t.type){return}var n=t.type.toLowerCase();if(n!=="devicemotion"){return}this.updateDeviceMotion_(t.deviceMotionEvent)};ye.prototype.setScreenTransform_=function(){this.worldToScreenQ.set(0,0,0,1);switch(window.orientation){case 0:break;case 90:this.worldToScreenQ.setFromAxisAngle(new te(0,0,1),-Math.PI/2);break;case-90:this.worldToScreenQ.setFromAxisAngle(new te(0,0,1),Math.PI/2);break;case 180:break}this.inverseWorldToScreenQ.copy(this.worldToScreenQ);this.inverseWorldToScreenQ.inverse()};ye.prototype.start=function(){this.onDeviceMotionCallback_=this.onDeviceMotion_.bind(this);this.onOrientationChangeCallback_=this.onOrientationChange_.bind(this);this.onMessageCallback_=this.onMessage_.bind(this);this.onDeviceOrientationCallback_=this.onDeviceOrientation_.bind(this);if(f()&&R()){window.addEventListener("message",this.onMessageCallback_)}window.addEventListener("orientationchange",this.onOrientationChangeCallback_);if(this.isWithoutDeviceMotion){window.addEventListener("deviceorientation",this.onDeviceOrientationCallback_)}else{window.addEventListener("devicemotion",this.onDeviceMotionCallback_)}};ye.prototype.stop=function(){window.removeEventListener("devicemotion",this.onDeviceMotionCallback_);window.removeEventListener("deviceorientation",this.onDeviceOrientationCallback_);window.removeEventListener("orientationchange",this.onOrientationChangeCallback_);window.removeEventListener("message",this.onMessageCallback_)};var _e=60;var be=new te(1,0,0);var Ee=new te(0,0,1);var Te=new ne;Te.setFromAxisAngle(be,-Math.PI/2);Te.multiply((new ne).setFromAxisAngle(Ee,Math.PI/2));var Ae=function(){function t(e){n(this,t);this.config=e;this.sensor=null;this.fusionSensor=null;this._out=new Float32Array(4);this.api=null;this.errors=[];this._sensorQ=new ne;this._outQ=new ne;this._onSensorRead=this._onSensorRead.bind(this);this._onSensorError=this._onSensorError.bind(this);this.init()}e(t,[{key:"init",value:function e(){var t=null;try{t=new RelativeOrientationSensor({frequency:_e,referenceFrame:"screen"});t.addEventListener("error",this._onSensorError)}catch(e){this.errors.push(e);if(e.name==="SecurityError"){console.error("Cannot construct sensors due to the Feature Policy");console.warn('Attempting to fall back using "devicemotion"; however this will '+"fail in the future without correct permissions.");this.useDeviceMotion()}else if(e.name==="ReferenceError"){this.useDeviceMotion()}else{console.error(e)}}if(t){this.api="sensor";this.sensor=t;this.sensor.addEventListener("reading",this._onSensorRead);this.sensor.start()}}},{key:"useDeviceMotion",value:function e(){this.api="devicemotion";this.fusionSensor=new ye(this.config.K_FILTER,this.config.PREDICTION_TIME_S,this.config.YAW_ONLY,this.config.DEBUG);if(this.sensor){this.sensor.removeEventListener("reading",this._onSensorRead);this.sensor.removeEventListener("error",this._onSensorError);this.sensor=null}}},{key:"getOrientation",value:function e(){if(this.fusionSensor){return this.fusionSensor.getOrientation()}if(!this.sensor||!this.sensor.quaternion){this._out[0]=this._out[1]=this._out[2]=0;this._out[3]=1;return this._out}var t=this.sensor.quaternion;this._sensorQ.set(t[0],t[1],t[2],t[3]);var n=this._outQ;n.copy(Te);n.multiply(this._sensorQ);if(this.config.YAW_ONLY){n.x=n.z=0;n.normalize()}this._out[0]=n.x;this._out[1]=n.y;this._out[2]=n.z;this._out[3]=n.w;return this._out}},{key:"_onSensorError",value:function e(t){this.errors.push(t.error);if(t.error.name==="NotAllowedError"){console.error("Permission to access sensor was denied")}else if(t.error.name==="NotReadableError"){console.error("Sensor could not be read")}else{console.error(t.error)}this.useDeviceMotion()}},{key:"_onSensorRead",value:function e(){}}]);return t}();var we="<svg width='198' height='240' viewBox='0 0 198 240' xmlns='http://www.w3.org/2000/svg'><g fill='none' fill-rule='evenodd'><path d='M149.625 109.527l6.737 3.891v.886c0 .177.013.36.038.549.01.081.02.162.027.242.14 1.415.974 2.998 2.105 3.999l5.72 5.062.081-.09s4.382-2.53 5.235-3.024l25.97 14.993v54.001c0 .771-.386 1.217-.948 1.217-.233 0-.495-.076-.772-.236l-23.967-13.838-.014.024-27.322 15.775-.85-1.323c-4.731-1.529-9.748-2.74-14.951-3.61a.27.27 0 0 0-.007.024l-5.067 16.961-7.891 4.556-.037-.063v27.59c0 .772-.386 1.217-.948 1.217-.232 0-.495-.076-.772-.236l-42.473-24.522c-.95-.549-1.72-1.877-1.72-2.967v-1.035l-.021.047a5.111 5.111 0 0 0-1.816-.399 5.682 5.682 0 0 0-.546.001 13.724 13.724 0 0 1-1.918-.041c-1.655-.153-3.2-.6-4.404-1.296l-46.576-26.89.005.012-10.278-18.75c-1.001-1.827-.241-4.216 1.698-5.336l56.011-32.345a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.659 3.227 1.853l.005-.003.227.413-.006.004a9.63 9.63 0 0 0 1.477 2.018l.277.27c1.914 1.85 4.468 2.801 7.113 2.801 1.949 0 3.948-.517 5.775-1.572.013 0 7.319-4.219 7.319-4.219a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.658 3.226 1.853l3.25 5.928.022-.018 6.785 3.917-.105-.182 46.881-26.965m0-1.635c-.282 0-.563.073-.815.218l-46.169 26.556-5.41-3.124-3.005-5.481c-.913-1.667-2.699-2.702-4.66-2.703-1.011 0-2.02.274-2.917.792a3825 3825 0 0 1-7.275 4.195l-.044.024a9.937 9.937 0 0 1-4.957 1.353c-2.292 0-4.414-.832-5.976-2.342l-.252-.245a7.992 7.992 0 0 1-1.139-1.534 1.379 1.379 0 0 0-.06-.122l-.227-.414a1.718 1.718 0 0 0-.095-.154c-.938-1.574-2.673-2.545-4.571-2.545-1.011 0-2.02.274-2.917.792L3.125 155.502c-2.699 1.559-3.738 4.94-2.314 7.538l10.278 18.75c.177.323.448.563.761.704l46.426 26.804c1.403.81 3.157 1.332 5.072 1.508a15.661 15.661 0 0 0 2.146.046 4.766 4.766 0 0 1 .396 0c.096.004.19.011.283.022.109 1.593 1.159 3.323 2.529 4.114l42.472 24.522c.524.302 1.058.455 1.59.455 1.497 0 2.583-1.2 2.583-2.852v-26.562l7.111-4.105a1.64 1.64 0 0 0 .749-.948l4.658-15.593c4.414.797 8.692 1.848 12.742 3.128l.533.829a1.634 1.634 0 0 0 2.193.531l26.532-15.317L193 192.433c.523.302 1.058.455 1.59.455 1.497 0 2.583-1.199 2.583-2.852v-54.001c0-.584-.312-1.124-.818-1.416l-25.97-14.993a1.633 1.633 0 0 0-1.636.001c-.606.351-2.993 1.73-4.325 2.498l-4.809-4.255c-.819-.725-1.461-1.933-1.561-2.936a7.776 7.776 0 0 0-.033-.294 2.487 2.487 0 0 1-.023-.336v-.886c0-.584-.312-1.123-.817-1.416l-6.739-3.891a1.633 1.633 0 0 0-.817-.219' fill='#455A64'/><path d='M96.027 132.636l46.576 26.891c1.204.695 1.979 1.587 2.242 2.541l-.01.007-81.374 46.982h-.001c-1.654-.152-3.199-.6-4.403-1.295l-46.576-26.891 83.546-48.235' fill='#FAFAFA'/><path d='M63.461 209.174c-.008 0-.015 0-.022-.002-1.693-.156-3.228-.609-4.441-1.309l-46.576-26.89a.118.118 0 0 1 0-.203l83.546-48.235a.117.117 0 0 1 .117 0l46.576 26.891c1.227.708 2.021 1.612 2.296 2.611a.116.116 0 0 1-.042.124l-.021.016-81.375 46.981a.11.11 0 0 1-.058.016zm-50.747-28.303l46.401 26.79c1.178.68 2.671 1.121 4.32 1.276l81.272-46.922c-.279-.907-1.025-1.73-2.163-2.387l-46.517-26.857-83.313 48.1z' fill='#607D8B'/><path d='M148.327 165.471a5.85 5.85 0 0 1-.546.001c-1.894-.083-3.302-1.038-3.145-2.132a2.693 2.693 0 0 0-.072-1.105l-81.103 46.822c.628.058 1.272.073 1.918.042.182-.009.364-.009.546-.001 1.894.083 3.302 1.038 3.145 2.132l79.257-45.759' fill='#FFF'/><path d='M69.07 211.347a.118.118 0 0 1-.115-.134c.045-.317-.057-.637-.297-.925-.505-.61-1.555-1.022-2.738-1.074a5.966 5.966 0 0 0-.535.001 14.03 14.03 0 0 1-1.935-.041.117.117 0 0 1-.103-.092.116.116 0 0 1 .055-.126l81.104-46.822a.117.117 0 0 1 .171.07c.104.381.129.768.074 1.153-.045.316.057.637.296.925.506.61 1.555 1.021 2.739 1.073.178.008.357.008.535-.001a.117.117 0 0 1 .064.218l-79.256 45.759a.114.114 0 0 1-.059.016zm-3.405-2.372c.089 0 .177.002.265.006 1.266.056 2.353.488 2.908 1.158.227.274.35.575.36.882l78.685-45.429c-.036 0-.072-.001-.107-.003-1.267-.056-2.354-.489-2.909-1.158-.282-.34-.402-.724-.347-1.107a2.604 2.604 0 0 0-.032-.91L63.846 208.97a13.91 13.91 0 0 0 1.528.012c.097-.005.194-.007.291-.007z' fill='#607D8B'/><path d='M2.208 162.134c-1.001-1.827-.241-4.217 1.698-5.337l56.011-32.344c1.939-1.12 4.324-.546 5.326 1.281l.232.41a9.344 9.344 0 0 0 1.47 2.021l.278.27c3.325 3.214 8.583 3.716 12.888 1.23l7.319-4.22c1.94-1.119 4.324-.546 5.325 1.282l3.25 5.928-83.519 48.229-10.278-18.75z' fill='#FAFAFA'/><path d='M12.486 181.001a.112.112 0 0 1-.031-.005.114.114 0 0 1-.071-.056L2.106 162.19c-1.031-1.88-.249-4.345 1.742-5.494l56.01-32.344a4.328 4.328 0 0 1 2.158-.588c1.415 0 2.65.702 3.311 1.882.01.008.018.017.024.028l.227.414a.122.122 0 0 1 .013.038 9.508 9.508 0 0 0 1.439 1.959l.275.266c1.846 1.786 4.344 2.769 7.031 2.769 1.977 0 3.954-.538 5.717-1.557a.148.148 0 0 1 .035-.013l7.284-4.206a4.321 4.321 0 0 1 2.157-.588c1.427 0 2.672.716 3.329 1.914l3.249 5.929a.116.116 0 0 1-.044.157l-83.518 48.229a.116.116 0 0 1-.059.016zm49.53-57.004c-.704 0-1.41.193-2.041.557l-56.01 32.345c-1.882 1.086-2.624 3.409-1.655 5.179l10.221 18.645 83.317-48.112-3.195-5.829c-.615-1.122-1.783-1.792-3.124-1.792a4.08 4.08 0 0 0-2.04.557l-7.317 4.225a.148.148 0 0 1-.035.013 11.7 11.7 0 0 1-5.801 1.569c-2.748 0-5.303-1.007-7.194-2.835l-.278-.27a9.716 9.716 0 0 1-1.497-2.046.096.096 0 0 1-.013-.037l-.191-.347a.11.11 0 0 1-.023-.029c-.615-1.123-1.783-1.793-3.124-1.793z' fill='#607D8B'/><path d='M42.434 155.808c-2.51-.001-4.697-1.258-5.852-3.365-1.811-3.304-.438-7.634 3.059-9.654l12.291-7.098a7.599 7.599 0 0 1 3.789-1.033c2.51 0 4.697 1.258 5.852 3.365 1.811 3.304.439 7.634-3.059 9.654l-12.291 7.098a7.606 7.606 0 0 1-3.789 1.033zm13.287-20.683a7.128 7.128 0 0 0-3.555.971l-12.291 7.098c-3.279 1.893-4.573 5.942-2.883 9.024 1.071 1.955 3.106 3.122 5.442 3.122a7.13 7.13 0 0 0 3.556-.97l12.291-7.098c3.279-1.893 4.572-5.942 2.883-9.024-1.072-1.955-3.106-3.123-5.443-3.123z' fill='#607D8B'/><path d='M149.588 109.407l6.737 3.89v.887c0 .176.013.36.037.549.011.081.02.161.028.242.14 1.415.973 2.998 2.105 3.999l7.396 6.545c.177.156.358.295.541.415 1.579 1.04 2.95.466 3.062-1.282.049-.784.057-1.595.023-2.429l-.003-.16v-1.151l25.987 15.003v54c0 1.09-.77 1.53-1.72.982l-42.473-24.523c-.95-.548-1.72-1.877-1.72-2.966v-34.033' fill='#FAFAFA'/><path d='M194.553 191.25c-.257 0-.54-.085-.831-.253l-42.472-24.521c-.981-.567-1.779-1.943-1.779-3.068v-34.033h.234v34.033c0 1.051.745 2.336 1.661 2.866l42.473 24.521c.424.245.816.288 1.103.122.285-.164.442-.52.442-1.002v-53.933l-25.753-14.868.003 1.106c.034.832.026 1.654-.024 2.439-.054.844-.396 1.464-.963 1.746-.619.309-1.45.173-2.28-.373a5.023 5.023 0 0 1-.553-.426l-7.397-6.544c-1.158-1.026-1.999-2.625-2.143-4.076a9.624 9.624 0 0 0-.027-.238 4.241 4.241 0 0 1-.038-.564v-.82l-6.68-3.856.117-.202 6.738 3.89.058.034v.954c0 .171.012.351.036.533.011.083.021.165.029.246.138 1.395.948 2.935 2.065 3.923l7.397 6.545c.173.153.35.289.527.406.758.499 1.504.63 2.047.359.49-.243.786-.795.834-1.551.05-.778.057-1.591.024-2.417l-.004-.163v-1.355l.175.1 25.987 15.004.059.033v54.068c0 .569-.198.996-.559 1.204a1.002 1.002 0 0 1-.506.131' fill='#607D8B'/><path d='M145.685 163.161l24.115 13.922-25.978 14.998-1.462-.307c-6.534-2.17-13.628-3.728-21.019-4.616-4.365-.524-8.663 1.096-9.598 3.62a2.746 2.746 0 0 0-.011 1.928c1.538 4.267 4.236 8.363 7.995 12.135l.532.845-25.977 14.997-24.115-13.922 75.518-43.6' fill='#FFF'/><path d='M94.282 220.818l-.059-.033-24.29-14.024.175-.101 75.577-43.634.058.033 24.29 14.024-26.191 15.122-.045-.01-1.461-.307c-6.549-2.174-13.613-3.725-21.009-4.614a13.744 13.744 0 0 0-1.638-.097c-3.758 0-7.054 1.531-7.837 3.642a2.62 2.62 0 0 0-.01 1.848c1.535 4.258 4.216 8.326 7.968 12.091l.016.021.526.835.006.01.064.102-.105.061-25.977 14.998-.058.033zm-23.881-14.057l23.881 13.788 24.802-14.32c.546-.315.846-.489 1.017-.575l-.466-.74c-3.771-3.787-6.467-7.881-8.013-12.168a2.851 2.851 0 0 1 .011-2.008c.815-2.199 4.203-3.795 8.056-3.795.557 0 1.117.033 1.666.099 7.412.891 14.491 2.445 21.041 4.621.836.175 1.215.254 1.39.304l25.78-14.884-23.881-13.788-75.284 43.466z' fill='#607D8B'/><path d='M167.23 125.979v50.871l-27.321 15.773-6.461-14.167c-.91-1.996-3.428-1.738-5.624.574a10.238 10.238 0 0 0-2.33 4.018l-6.46 21.628-27.322 15.774v-50.871l75.518-43.6' fill='#FFF'/><path d='M91.712 220.567a.127.127 0 0 1-.059-.016.118.118 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.519-43.6a.117.117 0 0 1 .175.101v50.871c0 .041-.023.08-.059.1l-27.321 15.775a.118.118 0 0 1-.094.01.12.12 0 0 1-.071-.063l-6.46-14.168c-.375-.822-1.062-1.275-1.934-1.275-1.089 0-2.364.686-3.5 1.881a10.206 10.206 0 0 0-2.302 3.972l-6.46 21.627a.118.118 0 0 1-.054.068L91.77 220.551a.12.12 0 0 1-.058.016zm.117-50.92v50.601l27.106-15.65 6.447-21.583a10.286 10.286 0 0 1 2.357-4.065c1.18-1.242 2.517-1.954 3.669-1.954.969 0 1.731.501 2.146 1.411l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill='#607D8B'/><path d='M168.543 126.213v50.87l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.624.574a10.248 10.248 0 0 0-2.33 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6' fill='#FFF'/><path d='M93.025 220.8a.123.123 0 0 1-.059-.015.12.12 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.518-43.6a.112.112 0 0 1 .117 0c.036.02.059.059.059.1v50.871a.116.116 0 0 1-.059.101l-27.321 15.774a.111.111 0 0 1-.094.01.115.115 0 0 1-.071-.062l-6.46-14.168c-.375-.823-1.062-1.275-1.935-1.275-1.088 0-2.363.685-3.499 1.881a10.19 10.19 0 0 0-2.302 3.971l-6.461 21.628a.108.108 0 0 1-.053.067l-27.322 15.775a.12.12 0 0 1-.058.015zm.117-50.919v50.6l27.106-15.649 6.447-21.584a10.293 10.293 0 0 1 2.357-4.065c1.179-1.241 2.516-1.954 3.668-1.954.969 0 1.732.502 2.147 1.412l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill='#607D8B'/><path d='M169.8 177.083l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.625.574a10.246 10.246 0 0 0-2.329 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6v50.87z' fill='#FAFAFA'/><path d='M94.282 220.917a.234.234 0 0 1-.234-.233v-50.871c0-.083.045-.161.117-.202l75.518-43.601a.234.234 0 1 1 .35.202v50.871a.233.233 0 0 1-.116.202l-27.322 15.775a.232.232 0 0 1-.329-.106l-6.461-14.168c-.36-.789-.992-1.206-1.828-1.206-1.056 0-2.301.672-3.415 1.844a10.099 10.099 0 0 0-2.275 3.924l-6.46 21.628a.235.235 0 0 1-.107.136l-27.322 15.774a.23.23 0 0 1-.116.031zm.233-50.969v50.331l26.891-15.525 6.434-21.539a10.41 10.41 0 0 1 2.384-4.112c1.201-1.265 2.569-1.991 3.753-1.991 1.018 0 1.818.526 2.253 1.48l6.354 13.934 26.982-15.578v-50.331l-75.051 43.331z' fill='#607D8B'/><path d='M109.894 199.943c-1.774 0-3.241-.725-4.244-2.12a.224.224 0 0 1 .023-.294.233.233 0 0 1 .301-.023c.78.547 1.705.827 2.75.827 1.323 0 2.754-.439 4.256-1.306 5.311-3.067 9.631-10.518 9.631-16.611 0-1.927-.442-3.56-1.278-4.724a.232.232 0 0 1 .323-.327c1.671 1.172 2.591 3.381 2.591 6.219 0 6.242-4.426 13.863-9.865 17.003-1.574.908-3.084 1.356-4.488 1.356zm-2.969-1.542c.813.651 1.82.877 2.968.877h.001c1.321 0 2.753-.327 4.254-1.194 5.311-3.067 9.632-10.463 9.632-16.556 0-1.979-.463-3.599-1.326-4.761.411 1.035.625 2.275.625 3.635 0 6.243-4.426 13.883-9.865 17.023-1.574.909-3.084 1.317-4.49 1.317-.641 0-1.243-.149-1.799-.341z' fill='#607D8B'/><path d='M113.097 197.23c5.384-3.108 9.748-10.636 9.748-16.814 0-2.051-.483-3.692-1.323-4.86-1.784-1.252-4.374-1.194-7.257.47-5.384 3.108-9.748 10.636-9.748 16.814 0 2.051.483 3.692 1.323 4.86 1.784 1.252 4.374 1.194 7.257-.47' fill='#FAFAFA'/><path d='M108.724 198.614c-1.142 0-2.158-.213-3.019-.817-.021-.014-.04.014-.055-.007-.894-1.244-1.367-2.948-1.367-4.973 0-6.242 4.426-13.864 9.865-17.005 1.574-.908 3.084-1.363 4.49-1.363 1.142 0 2.158.309 3.018.913a.23.23 0 0 1 .056.056c.894 1.244 1.367 2.972 1.367 4.997 0 6.243-4.426 13.783-9.865 16.923-1.574.909-3.084 1.276-4.49 1.276zm-2.718-1.109c.774.532 1.688.776 2.718.776 1.323 0 2.754-.413 4.256-1.28 5.311-3.066 9.631-10.505 9.631-16.598 0-1.909-.434-3.523-1.255-4.685-.774-.533-1.688-.799-2.718-.799-1.323 0-2.755.441-4.256 1.308-5.311 3.066-9.631 10.506-9.631 16.599 0 1.909.434 3.517 1.255 4.679z' fill='#607D8B'/><path d='M149.318 114.262l-9.984 8.878 15.893 11.031 5.589-6.112-11.498-13.797' fill='#FAFAFA'/><path d='M169.676 120.84l-9.748 5.627c-3.642 2.103-9.528 2.113-13.147.024-3.62-2.089-3.601-5.488.041-7.591l9.495-5.608-6.729-3.885-81.836 47.071 45.923 26.514 3.081-1.779c.631-.365.869-.898.618-1.39-2.357-4.632-2.593-9.546-.683-14.262 5.638-13.92 24.509-24.815 48.618-28.07 8.169-1.103 16.68-.967 24.704.394.852.145 1.776.008 2.407-.357l3.081-1.778-25.825-14.91' fill='#FAFAFA'/><path d='M113.675 183.459a.47.47 0 0 1-.233-.062l-45.924-26.515a.468.468 0 0 1 .001-.809l81.836-47.071a.467.467 0 0 1 .466 0l6.729 3.885a.467.467 0 0 1-.467.809l-6.496-3.75-80.9 46.533 44.988 25.973 2.848-1.644c.192-.111.62-.409.435-.773-2.416-4.748-2.658-9.814-.7-14.65 2.806-6.927 8.885-13.242 17.582-18.263 8.657-4.998 19.518-8.489 31.407-10.094 8.198-1.107 16.79-.97 24.844.397.739.125 1.561.007 2.095-.301l2.381-1.374-25.125-14.506a.467.467 0 0 1 .467-.809l25.825 14.91a.467.467 0 0 1 0 .809l-3.081 1.779c-.721.417-1.763.575-2.718.413-7.963-1.351-16.457-1.486-24.563-.392-11.77 1.589-22.512 5.039-31.065 9.977-8.514 4.916-14.456 11.073-17.183 17.805-1.854 4.578-1.623 9.376.666 13.875.37.725.055 1.513-.8 2.006l-3.081 1.78a.476.476 0 0 1-.234.062' fill='#455A64'/><path d='M153.316 128.279c-2.413 0-4.821-.528-6.652-1.586-1.818-1.049-2.82-2.461-2.82-3.975 0-1.527 1.016-2.955 2.861-4.02l9.493-5.607a.233.233 0 1 1 .238.402l-9.496 5.609c-1.696.979-2.628 2.263-2.628 3.616 0 1.34.918 2.608 2.585 3.571 3.549 2.049 9.343 2.038 12.914-.024l9.748-5.628a.234.234 0 0 1 .234.405l-9.748 5.628c-1.858 1.072-4.296 1.609-6.729 1.609' fill='#607D8B'/><path d='M113.675 182.992l-45.913-26.508M113.675 183.342a.346.346 0 0 1-.175-.047l-45.913-26.508a.35.35 0 1 1 .35-.607l45.913 26.508a.35.35 0 0 1-.175.654' fill='#455A64'/><path d='M67.762 156.484v54.001c0 1.09.77 2.418 1.72 2.967l42.473 24.521c.95.549 1.72.11 1.72-.98v-54.001' fill='#FAFAFA'/><path d='M112.727 238.561c-.297 0-.62-.095-.947-.285l-42.473-24.521c-1.063-.613-1.895-2.05-1.895-3.27v-54.001a.35.35 0 1 1 .701 0v54.001c0 .96.707 2.18 1.544 2.663l42.473 24.522c.344.198.661.243.87.122.206-.119.325-.411.325-.799v-54.001a.35.35 0 1 1 .7 0v54.001c0 .655-.239 1.154-.675 1.406a1.235 1.235 0 0 1-.623.162' fill='#455A64'/><path d='M112.86 147.512h-.001c-2.318 0-4.499-.522-6.142-1.471-1.705-.984-2.643-2.315-2.643-3.749 0-1.445.952-2.791 2.68-3.788l12.041-6.953c1.668-.962 3.874-1.493 6.212-1.493 2.318 0 4.499.523 6.143 1.472 1.704.984 2.643 2.315 2.643 3.748 0 1.446-.952 2.791-2.68 3.789l-12.042 6.952c-1.668.963-3.874 1.493-6.211 1.493zm12.147-16.753c-2.217 0-4.298.497-5.861 1.399l-12.042 6.952c-1.502.868-2.33 1.998-2.33 3.182 0 1.173.815 2.289 2.293 3.142 1.538.889 3.596 1.378 5.792 1.378h.001c2.216 0 4.298-.497 5.861-1.399l12.041-6.953c1.502-.867 2.33-1.997 2.33-3.182 0-1.172-.814-2.288-2.292-3.142-1.539-.888-3.596-1.377-5.793-1.377z' fill='#607D8B'/><path d='M165.63 123.219l-5.734 3.311c-3.167 1.828-8.286 1.837-11.433.02-3.147-1.817-3.131-4.772.036-6.601l5.734-3.31 11.397 6.58' fill='#FAFAFA'/><path d='M154.233 117.448l9.995 5.771-4.682 2.704c-1.434.827-3.352 1.283-5.399 1.283-2.029 0-3.923-.449-5.333-1.263-1.29-.744-2-1.694-2-2.674 0-.991.723-1.955 2.036-2.713l5.383-3.108m0-.809l-5.734 3.31c-3.167 1.829-3.183 4.784-.036 6.601 1.568.905 3.623 1.357 5.684 1.357 2.077 0 4.159-.46 5.749-1.377l5.734-3.311-11.397-6.58M145.445 179.667c-1.773 0-3.241-.85-4.243-2.245-.067-.092-.057-.275.023-.356.08-.081.207-.12.3-.055.781.548 1.706.812 2.751.811 1.322 0 2.754-.446 4.256-1.313 5.31-3.066 9.631-10.522 9.631-16.615 0-1.927-.442-3.562-1.279-4.726a.235.235 0 0 1 .024-.301.232.232 0 0 1 .3-.027c1.67 1.172 2.59 3.38 2.59 6.219 0 6.242-4.425 13.987-9.865 17.127-1.573.908-3.083 1.481-4.488 1.481zM142.476 178c.814.651 1.82 1.002 2.969 1.002 1.322 0 2.753-.452 4.255-1.32 5.31-3.065 9.631-10.523 9.631-16.617 0-1.98-.463-3.63-1.325-4.793.411 1.035.624 2.26.624 3.62 0 6.242-4.425 13.875-9.865 17.015-1.573.909-3.084 1.376-4.489 1.376a5.49 5.49 0 0 1-1.8-.283z' fill='#607D8B'/><path d='M148.648 176.704c5.384-3.108 9.748-10.636 9.748-16.813 0-2.052-.483-3.693-1.322-4.861-1.785-1.252-4.375-1.194-7.258.471-5.383 3.108-9.748 10.636-9.748 16.813 0 2.051.484 3.692 1.323 4.86 1.785 1.253 4.374 1.195 7.257-.47' fill='#FAFAFA'/><path d='M144.276 178.276c-1.143 0-2.158-.307-3.019-.911a.217.217 0 0 1-.055-.054c-.895-1.244-1.367-2.972-1.367-4.997 0-6.241 4.425-13.875 9.865-17.016 1.573-.908 3.084-1.369 4.489-1.369 1.143 0 2.158.307 3.019.91a.24.24 0 0 1 .055.055c.894 1.244 1.367 2.971 1.367 4.997 0 6.241-4.425 13.875-9.865 17.016-1.573.908-3.084 1.369-4.489 1.369zm-2.718-1.172c.773.533 1.687.901 2.718.901 1.322 0 2.754-.538 4.256-1.405 5.31-3.066 9.631-10.567 9.631-16.661 0-1.908-.434-3.554-1.256-4.716-.774-.532-1.688-.814-2.718-.814-1.322 0-2.754.433-4.256 1.3-5.31 3.066-9.631 10.564-9.631 16.657 0 1.91.434 3.576 1.256 4.738z' fill='#607D8B'/><path d='M150.72 172.361l-.363-.295a24.105 24.105 0 0 0 2.148-3.128 24.05 24.05 0 0 0 1.977-4.375l.443.149a24.54 24.54 0 0 1-2.015 4.46 24.61 24.61 0 0 1-2.19 3.189M115.917 191.514l-.363-.294a24.174 24.174 0 0 0 2.148-3.128 24.038 24.038 0 0 0 1.976-4.375l.443.148a24.48 24.48 0 0 1-2.015 4.461 24.662 24.662 0 0 1-2.189 3.188M114 237.476V182.584 237.476' fill='#607D8B'/><g><path d='M81.822 37.474c.017-.135-.075-.28-.267-.392-.327-.188-.826-.21-1.109-.045l-6.012 3.471c-.131.076-.194.178-.191.285.002.132.002.461.002.578v.043l-.007.128-6.591 3.779c-.001 0-2.077 1.046-2.787 5.192 0 0-.912 6.961-.898 19.745.015 12.57.606 17.07 1.167 21.351.22 1.684 3.001 2.125 3.001 2.125.331.04.698-.027 1.08-.248l75.273-43.551c1.808-1.069 2.667-3.719 3.056-6.284 1.213-7.99 1.675-32.978-.275-39.878-.196-.693-.51-1.083-.868-1.282l-2.086-.79c-.727.028-1.416.467-1.534.535L82.032 37.072l-.21.402' fill='#FFF'/><path d='M144.311 1.701l2.085.79c.358.199.672.589.868 1.282 1.949 6.9 1.487 31.887.275 39.878-.39 2.565-1.249 5.215-3.056 6.284L69.21 93.486a1.78 1.78 0 0 1-.896.258l-.183-.011c0 .001-2.782-.44-3.003-2.124-.56-4.282-1.151-8.781-1.165-21.351-.015-12.784.897-19.745.897-19.745.71-4.146 2.787-5.192 2.787-5.192l6.591-3.779.007-.128v-.043c0-.117 0-.446-.002-.578-.003-.107.059-.21.191-.285l6.012-3.472a.98.98 0 0 1 .481-.11c.218 0 .449.053.627.156.193.112.285.258.268.392l.211-.402 60.744-34.836c.117-.068.806-.507 1.534-.535m0-.997l-.039.001c-.618.023-1.283.244-1.974.656l-.021.012-60.519 34.706a2.358 2.358 0 0 0-.831-.15c-.365 0-.704.084-.98.244l-6.012 3.471c-.442.255-.699.69-.689 1.166l.001.15-6.08 3.487c-.373.199-2.542 1.531-3.29 5.898l-.006.039c-.009.07-.92 7.173-.906 19.875.014 12.62.603 17.116 1.172 21.465l.002.015c.308 2.355 3.475 2.923 3.836 2.98l.034.004c.101.013.204.019.305.019a2.77 2.77 0 0 0 1.396-.392l75.273-43.552c1.811-1.071 2.999-3.423 3.542-6.997 1.186-7.814 1.734-33.096-.301-40.299-.253-.893-.704-1.527-1.343-1.882l-.132-.062-2.085-.789a.973.973 0 0 0-.353-.065' fill='#455A64'/><path d='M128.267 11.565l1.495.434-56.339 32.326' fill='#FFF'/><path d='M74.202 90.545a.5.5 0 0 1-.25-.931l18.437-10.645a.499.499 0 1 1 .499.864L74.451 90.478l-.249.067M75.764 42.654l-.108-.062.046-.171 5.135-2.964.17.045-.045.171-5.135 2.964-.063.017M70.52 90.375V46.421l.063-.036L137.84 7.554v43.954l-.062.036L70.52 90.375zm.25-43.811v43.38l66.821-38.579V7.985L70.77 46.564z' fill='#607D8B'/><path d='M86.986 83.182c-.23.149-.612.384-.849.523l-11.505 6.701c-.237.139-.206.252.068.252h.565c.275 0 .693-.113.93-.252L87.7 83.705c.237-.139.428-.253.425-.256a11.29 11.29 0 0 1-.006-.503c0-.274-.188-.377-.418-.227l-.715.463' fill='#607D8B'/><path d='M75.266 90.782H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.236-.138.615-.371.844-.519l.715-.464a.488.488 0 0 1 .266-.089c.172 0 .345.13.345.421 0 .214.001.363.003.437l.006.004-.004.069c-.003.075-.003.075-.486.356l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.108.866-.234l11.505-6.702c.168-.098.294-.173.361-.214-.004-.084-.004-.218-.004-.437l-.095-.171-.131.049-.714.463c-.232.15-.616.386-.854.525l-11.505 6.702-.029.018z' fill='#607D8B'/><path d='M75.266 89.871H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.258-.151.694-.268.993-.268h.565c.2 0 .316.056.346.166.03.11-.043.217-.215.317l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.107.866-.234l11.505-6.702.03-.018-.035-.001h-.565c-.252 0-.649.108-.867.234l-11.505 6.702-.029.018zM74.37 90.801v-1.247 1.247' fill='#607D8B'/><path d='M68.13 93.901c-.751-.093-1.314-.737-1.439-1.376-.831-4.238-1.151-8.782-1.165-21.352-.015-12.784.897-19.745.897-19.745.711-4.146 2.787-5.192 2.787-5.192l74.859-43.219c.223-.129 2.487-1.584 3.195.923 1.95 6.9 1.488 31.887.275 39.878-.389 2.565-1.248 5.215-3.056 6.283L69.21 93.653c-.382.221-.749.288-1.08.248 0 0-2.781-.441-3.001-2.125-.561-4.281-1.152-8.781-1.167-21.351-.014-12.784.898-19.745.898-19.745.71-4.146 2.787-5.191 2.787-5.191l6.598-3.81.871-.119 6.599-3.83.046-.461L68.13 93.901' fill='#FAFAFA'/><path d='M68.317 94.161l-.215-.013h-.001l-.244-.047c-.719-.156-2.772-.736-2.976-2.292-.568-4.34-1.154-8.813-1.168-21.384-.014-12.654.891-19.707.9-19.777.725-4.231 2.832-5.338 2.922-5.382l6.628-3.827.87-.119 6.446-3.742.034-.334a.248.248 0 0 1 .273-.223.248.248 0 0 1 .223.272l-.059.589-6.752 3.919-.87.118-6.556 3.785c-.031.016-1.99 1.068-2.666 5.018-.007.06-.908 7.086-.894 19.702.014 12.539.597 16.996 1.161 21.305.091.691.689 1.154 1.309 1.452a1.95 1.95 0 0 1-.236-.609c-.781-3.984-1.155-8.202-1.17-21.399-.014-12.653.891-19.707.9-19.777.725-4.231 2.832-5.337 2.922-5.382-.004.001 74.444-42.98 74.846-43.212l.028-.017c.904-.538 1.72-.688 2.36-.433.555.221.949.733 1.172 1.52 2.014 7.128 1.46 32.219.281 39.983-.507 3.341-1.575 5.515-3.175 6.462L69.335 93.869a2.023 2.023 0 0 1-1.018.292zm-.147-.507c.293.036.604-.037.915-.217l75.273-43.551c1.823-1.078 2.602-3.915 2.934-6.106 1.174-7.731 1.731-32.695-.268-39.772-.178-.631-.473-1.032-.876-1.192-.484-.193-1.166-.052-1.921.397l-.034.021-74.858 43.218c-.031.017-1.989 1.069-2.666 5.019-.007.059-.908 7.085-.894 19.702.015 13.155.386 17.351 1.161 21.303.09.461.476.983 1.037 1.139.114.025.185.037.196.039h.001z' fill='#455A64'/><path d='M69.317 68.982c.489-.281.885-.056.885.505 0 .56-.396 1.243-.885 1.525-.488.282-.884.057-.884-.504 0-.56.396-1.243.884-1.526' fill='#FFF'/><path d='M68.92 71.133c-.289 0-.487-.228-.487-.625 0-.56.396-1.243.884-1.526a.812.812 0 0 1 .397-.121c.289 0 .488.229.488.626 0 .56-.396 1.243-.885 1.525a.812.812 0 0 1-.397.121m.794-2.459a.976.976 0 0 0-.49.147c-.548.317-.978 1.058-.978 1.687 0 .486.271.812.674.812a.985.985 0 0 0 .491-.146c.548-.317.978-1.057.978-1.687 0-.486-.272-.813-.675-.813' fill='#8097A2'/><path d='M68.92 70.947c-.271 0-.299-.307-.299-.439 0-.491.361-1.116.79-1.363a.632.632 0 0 1 .303-.096c.272 0 .301.306.301.438 0 .491-.363 1.116-.791 1.364a.629.629 0 0 1-.304.096m.794-2.086a.812.812 0 0 0-.397.121c-.488.283-.884.966-.884 1.526 0 .397.198.625.487.625a.812.812 0 0 0 .397-.121c.489-.282.885-.965.885-1.525 0-.397-.199-.626-.488-.626' fill='#8097A2'/><path d='M69.444 85.35c.264-.152.477-.031.477.272 0 .303-.213.67-.477.822-.263.153-.477.031-.477-.271 0-.302.214-.671.477-.823' fill='#FFF'/><path d='M69.23 86.51c-.156 0-.263-.123-.263-.337 0-.302.214-.671.477-.823a.431.431 0 0 1 .214-.066c.156 0 .263.124.263.338 0 .303-.213.67-.477.822a.431.431 0 0 1-.214.066m.428-1.412c-.1 0-.203.029-.307.09-.32.185-.57.618-.57.985 0 .309.185.524.449.524a.63.63 0 0 0 .308-.09c.32-.185.57-.618.57-.985 0-.309-.185-.524-.45-.524' fill='#8097A2'/><path d='M69.23 86.322l-.076-.149c0-.235.179-.544.384-.661l.12-.041.076.151c0 .234-.179.542-.383.66l-.121.04m.428-1.038a.431.431 0 0 0-.214.066c-.263.152-.477.521-.477.823 0 .214.107.337.263.337a.431.431 0 0 0 .214-.066c.264-.152.477-.519.477-.822 0-.214-.107-.338-.263-.338' fill='#8097A2'/><path d='M139.278 7.769v43.667L72.208 90.16V46.493l67.07-38.724' fill='#455A64'/><path d='M72.083 90.375V46.421l.063-.036 67.257-38.831v43.954l-.062.036-67.258 38.831zm.25-43.811v43.38l66.821-38.579V7.985L72.333 46.564z' fill='#607D8B'/></g><path d='M125.737 88.647l-7.639 3.334V84l-11.459 4.713v8.269L99 100.315l13.369 3.646 13.368-15.314' fill='#455A64'/></g></svg>";function Se(){this.loadIcon_();var e=document.createElement("div");var t=e.style;t.position="fixed";t.top=0;t.right=0;t.bottom=0;t.left=0;t.backgroundColor="gray";t.fontFamily="sans-serif";t.zIndex=1e6;var n=document.createElement("img");n.src=this.icon;var t=n.style;t.marginLeft="25%";t.marginTop="25%";t.width="50%";e.appendChild(n);var r=document.createElement("div");var t=r.style;t.textAlign="center";t.fontSize="16px";t.lineHeight="24px";t.margin="24px 25%";t.width="50%";r.innerHTML="Place your phone into your Cardboard viewer.";e.appendChild(r);var i=document.createElement("div");var t=i.style;t.backgroundColor="#CFD8DC";t.position="fixed";t.bottom=0;t.width="100%";t.height="48px";t.padding="14px 24px";t.boxSizing="border-box";t.color="#656A6B";e.appendChild(i);var a=document.createElement("div");a.style.float="left";a.innerHTML="No Cardboard viewer?";var o=document.createElement("a");o.href="https://www.google.com/get/cardboard/get-cardboard/";o.innerHTML="get one";o.target="_blank";var t=o.style;t.float="right";t.fontWeight=600;t.textTransform="uppercase";t.borderLeft="1px solid gray";t.paddingLeft="24px";t.textDecoration="none";t.color="#656A6B";i.appendChild(a);i.appendChild(o);this.overlay=e;this.text=r;this.hide()}Se.prototype.show=function(e){if(!e&&!this.overlay.parentElement){document.body.appendChild(this.overlay)}else if(e){if(this.overlay.parentElement&&this.overlay.parentElement!=e)this.overlay.parentElement.removeChild(this.overlay);e.appendChild(this.overlay)}this.overlay.style.display="block";var t=this.overlay.querySelector("img");var n=t.style;if(m()){n.width="20%";n.marginLeft="40%";n.marginTop="3%"}else{n.width="50%";n.marginLeft="25%";n.marginTop="25%"}};Se.prototype.hide=function(){this.overlay.style.display="none"};Se.prototype.showTemporarily=function(e,t){this.show(t);this.timer=setTimeout(this.hide.bind(this),e)};Se.prototype.disableShowTemporarily=function(){clearTimeout(this.timer)};Se.prototype.update=function(){this.disableShowTemporarily();if(!m()&&S()){this.show()}else{this.hide()}};Se.prototype.loadIcon_=function(){this.icon=t("image/svg+xml",we)};var Ce="CardboardV1";var xe="WEBVR_CARDBOARD_VIEWER";var Me="webvr-polyfill-viewer-selector";function Re(e){try{this.selectedKey=localStorage.getItem(xe)}catch(e){console.error("Failed to load viewer profile: %s",e)}if(!this.selectedKey){this.selectedKey=e||Ce}this.dialog=this.createDialog_(se.Viewers);this.root=null;this.onChangeCallbacks_=[]}Re.prototype.show=function(e){this.root=e;e.appendChild(this.dialog);var t=this.dialog.querySelector("#"+this.selectedKey);t.checked=true;this.dialog.style.display="block"};Re.prototype.hide=function(){if(this.root&&this.root.contains(this.dialog)){this.root.removeChild(this.dialog)}this.dialog.style.display="none"};Re.prototype.getCurrentViewer=function(){return se.Viewers[this.selectedKey]};Re.prototype.getSelectedKey_=function(){var e=this.dialog.querySelector("input[name=field]:checked");if(e){return e.id}return null};Re.prototype.onChange=function(e){this.onChangeCallbacks_.push(e)};Re.prototype.fireOnChange_=function(e){for(var t=0;t<this.onChangeCallbacks_.length;t++){this.onChangeCallbacks_[t](e)}};Re.prototype.onSave_=function(){this.selectedKey=this.getSelectedKey_();if(!this.selectedKey||!se.Viewers[this.selectedKey]){console.error("ViewerSelector.onSave_: this should never happen!");return}this.fireOnChange_(se.Viewers[this.selectedKey]);try{localStorage.setItem(xe,this.selectedKey)}catch(e){console.error("Failed to save viewer profile: %s",e)}this.hide()};Re.prototype.createDialog_=function(e){var t=document.createElement("div");t.classList.add(Me);t.style.display="none";var n=document.createElement("div");var r=n.style;r.position="fixed";r.left=0;r.top=0;r.width="100%";r.height="100%";r.background="rgba(0, 0, 0, 0.3)";n.addEventListener("click",this.hide.bind(this));var i=280;var a=document.createElement("div");var r=a.style;r.boxSizing="border-box";r.position="fixed";r.top="24px";r.left="50%";r.marginLeft=-i/2+"px";r.width=i+"px";r.padding="24px";r.overflow="hidden";r.background="#fafafa";r.fontFamily="'Roboto', sans-serif";r.boxShadow="0px 5px 20px #666";a.appendChild(this.createH1_("Select your viewer"));for(var o in e){a.appendChild(this.createChoice_(o,e[o].label))}a.appendChild(this.createButton_("Save",this.onSave_.bind(this)));t.appendChild(n);t.appendChild(a);return t};Re.prototype.createH1_=function(e){var t=document.createElement("h1");var n=t.style;n.color="black";n.fontSize="20px";n.fontWeight="bold";n.marginTop=0;n.marginBottom="24px";t.innerHTML=e;return t};Re.prototype.createChoice_=function(e,t){var n=document.createElement("div");n.style.marginTop="8px";n.style.color="black";var r=document.createElement("input");r.style.fontSize="30px";r.setAttribute("id",e);r.setAttribute("type","radio");r.setAttribute("value",e);r.setAttribute("name","field");var i=document.createElement("label");i.style.marginLeft="4px";i.setAttribute("for",e);i.innerHTML=t;n.appendChild(r);n.appendChild(i);return n};Re.prototype.createButton_=function(e,t){var n=document.createElement("button");n.innerHTML=e;var r=n.style;r.float="right";r.textTransform="uppercase";r.color="#1094f7";r.fontSize="14px";r.letterSpacing=0;r.border=0;r.background="none";r.marginTop="16px";n.addEventListener("click",t);return n};var Ie=typeof window!=="undefined"?window:typeof qe!=="undefined"?qe:typeof self!=="undefined"?self:{};function Pe(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e["default"]:e}function De(e,t){return t={exports:{}},e(t,t.exports),t.exports}var Le=De(function(r,e){(function e(t,n){r.exports=n()})(Ie,function(){return function(n){var r={};function i(e){if(r[e]){return r[e].exports}var t=r[e]={i:e,l:false,exports:{}};n[e].call(t.exports,t,t.exports,i);t.l=true;return t.exports}i.m=n;i.c=r;i.d=function(e,t,n){if(!i.o(e,t)){Object.defineProperty(e,t,{configurable:false,enumerable:true,get:n})}};i.n=function(t){var e=t&&t.__esModule?function e(){return t["default"]}:function e(){return t};i.d(e,"a",e);return e};i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};i.p="";return i(i.s=0)}([function(e,t,n){var r=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}return function(e,t,n){if(t)r(e.prototype,t);if(n)r(e,n);return e}}();function i(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var a=n(1);var o=typeof navigator!=="undefined"&&parseFloat((""+(/CPU.*OS ([0-9_]{3,4})[0-9_]{0,1}|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))<10&&!window.MSStream;var s=function(){function e(){i(this,e);if(o){this.noSleepTimer=null}else{this.noSleepVideo=document.createElement("video");this.noSleepVideo.setAttribute("playsinline","");this.noSleepVideo.setAttribute("src",a);this.noSleepVideo.addEventListener("timeupdate",function(e){if(this.noSleepVideo.currentTime>.5){this.noSleepVideo.currentTime=Math.random()}}.bind(this))}}r(e,[{key:"enable",value:function e(){if(o){this.disable();this.noSleepTimer=window.setInterval(function(){window.location.href="/";window.setTimeout(window.stop,0)},15e3)}else{this.noSleepVideo.play()}}},{key:"disable",value:function e(){if(o){if(this.noSleepTimer){window.clearInterval(this.noSleepTimer);this.noSleepTimer=null}}else{this.noSleepVideo.pause()}}}]);return e}();e.exports=s},function(e,t,n){e.exports="data:video/mp4;base64,AAAAIGZ0eXBtcDQyAAACAGlzb21pc28yYXZjMW1wNDEAAAAIZnJlZQAACKBtZGF0AAAC8wYF///v3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE0MiByMjQ3OSBkZDc5YTYxIC0gSC4yNjQvTVBFRy00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAxNCAtIGh0dHA6Ly93d3cudmlkZW9sYW4ub3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTEgZGVibG9jaz0xOjA6MCBhbmFseXNlPTB4MToweDExMSBtZT1oZXggc3VibWU9MiBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVkX3JlZj0wIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MCA4eDhkY3Q9MCBjcW09MCBkZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0wIHRocmVhZHM9NiBsb29rYWhlYWRfdGhyZWFkcz0xIHNsaWNlZF90aHJlYWRzPTAgbnI9MCBkZWNpbWF0ZT0xIGludGVybGFjZWQ9MCBibHVyYXlfY29tcGF0PTAgY29uc3RyYWluZWRfaW50cmE9MCBiZnJhbWVzPTMgYl9weXJhbWlkPTIgYl9hZGFwdD0xIGJfYmlhcz0wIGRpcmVjdD0xIHdlaWdodGI9MSBvcGVuX2dvcD0wIHdlaWdodHA9MSBrZXlpbnQ9MzAwIGtleWludF9taW49MzAgc2NlbmVjdXQ9NDAgaW50cmFfcmVmcmVzaD0wIHJjX2xvb2thaGVhZD0xMCByYz1jcmYgbWJ0cmVlPTEgY3JmPTIwLjAgcWNvbXA9MC42MCBxcG1pbj0wIHFwbWF4PTY5IHFwc3RlcD00IHZidl9tYXhyYXRlPTIwMDAwIHZidl9idWZzaXplPTI1MDAwIGNyZl9tYXg9MC4wIG5hbF9ocmQ9bm9uZSBmaWxsZXI9MCBpcF9yYXRpbz0xLjQwIGFxPTE6MS4wMACAAAAAOWWIhAA3//p+C7v8tDDSTjf97w55i3SbRPO4ZY+hkjD5hbkAkL3zpJ6h/LR1CAABzgB1kqqzUorlhQAAAAxBmiQYhn/+qZYADLgAAAAJQZ5CQhX/AAj5IQADQGgcIQADQGgcAAAACQGeYUQn/wALKCEAA0BoHAAAAAkBnmNEJ/8ACykhAANAaBwhAANAaBwAAAANQZpoNExDP/6plgAMuSEAA0BoHAAAAAtBnoZFESwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBnqVEJ/8ACykhAANAaBwAAAAJAZ6nRCf/AAsoIQADQGgcIQADQGgcAAAADUGarDRMQz/+qZYADLghAANAaBwAAAALQZ7KRRUsK/8ACPkhAANAaBwAAAAJAZ7pRCf/AAsoIQADQGgcIQADQGgcAAAACQGe60Qn/wALKCEAA0BoHAAAAA1BmvA0TEM//qmWAAy5IQADQGgcIQADQGgcAAAAC0GfDkUVLCv/AAj5IQADQGgcAAAACQGfLUQn/wALKSEAA0BoHCEAA0BoHAAAAAkBny9EJ/8ACyghAANAaBwAAAANQZs0NExDP/6plgAMuCEAA0BoHAAAAAtBn1JFFSwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBn3FEJ/8ACyghAANAaBwAAAAJAZ9zRCf/AAsoIQADQGgcIQADQGgcAAAADUGbeDRMQz/+qZYADLkhAANAaBwAAAALQZ+WRRUsK/8ACPghAANAaBwhAANAaBwAAAAJAZ+1RCf/AAspIQADQGgcAAAACQGft0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bm7w0TEM//qmWAAy4IQADQGgcAAAAC0Gf2kUVLCv/AAj5IQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHAAAAAkBn/tEJ/8ACykhAANAaBwAAAANQZvgNExDP/6plgAMuSEAA0BoHCEAA0BoHAAAAAtBnh5FFSwr/wAI+CEAA0BoHAAAAAkBnj1EJ/8ACyghAANAaBwhAANAaBwAAAAJAZ4/RCf/AAspIQADQGgcAAAADUGaJDRMQz/+qZYADLghAANAaBwAAAALQZ5CRRUsK/8ACPkhAANAaBwhAANAaBwAAAAJAZ5hRCf/AAsoIQADQGgcAAAACQGeY0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bmmg0TEM//qmWAAy5IQADQGgcAAAAC0GehkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGepUQn/wALKSEAA0BoHAAAAAkBnqdEJ/8ACyghAANAaBwAAAANQZqsNExDP/6plgAMuCEAA0BoHCEAA0BoHAAAAAtBnspFFSwr/wAI+SEAA0BoHAAAAAkBnulEJ/8ACyghAANAaBwhAANAaBwAAAAJAZ7rRCf/AAsoIQADQGgcAAAADUGa8DRMQz/+qZYADLkhAANAaBwhAANAaBwAAAALQZ8ORRUsK/8ACPkhAANAaBwAAAAJAZ8tRCf/AAspIQADQGgcIQADQGgcAAAACQGfL0Qn/wALKCEAA0BoHAAAAA1BmzQ0TEM//qmWAAy4IQADQGgcAAAAC0GfUkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGfcUQn/wALKCEAA0BoHAAAAAkBn3NEJ/8ACyghAANAaBwhAANAaBwAAAANQZt4NExC//6plgAMuSEAA0BoHAAAAAtBn5ZFFSwr/wAI+CEAA0BoHCEAA0BoHAAAAAkBn7VEJ/8ACykhAANAaBwAAAAJAZ+3RCf/AAspIQADQGgcAAAADUGbuzRMQn/+nhAAYsAhAANAaBwhAANAaBwAAAAJQZ/aQhP/AAspIQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHAAACiFtb292AAAAbG12aGQAAAAA1YCCX9WAgl8AAAPoAAAH/AABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAGGlvZHMAAAAAEICAgAcAT////v7/AAAF+XRyYWsAAABcdGtoZAAAAAPVgIJf1YCCXwAAAAEAAAAAAAAH0AAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAygAAAMoAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAB9AAABdwAAEAAAAABXFtZGlhAAAAIG1kaGQAAAAA1YCCX9WAgl8AAV+QAAK/IFXEAAAAAAAtaGRscgAAAAAAAAAAdmlkZQAAAAAAAAAAAAAAAFZpZGVvSGFuZGxlcgAAAAUcbWluZgAAABR2bWhkAAAAAQAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAAE3HN0YmwAAACYc3RzZAAAAAAAAAABAAAAiGF2YzEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAygDKAEgAAABIAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAY//8AAAAyYXZjQwFNQCj/4QAbZ01AKOyho3ySTUBAQFAAAAMAEAAr8gDxgxlgAQAEaO+G8gAAABhzdHRzAAAAAAAAAAEAAAA8AAALuAAAABRzdHNzAAAAAAAAAAEAAAABAAAB8GN0dHMAAAAAAAAAPAAAAAEAABdwAAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAAC7gAAAAAQAAF3AAAAABAAAAAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAEEc3RzegAAAAAAAAAAAAAAPAAAAzQAAAAQAAAADQAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAANAAAADQAAAQBzdGNvAAAAAAAAADwAAAAwAAADZAAAA3QAAAONAAADoAAAA7kAAAPQAAAD6wAAA/4AAAQXAAAELgAABEMAAARcAAAEbwAABIwAAAShAAAEugAABM0AAATkAAAE/wAABRIAAAUrAAAFQgAABV0AAAVwAAAFiQAABaAAAAW1AAAFzgAABeEAAAX+AAAGEwAABiwAAAY/AAAGVgAABnEAAAaEAAAGnQAABrQAAAbPAAAG4gAABvUAAAcSAAAHJwAAB0AAAAdTAAAHcAAAB4UAAAeeAAAHsQAAB8gAAAfjAAAH9gAACA8AAAgmAAAIQQAACFQAAAhnAAAIhAAACJcAAAMsdHJhawAAAFx0a2hkAAAAA9WAgl/VgIJfAAAAAgAAAAAAAAf8AAAAAAAAAAAAAAABAQAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAACsm1kaWEAAAAgbWRoZAAAAADVgIJf1YCCXwAArEQAAWAAVcQAAAAAACdoZGxyAAAAAAAAAABzb3VuAAAAAAAAAAAAAAAAU3RlcmVvAAAAAmNtaW5mAAAAEHNtaGQAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAidzdGJsAAAAZ3N0c2QAAAAAAAAAAQAAAFdtcDRhAAAAAAAAAAEAAAAAAAAAAAACABAAAAAArEQAAAAAADNlc2RzAAAAAAOAgIAiAAIABICAgBRAFQAAAAADDUAAAAAABYCAgAISEAaAgIABAgAAABhzdHRzAAAAAAAAAAEAAABYAAAEAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAAUc3RzegAAAAAAAAAGAAAAWAAAAXBzdGNvAAAAAAAAAFgAAAOBAAADhwAAA5oAAAOtAAADswAAA8oAAAPfAAAD5QAAA/gAAAQLAAAEEQAABCgAAAQ9AAAEUAAABFYAAARpAAAEgAAABIYAAASbAAAErgAABLQAAATHAAAE3gAABPMAAAT5AAAFDAAABR8AAAUlAAAFPAAABVEAAAVXAAAFagAABX0AAAWDAAAFmgAABa8AAAXCAAAFyAAABdsAAAXyAAAF+AAABg0AAAYgAAAGJgAABjkAAAZQAAAGZQAABmsAAAZ+AAAGkQAABpcAAAauAAAGwwAABskAAAbcAAAG7wAABwYAAAcMAAAHIQAABzQAAAc6AAAHTQAAB2QAAAdqAAAHfwAAB5IAAAeYAAAHqwAAB8IAAAfXAAAH3QAAB/AAAAgDAAAICQAACCAAAAg1AAAIOwAACE4AAAhhAAAIeAAACH4AAAiRAAAIpAAACKoAAAiwAAAItgAACLwAAAjCAAAAFnVkdGEAAAAObmFtZVN0ZXJlbwAAAHB1ZHRhAAAAaG1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAAO2lsc3QAAAAzqXRvbwAAACtkYXRhAAAAAQAAAABIYW5kQnJha2UgMC4xMC4yIDIwMTUwNjExMDA="}])})});var Oe=Pe(Le);var Ne=1e3;var ke=[0,0,.5,1];var Be=[.5,0,.5,1];var Fe=window.requestAnimationFrame;var je=window.cancelAnimationFrame;function Ue(){this.leftProjectionMatrix=new Float32Array(16);this.leftViewMatrix=new Float32Array(16);this.rightProjectionMatrix=new Float32Array(16);this.rightViewMatrix=new Float32Array(16);this.pose=null}function He(t){Object.defineProperties(this,{hasPosition:{writable:false,enumerable:true,value:t.hasPosition},hasExternalDisplay:{writable:false,enumerable:true,value:t.hasExternalDisplay},canPresent:{writable:false,enumerable:true,value:t.canPresent},maxLayers:{writable:false,enumerable:true,value:t.maxLayers},hasOrientation:{enumerable:true,get:function e(){L("VRDisplayCapabilities.prototype.hasOrientation","VRDisplay.prototype.getFrameData");return t.hasOrientation}}})}function Ge(e){e=e||{};var t="wakelock"in e?e.wakelock:true;this.isPolyfilled=true;this.displayId=Ne++;this.displayName="";this.depthNear=.01;this.depthFar=1e4;this.isPresenting=false;Object.defineProperty(this,"isConnected",{get:function e(){L("VRDisplay.prototype.isConnected","VRDisplayCapabilities.prototype.hasExternalDisplay");return false}});this.capabilities=new He({hasPosition:false,hasOrientation:false,hasExternalDisplay:false,canPresent:false,maxLayers:1});this.stageParameters=null;this.waitingForPresent_=false;this.layer_=null;this.originalParent_=null;this.fullscreenElement_=null;this.fullscreenWrapper_=null;this.fullscreenElementCachedStyle_=null;this.fullscreenEventTarget_=null;this.fullscreenChangeHandler_=null;this.fullscreenErrorHandler_=null;if(t&&S()){this.wakelock_=new Oe}}Ge.prototype.getFrameData=function(e){return M(e,this._getPose(),this)};Ge.prototype.getPose=function(){L("VRDisplay.prototype.getPose","VRDisplay.prototype.getFrameData");return this._getPose()};Ge.prototype.resetPose=function(){L("VRDisplay.prototype.resetPose");return this._resetPose()};Ge.prototype.getImmediatePose=function(){L("VRDisplay.prototype.getImmediatePose","VRDisplay.prototype.getFrameData");return this._getPose()};Ge.prototype.requestAnimationFrame=function(e){return Fe(e)};Ge.prototype.cancelAnimationFrame=function(e){return je(e)};Ge.prototype.wrapForFullscreen=function(e){if(f()){return e}if(!this.fullscreenWrapper_){this.fullscreenWrapper_=document.createElement("div");var t=["height: "+Math.min(screen.height,screen.width)+"px !important","top: 0 !important","left: 0 !important","right: 0 !important","border: 0","margin: 0","padding: 0","z-index: 999999 !important","position: fixed"];this.fullscreenWrapper_.setAttribute("style",t.join("; ")+";");this.fullscreenWrapper_.classList.add("webvr-polyfill-fullscreen-wrapper")}if(this.fullscreenElement_==e){return this.fullscreenWrapper_}if(this.fullscreenElement_){if(this.originalParent_){this.originalParent_.appendChild(this.fullscreenElement_)}else{this.fullscreenElement_.parentElement.removeChild(this.fullscreenElement_)}}this.fullscreenElement_=e;this.originalParent_=e.parentElement;if(!this.originalParent_){document.body.appendChild(e)}if(!this.fullscreenWrapper_.parentElement){var n=this.fullscreenElement_.parentElement;n.insertBefore(this.fullscreenWrapper_,this.fullscreenElement_);n.removeChild(this.fullscreenElement_)}this.fullscreenWrapper_.insertBefore(this.fullscreenElement_,this.fullscreenWrapper_.firstChild);this.fullscreenElementCachedStyle_=this.fullscreenElement_.getAttribute("style");var r=this;function i(){if(!r.fullscreenElement_){return}var e=["position: absolute","top: 0","left: 0","width: "+Math.max(screen.width,screen.height)+"px","height: "+Math.min(screen.height,screen.width)+"px","border: 0","margin: 0","padding: 0"];r.fullscreenElement_.setAttribute("style",e.join("; ")+";")}i();return this.fullscreenWrapper_};Ge.prototype.removeFullscreenWrapper=function(){if(!this.fullscreenElement_){return}var e=this.fullscreenElement_;if(this.fullscreenElementCachedStyle_){e.setAttribute("style",this.fullscreenElementCachedStyle_)}else{e.removeAttribute("style")}this.fullscreenElement_=null;this.fullscreenElementCachedStyle_=null;var t=this.fullscreenWrapper_.parentElement;this.fullscreenWrapper_.removeChild(e);if(this.originalParent_===t){t.insertBefore(e,this.fullscreenWrapper_)}else if(this.originalParent_){this.originalParent_.appendChild(e)}t.removeChild(this.fullscreenWrapper_);return e};Ge.prototype.requestPresent=function(c){var d=this.isPresenting;var h=this;if(!(c instanceof Array)){L("VRDisplay.prototype.requestPresent with non-array argument","an array of VRLayers as the first argument");c=[c]}return new Promise(function(n,t){if(!h.capabilities.canPresent){t(new Error("VRDisplay is not capable of presenting."));return}if(c.length==0||c.length>h.capabilities.maxLayers){t(new Error("Invalid number of layers."));return}var e=c[0];if(!e.source){n();return}var r=e.leftBounds||ke;var i=e.rightBounds||Be;if(d){var a=h.layer_;if(a.source!==e.source){a.source=e.source}for(var o=0;o<4;o++){a.leftBounds[o]=r[o];a.rightBounds[o]=i[o]}h.wrapForFullscreen(h.layer_.source);h.updatePresent_();n();return}h.layer_={predistorted:e.predistorted,source:e.source,leftBounds:r.slice(0),rightBounds:i.slice(0)};h.waitingForPresent_=false;if(h.layer_&&h.layer_.source){var s=h.wrapForFullscreen(h.layer_.source);var l=function e(){var t=b();h.isPresenting=s===t;if(h.isPresenting){if(screen.orientation&&screen.orientation.lock){screen.orientation.lock("landscape-primary").catch(function(e){console.error("screen.orientation.lock() failed due to",e.message)})}h.waitingForPresent_=false;h.beginPresent_();n()}else{if(screen.orientation&&screen.orientation.unlock){screen.orientation.unlock()}h.removeFullscreenWrapper();h.disableWakeLock();h.endPresent_();h.removeFullscreenListeners_()}h.fireVRDisplayPresentChange_()};var u=function e(){if(!h.waitingForPresent_){return}h.removeFullscreenWrapper();h.removeFullscreenListeners_();h.disableWakeLock();h.waitingForPresent_=false;h.isPresenting=false;t(new Error("Unable to present."))};h.addFullscreenListeners_(s,l,u);if(y(s)){h.enableWakeLock();h.waitingForPresent_=true}else if(f()||p()){h.enableWakeLock();h.isPresenting=true;h.beginPresent_();h.fireVRDisplayPresentChange_();n()}}if(!h.waitingForPresent_&&!f()){_();t(new Error("Unable to present."))}})};Ge.prototype.exitPresent=function(){var n=this.isPresenting;var r=this;this.isPresenting=false;this.layer_=null;this.disableWakeLock();return new Promise(function(e,t){if(n){if(!_()&&f()){r.endPresent_();r.fireVRDisplayPresentChange_()}if(p()){r.removeFullscreenWrapper();r.removeFullscreenListeners_();r.endPresent_();r.fireVRDisplayPresentChange_()}e()}else{t(new Error("Was not presenting to VRDisplay."))}})};Ge.prototype.getLayers=function(){if(this.layer_){return[this.layer_]}return[]};Ge.prototype.fireVRDisplayPresentChange_=function(){var e=new CustomEvent("vrdisplaypresentchange",{detail:{display:this}});window.dispatchEvent(e)};Ge.prototype.fireVRDisplayConnect_=function(){var e=new CustomEvent("vrdisplayconnect",{detail:{display:this}});window.dispatchEvent(e)};Ge.prototype.addFullscreenListeners_=function(e,t,n){this.removeFullscreenListeners_();this.fullscreenEventTarget_=e;this.fullscreenChangeHandler_=t;this.fullscreenErrorHandler_=n;if(t){if(document.fullscreenEnabled){e.addEventListener("fullscreenchange",t,false)}else if(document.webkitFullscreenEnabled){e.addEventListener("webkitfullscreenchange",t,false)}else if(document.mozFullScreenEnabled){document.addEventListener("mozfullscreenchange",t,false)}else if(document.msFullscreenEnabled){e.addEventListener("msfullscreenchange",t,false)}}if(n){if(document.fullscreenEnabled){e.addEventListener("fullscreenerror",n,false)}else if(document.webkitFullscreenEnabled){e.addEventListener("webkitfullscreenerror",n,false)}else if(document.mozFullScreenEnabled){document.addEventListener("mozfullscreenerror",n,false)}else if(document.msFullscreenEnabled){e.addEventListener("msfullscreenerror",n,false)}}};Ge.prototype.removeFullscreenListeners_=function(){if(!this.fullscreenEventTarget_)return;var e=this.fullscreenEventTarget_;if(this.fullscreenChangeHandler_){var t=this.fullscreenChangeHandler_;e.removeEventListener("fullscreenchange",t,false);e.removeEventListener("webkitfullscreenchange",t,false);document.removeEventListener("mozfullscreenchange",t,false);e.removeEventListener("msfullscreenchange",t,false)}if(this.fullscreenErrorHandler_){var n=this.fullscreenErrorHandler_;e.removeEventListener("fullscreenerror",n,false);e.removeEventListener("webkitfullscreenerror",n,false);document.removeEventListener("mozfullscreenerror",n,false);e.removeEventListener("msfullscreenerror",n,false)}this.fullscreenEventTarget_=null;this.fullscreenChangeHandler_=null;this.fullscreenErrorHandler_=null};Ge.prototype.enableWakeLock=function(){if(this.wakelock_){this.wakelock_.enable()}};Ge.prototype.disableWakeLock=function(){if(this.wakelock_){this.wakelock_.disable()}};Ge.prototype.beginPresent_=function(){};Ge.prototype.endPresent_=function(){};Ge.prototype.submitFrame=function(e){};Ge.prototype.getEyeParameters=function(e){return null};var Ve={ADDITIONAL_VIEWERS:[],DEFAULT_VIEWER:"",MOBILE_WAKE_LOCK:true,DEBUG:false,DPDB_URL:"https://dpdb.webvr.rocks/dpdb.json",K_FILTER:.98,PREDICTION_TIME_S:.04,CARDBOARD_UI_DISABLED:false,ROTATE_INSTRUCTIONS_DISABLED:false,YAW_ONLY:false,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:false};var ze={LEFT:"left",RIGHT:"right"};function We(e){var t=C({},Ve);e=C(t,e||{});Ge.call(this,{wakelock:e.MOBILE_WAKE_LOCK});this.config=e;this.displayName="Cardboard VRDisplay";this.capabilities=new He({hasPosition:false,hasOrientation:true,hasExternalDisplay:false,canPresent:true,maxLayers:1});this.stageParameters=null;this.bufferScale_=this.config.BUFFER_SCALE;this.poseSensor_=new Ae(this.config);this.distorter_=null;this.cardboardUI_=null;this.dpdb_=new fe(this.config.DPDB_URL,this.onDeviceParamsUpdated_.bind(this));this.deviceInfo_=new se(this.dpdb_.getDeviceParams(),e.ADDITIONAL_VIEWERS);this.viewerSelector_=new Re(e.DEFAULT_VIEWER);this.viewerSelector_.onChange(this.onViewerChanged_.bind(this));this.deviceInfo_.setViewer(this.viewerSelector_.getCurrentViewer());if(!this.config.ROTATE_INSTRUCTIONS_DISABLED){this.rotateInstructions_=new Se}if(f()){window.addEventListener("resize",this.onResize_.bind(this))}}We.prototype=Object.create(Ge.prototype);We.prototype._getPose=function(){return{position:null,orientation:this.poseSensor_.getOrientation(),linearVelocity:null,linearAcceleration:null,angularVelocity:null,angularAcceleration:null}};We.prototype._resetPose=function(){if(this.poseSensor_.resetPose){this.poseSensor_.resetPose()}};We.prototype._getFieldOfView=function(e){var t;if(e==ze.LEFT){t=this.deviceInfo_.getFieldOfViewLeftEye()}else if(e==ze.RIGHT){t=this.deviceInfo_.getFieldOfViewRightEye()}else{console.error("Invalid eye provided: %s",e);return null}return t};We.prototype._getEyeOffset=function(e){var t;if(e==ze.LEFT){t=[-this.deviceInfo_.viewer.interLensDistance*.5,0,0]}else if(e==ze.RIGHT){t=[this.deviceInfo_.viewer.interLensDistance*.5,0,0]}else{console.error("Invalid eye provided: %s",e);return null}return t};We.prototype.getEyeParameters=function(e){var t=this._getEyeOffset(e);var n=this._getFieldOfView(e);var r={offset:t,renderWidth:this.deviceInfo_.device.width*.5*this.bufferScale_,renderHeight:this.deviceInfo_.device.height*this.bufferScale_};Object.defineProperty(r,"fieldOfView",{enumerable:true,get:function e(){L("VRFieldOfView","VRFrameData's projection matrices");return n}});return r};We.prototype.onDeviceParamsUpdated_=function(e){if(this.config.DEBUG){console.log("DPDB reported that device params were updated.")}this.deviceInfo_.updateDeviceParams(e);if(this.distorter_){this.distorter_.updateDeviceInfo(this.deviceInfo_)}};We.prototype.updateBounds_=function(){if(this.layer_&&this.distorter_&&(this.layer_.leftBounds||this.layer_.rightBounds)){this.distorter_.setTextureBounds(this.layer_.leftBounds,this.layer_.rightBounds)}};We.prototype.beginPresent_=function(){var e=this.layer_.source.getContext("webgl");if(!e)e=this.layer_.source.getContext("experimental-webgl");if(!e)e=this.layer_.source.getContext("webgl2");if(!e)return;if(this.layer_.predistorted){if(!this.config.CARDBOARD_UI_DISABLED){e.canvas.width=g()*this.bufferScale_;e.canvas.height=v()*this.bufferScale_;this.cardboardUI_=new Z(e)}}else{if(!this.config.CARDBOARD_UI_DISABLED){this.cardboardUI_=new Z(e)}this.distorter_=new F(e,this.cardboardUI_,this.config.BUFFER_SCALE,this.config.DIRTY_SUBMIT_FRAME_BINDINGS);this.distorter_.updateDeviceInfo(this.deviceInfo_)}if(this.cardboardUI_){this.cardboardUI_.listen(function(e){this.viewerSelector_.show(this.layer_.source.parentElement);e.stopPropagation();e.preventDefault()}.bind(this),function(e){this.exitPresent();e.stopPropagation();e.preventDefault()}.bind(this))}if(this.rotateInstructions_){if(m()&&S()){this.rotateInstructions_.showTemporarily(3e3,this.layer_.source.parentElement)}else{this.rotateInstructions_.update()}}this.orientationHandler=this.onOrientationChange_.bind(this);window.addEventListener("orientationchange",this.orientationHandler);this.vrdisplaypresentchangeHandler=this.updateBounds_.bind(this);window.addEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler);this.fireVRDisplayDeviceParamsChange_()};We.prototype.endPresent_=function(){if(this.distorter_){this.distorter_.destroy();this.distorter_=null}if(this.cardboardUI_){this.cardboardUI_.destroy();this.cardboardUI_=null}if(this.rotateInstructions_){this.rotateInstructions_.hide()}this.viewerSelector_.hide();window.removeEventListener("orientationchange",this.orientationHandler);window.removeEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler)};We.prototype.updatePresent_=function(){this.endPresent_();this.beginPresent_()};We.prototype.submitFrame=function(e){if(this.distorter_){this.updateBounds_();this.distorter_.submitFrame()}else if(this.cardboardUI_&&this.layer_){var t=this.layer_.source.getContext("webgl");if(!t)t=this.layer_.source.getContext("experimental-webgl");if(!t)t=this.layer_.source.getContext("webgl2");var n=t.canvas;if(n.width!=this.lastWidth||n.height!=this.lastHeight){this.cardboardUI_.onResize()}this.lastWidth=n.width;this.lastHeight=n.height;this.cardboardUI_.render()}};We.prototype.onOrientationChange_=function(e){this.viewerSelector_.hide();if(this.rotateInstructions_){this.rotateInstructions_.update()}this.onResize_()};We.prototype.onResize_=function(e){if(this.layer_){var t=this.layer_.source.getContext("webgl");if(!t)t=this.layer_.source.getContext("experimental-webgl");if(!t)t=this.layer_.source.getContext("webgl2");var n=["position: absolute","top: 0","left: 0","width: 100vw","height: 100vh","border: 0","margin: 0","padding: 0px","box-sizing: content-box"];t.canvas.setAttribute("style",n.join("; ")+";");x(t.canvas)}};We.prototype.onViewerChanged_=function(e){this.deviceInfo_.setViewer(e);if(this.distorter_){this.distorter_.updateDeviceInfo(this.deviceInfo_)}this.fireVRDisplayDeviceParamsChange_()};We.prototype.fireVRDisplayDeviceParamsChange_=function(){var e=new CustomEvent("vrdisplaydeviceparamschange",{detail:{vrdisplay:this,deviceInfo:this.deviceInfo_}});window.dispatchEvent(e)};We.VRFrameData=Ue;We.VRDisplay=Ge;return We})})),s="0.10.12",l={ADDITIONAL_VIEWERS:[],DEFAULT_VIEWER:"",PROVIDE_MOBILE_VRDISPLAY:true,MOBILE_WAKE_LOCK:true,DEBUG:false,DPDB_URL:"https://dpdb.webvr.rocks/dpdb.json",K_FILTER:.98,PREDICTION_TIME_S:.04,CARDBOARD_UI_DISABLED:false,ROTATE_INSTRUCTIONS_DISABLED:false,YAW_ONLY:false,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:false};function u(e){this.config=r(r({},l),e);this.polyfillDisplays=[];this.enabled=false;this.hasNative="getVRDisplays"in navigator;this.native={};this.native.getVRDisplays=navigator.getVRDisplays;this.native.VRFrameData=window.VRFrameData;this.native.VRDisplay=window.VRDisplay;if(!this.hasNative||this.config.PROVIDE_MOBILE_VRDISPLAY&&n()){this.enable();this.getVRDisplays().then(function(e){if(e&&e[0]&&e[0].fireVRDisplayConnect_){e[0].fireVRDisplayConnect_()}})}}u.prototype.getPolyfillDisplays=function(){if(this._polyfillDisplaysPopulated){return this.polyfillDisplays}if(n()){var e=new o({ADDITIONAL_VIEWERS:this.config.ADDITIONAL_VIEWERS,DEFAULT_VIEWER:this.config.DEFAULT_VIEWER,MOBILE_WAKE_LOCK:this.config.MOBILE_WAKE_LOCK,DEBUG:this.config.DEBUG,DPDB_URL:this.config.DPDB_URL,CARDBOARD_UI_DISABLED:this.config.CARDBOARD_UI_DISABLED,K_FILTER:this.config.K_FILTER,PREDICTION_TIME_S:this.config.PREDICTION_TIME_S,ROTATE_INSTRUCTIONS_DISABLED:this.config.ROTATE_INSTRUCTIONS_DISABLED,YAW_ONLY:this.config.YAW_ONLY,BUFFER_SCALE:this.config.BUFFER_SCALE,DIRTY_SUBMIT_FRAME_BINDINGS:this.config.DIRTY_SUBMIT_FRAME_BINDINGS});this.polyfillDisplays.push(e)}this._polyfillDisplaysPopulated=true;return this.polyfillDisplays},u.prototype.enable=function(){this.enabled=true;if(this.hasNative&&this.native.VRFrameData){var t=this.native.VRFrameData;var n=new this.native.VRFrameData;var r=this.native.VRDisplay.prototype.getFrameData;window.VRDisplay.prototype.getFrameData=function(e){if(e instanceof t){r.call(this,e);return}r.call(this,n);e.pose=n.pose;i(n.leftProjectionMatrix,e.leftProjectionMatrix);i(n.rightProjectionMatrix,e.rightProjectionMatrix);i(n.leftViewMatrix,e.leftViewMatrix);i(n.rightViewMatrix,e.rightViewMatrix)}}navigator.getVRDisplays=this.getVRDisplays.bind(this);window.VRDisplay=o.VRDisplay;window.VRFrameData=o.VRFrameData},u.prototype.getVRDisplays=function(){var t=this;var e=this.config;if(!this.hasNative){return Promise.resolve(this.getPolyfillDisplays())}return this.native.getVRDisplays.call(navigator).then(function(e){return e.length>0?e:t.getPolyfillDisplays()})},u.version=s,u.VRFrameData=o.VRFrameData,u.VRDisplay=o.VRDisplay;var c=Object.freeze({default:u}),d=c&&u||c,h;if(typeof qe!=="undefined"&&qe.window){if(!qe.document){qe.document=qe.window.document}if(!qe.navigator){qe.navigator=qe.window.navigator}}return d}()}));function i(){}void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}),void 0===Math.sign&&(Math.sign=function(e){return e<0?-1:0<e?1:+e}),"name"in Function.prototype==!1&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(null!=r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t}),Object.assign(i.prototype,{addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)},removeEventListener:function(e,t){if(void 0!==this._listeners){var n=this._listeners[e];if(void 0!==n){var r=n.indexOf(t);-1!==r&&n.splice(r,1)}}},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var n=t.slice(0),r=0,i=n.length;r<i;r++)n[r].call(this,e)}}}});var c,d,h,p,m,g,v,y,_,b,E,T,A,w,S,C,x,M,R,I,P,D,q=0,Y=1,K=2,z=0,W=1,X=2,N=1,L=2,k=0,Ae=1,Q=2,we=0,Z=0,J=1,$=2,ee=3,te=4,ne=5,O=100,B=101,F=102,j=103,U=104,H=200,G=201,V=202,re=203,ie=204,ae=205,oe=206,se=207,le=208,ue=209,ce=210,de=0,he=1,fe=2,pe=3,me=4,ge=5,ve=6,ye=7,_e=0,be=1,Ee=2,Te=0,Se=1,Ce=2,xe=3,Me=4,Re=301,Ie=302,Pe=303,De=304,Le=305,Oe=306,Ne=307,ke=1e3,Be=1001,Fe=1002,je=1003,Ue=1004,He=1005,Ge=1006,Ve=1007,ze=1008,We=1009,qe=1010,Ye=1011,Ke=1012,Xe=1013,Qe=1014,Ze=1015,Je=1016,$e=1017,et=1018,tt=1019,nt=1020,rt=1021,it=1022,at=1023,ot=1024,st=1025,lt=1026,ut=1027,ct=33776,dt=33777,ht=33778,ft=33779,pt=35840,mt=35841,gt=35842,vt=35843,yt=36196,_t=37808,bt=37809,Et=37810,Tt=37811,At=37812,wt=37813,St=37814,Ct=37815,xt=37816,Mt=37817,Rt=37818,It=37819,Pt=37820,Dt=37821,Lt=0,Ot=3e3,Nt=3001,kt=3007,Bt=3002,Ft=3004,jt=3005,Ut=3006,Ht=3200,Gt=3201,Vt={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){for(var i=[],e=0;e<256;e++)i[e]=(e<16?"0":"")+e.toString(16);return function(){var e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(i[255&e]+i[e>>8&255]+i[e>>16&255]+i[e>>24&255]+"-"+i[255&t]+i[t>>8&255]+"-"+i[t>>16&15|64]+i[t>>24&255]+"-"+i[63&n|128]+i[n>>8&255]+"-"+i[n>>16&255]+i[n>>24&255]+i[255&r]+i[r>>8&255]+i[r>>16&255]+i[r>>24&255]).toUpperCase()}}(),clamp:function(e,t,n){return Math.max(t,Math.min(n,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,n,r,i){return r+(e-t)*(i-r)/(n-t)},lerp:function(e,t,n){return(1-n)*e+n*t},smoothstep:function(e,t,n){return e<=t?0:n<=e?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:n<=e?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*Vt.DEG2RAD},radToDeg:function(e){return e*Vt.RAD2DEG},isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}};function zt(e,t){this.x=e||0,this.y=t||0}function Wt(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function qt(e,t,n,r){this._x=e||0,this._y=t||0,this._z=n||0,this._w=void 0!==r?r:1}function Yt(e,t,n){this.x=e||0,this.y=t||0,this.z=n||0}function Kt(){this.elements=[1,0,0,0,1,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}Object.defineProperties(zt.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(e){this.y=e}}}),Object.assign(zt.prototype,{isVector2:!0,set:function(e,t){return this.x=e,this.y=t,this},setScalar:function(e){return this.x=e,this.y=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){return this.multiplyScalar(1/e)},applyMatrix3:function(e){var t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this},clampScalar:(c=new zt,d=new zt,function(e,t){return c.set(e,e),d.set(t,t),this.clamp(c,d)}),clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var e=Math.atan2(this.y,this.x);return e<0&&(e+=2*Math.PI),e},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this},rotateAround:function(e,t){var n=Math.cos(t),r=Math.sin(t),i=this.x-e.x,a=this.y-e.y;return this.x=i*n-a*r+e.x,this.y=i*r+a*n+e.y,this}}),Object.assign(Wt.prototype,{isMatrix4:!0,set:function(e,t,n,r,i,a,o,s,l,u,c,d,h,f,p,m){var g=this.elements;return g[0]=e,g[4]=t,g[8]=n,g[12]=r,g[1]=i,g[5]=a,g[9]=o,g[13]=s,g[2]=l,g[6]=u,g[10]=c,g[14]=d,g[3]=h,g[7]=f,g[11]=p,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new Wt).fromArray(this.elements)},copy:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this},copyPosition:function(e){var t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this},extractBasis:function(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this},extractRotation:(E=new Yt,function(e){var t=this.elements,n=e.elements,r=1/E.setFromMatrixColumn(e,0).length(),i=1/E.setFromMatrixColumn(e,1).length(),a=1/E.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=0,t[8]=n[8]*a,t[9]=n[9]*a,t[10]=n[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}),makeRotationFromEuler:function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,n=e.x,r=e.y,i=e.z,a=Math.cos(n),o=Math.sin(n),s=Math.cos(r),l=Math.sin(r),u=Math.cos(i),c=Math.sin(i);if("XYZ"===e.order){var d=a*u,h=a*c,f=o*u,p=o*c;t[0]=s*u,t[4]=-s*c,t[8]=l,t[1]=h+f*l,t[5]=d-p*l,t[9]=-o*s,t[2]=p-d*l,t[6]=f+h*l,t[10]=a*s}else if("YXZ"===e.order){var m=s*u,g=s*c,v=l*u,y=l*c;t[0]=m+y*o,t[4]=v*o-g,t[8]=a*l,t[1]=a*c,t[5]=a*u,t[9]=-o,t[2]=g*o-v,t[6]=y+m*o,t[10]=a*s}else if("ZXY"===e.order){m=s*u,g=s*c,v=l*u,y=l*c;t[0]=m-y*o,t[4]=-a*c,t[8]=v+g*o,t[1]=g+v*o,t[5]=a*u,t[9]=y-m*o,t[2]=-a*l,t[6]=o,t[10]=a*s}else if("ZYX"===e.order){d=a*u,h=a*c,f=o*u,p=o*c;t[0]=s*u,t[4]=f*l-h,t[8]=d*l+p,t[1]=s*c,t[5]=p*l+d,t[9]=h*l-f,t[2]=-l,t[6]=o*s,t[10]=a*s}else if("YZX"===e.order){var _=a*s,b=a*l,E=o*s,T=o*l;t[0]=s*u,t[4]=T-_*c,t[8]=E*c+b,t[1]=c,t[5]=a*u,t[9]=-o*u,t[2]=-l*u,t[6]=b*c+E,t[10]=_-T*c}else if("XZY"===e.order){_=a*s,b=a*l,E=o*s,T=o*l;t[0]=s*u,t[4]=-c,t[8]=l*u,t[1]=_*c+T,t[5]=a*u,t[9]=b*c-E,t[2]=E*c-b,t[6]=o*u,t[10]=T*c+_}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromQuaternion:(_=new Yt(0,0,0),b=new Yt(1,1,1),function(e){return this.compose(_,e,b)}),lookAt:(g=new Yt,v=new Yt,y=new Yt,function(e,t,n){var r=this.elements;return y.subVectors(e,t),0===y.lengthSq()&&(y.z=1),y.normalize(),g.crossVectors(n,y),0===g.lengthSq()&&(1===Math.abs(n.z)?y.x+=1e-4:y.z+=1e-4,y.normalize(),g.crossVectors(n,y)),g.normalize(),v.crossVectors(y,g),r[0]=g.x,r[4]=v.x,r[8]=y.x,r[1]=g.y,r[5]=v.y,r[9]=y.y,r[2]=g.z,r[6]=v.z,r[10]=y.z,this}),multiply:function(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var n=e.elements,r=t.elements,i=this.elements,a=n[0],o=n[4],s=n[8],l=n[12],u=n[1],c=n[5],d=n[9],h=n[13],f=n[2],p=n[6],m=n[10],g=n[14],v=n[3],y=n[7],_=n[11],b=n[15],E=r[0],T=r[4],A=r[8],w=r[12],S=r[1],C=r[5],x=r[9],M=r[13],R=r[2],I=r[6],P=r[10],D=r[14],L=r[3],O=r[7],N=r[11],k=r[15];return i[0]=a*E+o*S+s*R+l*L,i[4]=a*T+o*C+s*I+l*O,i[8]=a*A+o*x+s*P+l*N,i[12]=a*w+o*M+s*D+l*k,i[1]=u*E+c*S+d*R+h*L,i[5]=u*T+c*C+d*I+h*O,i[9]=u*A+c*x+d*P+h*N,i[13]=u*w+c*M+d*D+h*k,i[2]=f*E+p*S+m*R+g*L,i[6]=f*T+p*C+m*I+g*O,i[10]=f*A+p*x+m*P+g*N,i[14]=f*w+p*M+m*D+g*k,i[3]=v*E+y*S+_*R+b*L,i[7]=v*T+y*C+_*I+b*O,i[11]=v*A+y*x+_*P+b*N,i[15]=v*w+y*M+_*D+b*k,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},applyToBufferAttribute:(m=new Yt,function(e){for(var t=0,n=e.count;t<n;t++)m.x=e.getX(t),m.y=e.getY(t),m.z=e.getZ(t),m.applyMatrix4(this),e.setXYZ(t,m.x,m.y,m.z);return e}),determinant:function(){var e=this.elements,t=e[0],n=e[4],r=e[8],i=e[12],a=e[1],o=e[5],s=e[9],l=e[13],u=e[2],c=e[6],d=e[10],h=e[14];return e[3]*(i*s*c-r*l*c-i*o*d+n*l*d+r*o*h-n*s*h)+e[7]*(t*s*h-t*l*d+i*a*d-r*a*h+r*l*u-i*s*u)+e[11]*(t*l*c-t*o*h-i*a*c+n*a*h+i*o*u-n*l*u)+e[15]*(-r*o*u-t*s*c+t*o*d+r*a*c-n*a*d+n*s*u)},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},setPosition:function(e){var t=this.elements;return t[12]=e.x,t[13]=e.y,t[14]=e.z,this},getInverse:function(e,t){var n=this.elements,r=e.elements,i=r[0],a=r[1],o=r[2],s=r[3],l=r[4],u=r[5],c=r[6],d=r[7],h=r[8],f=r[9],p=r[10],m=r[11],g=r[12],v=r[13],y=r[14],_=r[15],b=f*y*d-v*p*d+v*c*m-u*y*m-f*c*_+u*p*_,E=g*p*d-h*y*d-g*c*m+l*y*m+h*c*_-l*p*_,T=h*v*d-g*f*d+g*u*m-l*v*m-h*u*_+l*f*_,A=g*f*c-h*v*c-g*u*p+l*v*p+h*u*y-l*f*y,w=i*b+a*E+o*T+s*A;if(0==w){var S="THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0";if(!0===t)throw new Error(S);return console.warn(S),this.identity()}var C=1/w;return n[0]=b*C,n[1]=(v*p*s-f*y*s-v*o*m+a*y*m+f*o*_-a*p*_)*C,n[2]=(u*y*s-v*c*s+v*o*d-a*y*d-u*o*_+a*c*_)*C,n[3]=(f*c*s-u*p*s-f*o*d+a*p*d+u*o*m-a*c*m)*C,n[4]=E*C,n[5]=(h*y*s-g*p*s+g*o*m-i*y*m-h*o*_+i*p*_)*C,n[6]=(g*c*s-l*y*s-g*o*d+i*y*d+l*o*_-i*c*_)*C,n[7]=(l*p*s-h*c*s+h*o*d-i*p*d-l*o*m+i*c*m)*C,n[8]=T*C,n[9]=(g*f*s-h*v*s-g*a*m+i*v*m+h*a*_-i*f*_)*C,n[10]=(l*v*s-g*u*s+g*a*d-i*v*d-l*a*_+i*u*_)*C,n[11]=(h*u*s-l*f*s-h*a*d+i*f*d+l*a*m-i*u*m)*C,n[12]=A*C,n[13]=(h*v*o-g*f*o+g*a*p-i*v*p-h*a*y+i*f*y)*C,n[14]=(g*u*o-l*v*o-g*a*c+i*v*c+l*a*y-i*u*y)*C,n[15]=(l*f*o-h*u*o+h*a*c-i*f*c-l*a*p+i*u*p)*C,this},scale:function(e){var t=this.elements,n=e.x,r=e.y,i=e.z;return t[0]*=n,t[4]*=r,t[8]*=i,t[1]*=n,t[5]*=r,t[9]*=i,t[2]*=n,t[6]*=r,t[10]*=i,t[3]*=n,t[7]*=r,t[11]*=i,this},getMaxScaleOnAxis:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))},makeTranslation:function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var n=Math.cos(t),r=Math.sin(t),i=1-n,a=e.x,o=e.y,s=e.z,l=i*a,u=i*o;return this.set(l*a+n,l*o-r*s,l*s+r*o,0,l*o+r*s,u*o+n,u*s-r*a,0,l*s-r*o,u*s+r*a,i*s*s+n,0,0,0,0,1),this},makeScale:function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(e,t,n){return this.set(1,t,n,0,e,1,n,0,e,t,1,0,0,0,0,1),this},compose:function(e,t,n){var r=this.elements,i=t._x,a=t._y,o=t._z,s=t._w,l=i+i,u=a+a,c=o+o,d=i*l,h=i*u,f=i*c,p=a*u,m=a*c,g=o*c,v=s*l,y=s*u,_=s*c,b=n.x,E=n.y,T=n.z;return r[0]=(1-(p+g))*b,r[1]=(h+_)*b,r[2]=(f-y)*b,r[3]=0,r[4]=(h-_)*E,r[5]=(1-(d+g))*E,r[6]=(m+v)*E,r[7]=0,r[8]=(f+y)*T,r[9]=(m-v)*T,r[10]=(1-(d+p))*T,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this},decompose:(h=new Yt,p=new Wt,function(e,t,n){var r=this.elements,i=h.set(r[0],r[1],r[2]).length(),a=h.set(r[4],r[5],r[6]).length(),o=h.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),e.x=r[12],e.y=r[13],e.z=r[14],p.copy(this);var s=1/i,l=1/a,u=1/o;return p.elements[0]*=s,p.elements[1]*=s,p.elements[2]*=s,p.elements[4]*=l,p.elements[5]*=l,p.elements[6]*=l,p.elements[8]*=u,p.elements[9]*=u,p.elements[10]*=u,t.setFromRotationMatrix(p),n.x=i,n.y=a,n.z=o,this}),makePerspective:function(e,t,n,r,i,a){void 0===a&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var o=this.elements,s=2*i/(t-e),l=2*i/(n-r),u=(t+e)/(t-e),c=(n+r)/(n-r),d=-(a+i)/(a-i),h=-2*a*i/(a-i);return o[0]=s,o[4]=0,o[8]=u,o[12]=0,o[1]=0,o[5]=l,o[9]=c,o[13]=0,o[2]=0,o[6]=0,o[10]=d,o[14]=h,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this},makeOrthographic:function(e,t,n,r,i,a){var o=this.elements,s=1/(t-e),l=1/(n-r),u=1/(a-i),c=(t+e)*s,d=(n+r)*l,h=(a+i)*u;return o[0]=2*s,o[4]=0,o[8]=0,o[12]=-c,o[1]=0,o[5]=2*l,o[9]=0,o[13]=-d,o[2]=0,o[6]=0,o[10]=-2*u,o[14]=-h,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this},equals:function(e){for(var t=this.elements,n=e.elements,r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var n=0;n<16;n++)this.elements[n]=e[n+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}),Object.assign(qt,{slerp:function(e,t,n,r){return n.copy(e).slerp(t,r)},slerpFlat:function(e,t,n,r,i,a,o){var s=n[r+0],l=n[r+1],u=n[r+2],c=n[r+3],d=i[a+0],h=i[a+1],f=i[a+2],p=i[a+3];if(c!==p||s!==d||l!==h||u!==f){var m=1-o,g=s*d+l*h+u*f+c*p,v=0<=g?1:-1,y=1-g*g;if(y>Number.EPSILON){var _=Math.sqrt(y),b=Math.atan2(_,g*v);m=Math.sin(m*b)/_,o=Math.sin(o*b)/_}var E=o*v;if(s=s*m+d*E,l=l*m+h*E,u=u*m+f*E,c=c*m+p*E,m===1-o){var T=1/Math.sqrt(s*s+l*l+u*u+c*c);s*=T,l*=T,u*=T,c*=T}}e[t]=s,e[t+1]=l,e[t+2]=u,e[t+3]=c}}),Object.defineProperties(qt.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this.onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e,this.onChangeCallback()}}}),Object.assign(qt.prototype,{set:function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this.onChangeCallback(),this},setFromEuler:function(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=e._x,r=e._y,i=e._z,a=e.order,o=Math.cos,s=Math.sin,l=o(n/2),u=o(r/2),c=o(i/2),d=s(n/2),h=s(r/2),f=s(i/2);return"XYZ"===a?(this._x=d*u*c+l*h*f,this._y=l*h*c-d*u*f,this._z=l*u*f+d*h*c,this._w=l*u*c-d*h*f):"YXZ"===a?(this._x=d*u*c+l*h*f,this._y=l*h*c-d*u*f,this._z=l*u*f-d*h*c,this._w=l*u*c+d*h*f):"ZXY"===a?(this._x=d*u*c-l*h*f,this._y=l*h*c+d*u*f,this._z=l*u*f+d*h*c,this._w=l*u*c-d*h*f):"ZYX"===a?(this._x=d*u*c-l*h*f,this._y=l*h*c+d*u*f,this._z=l*u*f-d*h*c,this._w=l*u*c+d*h*f):"YZX"===a?(this._x=d*u*c+l*h*f,this._y=l*h*c+d*u*f,this._z=l*u*f-d*h*c,this._w=l*u*c-d*h*f):"XZY"===a&&(this._x=d*u*c-l*h*f,this._y=l*h*c-d*u*f,this._z=l*u*f+d*h*c,this._w=l*u*c+d*h*f),!1!==t&&this.onChangeCallback(),this},setFromAxisAngle:function(e,t){var n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this.onChangeCallback(),this},setFromRotationMatrix:function(e){var t,n=e.elements,r=n[0],i=n[4],a=n[8],o=n[1],s=n[5],l=n[9],u=n[2],c=n[6],d=n[10],h=r+s+d;return 0<h?(t=.5/Math.sqrt(h+1),this._w=.25/t,this._x=(c-l)*t,this._y=(a-u)*t,this._z=(o-i)*t):s<r&&d<r?(t=2*Math.sqrt(1+r-s-d),this._w=(c-l)/t,this._x=.25*t,this._y=(i+o)/t,this._z=(a+u)/t):d<s?(t=2*Math.sqrt(1+s-r-d),this._w=(a-u)/t,this._x=(i+o)/t,this._y=.25*t,this._z=(l+c)/t):(t=2*Math.sqrt(1+d-r-s),this._w=(o-i)/t,this._x=(a+u)/t,this._y=(l+c)/t,this._z=.25*t),this.onChangeCallback(),this},setFromUnitVectors:(A=new Yt,function(e,t){return void 0===A&&(A=new Yt),(T=e.dot(t)+1)<1e-6?(T=0,Math.abs(e.x)>Math.abs(e.z)?A.set(-e.y,e.x,0):A.set(0,-e.z,e.y)):A.crossVectors(e,t),this._x=A.x,this._y=A.y,this._z=A.z,this._w=T,this.normalize()}),inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this.onChangeCallback(),this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(e,t){var n=e._x,r=e._y,i=e._z,a=e._w,o=t._x,s=t._y,l=t._z,u=t._w;return this._x=n*u+a*o+r*l-i*s,this._y=r*u+a*s+i*o-n*l,this._z=i*u+a*l+n*s-r*o,this._w=a*u-n*o-r*s-i*l,this.onChangeCallback(),this},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var n=this._x,r=this._y,i=this._z,a=this._w,o=a*e._w+n*e._x+r*e._y+i*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),1<=o)return this._w=a,this._x=n,this._y=r,this._z=i,this;var s=Math.sqrt(1-o*o);if(Math.abs(s)<.001)return this._w=.5*(a+this._w),this._x=.5*(n+this._x),this._y=.5*(r+this._y),this._z=.5*(i+this._z),this;var l=Math.atan2(s,o),u=Math.sin((1-t)*l)/s,c=Math.sin(t*l)/s;return this._w=a*u+this._w*c,this._x=n*u+this._x*c,this._y=r*u+this._y*c,this._z=i*u+this._z*c,this.onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return void 0===t&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}}),Object.assign(Yt.prototype,{isVector3:!0,set:function(e,t,n){return this.x=e,this.y=t,this.z=n,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:(P=new qt,function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(P.setFromEuler(e))}),applyAxisAngle:(I=new qt,function(e,t){return this.applyQuaternion(I.setFromAxisAngle(e,t))}),applyMatrix3:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6]*r,this.y=i[1]*t+i[4]*n+i[7]*r,this.z=i[2]*t+i[5]*n+i[8]*r,this},applyMatrix4:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements,a=1/(i[3]*t+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*t+i[4]*n+i[8]*r+i[12])*a,this.y=(i[1]*t+i[5]*n+i[9]*r+i[13])*a,this.z=(i[2]*t+i[6]*n+i[10]*r+i[14])*a,this},applyQuaternion:function(e){var t=this.x,n=this.y,r=this.z,i=e.x,a=e.y,o=e.z,s=e.w,l=s*t+a*r-o*n,u=s*n+o*t-i*r,c=s*r+i*n-a*t,d=-i*t-a*n-o*r;return this.x=l*s+d*-i+u*-o-c*-a,this.y=u*s+d*-a+c*-i-l*-o,this.z=c*s+d*-o+l*-a-u*-i,this},project:(R=new Wt,function(e){return R.multiplyMatrices(e.projectionMatrix,R.getInverse(e.matrixWorld)),this.applyMatrix4(R)}),unproject:(M=new Wt,function(e){return M.multiplyMatrices(e.matrixWorld,M.getInverse(e.projectionMatrix)),this.applyMatrix4(M)}),transformDirection:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[4]*n+i[8]*r,this.y=i[1]*t+i[5]*n+i[9]*r,this.z=i[2]*t+i[6]*n+i[10]*r,this.normalize()},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this},clampScalar:(C=new Yt,x=new Yt,function(e,t){return C.set(e,e,e),x.set(t,t,t),this.clamp(C,x)}),clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},cross:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)},crossVectors:function(e,t){var n=e.x,r=e.y,i=e.z,a=t.x,o=t.y,s=t.z;return this.x=r*s-i*o,this.y=i*a-n*s,this.z=n*o-r*a,this},projectOnVector:function(e){var t=e.dot(this)/e.lengthSq();return this.copy(e).multiplyScalar(t)},projectOnPlane:(S=new Yt,function(e){return S.copy(this).projectOnVector(e),this.sub(S)}),reflect:(w=new Yt,function(e){return this.sub(w.copy(e).multiplyScalar(2*this.dot(e)))}),angleTo:function(e){var t=this.dot(e)/Math.sqrt(this.lengthSq()*e.lengthSq());return Math.acos(Vt.clamp(t,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},setFromSpherical:function(e){var t=Math.sin(e.phi)*e.radius;return this.x=t*Math.sin(e.theta),this.y=Math.cos(e.phi)*e.radius,this.z=t*Math.cos(e.theta),this},setFromCylindrical:function(e){return this.x=e.radius*Math.sin(e.theta),this.y=e.y,this.z=e.radius*Math.cos(e.theta),this},setFromMatrixPosition:function(e){var t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(e){var t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this},setFromMatrixColumn:function(e,t){return this.fromArray(e.elements,4*t)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}}),Object.assign(Kt.prototype,{isMatrix3:!0,set:function(e,t,n,r,i,a,o,s,l){var u=this.elements;return u[0]=e,u[1]=r,u[2]=o,u[3]=t,u[4]=i,u[5]=s,u[6]=n,u[7]=a,u[8]=l,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this},setFromMatrix4:function(e){var t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},applyToBufferAttribute:(D=new Yt,function(e){for(var t=0,n=e.count;t<n;t++)D.x=e.getX(t),D.y=e.getY(t),D.z=e.getZ(t),D.applyMatrix3(this),e.setXYZ(t,D.x,D.y,D.z);return e}),multiply:function(e){return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var n=e.elements,r=t.elements,i=this.elements,a=n[0],o=n[3],s=n[6],l=n[1],u=n[4],c=n[7],d=n[2],h=n[5],f=n[8],p=r[0],m=r[3],g=r[6],v=r[1],y=r[4],_=r[7],b=r[2],E=r[5],T=r[8];return i[0]=a*p+o*v+s*b,i[3]=a*m+o*y+s*E,i[6]=a*g+o*_+s*T,i[1]=l*p+u*v+c*b,i[4]=l*m+u*y+c*E,i[7]=l*g+u*_+c*T,i[2]=d*p+h*v+f*b,i[5]=d*m+h*y+f*E,i[8]=d*g+h*_+f*T,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],o=e[5],s=e[6],l=e[7],u=e[8];return t*a*u-t*o*l-n*i*u+n*o*s+r*i*l-r*a*s},getInverse:function(e,t){e&&e.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var n=e.elements,r=this.elements,i=n[0],a=n[1],o=n[2],s=n[3],l=n[4],u=n[5],c=n[6],d=n[7],h=n[8],f=h*l-u*d,p=u*c-h*s,m=d*s-l*c,g=i*f+a*p+o*m;if(0==g){var v="THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0";if(!0===t)throw new Error(v);return console.warn(v),this.identity()}var y=1/g;return r[0]=f*y,r[1]=(o*d-h*a)*y,r[2]=(u*a-o*l)*y,r[3]=p*y,r[4]=(h*i-o*c)*y,r[5]=(o*s-u*i)*y,r[6]=m*y,r[7]=(a*c-d*i)*y,r[8]=(l*i-a*s)*y,this},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},setUvTransform:function(e,t,n,r,i,a,o){var s=Math.cos(i),l=Math.sin(i);this.set(n*s,n*l,-n*(s*a+l*o)+a+e,-r*l,r*s,-r*(-l*a+s*o)+o+t,0,0,1)},scale:function(e,t){var n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this},rotate:function(e){var t=Math.cos(e),n=Math.sin(e),r=this.elements,i=r[0],a=r[3],o=r[6],s=r[1],l=r[4],u=r[7];return r[0]=t*i+n*s,r[3]=t*a+n*l,r[6]=t*o+n*u,r[1]=-n*i+t*s,r[4]=-n*a+t*l,r[7]=-n*o+t*u,this},translate:function(e,t){var n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this},equals:function(e){for(var t=this.elements,n=e.elements,r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var n=0;n<9;n++)this.elements[n]=e[n+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}});var Xt,Qt,Zt,Jt,$t,en,tn,nn,rn,an,on,sn,ln,un,cn,dn,hn,fn,pn,mn,gn,vn,yn,_n,bn,En,Tn,An,wn,Sn,Cn=0;function xn(e,t,n,r,i,a,o,s,l,u){Object.defineProperty(this,"id",{value:Cn++}),this.uuid=Vt.generateUUID(),this.name="",this.image=void 0!==e?e:xn.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==t?t:xn.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:Be,this.wrapT=void 0!==r?r:Be,this.magFilter=void 0!==i?i:Ge,this.minFilter=void 0!==a?a:ze,this.anisotropy=void 0!==l?l:1,this.format=void 0!==o?o:at,this.type=void 0!==s?s:We,this.offset=new zt(0,0),this.repeat=new zt(1,1),this.center=new zt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Kt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==u?u:Ot,this.version=0,this.onUpdate=null}function Mn(e,t,n,r){this.x=e||0,this.y=t||0,this.z=n||0,this.w=void 0!==r?r:1}function Rn(e,t,n){this.width=e,this.height=t,this.scissor=new Mn(0,0,e,t),this.scissorTest=!1,this.viewport=new Mn(0,0,e,t),void 0===(n=n||{}).minFilter&&(n.minFilter=Ge),this.texture=new xn(void 0,void 0,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.generateMipmaps=void 0===n.generateMipmaps||n.generateMipmaps,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0===n.stencilBuffer||n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}function In(e,t,n){Rn.call(this,e,t,n),this.activeCubeFace=0,this.activeMipMapLevel=0}function Pn(e,t,n,r,i,a,o,s,l,u,c,d){xn.call(this,null,a,o,s,l,u,r,i,c,d),this.image={data:e,width:t,height:n},this.magFilter=void 0!==l?l:je,this.minFilter=void 0!==u?u:je,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}function Dn(e,t){this.min=void 0!==e?e:new Yt(1/0,1/0,1/0),this.max=void 0!==t?t:new Yt(-1/0,-1/0,-1/0)}function Ln(e){var t,n;for(t=0,n=e.length-3;t<=n;t+=3){on.fromArray(e,t);var r=ln.x*Math.abs(on.x)+ln.y*Math.abs(on.y)+ln.z*Math.abs(on.z),i=$t.dot(on),a=en.dot(on),o=tn.dot(on);if(Math.max(-Math.max(i,a,o),Math.min(i,a,o))>r)return!1}return!0}function On(e){var t=e.geometry;if(void 0!==t)if(t.isGeometry){var n=t.vertices;for(hn=0,fn=n.length;hn<fn;hn++)pn.copy(n[hn]),pn.applyMatrix4(e.matrixWorld),dn.expandByPoint(pn)}else if(t.isBufferGeometry){var r=t.attributes.position;if(void 0!==r)for(hn=0,fn=r.count;hn<fn;hn++)pn.fromBufferAttribute(r,hn).applyMatrix4(e.matrixWorld),dn.expandByPoint(pn)}}function Nn(e,t){this.center=void 0!==e?e:new Yt,this.radius=void 0!==t?t:0}function kn(e,t){this.normal=void 0!==e?e:new Yt(1,0,0),this.constant=void 0!==t?t:0}function Bn(e,t,n,r,i,a){this.planes=[void 0!==e?e:new kn,void 0!==t?t:new kn,void 0!==n?n:new kn,void 0!==r?r:new kn,void 0!==i?i:new kn,void 0!==a?a:new kn]}xn.DEFAULT_IMAGE=void 0,xn.DEFAULT_MAPPING=300,xn.prototype=Object.assign(Object.create(i.prototype),{constructor:xn,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){var t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];var n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};if(void 0!==this.image){var r=this.image;void 0===r.uuid&&(r.uuid=Vt.generateUUID()),t||void 0!==e.images[r.uuid]||(e.images[r.uuid]={uuid:r.uuid,url:function(e){var t;if(e instanceof HTMLCanvasElement)t=e;else{(t=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")).width=e.width,t.height=e.height;var n=t.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height)}return 2048<t.width||2048<t.height?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}(r)}),n.image=r.uuid}return t||(e.textures[this.uuid]=n),n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(300===this.mapping){if(e.applyMatrix3(this.matrix),e.x<0||1<e.x)switch(this.wrapS){case ke:e.x=e.x-Math.floor(e.x);break;case Be:e.x=e.x<0?0:1;break;case Fe:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||1<e.y)switch(this.wrapT){case ke:e.y=e.y-Math.floor(e.y);break;case Be:e.y=e.y<0?0:1;break;case Fe:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}this.flipY&&(e.y=1-e.y)}}}),Object.defineProperty(xn.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(Mn.prototype,{isVector4:!0,set:function(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var t=this.x,n=this.y,r=this.z,i=this.w,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*r+a[12]*i,this.y=a[1]*t+a[5]*n+a[9]*r+a[13]*i,this.z=a[2]*t+a[6]*n+a[10]*r+a[14]*i,this.w=a[3]*t+a[7]*n+a[11]*r+a[15]*i,this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){var t,n,r,i,a=e.elements,o=a[0],s=a[4],l=a[8],u=a[1],c=a[5],d=a[9],h=a[2],f=a[6],p=a[10];if(Math.abs(s-u)<.01&&Math.abs(l-h)<.01&&Math.abs(d-f)<.01){if(Math.abs(s+u)<.1&&Math.abs(l+h)<.1&&Math.abs(d+f)<.1&&Math.abs(o+c+p-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;var m=(o+1)/2,g=(c+1)/2,v=(p+1)/2,y=(s+u)/4,_=(l+h)/4,b=(d+f)/4;return g<m&&v<m?i=m<.01?(n=0,r=.707106781):(r=y/(n=Math.sqrt(m)),_/n):v<g?i=g<.01?(r=0,n=.707106781):(n=y/(r=Math.sqrt(g)),b/r):v<.01?(r=n=.707106781,i=0):(n=_/(i=Math.sqrt(v)),r=b/i),this.set(n,r,i,t),this}var E=Math.sqrt((f-d)*(f-d)+(l-h)*(l-h)+(u-s)*(u-s));return Math.abs(E)<.001&&(E=1),this.x=(f-d)/E,this.y=(l-h)/E,this.z=(u-s)/E,this.w=Math.acos((o+c+p-1)/2),this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this},clampScalar:function(e,t){return void 0===Xt&&(Xt=new Mn,Qt=new Mn),Xt.set(e,e,e,e),Qt.set(t,t,t,t),this.clamp(Xt,Qt)},clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}}),Rn.prototype=Object.assign(Object.create(i.prototype),{constructor:Rn,isWebGLRenderTarget:!0,setSize:function(e,t){this.width===e&&this.height===t||(this.width=e,this.height=t,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),((In.prototype=Object.create(Rn.prototype)).constructor=In).prototype.isWebGLRenderTargetCube=!0,((Pn.prototype=Object.create(xn.prototype)).constructor=Pn).prototype.isDataTexture=!0,Object.assign(Dn.prototype,{isBox3:!0,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromArray:function(e){for(var t=1/0,n=1/0,r=1/0,i=-1/0,a=-1/0,o=-1/0,s=0,l=e.length;s<l;s+=3){var u=e[s],c=e[s+1],d=e[s+2];u<t&&(t=u),c<n&&(n=c),d<r&&(r=d),i<u&&(i=u),a<c&&(a=c),o<d&&(o=d)}return this.min.set(t,n,r),this.max.set(i,a,o),this},setFromBufferAttribute:function(e){for(var t=1/0,n=1/0,r=1/0,i=-1/0,a=-1/0,o=-1/0,s=0,l=e.count;s<l;s++){var u=e.getX(s),c=e.getY(s),d=e.getZ(s);u<t&&(t=u),c<n&&(n=c),d<r&&(r=d),i<u&&(i=u),a<c&&(a=c),o<d&&(o=d)}return this.min.set(t,n,r),this.max.set(i,a,o),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:(mn=new Yt,function(e,t){var n=mn.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}),setFromObject:function(e){return this.makeEmpty(),this.expandByObject(e)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(e){return void 0===e&&(console.warn("THREE.Box3: .getCenter() target is now required"),e=new Yt),this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("THREE.Box3: .getSize() target is now required"),e=new Yt),this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},expandByObject:(pn=new Yt,function(e){return dn=this,e.updateMatrixWorld(!0),e.traverse(On),this}),containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .getParameter() target is now required"),t=new Yt),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},intersectsSphere:(cn=new Yt,function(e){return this.clampPoint(e.center,cn),cn.distanceToSquared(e.center)<=e.radius*e.radius}),intersectsPlane:function(e){var t,n;return n=0<e.normal.x?(t=e.normal.x*this.min.x,e.normal.x*this.max.x):(t=e.normal.x*this.max.x,e.normal.x*this.min.x),0<e.normal.y?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),0<e.normal.z?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=e.constant&&n>=e.constant},intersectsTriangle:($t=new Yt,en=new Yt,tn=new Yt,nn=new Yt,rn=new Yt,an=new Yt,on=new Yt,sn=new Yt,ln=new Yt,un=new Yt,function(e){if(this.isEmpty())return!1;this.getCenter(sn),ln.subVectors(this.max,sn),$t.subVectors(e.a,sn),en.subVectors(e.b,sn),tn.subVectors(e.c,sn),nn.subVectors(en,$t),rn.subVectors(tn,en),an.subVectors($t,tn);var t=[0,-nn.z,nn.y,0,-rn.z,rn.y,0,-an.z,an.y,nn.z,0,-nn.x,rn.z,0,-rn.x,an.z,0,-an.x,-nn.y,nn.x,0,-rn.y,rn.x,0,-an.y,an.x,0];return!!Ln(t)&&!!Ln(t=[1,0,0,0,1,0,0,0,1])&&(un.crossVectors(nn,rn),Ln(t=[un.x,un.y,un.z]))}),clampPoint:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .clampPoint() target is now required"),t=new Yt),t.copy(e).clamp(this.min,this.max)},distanceToPoint:(Jt=new Yt,function(e){return Jt.copy(e).clamp(this.min,this.max).sub(e).length()}),getBoundingSphere:(Zt=new Yt,function(e){return void 0===e&&(console.warn("THREE.Box3: .getBoundingSphere() target is now required"),e=new Nn),this.getCenter(e.center),e.radius=.5*this.getSize(Zt).length(),e}),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:function(e){if(this.isEmpty())return this;var t=e.elements,n=t[0]*this.min.x,r=t[1]*this.min.x,i=t[2]*this.min.x,a=t[0]*this.max.x,o=t[1]*this.max.x,s=t[2]*this.max.x,l=t[4]*this.min.y,u=t[5]*this.min.y,c=t[6]*this.min.y,d=t[4]*this.max.y,h=t[5]*this.max.y,f=t[6]*this.max.y,p=t[8]*this.min.z,m=t[9]*this.min.z,g=t[10]*this.min.z,v=t[8]*this.max.z,y=t[9]*this.max.z,_=t[10]*this.max.z;return this.min.x=Math.min(n,a)+Math.min(l,d)+Math.min(p,v)+t[12],this.min.y=Math.min(r,o)+Math.min(u,h)+Math.min(m,y)+t[13],this.min.z=Math.min(i,s)+Math.min(c,f)+Math.min(g,_)+t[14],this.max.x=Math.max(n,a)+Math.max(l,d)+Math.max(p,v)+t[12],this.max.y=Math.max(r,o)+Math.max(u,h)+Math.max(m,y)+t[13],this.max.z=Math.max(i,s)+Math.max(c,f)+Math.max(g,_)+t[14],this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}),Object.assign(Nn.prototype,{set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:(gn=new Dn,function(e,t){var n=this.center;void 0!==t?n.copy(t):gn.setFromPoints(e).getCenter(n);for(var r=0,i=0,a=e.length;i<a;i++)r=Math.max(r,n.distanceToSquared(e[i]));return this.radius=Math.sqrt(r),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function(){return this.radius<=0},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius},clampPoint:function(e,t){var n=this.center.distanceToSquared(e);return void 0===t&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),t=new Yt),t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t},getBoundingBox:function(e){return void 0===e&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),e=new Dn),e.set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}}),Object.assign(kn.prototype,{set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:(bn=new Yt,En=new Yt,function(e,t,n){var r=bn.subVectors(n,t).cross(En.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return void 0===t&&(console.warn("THREE.Plane: .projectPoint() target is now required"),t=new Yt),t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},intersectLine:(_n=new Yt,function(e,t){void 0===t&&(console.warn("THREE.Plane: .intersectLine() target is now required"),t=new Yt);var n=e.delta(_n),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):void 0;var i=-(e.start.dot(this.normal)+this.constant)/r;return i<0||1<i?void 0:t.copy(n).multiplyScalar(i).add(e.start)}),intersectsLine:function(e){var t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&0<n||n<0&&0<t},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){return void 0===e&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),e=new Yt),e.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:(vn=new Yt,yn=new Kt,function(e,t){var n=t||yn.getNormalMatrix(e),r=this.coplanarPoint(vn).applyMatrix4(e),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this}),translate:function(e){return this.constant-=e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}}),Object.assign(Bn.prototype,{set:function(e,t,n,r,i,a){var o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(n),o[3].copy(r),o[4].copy(i),o[5].copy(a),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){for(var t=this.planes,n=0;n<6;n++)t[n].copy(e.planes[n]);return this},setFromMatrix:function(e){var t=this.planes,n=e.elements,r=n[0],i=n[1],a=n[2],o=n[3],s=n[4],l=n[5],u=n[6],c=n[7],d=n[8],h=n[9],f=n[10],p=n[11],m=n[12],g=n[13],v=n[14],y=n[15];return t[0].setComponents(o-r,c-s,p-d,y-m).normalize(),t[1].setComponents(o+r,c+s,p+d,y+m).normalize(),t[2].setComponents(o+i,c+l,p+h,y+g).normalize(),t[3].setComponents(o-i,c-l,p-h,y-g).normalize(),t[4].setComponents(o-a,c-u,p-f,y-v).normalize(),t[5].setComponents(o+a,c+u,p+f,y+v).normalize(),this},intersectsObject:(Sn=new Nn,function(e){var t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),Sn.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Sn)}),intersectsSprite:(wn=new Nn,function(e){return wn.center.set(0,0,0),wn.radius=.7071067811865476,wn.applyMatrix4(e.matrixWorld),this.intersectsSphere(wn)}),intersectsSphere:function(e){for(var t=this.planes,n=e.center,r=-e.radius,i=0;i<6;i++){if(t[i].distanceToPoint(n)<r)return!1}return!0},intersectsBox:(Tn=new Yt,An=new Yt,function(e){for(var t=this.planes,n=0;n<6;n++){var r=t[n];Tn.x=0<r.normal.x?e.min.x:e.max.x,An.x=0<r.normal.x?e.max.x:e.min.x,Tn.y=0<r.normal.y?e.min.y:e.max.y,An.y=0<r.normal.y?e.max.y:e.min.y,Tn.z=0<r.normal.z?e.min.z:e.max.z,An.z=0<r.normal.z?e.max.z:e.min.z;var i=r.distanceToPoint(Tn),a=r.distanceToPoint(An);if(i<0&&a<0)return!1}return!0}),containsPoint:function(e){for(var t=this.planes,n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}});var Fn,jn={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"\nvec3 transformed = vec3( position );\n",beginnormal_vertex:"\nvec3 objectNormal = vec3( normal );\n",bsdfs:"float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t}\n\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t#endif\n#endif\n",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvarying vec3 vViewPosition;\n#endif\n",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\n",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n",defaultnormal_vertex:"vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n",encodings_fragment:"  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM            = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat D      = max( maxRange / maxRGB, 1.0 );\n\tD            = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n\tXp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract(Le);\n\tvResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n\treturn vec4( max(vRGB, 0.0), 1.0 );\n}\n",envmap_fragment:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n",envmap_pars_fragment:"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n",envmap_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n",fog_vertex:"\n#ifdef USE_FOG\nfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n  varying float fogDepth;\n#endif\n",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif\n",gradientmap_pars_fragment:"#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif\n",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n",lights_pars_begin:"uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n",lights_pars_maps:"#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos - halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos + halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos + halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos - halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearCoatRadiance = vec3( 0.0 );\n#endif\n",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), maxMipLevel );\n\t#ifndef STANDARD\n\t\tclearCoatRadiance += getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), maxMipLevel );\n\t#endif\n#endif\n",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\tgl_Position.z *= gl_Position.w;\n\t#endif\n#endif\n",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n",map_particle_fragment:"#ifdef USE_MAP\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",map_particle_pars_fragment:"#ifdef USE_MAP\n\tuniform mat3 uvTransform;\n\tuniform sampler2D map;\n#endif\n",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif\n",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n",normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n#endif\n",normal_fragment_maps:"#ifdef USE_NORMALMAP\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\tvec3 N = normalize( surf_norm );\n\t\tmat3 tsn = mat3( S, T, N );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy *= normalScale;\n\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif\n",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",project_vertex:"vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n",dithering_fragment:"#if defined( DITHERING )\n  gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif\n",dithering_pars_fragment:"#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif\n",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif\n",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif\n",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",tonemapping_pars_fragment:"#ifndef saturate\n\t#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",uv_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\n",uv_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif\n",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldPosition;\nvoid main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\tgl_FragColor.a *= opacity;\n}\n",cube_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}\n",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}\n",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}\n",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}\n",equirect_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}\n",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_pars_maps>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_pars_maps>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_pars_maps>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphysical_frag:"#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars_begin>\n#include <lights_pars_maps>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphysical_vert:"#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}\n",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}\n",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}\n",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}\n",shadow_vert:"#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n"},Un={merge:function(e){for(var t={},n=0;n<e.length;n++){var r=this.clone(e[n]);for(var i in r)t[i]=r[i]}return t},clone:function(e){var t={};for(var n in e)for(var r in t[n]={},e[n]){var i=e[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture)?t[n][r]=i.clone():Array.isArray(i)?t[n][r]=i.slice():t[n][r]=i}return t}},Hn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Gn(e,t,n){return void 0===t&&void 0===n?this.set(e):this.setRGB(e,t,n)}function Vn(e,t,n){return n<0&&(n+=1),1<n&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}Object.assign(Gn.prototype,{isColor:!0,r:1,g:1,b:1,set:function(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},setScalar:function(e){return this.r=e,this.g=e,this.b=e,this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this},setRGB:function(e,t,n){return this.r=e,this.g=t,this.b=n,this},setHSL:function(e,t,n){if(e=Vt.euclideanModulo(e,1),t=Vt.clamp(t,0,1),n=Vt.clamp(n,0,1),0===t)this.r=this.g=this.b=n;else{var r=n<=.5?n*(1+t):n+t-n*t,i=2*n-r;this.r=Vn(i,r,e+1/3),this.g=Vn(i,r,e),this.b=Vn(i,r,e-1/3)}return this},setStyle:function(t){function e(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var r,i=n[1],a=n[2];switch(i){case"rgb":case"rgba":if(r=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,e(r[5]),this;if(r=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,e(r[5]),this;break;case"hsl":case"hsla":if(r=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a)){var o=parseFloat(r[1])/360,s=parseInt(r[2],10)/100,l=parseInt(r[3],10)/100;return e(r[5]),this.setHSL(o,s,l)}}}else if(n=/^\#([A-Fa-f0-9]+)$/.exec(t)){var u,c=(u=n[1]).length;if(3===c)return this.r=parseInt(u.charAt(0)+u.charAt(0),16)/255,this.g=parseInt(u.charAt(1)+u.charAt(1),16)/255,this.b=parseInt(u.charAt(2)+u.charAt(2),16)/255,this;if(6===c)return this.r=parseInt(u.charAt(0)+u.charAt(1),16)/255,this.g=parseInt(u.charAt(2)+u.charAt(3),16)/255,this.b=parseInt(u.charAt(4)+u.charAt(5),16)/255,this}t&&0<t.length&&(void 0!==(u=Hn[t])?this.setHex(u):console.warn("THREE.Color: Unknown color "+t));return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,t){return void 0===t&&(t=2),this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},copyLinearToGamma:function(e,t){void 0===t&&(t=2);var n=0<t?1/t:1;return this.r=Math.pow(e.r,n),this.g=Math.pow(e.g,n),this.b=Math.pow(e.b,n),this},convertGammaToLinear:function(e){return this.copyGammaToLinear(this,e),this},convertLinearToGamma:function(e){return this.copyLinearToGamma(this,e),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){void 0===e&&(console.warn("THREE.Color: .getHSL() target is now required"),e={h:0,s:0,l:0});var t,n,r=this.r,i=this.g,a=this.b,o=Math.max(r,i,a),s=Math.min(r,i,a),l=(s+o)/2;if(s===o)n=t=0;else{var u=o-s;switch(n=l<=.5?u/(o+s):u/(2-o-s),o){case r:t=(i-a)/u+(i<a?6:0);break;case i:t=(a-r)/u+2;break;case a:t=(r-i)/u+4}t/=6}return e.h=t,e.s=n,e.l=l,e},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:(Fn={},function(e,t,n){return this.getHSL(Fn),Fn.h+=e,Fn.s+=t,Fn.l+=n,this.setHSL(Fn.h,Fn.s,Fn.l),this}),add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},sub:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e,t){return void 0===t&&(t=0),this.r=e[t],this.g=e[t+1],this.b=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e},toJSON:function(){return this.getHex()}});var zn,Wn,qn={common:{diffuse:{value:new Gn(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Kt},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new zt(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Gn(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new Gn(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new Kt}}},Yn={basic:{uniforms:Un.merge([qn.common,qn.specularmap,qn.envmap,qn.aomap,qn.lightmap,qn.fog]),vertexShader:jn.meshbasic_vert,fragmentShader:jn.meshbasic_frag},lambert:{uniforms:Un.merge([qn.common,qn.specularmap,qn.envmap,qn.aomap,qn.lightmap,qn.emissivemap,qn.fog,qn.lights,{emissive:{value:new Gn(0)}}]),vertexShader:jn.meshlambert_vert,fragmentShader:jn.meshlambert_frag},phong:{uniforms:Un.merge([qn.common,qn.specularmap,qn.envmap,qn.aomap,qn.lightmap,qn.emissivemap,qn.bumpmap,qn.normalmap,qn.displacementmap,qn.gradientmap,qn.fog,qn.lights,{emissive:{value:new Gn(0)},specular:{value:new Gn(1118481)},shininess:{value:30}}]),vertexShader:jn.meshphong_vert,fragmentShader:jn.meshphong_frag},standard:{uniforms:Un.merge([qn.common,qn.envmap,qn.aomap,qn.lightmap,qn.emissivemap,qn.bumpmap,qn.normalmap,qn.displacementmap,qn.roughnessmap,qn.metalnessmap,qn.fog,qn.lights,{emissive:{value:new Gn(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:jn.meshphysical_vert,fragmentShader:jn.meshphysical_frag},points:{uniforms:Un.merge([qn.points,qn.fog]),vertexShader:jn.points_vert,fragmentShader:jn.points_frag},dashed:{uniforms:Un.merge([qn.common,qn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:jn.linedashed_vert,fragmentShader:jn.linedashed_frag},depth:{uniforms:Un.merge([qn.common,qn.displacementmap]),vertexShader:jn.depth_vert,fragmentShader:jn.depth_frag},normal:{uniforms:Un.merge([qn.common,qn.bumpmap,qn.normalmap,qn.displacementmap,{opacity:{value:1}}]),vertexShader:jn.normal_vert,fragmentShader:jn.normal_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:jn.cube_vert,fragmentShader:jn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:jn.equirect_vert,fragmentShader:jn.equirect_frag},distanceRGBA:{uniforms:Un.merge([qn.common,qn.displacementmap,{referencePosition:{value:new Yt},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:jn.distanceRGBA_vert,fragmentShader:jn.distanceRGBA_frag},shadow:{uniforms:Un.merge([qn.lights,qn.fog,{color:{value:new Gn(0)},opacity:{value:1}}]),vertexShader:jn.shadow_vert,fragmentShader:jn.shadow_frag}};function Kn(){var n=null,r=!1,i=null;function a(e,t){!1!==r&&(i(e,t),n.requestAnimationFrame(a))}return{start:function(){!0!==r&&null!==i&&(n.requestAnimationFrame(a),r=!0)},stop:function(){r=!1},setAnimationLoop:function(e){i=e},setContext:function(e){n=e}}}function Xn(o){var r=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),r.get(e)},remove:function(e){e.isInterleavedBufferAttribute&&(e=e.data);var t=r.get(e);t&&(o.deleteBuffer(t.buffer),r.delete(e))},update:function(e,t){e.isInterleavedBufferAttribute&&(e=e.data);var n=r.get(e);void 0===n?r.set(e,function(e,t){var n=e.array,r=e.dynamic?o.DYNAMIC_DRAW:o.STATIC_DRAW,i=o.createBuffer();o.bindBuffer(t,i),o.bufferData(t,n,r),e.onUploadCallback();var a=o.FLOAT;return n instanceof Float32Array?a=o.FLOAT:n instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):n instanceof Uint16Array?a=o.UNSIGNED_SHORT:n instanceof Int16Array?a=o.SHORT:n instanceof Uint32Array?a=o.UNSIGNED_INT:n instanceof Int32Array?a=o.INT:n instanceof Int8Array?a=o.BYTE:n instanceof Uint8Array&&(a=o.UNSIGNED_BYTE),{buffer:i,type:a,bytesPerElement:n.BYTES_PER_ELEMENT,version:e.version}}(e,t)):n.version<e.version&&(function(e,t,n){var r=t.array,i=t.updateRange;o.bindBuffer(n,e),!1===t.dynamic?o.bufferData(n,r,o.STATIC_DRAW):-1===i.count?o.bufferSubData(n,0,r):0===i.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(o.bufferSubData(n,i.offset*r.BYTES_PER_ELEMENT,r.subarray(i.offset,i.offset+i.count)),i.count=-1)}(n.buffer,e,t),n.version=e.version)}}}function Qn(e,t,n,r){this._x=e||0,this._y=t||0,this._z=n||0,this._order=r||Qn.DefaultOrder}function Zn(){this.mask=1}Yn.physical={uniforms:Un.merge([Yn.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:jn.meshphysical_vert,fragmentShader:jn.meshphysical_frag},Qn.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],Qn.DefaultOrder="XYZ",Object.defineProperties(Qn.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e,this.onChangeCallback()}}}),Object.assign(Qn.prototype,{isEuler:!0,set:function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._order=r||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this.onChangeCallback(),this},setFromRotationMatrix:function(e,t,n){var r=Vt.clamp,i=e.elements,a=i[0],o=i[4],s=i[8],l=i[1],u=i[5],c=i[9],d=i[2],h=i[6],f=i[10];return"XYZ"===(t=t||this._order)?(this._y=Math.asin(r(s,-1,1)),Math.abs(s)<.99999?(this._x=Math.atan2(-c,f),this._z=Math.atan2(-o,a)):(this._x=Math.atan2(h,u),this._z=0)):"YXZ"===t?(this._x=Math.asin(-r(c,-1,1)),Math.abs(c)<.99999?(this._y=Math.atan2(s,f),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-d,a),this._z=0)):"ZXY"===t?(this._x=Math.asin(r(h,-1,1)),Math.abs(h)<.99999?(this._y=Math.atan2(-d,f),this._z=Math.atan2(-o,u)):(this._y=0,this._z=Math.atan2(l,a))):"ZYX"===t?(this._y=Math.asin(-r(d,-1,1)),Math.abs(d)<.99999?(this._x=Math.atan2(h,f),this._z=Math.atan2(l,a)):(this._x=0,this._z=Math.atan2(-o,u))):"YZX"===t?(this._z=Math.asin(r(l,-1,1)),Math.abs(l)<.99999?(this._x=Math.atan2(-c,u),this._y=Math.atan2(-d,a)):(this._x=0,this._y=Math.atan2(s,f))):"XZY"===t?(this._z=Math.asin(-r(o,-1,1)),Math.abs(o)<.99999?(this._x=Math.atan2(h,u),this._y=Math.atan2(s,a)):(this._x=Math.atan2(-c,f),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+t),this._order=t,!1!==n&&this.onChangeCallback(),this},setFromQuaternion:(Wn=new Wt,function(e,t,n){return Wn.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Wn,t,n)}),setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:(zn=new qt,function(e){return zn.setFromEuler(this),this.setFromQuaternion(zn,e)}),equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new Yt(this._x,this._y,this._z)},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}}),Object.assign(Zn.prototype,{set:function(e){this.mask=1<<e|0},enable:function(e){this.mask|=1<<e|0},toggle:function(e){this.mask^=1<<e|0},disable:function(e){this.mask&=~(1<<e|0)},test:function(e){return 0!=(this.mask&e.mask)}});var Jn,$n,er,tr,nr,rr,ir,ar,or,sr,lr,ur,cr,dr,hr,fr,pr,mr,gr=0;function vr(){Object.defineProperty(this,"id",{value:gr++}),this.uuid=Vt.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=vr.DefaultUp.clone();var e=new Yt,t=new Qn,n=new qt,r=new Yt(1,1,1);t.onChange(function(){n.setFromEuler(t,!1)}),n.onChange(function(){t.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{enumerable:!0,value:e},rotation:{enumerable:!0,value:t},quaternion:{enumerable:!0,value:n},scale:{enumerable:!0,value:r},modelViewMatrix:{value:new Wt},normalMatrix:{value:new Kt}}),this.matrix=new Wt,this.matrixWorld=new Wt,this.matrixAutoUpdate=vr.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Zn,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function yr(){vr.call(this),this.type="Camera",this.matrixWorldInverse=new Wt,this.projectionMatrix=new Wt}function _r(e,t,n,r,i,a){yr.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=void 0!==i?i:.1,this.far=void 0!==a?a:2e3,this.updateProjectionMatrix()}function br(e,t,n,r,i,a){this.a=e,this.b=t,this.c=n,this.normal=r&&r.isVector3?r:new Yt,this.vertexNormals=Array.isArray(r)?r:[],this.color=i&&i.isColor?i:new Gn,this.vertexColors=Array.isArray(i)?i:[],this.materialIndex=void 0!==a?a:0}vr.DefaultUp=new Yt(0,1,0),vr.DefaultMatrixAutoUpdate=!0,vr.prototype=Object.assign(Object.create(i.prototype),{constructor:vr,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(e){this.matrix.multiplyMatrices(e,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:(pr=new qt,function(e,t){return pr.setFromAxisAngle(e,t),this.quaternion.multiply(pr),this}),rotateOnWorldAxis:(fr=new qt,function(e,t){return fr.setFromAxisAngle(e,t),this.quaternion.premultiply(fr),this}),rotateX:(hr=new Yt(1,0,0),function(e){return this.rotateOnAxis(hr,e)}),rotateY:(dr=new Yt(0,1,0),function(e){return this.rotateOnAxis(dr,e)}),rotateZ:(cr=new Yt(0,0,1),function(e){return this.rotateOnAxis(cr,e)}),translateOnAxis:(ur=new Yt,function(e,t){return ur.copy(e).applyQuaternion(this.quaternion),this.position.add(ur.multiplyScalar(t)),this}),translateX:(lr=new Yt(1,0,0),function(e){return this.translateOnAxis(lr,e)}),translateY:(sr=new Yt(0,1,0),function(e){return this.translateOnAxis(sr,e)}),translateZ:(or=new Yt(0,0,1),function(e){return this.translateOnAxis(or,e)}),localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:(ar=new Wt,function(e){return e.applyMatrix4(ar.getInverse(this.matrixWorld))}),lookAt:(rr=new Wt,ir=new Yt,function(e,t,n){e.isVector3?ir.copy(e):ir.set(e,t,n),this.isCamera?rr.lookAt(this.position,ir,this.up):rr.lookAt(ir,this.position,this.up),this.quaternion.setFromRotationMatrix(rr)}),add:function(e){if(1<arguments.length){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?console.error("THREE.Object3D.add: object can't be added as a child of itself.",e):e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,e.dispatchEvent({type:"added"}),this.children.push(e)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this},remove:function(e){if(1<arguments.length){for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}var n=this.children.indexOf(e);return-1!==n&&(e.parent=null,e.dispatchEvent({type:"removed"}),this.children.splice(n,1)),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var n=0,r=this.children.length;n<r;n++){var i=this.children[n].getObjectByProperty(e,t);if(void 0!==i)return i}},getWorldPosition:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),e=new Yt),this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:(tr=new Yt,nr=new Yt,function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),e=new qt),this.updateMatrixWorld(!0),this.matrixWorld.decompose(tr,e,nr),e}),getWorldScale:($n=new Yt,er=new qt,function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),e=new Yt),this.updateMatrixWorld(!0),this.matrixWorld.decompose($n,er,e),e}),getWorldDirection:(Jn=new qt,function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new Yt),this.getWorldQuaternion(Jn),e.set(0,0,1).applyQuaternion(Jn)}),raycast:function(){},traverse:function(e){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverse(e)},traverseVisible:function(e){if(!1!==this.visible){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}},traverseAncestors:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),e=!(this.matrixWorldNeedsUpdate=!1));for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)},toJSON:function(n){var e=void 0===n||"string"==typeof n,t={};e&&(n={geometries:{},materials:{},textures:{},images:{},shapes:{}},t.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var r={};function i(e,t){return void 0===e[t.uuid]&&(e[t.uuid]=t.toJSON(n)),t.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),void 0!==this.geometry){r.geometry=i(n.geometries,this.geometry);var a=this.geometry.parameters;if(void 0!==a&&void 0!==a.shapes){var o=a.shapes;if(Array.isArray(o))for(var s=0,l=o.length;s<l;s++){var u=o[s];i(n.shapes,u)}else i(n.shapes,o)}}if(void 0!==this.material)if(Array.isArray(this.material)){var c=[];for(s=0,l=this.material.length;s<l;s++)c.push(i(n.materials,this.material[s]));r.material=c}else r.material=i(n.materials,this.material);if(0<this.children.length){r.children=[];for(s=0;s<this.children.length;s++)r.children.push(this.children[s].toJSON(n).object)}if(e){var d=m(n.geometries),h=m(n.materials),f=m(n.textures),p=m(n.images);o=m(n.shapes);0<d.length&&(t.geometries=d),0<h.length&&(t.materials=h),0<f.length&&(t.textures=f),0<p.length&&(t.images=p),0<o.length&&(t.shapes=o)}return t.object=r,t;function m(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}},clone:function(e){return(new this.constructor).copy(this,e)},copy:function(e,t){if(void 0===t&&(t=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(var n=0;n<e.children.length;n++){var r=e.children[n];this.add(r.clone())}return this}}),yr.prototype=Object.assign(Object.create(vr.prototype),{constructor:yr,isCamera:!0,copy:function(e,t){return vr.prototype.copy.call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this},getWorldDirection:(mr=new qt,function(e){return void 0===e&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new Yt),this.getWorldQuaternion(mr),e.set(0,0,-1).applyQuaternion(mr)}),updateMatrixWorld:function(e){vr.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),_r.prototype=Object.assign(Object.create(yr.prototype),{constructor:_r,isOrthographicCamera:!0,copy:function(e,t){return yr.prototype.copy.call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this},setViewOffset:function(e,t,n,r,i,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,i=n-e,a=n+e,o=r+t,s=r-t;if(null!==this.view&&this.view.enabled){var l=this.zoom/(this.view.width/this.view.fullWidth),u=this.zoom/(this.view.height/this.view.fullHeight),c=(this.right-this.left)/this.view.width,d=(this.top-this.bottom)/this.view.height;a=(i+=c*(this.view.offsetX/l))+c*(this.view.width/l),s=(o-=d*(this.view.offsetY/u))-d*(this.view.height/u)}this.projectionMatrix.makeOrthographic(i,a,o,s,this.near,this.far)},toJSON:function(e){var t=vr.prototype.toJSON.call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}),Object.assign(br.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(var t=0,n=e.vertexNormals.length;t<n;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(t=0,n=e.vertexColors.length;t<n;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}});var Er,Tr,Ar,wr,Sr,Cr,xr,Mr=0;function Rr(){Object.defineProperty(this,"id",{value:Mr+=2}),this.uuid=Vt.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}function Ir(e,t,n){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===n,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function Pr(e,t,n){Ir.call(this,new Int8Array(e),t,n)}function Dr(e,t,n){Ir.call(this,new Uint8Array(e),t,n)}function Lr(e,t,n){Ir.call(this,new Uint8ClampedArray(e),t,n)}function Or(e,t,n){Ir.call(this,new Int16Array(e),t,n)}function Nr(e,t,n){Ir.call(this,new Uint16Array(e),t,n)}function kr(e,t,n){Ir.call(this,new Int32Array(e),t,n)}function Br(e,t,n){Ir.call(this,new Uint32Array(e),t,n)}function Fr(e,t,n){Ir.call(this,new Float32Array(e),t,n)}function jr(e,t,n){Ir.call(this,new Float64Array(e),t,n)}function Ur(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function Hr(e){if(0===e.length)return-1/0;for(var t=e[0],n=1,r=e.length;n<r;++n)e[n]>t&&(t=e[n]);return t}Rr.prototype=Object.assign(Object.create(i.prototype),{constructor:Rr,isGeometry:!0,applyMatrix:function(e){for(var t=(new Kt).getNormalMatrix(e),n=0,r=this.vertices.length;n<r;n++){this.vertices[n].applyMatrix4(e)}for(n=0,r=this.faces.length;n<r;n++){var i=this.faces[n];i.normal.applyMatrix3(t).normalize();for(var a=0,o=i.vertexNormals.length;a<o;a++)i.vertexNormals[a].applyMatrix3(t).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:(xr=new Wt,function(e){return xr.makeRotationX(e),this.applyMatrix(xr),this}),rotateY:(Cr=new Wt,function(e){return Cr.makeRotationY(e),this.applyMatrix(Cr),this}),rotateZ:(Sr=new Wt,function(e){return Sr.makeRotationZ(e),this.applyMatrix(Sr),this}),translate:(wr=new Wt,function(e,t,n){return wr.makeTranslation(e,t,n),this.applyMatrix(wr),this}),scale:(Ar=new Wt,function(e,t,n){return Ar.makeScale(e,t,n),this.applyMatrix(Ar),this}),lookAt:(Tr=new vr,function(e){Tr.lookAt(e),Tr.updateMatrix(),this.applyMatrix(Tr.matrix)}),fromBufferGeometry:function(e){var a=this,t=null!==e.index?e.index.array:void 0,n=e.attributes,r=n.position.array,o=void 0!==n.normal?n.normal.array:void 0,s=void 0!==n.color?n.color.array:void 0,l=void 0!==n.uv?n.uv.array:void 0,u=void 0!==n.uv2?n.uv2.array:void 0;void 0!==u&&(this.faceVertexUvs[1]=[]);for(var c=[],d=[],h=[],i=0,f=0;i<r.length;i+=3,f+=2)a.vertices.push(new Yt(r[i],r[i+1],r[i+2])),void 0!==o&&c.push(new Yt(o[i],o[i+1],o[i+2])),void 0!==s&&a.colors.push(new Gn(s[i],s[i+1],s[i+2])),void 0!==l&&d.push(new zt(l[f],l[f+1])),void 0!==u&&h.push(new zt(u[f],u[f+1]));function p(e,t,n,r){var i=new br(e,t,n,void 0!==o?[c[e].clone(),c[t].clone(),c[n].clone()]:[],void 0!==s?[a.colors[e].clone(),a.colors[t].clone(),a.colors[n].clone()]:[],r);a.faces.push(i),void 0!==l&&a.faceVertexUvs[0].push([d[e].clone(),d[t].clone(),d[n].clone()]),void 0!==u&&a.faceVertexUvs[1].push([h[e].clone(),h[t].clone(),h[n].clone()])}var m=e.groups;if(0<m.length)for(i=0;i<m.length;i++)for(var g=m[i],v=g.start,y=(f=v,v+g.count);f<y;f+=3)void 0!==t?p(t[f],t[f+1],t[f+2],g.materialIndex):p(f,f+1,f+2,g.materialIndex);else if(void 0!==t)for(i=0;i<t.length;i+=3)p(t[i],t[i+1],t[i+2]);else for(i=0;i<r.length/3;i+=3)p(i,i+1,i+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this},center:(Er=new Yt,function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Er).negate(),this.translate(Er.x,Er.y,Er.z),this}),normalize:function(){this.computeBoundingSphere();var e=this.boundingSphere.center,t=this.boundingSphere.radius,n=0===t?1:1/t,r=new Wt;return r.set(n,0,0,-n*e.x,0,n,0,-n*e.y,0,0,n,-n*e.z,0,0,0,1),this.applyMatrix(r),this},computeFaceNormals:function(){for(var e=new Yt,t=new Yt,n=0,r=this.faces.length;n<r;n++){var i=this.faces[n],a=this.vertices[i.a],o=this.vertices[i.b],s=this.vertices[i.c];e.subVectors(s,o),t.subVectors(a,o),e.cross(t),e.normalize(),i.normal.copy(e)}},computeVertexNormals:function(e){var t,n,r,i,a,o;for(void 0===e&&(e=!0),o=new Array(this.vertices.length),t=0,n=this.vertices.length;t<n;t++)o[t]=new Yt;if(e){var s,l,u,c=new Yt,d=new Yt;for(r=0,i=this.faces.length;r<i;r++)a=this.faces[r],s=this.vertices[a.a],l=this.vertices[a.b],u=this.vertices[a.c],c.subVectors(u,l),d.subVectors(s,l),c.cross(d),o[a.a].add(c),o[a.b].add(c),o[a.c].add(c)}else for(this.computeFaceNormals(),r=0,i=this.faces.length;r<i;r++)o[(a=this.faces[r]).a].add(a.normal),o[a.b].add(a.normal),o[a.c].add(a.normal);for(t=0,n=this.vertices.length;t<n;t++)o[t].normalize();for(r=0,i=this.faces.length;r<i;r++){var h=(a=this.faces[r]).vertexNormals;3===h.length?(h[0].copy(o[a.a]),h[1].copy(o[a.b]),h[2].copy(o[a.c])):(h[0]=o[a.a].clone(),h[1]=o[a.b].clone(),h[2]=o[a.c].clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var e,t,n;for(this.computeFaceNormals(),e=0,t=this.faces.length;e<t;e++){var r=(n=this.faces[e]).vertexNormals;3===r.length?(r[0].copy(n.normal),r[1].copy(n.normal),r[2].copy(n.normal)):(r[0]=n.normal.clone(),r[1]=n.normal.clone(),r[2]=n.normal.clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var e,t,n,r,i;for(n=0,r=this.faces.length;n<r;n++)for((i=this.faces[n]).__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]),e=0,t=i.vertexNormals.length;e<t;e++)i.__originalVertexNormals[e]?i.__originalVertexNormals[e].copy(i.vertexNormals[e]):i.__originalVertexNormals[e]=i.vertexNormals[e].clone();var a=new Rr;for(a.faces=this.faces,e=0,t=this.morphTargets.length;e<t;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];var o=this.morphNormals[e].faceNormals,s=this.morphNormals[e].vertexNormals;for(n=0,r=this.faces.length;n<r;n++)l=new Yt,u={a:new Yt,b:new Yt,c:new Yt},o.push(l),s.push(u)}var l,u,c=this.morphNormals[e];for(a.vertices=this.morphTargets[e].vertices,a.computeFaceNormals(),a.computeVertexNormals(),n=0,r=this.faces.length;n<r;n++)i=this.faces[n],l=c.faceNormals[n],u=c.vertexNormals[n],l.copy(i.normal),u.a.copy(i.vertexNormals[0]),u.b.copy(i.vertexNormals[1]),u.c.copy(i.vertexNormals[2])}for(n=0,r=this.faces.length;n<r;n++)(i=this.faces[n]).normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Dn),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Nn),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,n){if(e&&e.isGeometry){var r,i=this.vertices.length,a=this.vertices,o=e.vertices,s=this.faces,l=e.faces,u=this.faceVertexUvs[0],c=e.faceVertexUvs[0],d=this.colors,h=e.colors;void 0===n&&(n=0),void 0!==t&&(r=(new Kt).getNormalMatrix(t));for(var f=0,p=o.length;f<p;f++){var m=o[f].clone();void 0!==t&&m.applyMatrix4(t),a.push(m)}for(f=0,p=h.length;f<p;f++)d.push(h[f].clone());for(f=0,p=l.length;f<p;f++){var g,v,y,_=l[f],b=_.vertexNormals,E=_.vertexColors;(g=new br(_.a+i,_.b+i,_.c+i)).normal.copy(_.normal),void 0!==r&&g.normal.applyMatrix3(r).normalize();for(var T=0,A=b.length;T<A;T++)v=b[T].clone(),void 0!==r&&v.applyMatrix3(r).normalize(),g.vertexNormals.push(v);g.color.copy(_.color);for(T=0,A=E.length;T<A;T++)y=E[T],g.vertexColors.push(y.clone());g.materialIndex=_.materialIndex+n,s.push(g)}for(f=0,p=c.length;f<p;f++){var w=c[f],S=[];if(void 0!==w){for(T=0,A=w.length;T<A;T++)S.push(w[T].clone());u.push(S)}}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e)},mergeMesh:function(e){e&&e.isMesh?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e)},mergeVertices:function(){var e,t,n,r,i,a,o,s,l={},u=[],c=[],d=Math.pow(10,4);for(n=0,r=this.vertices.length;n<r;n++)e=this.vertices[n],void 0===l[t=Math.round(e.x*d)+"_"+Math.round(e.y*d)+"_"+Math.round(e.z*d)]?(l[t]=n,u.push(this.vertices[n]),c[n]=u.length-1):c[n]=c[l[t]];var h=[];for(n=0,r=this.faces.length;n<r;n++){(i=this.faces[n]).a=c[i.a],i.b=c[i.b],i.c=c[i.c],a=[i.a,i.b,i.c];for(var f=0;f<3;f++)if(a[f]===a[(f+1)%3]){h.push(n);break}}for(n=h.length-1;0<=n;n--){var p=h[n];for(this.faces.splice(p,1),o=0,s=this.faceVertexUvs.length;o<s;o++)this.faceVertexUvs[o].splice(p,1)}var m=this.vertices.length-u.length;return this.vertices=u,m},setFromPoints:function(e){this.vertices=[];for(var t=0,n=e.length;t<n;t++){var r=e[t];this.vertices.push(new Yt(r.x,r.y,r.z||0))}return this},sortFacesByMaterialIndex:function(){for(var e=this.faces,t=e.length,n=0;n<t;n++)e[n]._id=n;e.sort(function(e,t){return e.materialIndex-t.materialIndex});var r,i,a=this.faceVertexUvs[0],o=this.faceVertexUvs[1];a&&a.length===t&&(r=[]),o&&o.length===t&&(i=[]);for(n=0;n<t;n++){var s=e[n]._id;r&&r.push(a[s]),i&&i.push(o[s])}r&&(this.faceVertexUvs[0]=r),i&&(this.faceVertexUvs[1]=i)},toJSON:function(){var e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){var t=this.parameters;for(var n in t)void 0!==t[n]&&(e[n]=t[n]);return e}for(var r=[],i=0;i<this.vertices.length;i++){var a=this.vertices[i];r.push(a.x,a.y,a.z)}var o=[],s=[],l={},u=[],c={},d=[],h={};for(i=0;i<this.faces.length;i++){var f=this.faces[i],p=void 0!==this.faceVertexUvs[0][i],m=0<f.normal.length(),g=0<f.vertexNormals.length,v=1!==f.color.r||1!==f.color.g||1!==f.color.b,y=0<f.vertexColors.length,_=0;if(_=A(_,0,0),_=A(_,1,!0),_=A(_,2,!1),_=A(_,3,p),_=A(_,4,m),_=A(_,5,g),_=A(_,6,v),_=A(_,7,y),o.push(_),o.push(f.a,f.b,f.c),o.push(f.materialIndex),p){var b=this.faceVertexUvs[0][i];o.push(C(b[0]),C(b[1]),C(b[2]))}if(m&&o.push(w(f.normal)),g){var E=f.vertexNormals;o.push(w(E[0]),w(E[1]),w(E[2]))}if(v&&o.push(S(f.color)),y){var T=f.vertexColors;o.push(S(T[0]),S(T[1]),S(T[2]))}}function A(e,t,n){return n?e|1<<t:e&~(1<<t)}function w(e){var t=e.x.toString()+e.y.toString()+e.z.toString();return void 0!==l[t]||(l[t]=s.length/3,s.push(e.x,e.y,e.z)),l[t]}function S(e){var t=e.r.toString()+e.g.toString()+e.b.toString();return void 0!==c[t]||(c[t]=u.length,u.push(e.getHex())),c[t]}function C(e){var t=e.x.toString()+e.y.toString();return void 0!==h[t]||(h[t]=d.length/2,d.push(e.x,e.y)),h[t]}return e.data={},e.data.vertices=r,e.data.normals=s,0<u.length&&(e.data.colors=u),0<d.length&&(e.data.uvs=[d]),e.data.faces=o,e},clone:function(){return(new Rr).copy(this)},copy:function(e){var t,n,r,i,a,o;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var s=e.vertices;for(t=0,n=s.length;t<n;t++)this.vertices.push(s[t].clone());var l=e.colors;for(t=0,n=l.length;t<n;t++)this.colors.push(l[t].clone());var u=e.faces;for(t=0,n=u.length;t<n;t++)this.faces.push(u[t].clone());for(t=0,n=e.faceVertexUvs.length;t<n;t++){var c=e.faceVertexUvs[t];for(void 0===this.faceVertexUvs[t]&&(this.faceVertexUvs[t]=[]),r=0,i=c.length;r<i;r++){var d=c[r],h=[];for(a=0,o=d.length;a<o;a++){var f=d[a];h.push(f.clone())}this.faceVertexUvs[t].push(h)}}var p=e.morphTargets;for(t=0,n=p.length;t<n;t++){var m={};if(m.name=p[t].name,void 0!==p[t].vertices)for(m.vertices=[],r=0,i=p[t].vertices.length;r<i;r++)m.vertices.push(p[t].vertices[r].clone());if(void 0!==p[t].normals)for(m.normals=[],r=0,i=p[t].normals.length;r<i;r++)m.normals.push(p[t].normals[r].clone());this.morphTargets.push(m)}var g=e.morphNormals;for(t=0,n=g.length;t<n;t++){var v={};if(void 0!==g[t].vertexNormals)for(v.vertexNormals=[],r=0,i=g[t].vertexNormals.length;r<i;r++){var y=g[t].vertexNormals[r],_={};_.a=y.a.clone(),_.b=y.b.clone(),_.c=y.c.clone(),v.vertexNormals.push(_)}if(void 0!==g[t].faceNormals)for(v.faceNormals=[],r=0,i=g[t].faceNormals.length;r<i;r++)v.faceNormals.push(g[t].faceNormals[r].clone());this.morphNormals.push(v)}var b=e.skinWeights;for(t=0,n=b.length;t<n;t++)this.skinWeights.push(b[t].clone());var E=e.skinIndices;for(t=0,n=E.length;t<n;t++)this.skinIndices.push(E[t].clone());var T=e.lineDistances;for(t=0,n=T.length;t<n;t++)this.lineDistances.push(T[t]);var A=e.boundingBox;null!==A&&(this.boundingBox=A.clone());var w=e.boundingSphere;return null!==w&&(this.boundingSphere=w.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(Ir.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(Ir.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setArray:function(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");return this.count=void 0!==e?e.length/this.itemSize:0,this.array=e,this},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.dynamic=e.dynamic,this},copyAt:function(e,t,n){e*=this.itemSize,n*=t.itemSize;for(var r=0,i=this.itemSize;r<i;r++)this.array[e+r]=t.array[n+r];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var a=e[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),a=new Gn),t[n++]=a.r,t[n++]=a.g,t[n++]=a.b}return this},copyVector2sArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var a=e[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),a=new zt),t[n++]=a.x,t[n++]=a.y}return this},copyVector3sArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var a=e[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),a=new Yt),t[n++]=a.x,t[n++]=a.y,t[n++]=a.z}return this},copyVector4sArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var a=e[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),a=new Mn),t[n++]=a.x,t[n++]=a.y,t[n++]=a.z,t[n++]=a.w}return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this},setXYZ:function(e,t,n,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this},setXYZW:function(e,t,n,r,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=i,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}}),(Pr.prototype=Object.create(Ir.prototype)).constructor=Pr,(Dr.prototype=Object.create(Ir.prototype)).constructor=Dr,(Lr.prototype=Object.create(Ir.prototype)).constructor=Lr,(Or.prototype=Object.create(Ir.prototype)).constructor=Or,(Nr.prototype=Object.create(Ir.prototype)).constructor=Nr,(kr.prototype=Object.create(Ir.prototype)).constructor=kr,(Br.prototype=Object.create(Ir.prototype)).constructor=Br,(Fr.prototype=Object.create(Ir.prototype)).constructor=Fr,(jr.prototype=Object.create(Ir.prototype)).constructor=jr,Object.assign(Ur.prototype,{computeGroups:function(e){for(var t,n=[],r=void 0,i=e.faces,a=0;a<i.length;a++){var o=i[a];o.materialIndex!==r&&(r=o.materialIndex,void 0!==t&&(t.count=3*a-t.start,n.push(t)),t={start:3*a,materialIndex:r})}void 0!==t&&(t.count=3*a-t.start,n.push(t)),this.groups=n},fromGeometry:function(e){var t,n=e.faces,r=e.vertices,i=e.faceVertexUvs,a=i[0]&&0<i[0].length,o=i[1]&&0<i[1].length,s=e.morphTargets,l=s.length;if(0<l){t=[];for(var u=0;u<l;u++)t[u]=[];this.morphTargets.position=t}var c,d=e.morphNormals,h=d.length;if(0<h){c=[];for(u=0;u<h;u++)c[u]=[];this.morphTargets.normal=c}var f=e.skinIndices,p=e.skinWeights,m=f.length===r.length,g=p.length===r.length;0===n.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(u=0;u<n.length;u++){var v=n[u];this.vertices.push(r[v.a],r[v.b],r[v.c]);var y=v.vertexNormals;if(3===y.length)this.normals.push(y[0],y[1],y[2]);else{var _=v.normal;this.normals.push(_,_,_)}var b,E=v.vertexColors;if(3===E.length)this.colors.push(E[0],E[1],E[2]);else{var T=v.color;this.colors.push(T,T,T)}if(!0===a)void 0!==(b=i[0][u])?this.uvs.push(b[0],b[1],b[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",u),this.uvs.push(new zt,new zt,new zt));if(!0===o)void 0!==(b=i[1][u])?this.uvs2.push(b[0],b[1],b[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",u),this.uvs2.push(new zt,new zt,new zt));for(var A=0;A<l;A++){var w=s[A].vertices;t[A].push(w[v.a],w[v.b],w[v.c])}for(A=0;A<h;A++){var S=d[A].vertexNormals[u];c[A].push(S.a,S.b,S.c)}m&&this.skinIndices.push(f[v.a],f[v.b],f[v.c]),g&&this.skinWeights.push(p[v.a],p[v.b],p[v.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this}});var Gr,Vr,zr,Wr,qr,Yr,Kr,Xr,Qr,Zr,Jr=1;function $r(){Object.defineProperty(this,"id",{value:Jr+=2}),this.uuid=Vt.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}function ei(e,t,n,r,i,a){Rr.call(this),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:i,depthSegments:a},this.fromBufferGeometry(new ti(e,t,n,r,i,a)),this.mergeVertices()}function ti(e,t,n,r,i,a){$r.call(this),this.type="BoxBufferGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:i,depthSegments:a};var R=this;e=e||1,t=t||1,n=n||1,r=Math.floor(r)||1,i=Math.floor(i)||1,a=Math.floor(a)||1;var I=[],P=[],D=[],L=[],O=0,N=0;function o(e,t,n,r,i,a,o,s,l,u,c){var d,h,f=a/l,p=o/u,m=a/2,g=o/2,v=s/2,y=l+1,_=u+1,b=0,E=0,T=new Yt;for(h=0;h<_;h++){var A=h*p-g;for(d=0;d<y;d++){var w=d*f-m;T[e]=w*r,T[t]=A*i,T[n]=v,P.push(T.x,T.y,T.z),T[e]=0,T[t]=0,T[n]=0<s?1:-1,D.push(T.x,T.y,T.z),L.push(d/l),L.push(1-h/u),b+=1}}for(h=0;h<u;h++)for(d=0;d<l;d++){var S=O+d+y*h,C=O+d+y*(h+1),x=O+(d+1)+y*(h+1),M=O+(d+1)+y*h;I.push(S,C,M),I.push(C,x,M),E+=6}R.addGroup(N,E,c),N+=E,O+=b}o("z","y","x",-1,-1,n,t,e,a,i,0),o("z","y","x",1,-1,n,t,-e,a,i,1),o("x","z","y",1,1,e,n,t,r,a,2),o("x","z","y",1,-1,e,n,-t,r,a,3),o("x","y","z",1,-1,e,t,n,r,i,4),o("x","y","z",-1,-1,e,t,-n,r,i,5),this.setIndex(I),this.addAttribute("position",new Fr(P,3)),this.addAttribute("normal",new Fr(D,3)),this.addAttribute("uv",new Fr(L,2))}function ni(e,t,n,r){Rr.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r},this.fromBufferGeometry(new ri(e,t,n,r)),this.mergeVertices()}function ri(e,t,n,r){$r.call(this),this.type="PlaneBufferGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};var i,a,o=(e=e||1)/2,s=(t=t||1)/2,l=Math.floor(n)||1,u=Math.floor(r)||1,c=l+1,d=u+1,h=e/l,f=t/u,p=[],m=[],g=[],v=[];for(a=0;a<d;a++){var y=a*f-s;for(i=0;i<c;i++){var _=i*h-o;m.push(_,-y,0),g.push(0,0,1),v.push(i/l),v.push(1-a/u)}}for(a=0;a<u;a++)for(i=0;i<l;i++){var b=i+c*a,E=i+c*(a+1),T=i+1+c*(a+1),A=i+1+c*a;p.push(b,E,A),p.push(E,T,A)}this.setIndex(p),this.addAttribute("position",new Fr(m,3)),this.addAttribute("normal",new Fr(g,3)),this.addAttribute("uv",new Fr(v,2))}$r.prototype=Object.assign(Object.create(i.prototype),{constructor:$r,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){Array.isArray(e)?this.index=new(65535<Hr(e)?Br:Nr)(e,1):this.index=e},addAttribute:function(e,t){return t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?("index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t)):this.attributes[e]=t,this):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.addAttribute(e,new Ir(t,arguments[2])))},getAttribute:function(e){return this.attributes[e]},removeAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,t,n){this.groups.push({start:e,count:t,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix:function(e){var t=this.attributes.position;void 0!==t&&(e.applyToBufferAttribute(t),t.needsUpdate=!0);var n=this.attributes.normal;void 0!==n&&((new Kt).getNormalMatrix(e).applyToBufferAttribute(n),n.needsUpdate=!0);return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:(Zr=new Wt,function(e){return Zr.makeRotationX(e),this.applyMatrix(Zr),this}),rotateY:(Qr=new Wt,function(e){return Qr.makeRotationY(e),this.applyMatrix(Qr),this}),rotateZ:(Xr=new Wt,function(e){return Xr.makeRotationZ(e),this.applyMatrix(Xr),this}),translate:(Kr=new Wt,function(e,t,n){return Kr.makeTranslation(e,t,n),this.applyMatrix(Kr),this}),scale:(Yr=new Wt,function(e,t,n){return Yr.makeScale(e,t,n),this.applyMatrix(Yr),this}),lookAt:(qr=new vr,function(e){qr.lookAt(e),qr.updateMatrix(),this.applyMatrix(qr.matrix)}),center:(Wr=new Yt,function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Wr).negate(),this.translate(Wr.x,Wr.y,Wr.z),this}),setFromObject:function(e){var t=e.geometry;if(e.isPoints||e.isLine){var n=new Fr(3*t.vertices.length,3),r=new Fr(3*t.colors.length,3);if(this.addAttribute("position",n.copyVector3sArray(t.vertices)),this.addAttribute("color",r.copyColorsArray(t.colors)),t.lineDistances&&t.lineDistances.length===t.vertices.length){var i=new Fr(t.lineDistances.length,1);this.addAttribute("lineDistance",i.copyArray(t.lineDistances))}null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone())}else e.isMesh&&t&&t.isGeometry&&this.fromGeometry(t);return this},setFromPoints:function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n];t.push(i.x,i.y,i.z||0)}return this.addAttribute("position",new Fr(t,3)),this},updateFromObject:function(e){var t,n=e.geometry;if(e.isMesh){var r=n.__directGeometry;if(!0===n.elementsNeedUpdate&&(r=void 0,n.elementsNeedUpdate=!1),void 0===r)return this.fromGeometry(n);r.verticesNeedUpdate=n.verticesNeedUpdate,r.normalsNeedUpdate=n.normalsNeedUpdate,r.colorsNeedUpdate=n.colorsNeedUpdate,r.uvsNeedUpdate=n.uvsNeedUpdate,r.groupsNeedUpdate=n.groupsNeedUpdate,n.verticesNeedUpdate=!1,n.normalsNeedUpdate=!1,n.colorsNeedUpdate=!1,n.uvsNeedUpdate=!1,n.groupsNeedUpdate=!1,n=r}return!0===n.verticesNeedUpdate&&(void 0!==(t=this.attributes.position)&&(t.copyVector3sArray(n.vertices),t.needsUpdate=!0),n.verticesNeedUpdate=!1),!0===n.normalsNeedUpdate&&(void 0!==(t=this.attributes.normal)&&(t.copyVector3sArray(n.normals),t.needsUpdate=!0),n.normalsNeedUpdate=!1),!0===n.colorsNeedUpdate&&(void 0!==(t=this.attributes.color)&&(t.copyColorsArray(n.colors),t.needsUpdate=!0),n.colorsNeedUpdate=!1),n.uvsNeedUpdate&&(void 0!==(t=this.attributes.uv)&&(t.copyVector2sArray(n.uvs),t.needsUpdate=!0),n.uvsNeedUpdate=!1),n.lineDistancesNeedUpdate&&(void 0!==(t=this.attributes.lineDistance)&&(t.copyArray(n.lineDistances),t.needsUpdate=!0),n.lineDistancesNeedUpdate=!1),n.groupsNeedUpdate&&(n.computeGroups(e.geometry),this.groups=n.groups,n.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=(new Ur).fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){var t=new Float32Array(3*e.vertices.length);if(this.addAttribute("position",new Ir(t,3).copyVector3sArray(e.vertices)),0<e.normals.length){var n=new Float32Array(3*e.normals.length);this.addAttribute("normal",new Ir(n,3).copyVector3sArray(e.normals))}if(0<e.colors.length){var r=new Float32Array(3*e.colors.length);this.addAttribute("color",new Ir(r,3).copyColorsArray(e.colors))}if(0<e.uvs.length){var i=new Float32Array(2*e.uvs.length);this.addAttribute("uv",new Ir(i,2).copyVector2sArray(e.uvs))}if(0<e.uvs2.length){var a=new Float32Array(2*e.uvs2.length);this.addAttribute("uv2",new Ir(a,2).copyVector2sArray(e.uvs2))}for(var o in this.groups=e.groups,e.morphTargets){for(var s=[],l=e.morphTargets[o],u=0,c=l.length;u<c;u++){var d=l[u],h=new Fr(3*d.length,3);s.push(h.copyVector3sArray(d))}this.morphAttributes[o]=s}if(0<e.skinIndices.length){var f=new Fr(4*e.skinIndices.length,4);this.addAttribute("skinIndex",f.copyVector4sArray(e.skinIndices))}if(0<e.skinWeights.length){var p=new Fr(4*e.skinWeights.length,4);this.addAttribute("skinWeight",p.copyVector4sArray(e.skinWeights))}return null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Dn);var e=this.attributes.position;void 0!==e?this.boundingBox.setFromBufferAttribute(e):this.boundingBox.makeEmpty(),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:(Vr=new Dn,zr=new Yt,function(){null===this.boundingSphere&&(this.boundingSphere=new Nn);var e=this.attributes.position;if(e){var t=this.boundingSphere.center;Vr.setFromBufferAttribute(e),Vr.getCenter(t);for(var n=0,r=0,i=e.count;r<i;r++)zr.x=e.getX(r),zr.y=e.getY(r),zr.z=e.getZ(r),n=Math.max(n,t.distanceToSquared(zr));this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}),computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.index,t=this.attributes,n=this.groups;if(t.position){var r=t.position.array;if(void 0===t.normal)this.addAttribute("normal",new Ir(new Float32Array(r.length),3));else for(var i=t.normal.array,a=0,o=i.length;a<o;a++)i[a]=0;var s,l,u,c=t.normal.array,d=new Yt,h=new Yt,f=new Yt,p=new Yt,m=new Yt;if(e){var g=e.array;0===n.length&&this.addGroup(0,g.length);for(var v=0,y=n.length;v<y;++v){var _=n[v],b=_.start;for(a=b,o=b+_.count;a<o;a+=3)s=3*g[a+0],l=3*g[a+1],u=3*g[a+2],d.fromArray(r,s),h.fromArray(r,l),f.fromArray(r,u),p.subVectors(f,h),m.subVectors(d,h),p.cross(m),c[s]+=p.x,c[1+s]+=p.y,c[2+s]+=p.z,c[l]+=p.x,c[1+l]+=p.y,c[2+l]+=p.z,c[u]+=p.x,c[1+u]+=p.y,c[2+u]+=p.z}}else for(a=0,o=r.length;a<o;a+=9)d.fromArray(r,a),h.fromArray(r,a+3),f.fromArray(r,a+6),p.subVectors(f,h),m.subVectors(d,h),p.cross(m),c[a]=p.x,c[a+1]=p.y,c[a+2]=p.z,c[a+3]=p.x,c[a+4]=p.y,c[a+5]=p.z,c[a+6]=p.x,c[a+7]=p.y,c[a+8]=p.z;this.normalizeNormals(),t.normal.needsUpdate=!0}},merge:function(e,t){if(e&&e.isBufferGeometry){void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var n=this.attributes;for(var r in n)if(void 0!==e.attributes[r])for(var i=n[r].array,a=e.attributes[r],o=a.array,s=0,l=a.itemSize*t;s<o.length;s++,l++)i[l]=o[s];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e)},normalizeNormals:(Gr=new Yt,function(){for(var e=this.attributes.normal,t=0,n=e.count;t<n;t++)Gr.x=e.getX(t),Gr.y=e.getY(t),Gr.z=e.getZ(t),Gr.normalize(),e.setXYZ(t,Gr.x,Gr.y,Gr.z)}),toNonIndexed:function(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var e=new $r,t=this.index.array,n=this.attributes;for(var r in n){for(var i=n[r],a=i.array,o=i.itemSize,s=new a.constructor(t.length*o),l=0,u=0,c=0,d=t.length;c<d;c++){l=t[c]*o;for(var h=0;h<o;h++)s[u++]=a[l++]}e.addAttribute(r,new Ir(s,o))}var f=this.groups;for(c=0,d=f.length;c<d;c++){var p=f[c];e.addGroup(p.start,p.count,p.materialIndex)}return e},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),0<Object.keys(this.userData).length&&(e.userData=this.userData),void 0!==this.parameters){var t=this.parameters;for(var n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};var r=this.index;if(null!==r){var i=Array.prototype.slice.call(r.array);e.data.index={type:r.array.constructor.name,array:i}}var a=this.attributes;for(var n in a){var o=a[n];i=Array.prototype.slice.call(o.array);e.data.attributes[n]={itemSize:o.itemSize,type:o.array.constructor.name,array:i,normalized:o.normalized}}var s=this.groups;0<s.length&&(e.data.groups=JSON.parse(JSON.stringify(s)));var l=this.boundingSphere;return null!==l&&(e.data.boundingSphere={center:l.center.toArray(),radius:l.radius}),e},clone:function(){return(new $r).copy(this)},copy:function(e){var t,n,r;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var i=e.index;null!==i&&this.setIndex(i.clone());var a=e.attributes;for(t in a){var o=a[t];this.addAttribute(t,o.clone())}var s=e.morphAttributes;for(t in s){var l=[],u=s[t];for(n=0,r=u.length;n<r;n++)l.push(u[n].clone());this.morphAttributes[t]=l}var c=e.groups;for(n=0,r=c.length;n<r;n++){var d=c[n];this.addGroup(d.start,d.count,d.materialIndex)}var h=e.boundingBox;null!==h&&(this.boundingBox=h.clone());var f=e.boundingSphere;return null!==f&&(this.boundingSphere=f.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),(ei.prototype=Object.create(Rr.prototype)).constructor=ei,(ti.prototype=Object.create($r.prototype)).constructor=ti,(ni.prototype=Object.create(Rr.prototype)).constructor=ni,(ri.prototype=Object.create($r.prototype)).constructor=ri;var ii,ai,oi,si,li,ui,ci,di,hi,fi,pi,mi,gi,vi,yi,_i,bi,Ei,Ti,Ai,wi,Si,Ci,xi,Mi,Ri,Ii,Pi,Di,Li,Oi,Ni,ki,Bi,Fi,ji,Ui,Hi,Gi,Vi=0;function zi(){Object.defineProperty(this,"id",{value:Vi++}),this.uuid=Vt.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.lights=!0,this.blending=J,this.side=k,this.flatShading=!1,this.vertexColors=we,this.opacity=1,this.transparent=!1,this.blendSrc=ie,this.blendDst=ae,this.blendEquation=O,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=pe,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.overdraw=0,this.visible=!0,this.userData={},this.needsUpdate=!0}function Wi(e){zi.call(this),this.type="MeshBasicMaterial",this.color=new Gn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=_e,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(e)}function qi(e){zi.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}function Yi(e,t){this.origin=void 0!==e?e:new Yt,this.direction=void 0!==t?t:new Yt}function Ki(e,t){this.start=void 0!==e?e:new Yt,this.end=void 0!==t?t:new Yt}function Xi(e,t,n){this.a=void 0!==e?e:new Yt,this.b=void 0!==t?t:new Yt,this.c=void 0!==n?n:new Yt}function Qi(e,t){vr.call(this),this.type="Mesh",this.geometry=void 0!==e?e:new $r,this.material=void 0!==t?t:new Wi({color:16777215*Math.random()}),this.drawMode=Lt,this.updateMorphTargets()}function Zi(e,t,n,r,i,a,o){return Xi.getBarycoord(e,t,n,r,Ui),i.multiplyScalar(Ui.x),a.multiplyScalar(Ui.y),o.multiplyScalar(Ui.z),i.add(a).add(o),i.clone()}function Ji(e,t,n,r,i,a,o,s){if(null===(t.side===Ae?r.intersectTriangle(o,a,i,!0,s):r.intersectTriangle(i,a,o,t.side!==Q,s)))return null;Gi.copy(s),Gi.applyMatrix4(e.matrixWorld);var l=n.ray.origin.distanceTo(Gi);return l<n.near||l>n.far?null:{distance:l,point:Gi.clone(),object:e}}function $i(e,t,n,r,i,a,o,s){Pi.fromBufferAttribute(r,a),Di.fromBufferAttribute(r,o),Li.fromBufferAttribute(r,s);var l=Ji(e,e.material,t,n,Pi,Di,Li,Hi);if(l){i&&(Bi.fromBufferAttribute(i,a),Fi.fromBufferAttribute(i,o),ji.fromBufferAttribute(i,s),l.uv=Zi(Hi,Pi,Di,Li,Bi,Fi,ji));var u=new br(a,o,s);Xi.getNormal(Pi,Di,Li,u.normal),l.face=u}return l}function ea(a,n,o,r){var s,l,u,c=new Gn(0),d=0;function h(e,t){n.buffers.color.setClear(e.r,e.g,e.b,t,r)}return{getClearColor:function(){return c},setClearColor:function(e,t){c.set(e),h(c,d=void 0!==t?t:1)},getClearAlpha:function(){return d},setClearAlpha:function(e){h(c,d=e)},render:function(e,t,n,r){var i=t.background;null===i?h(c,d):i&&i.isColor&&(h(i,1),r=!0),(a.autoClear||r)&&a.clear(a.autoClearColor,a.autoClearDepth,a.autoClearStencil),i&&i.isCubeTexture?(void 0===u&&((u=new Qi(new ti(1,1,1),new qi({uniforms:Yn.cube.uniforms,vertexShader:Yn.cube.vertexShader,fragmentShader:Yn.cube.fragmentShader,side:Ae,depthTest:!0,depthWrite:!1,fog:!1}))).geometry.removeAttribute("normal"),u.geometry.removeAttribute("uv"),u.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},o.update(u)),u.material.uniforms.tCube.value=i,e.push(u,u.geometry,u.material,0,null)):i&&i.isTexture&&(void 0===s&&(s=new _r(-1,1,1,-1,0,1),l=new Qi(new ri(2,2),new Wi({depthTest:!1,depthWrite:!1,fog:!1})),o.update(l)),l.material.map=i,a.renderBufferDirect(s,null,l.geometry,l.material,l,null))}}}function ta(n,i,a){var o;this.setMode=function(e){o=e},this.render=function(e,t){n.drawArrays(o,e,t),a.update(t,o)},this.renderInstances=function(e,t,n){var r=i.get("ANGLE_instanced_arrays");null!==r?(r.drawArraysInstancedANGLE(o,t,n,e.maxInstancedCount),a.update(n,o,e.maxInstancedCount)):console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.")}}function na(t,n,e){var r;function i(e){if("highp"===e){if(0<t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision&&0<t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision)return"highp";e="mediump"}return"mediump"===e&&0<t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision&&0<t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision?"mediump":"lowp"}var a=void 0!==e.precision?e.precision:"highp",o=i(a);o!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",o,"instead."),a=o);var s=!0===e.logarithmicDepthBuffer,l=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),u=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),c=t.getParameter(t.MAX_TEXTURE_SIZE),d=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),h=t.getParameter(t.MAX_VERTEX_ATTRIBS),f=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),p=t.getParameter(t.MAX_VARYING_VECTORS),m=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),g=0<u,v=!!n.get("OES_texture_float");return{getMaxAnisotropy:function(){if(void 0!==r)return r;var e=n.get("EXT_texture_filter_anisotropic");return r=null!==e?t.getParameter(e.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:i,precision:a,logarithmicDepthBuffer:s,maxTextures:l,maxVertexTextures:u,maxTextureSize:c,maxCubemapSize:d,maxAttributes:h,maxVertexUniforms:f,maxVaryings:p,maxFragmentUniforms:m,vertexTextures:g,floatFragmentTextures:v,floatVertexTextures:g&&v}}function ra(){var c=this,d=null,h=0,f=!1,p=!1,m=new kn,g=new Kt,v={value:null,needsUpdate:!1};function y(){v.value!==d&&(v.value=d,v.needsUpdate=0<h),c.numPlanes=h,c.numIntersection=0}function _(e,t,n,r){var i=null!==e?e.length:0,a=null;if(0!==i){if(a=v.value,!0!==r||null===a){var o=n+4*i,s=t.matrixWorldInverse;g.getNormalMatrix(s),(null===a||a.length<o)&&(a=new Float32Array(o));for(var l=0,u=n;l!==i;++l,u+=4)m.copy(e[l]).applyMatrix4(s,g),m.normal.toArray(a,u),a[u+3]=m.constant}v.value=a,v.needsUpdate=!0}return c.numPlanes=i,a}this.uniform=v,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t,n){var r=0!==e.length||t||0!==h||f;return f=t,d=_(e,n,0),h=e.length,r},this.beginShadows=function(){p=!0,_(null)},this.endShadows=function(){p=!1,y()},this.setState=function(e,t,n,r,i,a){if(!f||null===e||0===e.length||p&&!n)p?_(null):y();else{var o=p?0:h,s=4*o,l=i.clippingState||null;v.value=l,l=_(e,r,s,a);for(var u=0;u!==s;++u)l[u]=d[u];i.clippingState=l,this.numIntersection=t?this.numPlanes:0,this.numPlanes+=o}}}function ia(n){var r={};return{get:function(e){if(void 0!==r[e])return r[e];var t;switch(e){case"WEBGL_depth_texture":t=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":t=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":t=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":t=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:t=n.getExtension(e)}return null===t&&console.warn("THREE.WebGLRenderer: "+e+" extension not supported."),r[e]=t}}}function aa(d,h,a){var o={},f={};function s(e){var t=e.target,n=o[t.id];for(var r in null!==n.index&&h.remove(n.index),n.attributes)h.remove(n.attributes[r]);t.removeEventListener("dispose",s),delete o[t.id];var i=f[t.id];i&&(h.remove(i),delete f[t.id]),(i=f[n.id])&&(h.remove(i),delete f[n.id]),a.memory.geometries--}return{get:function(e,t){var n=o[t.id];return n||(t.addEventListener("dispose",s),t.isBufferGeometry?n=t:t.isGeometry&&(void 0===t._bufferGeometry&&(t._bufferGeometry=(new $r).setFromObject(e)),n=t._bufferGeometry),o[t.id]=n,a.memory.geometries++,n)},update:function(e){var t=e.index,n=e.attributes;for(var r in null!==t&&h.update(t,d.ELEMENT_ARRAY_BUFFER),n)h.update(n[r],d.ARRAY_BUFFER);var i=e.morphAttributes;for(var r in i)for(var a=i[r],o=0,s=a.length;o<s;o++)h.update(a[o],d.ARRAY_BUFFER)},getWireframeAttribute:function(e){var t=f[e.id];if(t)return t;var n,r=[],i=e.index,a=e.attributes;if(null!==i)for(var o=0,s=(n=i.array).length;o<s;o+=3){var l=n[o+0],u=n[o+1],c=n[o+2];r.push(l,u,u,c,c,l)}else for(o=0,s=(n=a.position.array).length/3-1;o<s;o+=3){l=o+0,u=o+1,c=o+2;r.push(l,u,u,c,c,l)}return t=new(65535<Hr(r)?Br:Nr)(r,1),h.update(t,d.ELEMENT_ARRAY_BUFFER),f[e.id]=t}}}function oa(n,i,a){var o,s,l;this.setMode=function(e){o=e},this.setIndex=function(e){s=e.type,l=e.bytesPerElement},this.render=function(e,t){n.drawElements(o,t,s,e*l),a.update(t,o)},this.renderInstances=function(e,t,n){var r=i.get("ANGLE_instanced_arrays");null!==r?(r.drawElementsInstancedANGLE(o,n,s,t*l,e.maxInstancedCount),a.update(n,o,e.maxInstancedCount)):console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.")}}function sa(r){var i={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:i,programs:null,autoReset:!0,reset:function(){i.frame++,i.calls=0,i.triangles=0,i.points=0,i.lines=0},update:function(e,t,n){switch(n=n||1,i.calls++,t){case r.TRIANGLES:i.triangles+=n*(e/3);break;case r.TRIANGLE_STRIP:case r.TRIANGLE_FAN:i.triangles+=n*(e-2);break;case r.LINES:i.lines+=n*(e/2);break;case r.LINE_STRIP:i.lines+=n*(e-1);break;case r.LINE_LOOP:i.lines+=n*e;break;case r.POINTS:i.points+=n*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",t)}}}}function la(e,t){return Math.abs(t[1])-Math.abs(e[1])}function ua(f){var p={},m=new Float32Array(8);return{update:function(e,t,n,r){var i=e.morphTargetInfluences,a=i.length,o=p[t.id];if(void 0===o){o=[];for(var s=0;s<a;s++)o[s]=[s,0];p[t.id]=o}var l=n.morphTargets&&t.morphAttributes.position,u=n.morphNormals&&t.morphAttributes.normal;for(s=0;s<a;s++){0!==(c=o[s])[1]&&(l&&t.removeAttribute("morphTarget"+s),u&&t.removeAttribute("morphNormal"+s))}for(s=0;s<a;s++){(c=o[s])[0]=s,c[1]=i[s]}for(o.sort(la),s=0;s<8;s++){var c;if(c=o[s]){var d=c[0],h=c[1];if(h){l&&t.addAttribute("morphTarget"+s,l[d]),u&&t.addAttribute("morphNormal"+s,u[d]),m[s]=h;continue}}m[s]=0}r.getUniforms().setValue(f,"morphTargetInfluences",m)}}}function ca(i,a){var o={};return{update:function(e){var t=a.render.frame,n=e.geometry,r=i.get(e,n);return o[r.id]!==t&&(n.isGeometry&&r.updateFromObject(e),i.update(r),o[r.id]=t),r},dispose:function(){o={}}}}function da(e,t,n,r,i,a,o,s,l,u){xn.call(this,e=void 0!==e?e:[],t=void 0!==t?t:Re,n,r,i,a,o,s,l,u),this.flipY=!1}zi.prototype=Object.assign(Object.create(i.prototype),{constructor:zi,isMaterial:!0,onBeforeCompile:function(){},setValues:function(e){if(void 0!==e)for(var t in e){var n=e[t];if(void 0!==n)if("shading"!==t){var r=this[t];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]="overdraw"===t?Number(n):n:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===n;else console.warn("THREE.Material: '"+t+"' parameter is undefined.")}},toJSON:function(e){var t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});var n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearCoat&&(n.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(n.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,n.reflectivity=this.reflectivity),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==J&&(n.blending=this.blending),!0===this.flatShading&&(n.flatShading=this.flatShading),this.side!==k&&(n.side=this.side),this.vertexColors!==we&&(n.vertexColors=this.vertexColors),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,0!==this.rotation&&(n.rotation=this.rotation),1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),0<this.alphaTest&&(n.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),1<this.wireframeLinewidth&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.skinning&&(n.skinning=!0),!1===this.visible&&(n.visible=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),t){var i=r(e.textures),a=r(e.images);0<i.length&&(n.textures=i),0<a.length&&(n.images=a)}return n},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.lights=e.lights,this.blending=e.blending,this.side=e.side,this.flatShading=e.flatShading,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.overdraw=e.overdraw,this.visible=e.visible,this.userData=JSON.parse(JSON.stringify(e.userData)),this.clipShadows=e.clipShadows,this.clipIntersection=e.clipIntersection;var t=e.clippingPlanes,n=null;if(null!==t){var r=t.length;n=new Array(r);for(var i=0;i!==r;++i)n[i]=t[i].clone()}return this.clippingPlanes=n,this.shadowSide=e.shadowSide,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),((Wi.prototype=Object.create(zi.prototype)).constructor=Wi).prototype.isMeshBasicMaterial=!0,Wi.prototype.copy=function(e){return zi.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this},((qi.prototype=Object.create(zi.prototype)).constructor=qi).prototype.isShaderMaterial=!0,qi.prototype.copy=function(e){return zi.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Un.clone(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=e.extensions,this},qi.prototype.toJSON=function(e){var t=zi.prototype.toJSON.call(this,e);return t.uniforms=this.uniforms,t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t},Object.assign(Yi.prototype,{set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){return void 0===t&&(console.warn("THREE.Ray: .at() target is now required"),t=new Yt),t.copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},recast:(pi=new Yt,function(e){return this.origin.copy(this.at(e,pi)),this}),closestPointToPoint:function(e,t){void 0===t&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),t=new Yt),t.subVectors(e,this.origin);var n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(e){return Math.sqrt(this.distanceSqToPoint(e))},distanceSqToPoint:(fi=new Yt,function(e){var t=fi.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(fi.copy(this.direction).multiplyScalar(t).add(this.origin),fi.distanceToSquared(e))}),distanceSqToSegment:(ci=new Yt,di=new Yt,hi=new Yt,function(e,t,n,r){ci.copy(e).add(t).multiplyScalar(.5),di.copy(t).sub(e).normalize(),hi.copy(this.origin).sub(ci);var i,a,o,s,l=.5*e.distanceTo(t),u=-this.direction.dot(di),c=hi.dot(this.direction),d=-hi.dot(di),h=hi.lengthSq(),f=Math.abs(1-u*u);if(0<f)if(a=u*c-d,s=l*f,0<=(i=u*d-c))if(-s<=a)if(a<=s){var p=1/f;o=(i*=p)*(i+u*(a*=p)+2*c)+a*(u*i+a+2*d)+h}else a=l,o=-(i=Math.max(0,-(u*a+c)))*i+a*(a+2*d)+h;else a=-l,o=-(i=Math.max(0,-(u*a+c)))*i+a*(a+2*d)+h;else o=a<=-s?-(i=Math.max(0,-(-u*l+c)))*i+(a=0<i?-l:Math.min(Math.max(-l,-d),l))*(a+2*d)+h:a<=s?(i=0,(a=Math.min(Math.max(-l,-d),l))*(a+2*d)+h):-(i=Math.max(0,-(u*l+c)))*i+(a=0<i?l:Math.min(Math.max(-l,-d),l))*(a+2*d)+h;else a=0<u?-l:l,o=-(i=Math.max(0,-(u*a+c)))*i+a*(a+2*d)+h;return n&&n.copy(this.direction).multiplyScalar(i).add(this.origin),r&&r.copy(di).multiplyScalar(a).add(ci),o}),intersectSphere:(ui=new Yt,function(e,t){ui.subVectors(e.center,this.origin);var n=ui.dot(this.direction),r=ui.dot(ui)-n*n,i=e.radius*e.radius;if(i<r)return null;var a=Math.sqrt(i-r),o=n-a,s=n+a;return o<0&&s<0?null:o<0?this.at(s,t):this.at(o,t)}),intersectsSphere:function(e){return this.distanceToPoint(e.center)<=e.radius},distanceToPlane:function(e){var t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(e.normal)+e.constant)/t;return 0<=n?n:null},intersectPlane:function(e,t){var n=this.distanceToPlane(e);return null===n?null:this.at(n,t)},intersectsPlane:function(e){var t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0},intersectBox:function(e,t){var n,r,i,a,o,s,l=1/this.direction.x,u=1/this.direction.y,c=1/this.direction.z,d=this.origin;return r=0<=l?(n=(e.min.x-d.x)*l,(e.max.x-d.x)*l):(n=(e.max.x-d.x)*l,(e.min.x-d.x)*l),(a=0<=u?(i=(e.min.y-d.y)*u,(e.max.y-d.y)*u):(i=(e.max.y-d.y)*u,(e.min.y-d.y)*u))<n||r<i?null:((n<i||n!=n)&&(n=i),(a<r||r!=r)&&(r=a),(s=0<=c?(o=(e.min.z-d.z)*c,(e.max.z-d.z)*c):(o=(e.max.z-d.z)*c,(e.min.z-d.z)*c))<n||r<o?null:((n<o||n!=n)&&(n=o),(s<r||r!=r)&&(r=s),r<0?null:this.at(0<=n?n:r,t)))},intersectsBox:(li=new Yt,function(e){return null!==this.intersectBox(e,li)}),intersectTriangle:(ii=new Yt,ai=new Yt,oi=new Yt,si=new Yt,function(e,t,n,r,i){ai.subVectors(t,e),oi.subVectors(n,e),si.crossVectors(ai,oi);var a,o=this.direction.dot(si);if(0<o){if(r)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}ii.subVectors(this.origin,e);var s=a*this.direction.dot(oi.crossVectors(ii,oi));if(s<0)return null;var l=a*this.direction.dot(ai.cross(ii));if(l<0)return null;if(o<s+l)return null;var u=-a*ii.dot(si);return u<0?null:this.at(u/o,i)}),applyMatrix4:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}}),Object.assign(Ki.prototype,{set:function(e,t){return this.start.copy(e),this.end.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},getCenter:function(e){return void 0===e&&(console.warn("THREE.Line3: .getCenter() target is now required"),e=new Yt),e.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){return void 0===e&&(console.warn("THREE.Line3: .delta() target is now required"),e=new Yt),e.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){return void 0===t&&(console.warn("THREE.Line3: .at() target is now required"),t=new Yt),this.delta(t).multiplyScalar(e).add(this.start)},closestPointToPointParameter:(mi=new Yt,gi=new Yt,function(e,t){mi.subVectors(e,this.start),gi.subVectors(this.end,this.start);var n=gi.dot(gi),r=gi.dot(mi)/n;return t&&(r=Vt.clamp(r,0,1)),r}),closestPointToPoint:function(e,t,n){var r=this.closestPointToPointParameter(e,t);return void 0===n&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),n=new Yt),this.delta(n).multiplyScalar(r).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}}),Object.assign(Xi,{getNormal:(Ei=new Yt,function(e,t,n,r){void 0===r&&(console.warn("THREE.Triangle: .getNormal() target is now required"),r=new Yt),r.subVectors(n,t),Ei.subVectors(e,t),r.cross(Ei);var i=r.lengthSq();return 0<i?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)}),getBarycoord:(yi=new Yt,_i=new Yt,bi=new Yt,function(e,t,n,r,i){yi.subVectors(r,t),_i.subVectors(n,t),bi.subVectors(e,t);var a=yi.dot(yi),o=yi.dot(_i),s=yi.dot(bi),l=_i.dot(_i),u=_i.dot(bi),c=a*l-o*o;if(void 0===i&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),i=new Yt),0==c)return i.set(-2,-1,-1);var d=1/c,h=(l*s-o*u)*d,f=(a*u-o*s)*d;return i.set(1-h-f,f,h)}),containsPoint:(vi=new Yt,function(e,t,n,r){return Xi.getBarycoord(e,t,n,r,vi),0<=vi.x&&0<=vi.y&&vi.x+vi.y<=1})}),Object.assign(Xi.prototype,{set:function(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this},setFromPointsAndIndices:function(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},getArea:(Ci=new Yt,xi=new Yt,function(){return Ci.subVectors(this.c,this.b),xi.subVectors(this.a,this.b),.5*Ci.cross(xi).length()}),getMidpoint:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),e=new Yt),e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(e){return Xi.getNormal(this.a,this.b,this.c,e)},getPlane:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getPlane() target is now required"),e=new Yt),e.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(e,t){return Xi.getBarycoord(e,this.a,this.b,this.c,t)},containsPoint:function(e){return Xi.containsPoint(e,this.a,this.b,this.c)},intersectsBox:function(e){return e.intersectsTriangle(this)},closestPointToPoint:(Ti=new kn,Ai=[new Ki,new Ki,new Ki],wi=new Yt,Si=new Yt,function(e,t){void 0===t&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),t=new Yt);var n=1/0;if(Ti.setFromCoplanarPoints(this.a,this.b,this.c),Ti.projectPoint(e,wi),!0===this.containsPoint(wi))t.copy(wi);else{Ai[0].set(this.a,this.b),Ai[1].set(this.b,this.c),Ai[2].set(this.c,this.a);for(var r=0;r<Ai.length;r++){Ai[r].closestPointToPoint(wi,!0,Si);var i=wi.distanceToSquared(Si);i<n&&(n=i,t.copy(Si))}}return t}),equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}),Qi.prototype=Object.assign(Object.create(vr.prototype),{constructor:Qi,isMesh:!0,setDrawMode:function(e){this.drawMode=e},copy:function(e){return vr.prototype.copy.call(this,e),this.drawMode=e.drawMode,void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this},updateMorphTargets:function(){var e,t,n,r=this.geometry;if(r.isBufferGeometry){var i=r.morphAttributes,a=Object.keys(i);if(0<a.length){var o=i[a[0]];if(void 0!==o)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=o.length;e<t;e++)n=o[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}else{var s=r.morphTargets;if(void 0!==s&&0<s.length)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=s.length;e<t;e++)n=s[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}},raycast:(Mi=new Wt,Ri=new Yi,Ii=new Nn,Pi=new Yt,Di=new Yt,Li=new Yt,Oi=new Yt,Ni=new Yt,ki=new Yt,Bi=new zt,Fi=new zt,ji=new zt,Ui=new Yt,Hi=new Yt,Gi=new Yt,function(e,t){var n,r=this.geometry,i=this.material,a=this.matrixWorld;if(void 0!==i&&(null===r.boundingSphere&&r.computeBoundingSphere(),Ii.copy(r.boundingSphere),Ii.applyMatrix4(a),!1!==e.ray.intersectsSphere(Ii)&&(Mi.getInverse(a),Ri.copy(e.ray).applyMatrix4(Mi),null===r.boundingBox||!1!==Ri.intersectsBox(r.boundingBox))))if(r.isBufferGeometry){var o,s,l,u,c,d=r.index,h=r.attributes.position,f=r.attributes.uv;if(null!==d)for(u=0,c=d.count;u<c;u+=3)o=d.getX(u),s=d.getX(u+1),l=d.getX(u+2),(n=$i(this,e,Ri,h,f,o,s,l))&&(n.faceIndex=Math.floor(u/3),t.push(n));else if(void 0!==h)for(u=0,c=h.count;u<c;u+=3)(n=$i(this,e,Ri,h,f,o=u,s=u+1,l=u+2))&&(n.faceIndex=Math.floor(u/3),t.push(n))}else if(r.isGeometry){var p,m,g,v,y=Array.isArray(i),_=r.vertices,b=r.faces,E=r.faceVertexUvs[0];0<E.length&&(v=E);for(var T=0,A=b.length;T<A;T++){var w=b[T],S=y?i[w.materialIndex]:i;if(void 0!==S){if(p=_[w.a],m=_[w.b],g=_[w.c],!0===S.morphTargets){var C=r.morphTargets,x=this.morphTargetInfluences;Pi.set(0,0,0),Di.set(0,0,0),Li.set(0,0,0);for(var M=0,R=C.length;M<R;M++){var I=x[M];if(0!==I){var P=C[M].vertices;Pi.addScaledVector(Oi.subVectors(P[w.a],p),I),Di.addScaledVector(Ni.subVectors(P[w.b],m),I),Li.addScaledVector(ki.subVectors(P[w.c],g),I)}}Pi.add(p),Di.add(m),Li.add(g),p=Pi,m=Di,g=Li}if(n=Ji(this,S,e,Ri,p,m,g,Hi)){if(v&&v[T]){var D=v[T];Bi.copy(D[0]),Fi.copy(D[1]),ji.copy(D[2]),n.uv=Zi(Hi,p,m,g,Bi,Fi,ji)}n.face=w,n.faceIndex=T,t.push(n)}}}}}),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),((da.prototype=Object.create(xn.prototype)).constructor=da).prototype.isCubeTexture=!0,Object.defineProperty(da.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}});var ha=new xn,fa=new da;function pa(){this.seq=[],this.map={}}var ma=[],ga=[],va=new Float32Array(16),ya=new Float32Array(9),_a=new Float32Array(4);function ba(e,t,n){var r=e[0];if(r<=0||0<r)return e;var i=t*n,a=ma[i];if(void 0===a&&(a=new Float32Array(i),ma[i]=a),0!==t){r.toArray(a,0);for(var o=1,s=0;o!==t;++o)s+=n,e[o].toArray(a,s)}return a}function Ea(e,t){if(e.length!==t.length)return!1;for(var n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function Ta(e,t){for(var n=0,r=t.length;n<r;n++)e[n]=t[n]}function Aa(e,t){var n=ga[t];void 0===n&&(n=new Int32Array(t),ga[t]=n);for(var r=0;r!==t;++r)n[r]=e.allocTextureUnit();return n}function wa(e,t){var n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function Sa(e,t){var n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function Ca(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(Ea(n,t))return;e.uniform2fv(this.addr,t),Ta(n,t)}}function xa(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(Ea(n,t))return;e.uniform3fv(this.addr,t),Ta(n,t)}}function Ma(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(Ea(n,t))return;e.uniform4fv(this.addr,t),Ta(n,t)}}function Ra(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(Ea(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),Ta(n,t)}else{if(Ea(n,r))return;_a.set(r),e.uniformMatrix2fv(this.addr,!1,_a),Ta(n,r)}}function Ia(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(Ea(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),Ta(n,t)}else{if(Ea(n,r))return;ya.set(r),e.uniformMatrix3fv(this.addr,!1,ya),Ta(n,r)}}function Pa(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(Ea(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),Ta(n,t)}else{if(Ea(n,r))return;va.set(r),e.uniformMatrix4fv(this.addr,!1,va),Ta(n,r)}}function Da(e,t,n){var r=this.cache,i=n.allocTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture2D(t||ha,i)}function La(e,t,n){var r=this.cache,i=n.allocTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTextureCube(t||fa,i)}function Oa(e,t){var n=this.cache;Ea(n,t)||(e.uniform2iv(this.addr,t),Ta(n,t))}function Na(e,t){var n=this.cache;Ea(n,t)||(e.uniform3iv(this.addr,t),Ta(n,t))}function ka(e,t){var n=this.cache;Ea(n,t)||(e.uniform4iv(this.addr,t),Ta(n,t))}function Ba(e,t){var n=this.cache;Ea(n,t)||(e.uniform1fv(this.addr,t),Ta(n,t))}function Fa(e,t){var n=this.cache;Ea(n,t)||(e.uniform1iv(this.addr,t),Ta(n,t))}function ja(e,t){var n=this.cache,r=ba(t,this.size,2);Ea(n,r)||(e.uniform2fv(this.addr,r),this.updateCache(r))}function Ua(e,t){var n=this.cache,r=ba(t,this.size,3);Ea(n,r)||(e.uniform3fv(this.addr,r),this.updateCache(r))}function Ha(e,t){var n=this.cache,r=ba(t,this.size,4);Ea(n,r)||(e.uniform4fv(this.addr,r),this.updateCache(r))}function Ga(e,t){var n=this.cache,r=ba(t,this.size,4);Ea(n,r)||(e.uniformMatrix2fv(this.addr,!1,r),this.updateCache(r))}function Va(e,t){var n=this.cache,r=ba(t,this.size,9);Ea(n,r)||(e.uniformMatrix3fv(this.addr,!1,r),this.updateCache(r))}function za(e,t){var n=this.cache,r=ba(t,this.size,16);Ea(n,r)||(e.uniformMatrix4fv(this.addr,!1,r),this.updateCache(r))}function Wa(e,t,n){var r=this.cache,i=t.length,a=Aa(n,i);!1===Ea(r,a)&&(e.uniform1iv(this.addr,a),Ta(r,a));for(var o=0;o!==i;++o)n.setTexture2D(t[o]||ha,a[o])}function qa(e,t,n){var r=this.cache,i=t.length,a=Aa(n,i);!1===Ea(r,a)&&(e.uniform1iv(this.addr,a),Ta(r,a));for(var o=0;o!==i;++o)n.setTextureCube(t[o]||fa,a[o])}function Ya(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function(e){switch(e){case 5126:return wa;case 35664:return Ca;case 35665:return xa;case 35666:return Ma;case 35674:return Ra;case 35675:return Ia;case 35676:return Pa;case 35678:case 36198:return Da;case 35680:return La;case 5124:case 35670:return Sa;case 35667:case 35671:return Oa;case 35668:case 35672:return Na;case 35669:case 35673:return ka}}(t.type)}function Ka(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function(e){switch(e){case 5126:return Ba;case 35664:return ja;case 35665:return Ua;case 35666:return Ha;case 35674:return Ga;case 35675:return Va;case 35676:return za;case 35678:return Wa;case 35680:return qa;case 5124:case 35670:return Fa;case 35667:case 35671:return Oa;case 35668:case 35672:return Na;case 35669:case 35673:return ka}}(t.type)}function Xa(e){this.id=e,pa.call(this)}Ka.prototype.updateCache=function(e){var t=this.cache;e instanceof Float32Array&&t.length!==e.length&&(this.cache=new Float32Array(e.length)),Ta(t,e)},Xa.prototype.setValue=function(e,t){for(var n=this.seq,r=0,i=n.length;r!==i;++r){var a=n[r];a.setValue(e,t[a.id])}};var Qa=/([\w\d_]+)(\])?(\[|\.)?/g;function Za(e,t){e.seq.push(t),e.map[t.id]=t}function Ja(e,t,n){var r=e.name,i=r.length;for(Qa.lastIndex=0;;){var a=Qa.exec(r),o=Qa.lastIndex,s=a[1],l="]"===a[2],u=a[3];if(l&&(s|=0),void 0===u||"["===u&&o+2===i){Za(n,void 0===u?new Ya(s,e,t):new Ka(s,e,t));break}var c=n.map[s];void 0===c&&Za(n,c=new Xa(s)),n=c}}function $a(e,t,n){pa.call(this),this.renderer=n;for(var r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),i=0;i<r;++i){var a=e.getActiveUniform(t,i);Ja(a,e.getUniformLocation(t,a.name),this)}}function eo(e,t,n){var r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),!1===e.getShaderParameter(r,e.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==e.getShaderInfoLog(r)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",t===e.VERTEX_SHADER?"vertex":"fragment",e.getShaderInfoLog(r),function(e){for(var t=e.split("\n"),n=0;n<t.length;n++)t[n]=n+1+": "+t[n];return t.join("\n")}(n)),r}$a.prototype.setValue=function(e,t,n){var r=this.map[t];void 0!==r&&r.setValue(e,n,this.renderer)},$a.prototype.setOptional=function(e,t,n){var r=t[n];void 0!==r&&this.setValue(e,n,r)},$a.upload=function(e,t,n,r){for(var i=0,a=t.length;i!==a;++i){var o=t[i],s=n[o.id];!1!==s.needsUpdate&&o.setValue(e,s.value,r)}},$a.seqWithValue=function(e,t){for(var n=[],r=0,i=e.length;r!==i;++r){var a=e[r];a.id in t&&n.push(a)}return n};var to=0;function no(e){switch(e){case Ot:return["Linear","( value )"];case Nt:return["sRGB","( value )"];case Bt:return["RGBE","( value )"];case Ft:return["RGBM","( value, 7.0 )"];case jt:return["RGBM","( value, 16.0 )"];case Ut:return["RGBD","( value, 256.0 )"];case kt:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+e)}}function ro(e,t){var n=no(t);return"vec4 "+e+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function io(e){return""!==e}function ao(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights)}function oo(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}function so(e){return e.replace(/^[ \t]*#include +<([\w\d.]+)>/gm,function(e,t){var n=jn[t];if(void 0===n)throw new Error("Can not resolve #include <"+t+">");return so(n)})}function lo(e){return e.replace(/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,function(e,t,n,r){for(var i="",a=parseInt(t);a<parseInt(n);a++)i+=r.replace(/\[ i \]/g,"[ "+a+" ]");return i})}function uo(e,t,n,r,i,a){var o=e.context,s=r.defines,l=i.vertexShader,u=i.fragmentShader,c="SHADOWMAP_TYPE_BASIC";a.shadowMapType===N?c="SHADOWMAP_TYPE_PCF":a.shadowMapType===L&&(c="SHADOWMAP_TYPE_PCF_SOFT");var d="ENVMAP_TYPE_CUBE",h="ENVMAP_MODE_REFLECTION",f="ENVMAP_BLENDING_MULTIPLY";if(a.envMap){switch(r.envMap.mapping){case Re:case Ie:d="ENVMAP_TYPE_CUBE";break;case Oe:case Ne:d="ENVMAP_TYPE_CUBE_UV";break;case Pe:case De:d="ENVMAP_TYPE_EQUIREC";break;case Le:d="ENVMAP_TYPE_SPHERE"}switch(r.envMap.mapping){case Ie:case De:h="ENVMAP_MODE_REFRACTION"}switch(r.combine){case _e:f="ENVMAP_BLENDING_MULTIPLY";break;case be:f="ENVMAP_BLENDING_MIX";break;case Ee:f="ENVMAP_BLENDING_ADD"}}var p,m,g=0<e.gammaFactor?e.gammaFactor:1,v=function(e,t,n){return[(e=e||{}).derivatives||t.envMapCubeUV||t.bumpMap||t.normalMap||t.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(e.fragDepth||t.logarithmicDepthBuffer)&&n.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",e.drawBuffers&&n.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(e.shaderTextureLOD||t.envMap)&&n.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(io).join("\n")}(r.extensions,a,t),y=function(e){var t=[];for(var n in e){var r=e[n];!1!==r&&t.push("#define "+n+" "+r)}return t.join("\n")}(s),_=o.createProgram();r.isRawShaderMaterial?(0<(p=[y].filter(io).join("\n")).length&&(p+="\n"),0<(m=[v,y].filter(io).join("\n")).length&&(m+="\n")):(p=["precision "+a.precision+" float;","precision "+a.precision+" int;","#define SHADER_NAME "+i.name,y,a.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+g,"#define MAX_BONES "+a.maxBones,a.useFog&&a.fog?"#define USE_FOG":"",a.useFog&&a.fogExp?"#define FOG_EXP2":"",a.map?"#define USE_MAP":"",a.envMap?"#define USE_ENVMAP":"",a.envMap?"#define "+h:"",a.lightMap?"#define USE_LIGHTMAP":"",a.aoMap?"#define USE_AOMAP":"",a.emissiveMap?"#define USE_EMISSIVEMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.displacementMap&&a.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.roughnessMap?"#define USE_ROUGHNESSMAP":"",a.metalnessMap?"#define USE_METALNESSMAP":"",a.alphaMap?"#define USE_ALPHAMAP":"",a.vertexColors?"#define USE_COLOR":"",a.flatShading?"#define FLAT_SHADED":"",a.skinning?"#define USE_SKINNING":"",a.useVertexTexture?"#define BONE_TEXTURE":"",a.morphTargets?"#define USE_MORPHTARGETS":"",a.morphNormals&&!1===a.flatShading?"#define USE_MORPHNORMALS":"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+c:"",a.sizeAttenuation?"#define USE_SIZEATTENUATION":"",a.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",a.logarithmicDepthBuffer&&t.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(io).join("\n"),m=[v,"precision "+a.precision+" float;","precision "+a.precision+" int;","#define SHADER_NAME "+i.name,y,a.alphaTest?"#define ALPHATEST "+a.alphaTest+(a.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+g,a.useFog&&a.fog?"#define USE_FOG":"",a.useFog&&a.fogExp?"#define FOG_EXP2":"",a.map?"#define USE_MAP":"",a.envMap?"#define USE_ENVMAP":"",a.envMap?"#define "+d:"",a.envMap?"#define "+h:"",a.envMap?"#define "+f:"",a.lightMap?"#define USE_LIGHTMAP":"",a.aoMap?"#define USE_AOMAP":"",a.emissiveMap?"#define USE_EMISSIVEMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.roughnessMap?"#define USE_ROUGHNESSMAP":"",a.metalnessMap?"#define USE_METALNESSMAP":"",a.alphaMap?"#define USE_ALPHAMAP":"",a.vertexColors?"#define USE_COLOR":"",a.gradientMap?"#define USE_GRADIENTMAP":"",a.flatShading?"#define FLAT_SHADED":"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+c:"",a.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",a.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",a.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",a.logarithmicDepthBuffer&&t.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",a.envMap&&t.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",a.toneMapping!==Te?"#define TONE_MAPPING":"",a.toneMapping!==Te?jn.tonemapping_pars_fragment:"",a.toneMapping!==Te?function(e,t){var n;switch(t){case Se:n="Linear";break;case Ce:n="Reinhard";break;case xe:n="Uncharted2";break;case Me:n="OptimizedCineon";break;default:throw new Error("unsupported toneMapping: "+t)}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}("toneMapping",a.toneMapping):"",a.dithering?"#define DITHERING":"",a.outputEncoding||a.mapEncoding||a.envMapEncoding||a.emissiveMapEncoding?jn.encodings_pars_fragment:"",a.mapEncoding?ro("mapTexelToLinear",a.mapEncoding):"",a.envMapEncoding?ro("envMapTexelToLinear",a.envMapEncoding):"",a.emissiveMapEncoding?ro("emissiveMapTexelToLinear",a.emissiveMapEncoding):"",a.outputEncoding?function(e,t){var n=no(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}("linearToOutputTexel",a.outputEncoding):"",a.depthPacking?"#define DEPTH_PACKING "+r.depthPacking:"","\n"].filter(io).join("\n")),l=oo(l=ao(l=so(l),a),a),u=oo(u=ao(u=so(u),a),a);var b=p+(l=lo(l)),E=m+(u=lo(u)),T=eo(o,o.VERTEX_SHADER,b),A=eo(o,o.FRAGMENT_SHADER,E);o.attachShader(_,T),o.attachShader(_,A),void 0!==r.index0AttributeName?o.bindAttribLocation(_,0,r.index0AttributeName):!0===a.morphTargets&&o.bindAttribLocation(_,0,"position"),o.linkProgram(_);var w,S,C=o.getProgramInfoLog(_).trim(),x=o.getShaderInfoLog(T).trim(),M=o.getShaderInfoLog(A).trim(),R=!0,I=!0;return!1===o.getProgramParameter(_,o.LINK_STATUS)?(R=!1,console.error("THREE.WebGLProgram: shader error: ",o.getError(),"gl.VALIDATE_STATUS",o.getProgramParameter(_,o.VALIDATE_STATUS),"gl.getProgramInfoLog",C,x,M)):""!==C?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",C):""!==x&&""!==M||(I=!1),I&&(this.diagnostics={runnable:R,material:r,programLog:C,vertexShader:{log:x,prefix:p},fragmentShader:{log:M,prefix:m}}),o.deleteShader(T),o.deleteShader(A),this.getUniforms=function(){return void 0===w&&(w=new $a(o,_,e)),w},this.getAttributes=function(){return void 0===S&&(S=function(e,t){for(var n={},r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),i=0;i<r;i++){var a=e.getActiveAttrib(t,i).name;n[a]=e.getAttribLocation(t,a)}return n}(o,_)),S},this.destroy=function(){o.deleteProgram(_),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.name=i.name,this.id=to++,this.code=n,this.usedTimes=1,this.program=_,this.vertexShader=T,this.fragmentShader=A,this}function co(d,l,h){var u=[],f={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow"},a=["precision","supportsVertexTextures","map","mapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering"];function p(e,t){var n;return e?e.isTexture?n=e.encoding:e.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),n=e.texture.encoding):n=Ot,n===Ot&&t&&(n=kt),n}this.getParameters=function(e,t,n,r,i,a,o){var s=f[e.type],l=o.isSkinnedMesh?function(e){var t=e.skeleton.bones;if(h.floatVertexTextures)return 1024;var n=h.maxVertexUniforms,r=Math.floor((n-20)/4),i=Math.min(r,t.length);return i<t.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+t.length+" bones. This GPU supports "+i+"."),0):i}(o):0,u=h.precision;null!==e.precision&&(u=h.getMaxPrecision(e.precision))!==e.precision&&console.warn("THREE.WebGLProgram.getParameters:",e.precision,"not supported, using",u,"instead.");var c=d.getRenderTarget();return{shaderID:s,precision:u,supportsVertexTextures:h.vertexTextures,outputEncoding:p(c?c.texture:null,d.gammaOutput),map:!!e.map,mapEncoding:p(e.map,d.gammaInput),envMap:!!e.envMap,envMapMode:e.envMap&&e.envMap.mapping,envMapEncoding:p(e.envMap,d.gammaInput),envMapCubeUV:!!e.envMap&&(e.envMap.mapping===Oe||e.envMap.mapping===Ne),lightMap:!!e.lightMap,aoMap:!!e.aoMap,emissiveMap:!!e.emissiveMap,emissiveMapEncoding:p(e.emissiveMap,d.gammaInput),bumpMap:!!e.bumpMap,normalMap:!!e.normalMap,displacementMap:!!e.displacementMap,roughnessMap:!!e.roughnessMap,metalnessMap:!!e.metalnessMap,specularMap:!!e.specularMap,alphaMap:!!e.alphaMap,gradientMap:!!e.gradientMap,combine:e.combine,vertexColors:e.vertexColors,fog:!!r,useFog:e.fog,fogExp:r&&r.isFogExp2,flatShading:e.flatShading,sizeAttenuation:e.sizeAttenuation,logarithmicDepthBuffer:h.logarithmicDepthBuffer,skinning:e.skinning&&0<l,maxBones:l,useVertexTexture:h.floatVertexTextures,morphTargets:e.morphTargets,morphNormals:e.morphNormals,maxMorphTargets:d.maxMorphTargets,maxMorphNormals:d.maxMorphNormals,numDirLights:t.directional.length,numPointLights:t.point.length,numSpotLights:t.spot.length,numRectAreaLights:t.rectArea.length,numHemiLights:t.hemi.length,numClippingPlanes:i,numClipIntersection:a,dithering:e.dithering,shadowMapEnabled:d.shadowMap.enabled&&o.receiveShadow&&0<n.length,shadowMapType:d.shadowMap.type,toneMapping:d.toneMapping,physicallyCorrectLights:d.physicallyCorrectLights,premultipliedAlpha:e.premultipliedAlpha,alphaTest:e.alphaTest,doubleSided:e.side===Q,flipSided:e.side===Ae,depthPacking:void 0!==e.depthPacking&&e.depthPacking}},this.getProgramCode=function(e,t){var n=[];if(t.shaderID?n.push(t.shaderID):(n.push(e.fragmentShader),n.push(e.vertexShader)),void 0!==e.defines)for(var r in e.defines)n.push(r),n.push(e.defines[r]);for(var i=0;i<a.length;i++)n.push(t[a[i]]);return n.push(e.onBeforeCompile.toString()),n.push(d.gammaOutput),n.join()},this.acquireProgram=function(e,t,n,r){for(var i,a=0,o=u.length;a<o;a++){var s=u[a];if(s.code===r){++(i=s).usedTimes;break}}return void 0===i&&(i=new uo(d,l,r,e,t,n),u.push(i)),i},this.releaseProgram=function(e){if(0==--e.usedTimes){var t=u.indexOf(e);u[t]=u[u.length-1],u.pop(),e.destroy()}},this.programs=u}function ho(){var r=new WeakMap;return{get:function(e){var t=r.get(e);return void 0===t&&(t={},r.set(e,t)),t},remove:function(e){r.delete(e)},update:function(e,t,n){r.get(e)[t]=n},dispose:function(){r=new WeakMap}}}function fo(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program&&t.program&&e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function po(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function mo(){var o=[],s=0,l=[],u=[];return{opaque:l,transparent:u,init:function(){s=0,l.length=0,u.length=0},push:function(e,t,n,r,i){var a=o[s];void 0===a?(a={id:e.id,object:e,geometry:t,material:n,program:n.program,renderOrder:e.renderOrder,z:r,group:i},o[s]=a):(a.id=e.id,a.object=e,a.geometry=t,a.material=n,a.program=n.program,a.renderOrder=e.renderOrder,a.z=r,a.group=i),(!0===n.transparent?u:l).push(a),s++},sort:function(){1<l.length&&l.sort(fo),1<u.length&&u.sort(po)}}}function go(){var i={};return{get:function(e,t){var n=e.id+","+t.id,r=i[n];return void 0===r&&(r=new mo,i[n]=r),r},dispose:function(){i={}}}}function vo(){var n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];var t;switch(e.type){case"DirectionalLight":t={direction:new Yt,color:new Gn,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new zt};break;case"SpotLight":t={position:new Yt,direction:new Yt,color:new Gn,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new zt};break;case"PointLight":t={position:new Yt,color:new Gn,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new zt,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":t={direction:new Yt,skyColor:new Gn,groundColor:new Gn};break;case"RectAreaLight":t={color:new Gn,position:new Yt,halfWidth:new Yt,halfHeight:new Yt}}return n[e.id]=t}}}var yo,_o,bo,Eo,To,Ao,wo,So,Co,xo,Mo,Ro,Io,Po,Do,Lo,Oo,No,ko=0;function Bo(){var E=new vo,T={id:ko++,hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},A=new Yt,w=new Wt,S=new Wt;return{setup:function(e,t,n){for(var r=0,i=0,a=0,o=0,s=0,l=0,u=0,c=0,d=n.matrixWorldInverse,h=0,f=e.length;h<f;h++){var p=e[h],m=p.color,g=p.intensity,v=p.distance,y=p.shadow&&p.shadow.map?p.shadow.map.texture:null;if(p.isAmbientLight)r+=m.r*g,i+=m.g*g,a+=m.b*g;else if(p.isDirectionalLight){if((b=E.get(p)).color.copy(p.color).multiplyScalar(p.intensity),b.direction.setFromMatrixPosition(p.matrixWorld),A.setFromMatrixPosition(p.target.matrixWorld),b.direction.sub(A),b.direction.transformDirection(d),b.shadow=p.castShadow,p.castShadow){var _=p.shadow;b.shadowBias=_.bias,b.shadowRadius=_.radius,b.shadowMapSize=_.mapSize}T.directionalShadowMap[o]=y,T.directionalShadowMatrix[o]=p.shadow.matrix,T.directional[o]=b,o++}else if(p.isSpotLight){if((b=E.get(p)).position.setFromMatrixPosition(p.matrixWorld),b.position.applyMatrix4(d),b.color.copy(m).multiplyScalar(g),b.distance=v,b.direction.setFromMatrixPosition(p.matrixWorld),A.setFromMatrixPosition(p.target.matrixWorld),b.direction.sub(A),b.direction.transformDirection(d),b.coneCos=Math.cos(p.angle),b.penumbraCos=Math.cos(p.angle*(1-p.penumbra)),b.decay=0===p.distance?0:p.decay,b.shadow=p.castShadow,p.castShadow){_=p.shadow;b.shadowBias=_.bias,b.shadowRadius=_.radius,b.shadowMapSize=_.mapSize}T.spotShadowMap[l]=y,T.spotShadowMatrix[l]=p.shadow.matrix,T.spot[l]=b,l++}else if(p.isRectAreaLight){(b=E.get(p)).color.copy(m).multiplyScalar(g),b.position.setFromMatrixPosition(p.matrixWorld),b.position.applyMatrix4(d),S.identity(),w.copy(p.matrixWorld),w.premultiply(d),S.extractRotation(w),b.halfWidth.set(.5*p.width,0,0),b.halfHeight.set(0,.5*p.height,0),b.halfWidth.applyMatrix4(S),b.halfHeight.applyMatrix4(S),T.rectArea[u]=b,u++}else if(p.isPointLight){if((b=E.get(p)).position.setFromMatrixPosition(p.matrixWorld),b.position.applyMatrix4(d),b.color.copy(p.color).multiplyScalar(p.intensity),b.distance=p.distance,b.decay=0===p.distance?0:p.decay,b.shadow=p.castShadow,p.castShadow){_=p.shadow;b.shadowBias=_.bias,b.shadowRadius=_.radius,b.shadowMapSize=_.mapSize,b.shadowCameraNear=_.camera.near,b.shadowCameraFar=_.camera.far}T.pointShadowMap[s]=y,T.pointShadowMatrix[s]=p.shadow.matrix,T.point[s]=b,s++}else if(p.isHemisphereLight){var b;(b=E.get(p)).direction.setFromMatrixPosition(p.matrixWorld),b.direction.transformDirection(d),b.direction.normalize(),b.skyColor.copy(p.color).multiplyScalar(g),b.groundColor.copy(p.groundColor).multiplyScalar(g),T.hemi[c]=b,c++}}T.ambient[0]=r,T.ambient[1]=i,T.ambient[2]=a,T.directional.length=o,T.spot.length=l,T.rectArea.length=u,T.point.length=s,T.hemi.length=c,T.hash=T.id+","+o+","+s+","+l+","+u+","+c+","+t.length},state:T}}function Fo(){var t=new Bo,n=[],r=[],i=[];return{init:function(){n.length=0,r.length=0,i.length=0},state:{lightsArray:n,shadowsArray:r,spritesArray:i,lights:t},setupLights:function(e){t.setup(n,r,e)},pushLight:function(e){n.push(e)},pushShadow:function(e){r.push(e)},pushSprite:function(e){i.push(e)}}}function jo(){var i={};return{get:function(e,t){var n=e.id+","+t.id,r=i[n];return void 0===r&&(r=new Fo,i[n]=r),r},dispose:function(){i={}}}}function Uo(e){zi.call(this),this.type="MeshDepthMaterial",this.depthPacking=Ht,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(e)}function Ho(e){zi.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new Yt,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.lights=!1,this.setValues(e)}function Go(_,m,e){for(var b=new Bn,E=new Wt,T=new zt,A=new zt(e,e),w=new Yt,S=new Yt,v=1,y=2,t=1+(v|y),C=new Array(t),x=new Array(t),M={},R={0:Ae,1:k,2:Q},I=[new Yt(1,0,0),new Yt(-1,0,0),new Yt(0,0,1),new Yt(0,0,-1),new Yt(0,1,0),new Yt(0,-1,0)],P=[new Yt(0,1,0),new Yt(0,1,0),new Yt(0,1,0),new Yt(0,1,0),new Yt(0,0,1),new Yt(0,0,-1)],D=[new Mn,new Mn,new Mn,new Mn,new Mn,new Mn],n=0;n!==t;++n){var r=0!=(n&v),i=0!=(n&y),a=new Uo({depthPacking:Gt,morphTargets:r,skinning:i});C[n]=a;var o=new Ho({morphTargets:r,skinning:i});x[n]=o}var L=this;function g(e,t,n,r,i,a){var o=e.geometry,s=null,l=C,u=e.customDepthMaterial;if(n&&(l=x,u=e.customDistanceMaterial),u)s=u;else{var c=!1;t.morphTargets&&(o&&o.isBufferGeometry?c=o.morphAttributes&&o.morphAttributes.position&&0<o.morphAttributes.position.length:o&&o.isGeometry&&(c=o.morphTargets&&0<o.morphTargets.length)),e.isSkinnedMesh&&!1===t.skinning&&console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",e);var d=e.isSkinnedMesh&&t.skinning,h=0;c&&(h|=v),d&&(h|=y),s=l[h]}if(_.localClippingEnabled&&!0===t.clipShadows&&0!==t.clippingPlanes.length){var f=s.uuid,p=t.uuid,m=M[f];void 0===m&&(m={},M[f]=m);var g=m[p];void 0===g&&(g=s.clone(),m[p]=g),s=g}return s.visible=t.visible,s.wireframe=t.wireframe,s.side=null!=t.shadowSide?t.shadowSide:R[t.side],s.clipShadows=t.clipShadows,s.clippingPlanes=t.clippingPlanes,s.clipIntersection=t.clipIntersection,s.wireframeLinewidth=t.wireframeLinewidth,s.linewidth=t.linewidth,n&&s.isMeshDistanceMaterial&&(s.referencePosition.copy(r),s.nearDistance=i,s.farDistance=a),s}function O(e,t,n,r){if(!1!==e.visible){if(e.layers.test(t.layers)&&(e.isMesh||e.isLine||e.isPoints)&&e.castShadow&&(!e.frustumCulled||b.intersectsObject(e))){e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld);var i=m.update(e),a=e.material;if(Array.isArray(a))for(var o=i.groups,s=0,l=o.length;s<l;s++){var u=o[s],c=a[u.materialIndex];if(c&&c.visible){var d=g(e,c,r,S,n.near,n.far);_.renderBufferDirect(n,null,i,d,e,u)}}else if(a.visible){d=g(e,a,r,S,n.near,n.far);_.renderBufferDirect(n,null,i,d,e,null)}}for(var h=e.children,f=0,p=h.length;f<p;f++)O(h[f],t,n,r)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=N,this.render=function(e,t,n){if(!1!==L.enabled&&(!1!==L.autoUpdate||!1!==L.needsUpdate)&&0!==e.length){var r,i=_.context,a=_.state;a.disable(i.BLEND),a.buffers.color.setClear(1,1,1,1),a.buffers.depth.setTest(!0),a.setScissorTest(!1);for(var o=0,s=e.length;o<s;o++){var l=e[o],u=l.shadow,c=l&&l.isPointLight;if(void 0!==u){var d=u.camera;if(T.copy(u.mapSize),T.min(A),c){var h=T.x,f=T.y;D[0].set(2*h,f,h,f),D[1].set(0,f,h,f),D[2].set(3*h,f,h,f),D[3].set(h,f,h,f),D[4].set(3*h,0,h,f),D[5].set(h,0,h,f),T.x*=4,T.y*=2}if(null===u.map){var p={minFilter:je,magFilter:je,format:at};u.map=new Rn(T.x,T.y,p),u.map.texture.name=l.name+".shadowMap",d.updateProjectionMatrix()}u.isSpotLightShadow&&u.update(l);var m=u.map,g=u.matrix;S.setFromMatrixPosition(l.matrixWorld),d.position.copy(S),c?(r=6,g.makeTranslation(-S.x,-S.y,-S.z)):(r=1,w.setFromMatrixPosition(l.target.matrixWorld),d.lookAt(w),d.updateMatrixWorld(),g.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),g.multiply(d.projectionMatrix),g.multiply(d.matrixWorldInverse)),_.setRenderTarget(m),_.clear();for(var v=0;v<r;v++){if(c){w.copy(d.position),w.add(I[v]),d.up.copy(P[v]),d.lookAt(w),d.updateMatrixWorld();var y=D[v];a.viewport(y)}E.multiplyMatrices(d.projectionMatrix,d.matrixWorldInverse),b.setFromMatrix(E),O(t,n,d,c)}}else console.warn("THREE.WebGLShadowMap:",l,"has no shadow.")}L.needsUpdate=!1}}}function Vo(e,t,n,r,i,a,o,s,l){xn.call(this,e,t,n,r,i,a,o,s,l),this.needsUpdate=!0}function zo(f,p,m,g,i){var v,y,_,b,E,T,A=new Yt,w=new qt,S=new Yt;function C(){var e=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),t=new Uint16Array([0,1,2,0,2,3]);v=p.createBuffer(),y=p.createBuffer(),p.bindBuffer(p.ARRAY_BUFFER,v),p.bufferData(p.ARRAY_BUFFER,e,p.STATIC_DRAW),p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,y),p.bufferData(p.ELEMENT_ARRAY_BUFFER,t,p.STATIC_DRAW),_=function(){var e=p.createProgram(),t=p.createShader(p.VERTEX_SHADER),n=p.createShader(p.FRAGMENT_SHADER);return p.shaderSource(t,["precision "+i.precision+" float;","#define SHADER_NAME SpriteMaterial","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 center;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float fogDepth;","void main() {","\tvUV = uvOffset + uv * uvScale;","\tvec2 alignedPosition = ( position - center ) * scale;","\tvec2 rotatedPosition;","\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","\tvec4 mvPosition;","\tmvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","\tmvPosition.xy += rotatedPosition;","\tgl_Position = projectionMatrix * mvPosition;","\tfogDepth = - mvPosition.z;","}"].join("\n")),p.shaderSource(n,["precision "+i.precision+" float;","#define SHADER_NAME SpriteMaterial","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","varying float fogDepth;","void main() {","\tvec4 texture = texture2D( map, vUV );","\tgl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","\tif ( gl_FragColor.a < alphaTest ) discard;","\tif ( fogType > 0 ) {","\t\tfloat fogFactor = 0.0;","\t\tif ( fogType == 1 ) {","\t\t\tfogFactor = smoothstep( fogNear, fogFar, fogDepth );","\t\t} else {","\t\t\tconst float LOG2 = 1.442695;","\t\t\tfogFactor = exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 );","\t\t\tfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","\t\t}","\t\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );","\t}","}"].join("\n")),p.compileShader(t),p.compileShader(n),p.attachShader(e,t),p.attachShader(e,n),p.linkProgram(e),e}(),b={position:p.getAttribLocation(_,"position"),uv:p.getAttribLocation(_,"uv")},E={uvOffset:p.getUniformLocation(_,"uvOffset"),uvScale:p.getUniformLocation(_,"uvScale"),rotation:p.getUniformLocation(_,"rotation"),center:p.getUniformLocation(_,"center"),scale:p.getUniformLocation(_,"scale"),color:p.getUniformLocation(_,"color"),map:p.getUniformLocation(_,"map"),opacity:p.getUniformLocation(_,"opacity"),modelViewMatrix:p.getUniformLocation(_,"modelViewMatrix"),projectionMatrix:p.getUniformLocation(_,"projectionMatrix"),fogType:p.getUniformLocation(_,"fogType"),fogDensity:p.getUniformLocation(_,"fogDensity"),fogNear:p.getUniformLocation(_,"fogNear"),fogFar:p.getUniformLocation(_,"fogFar"),fogColor:p.getUniformLocation(_,"fogColor"),fogDepth:p.getUniformLocation(_,"fogDepth"),alphaTest:p.getUniformLocation(_,"alphaTest")};var n=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");n.width=8,n.height=8;var r=n.getContext("2d");r.fillStyle="white",r.fillRect(0,0,8,8),T=new Vo(n)}function x(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:t.id-e.id}this.render=function(e,t,n){if(0!==e.length){void 0===_&&C(),m.useProgram(_),m.initAttributes(),m.enableAttribute(b.position),m.enableAttribute(b.uv),m.disableUnusedAttributes(),m.disable(p.CULL_FACE),m.enable(p.BLEND),p.bindBuffer(p.ARRAY_BUFFER,v),p.vertexAttribPointer(b.position,2,p.FLOAT,!1,16,0),p.vertexAttribPointer(b.uv,2,p.FLOAT,!1,16,8),p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,y),p.uniformMatrix4fv(E.projectionMatrix,!1,n.projectionMatrix.elements),m.activeTexture(p.TEXTURE0),p.uniform1i(E.map,0);var r=0,i=0,a=t.fog;a?(p.uniform3f(E.fogColor,a.color.r,a.color.g,a.color.b),a.isFog?(p.uniform1f(E.fogNear,a.near),p.uniform1f(E.fogFar,a.far),p.uniform1i(E.fogType,1),i=r=1):a.isFogExp2&&(p.uniform1f(E.fogDensity,a.density),p.uniform1i(E.fogType,2),i=r=2)):(p.uniform1i(E.fogType,0),i=r=0);for(var o=0,s=e.length;o<s;o++){(c=e[o]).modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,c.matrixWorld),c.z=-c.modelViewMatrix.elements[14]}e.sort(x);var l=[],u=[];for(o=0,s=e.length;o<s;o++){var c,d=(c=e[o]).material;if(!1!==d.visible){c.onBeforeRender(f,t,n,void 0,d,void 0),p.uniform1f(E.alphaTest,d.alphaTest),p.uniformMatrix4fv(E.modelViewMatrix,!1,c.modelViewMatrix.elements),c.matrixWorld.decompose(A,w,S),l[0]=S.x,l[1]=S.y,u[0]=c.center.x-.5,u[1]=c.center.y-.5;var h=0;t.fog&&d.fog&&(h=i),r!==h&&(p.uniform1i(E.fogType,h),r=h),null!==d.map?(p.uniform2f(E.uvOffset,d.map.offset.x,d.map.offset.y),p.uniform2f(E.uvScale,d.map.repeat.x,d.map.repeat.y)):(p.uniform2f(E.uvOffset,0,0),p.uniform2f(E.uvScale,1,1)),p.uniform1f(E.opacity,d.opacity),p.uniform3f(E.color,d.color.r,d.color.g,d.color.b),p.uniform1f(E.rotation,d.rotation),p.uniform2fv(E.center,u),p.uniform2fv(E.scale,l),m.setBlending(d.blending,d.blendEquation,d.blendSrc,d.blendDst,d.blendEquationAlpha,d.blendSrcAlpha,d.blendDstAlpha,d.premultipliedAlpha),m.buffers.depth.setTest(d.depthTest),m.buffers.depth.setMask(d.depthWrite),m.buffers.color.setMask(d.colorWrite),g.setTexture2D(d.map||T,0),p.drawElements(p.TRIANGLES,6,p.UNSIGNED_SHORT,0),c.onAfterRender(f,t,n,void 0,d,void 0)}}m.enable(p.CULL_FACE),m.reset()}}}function Wo(c,n,l){var r=new function(){var t=!1,a=new Mn,n=null,o=new Mn(0,0,0,0);return{setMask:function(e){n===e||t||(c.colorMask(e,e,e,e),n=e)},setLocked:function(e){t=e},setClear:function(e,t,n,r,i){!0===i&&(e*=r,t*=r,n*=r),a.set(e,t,n,r),!1===o.equals(a)&&(c.clearColor(e,t,n,r),o.copy(a))},reset:function(){t=!1,n=null,o.set(-1,0,0,0)}}},i=new function(){var t=!1,n=null,r=null,i=null;return{setTest:function(e){e?B(c.DEPTH_TEST):F(c.DEPTH_TEST)},setMask:function(e){n===e||t||(c.depthMask(e),n=e)},setFunc:function(e){if(r!==e){if(e)switch(e){case de:c.depthFunc(c.NEVER);break;case he:c.depthFunc(c.ALWAYS);break;case fe:c.depthFunc(c.LESS);break;case pe:c.depthFunc(c.LEQUAL);break;case me:c.depthFunc(c.EQUAL);break;case ge:c.depthFunc(c.GEQUAL);break;case ve:c.depthFunc(c.GREATER);break;case ye:c.depthFunc(c.NOTEQUAL);break;default:c.depthFunc(c.LEQUAL)}else c.depthFunc(c.LEQUAL);r=e}},setLocked:function(e){t=e},setClear:function(e){i!==e&&(c.clearDepth(e),i=e)},reset:function(){t=!1,i=r=n=null}}},t=new function(){var t=!1,n=null,r=null,i=null,a=null,o=null,s=null,l=null,u=null;return{setTest:function(e){e?B(c.STENCIL_TEST):F(c.STENCIL_TEST)},setMask:function(e){n===e||t||(c.stencilMask(e),n=e)},setFunc:function(e,t,n){r===e&&i===t&&a===n||(c.stencilFunc(e,t,n),r=e,i=t,a=n)},setOp:function(e,t,n){o===e&&s===t&&l===n||(c.stencilOp(e,t,n),o=e,s=t,l=n)},setLocked:function(e){t=e},setClear:function(e){u!==e&&(c.clearStencil(e),u=e)},reset:function(){t=!1,u=l=s=o=a=i=r=n=null}}},e=c.getParameter(c.MAX_VERTEX_ATTRIBS),a=new Uint8Array(e),o=new Uint8Array(e),s=new Uint8Array(e),u={},d=null,h=null,f=null,p=null,m=null,g=null,v=null,y=null,_=null,b=!1,E=null,T=null,A=null,w=null,S=null,C=c.getParameter(c.MAX_COMBINED_TEXTURE_IMAGE_UNITS),x=!1,M=0,R=c.getParameter(c.VERSION);-1!==R.indexOf("WebGL")?(M=parseFloat(/^WebGL\ ([0-9])/.exec(R)[1]),x=1<=M):-1!==R.indexOf("OpenGL ES")&&(M=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(R)[1]),x=2<=M);var I=null,P={},D=new Mn,L=new Mn;function O(e,t,n){var r=new Uint8Array(4),i=c.createTexture();c.bindTexture(e,i),c.texParameteri(e,c.TEXTURE_MIN_FILTER,c.NEAREST),c.texParameteri(e,c.TEXTURE_MAG_FILTER,c.NEAREST);for(var a=0;a<n;a++)c.texImage2D(t+a,0,c.RGBA,1,1,0,c.RGBA,c.UNSIGNED_BYTE,r);return i}var N={};function k(e,t){a[e]=1,0===o[e]&&(c.enableVertexAttribArray(e),o[e]=1),s[e]!==t&&(n.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(e,t),s[e]=t)}function B(e){!0!==u[e]&&(c.enable(e),u[e]=!0)}function F(e){!1!==u[e]&&(c.disable(e),u[e]=!1)}function j(e,t,n,r,i,a,o,s){if(e!==Z?B(c.BLEND):F(c.BLEND),e!==ne){if(e!==f||s!==b)switch(e){case $:s?(c.blendEquationSeparate(c.FUNC_ADD,c.FUNC_ADD),c.blendFuncSeparate(c.ONE,c.ONE,c.ONE,c.ONE)):(c.blendEquation(c.FUNC_ADD),c.blendFunc(c.SRC_ALPHA,c.ONE));break;case ee:s?(c.blendEquationSeparate(c.FUNC_ADD,c.FUNC_ADD),c.blendFuncSeparate(c.ZERO,c.ZERO,c.ONE_MINUS_SRC_COLOR,c.ONE_MINUS_SRC_ALPHA)):(c.blendEquation(c.FUNC_ADD),c.blendFunc(c.ZERO,c.ONE_MINUS_SRC_COLOR));break;case te:s?(c.blendEquationSeparate(c.FUNC_ADD,c.FUNC_ADD),c.blendFuncSeparate(c.ZERO,c.SRC_COLOR,c.ZERO,c.SRC_ALPHA)):(c.blendEquation(c.FUNC_ADD),c.blendFunc(c.ZERO,c.SRC_COLOR));break;default:s?(c.blendEquationSeparate(c.FUNC_ADD,c.FUNC_ADD),c.blendFuncSeparate(c.ONE,c.ONE_MINUS_SRC_ALPHA,c.ONE,c.ONE_MINUS_SRC_ALPHA)):(c.blendEquationSeparate(c.FUNC_ADD,c.FUNC_ADD),c.blendFuncSeparate(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA,c.ONE,c.ONE_MINUS_SRC_ALPHA))}_=y=v=g=m=p=null}else i=i||t,a=a||n,o=o||r,t===p&&i===v||(c.blendEquationSeparate(l.convert(t),l.convert(i)),p=t,v=i),n===m&&r===g&&a===y&&o===_||(c.blendFuncSeparate(l.convert(n),l.convert(r),l.convert(a),l.convert(o)),m=n,g=r,y=a,_=o);f=e,b=s}function U(e){E!==e&&(e?c.frontFace(c.CW):c.frontFace(c.CCW),E=e)}function H(e){e!==z?(B(c.CULL_FACE),e!==T&&(e===W?c.cullFace(c.BACK):e===X?c.cullFace(c.FRONT):c.cullFace(c.FRONT_AND_BACK))):F(c.CULL_FACE),T=e}function G(e,t,n){e?(B(c.POLYGON_OFFSET_FILL),w===t&&S===n||(c.polygonOffset(t,n),w=t,S=n)):F(c.POLYGON_OFFSET_FILL)}function V(e){void 0===e&&(e=c.TEXTURE0+C-1),I!==e&&(c.activeTexture(e),I=e)}return N[c.TEXTURE_2D]=O(c.TEXTURE_2D,c.TEXTURE_2D,1),N[c.TEXTURE_CUBE_MAP]=O(c.TEXTURE_CUBE_MAP,c.TEXTURE_CUBE_MAP_POSITIVE_X,6),r.setClear(0,0,0,1),i.setClear(1),t.setClear(0),B(c.DEPTH_TEST),i.setFunc(pe),U(!1),H(W),B(c.CULL_FACE),B(c.BLEND),j(J),{buffers:{color:r,depth:i,stencil:t},initAttributes:function(){for(var e=0,t=a.length;e<t;e++)a[e]=0},enableAttribute:function(e){k(e,0)},enableAttributeAndDivisor:k,disableUnusedAttributes:function(){for(var e=0,t=o.length;e!==t;++e)o[e]!==a[e]&&(c.disableVertexAttribArray(e),o[e]=0)},enable:B,disable:F,getCompressedTextureFormats:function(){if(null===d&&(d=[],n.get("WEBGL_compressed_texture_pvrtc")||n.get("WEBGL_compressed_texture_s3tc")||n.get("WEBGL_compressed_texture_etc1")||n.get("WEBGL_compressed_texture_astc")))for(var e=c.getParameter(c.COMPRESSED_TEXTURE_FORMATS),t=0;t<e.length;t++)d.push(e[t]);return d},useProgram:function(e){return h!==e&&(c.useProgram(e),h=e,!0)},setBlending:j,setMaterial:function(e,t){e.side===Q?F(c.CULL_FACE):B(c.CULL_FACE);var n=e.side===Ae;t&&(n=!n),U(n),!0===e.transparent?j(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha):j(Z),i.setFunc(e.depthFunc),i.setTest(e.depthTest),i.setMask(e.depthWrite),r.setMask(e.colorWrite),G(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)},setFlipSided:U,setCullFace:H,setLineWidth:function(e){e!==A&&(x&&c.lineWidth(e),A=e)},setPolygonOffset:G,setScissorTest:function(e){e?B(c.SCISSOR_TEST):F(c.SCISSOR_TEST)},activeTexture:V,bindTexture:function(e,t){null===I&&V();var n=P[I];void 0===n&&(n={type:void 0,texture:void 0},P[I]=n),n.type===e&&n.texture===t||(c.bindTexture(e,t||N[e]),n.type=e,n.texture=t)},compressedTexImage2D:function(){try{c.compressedTexImage2D.apply(c,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{c.texImage2D.apply(c,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(e){!1===D.equals(e)&&(c.scissor(e.x,e.y,e.z,e.w),D.copy(e))},viewport:function(e){!1===L.equals(e)&&(c.viewport(e.x,e.y,e.z,e.w),L.copy(e))},reset:function(){for(var e=0;e<o.length;e++)1===o[e]&&(c.disableVertexAttribArray(e),o[e]=0);u={},P={},T=E=f=h=I=d=null,r.reset(),i.reset(),t.reset()}}}function qo(m,i,g,v,y,_,b){var h,f="undefined"!=typeof WebGL2RenderingContext&&m instanceof WebGL2RenderingContext,a={};function E(e,t){if(e.width>t||e.height>t){if("data"in e)return void console.warn("THREE.WebGLRenderer: image in DataTexture is too big ("+e.width+"x"+e.height+").");var n=t/Math.max(e.width,e.height),r=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return r.width=Math.floor(e.width*n),r.height=Math.floor(e.height*n),r.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,r.width,r.height),console.warn("THREE.WebGLRenderer: image is too big ("+e.width+"x"+e.height+"). Resized to "+r.width+"x"+r.height,e),r}return e}function T(e){return Vt.isPowerOfTwo(e.width)&&Vt.isPowerOfTwo(e.height)}function A(e,t){return e.generateMipmaps&&t&&e.minFilter!==je&&e.minFilter!==Ge}function w(e,t,n,r){m.generateMipmap(e),v.get(t).__maxMipLevel=Math.log(Math.max(n,r))*Math.LOG2E}function o(e){return e===je||e===Ue||e===He?m.NEAREST:m.LINEAR}function S(e){var t=e.target;t.removeEventListener("dispose",S),function(e){var t=v.get(e);if(e.image&&t.__image__webglTextureCube)m.deleteTexture(t.__image__webglTextureCube);else{if(void 0===t.__webglInit)return;m.deleteTexture(t.__webglTexture)}v.remove(e)}(t),t.isVideoTexture&&delete a[t.id],b.memory.textures--}function s(e){var t=e.target;t.removeEventListener("dispose",s),function(e){var t=v.get(e),n=v.get(e.texture);if(!e)return;void 0!==n.__webglTexture&&m.deleteTexture(n.__webglTexture);e.depthTexture&&e.depthTexture.dispose();if(e.isWebGLRenderTargetCube)for(var r=0;r<6;r++)m.deleteFramebuffer(t.__webglFramebuffer[r]),t.__webglDepthbuffer&&m.deleteRenderbuffer(t.__webglDepthbuffer[r]);else m.deleteFramebuffer(t.__webglFramebuffer),t.__webglDepthbuffer&&m.deleteRenderbuffer(t.__webglDepthbuffer);v.remove(e.texture),v.remove(e)}(t),b.memory.textures--}function l(e,t){var n=v.get(e);if(e.isVideoTexture&&function(e){var t=e.id,n=b.render.frame;a[t]!==n&&(a[t]=n,e.update())}(e),0<e.version&&n.__version!==e.version){var r=e.image;if(void 0===r)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",e);else{if(!1!==r.complete)return void function(e,t,n){void 0===e.__webglInit&&(e.__webglInit=!0,t.addEventListener("dispose",S),e.__webglTexture=m.createTexture(),b.memory.textures++);g.activeTexture(m.TEXTURE0+n),g.bindTexture(m.TEXTURE_2D,e.__webglTexture),m.pixelStorei(m.UNPACK_FLIP_Y_WEBGL,t.flipY),m.pixelStorei(m.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),m.pixelStorei(m.UNPACK_ALIGNMENT,t.unpackAlignment);var r=E(t.image,y.maxTextureSize);!function(e){return e.wrapS!==Be||e.wrapT!==Be||e.minFilter!==je&&e.minFilter!==Ge}(t)||!1!==T(r)||(r=function(e){return e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof ImageBitmap?(void 0===h&&(h=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),h.width=Vt.floorPowerOfTwo(e.width),h.height=Vt.floorPowerOfTwo(e.height),h.getContext("2d").drawImage(e,0,0,h.width,h.height),console.warn("THREE.WebGLRenderer: image is not power of two ("+e.width+"x"+e.height+"). Resized to "+h.width+"x"+h.height,e),h):e}(r));var i=T(r),a=_.convert(t.format),o=_.convert(t.type);C(m.TEXTURE_2D,t,i);var s,l=t.mipmaps;if(t.isDepthTexture){var u=m.DEPTH_COMPONENT;if(t.type===Ze){if(!f)throw new Error("Float Depth Texture only supported in WebGL2.0");u=m.DEPTH_COMPONENT32F}else f&&(u=m.DEPTH_COMPONENT16);t.format===lt&&u===m.DEPTH_COMPONENT&&t.type!==Ke&&t.type!==Qe&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),t.type=Ke,o=_.convert(t.type)),t.format===ut&&(u=m.DEPTH_STENCIL,t.type!==nt&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),t.type=nt,o=_.convert(t.type))),g.texImage2D(m.TEXTURE_2D,0,u,r.width,r.height,0,a,o,null)}else if(t.isDataTexture)if(0<l.length&&i){for(var c=0,d=l.length;c<d;c++)s=l[c],g.texImage2D(m.TEXTURE_2D,c,a,s.width,s.height,0,a,o,s.data);t.generateMipmaps=!1,e.__maxMipLevel=l.length-1}else g.texImage2D(m.TEXTURE_2D,0,a,r.width,r.height,0,a,o,r.data),e.__maxMipLevel=0;else if(t.isCompressedTexture){for(c=0,d=l.length;c<d;c++)s=l[c],t.format!==at&&t.format!==it?-1<g.getCompressedTextureFormats().indexOf(a)?g.compressedTexImage2D(m.TEXTURE_2D,c,a,s.width,s.height,0,s.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):g.texImage2D(m.TEXTURE_2D,c,a,s.width,s.height,0,a,o,s.data);e.__maxMipLevel=l.length-1}else if(0<l.length&&i){for(c=0,d=l.length;c<d;c++)s=l[c],g.texImage2D(m.TEXTURE_2D,c,a,a,o,s);t.generateMipmaps=!1,e.__maxMipLevel=l.length-1}else g.texImage2D(m.TEXTURE_2D,0,a,a,o,r),e.__maxMipLevel=0;A(t,i)&&w(m.TEXTURE_2D,t,r.width,r.height);e.__version=t.version,t.onUpdate&&t.onUpdate(t)}(n,e,t);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",e)}}g.activeTexture(m.TEXTURE0+t),g.bindTexture(m.TEXTURE_2D,n.__webglTexture)}function C(e,t,n){var r;if(n?(m.texParameteri(e,m.TEXTURE_WRAP_S,_.convert(t.wrapS)),m.texParameteri(e,m.TEXTURE_WRAP_T,_.convert(t.wrapT)),m.texParameteri(e,m.TEXTURE_MAG_FILTER,_.convert(t.magFilter)),m.texParameteri(e,m.TEXTURE_MIN_FILTER,_.convert(t.minFilter))):(m.texParameteri(e,m.TEXTURE_WRAP_S,m.CLAMP_TO_EDGE),m.texParameteri(e,m.TEXTURE_WRAP_T,m.CLAMP_TO_EDGE),t.wrapS===Be&&t.wrapT===Be||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",t),m.texParameteri(e,m.TEXTURE_MAG_FILTER,o(t.magFilter)),m.texParameteri(e,m.TEXTURE_MIN_FILTER,o(t.minFilter)),t.minFilter!==je&&t.minFilter!==Ge&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",t)),r=i.get("EXT_texture_filter_anisotropic")){if(t.type===Ze&&null===i.get("OES_texture_float_linear"))return;if(t.type===Je&&null===i.get("OES_texture_half_float_linear"))return;(1<t.anisotropy||v.get(t).__currentAnisotropy)&&(m.texParameterf(e,r.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(t.anisotropy,y.getMaxAnisotropy())),v.get(t).__currentAnisotropy=t.anisotropy)}}function u(e,t,n,r){var i=_.convert(t.texture.format),a=_.convert(t.texture.type);g.texImage2D(r,0,i,t.width,t.height,0,i,a,null),m.bindFramebuffer(m.FRAMEBUFFER,e),m.framebufferTexture2D(m.FRAMEBUFFER,n,r,v.get(t.texture).__webglTexture,0),m.bindFramebuffer(m.FRAMEBUFFER,null)}function c(e,t){m.bindRenderbuffer(m.RENDERBUFFER,e),t.depthBuffer&&!t.stencilBuffer?(m.renderbufferStorage(m.RENDERBUFFER,m.DEPTH_COMPONENT16,t.width,t.height),m.framebufferRenderbuffer(m.FRAMEBUFFER,m.DEPTH_ATTACHMENT,m.RENDERBUFFER,e)):t.depthBuffer&&t.stencilBuffer?(m.renderbufferStorage(m.RENDERBUFFER,m.DEPTH_STENCIL,t.width,t.height),m.framebufferRenderbuffer(m.FRAMEBUFFER,m.DEPTH_STENCIL_ATTACHMENT,m.RENDERBUFFER,e)):m.renderbufferStorage(m.RENDERBUFFER,m.RGBA4,t.width,t.height),m.bindRenderbuffer(m.RENDERBUFFER,null)}function d(e){var t=v.get(e),n=!0===e.isWebGLRenderTargetCube;if(e.depthTexture){if(n)throw new Error("target.depthTexture not supported in Cube render targets");!function(e,t){if(t&&t.isWebGLRenderTargetCube)throw new Error("Depth Texture with cube render targets is not supported");if(m.bindFramebuffer(m.FRAMEBUFFER,e),!t.depthTexture||!t.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");v.get(t.depthTexture).__webglTexture&&t.depthTexture.image.width===t.width&&t.depthTexture.image.height===t.height||(t.depthTexture.image.width=t.width,t.depthTexture.image.height=t.height,t.depthTexture.needsUpdate=!0),l(t.depthTexture,0);var n=v.get(t.depthTexture).__webglTexture;if(t.depthTexture.format===lt)m.framebufferTexture2D(m.FRAMEBUFFER,m.DEPTH_ATTACHMENT,m.TEXTURE_2D,n,0);else{if(t.depthTexture.format!==ut)throw new Error("Unknown depthTexture format");m.framebufferTexture2D(m.FRAMEBUFFER,m.DEPTH_STENCIL_ATTACHMENT,m.TEXTURE_2D,n,0)}}(t.__webglFramebuffer,e)}else if(n){t.__webglDepthbuffer=[];for(var r=0;r<6;r++)m.bindFramebuffer(m.FRAMEBUFFER,t.__webglFramebuffer[r]),t.__webglDepthbuffer[r]=m.createRenderbuffer(),c(t.__webglDepthbuffer[r],e)}else m.bindFramebuffer(m.FRAMEBUFFER,t.__webglFramebuffer),t.__webglDepthbuffer=m.createRenderbuffer(),c(t.__webglDepthbuffer,e);m.bindFramebuffer(m.FRAMEBUFFER,null)}this.setTexture2D=l,this.setTextureCube=function(e,t){var n=v.get(e);if(6===e.image.length)if(0<e.version&&n.__version!==e.version){n.__image__webglTextureCube||(e.addEventListener("dispose",S),n.__image__webglTextureCube=m.createTexture(),b.memory.textures++),g.activeTexture(m.TEXTURE0+t),g.bindTexture(m.TEXTURE_CUBE_MAP,n.__image__webglTextureCube),m.pixelStorei(m.UNPACK_FLIP_Y_WEBGL,e.flipY);for(var r=e&&e.isCompressedTexture,i=e.image[0]&&e.image[0].isDataTexture,a=[],o=0;o<6;o++)a[o]=r||i?i?e.image[o].image:e.image[o]:E(e.image[o],y.maxCubemapSize);var s=a[0],l=T(s),u=_.convert(e.format),c=_.convert(e.type);C(m.TEXTURE_CUBE_MAP,e,l);for(o=0;o<6;o++)if(r)for(var d,h=a[o].mipmaps,f=0,p=h.length;f<p;f++)d=h[f],e.format!==at&&e.format!==it?-1<g.getCompressedTextureFormats().indexOf(u)?g.compressedTexImage2D(m.TEXTURE_CUBE_MAP_POSITIVE_X+o,f,u,d.width,d.height,0,d.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):g.texImage2D(m.TEXTURE_CUBE_MAP_POSITIVE_X+o,f,u,d.width,d.height,0,u,c,d.data);else i?g.texImage2D(m.TEXTURE_CUBE_MAP_POSITIVE_X+o,0,u,a[o].width,a[o].height,0,u,c,a[o].data):g.texImage2D(m.TEXTURE_CUBE_MAP_POSITIVE_X+o,0,u,u,c,a[o]);n.__maxMipLevel=r?h.length-1:0,A(e,l)&&w(m.TEXTURE_CUBE_MAP,e,s.width,s.height),n.__version=e.version,e.onUpdate&&e.onUpdate(e)}else g.activeTexture(m.TEXTURE0+t),g.bindTexture(m.TEXTURE_CUBE_MAP,n.__image__webglTextureCube)},this.setTextureCubeDynamic=function(e,t){g.activeTexture(m.TEXTURE0+t),g.bindTexture(m.TEXTURE_CUBE_MAP,v.get(e).__webglTexture)},this.setupRenderTarget=function(e){var t=v.get(e),n=v.get(e.texture);e.addEventListener("dispose",s),n.__webglTexture=m.createTexture(),b.memory.textures++;var r=!0===e.isWebGLRenderTargetCube,i=T(e);if(r){t.__webglFramebuffer=[];for(var a=0;a<6;a++)t.__webglFramebuffer[a]=m.createFramebuffer()}else t.__webglFramebuffer=m.createFramebuffer();if(r){g.bindTexture(m.TEXTURE_CUBE_MAP,n.__webglTexture),C(m.TEXTURE_CUBE_MAP,e.texture,i);for(a=0;a<6;a++)u(t.__webglFramebuffer[a],e,m.COLOR_ATTACHMENT0,m.TEXTURE_CUBE_MAP_POSITIVE_X+a);A(e.texture,i)&&w(m.TEXTURE_CUBE_MAP,e.texture,e.width,e.height),g.bindTexture(m.TEXTURE_CUBE_MAP,null)}else g.bindTexture(m.TEXTURE_2D,n.__webglTexture),C(m.TEXTURE_2D,e.texture,i),u(t.__webglFramebuffer,e,m.COLOR_ATTACHMENT0,m.TEXTURE_2D),A(e.texture,i)&&w(m.TEXTURE_2D,e.texture,e.width,e.height),g.bindTexture(m.TEXTURE_2D,null);e.depthBuffer&&d(e)},this.updateRenderTargetMipmap=function(e){var t=e.texture;if(A(t,T(e))){var n=e.isWebGLRenderTargetCube?m.TEXTURE_CUBE_MAP:m.TEXTURE_2D,r=v.get(t).__webglTexture;g.bindTexture(n,r),w(n,t,e.width,e.height),g.bindTexture(n,null)}}}function Yo(n,r){return{convert:function(e){var t;if(e===ke)return n.REPEAT;if(e===Be)return n.CLAMP_TO_EDGE;if(e===Fe)return n.MIRRORED_REPEAT;if(e===je)return n.NEAREST;if(e===Ue)return n.NEAREST_MIPMAP_NEAREST;if(e===He)return n.NEAREST_MIPMAP_LINEAR;if(e===Ge)return n.LINEAR;if(e===Ve)return n.LINEAR_MIPMAP_NEAREST;if(e===ze)return n.LINEAR_MIPMAP_LINEAR;if(e===We)return n.UNSIGNED_BYTE;if(e===$e)return n.UNSIGNED_SHORT_4_4_4_4;if(e===et)return n.UNSIGNED_SHORT_5_5_5_1;if(e===tt)return n.UNSIGNED_SHORT_5_6_5;if(e===qe)return n.BYTE;if(e===Ye)return n.SHORT;if(e===Ke)return n.UNSIGNED_SHORT;if(e===Xe)return n.INT;if(e===Qe)return n.UNSIGNED_INT;if(e===Ze)return n.FLOAT;if(e===Je&&null!==(t=r.get("OES_texture_half_float")))return t.HALF_FLOAT_OES;if(e===rt)return n.ALPHA;if(e===it)return n.RGB;if(e===at)return n.RGBA;if(e===ot)return n.LUMINANCE;if(e===st)return n.LUMINANCE_ALPHA;if(e===lt)return n.DEPTH_COMPONENT;if(e===ut)return n.DEPTH_STENCIL;if(e===O)return n.FUNC_ADD;if(e===B)return n.FUNC_SUBTRACT;if(e===F)return n.FUNC_REVERSE_SUBTRACT;if(e===H)return n.ZERO;if(e===G)return n.ONE;if(e===V)return n.SRC_COLOR;if(e===re)return n.ONE_MINUS_SRC_COLOR;if(e===ie)return n.SRC_ALPHA;if(e===ae)return n.ONE_MINUS_SRC_ALPHA;if(e===oe)return n.DST_ALPHA;if(e===se)return n.ONE_MINUS_DST_ALPHA;if(e===le)return n.DST_COLOR;if(e===ue)return n.ONE_MINUS_DST_COLOR;if(e===ce)return n.SRC_ALPHA_SATURATE;if((e===ct||e===dt||e===ht||e===ft)&&null!==(t=r.get("WEBGL_compressed_texture_s3tc"))){if(e===ct)return t.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===dt)return t.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===ht)return t.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===ft)return t.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((e===pt||e===mt||e===gt||e===vt)&&null!==(t=r.get("WEBGL_compressed_texture_pvrtc"))){if(e===pt)return t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===mt)return t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===gt)return t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===vt)return t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(e===yt&&null!==(t=r.get("WEBGL_compressed_texture_etc1")))return t.COMPRESSED_RGB_ETC1_WEBGL;if((e===_t||e===bt||e===Et||e===Tt||e===At||e===wt||e===St||e===Ct||e===xt||e===Mt||e===Rt||e===It||e===Pt||e===Dt)&&null!==(t=r.get("WEBGL_compressed_texture_astc")))return e;if((e===j||e===U)&&null!==(t=r.get("EXT_blend_minmax"))){if(e===j)return t.MIN_EXT;if(e===U)return t.MAX_EXT}return e===nt&&null!==(t=r.get("WEBGL_depth_texture"))?t.UNSIGNED_INT_24_8_WEBGL:0}}}function Ko(e,t,n,r){yr.call(this),this.type="PerspectiveCamera",this.fov=void 0!==e?e:50,this.zoom=1,this.near=void 0!==n?n:.1,this.far=void 0!==r?r:2e3,this.focus=10,this.aspect=void 0!==t?t:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function Xo(e){Ko.call(this),this.cameras=e||[]}function Qo(r){var s=this,l=null,u=null,c=null,d=new Wt,h=new Wt;"undefined"!=typeof window&&"VRFrameData"in window&&(u=new window.VRFrameData,window.addEventListener("vrdisplaypresentchange",e,!1));var f=new Wt,p=new qt,m=new Yt,g=new Ko;g.bounds=new Mn(0,0,.5,1),g.layers.enable(1);var v=new Ko;v.bounds=new Mn(.5,0,.5,1),v.layers.enable(2);var i,a,y=new Xo([g,v]);function o(){return null!==l&&!0===l.isPresenting}function e(){if(o()){var e=l.getEyeParameters("left"),t=e.renderWidth,n=e.renderHeight;a=r.getPixelRatio(),i=r.getSize(),r.setDrawingBufferSize(2*t,n,1),_.start()}else s.enabled&&(r.setDrawingBufferSize(i.width,i.height,a),_.stop())}y.layers.enable(1),y.layers.enable(2),this.enabled=!1,this.userHeight=1.6,this.getDevice=function(){return l},this.setDevice=function(e){void 0!==e&&(l=e),_.setContext(e)},this.setPoseTarget=function(e){void 0!==e&&(c=e)},this.getCamera=function(e){if(null===l)return e;l.depthNear=e.near,l.depthFar=e.far,l.getFrameData(u);var t=l.stageParameters;t?d.fromArray(t.sittingToStandingTransform):d.makeTranslation(0,s.userHeight,0);var n=u.pose,r=null!==c?c:e;if(r.matrix.copy(d),r.matrix.decompose(r.position,r.quaternion,r.scale),null!==n.orientation&&(p.fromArray(n.orientation),r.quaternion.multiply(p)),null!==n.position&&(p.setFromRotationMatrix(d),m.fromArray(n.position),m.applyQuaternion(p),r.position.add(m)),r.updateMatrixWorld(),!1===l.isPresenting)return e;g.near=e.near,v.near=e.near,g.far=e.far,v.far=e.far,y.matrixWorld.copy(e.matrixWorld),y.matrixWorldInverse.copy(e.matrixWorldInverse),g.matrixWorldInverse.fromArray(u.leftViewMatrix),v.matrixWorldInverse.fromArray(u.rightViewMatrix),h.getInverse(d),g.matrixWorldInverse.multiply(h),v.matrixWorldInverse.multiply(h);var i=r.parent;null!==i&&(f.getInverse(i.matrixWorld),g.matrixWorldInverse.multiply(f),v.matrixWorldInverse.multiply(f)),g.matrixWorld.getInverse(g.matrixWorldInverse),v.matrixWorld.getInverse(v.matrixWorldInverse),g.projectionMatrix.fromArray(u.leftProjectionMatrix),v.projectionMatrix.fromArray(u.rightProjectionMatrix),y.projectionMatrix.copy(g.projectionMatrix);var a=l.getLayers();if(a.length){var o=a[0];null!==o.leftBounds&&4===o.leftBounds.length&&g.bounds.fromArray(o.leftBounds),null!==o.rightBounds&&4===o.rightBounds.length&&v.bounds.fromArray(o.rightBounds)}return y},this.getStandingMatrix=function(){return d},this.isPresenting=o;var _=new Kn;this.setAnimationLoop=function(e){_.setAnimationLoop(e)},this.submitFrame=function(){o()&&l.submitFrame()},this.dispose=function(){"undefined"!=typeof window&&window.removeEventListener("vrdisplaypresentchange",e)}}function Zo(n){var r=n.context,t=null,u=null,c=null,d=null;function o(){return null!==u&&null!==c}var e=new Ko;e.layers.enable(1),e.viewport=new Mn;var i=new Ko;i.layers.enable(2),i.viewport=new Mn;var h=new Xo([e,i]);function s(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.getInverse(e.matrixWorld)}h.layers.enable(1),h.layers.enable(2),this.enabled=!1,this.getDevice=function(){return t},this.setDevice=function(e){void 0!==e&&(t=e),r.setCompatibleXRDevice(e)},this.setSession=function(e,t){null!==(u=e)&&(u.addEventListener("end",function(){n.setFramebuffer(null),a.stop()}),u.baseLayer=new XRWebGLLayer(u,r),u.requestFrameOfReference(t.frameOfReferenceType).then(function(e){c=e,n.setFramebuffer(u.baseLayer.framebuffer),a.setContext(u),a.start()}))},this.getCamera=function(e){if(o()){var t=e.parent,n=h.cameras;s(h,t);for(var r=0;r<n.length;r++)s(n[r],t);e.matrixWorld.copy(h.matrixWorld);for(var i=e.children,a=(r=0,i.length);r<a;r++)i[r].updateMatrixWorld(!0);return h}return e},this.isPresenting=o;var f=null;var a=new Kn;a.setAnimationLoop(function(e,t){d=t.getDevicePose(c);for(var n=u.baseLayer,r=t.views,i=0;i<r.length;i++){var a=r[i],o=n.getViewport(a),s=d.getViewMatrix(a),l=h.cameras[i];l.matrix.fromArray(s).getInverse(l.matrix),l.projectionMatrix.fromArray(a.projectionMatrix),l.viewport.set(o.x,o.y,o.width,o.height),0===i&&(h.matrix.copy(l.matrix),h.projectionMatrix.copy(l.projectionMatrix))}f&&f()}),this.setAnimationLoop=function(e){f=e},this.getStandingMatrix=function(){return console.warn("THREE.WebXRManager: getStandingMatrix() is no longer needed."),new THREE.Matrix4},this.submitFrame=function(){}}function Jo(e){console.log("THREE.WebGLRenderer","93");var r=void 0!==(e=e||{}).canvas?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),t=void 0!==e.context?e.context:null,n=void 0!==e.alpha&&e.alpha,i=void 0===e.depth||e.depth,a=void 0===e.stencil||e.stencil,o=void 0!==e.antialias&&e.antialias,s=void 0===e.premultipliedAlpha||e.premultipliedAlpha,l=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,u=void 0!==e.powerPreference?e.powerPreference:"default",f=null,_=null;this.domElement=r,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=Se,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var w,S,b,C,c,E,d,x,M,p,g,h,m,v,R,I,P,y,T,A=this,D=!1,L=null,O=null,N=null,k=-1,B="",F=null,j=null,U=new Mn,H=new Mn,G=null,V=0,z=r.width,W=r.height,q=1,Y=new Mn(0,0,z,W),K=new Mn(0,0,z,W),X=!1,Q=new Bn,Z=new ra,J=!1,$=!1,ee=new Wt,te=new Yt;function ne(){return null===O?q:1}try{var re={alpha:n,depth:i,stencil:a,antialias:o,premultipliedAlpha:s,preserveDrawingBuffer:l,powerPreference:u};if(r.addEventListener("webglcontextlost",se,!1),r.addEventListener("webglcontextrestored",le,!1),null===(w=t||r.getContext("webgl",re)||r.getContext("experimental-webgl",re)))throw null!==r.getContext("webgl")?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");void 0===w.getShaderPrecisionFormat&&(w.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(e){console.error("THREE.WebGLRenderer: "+e.message)}function ie(){(S=new ia(w)).get("WEBGL_depth_texture"),S.get("OES_texture_float"),S.get("OES_texture_float_linear"),S.get("OES_texture_half_float"),S.get("OES_texture_half_float_linear"),S.get("OES_standard_derivatives"),S.get("OES_element_index_uint"),S.get("ANGLE_instanced_arrays"),T=new Yo(w,S),b=new na(w,S,e),(C=new Wo(w,S,T)).scissor(H.copy(K).multiplyScalar(q)),C.viewport(U.copy(Y).multiplyScalar(q)),c=new sa(w),E=new ho,d=new qo(w,S,C,E,b,T,c),x=new Xn(w),M=new aa(w,x,c),p=new ca(M,c),R=new ua(w),g=new co(A,S,b),h=new go,m=new jo,v=new ea(A,C,p,s),I=new ta(w,S,c),P=new oa(w,S,c),y=new zo(A,w,C,d,b),c.programs=g.programs,A.context=w,A.capabilities=b,A.extensions=S,A.properties=E,A.renderLists=h,A.state=C,A.info=c}ie();var ae="xr"in navigator?new Zo(A):new Qo(A);this.vr=ae;var oe=new Go(A,p,b.maxTextureSize);function se(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),D=!0}function le(){console.log("THREE.WebGLRenderer: Context Restored."),D=!1,ie()}function ue(e){var t=e.target;t.removeEventListener("dispose",ue),function(e){ce(e),E.remove(e)}(t)}function ce(e){var t=E.get(e).program;(e.program=void 0)!==t&&g.releaseProgram(t)}this.shadowMap=oe,this.getContext=function(){return w},this.getContextAttributes=function(){return w.getContextAttributes()},this.forceContextLoss=function(){var e=S.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){var e=S.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return q},this.setPixelRatio=function(e){void 0!==e&&(q=e,this.setSize(z,W,!1))},this.getSize=function(){return{width:z,height:W}},this.setSize=function(e,t,n){ae.isPresenting()?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(z=e,W=t,r.width=e*q,r.height=t*q,!1!==n&&(r.style.width=e+"px",r.style.height=t+"px"),this.setViewport(0,0,e,t))},this.getDrawingBufferSize=function(){return{width:z*q,height:W*q}},this.setDrawingBufferSize=function(e,t,n){z=e,W=t,q=n,r.width=e*n,r.height=t*n,this.setViewport(0,0,e,t)},this.getCurrentViewport=function(){return U},this.setViewport=function(e,t,n,r){Y.set(e,W-t-r,n,r),C.viewport(U.copy(Y).multiplyScalar(q))},this.setScissor=function(e,t,n,r){K.set(e,W-t-r,n,r),C.scissor(H.copy(K).multiplyScalar(q))},this.setScissorTest=function(e){C.setScissorTest(X=e)},this.getClearColor=function(){return v.getClearColor()},this.setClearColor=function(){v.setClearColor.apply(v,arguments)},this.getClearAlpha=function(){return v.getClearAlpha()},this.setClearAlpha=function(){v.setClearAlpha.apply(v,arguments)},this.clear=function(e,t,n){var r=0;void 0!==e&&!e||(r|=w.COLOR_BUFFER_BIT),void 0!==t&&!t||(r|=w.DEPTH_BUFFER_BIT),void 0!==n&&!n||(r|=w.STENCIL_BUFFER_BIT),w.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.clearTarget=function(e,t,n,r){this.setRenderTarget(e),this.clear(t,n,r)},this.dispose=function(){r.removeEventListener("webglcontextlost",se,!1),r.removeEventListener("webglcontextrestored",le,!1),h.dispose(),m.dispose(),E.dispose(),p.dispose(),ae.dispose(),me.stop()},this.renderBufferImmediate=function(e,t,n){C.initAttributes();var r=E.get(e);e.hasPositions&&!r.position&&(r.position=w.createBuffer()),e.hasNormals&&!r.normal&&(r.normal=w.createBuffer()),e.hasUvs&&!r.uv&&(r.uv=w.createBuffer()),e.hasColors&&!r.color&&(r.color=w.createBuffer());var i=t.getAttributes();if(e.hasPositions&&(w.bindBuffer(w.ARRAY_BUFFER,r.position),w.bufferData(w.ARRAY_BUFFER,e.positionArray,w.DYNAMIC_DRAW),C.enableAttribute(i.position),w.vertexAttribPointer(i.position,3,w.FLOAT,!1,0,0)),e.hasNormals){if(w.bindBuffer(w.ARRAY_BUFFER,r.normal),!n.isMeshPhongMaterial&&!n.isMeshStandardMaterial&&!n.isMeshNormalMaterial&&!0===n.flatShading)for(var a=0,o=3*e.count;a<o;a+=9){var s=e.normalArray,l=(s[a+0]+s[a+3]+s[a+6])/3,u=(s[a+1]+s[a+4]+s[a+7])/3,c=(s[a+2]+s[a+5]+s[a+8])/3;s[a+0]=l,s[a+1]=u,s[a+2]=c,s[a+3]=l,s[a+4]=u,s[a+5]=c,s[a+6]=l,s[a+7]=u,s[a+8]=c}w.bufferData(w.ARRAY_BUFFER,e.normalArray,w.DYNAMIC_DRAW),C.enableAttribute(i.normal),w.vertexAttribPointer(i.normal,3,w.FLOAT,!1,0,0)}e.hasUvs&&n.map&&(w.bindBuffer(w.ARRAY_BUFFER,r.uv),w.bufferData(w.ARRAY_BUFFER,e.uvArray,w.DYNAMIC_DRAW),C.enableAttribute(i.uv),w.vertexAttribPointer(i.uv,2,w.FLOAT,!1,0,0)),e.hasColors&&n.vertexColors!==we&&(w.bindBuffer(w.ARRAY_BUFFER,r.color),w.bufferData(w.ARRAY_BUFFER,e.colorArray,w.DYNAMIC_DRAW),C.enableAttribute(i.color),w.vertexAttribPointer(i.color,3,w.FLOAT,!1,0,0)),C.disableUnusedAttributes(),w.drawArrays(w.TRIANGLES,0,e.count),e.count=0},this.renderBufferDirect=function(e,t,n,r,i,a){var o=i.isMesh&&i.matrixWorld.determinant()<0;C.setMaterial(r,o);var s=_e(e,t,r,i),l=n.id+"_"+s.id+"_"+(!0===r.wireframe),u=!1;l!==B&&(B=l,u=!0),i.morphTargetInfluences&&(R.update(i,n,r,s),u=!0);var c,d=n.index,h=n.attributes.position,f=1;!0===r.wireframe&&(d=M.getWireframeAttribute(n),f=2);var p=I;null!==d&&(c=x.get(d),(p=P).setIndex(c)),u&&(function(e,t,n){if(n&&n.isInstancedBufferGeometry&&null===S.get("ANGLE_instanced_arrays"))return console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");C.initAttributes();var r=n.attributes,i=t.getAttributes(),a=e.defaultAttributeValues;for(var o in i){var s=i[o];if(0<=s){var l=r[o];if(void 0!==l){var u=l.normalized,c=l.itemSize,d=x.get(l);if(void 0===d)continue;var h=d.buffer,f=d.type,p=d.bytesPerElement;if(l.isInterleavedBufferAttribute){var m=l.data,g=m.stride,v=l.offset;m&&m.isInstancedInterleavedBuffer?(C.enableAttributeAndDivisor(s,m.meshPerAttribute),void 0===n.maxInstancedCount&&(n.maxInstancedCount=m.meshPerAttribute*m.count)):C.enableAttribute(s),w.bindBuffer(w.ARRAY_BUFFER,h),w.vertexAttribPointer(s,c,f,u,g*p,v*p)}else l.isInstancedBufferAttribute?(C.enableAttributeAndDivisor(s,l.meshPerAttribute),void 0===n.maxInstancedCount&&(n.maxInstancedCount=l.meshPerAttribute*l.count)):C.enableAttribute(s),w.bindBuffer(w.ARRAY_BUFFER,h),w.vertexAttribPointer(s,c,f,u,0,0)}else if(void 0!==a){var y=a[o];if(void 0!==y)switch(y.length){case 2:w.vertexAttrib2fv(s,y);break;case 3:w.vertexAttrib3fv(s,y);break;case 4:w.vertexAttrib4fv(s,y);break;default:w.vertexAttrib1fv(s,y)}}}}C.disableUnusedAttributes()}(r,s,n),null!==d&&w.bindBuffer(w.ELEMENT_ARRAY_BUFFER,c.buffer));var m=1/0;null!==d?m=d.count:void 0!==h&&(m=h.count);var g=n.drawRange.start*f,v=n.drawRange.count*f,y=null!==a?a.start*f:0,_=null!==a?a.count*f:1/0,b=Math.max(g,y),E=Math.min(m,g+v,y+_)-1,T=Math.max(0,E-b+1);if(0!==T){if(i.isMesh)if(!0===r.wireframe)C.setLineWidth(r.wireframeLinewidth*ne()),p.setMode(w.LINES);else switch(i.drawMode){case Lt:p.setMode(w.TRIANGLES);break;case 1:p.setMode(w.TRIANGLE_STRIP);break;case 2:p.setMode(w.TRIANGLE_FAN)}else if(i.isLine){var A=r.linewidth;void 0===A&&(A=1),C.setLineWidth(A*ne()),i.isLineSegments?p.setMode(w.LINES):i.isLineLoop?p.setMode(w.LINE_LOOP):p.setMode(w.LINE_STRIP)}else i.isPoints&&p.setMode(w.POINTS);n&&n.isInstancedBufferGeometry?0<n.maxInstancedCount&&p.renderInstances(n,b,T):p.render(b,T)}},this.compile=function(n,e){(_=m.get(n,e)).init(),n.traverse(function(e){e.isLight&&(_.pushLight(e),e.castShadow&&_.pushShadow(e))}),_.setupLights(e),n.traverse(function(e){if(e.material)if(Array.isArray(e.material))for(var t=0;t<e.material.length;t++)ye(e.material[t],n.fog,e);else ye(e.material,n.fog,e)})};var de=null;var he,fe,pe,me=new Kn;function ge(e,t,n,r){for(var i=0,a=e.length;i<a;i++){var o=e[i],s=o.object,l=o.geometry,u=void 0===r?o.material:r,c=o.group;if(n.isArrayCamera)for(var d=(j=n).cameras,h=0,f=d.length;h<f;h++){var p=d[h];if(s.layers.test(p.layers)){if("viewport"in p)C.viewport(U.copy(p.viewport));else{var m=p.bounds,g=m.x*z,v=m.y*W,y=m.z*z,_=m.w*W;C.viewport(U.set(g,v,y,_).multiplyScalar(q))}ve(s,t,p,l,u,c)}}else j=null,ve(s,t,n,l,u,c)}}function ve(e,t,n,r,i,a){if(e.onBeforeRender(A,t,n,r,i,a),_=m.get(t,j||n),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),e.isImmediateRenderObject){var o=e.isMesh&&e.matrixWorld.determinant()<0;C.setMaterial(i,o);var s=_e(n,t.fog,i,e);B="",function(e,t,n){e.render(function(e){A.renderBufferImmediate(e,t,n)})}(e,s,i)}else A.renderBufferDirect(n,t.fog,r,i,e,a);e.onAfterRender(A,t,n,r,i,a),_=m.get(t,j||n)}function ye(e,t,n){var r=E.get(e),i=_.state.lights,a=_.state.shadowsArray,o=g.getParameters(e,i.state,a,t,Z.numPlanes,Z.numIntersection,n),s=g.getProgramCode(e,o),l=r.program,u=!0;if(void 0===l)e.addEventListener("dispose",ue);else if(l.code!==s)ce(e);else if(r.lightsHash!==i.state.hash)E.update(e,"lightsHash",i.state.hash),u=!1;else{if(void 0!==o.shaderID)return;u=!1}if(u){if(o.shaderID){var c=Yn[o.shaderID];r.shader={name:e.type,uniforms:Un.clone(c.uniforms),vertexShader:c.vertexShader,fragmentShader:c.fragmentShader}}else r.shader={name:e.type,uniforms:e.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader};e.onBeforeCompile(r.shader,A),l=g.acquireProgram(e,r.shader,o,s),r.program=l,e.program=l}var d=l.getAttributes();if(e.morphTargets)for(var h=e.numSupportedMorphTargets=0;h<A.maxMorphTargets;h++)0<=d["morphTarget"+h]&&e.numSupportedMorphTargets++;if(e.morphNormals)for(h=e.numSupportedMorphNormals=0;h<A.maxMorphNormals;h++)0<=d["morphNormal"+h]&&e.numSupportedMorphNormals++;var f=r.shader.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(r.numClippingPlanes=Z.numPlanes,r.numIntersection=Z.numIntersection,f.clippingPlanes=Z.uniform),r.fog=t,r.lightsHash=i.state.hash,e.lights&&(f.ambientLightColor.value=i.state.ambient,f.directionalLights.value=i.state.directional,f.spotLights.value=i.state.spot,f.rectAreaLights.value=i.state.rectArea,f.pointLights.value=i.state.point,f.hemisphereLights.value=i.state.hemi,f.directionalShadowMap.value=i.state.directionalShadowMap,f.directionalShadowMatrix.value=i.state.directionalShadowMatrix,f.spotShadowMap.value=i.state.spotShadowMap,f.spotShadowMatrix.value=i.state.spotShadowMatrix,f.pointShadowMap.value=i.state.pointShadowMap,f.pointShadowMatrix.value=i.state.pointShadowMatrix);var p=r.program.getUniforms(),m=$a.seqWithValue(p.seq,f);r.uniformsList=m}function _e(e,t,n,r){V=0;var i=E.get(n),a=_.state.lights;if(J&&($||e!==F)){var o=e===F&&n.id===k;Z.setState(n.clippingPlanes,n.clipIntersection,n.clipShadows,e,i,o)}!1===n.needsUpdate&&(void 0===i.program?n.needsUpdate=!0:n.fog&&i.fog!==t?n.needsUpdate=!0:n.lights&&i.lightsHash!==a.state.hash?n.needsUpdate=!0:void 0===i.numClippingPlanes||i.numClippingPlanes===Z.numPlanes&&i.numIntersection===Z.numIntersection||(n.needsUpdate=!0)),n.needsUpdate&&(ye(n,t,r),n.needsUpdate=!1);var s=!1,l=!1,u=!1,c=i.program,d=c.getUniforms(),h=i.shader.uniforms;if(C.useProgram(c.program)&&(u=l=s=!0),n.id!==k&&(k=n.id,l=!0),s||e!==F){if(d.setValue(w,"projectionMatrix",e.projectionMatrix),b.logarithmicDepthBuffer&&d.setValue(w,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),F!==(j||e)&&(F=j||e,u=l=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshStandardMaterial||n.envMap){var f=d.map.cameraPosition;void 0!==f&&f.setValue(w,te.setFromMatrixPosition(e.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.skinning)&&d.setValue(w,"viewMatrix",e.matrixWorldInverse)}if(n.skinning){d.setOptional(w,r,"bindMatrix"),d.setOptional(w,r,"bindMatrixInverse");var p=r.skeleton;if(p){var m=p.bones;if(b.floatVertexTextures){if(void 0===p.boneTexture){var g=Math.sqrt(4*m.length);g=Vt.ceilPowerOfTwo(g),g=Math.max(g,4);var v=new Float32Array(g*g*4);v.set(p.boneMatrices);var y=new Pn(v,g,g,at,Ze);y.needsUpdate=!0,p.boneMatrices=v,p.boneTexture=y,p.boneTextureSize=g}d.setValue(w,"boneTexture",p.boneTexture),d.setValue(w,"boneTextureSize",p.boneTextureSize)}else d.setOptional(w,p,"boneMatrices")}}return l&&(d.setValue(w,"toneMappingExposure",A.toneMappingExposure),d.setValue(w,"toneMappingWhitePoint",A.toneMappingWhitePoint),n.lights&&function(e,t){e.ambientLightColor.needsUpdate=t,e.directionalLights.needsUpdate=t,e.pointLights.needsUpdate=t,e.spotLights.needsUpdate=t,e.rectAreaLights.needsUpdate=t,e.hemisphereLights.needsUpdate=t}(h,u),t&&n.fog&&function(e,t){e.fogColor.value=t.color,t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)}(h,t),n.isMeshBasicMaterial?be(h,n):n.isMeshLambertMaterial?(be(h,n),function(e,t){t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap)}(h,n)):n.isMeshPhongMaterial?(be(h,n),n.isMeshToonMaterial?function(e,t){Ee(e,t),t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(h,n):Ee(h,n)):n.isMeshStandardMaterial?(be(h,n),n.isMeshPhysicalMaterial?function(e,t){e.clearCoat.value=t.clearCoat,e.clearCoatRoughness.value=t.clearCoatRoughness,Te(e,t)}(h,n):Te(h,n)):n.isMeshDepthMaterial?(be(h,n),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(h,n)):n.isMeshDistanceMaterial?(be(h,n),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias);e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(h,n)):n.isMeshNormalMaterial?(be(h,n),function(e,t){t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===Ae&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===Ae&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(h,n)):n.isLineBasicMaterial?(function(e,t){e.diffuse.value=t.color,e.opacity.value=t.opacity}(h,n),n.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(h,n)):n.isPointsMaterial?function(e,t){e.diffuse.value=t.color,e.opacity.value=t.opacity,e.size.value=t.size*q,e.scale.value=.5*W,e.map.value=t.map,null!==t.map&&(!0===t.map.matrixAutoUpdate&&t.map.updateMatrix(),e.uvTransform.value.copy(t.map.matrix))}(h,n):n.isShadowMaterial&&(h.color.value=n.color,h.opacity.value=n.opacity),void 0!==h.ltc_1&&(h.ltc_1.value=qn.LTC_1),void 0!==h.ltc_2&&(h.ltc_2.value=qn.LTC_2),$a.upload(w,i.uniformsList,h,A)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&($a.upload(w,i.uniformsList,h,A),n.uniformsNeedUpdate=!1),d.setValue(w,"modelViewMatrix",r.modelViewMatrix),d.setValue(w,"normalMatrix",r.normalMatrix),d.setValue(w,"modelMatrix",r.matrixWorld),c}function be(e,t){var n;e.opacity.value=t.opacity,t.color&&(e.diffuse.value=t.color),t.emissive&&e.emissive.value.copy(t.emissive).multiplyScalar(t.emissiveIntensity),t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.specularMap&&(e.specularMap.value=t.specularMap),t.envMap&&(e.envMap.value=t.envMap,e.flipEnvMap.value=t.envMap&&t.envMap.isCubeTexture?-1:1,e.reflectivity.value=t.reflectivity,e.refractionRatio.value=t.refractionRatio,e.maxMipLevel.value=E.get(t.envMap).__maxMipLevel),t.lightMap&&(e.lightMap.value=t.lightMap,e.lightMapIntensity.value=t.lightMapIntensity),t.aoMap&&(e.aoMap.value=t.aoMap,e.aoMapIntensity.value=t.aoMapIntensity),t.map?n=t.map:t.specularMap?n=t.specularMap:t.displacementMap?n=t.displacementMap:t.normalMap?n=t.normalMap:t.bumpMap?n=t.bumpMap:t.roughnessMap?n=t.roughnessMap:t.metalnessMap?n=t.metalnessMap:t.alphaMap?n=t.alphaMap:t.emissiveMap&&(n=t.emissiveMap),void 0!==n&&(n.isWebGLRenderTarget&&(n=n.texture),!0===n.matrixAutoUpdate&&n.updateMatrix(),e.uvTransform.value.copy(n.matrix))}function Ee(e,t){e.specular.value=t.specular,e.shininess.value=Math.max(t.shininess,1e-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===Ae&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===Ae&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}function Te(e,t){e.roughness.value=t.roughness,e.metalness.value=t.metalness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap),t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===Ae&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===Ae&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),t.envMap&&(e.envMapIntensity.value=t.envMapIntensity)}me.setAnimationLoop(function(){ae.isPresenting()||de&&de()}),me.setContext(window),this.setAnimationLoop=function(e){de=e,ae.setAnimationLoop(e),me.start()},this.render=function(e,t,n,r){if(t&&t.isCamera){if(!D){B="",k=-1,!(F=null)===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),ae.enabled&&(t=ae.getCamera(t)),(_=m.get(e,t)).init(),e.onBeforeRender(A,e,t,n),ee.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),Q.setFromMatrix(ee),$=this.localClippingEnabled,J=Z.init(this.clippingPlanes,$,t),(f=h.get(e,t)).init(),function e(t,n,r){if(!1===t.visible)return;var i=t.layers.test(n.layers);if(i)if(t.isLight)_.pushLight(t),t.castShadow&&_.pushShadow(t);else if(t.isSprite)t.frustumCulled&&!Q.intersectsSprite(t)||_.pushSprite(t);else if(t.isImmediateRenderObject)r&&te.setFromMatrixPosition(t.matrixWorld).applyMatrix4(ee),f.push(t,null,t.material,te.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.update(),!t.frustumCulled||Q.intersectsObject(t))){r&&te.setFromMatrixPosition(t.matrixWorld).applyMatrix4(ee);var a=p.update(t),o=t.material;if(Array.isArray(o))for(var s=a.groups,l=0,u=s.length;l<u;l++){var c=s[l],d=o[c.materialIndex];d&&d.visible&&f.push(t,a,d,te.z,c)}else o.visible&&f.push(t,a,o,te.z,null)}var h=t.children;for(var l=0,u=h.length;l<u;l++)e(h[l],n,r)}(e,t,A.sortObjects),!0===A.sortObjects&&f.sort(),J&&Z.beginShadows();var i=_.state.shadowsArray;oe.render(i,e,t),_.setupLights(t),J&&Z.endShadows(),this.info.autoReset&&this.info.reset(),void 0===n&&(n=null),this.setRenderTarget(n),v.render(f,e,t,r);var a=f.opaque,o=f.transparent;if(e.overrideMaterial){var s=e.overrideMaterial;a.length&&ge(a,e,t,s),o.length&&ge(o,e,t,s)}else a.length&&ge(a,e,t),o.length&&ge(o,e,t);var l=_.state.spritesArray;y.render(l,e,t),n&&d.updateRenderTargetMipmap(n),C.buffers.depth.setTest(!0),C.buffers.depth.setMask(!0),C.buffers.color.setMask(!0),C.setPolygonOffset(!1),e.onAfterRender(A,e,t),ae.enabled&&ae.submitFrame(),_=f=null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.allocTextureUnit=function(){var e=V;return e>=b.maxTextures&&console.warn("THREE.WebGLRenderer: Trying to use "+e+" texture units while this GPU supports only "+b.maxTextures),V+=1,e},this.setTexture2D=(he=!1,function(e,t){e&&e.isWebGLRenderTarget&&(he||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),he=!0),e=e.texture),d.setTexture2D(e,t)}),this.setTexture=(fe=!1,function(e,t){fe||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),fe=!0),d.setTexture2D(e,t)}),this.setTextureCube=(pe=!1,function(e,t){e&&e.isWebGLRenderTargetCube&&(pe||(console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),pe=!0),e=e.texture),e&&e.isCubeTexture||Array.isArray(e.image)&&6===e.image.length?d.setTextureCube(e,t):d.setTextureCubeDynamic(e,t)}),this.setFramebuffer=function(e){L=e},this.getRenderTarget=function(){return O},this.setRenderTarget=function(e){(O=e)&&void 0===E.get(e).__webglFramebuffer&&d.setupRenderTarget(e);var t=L,n=!1;if(e){var r=E.get(e).__webglFramebuffer;e.isWebGLRenderTargetCube?(t=r[e.activeCubeFace],n=!0):t=r,U.copy(e.viewport),H.copy(e.scissor),G=e.scissorTest}else U.copy(Y).multiplyScalar(q),H.copy(K).multiplyScalar(q),G=X;if(N!==t&&(w.bindFramebuffer(w.FRAMEBUFFER,t),N=t),C.viewport(U),C.scissor(H),C.setScissorTest(G),n){var i=E.get(e.texture);w.framebufferTexture2D(w.FRAMEBUFFER,w.COLOR_ATTACHMENT0,w.TEXTURE_CUBE_MAP_POSITIVE_X+e.activeCubeFace,i.__webglTexture,e.activeMipMapLevel)}},this.readRenderTargetPixels=function(e,t,n,r,i,a){if(e&&e.isWebGLRenderTarget){var o=E.get(e).__webglFramebuffer;if(o){var s=!1;o!==N&&(w.bindFramebuffer(w.FRAMEBUFFER,o),s=!0);try{var l=e.texture,u=l.format,c=l.type;if(u!==at&&T.convert(u)!==w.getParameter(w.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(c===We||T.convert(c)===w.getParameter(w.IMPLEMENTATION_COLOR_READ_TYPE)||c===Ze&&(S.get("OES_texture_float")||S.get("WEBGL_color_buffer_float"))||c===Je&&S.get("EXT_color_buffer_half_float")))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");w.checkFramebufferStatus(w.FRAMEBUFFER)===w.FRAMEBUFFER_COMPLETE?0<=t&&t<=e.width-r&&0<=n&&n<=e.height-i&&w.readPixels(t,n,r,i,T.convert(u),T.convert(c),a):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{s&&w.bindFramebuffer(w.FRAMEBUFFER,N)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(e,t,n){var r=t.image.width,i=t.image.height,a=T.convert(t.format);this.setTexture2D(t,0),w.copyTexImage2D(w.TEXTURE_2D,n||0,a,e.x,e.y,r,i,0)},this.copyTextureToTexture=function(e,t,n,r){var i=t.image.width,a=t.image.height,o=T.convert(n.format),s=T.convert(n.type);this.setTexture2D(n,0),t.isDataTexture?w.texSubImage2D(w.TEXTURE_2D,r||0,e.x,e.y,i,a,o,s,t.image.data):w.texSubImage2D(w.TEXTURE_2D,r||0,e.x,e.y,o,s,t.image)}}function $o(e,t){this.name="",this.color=new Gn(e),this.density=void 0!==t?t:25e-5}function es(e,t,n){this.name="",this.color=new Gn(e),this.near=void 0!==t?t:1,this.far=void 0!==n?n:1e3}function ts(){vr.call(this),this.type="Scene",this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0}function ns(e){zi.call(this),this.type="SpriteMaterial",this.color=new Gn(16777215),this.map=null,this.rotation=0,this.fog=!1,this.lights=!1,this.setValues(e)}function rs(e){vr.call(this),this.type="Sprite",this.material=void 0!==e?e:new ns,this.center=new zt(.5,.5)}function is(){vr.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function as(e,t){if(e=e||[],this.bones=e.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),void 0===t)this.calculateInverses();else if(this.bones.length===t.length)this.boneInverses=t.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new Wt)}}function os(){vr.call(this),this.type="Bone"}function ss(e,t){Qi.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Wt,this.bindMatrixInverse=new Wt;var n=new as(this.initBones());this.bind(n,this.matrixWorld),this.normalizeSkinWeights()}function ls(e){zi.call(this),this.type="LineBasicMaterial",this.color=new Gn(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.lights=!1,this.setValues(e)}function us(e,t,n){if(1===n)return console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new cs(e,t);vr.call(this),this.type="Line",this.geometry=void 0!==e?e:new $r,this.material=void 0!==t?t:new ls({color:16777215*Math.random()})}function cs(e,t){us.call(this,e,t),this.type="LineSegments"}function ds(e,t){us.call(this,e,t),this.type="LineLoop"}function hs(e){zi.call(this),this.type="PointsMaterial",this.color=new Gn(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.lights=!1,this.setValues(e)}function fs(e,t){vr.call(this),this.type="Points",this.geometry=void 0!==e?e:new $r,this.material=void 0!==t?t:new hs({color:16777215*Math.random()})}function ps(){vr.call(this),this.type="Group"}function ms(e,t,n,r,i,a,o,s,l){xn.call(this,e,t,n,r,i,a,o,s,l),this.generateMipmaps=!1}function gs(e,t,n,r,i,a,o,s,l,u,c,d){xn.call(this,null,a,o,s,l,u,r,i,c,d),this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}function vs(e,t,n,r,i,a,o,s,l,u){if((u=void 0!==u?u:lt)!==lt&&u!==ut)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&u===lt&&(n=Ke),void 0===n&&u===ut&&(n=nt),xn.call(this,null,r,i,a,o,s,u,n,l),this.image={width:e,height:t},this.magFilter=void 0!==o?o:je,this.minFilter=void 0!==s?s:je,this.flipY=!1,this.generateMipmaps=!1}function ys(e){$r.call(this),this.type="WireframeGeometry";var t,n,r,i,a,o,s,l,u,c,d=[],h=[0,0],f={},p=["a","b","c"];if(e&&e.isGeometry){var m=e.faces;for(t=0,r=m.length;t<r;t++){var g=m[t];for(n=0;n<3;n++)s=g[p[n]],l=g[p[(n+1)%3]],h[0]=Math.min(s,l),h[1]=Math.max(s,l),void 0===f[u=h[0]+","+h[1]]&&(f[u]={index1:h[0],index2:h[1]})}for(u in f)o=f[u],c=e.vertices[o.index1],d.push(c.x,c.y,c.z),c=e.vertices[o.index2],d.push(c.x,c.y,c.z)}else if(e&&e.isBufferGeometry){var v,y,_,b,E,T;if(c=new Yt,null!==e.index){for(v=e.attributes.position,y=e.index,0===(_=e.groups).length&&(_=[{start:0,count:y.count,materialIndex:0}]),i=0,a=_.length;i<a;++i)for(r=(t=(b=_[i]).start)+b.count;t<r;t+=3)for(n=0;n<3;n++)s=y.getX(t+n),l=y.getX(t+(n+1)%3),h[0]=Math.min(s,l),h[1]=Math.max(s,l),void 0===f[u=h[0]+","+h[1]]&&(f[u]={index1:h[0],index2:h[1]});for(u in f)o=f[u],c.fromBufferAttribute(v,o.index1),d.push(c.x,c.y,c.z),c.fromBufferAttribute(v,o.index2),d.push(c.x,c.y,c.z)}else for(t=0,r=(v=e.attributes.position).count/3;t<r;t++)for(n=0;n<3;n++)E=3*t+n,c.fromBufferAttribute(v,E),d.push(c.x,c.y,c.z),T=3*t+(n+1)%3,c.fromBufferAttribute(v,T),d.push(c.x,c.y,c.z)}this.addAttribute("position",new Fr(d,3))}function _s(e,t,n){Rr.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:n},this.fromBufferGeometry(new bs(e,t,n)),this.mergeVertices()}function bs(e,t,n){$r.call(this),this.type="ParametricBufferGeometry",this.parameters={func:e,slices:t,stacks:n};var r,i,a=[],o=[],s=[],l=[],u=new Yt,c=new Yt,d=new Yt,h=new Yt,f=new Yt;e.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");var p=t+1;for(r=0;r<=n;r++){var m=r/n;for(i=0;i<=t;i++){var g=i/t;e(g,m,c),o.push(c.x,c.y,c.z),0<=g-1e-5?(e(g-1e-5,m,d),h.subVectors(c,d)):(e(1e-5+g,m,d),h.subVectors(d,c)),0<=m-1e-5?(e(g,m-1e-5,d),f.subVectors(c,d)):(e(g,1e-5+m,d),f.subVectors(d,c)),u.crossVectors(h,f).normalize(),s.push(u.x,u.y,u.z),l.push(g,m)}}for(r=0;r<n;r++)for(i=0;i<t;i++){var v=r*p+i,y=r*p+i+1,_=(r+1)*p+i+1,b=(r+1)*p+i;a.push(v,y,b),a.push(y,_,b)}this.setIndex(a),this.addAttribute("position",new Fr(o,3)),this.addAttribute("normal",new Fr(s,3)),this.addAttribute("uv",new Fr(l,2))}function Es(e,t,n,r){Rr.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:r},this.fromBufferGeometry(new Ts(e,t,n,r)),this.mergeVertices()}function Ts(r,a,e,t){$r.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:r,indices:a,radius:e,detail:t},e=e||1;var c=[],d=[];function o(e,t,n,r){var i,a,o=Math.pow(2,r),s=[];for(i=0;i<=o;i++){s[i]=[];var l=e.clone().lerp(n,i/o),u=t.clone().lerp(n,i/o),c=o-i;for(a=0;a<=c;a++)s[i][a]=0===a&&i===o?l:l.clone().lerp(u,a/c)}for(i=0;i<o;i++)for(a=0;a<2*(o-i)-1;a++){var d=Math.floor(a/2);a%2==0?(h(s[i][d+1]),h(s[i+1][d]),h(s[i][d])):(h(s[i][d+1]),h(s[i+1][d+1]),h(s[i+1][d]))}}function h(e){c.push(e.x,e.y,e.z)}function s(e,t){var n=3*e;t.x=r[0+n],t.y=r[1+n],t.z=r[2+n]}function f(e,t,n,r){r<0&&1===e.x&&(d[t]=e.x-1),0===n.x&&0===n.z&&(d[t]=r/2/Math.PI+.5)}function p(e){return Math.atan2(e.z,-e.x)}!function(e){for(var t=new Yt,n=new Yt,r=new Yt,i=0;i<a.length;i+=3)s(a[i+0],t),s(a[i+1],n),s(a[i+2],r),o(t,n,r,e)}(t=t||0),function(e){for(var t=new Yt,n=0;n<c.length;n+=3)t.x=c[n+0],t.y=c[n+1],t.z=c[n+2],t.normalize().multiplyScalar(e),c[n+0]=t.x,c[n+1]=t.y,c[n+2]=t.z}(e),function(){for(var e=new Yt,t=0;t<c.length;t+=3){e.x=c[t+0],e.y=c[t+1],e.z=c[t+2];var n=p(e)/2/Math.PI+.5,r=(i=e,Math.atan2(-i.y,Math.sqrt(i.x*i.x+i.z*i.z))/Math.PI+.5);d.push(n,1-r)}var i;(function(){for(var e=new Yt,t=new Yt,n=new Yt,r=new Yt,i=new zt,a=new zt,o=new zt,s=0,l=0;s<c.length;s+=9,l+=6){e.set(c[s+0],c[s+1],c[s+2]),t.set(c[s+3],c[s+4],c[s+5]),n.set(c[s+6],c[s+7],c[s+8]),i.set(d[l+0],d[l+1]),a.set(d[l+2],d[l+3]),o.set(d[l+4],d[l+5]),r.copy(e).add(t).add(n).divideScalar(3);var u=p(r);f(i,l+0,e,u),f(a,l+2,t,u),f(o,l+4,n,u)}})(),function(){for(var e=0;e<d.length;e+=6){var t=d[e+0],n=d[e+2],r=d[e+4],i=Math.max(t,n,r),a=Math.min(t,n,r);.9<i&&a<.1&&(t<.2&&(d[e+0]+=1),n<.2&&(d[e+2]+=1),r<.2&&(d[e+4]+=1))}}()}(),this.addAttribute("position",new Fr(c,3)),this.addAttribute("normal",new Fr(c.slice(),3)),this.addAttribute("uv",new Fr(d,2)),0===t?this.computeVertexNormals():this.normalizeNormals()}function As(e,t){Rr.call(this),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new ws(e,t)),this.mergeVertices()}function ws(e,t){Ts.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Ss(e,t){Rr.call(this),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Cs(e,t)),this.mergeVertices()}function Cs(e,t){Ts.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronBufferGeometry",this.parameters={radius:e,detail:t}}function xs(e,t){Rr.call(this),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Ms(e,t)),this.mergeVertices()}function Ms(e,t){var n=(1+Math.sqrt(5))/2;Ts.call(this,[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Rs(e,t){Rr.call(this),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Is(e,t)),this.mergeVertices()}function Is(e,t){var n=(1+Math.sqrt(5))/2,r=1/n;Ts.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Ps(e,t,n,r,i,a){Rr.call(this),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:i},void 0!==a&&console.warn("THREE.TubeGeometry: taper has been removed.");var o=new Ds(e,t,n,r,i);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals,this.fromBufferGeometry(o),this.mergeVertices()}function Ds(o,s,l,u,e){$r.call(this),this.type="TubeBufferGeometry",this.parameters={path:o,tubularSegments:s,radius:l,radialSegments:u,closed:e},s=s||64,l=l||1,u=u||8,e=e||!1;var c=o.computeFrenetFrames(s,e);this.tangents=c.tangents,this.normals=c.normals,this.binormals=c.binormals;var i,d,h=new Yt,f=new Yt,t=new zt,p=new Yt,m=[],g=[],n=[],a=[];function r(e){p=o.getPointAt(e/s,p);var t=c.normals[e],n=c.binormals[e];for(d=0;d<=u;d++){var r=d/u*Math.PI*2,i=Math.sin(r),a=-Math.cos(r);f.x=a*t.x+i*n.x,f.y=a*t.y+i*n.y,f.z=a*t.z+i*n.z,f.normalize(),g.push(f.x,f.y,f.z),h.x=p.x+l*f.x,h.y=p.y+l*f.y,h.z=p.z+l*f.z,m.push(h.x,h.y,h.z)}}!function(){for(i=0;i<s;i++)r(i);r(!1===e?s:0),function(){for(i=0;i<=s;i++)for(d=0;d<=u;d++)t.x=i/s,t.y=d/u,n.push(t.x,t.y)}(),function(){for(d=1;d<=s;d++)for(i=1;i<=u;i++){var e=(u+1)*(d-1)+(i-1),t=(u+1)*d+(i-1),n=(u+1)*d+i,r=(u+1)*(d-1)+i;a.push(e,t,r),a.push(t,n,r)}}()}(),this.setIndex(a),this.addAttribute("position",new Fr(m,3)),this.addAttribute("normal",new Fr(g,3)),this.addAttribute("uv",new Fr(n,2))}function Ls(e,t,n,r,i,a,o){Rr.call(this),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:i,q:a},void 0!==o&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new Os(e,t,n,r,i,a)),this.mergeVertices()}function Os(e,t,n,r,i,a){$r.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:i,q:a},e=e||1,t=t||.4,n=Math.floor(n)||64,r=Math.floor(r)||8,i=i||2,a=a||3;var o,s,l=[],u=[],c=[],d=[],h=new Yt,f=new Yt,p=new Yt,m=new Yt,g=new Yt,v=new Yt,y=new Yt;for(o=0;o<=n;++o){var _=o/n*i*Math.PI*2;for(x(_,i,a,e,p),x(.01+_,i,a,e,m),v.subVectors(m,p),y.addVectors(m,p),g.crossVectors(v,y),y.crossVectors(g,v),g.normalize(),y.normalize(),s=0;s<=r;++s){var b=s/r*Math.PI*2,E=-t*Math.cos(b),T=t*Math.sin(b);h.x=p.x+(E*y.x+T*g.x),h.y=p.y+(E*y.y+T*g.y),h.z=p.z+(E*y.z+T*g.z),u.push(h.x,h.y,h.z),f.subVectors(h,p).normalize(),c.push(f.x,f.y,f.z),d.push(o/n),d.push(s/r)}}for(s=1;s<=n;s++)for(o=1;o<=r;o++){var A=(r+1)*(s-1)+(o-1),w=(r+1)*s+(o-1),S=(r+1)*s+o,C=(r+1)*(s-1)+o;l.push(A,w,C),l.push(w,S,C)}function x(e,t,n,r,i){var a=Math.cos(e),o=Math.sin(e),s=n/t*e,l=Math.cos(s);i.x=r*(2+l)*.5*a,i.y=r*(2+l)*o*.5,i.z=r*Math.sin(s)*.5}this.setIndex(l),this.addAttribute("position",new Fr(u,3)),this.addAttribute("normal",new Fr(c,3)),this.addAttribute("uv",new Fr(d,2))}function Ns(e,t,n,r,i){Rr.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:i},this.fromBufferGeometry(new ks(e,t,n,r,i)),this.mergeVertices()}function ks(e,t,n,r,i){$r.call(this),this.type="TorusBufferGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:i},e=e||1,t=t||.4,n=Math.floor(n)||8,r=Math.floor(r)||6,i=i||2*Math.PI;var a,o,s=[],l=[],u=[],c=[],d=new Yt,h=new Yt,f=new Yt;for(a=0;a<=n;a++)for(o=0;o<=r;o++){var p=o/r*i,m=a/n*Math.PI*2;h.x=(e+t*Math.cos(m))*Math.cos(p),h.y=(e+t*Math.cos(m))*Math.sin(p),h.z=t*Math.sin(m),l.push(h.x,h.y,h.z),d.x=e*Math.cos(p),d.y=e*Math.sin(p),f.subVectors(h,d).normalize(),u.push(f.x,f.y,f.z),c.push(o/r),c.push(a/n)}for(a=1;a<=n;a++)for(o=1;o<=r;o++){var g=(r+1)*a+o-1,v=(r+1)*(a-1)+o-1,y=(r+1)*(a-1)+o,_=(r+1)*a+o;s.push(g,v,_),s.push(v,y,_)}this.setIndex(s),this.addAttribute("position",new Fr(l,3)),this.addAttribute("normal",new Fr(u,3)),this.addAttribute("uv",new Fr(c,2))}((Uo.prototype=Object.create(zi.prototype)).constructor=Uo).prototype.isMeshDepthMaterial=!0,Uo.prototype.copy=function(e){return zi.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this},((Ho.prototype=Object.create(zi.prototype)).constructor=Ho).prototype.isMeshDistanceMaterial=!0,Ho.prototype.copy=function(e){return zi.prototype.copy.call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this},((Vo.prototype=Object.create(xn.prototype)).constructor=Vo).prototype.isCanvasTexture=!0,Ko.prototype=Object.assign(Object.create(yr.prototype),{constructor:Ko,isPerspectiveCamera:!0,copy:function(e,t){return yr.prototype.copy.call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){var t=.5*this.getFilmHeight()/e;this.fov=2*Vt.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(.5*Vt.DEG2RAD*this.fov);return.5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*Vt.RAD2DEG*Math.atan(Math.tan(.5*Vt.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,t,n,r,i,a){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,t=e*Math.tan(.5*Vt.DEG2RAD*this.fov)/this.zoom,n=2*t,r=this.aspect*n,i=-.5*r,a=this.view;if(null!==this.view&&this.view.enabled){var o=a.fullWidth,s=a.fullHeight;i+=a.offsetX*r/o,t-=a.offsetY*n/s,r*=a.width/o,n*=a.height/s}var l=this.filmOffset;0!==l&&(i+=e*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,t,t-n,e,this.far)},toJSON:function(e){var t=vr.prototype.toJSON.call(this,e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}),Xo.prototype=Object.assign(Object.create(Ko.prototype),{constructor:Xo,isArrayCamera:!0}),$o.prototype.isFogExp2=!0,$o.prototype.clone=function(){return new $o(this.color,this.density)},$o.prototype.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},es.prototype.isFog=!0,es.prototype.clone=function(){return new es(this.color,this.near,this.far)},es.prototype.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},ts.prototype=Object.assign(Object.create(vr.prototype),{constructor:ts,copy:function(e,t){return vr.prototype.copy.call(this,e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},toJSON:function(e){var t=vr.prototype.toJSON.call(this,e);return null!==this.background&&(t.object.background=this.background.toJSON(e)),null!==this.fog&&(t.object.fog=this.fog.toJSON()),t}}),((ns.prototype=Object.create(zi.prototype)).constructor=ns).prototype.isSpriteMaterial=!0,ns.prototype.copy=function(e){return zi.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.rotation=e.rotation,this},rs.prototype=Object.assign(Object.create(vr.prototype),{constructor:rs,isSprite:!0,raycast:(yo=new Yt,_o=new Yt,bo=new Yt,function(e,t){_o.setFromMatrixPosition(this.matrixWorld),e.ray.closestPointToPoint(_o,yo),bo.setFromMatrixScale(this.matrixWorld);var n=bo.x*bo.y/4;if(!(_o.distanceToSquared(yo)>n)){var r=e.ray.origin.distanceTo(yo);r<e.near||r>e.far||t.push({distance:r,point:yo.clone(),face:null,object:this})}}),clone:function(){return new this.constructor(this.material).copy(this)},copy:function(e){return vr.prototype.copy.call(this,e),void 0!==e.center&&this.center.copy(e.center),this}}),is.prototype=Object.assign(Object.create(vr.prototype),{constructor:is,copy:function(e){vr.prototype.copy.call(this,e,!1);for(var t=e.levels,n=0,r=t.length;n<r;n++){var i=t[n];this.addLevel(i.object.clone(),i.distance)}return this},addLevel:function(e,t){void 0===t&&(t=0),t=Math.abs(t);for(var n=this.levels,r=0;r<n.length&&!(t<n[r].distance);r++);n.splice(r,0,{distance:t,object:e}),this.add(e)},getObjectForDistance:function(e){for(var t=this.levels,n=1,r=t.length;n<r&&!(e<t[n].distance);n++);return t[n-1].object},raycast:(Ao=new Yt,function(e,t){Ao.setFromMatrixPosition(this.matrixWorld);var n=e.ray.origin.distanceTo(Ao);this.getObjectForDistance(n).raycast(e,t)}),update:(Eo=new Yt,To=new Yt,function(e){var t=this.levels;if(1<t.length){Eo.setFromMatrixPosition(e.matrixWorld),To.setFromMatrixPosition(this.matrixWorld);var n=Eo.distanceTo(To);t[0].object.visible=!0;for(var r=1,i=t.length;r<i&&n>=t[r].distance;r++)t[r-1].object.visible=!1,t[r].object.visible=!0;for(;r<i;r++)t[r].object.visible=!1}}),toJSON:function(e){var t=vr.prototype.toJSON.call(this,e);t.object.levels=[];for(var n=this.levels,r=0,i=n.length;r<i;r++){var a=n[r];t.object.levels.push({object:a.object.uuid,distance:a.distance})}return t}}),Object.assign(as.prototype,{calculateInverses:function(){this.boneInverses=[];for(var e=0,t=this.bones.length;e<t;e++){var n=new Wt;this.bones[e]&&n.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(n)}},pose:function(){var e,t,n;for(t=0,n=this.bones.length;t<n;t++)(e=this.bones[t])&&e.matrixWorld.getInverse(this.boneInverses[t]);for(t=0,n=this.bones.length;t<n;t++)(e=this.bones[t])&&(e.parent&&e.parent.isBone?(e.matrix.getInverse(e.parent.matrixWorld),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))},update:(wo=new Wt,So=new Wt,function(){for(var e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture,i=0,a=e.length;i<a;i++){var o=e[i]?e[i].matrixWorld:So;wo.multiplyMatrices(o,t[i]),wo.toArray(n,16*i)}void 0!==r&&(r.needsUpdate=!0)}),clone:function(){return new as(this.bones,this.boneInverses)},getBoneByName:function(e){for(var t=0,n=this.bones.length;t<n;t++){var r=this.bones[t];if(r.name===e)return r}}}),os.prototype=Object.assign(Object.create(vr.prototype),{constructor:os,isBone:!0}),ss.prototype=Object.assign(Object.create(Qi.prototype),{constructor:ss,isSkinnedMesh:!0,initBones:function(){var e,t,n,r,i=[];if(this.geometry&&void 0!==this.geometry.bones){for(n=0,r=this.geometry.bones.length;n<r;n++)t=this.geometry.bones[n],e=new os,i.push(e),e.name=t.name,e.position.fromArray(t.pos),e.quaternion.fromArray(t.rotq),void 0!==t.scl&&e.scale.fromArray(t.scl);for(n=0,r=this.geometry.bones.length;n<r;n++)-1!==(t=this.geometry.bones[n]).parent&&null!==t.parent&&void 0!==i[t.parent]?i[t.parent].add(i[n]):this.add(i[n])}return this.updateMatrixWorld(!0),i},bind:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.getInverse(t)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){var e,t;if(this.geometry&&this.geometry.isGeometry)for(t=0;t<this.geometry.skinWeights.length;t++){var n=this.geometry.skinWeights[t];(e=1/n.manhattanLength())!==1/0?n.multiplyScalar(e):n.set(1,0,0,0)}else if(this.geometry&&this.geometry.isBufferGeometry){var r=new Mn,i=this.geometry.attributes.skinWeight;for(t=0;t<i.count;t++)r.x=i.getX(t),r.y=i.getY(t),r.z=i.getZ(t),r.w=i.getW(t),(e=1/r.manhattanLength())!==1/0?r.multiplyScalar(e):r.set(1,0,0,0),i.setXYZW(t,r.x,r.y,r.z,r.w)}},updateMatrixWorld:function(e){Qi.prototype.updateMatrixWorld.call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),((ls.prototype=Object.create(zi.prototype)).constructor=ls).prototype.isLineBasicMaterial=!0,ls.prototype.copy=function(e){return zi.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this},us.prototype=Object.assign(Object.create(vr.prototype),{constructor:us,isLine:!0,computeLineDistances:(Ro=new Yt,Io=new Yt,function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){for(var t=e.attributes.position,n=[0],r=1,i=t.count;r<i;r++)Ro.fromBufferAttribute(t,r-1),Io.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=Ro.distanceTo(Io);e.addAttribute("lineDistance",new Fr(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry){var a=e.vertices;for((n=e.lineDistances)[0]=0,r=1,i=a.length;r<i;r++)n[r]=n[r-1],n[r]+=a[r-1].distanceTo(a[r])}return this}),raycast:(Co=new Wt,xo=new Yi,Mo=new Nn,function(e,t){var n=e.linePrecision,r=n*n,i=this.geometry,a=this.matrixWorld;if(null===i.boundingSphere&&i.computeBoundingSphere(),Mo.copy(i.boundingSphere),Mo.applyMatrix4(a),!1!==e.ray.intersectsSphere(Mo)){Co.getInverse(a),xo.copy(e.ray).applyMatrix4(Co);var o=new Yt,s=new Yt,l=new Yt,u=new Yt,c=this&&this.isLineSegments?2:1;if(i.isBufferGeometry){var d=i.index,h=i.attributes.position.array;if(null!==d)for(var f=d.array,p=0,m=f.length-1;p<m;p+=c){var g=f[p],v=f[p+1];o.fromArray(h,3*g),s.fromArray(h,3*v),r<xo.distanceSqToSegment(o,s,u,l)||(u.applyMatrix4(this.matrixWorld),(b=e.ray.origin.distanceTo(u))<e.near||b>e.far||t.push({distance:b,point:l.clone().applyMatrix4(this.matrixWorld),index:p,face:null,faceIndex:null,object:this}))}else for(p=0,m=h.length/3-1;p<m;p+=c)o.fromArray(h,3*p),s.fromArray(h,3*p+3),r<xo.distanceSqToSegment(o,s,u,l)||(u.applyMatrix4(this.matrixWorld),(b=e.ray.origin.distanceTo(u))<e.near||b>e.far||t.push({distance:b,point:l.clone().applyMatrix4(this.matrixWorld),index:p,face:null,faceIndex:null,object:this}))}else if(i.isGeometry){var y=i.vertices,_=y.length;for(p=0;p<_-1;p+=c){var b;r<xo.distanceSqToSegment(y[p],y[p+1],u,l)||(u.applyMatrix4(this.matrixWorld),(b=e.ray.origin.distanceTo(u))<e.near||b>e.far||t.push({distance:b,point:l.clone().applyMatrix4(this.matrixWorld),index:p,face:null,faceIndex:null,object:this}))}}}}),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),cs.prototype=Object.assign(Object.create(us.prototype),{constructor:cs,isLineSegments:!0,computeLineDistances:(Po=new Yt,Do=new Yt,function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){for(var t=e.attributes.position,n=[],r=0,i=t.count;r<i;r+=2)Po.fromBufferAttribute(t,r),Do.fromBufferAttribute(t,r+1),n[r]=0===r?0:n[r-1],n[r+1]=n[r]+Po.distanceTo(Do);e.addAttribute("lineDistance",new Fr(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry){var a=e.vertices;for(n=e.lineDistances,r=0,i=a.length;r<i;r+=2)Po.copy(a[r]),Do.copy(a[r+1]),n[r]=0===r?0:n[r-1],n[r+1]=n[r]+Po.distanceTo(Do)}return this})}),ds.prototype=Object.assign(Object.create(us.prototype),{constructor:ds,isLineLoop:!0}),((hs.prototype=Object.create(zi.prototype)).constructor=hs).prototype.isPointsMaterial=!0,hs.prototype.copy=function(e){return zi.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.morphTargets=e.morphTargets,this},fs.prototype=Object.assign(Object.create(vr.prototype),{constructor:fs,isPoints:!0,raycast:(Lo=new Wt,Oo=new Yi,No=new Nn,function(i,a){var o=this,e=this.geometry,s=this.matrixWorld,t=i.params.Points.threshold;if(null===e.boundingSphere&&e.computeBoundingSphere(),No.copy(e.boundingSphere),No.applyMatrix4(s),No.radius+=t,!1!==i.ray.intersectsSphere(No)){Lo.getInverse(s),Oo.copy(i.ray).applyMatrix4(Lo);var n=t/((this.scale.x+this.scale.y+this.scale.z)/3),l=n*n,r=new Yt,u=new Yt;if(e.isBufferGeometry){var c=e.index,d=e.attributes.position.array;if(null!==c)for(var h=c.array,f=0,p=h.length;f<p;f++){var m=h[f];r.fromArray(d,3*m),y(r,m)}else{f=0;for(var g=d.length/3;f<g;f++)r.fromArray(d,3*f),y(r,f)}}else{var v=e.vertices;for(f=0,g=v.length;f<g;f++)y(v[f],f)}}function y(e,t){var n=Oo.distanceSqToPoint(e);if(n<l){Oo.closestPointToPoint(e,u),u.applyMatrix4(s);var r=i.ray.origin.distanceTo(u);if(r<i.near||r>i.far)return;a.push({distance:r,distanceToRay:Math.sqrt(n),point:u.clone(),index:t,face:null,object:o})}}}),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),ps.prototype=Object.assign(Object.create(vr.prototype),{constructor:ps,isGroup:!0}),ms.prototype=Object.assign(Object.create(xn.prototype),{constructor:ms,isVideoTexture:!0,update:function(){var e=this.image;e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),((gs.prototype=Object.create(xn.prototype)).constructor=gs).prototype.isCompressedTexture=!0,((vs.prototype=Object.create(xn.prototype)).constructor=vs).prototype.isDepthTexture=!0,(ys.prototype=Object.create($r.prototype)).constructor=ys,(_s.prototype=Object.create(Rr.prototype)).constructor=_s,(bs.prototype=Object.create($r.prototype)).constructor=bs,(Es.prototype=Object.create(Rr.prototype)).constructor=Es,(Ts.prototype=Object.create($r.prototype)).constructor=Ts,(As.prototype=Object.create(Rr.prototype)).constructor=As,(ws.prototype=Object.create(Ts.prototype)).constructor=ws,(Ss.prototype=Object.create(Rr.prototype)).constructor=Ss,(Cs.prototype=Object.create(Ts.prototype)).constructor=Cs,(xs.prototype=Object.create(Rr.prototype)).constructor=xs,(Ms.prototype=Object.create(Ts.prototype)).constructor=Ms,(Rs.prototype=Object.create(Rr.prototype)).constructor=Rs,(Is.prototype=Object.create(Ts.prototype)).constructor=Is,(Ps.prototype=Object.create(Rr.prototype)).constructor=Ps,(Ds.prototype=Object.create($r.prototype)).constructor=Ds,(Ls.prototype=Object.create(Rr.prototype)).constructor=Ls,(Os.prototype=Object.create($r.prototype)).constructor=Os,(Ns.prototype=Object.create(Rr.prototype)).constructor=Ns,(ks.prototype=Object.create($r.prototype)).constructor=ks;var Bs=function(e,t,n){n=n||2;var r,i,a,o,s,l,u,c=t&&t.length,d=c?t[0]*n:e.length,h=Fs(e,0,d,n,!0),f=[];if(!h)return f;if(c&&(h=function(e,t,n,r){var i,a,o,s,l,u=[];for(i=0,a=t.length;i<a;i++)o=t[i]*r,s=i<a-1?t[i+1]*r:e.length,(l=Fs(e,o,s,r,!1))===l.next&&(l.steiner=!0),u.push(Ks(l));for(u.sort(Ws),i=0;i<u.length;i++)qs(u[i],n),n=js(n,n.next);return n}(e,t,h,n)),e.length>80*n){r=a=e[0],i=o=e[1];for(var p=n;p<d;p+=n)(s=e[p])<r&&(r=s),(l=e[p+1])<i&&(i=l),a<s&&(a=s),o<l&&(o=l);u=0!==(u=Math.max(a-r,o-i))?1/u:0}return Us(h,f,n,r,i,u),f};function Fs(e,t,n,r,i){var a,o;if(i===0<function(e,t,n,r){for(var i=0,a=t,o=n-r;a<n;a+=r)i+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return i}(e,t,n,r))for(a=t;a<n;a+=r)o=tl(a,e[a],e[a+1],o);else for(a=n-r;t<=a;a-=r)o=tl(a,e[a],e[a+1],o);return o&&Zs(o,o.next)&&(nl(o),o=o.next),o}function js(e,t){if(!e)return e;t=t||e;var n,r=e;do{if(n=!1,r.steiner||!Zs(r,r.next)&&0!==Qs(r.prev,r,r.next))r=r.next;else{if(nl(r),(r=t=r.prev)===r.next)break;n=!0}}while(n||r!==t);return t}function Us(e,t,n,r,i,a,o){if(e){!o&&a&&function(e,t,n,r){var i=e;for(;null===i.z&&(i.z=Ys(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next,i!==e;);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,n,r,i,a,o,s,l,u=1;do{for(n=e,a=e=null,o=0;n;){for(o++,r=n,t=s=0;t<u&&(s++,r=r.nextZ);t++);for(l=u;0<s||0<l&&r;)0!==s&&(0===l||!r||n.z<=r.z)?(n=(i=n).nextZ,s--):(r=(i=r).nextZ,l--),a?a.nextZ=i:e=i,i.prevZ=a,a=i;n=r}a.nextZ=null,u*=2}while(1<o)}(i)}(e,r,i,a);for(var s,l,u=e;e.prev!==e.next;)if(s=e.prev,l=e.next,a?Gs(e,r,i,a):Hs(e))t.push(s.i/n),t.push(e.i/n),t.push(l.i/n),nl(e),e=l.next,u=l.next;else if((e=l)===u){o?1===o?Us(e=Vs(e,t,n),t,n,r,i,a,2):2===o&&zs(e,t,n,r,i,a):Us(js(e),t,n,r,i,a,1);break}}}function Hs(e){var t=e.prev,n=e,r=e.next;if(0<=Qs(t,n,r))return!1;for(var i=e.next.next;i!==e.prev;){if(Xs(t.x,t.y,n.x,n.y,r.x,r.y,i.x,i.y)&&0<=Qs(i.prev,i,i.next))return!1;i=i.next}return!0}function Gs(e,t,n,r){var i=e.prev,a=e,o=e.next;if(0<=Qs(i,a,o))return!1;for(var s=i.x<a.x?i.x<o.x?i.x:o.x:a.x<o.x?a.x:o.x,l=i.y<a.y?i.y<o.y?i.y:o.y:a.y<o.y?a.y:o.y,u=i.x>a.x?i.x>o.x?i.x:o.x:a.x>o.x?a.x:o.x,c=i.y>a.y?i.y>o.y?i.y:o.y:a.y>o.y?a.y:o.y,d=Ys(s,l,t,n,r),h=Ys(u,c,t,n,r),f=e.nextZ;f&&f.z<=h;){if(f!==e.prev&&f!==e.next&&Xs(i.x,i.y,a.x,a.y,o.x,o.y,f.x,f.y)&&0<=Qs(f.prev,f,f.next))return!1;f=f.nextZ}for(f=e.prevZ;f&&f.z>=d;){if(f!==e.prev&&f!==e.next&&Xs(i.x,i.y,a.x,a.y,o.x,o.y,f.x,f.y)&&0<=Qs(f.prev,f,f.next))return!1;f=f.prevZ}return!0}function Vs(e,t,n){var r=e;do{var i=r.prev,a=r.next.next;!Zs(i,a)&&Js(i,r,r.next,a)&&$s(i,a)&&$s(a,i)&&(t.push(i.i/n),t.push(r.i/n),t.push(a.i/n),nl(r),nl(r.next),r=e=a),r=r.next}while(r!==e);return r}function zs(e,t,n,r,i,a){var o,s,l=e;do{for(var u=l.next.next;u!==l.prev;){if(l.i!==u.i&&(s=u,(o=l).next.i!==s.i&&o.prev.i!==s.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&Js(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(o,s)&&$s(o,s)&&$s(s,o)&&function(e,t){var n=e,r=!1,i=(e.x+t.x)/2,a=(e.y+t.y)/2;for(;n.y>a!=n.next.y>a&&n.next.y!==n.y&&i<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next,n!==e;);return r}(o,s))){var c=el(l,u);return l=js(l,l.next),c=js(c,c.next),Us(l,t,n,r,i,a),void Us(c,t,n,r,i,a)}u=u.next}l=l.next}while(l!==e)}function Ws(e,t){return e.x-t.x}function qs(e,t){if(t=function(e,t){var n,r=t,i=e.x,a=e.y,o=-1/0;do{if(a<=r.y&&a>=r.next.y&&r.next.y!==r.y){var s=r.x+(a-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&o<s){if((o=s)===i){if(a===r.y)return r;if(a===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!n)return null;if(i===o)return n.prev;var l,u=n,c=n.x,d=n.y,h=1/0;r=n.next;for(;r!==u;)i>=r.x&&r.x>=c&&i!==r.x&&Xs(a<d?i:o,a,c,d,a<d?o:i,a,r.x,r.y)&&((l=Math.abs(a-r.y)/(i-r.x))<h||l===h&&r.x>n.x)&&$s(r,e)&&(n=r,h=l),r=r.next;return n}(e,t)){var n=el(t,e);js(n,n.next)}}function Ys(e,t,n,r,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Ks(e){for(var t=e,n=e;t.x<n.x&&(n=t),(t=t.next)!==e;);return n}function Xs(e,t,n,r,i,a,o,s){return 0<=(i-o)*(t-s)-(e-o)*(a-s)&&0<=(e-o)*(r-s)-(n-o)*(t-s)&&0<=(n-o)*(a-s)-(i-o)*(r-s)}function Qs(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function Zs(e,t){return e.x===t.x&&e.y===t.y}function Js(e,t,n,r){return!!(Zs(e,t)&&Zs(n,r)||Zs(e,r)&&Zs(n,t))||0<Qs(e,t,n)!=0<Qs(e,t,r)&&0<Qs(n,r,e)!=0<Qs(n,r,t)}function $s(e,t){return Qs(e.prev,e,e.next)<0?0<=Qs(e,t,e.next)&&0<=Qs(e,e.prev,t):Qs(e,t,e.prev)<0||Qs(e,e.next,t)<0}function el(e,t){var n=new rl(e.i,e.x,e.y),r=new rl(t.i,t.x,t.y),i=e.next,a=t.prev;return(e.next=t).prev=e,(n.next=i).prev=n,(r.next=n).prev=r,(a.next=r).prev=a,r}function tl(e,t,n,r){var i=new rl(e,t,n);return r?(i.next=r.next,(i.prev=r).next.prev=i,r.next=i):(i.prev=i).next=i,i}function nl(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function rl(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var il={area:function(e){for(var t=e.length,n=0,r=t-1,i=0;i<t;r=i++)n+=e[r].x*e[i].y-e[i].x*e[r].y;return.5*n},isClockWise:function(e){return il.area(e)<0},triangulateShape:function(e,t){var n=[],r=[],i=[];al(e),ol(n,e);var a=e.length;t.forEach(al);for(var o=0;o<t.length;o++)r.push(a),a+=t[o].length,ol(n,t[o]);var s=Bs(n,r);for(o=0;o<s.length;o+=3)i.push(s.slice(o,o+3));return i}};function al(e){var t=e.length;2<t&&e[t-1].equals(e[0])&&e.pop()}function ol(e,t){for(var n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}function sl(e,t){Rr.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},this.fromBufferGeometry(new ll(e,t)),this.mergeVertices()}function ll(e,Q){$r.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:e,options:Q},e=Array.isArray(e)?e:[e];for(var Z=this,J=[],$=[],t=0,n=e.length;t<n;t++){r(e[t])}function r(e){var r=[],t=void 0!==Q.curveSegments?Q.curveSegments:12,l=void 0!==Q.steps?Q.steps:1,n=void 0!==Q.depth?Q.depth:100,i=void 0===Q.bevelEnabled||Q.bevelEnabled,a=void 0!==Q.bevelThickness?Q.bevelThickness:6,o=void 0!==Q.bevelSize?Q.bevelSize:a-2,u=void 0!==Q.bevelSegments?Q.bevelSegments:3,s=Q.extrudePath,c=void 0!==Q.UVGenerator?Q.UVGenerator:ul;void 0!==Q.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),n=Q.amount);var d,h,f,p,m,g,v,y,_=!1;s&&(d=s.getSpacedPoints(l),i=!(_=!0),h=s.computeFrenetFrames(l,!1),f=new Yt,p=new Yt,m=new Yt),i||(o=a=u=0);var b=e.extractPoints(t),E=b.shape,T=b.holes;if(!il.isClockWise(E))for(E=E.reverse(),v=0,y=T.length;v<y;v++)g=T[v],il.isClockWise(g)&&(T[v]=g.reverse());var A=il.triangulateShape(E,T),w=E;for(v=0,y=T.length;v<y;v++)g=T[v],E=E.concat(g);function S(e,t,n){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(n).add(e)}var C,x,M,R,I,P,D=E.length,L=A.length;function O(e,t,n){var r,i,a,o=e.x-t.x,s=e.y-t.y,l=n.x-e.x,u=n.y-e.y,c=o*o+s*s,d=o*u-s*l;if(Math.abs(d)>Number.EPSILON){var h=Math.sqrt(c),f=Math.sqrt(l*l+u*u),p=t.x-s/h,m=t.y+o/h,g=((n.x-u/f-p)*u-(n.y+l/f-m)*l)/(o*u-s*l),v=(r=p+o*g-e.x)*r+(i=m+s*g-e.y)*i;if(v<=2)return new zt(r,i);a=Math.sqrt(v/2)}else{var y=!1;o>Number.EPSILON?l>Number.EPSILON&&(y=!0):o<-Number.EPSILON?l<-Number.EPSILON&&(y=!0):Math.sign(s)===Math.sign(u)&&(y=!0),a=y?(r=-s,i=o,Math.sqrt(c)):(r=o,i=s,Math.sqrt(c/2))}return new zt(r/a,i/a)}for(var N=[],k=0,B=w.length,F=B-1,j=k+1;k<B;k++,F++,j++)F===B&&(F=0),j===B&&(j=0),N[k]=O(w[k],w[F],w[j]);var U,H,G=[],V=N.concat();for(v=0,y=T.length;v<y;v++){for(g=T[v],U=[],k=0,F=(B=g.length)-1,j=k+1;k<B;k++,F++,j++)F===B&&(F=0),j===B&&(j=0),U[k]=O(g[k],g[F],g[j]);G.push(U),V=V.concat(U)}for(C=0;C<u;C++){for(M=C/u,R=a*Math.cos(M*Math.PI/2),x=o*Math.sin(M*Math.PI/2),k=0,B=w.length;k<B;k++)W((I=S(w[k],N[k],x)).x,I.y,-R);for(v=0,y=T.length;v<y;v++)for(g=T[v],U=G[v],k=0,B=g.length;k<B;k++)W((I=S(g[k],U[k],x)).x,I.y,-R)}for(x=o,k=0;k<D;k++)I=i?S(E[k],V[k],x):E[k],_?(p.copy(h.normals[0]).multiplyScalar(I.x),f.copy(h.binormals[0]).multiplyScalar(I.y),m.copy(d[0]).add(p).add(f),W(m.x,m.y,m.z)):W(I.x,I.y,0);for(H=1;H<=l;H++)for(k=0;k<D;k++)I=i?S(E[k],V[k],x):E[k],_?(p.copy(h.normals[H]).multiplyScalar(I.x),f.copy(h.binormals[H]).multiplyScalar(I.y),m.copy(d[H]).add(p).add(f),W(m.x,m.y,m.z)):W(I.x,I.y,n/l*H);for(C=u-1;0<=C;C--){for(M=C/u,R=a*Math.cos(M*Math.PI/2),x=o*Math.sin(M*Math.PI/2),k=0,B=w.length;k<B;k++)W((I=S(w[k],N[k],x)).x,I.y,n+R);for(v=0,y=T.length;v<y;v++)for(g=T[v],U=G[v],k=0,B=g.length;k<B;k++)I=S(g[k],U[k],x),_?W(I.x,I.y+d[l-1].y,d[l-1].x+R):W(I.x,I.y,n+R)}function z(e,t){var n,r;for(k=e.length;0<=--k;){(r=(n=k)-1)<0&&(r=e.length-1);var i=0,a=l+2*u;for(i=0;i<a;i++){var o=D*i,s=D*(i+1);Y(t+n+o,t+r+o,t+r+s,t+n+s)}}}function W(e,t,n){r.push(e),r.push(t),r.push(n)}function q(e,t,n){K(e),K(t),K(n);var r=J.length/3,i=c.generateTopUV(Z,J,r-3,r-2,r-1);X(i[0]),X(i[1]),X(i[2])}function Y(e,t,n,r){K(e),K(t),K(r),K(t),K(n),K(r);var i=J.length/3,a=c.generateSideWallUV(Z,J,i-6,i-3,i-2,i-1);X(a[0]),X(a[1]),X(a[3]),X(a[1]),X(a[2]),X(a[3])}function K(e){J.push(r[3*e+0]),J.push(r[3*e+1]),J.push(r[3*e+2])}function X(e){$.push(e.x),$.push(e.y)}!function(){var e=J.length/3;if(i){var t=0,n=D*t;for(k=0;k<L;k++)q((P=A[k])[2]+n,P[1]+n,P[0]+n);for(n=D*(t=l+2*u),k=0;k<L;k++)q((P=A[k])[0]+n,P[1]+n,P[2]+n)}else{for(k=0;k<L;k++)q((P=A[k])[2],P[1],P[0]);for(k=0;k<L;k++)q((P=A[k])[0]+D*l,P[1]+D*l,P[2]+D*l)}Z.addGroup(e,J.length/3-e,0)}(),function(){var e=J.length/3,t=0;for(z(w,t),t+=w.length,v=0,y=T.length;v<y;v++)z(g=T[v],t),t+=g.length;Z.addGroup(e,J.length/3-e,1)}()}this.addAttribute("position",new Fr(J,3)),this.addAttribute("uv",new Fr($,2)),this.computeVertexNormals()}((sl.prototype=Object.create(Rr.prototype)).constructor=sl).prototype.toJSON=function(){var e=Rr.prototype.toJSON.call(this);return cl(this.parameters.shapes,this.parameters.options,e)},((ll.prototype=Object.create($r.prototype)).constructor=ll).prototype.toJSON=function(){var e=$r.prototype.toJSON.call(this);return cl(this.parameters.shapes,this.parameters.options,e)};var ul={generateTopUV:function(e,t,n,r,i){var a=t[3*n],o=t[3*n+1],s=t[3*r],l=t[3*r+1],u=t[3*i],c=t[3*i+1];return[new zt(a,o),new zt(s,l),new zt(u,c)]},generateSideWallUV:function(e,t,n,r,i,a){var o=t[3*n],s=t[3*n+1],l=t[3*n+2],u=t[3*r],c=t[3*r+1],d=t[3*r+2],h=t[3*i],f=t[3*i+1],p=t[3*i+2],m=t[3*a],g=t[3*a+1],v=t[3*a+2];return Math.abs(s-c)<.01?[new zt(o,1-l),new zt(u,1-d),new zt(h,1-p),new zt(m,1-v)]:[new zt(s,1-l),new zt(c,1-d),new zt(f,1-p),new zt(g,1-v)]}};function cl(e,t,n){if(n.shapes=[],Array.isArray(e))for(var r=0,i=e.length;r<i;r++){var a=e[r];n.shapes.push(a.uuid)}else n.shapes.push(e.uuid);return void 0!==t.extrudePath&&(n.options.extrudePath=t.extrudePath.toJSON()),n}function dl(e,t){Rr.call(this),this.type="TextGeometry",this.parameters={text:e,parameters:t},this.fromBufferGeometry(new hl(e,t)),this.mergeVertices()}function hl(e,t){var n=(t=t||{}).font;if(!n||!n.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new Rr;var r=n.generateShapes(e,t.size,t.curveSegments);t.depth=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),ll.call(this,r,t),this.type="TextBufferGeometry"}function fl(e,t,n,r,i,a,o){Rr.call(this),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:i,thetaStart:a,thetaLength:o},this.fromBufferGeometry(new pl(e,t,n,r,i,a,o)),this.mergeVertices()}function pl(e,t,n,r,i,a,o){$r.call(this),this.type="SphereBufferGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:i,thetaStart:a,thetaLength:o},e=e||1,t=Math.max(3,Math.floor(t)||8),n=Math.max(2,Math.floor(n)||6),r=void 0!==r?r:0,i=void 0!==i?i:2*Math.PI;var s,l,u=(a=void 0!==a?a:0)+(o=void 0!==o?o:Math.PI),c=0,d=[],h=new Yt,f=new Yt,p=[],m=[],g=[],v=[];for(l=0;l<=n;l++){var y=[],_=l/n;for(s=0;s<=t;s++){var b=s/t;h.x=-e*Math.cos(r+b*i)*Math.sin(a+_*o),h.y=e*Math.cos(a+_*o),h.z=e*Math.sin(r+b*i)*Math.sin(a+_*o),m.push(h.x,h.y,h.z),f.set(h.x,h.y,h.z).normalize(),g.push(f.x,f.y,f.z),v.push(b,1-_),y.push(c++)}d.push(y)}for(l=0;l<n;l++)for(s=0;s<t;s++){var E=d[l][s+1],T=d[l][s],A=d[l+1][s],w=d[l+1][s+1];(0!==l||0<a)&&p.push(E,T,w),(l!==n-1||u<Math.PI)&&p.push(T,A,w)}this.setIndex(p),this.addAttribute("position",new Fr(m,3)),this.addAttribute("normal",new Fr(g,3)),this.addAttribute("uv",new Fr(v,2))}function ml(e,t,n,r,i,a){Rr.call(this),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:a},this.fromBufferGeometry(new gl(e,t,n,r,i,a)),this.mergeVertices()}function gl(e,t,n,r,i,a){$r.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:a},e=e||.5,t=t||1,i=void 0!==i?i:0,a=void 0!==a?a:2*Math.PI,n=void 0!==n?Math.max(3,n):8;var o,s,l,u=[],c=[],d=[],h=[],f=e,p=(t-e)/(r=void 0!==r?Math.max(1,r):1),m=new Yt,g=new zt;for(s=0;s<=r;s++){for(l=0;l<=n;l++)o=i+l/n*a,m.x=f*Math.cos(o),m.y=f*Math.sin(o),c.push(m.x,m.y,m.z),d.push(0,0,1),g.x=(m.x/t+1)/2,g.y=(m.y/t+1)/2,h.push(g.x,g.y);f+=p}for(s=0;s<r;s++){var v=s*(n+1);for(l=0;l<n;l++){var y=o=l+v,_=o+n+1,b=o+n+2,E=o+1;u.push(y,_,E),u.push(_,b,E)}}this.setIndex(u),this.addAttribute("position",new Fr(c,3)),this.addAttribute("normal",new Fr(d,3)),this.addAttribute("uv",new Fr(h,2))}function vl(e,t,n,r){Rr.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:r},this.fromBufferGeometry(new yl(e,t,n,r)),this.mergeVertices()}function yl(e,t,n,r){$r.call(this),this.type="LatheBufferGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:r},t=Math.floor(t)||12,n=n||0,r=r||2*Math.PI,r=Vt.clamp(r,0,2*Math.PI);var i,a,o,s=[],l=[],u=[],c=1/t,d=new Yt,h=new zt;for(a=0;a<=t;a++){var f=n+a*c*r,p=Math.sin(f),m=Math.cos(f);for(o=0;o<=e.length-1;o++)d.x=e[o].x*p,d.y=e[o].y,d.z=e[o].x*m,l.push(d.x,d.y,d.z),h.x=a/t,h.y=o/(e.length-1),u.push(h.x,h.y)}for(a=0;a<t;a++)for(o=0;o<e.length-1;o++){var g=i=o+a*e.length,v=i+e.length,y=i+e.length+1,_=i+1;s.push(g,v,_),s.push(v,y,_)}if(this.setIndex(s),this.addAttribute("position",new Fr(l,3)),this.addAttribute("uv",new Fr(u,2)),this.computeVertexNormals(),r===2*Math.PI){var b=this.attributes.normal.array,E=new Yt,T=new Yt,A=new Yt;for(i=t*e.length*3,o=a=0;a<e.length;a++,o+=3)E.x=b[o+0],E.y=b[o+1],E.z=b[o+2],T.x=b[i+o+0],T.y=b[i+o+1],T.z=b[i+o+2],A.addVectors(E,T).normalize(),b[o+0]=b[i+o+0]=A.x,b[o+1]=b[i+o+1]=A.y,b[o+2]=b[i+o+2]=A.z}}function _l(e,t){Rr.call(this),this.type="ShapeGeometry","object"==typeof t&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),t=t.curveSegments),this.parameters={shapes:e,curveSegments:t},this.fromBufferGeometry(new bl(e,t)),this.mergeVertices()}function bl(e,p){$r.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:e,curveSegments:p},p=p||12;var m=[],g=[],v=[],y=[],t=0,_=0;if(!1===Array.isArray(e))r(e);else for(var n=0;n<e.length;n++)r(e[n]),this.addGroup(t,_,n),t+=_,_=0;function r(e){var t,n,r,i=g.length/3,a=e.extractPoints(p),o=a.shape,s=a.holes;if(!1===il.isClockWise(o))for(o=o.reverse(),t=0,n=s.length;t<n;t++)r=s[t],!0===il.isClockWise(r)&&(s[t]=r.reverse());var l=il.triangulateShape(o,s);for(t=0,n=s.length;t<n;t++)r=s[t],o=o.concat(r);for(t=0,n=o.length;t<n;t++){var u=o[t];g.push(u.x,u.y,0),v.push(0,0,1),y.push(u.x,u.y)}for(t=0,n=l.length;t<n;t++){var c=l[t],d=c[0]+i,h=c[1]+i,f=c[2]+i;m.push(d,h,f),_+=3}}this.setIndex(m),this.addAttribute("position",new Fr(g,3)),this.addAttribute("normal",new Fr(v,3)),this.addAttribute("uv",new Fr(y,2))}function El(e,t){if(t.shapes=[],Array.isArray(e))for(var n=0,r=e.length;n<r;n++){var i=e[n];t.shapes.push(i.uuid)}else t.shapes.push(e.uuid);return t}function Tl(e,t){$r.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:t},t=void 0!==t?t:1;var n,r,i,a,o=[],s=Math.cos(Vt.DEG2RAD*t),l=[0,0],u={},c=["a","b","c"];e.isBufferGeometry?(a=new Rr).fromBufferGeometry(e):a=e.clone(),a.mergeVertices(),a.computeFaceNormals();for(var d=a.vertices,h=a.faces,f=0,p=h.length;f<p;f++)for(var m=h[f],g=0;g<3;g++)n=m[c[g]],r=m[c[(g+1)%3]],l[0]=Math.min(n,r),l[1]=Math.max(n,r),void 0===u[i=l[0]+","+l[1]]?u[i]={index1:l[0],index2:l[1],face1:f,face2:void 0}:u[i].face2=f;for(i in u){var v=u[i];if(void 0===v.face2||h[v.face1].normal.dot(h[v.face2].normal)<=s){var y=d[v.index1];o.push(y.x,y.y,y.z),y=d[v.index2],o.push(y.x,y.y,y.z)}}this.addAttribute("position",new Fr(o,3))}function Al(e,t,n,r,i,a,o,s){Rr.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:i,openEnded:a,thetaStart:o,thetaLength:s},this.fromBufferGeometry(new wl(e,t,n,r,i,a,o,s)),this.mergeVertices()}function wl(v,y,_,b,E,e,T,A){$r.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:v,radiusBottom:y,height:_,radialSegments:b,heightSegments:E,openEnded:e,thetaStart:T,thetaLength:A};var w=this;v=void 0!==v?v:1,y=void 0!==y?y:1,_=_||1,b=Math.floor(b)||8,E=Math.floor(E)||1,e=void 0!==e&&e,T=void 0!==T?T:0,A=void 0!==A?A:2*Math.PI;var S=[],C=[],x=[],M=[],R=0,I=[],P=_/2,D=0;function t(e){var t,n,r,i=new zt,a=new Yt,o=0,s=!0===e?v:y,l=!0===e?1:-1;for(n=R,t=1;t<=b;t++)C.push(0,P*l,0),x.push(0,l,0),M.push(.5,.5),R++;for(r=R,t=0;t<=b;t++){var u=t/b*A+T,c=Math.cos(u),d=Math.sin(u);a.x=s*d,a.y=P*l,a.z=s*c,C.push(a.x,a.y,a.z),x.push(0,l,0),i.x=.5*c+.5,i.y=.5*d*l+.5,M.push(i.x,i.y),R++}for(t=0;t<b;t++){var h=n+t,f=r+t;!0===e?S.push(f,f+1,h):S.push(f+1,f,h),o+=3}w.addGroup(D,o,!0===e?1:2),D+=o}!function(){var e,t,n=new Yt,r=new Yt,i=0,a=(y-v)/_;for(t=0;t<=E;t++){var o=[],s=t/E,l=s*(y-v)+v;for(e=0;e<=b;e++){var u=e/b,c=u*A+T,d=Math.sin(c),h=Math.cos(c);r.x=l*d,r.y=-s*_+P,r.z=l*h,C.push(r.x,r.y,r.z),n.set(d,a,h).normalize(),x.push(n.x,n.y,n.z),M.push(u,1-s),o.push(R++)}I.push(o)}for(e=0;e<b;e++)for(t=0;t<E;t++){var f=I[t][e],p=I[t+1][e],m=I[t+1][e+1],g=I[t][e+1];S.push(f,p,g),S.push(p,m,g),i+=6}w.addGroup(D,i,0),D+=i}(),!1===e&&(0<v&&t(!0),0<y&&t(!1)),this.setIndex(S),this.addAttribute("position",new Fr(C,3)),this.addAttribute("normal",new Fr(x,3)),this.addAttribute("uv",new Fr(M,2))}function Sl(e,t,n,r,i,a,o){Al.call(this,0,e,t,n,r,i,a,o),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:a,thetaLength:o}}function Cl(e,t,n,r,i,a,o){wl.call(this,0,e,t,n,r,i,a,o),this.type="ConeBufferGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:a,thetaLength:o}}function xl(e,t,n,r){Rr.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},this.fromBufferGeometry(new Ml(e,t,n,r)),this.mergeVertices()}function Ml(e,t,n,r){$r.call(this),this.type="CircleBufferGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},e=e||1,t=void 0!==t?Math.max(3,t):8,n=void 0!==n?n:0,r=void 0!==r?r:2*Math.PI;var i,a,o=[],s=[],l=[],u=[],c=new Yt,d=new zt;for(s.push(0,0,0),l.push(0,0,1),u.push(.5,.5),a=0,i=3;a<=t;a++,i+=3){var h=n+a/t*r;c.x=e*Math.cos(h),c.y=e*Math.sin(h),s.push(c.x,c.y,c.z),l.push(0,0,1),d.x=(s[i]/e+1)/2,d.y=(s[i+1]/e+1)/2,u.push(d.x,d.y)}for(i=1;i<=t;i++)o.push(i,i+1,0);this.setIndex(o),this.addAttribute("position",new Fr(s,3)),this.addAttribute("normal",new Fr(l,3)),this.addAttribute("uv",new Fr(u,2))}(dl.prototype=Object.create(Rr.prototype)).constructor=dl,(hl.prototype=Object.create(ll.prototype)).constructor=hl,(fl.prototype=Object.create(Rr.prototype)).constructor=fl,(pl.prototype=Object.create($r.prototype)).constructor=pl,(ml.prototype=Object.create(Rr.prototype)).constructor=ml,(gl.prototype=Object.create($r.prototype)).constructor=gl,(vl.prototype=Object.create(Rr.prototype)).constructor=vl,(yl.prototype=Object.create($r.prototype)).constructor=yl,((_l.prototype=Object.create(Rr.prototype)).constructor=_l).prototype.toJSON=function(){var e=Rr.prototype.toJSON.call(this);return El(this.parameters.shapes,e)},((bl.prototype=Object.create($r.prototype)).constructor=bl).prototype.toJSON=function(){var e=$r.prototype.toJSON.call(this);return El(this.parameters.shapes,e)},(Tl.prototype=Object.create($r.prototype)).constructor=Tl,(Al.prototype=Object.create(Rr.prototype)).constructor=Al,(wl.prototype=Object.create($r.prototype)).constructor=wl,(Sl.prototype=Object.create(Al.prototype)).constructor=Sl,(Cl.prototype=Object.create(wl.prototype)).constructor=Cl,(xl.prototype=Object.create(Rr.prototype)).constructor=xl,(Ml.prototype=Object.create($r.prototype)).constructor=Ml;var Rl=Object.freeze({WireframeGeometry:ys,ParametricGeometry:_s,ParametricBufferGeometry:bs,TetrahedronGeometry:As,TetrahedronBufferGeometry:ws,OctahedronGeometry:Ss,OctahedronBufferGeometry:Cs,IcosahedronGeometry:xs,IcosahedronBufferGeometry:Ms,DodecahedronGeometry:Rs,DodecahedronBufferGeometry:Is,PolyhedronGeometry:Es,PolyhedronBufferGeometry:Ts,TubeGeometry:Ps,TubeBufferGeometry:Ds,TorusKnotGeometry:Ls,TorusKnotBufferGeometry:Os,TorusGeometry:Ns,TorusBufferGeometry:ks,TextGeometry:dl,TextBufferGeometry:hl,SphereGeometry:fl,SphereBufferGeometry:pl,RingGeometry:ml,RingBufferGeometry:gl,PlaneGeometry:ni,PlaneBufferGeometry:ri,LatheGeometry:vl,LatheBufferGeometry:yl,ShapeGeometry:_l,ShapeBufferGeometry:bl,ExtrudeGeometry:sl,ExtrudeBufferGeometry:ll,EdgesGeometry:Tl,ConeGeometry:Sl,ConeBufferGeometry:Cl,CylinderGeometry:Al,CylinderBufferGeometry:wl,CircleGeometry:xl,CircleBufferGeometry:Ml,BoxGeometry:ei,BoxBufferGeometry:ti});function Il(e){zi.call(this),this.type="ShadowMaterial",this.color=new Gn(0),this.transparent=!0,this.setValues(e)}function Pl(e){qi.call(this,e),this.type="RawShaderMaterial"}function Dl(e){zi.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Gn(16777215),this.roughness=.5,this.metalness=.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Gn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new zt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Ll(e){Dl.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoat=0,this.clearCoatRoughness=0,this.setValues(e)}function Ol(e){zi.call(this),this.type="MeshPhongMaterial",this.color=new Gn(16777215),this.specular=new Gn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Gn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new zt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=_e,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Nl(e){Ol.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(e)}function kl(e){zi.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new zt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Bl(e){zi.call(this),this.type="MeshLambertMaterial",this.color=new Gn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Gn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=_e,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Fl(e){ls.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}((Il.prototype=Object.create(zi.prototype)).constructor=Il).prototype.isShadowMaterial=!0,Il.prototype.copy=function(e){return zi.prototype.copy.call(this,e),this.color.copy(e.color),this},((Pl.prototype=Object.create(qi.prototype)).constructor=Pl).prototype.isRawShaderMaterial=!0,((Dl.prototype=Object.create(zi.prototype)).constructor=Dl).prototype.isMeshStandardMaterial=!0,Dl.prototype.copy=function(e){return zi.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},((Ll.prototype=Object.create(Dl.prototype)).constructor=Ll).prototype.isMeshPhysicalMaterial=!0,Ll.prototype.copy=function(e){return Dl.prototype.copy.call(this,e),this.defines={PHYSICAL:""},this.reflectivity=e.reflectivity,this.clearCoat=e.clearCoat,this.clearCoatRoughness=e.clearCoatRoughness,this},((Ol.prototype=Object.create(zi.prototype)).constructor=Ol).prototype.isMeshPhongMaterial=!0,Ol.prototype.copy=function(e){return zi.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},((Nl.prototype=Object.create(Ol.prototype)).constructor=Nl).prototype.isMeshToonMaterial=!0,Nl.prototype.copy=function(e){return Ol.prototype.copy.call(this,e),this.gradientMap=e.gradientMap,this},((kl.prototype=Object.create(zi.prototype)).constructor=kl).prototype.isMeshNormalMaterial=!0,kl.prototype.copy=function(e){return zi.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},((Bl.prototype=Object.create(zi.prototype)).constructor=Bl).prototype.isMeshLambertMaterial=!0,Bl.prototype.copy=function(e){return zi.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},((Fl.prototype=Object.create(ls.prototype)).constructor=Fl).prototype.isLineDashedMaterial=!0,Fl.prototype.copy=function(e){return ls.prototype.copy.call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this};var jl=Object.freeze({ShadowMaterial:Il,SpriteMaterial:ns,RawShaderMaterial:Pl,ShaderMaterial:qi,PointsMaterial:hs,MeshPhysicalMaterial:Ll,MeshStandardMaterial:Dl,MeshPhongMaterial:Ol,MeshToonMaterial:Nl,MeshNormalMaterial:kl,MeshLambertMaterial:Bl,MeshDepthMaterial:Uo,MeshDistanceMaterial:Ho,MeshBasicMaterial:Wi,LineDashedMaterial:Fl,LineBasicMaterial:ls,Material:zi}),Ul={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};function Hl(e,t,n){var r=this,i=!1,a=0,o=0,s=void 0;this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(e){o++,!1===i&&void 0!==r.onStart&&r.onStart(e,a,o),i=!0},this.itemEnd=function(e){a++,void 0!==r.onProgress&&r.onProgress(e,a,o),a===o&&(i=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(e){void 0!==r.onError&&r.onError(e)},this.resolveURL=function(e){return s?s(e):e},this.setURLModifier=function(e){return s=e,this}}var Gl=new Hl,Vl={};function zl(e){this.manager=void 0!==e?e:Gl}function Wl(e){this.manager=void 0!==e?e:Gl}function ql(e){this.manager=void 0!==e?e:Gl}function Yl(){this.type="Curve",this.arcLengthDivisions=200}function Kl(e,t,n,r,i,a,o,s){Yl.call(this),this.type="EllipseCurve",this.aX=e||0,this.aY=t||0,this.xRadius=n||1,this.yRadius=r||1,this.aStartAngle=i||0,this.aEndAngle=a||2*Math.PI,this.aClockwise=o||!1,this.aRotation=s||0}function Xl(e,t,n,r,i,a){Kl.call(this,e,t,n,n,r,i,a),this.type="ArcCurve"}function Ql(){var i=0,a=0,o=0,s=0;function u(e,t,n,r){o=-3*(i=e)+3*t-2*(a=n)-r,s=2*e-2*t+n+r}return{initCatmullRom:function(e,t,n,r,i){u(t,n,i*(n-e),i*(r-t))},initNonuniformCatmullRom:function(e,t,n,r,i,a,o){var s=(t-e)/i-(n-e)/(i+a)+(n-t)/a,l=(n-t)/a-(r-t)/(a+o)+(r-n)/o;u(t,n,s*=a,l*=a)},calc:function(e){var t=e*e;return i+a*e+o*t+s*(t*e)}}}Object.assign(zl.prototype,{load:function(o,e,t,n){void 0===o&&(o=""),void 0!==this.path&&(o=this.path+o),o=this.manager.resolveURL(o);var s=this,r=Ul.get(o);if(void 0!==r)return s.manager.itemStart(o),setTimeout(function(){e&&e(r),s.manager.itemEnd(o)},0),r;if(void 0===Vl[o]){var i=o.match(/^data:(.*?)(;base64)?,(.*)$/);if(i){var a=i[1],l=!!i[2],u=i[3];u=window.decodeURIComponent(u),l&&(u=window.atob(u));try{var c,d=(this.responseType||"").toLowerCase();switch(d){case"arraybuffer":case"blob":for(var h=new Uint8Array(u.length),f=0;f<u.length;f++)h[f]=u.charCodeAt(f);c="blob"===d?new Blob([h.buffer],{type:a}):h.buffer;break;case"document":var p=new DOMParser;c=p.parseFromString(u,a);break;case"json":c=JSON.parse(u);break;default:c=u}window.setTimeout(function(){e&&e(c),s.manager.itemEnd(o)},0)}catch(e){window.setTimeout(function(){n&&n(e),s.manager.itemEnd(o),s.manager.itemError(o)},0)}}else{Vl[o]=[],Vl[o].push({onLoad:e,onProgress:t,onError:n});var m=new XMLHttpRequest;for(var g in m.open("GET",o,!0),m.addEventListener("load",function(e){var t=this.response;Ul.add(o,t);var n=Vl[o];if(delete Vl[o],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received.");for(var r=0,i=n.length;r<i;r++){(a=n[r]).onLoad&&a.onLoad(t)}s.manager.itemEnd(o)}else{for(r=0,i=n.length;r<i;r++){var a;(a=n[r]).onError&&a.onError(e)}s.manager.itemEnd(o),s.manager.itemError(o)}},!1),m.addEventListener("progress",function(e){for(var t=Vl[o],n=0,r=t.length;n<r;n++){var i=t[n];i.onProgress&&i.onProgress(e)}},!1),m.addEventListener("error",function(e){var t=Vl[o];delete Vl[o];for(var n=0,r=t.length;n<r;n++){var i=t[n];i.onError&&i.onError(e)}s.manager.itemEnd(o),s.manager.itemError(o)},!1),void 0!==this.responseType&&(m.responseType=this.responseType),void 0!==this.withCredentials&&(m.withCredentials=this.withCredentials),m.overrideMimeType&&m.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)m.setRequestHeader(g,this.requestHeader[g]);m.send(null)}return s.manager.itemStart(o),m}Vl[o].push({onLoad:e,onProgress:t,onError:n})},setPath:function(e){return this.path=e,this},setResponseType:function(e){return this.responseType=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setMimeType:function(e){return this.mimeType=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}}),Object.assign(function(e){this.manager=void 0!==e?e:Gl,this._parser=null}.prototype,{load:function(e,a,t,r){var o=this,s=[],l=new gs;l.image=s;var i=new zl(this.manager);function n(n){i.load(e[n],function(e){var t=o._parser(e,!0);s[n]={width:t.width,height:t.height,format:t.format,mipmaps:t.mipmaps},6===(u+=1)&&(1===t.mipmapCount&&(l.minFilter=Ge),l.format=t.format,l.needsUpdate=!0,a&&a(l))},t,r)}if(i.setPath(this.path),i.setResponseType("arraybuffer"),Array.isArray(e))for(var u=0,c=0,d=e.length;c<d;++c)n(c);else i.load(e,function(e){var t=o._parser(e,!0);if(t.isCubemap)for(var n=t.mipmaps.length/t.mipmapCount,r=0;r<n;r++){s[r]={mipmaps:[]};for(var i=0;i<t.mipmapCount;i++)s[r].mipmaps.push(t.mipmaps[r*t.mipmapCount+i]),s[r].format=t.format,s[r].width=t.width,s[r].height=t.height}else l.image.width=t.width,l.image.height=t.height,l.mipmaps=t.mipmaps;1===t.mipmapCount&&(l.minFilter=Ge),l.format=t.format,l.needsUpdate=!0,a&&a(l)},t,r);return l},setPath:function(e){return this.path=e,this}}),Object.assign(function(e){this.manager=void 0!==e?e:Gl,this._parser=null}.prototype,{load:function(e,n,t,r){var i=this,a=new Pn,o=new zl(this.manager);return o.setResponseType("arraybuffer"),o.load(e,function(e){var t=i._parser(e);t&&(void 0!==t.image?a.image=t.image:void 0!==t.data&&(a.image.width=t.width,a.image.height=t.height,a.image.data=t.data),a.wrapS=void 0!==t.wrapS?t.wrapS:Be,a.wrapT=void 0!==t.wrapT?t.wrapT:Be,a.magFilter=void 0!==t.magFilter?t.magFilter:Ge,a.minFilter=void 0!==t.minFilter?t.minFilter:ze,a.anisotropy=void 0!==t.anisotropy?t.anisotropy:1,void 0!==t.format&&(a.format=t.format),void 0!==t.type&&(a.type=t.type),void 0!==t.mipmaps&&(a.mipmaps=t.mipmaps),1===t.mipmapCount&&(a.minFilter=Ge),a.needsUpdate=!0,n&&n(a,t))},t,r),a}}),Object.assign(Wl.prototype,{crossOrigin:"Anonymous",load:function(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var i=this,a=Ul.get(t);if(void 0!==a)return i.manager.itemStart(t),setTimeout(function(){e&&e(a),i.manager.itemEnd(t)},0),a;var o=document.createElementNS("http://www.w3.org/1999/xhtml","img");function s(){o.removeEventListener("load",s,!1),o.removeEventListener("error",l,!1),Ul.add(t,this),e&&e(this),i.manager.itemEnd(t)}function l(e){o.removeEventListener("load",s,!1),o.removeEventListener("error",l,!1),r&&r(e),i.manager.itemEnd(t),i.manager.itemError(t)}return o.addEventListener("load",s,!1),o.addEventListener("error",l,!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),i.manager.itemStart(t),o.src=t,o},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(function(e){this.manager=void 0!==e?e:Gl}.prototype,{crossOrigin:"Anonymous",load:function(e,n,t,r){var i=new da,a=new Wl(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);var o=0;function s(t){a.load(e[t],function(e){i.images[t]=e,6===++o&&(i.needsUpdate=!0,n&&n(i))},void 0,r)}for(var l=0;l<e.length;++l)s(l);return i},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(ql.prototype,{crossOrigin:"Anonymous",load:function(n,r,e,t){var i=new xn,a=new Wl(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(n,function(e){i.image=e;var t=0<n.search(/\.(jpg|jpeg)$/)||0===n.search(/^data\:image\/jpeg/);i.format=t?it:at,i.needsUpdate=!0,void 0!==r&&r(i)},e,t),i},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(Yl.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e,t){var n=this.getUtoTmapping(e);return this.getPoint(n,t)},getPoints:function(e){void 0===e&&(e=5);for(var t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return t},getSpacedPoints:function(e){void 0===e&&(e=5);for(var t=[],n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(void 0===e&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,n,r=[],i=this.getPoint(0),a=0;for(r.push(0),n=1;n<=e;n++)a+=(t=this.getPoint(n/e)).distanceTo(i),r.push(a),i=t;return this.cacheArcLengths=r},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,t){var n,r=this.getLengths(),i=0,a=r.length;n=t||e*r[a-1];for(var o,s=0,l=a-1;s<=l;)if((o=r[i=Math.floor(s+(l-s)/2)]-n)<0)s=i+1;else{if(!(0<o)){l=i;break}l=i-1}if(r[i=l]===n)return i/(a-1);var u=r[i];return(i+(n-u)/(r[i+1]-u))/(a-1)},getTangent:function(e){var t=e-1e-4,n=e+1e-4;t<0&&(t=0),1<n&&(n=1);var r=this.getPoint(t);return this.getPoint(n).clone().sub(r).normalize()},getTangentAt:function(e){var t=this.getUtoTmapping(e);return this.getTangent(t)},computeFrenetFrames:function(e,t){var n,r,i,a=new Yt,o=[],s=[],l=[],u=new Yt,c=new Wt;for(n=0;n<=e;n++)r=n/e,o[n]=this.getTangentAt(r),o[n].normalize();s[0]=new Yt,l[0]=new Yt;var d=Number.MAX_VALUE,h=Math.abs(o[0].x),f=Math.abs(o[0].y),p=Math.abs(o[0].z);for(h<=d&&(d=h,a.set(1,0,0)),f<=d&&(d=f,a.set(0,1,0)),p<=d&&a.set(0,0,1),u.crossVectors(o[0],a).normalize(),s[0].crossVectors(o[0],u),l[0].crossVectors(o[0],s[0]),n=1;n<=e;n++)s[n]=s[n-1].clone(),l[n]=l[n-1].clone(),u.crossVectors(o[n-1],o[n]),u.length()>Number.EPSILON&&(u.normalize(),i=Math.acos(Vt.clamp(o[n-1].dot(o[n]),-1,1)),s[n].applyMatrix4(c.makeRotationAxis(u,i))),l[n].crossVectors(o[n],s[n]);if(!0===t)for(i=Math.acos(Vt.clamp(s[0].dot(s[e]),-1,1)),i/=e,0<o[0].dot(u.crossVectors(s[0],s[e]))&&(i=-i),n=1;n<=e;n++)s[n].applyMatrix4(c.makeRotationAxis(o[n],i*n)),l[n].crossVectors(o[n],s[n]);return{tangents:o,normals:s,binormals:l}},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},toJSON:function(){var e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e},fromJSON:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}),((Kl.prototype=Object.create(Yl.prototype)).constructor=Kl).prototype.isEllipseCurve=!0,Kl.prototype.getPoint=function(e,t){for(var n=t||new zt,r=2*Math.PI,i=this.aEndAngle-this.aStartAngle,a=Math.abs(i)<Number.EPSILON;i<0;)i+=r;for(;r<i;)i-=r;i<Number.EPSILON&&(i=a?0:r),!0!==this.aClockwise||a||(i===r?i=-r:i-=r);var o=this.aStartAngle+e*i,s=this.aX+this.xRadius*Math.cos(o),l=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){var u=Math.cos(this.aRotation),c=Math.sin(this.aRotation),d=s-this.aX,h=l-this.aY;s=d*u-h*c+this.aX,l=d*c+h*u+this.aY}return n.set(s,l)},Kl.prototype.copy=function(e){return Yl.prototype.copy.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},Kl.prototype.toJSON=function(){var e=Yl.prototype.toJSON.call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e},Kl.prototype.fromJSON=function(e){return Yl.prototype.fromJSON.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},((Xl.prototype=Object.create(Kl.prototype)).constructor=Xl).prototype.isArcCurve=!0;var Zl=new Yt,Jl=new Ql,$l=new Ql,eu=new Ql;function tu(e,t,n,r){Yl.call(this),this.type="CatmullRomCurve3",this.points=e||[],this.closed=t||!1,this.curveType=n||"centripetal",this.tension=r||.5}function nu(e,t,n,r,i){var a=.5*(r-t),o=.5*(i-n),s=e*e;return(2*n-2*r+a+o)*(e*s)+(-3*n+3*r-2*a-o)*s+a*e+n}function ru(e,t,n,r){return function(e,t){var n=1-e;return n*n*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,n)+function(e,t){return e*e*t}(e,r)}function iu(e,t,n,r,i){return function(e,t){var n=1-e;return n*n*n*t}(e,t)+function(e,t){var n=1-e;return 3*n*n*e*t}(e,n)+function(e,t){return 3*(1-e)*e*e*t}(e,r)+function(e,t){return e*e*e*t}(e,i)}function au(e,t,n,r){Yl.call(this),this.type="CubicBezierCurve",this.v0=e||new zt,this.v1=t||new zt,this.v2=n||new zt,this.v3=r||new zt}function ou(e,t,n,r){Yl.call(this),this.type="CubicBezierCurve3",this.v0=e||new Yt,this.v1=t||new Yt,this.v2=n||new Yt,this.v3=r||new Yt}function su(e,t){Yl.call(this),this.type="LineCurve",this.v1=e||new zt,this.v2=t||new zt}function lu(e,t){Yl.call(this),this.type="LineCurve3",this.v1=e||new Yt,this.v2=t||new Yt}function uu(e,t,n){Yl.call(this),this.type="QuadraticBezierCurve",this.v0=e||new zt,this.v1=t||new zt,this.v2=n||new zt}function cu(e,t,n){Yl.call(this),this.type="QuadraticBezierCurve3",this.v0=e||new Yt,this.v1=t||new Yt,this.v2=n||new Yt}function du(e){Yl.call(this),this.type="SplineCurve",this.points=e||[]}((tu.prototype=Object.create(Yl.prototype)).constructor=tu).prototype.isCatmullRomCurve3=!0,tu.prototype.getPoint=function(e,t){var n,r,i,a,o=t||new Yt,s=this.points,l=s.length,u=(l-(this.closed?0:1))*e,c=Math.floor(u),d=u-c;if(this.closed?c+=0<c?0:(Math.floor(Math.abs(c)/l)+1)*l:0===d&&c===l-1&&(c=l-2,d=1),n=this.closed||0<c?s[(c-1)%l]:(Zl.subVectors(s[0],s[1]).add(s[0]),Zl),r=s[c%l],i=s[(c+1)%l],a=this.closed||c+2<l?s[(c+2)%l]:(Zl.subVectors(s[l-1],s[l-2]).add(s[l-1]),Zl),"centripetal"===this.curveType||"chordal"===this.curveType){var h="chordal"===this.curveType?.5:.25,f=Math.pow(n.distanceToSquared(r),h),p=Math.pow(r.distanceToSquared(i),h),m=Math.pow(i.distanceToSquared(a),h);p<1e-4&&(p=1),f<1e-4&&(f=p),m<1e-4&&(m=p),Jl.initNonuniformCatmullRom(n.x,r.x,i.x,a.x,f,p,m),$l.initNonuniformCatmullRom(n.y,r.y,i.y,a.y,f,p,m),eu.initNonuniformCatmullRom(n.z,r.z,i.z,a.z,f,p,m)}else"catmullrom"===this.curveType&&(Jl.initCatmullRom(n.x,r.x,i.x,a.x,this.tension),$l.initCatmullRom(n.y,r.y,i.y,a.y,this.tension),eu.initCatmullRom(n.z,r.z,i.z,a.z,this.tension));return o.set(Jl.calc(d),$l.calc(d),eu.calc(d)),o},tu.prototype.copy=function(e){Yl.prototype.copy.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},tu.prototype.toJSON=function(){var e=Yl.prototype.toJSON.call(this);e.points=[];for(var t=0,n=this.points.length;t<n;t++){var r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e},tu.prototype.fromJSON=function(e){Yl.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var r=e.points[t];this.points.push((new Yt).fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},((au.prototype=Object.create(Yl.prototype)).constructor=au).prototype.isCubicBezierCurve=!0,au.prototype.getPoint=function(e,t){var n=t||new zt,r=this.v0,i=this.v1,a=this.v2,o=this.v3;return n.set(iu(e,r.x,i.x,a.x,o.x),iu(e,r.y,i.y,a.y,o.y)),n},au.prototype.copy=function(e){return Yl.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},au.prototype.toJSON=function(){var e=Yl.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},au.prototype.fromJSON=function(e){return Yl.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},((ou.prototype=Object.create(Yl.prototype)).constructor=ou).prototype.isCubicBezierCurve3=!0,ou.prototype.getPoint=function(e,t){var n=t||new Yt,r=this.v0,i=this.v1,a=this.v2,o=this.v3;return n.set(iu(e,r.x,i.x,a.x,o.x),iu(e,r.y,i.y,a.y,o.y),iu(e,r.z,i.z,a.z,o.z)),n},ou.prototype.copy=function(e){return Yl.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},ou.prototype.toJSON=function(){var e=Yl.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},ou.prototype.fromJSON=function(e){return Yl.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},((su.prototype=Object.create(Yl.prototype)).constructor=su).prototype.isLineCurve=!0,su.prototype.getPoint=function(e,t){var n=t||new zt;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n},su.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},su.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},su.prototype.copy=function(e){return Yl.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},su.prototype.toJSON=function(){var e=Yl.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},su.prototype.fromJSON=function(e){return Yl.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},((lu.prototype=Object.create(Yl.prototype)).constructor=lu).prototype.isLineCurve3=!0,lu.prototype.getPoint=function(e,t){var n=t||new Yt;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n},lu.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},lu.prototype.copy=function(e){return Yl.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},lu.prototype.toJSON=function(){var e=Yl.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},lu.prototype.fromJSON=function(e){return Yl.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},((uu.prototype=Object.create(Yl.prototype)).constructor=uu).prototype.isQuadraticBezierCurve=!0,uu.prototype.getPoint=function(e,t){var n=t||new zt,r=this.v0,i=this.v1,a=this.v2;return n.set(ru(e,r.x,i.x,a.x),ru(e,r.y,i.y,a.y)),n},uu.prototype.copy=function(e){return Yl.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},uu.prototype.toJSON=function(){var e=Yl.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},uu.prototype.fromJSON=function(e){return Yl.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},((cu.prototype=Object.create(Yl.prototype)).constructor=cu).prototype.isQuadraticBezierCurve3=!0,cu.prototype.getPoint=function(e,t){var n=t||new Yt,r=this.v0,i=this.v1,a=this.v2;return n.set(ru(e,r.x,i.x,a.x),ru(e,r.y,i.y,a.y),ru(e,r.z,i.z,a.z)),n},cu.prototype.copy=function(e){return Yl.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},cu.prototype.toJSON=function(){var e=Yl.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},cu.prototype.fromJSON=function(e){return Yl.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},((du.prototype=Object.create(Yl.prototype)).constructor=du).prototype.isSplineCurve=!0,du.prototype.getPoint=function(e,t){var n=t||new zt,r=this.points,i=(r.length-1)*e,a=Math.floor(i),o=i-a,s=r[0===a?a:a-1],l=r[a],u=r[a>r.length-2?r.length-1:a+1],c=r[a>r.length-3?r.length-1:a+2];return n.set(nu(o,s.x,l.x,u.x,c.x),nu(o,s.y,l.y,u.y,c.y)),n},du.prototype.copy=function(e){Yl.prototype.copy.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var r=e.points[t];this.points.push(r.clone())}return this},du.prototype.toJSON=function(){var e=Yl.prototype.toJSON.call(this);e.points=[];for(var t=0,n=this.points.length;t<n;t++){var r=this.points[t];e.points.push(r.toArray())}return e},du.prototype.fromJSON=function(e){Yl.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var r=e.points[t];this.points.push((new zt).fromArray(r))}return this};var hu=Object.freeze({ArcCurve:Xl,CatmullRomCurve3:tu,CubicBezierCurve:au,CubicBezierCurve3:ou,EllipseCurve:Kl,LineCurve:su,LineCurve3:lu,QuadraticBezierCurve:uu,QuadraticBezierCurve3:cu,SplineCurve:du});function fu(){Yl.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function pu(e){fu.call(this),this.type="Path",this.currentPoint=new zt,e&&this.setFromPoints(e)}function mu(e){pu.call(this,e),this.uuid=Vt.generateUUID(),this.type="Shape",this.holes=[]}function gu(e,t){vr.call(this),this.type="Light",this.color=new Gn(e),this.intensity=void 0!==t?t:1,this.receiveShadow=void 0}function vu(e,t,n){gu.call(this,e,n),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(vr.DefaultUp),this.updateMatrix(),this.groundColor=new Gn(t)}function yu(e){this.camera=e,this.bias=0,this.radius=1,this.mapSize=new zt(512,512),this.map=null,this.matrix=new Wt}function _u(){yu.call(this,new Ko(50,1,.5,500))}function bu(e,t,n,r,i,a){gu.call(this,e,t),this.type="SpotLight",this.position.copy(vr.DefaultUp),this.updateMatrix(),this.target=new vr,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}}),this.distance=void 0!==n?n:0,this.angle=void 0!==r?r:Math.PI/3,this.penumbra=void 0!==i?i:0,this.decay=void 0!==a?a:1,this.shadow=new _u}function Eu(e,t,n,r){gu.call(this,e,t),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}}),this.distance=void 0!==n?n:0,this.decay=void 0!==r?r:1,this.shadow=new yu(new Ko(90,1,.5,500))}function Tu(){yu.call(this,new _r(-5,5,5,-5,.5,500))}function Au(e,t){gu.call(this,e,t),this.type="DirectionalLight",this.position.copy(vr.DefaultUp),this.updateMatrix(),this.target=new vr,this.shadow=new Tu}function wu(e,t){gu.call(this,e,t),this.type="AmbientLight",this.castShadow=void 0}function Su(e,t,n,r){gu.call(this,e,t),this.type="RectAreaLight",this.width=void 0!==n?n:10,this.height=void 0!==r?r:10}function Cu(e,t,n,r){Bu.call(this,e,t,n,r)}function xu(e,t,n){Bu.call(this,e,t,n)}function Mu(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n}function Ru(e,t,n,r){Mu.call(this,e,t,n,r)}function Iu(e,t,n,r){Bu.call(this,e,t,n,r)}function Pu(e,t,n,r){Bu.call(this,e,t,n,r)}function Du(e,t,n,r){Bu.call(this,e,t,n,r)}function Lu(e,t,n,r){Mu.call(this,e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function Ou(e,t,n,r){Mu.call(this,e,t,n,r)}function Nu(e,t,n,r){Mu.call(this,e,t,n,r)}fu.prototype=Object.assign(Object.create(Yl.prototype),{constructor:fu,add:function(e){this.curves.push(e)},closePath:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new su(t,e))},getPoint:function(e){for(var t=e*this.getLength(),n=this.getCurveLengths(),r=0;r<n.length;){if(n[r]>=t){var i=n[r]-t,a=this.curves[r],o=a.getLength(),s=0===o?0:1-i/o;return a.getPointAt(s)}r++}return null},getLength:function(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e},getSpacedPoints:function(e){void 0===e&&(e=40);for(var t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t},getPoints:function(e){e=e||12;for(var t,n=[],r=0,i=this.curves;r<i.length;r++)for(var a=i[r],o=a&&a.isEllipseCurve?2*e:a&&a.isLineCurve?1:a&&a.isSplineCurve?e*a.points.length:e,s=a.getPoints(o),l=0;l<s.length;l++){var u=s[l];t&&t.equals(u)||(n.push(u),t=u)}return this.autoClose&&1<n.length&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},copy:function(e){Yl.prototype.copy.call(this,e),this.curves=[];for(var t=0,n=e.curves.length;t<n;t++){var r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this},toJSON:function(){var e=Yl.prototype.toJSON.call(this);e.autoClose=this.autoClose,e.curves=[];for(var t=0,n=this.curves.length;t<n;t++){var r=this.curves[t];e.curves.push(r.toJSON())}return e},fromJSON:function(e){Yl.prototype.fromJSON.call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var t=0,n=e.curves.length;t<n;t++){var r=e.curves[t];this.curves.push((new hu[r.type]).fromJSON(r))}return this}}),pu.prototype=Object.assign(Object.create(fu.prototype),{constructor:pu,setFromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y)},moveTo:function(e,t){this.currentPoint.set(e,t)},lineTo:function(e,t){var n=new su(this.currentPoint.clone(),new zt(e,t));this.curves.push(n),this.currentPoint.set(e,t)},quadraticCurveTo:function(e,t,n,r){var i=new uu(this.currentPoint.clone(),new zt(e,t),new zt(n,r));this.curves.push(i),this.currentPoint.set(n,r)},bezierCurveTo:function(e,t,n,r,i,a){var o=new au(this.currentPoint.clone(),new zt(e,t),new zt(n,r),new zt(i,a));this.curves.push(o),this.currentPoint.set(i,a)},splineThru:function(e){var t=new du([this.currentPoint.clone()].concat(e));this.curves.push(t),this.currentPoint.copy(e[e.length-1])},arc:function(e,t,n,r,i,a){var o=this.currentPoint.x,s=this.currentPoint.y;this.absarc(e+o,t+s,n,r,i,a)},absarc:function(e,t,n,r,i,a){this.absellipse(e,t,n,n,r,i,a)},ellipse:function(e,t,n,r,i,a,o,s){var l=this.currentPoint.x,u=this.currentPoint.y;this.absellipse(e+l,t+u,n,r,i,a,o,s)},absellipse:function(e,t,n,r,i,a,o,s){var l=new Kl(e,t,n,r,i,a,o,s);if(0<this.curves.length){var u=l.getPoint(0);u.equals(this.currentPoint)||this.lineTo(u.x,u.y)}this.curves.push(l);var c=l.getPoint(1);this.currentPoint.copy(c)},copy:function(e){return fu.prototype.copy.call(this,e),this.currentPoint.copy(e.currentPoint),this},toJSON:function(){var e=fu.prototype.toJSON.call(this);return e.currentPoint=this.currentPoint.toArray(),e},fromJSON:function(e){return fu.prototype.fromJSON.call(this,e),this.currentPoint.fromArray(e.currentPoint),this}}),mu.prototype=Object.assign(Object.create(pu.prototype),{constructor:mu,getPointsHoles:function(e){for(var t=[],n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t},extractPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},copy:function(e){pu.prototype.copy.call(this,e),this.holes=[];for(var t=0,n=e.holes.length;t<n;t++){var r=e.holes[t];this.holes.push(r.clone())}return this},toJSON:function(){var e=pu.prototype.toJSON.call(this);e.uuid=this.uuid,e.holes=[];for(var t=0,n=this.holes.length;t<n;t++){var r=this.holes[t];e.holes.push(r.toJSON())}return e},fromJSON:function(e){pu.prototype.fromJSON.call(this,e),this.uuid=e.uuid,this.holes=[];for(var t=0,n=e.holes.length;t<n;t++){var r=e.holes[t];this.holes.push((new pu).fromJSON(r))}return this}}),gu.prototype=Object.assign(Object.create(vr.prototype),{constructor:gu,isLight:!0,copy:function(e){return vr.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){var t=vr.prototype.toJSON.call(this,e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}),vu.prototype=Object.assign(Object.create(gu.prototype),{constructor:vu,isHemisphereLight:!0,copy:function(e){return gu.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}),Object.assign(yu.prototype,{copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e={};return 0!==this.bias&&(e.bias=this.bias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}),_u.prototype=Object.assign(Object.create(yu.prototype),{constructor:_u,isSpotLightShadow:!0,update:function(e){var t=this.camera,n=2*Vt.RAD2DEG*e.angle,r=this.mapSize.width/this.mapSize.height,i=e.distance||t.far;n===t.fov&&r===t.aspect&&i===t.far||(t.fov=n,t.aspect=r,t.far=i,t.updateProjectionMatrix())}}),bu.prototype=Object.assign(Object.create(gu.prototype),{constructor:bu,isSpotLight:!0,copy:function(e){return gu.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),Eu.prototype=Object.assign(Object.create(gu.prototype),{constructor:Eu,isPointLight:!0,copy:function(e){return gu.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}),Tu.prototype=Object.assign(Object.create(yu.prototype),{constructor:Tu}),Au.prototype=Object.assign(Object.create(gu.prototype),{constructor:Au,isDirectionalLight:!0,copy:function(e){return gu.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),wu.prototype=Object.assign(Object.create(gu.prototype),{constructor:wu,isAmbientLight:!0}),Su.prototype=Object.assign(Object.create(gu.prototype),{constructor:Su,isRectAreaLight:!0,copy:function(e){return gu.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){var t=gu.prototype.toJSON.call(this,e);return t.object.width=this.width,t.object.height=this.height,t}}),Cu.prototype=Object.assign(Object.create(Bu.prototype),{constructor:Cu,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),xu.prototype=Object.assign(Object.create(Bu.prototype),{constructor:xu,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Object.assign(Mu.prototype,{evaluate:function(e){var t=this.parameterPositions,n=this._cachedIndex,r=t[n],i=t[n-1];e:{t:{var a;n:{r:if(!(e<r)){for(var o=n+2;;){if(void 0===r){if(e<i)break r;return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,e,i)}if(n===o)break;if(i=r,e<(r=t[++n]))break t}a=t.length;break n}if(i<=e)break e;var s=t[1];e<s&&(n=2,i=s);for(o=n-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,e,r);if(n===o)break;if(r=i,(i=t[--n-1])<=e)break t}a=n,n=0}for(;n<a;){var l=n+a>>>1;e<t[l]?a=l:n=1+l}if(r=t[n],void 0===(i=t[n-1]))return this._cachedIndex=0,this.beforeStart_(0,e,r);if(void 0===r)return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,i,e)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,e,r)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){for(var t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r,a=0;a!==r;++a)t[a]=n[i+a];return t},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(Mu.prototype,{beforeStart_:Mu.prototype.copySampleValue_,afterEnd_:Mu.prototype.copySampleValue_}),Ru.prototype=Object.assign(Object.create(Mu.prototype),{constructor:Ru,interpolate_:function(e,t,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,l=(n-t)/(r-t),u=s+o;s!==u;s+=4)qt.slerpFlat(i,0,a,s-o,a,s,l);return i}}),Iu.prototype=Object.assign(Object.create(Bu.prototype),{constructor:Iu,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(e){return new Ru(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0}),Pu.prototype=Object.assign(Object.create(Bu.prototype),{constructor:Pu,ValueTypeName:"color"}),Du.prototype=Object.assign(Object.create(Bu.prototype),{constructor:Du,ValueTypeName:"number"}),Lu.prototype=Object.assign(Object.create(Mu.prototype),{constructor:Lu,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(e,t,n){var r=this.parameterPositions,i=e-2,a=e+1,o=r[i],s=r[a];if(void 0===o)switch(this.getSettings_().endingStart){case 2401:i=e,o=2*t-n;break;case 2402:o=t+r[i=r.length-2]-r[i+1];break;default:i=e,o=n}if(void 0===s)switch(this.getSettings_().endingEnd){case 2401:a=e,s=2*n-t;break;case 2402:s=n+r[a=1]-r[0];break;default:a=e-1,s=t}var l=.5*(n-t),u=this.valueSize;this._weightPrev=l/(t-o),this._weightNext=l/(s-n),this._offsetPrev=i*u,this._offsetNext=a*u},interpolate_:function(e,t,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,l=s-o,u=this._offsetPrev,c=this._offsetNext,d=this._weightPrev,h=this._weightNext,f=(n-t)/(r-t),p=f*f,m=p*f,g=-d*m+2*d*p-d*f,v=(1+d)*m+(-1.5-2*d)*p+(-.5+d)*f+1,y=(-1-h)*m+(1.5+h)*p+.5*f,_=h*m-h*p,b=0;b!==o;++b)i[b]=g*a[u+b]+v*a[l+b]+y*a[s+b]+_*a[c+b];return i}}),Ou.prototype=Object.assign(Object.create(Mu.prototype),{constructor:Ou,interpolate_:function(e,t,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,l=s-o,u=(n-t)/(r-t),c=1-u,d=0;d!==o;++d)i[d]=a[l+d]*c+a[s+d]*u;return i}}),Nu.prototype=Object.assign(Object.create(Mu.prototype),{constructor:Nu,interpolate_:function(e){return this.copySampleValue_(e-1)}});var ku={arraySlice:function(e,t,n){return ku.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==n?n:e.length)):e.slice(t,n)},convertArray:function(e,t,n){return!e||!n&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(n){for(var e=n.length,t=new Array(e),r=0;r!==e;++r)t[r]=r;return t.sort(function(e,t){return n[e]-n[t]}),t},sortedArray:function(e,t,n){for(var r=e.length,i=new e.constructor(r),a=0,o=0;o!==r;++a)for(var s=n[a]*t,l=0;l!==t;++l)i[o++]=e[s+l];return i},flattenJSON:function(e,t,n,r){for(var i=1,a=e[0];void 0!==a&&void 0===a[r];)a=e[i++];if(void 0!==a){var o=a[r];if(void 0!==o)if(Array.isArray(o))for(;void 0!==(o=a[r])&&(t.push(a.time),n.push.apply(n,o)),void 0!==(a=e[i++]););else if(void 0!==o.toArray)for(;void 0!==(o=a[r])&&(t.push(a.time),o.toArray(n,n.length)),void 0!==(a=e[i++]););else for(;void 0!==(o=a[r])&&(t.push(a.time),n.push(o)),void 0!==(a=e[i++]););}}};function Bu(e,t,n,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=ku.convertArray(t,this.TimeBufferType),this.values=ku.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation),this.validate(),this.optimize()}function Fu(e,t,n,r){Bu.call(this,e,t,n,r)}function ju(e,t,n){this.name=e,this.tracks=n,this.duration=void 0!==t?t:-1,this.uuid=Vt.generateUUID(),this.duration<0&&this.resetDuration(),this.optimize()}function Uu(e){this.manager=void 0!==e?e:Gl,this.textures={}}function Hu(e){this.manager=void 0!==e?e:Gl}Object.assign(Bu,{parse:function(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var t=Bu._getTrackTypeForValueTypeName(e.type);if(void 0===e.times){var n=[],r=[];ku.flattenJSON(e.keys,n,r,"value"),e.times=n,e.values=r}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)},toJSON:function(e){var t,n=e.constructor;if(void 0!==n.toJSON)t=n.toJSON(e);else{t={name:e.name,times:ku.convertArray(e.times,Array),values:ku.convertArray(e.values,Array)};var r=e.getInterpolation();r!==e.DefaultInterpolation&&(t.interpolation=r)}return t.type=e.ValueTypeName,t},_getTrackTypeForValueTypeName:function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Du;case"vector":case"vector2":case"vector3":case"vector4":return Fu;case"color":return Pu;case"quaternion":return Iu;case"bool":case"boolean":return xu;case"string":return Cu}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}}),Object.assign(Bu.prototype,{constructor:Bu,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(e){return new Nu(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new Ou(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new Lu(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){var t;switch(e){case 2300:t=this.InterpolantFactoryMethodDiscrete;break;case 2301:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0!==t)this.createInterpolant=t;else{var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}console.warn("THREE.KeyframeTrack:",n)}},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(0!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]+=e;return this},scale:function(e){if(1!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]*=e;return this},trim:function(e,t){for(var n=this.times,r=n.length,i=0,a=r-1;i!==r&&n[i]<e;)++i;for(;-1!==a&&n[a]>t;)--a;if(++a,0!==i||a!==r){a<=i&&(i=(a=Math.max(a,1))-1);var o=this.getValueSize();this.times=ku.arraySlice(n,i,a),this.values=ku.arraySlice(this.values,i*o,a*o)}return this},validate:function(){var e=!0,t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);var n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);for(var a=null,o=0;o!==i;o++){var s=n[o];if("number"==typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,s),e=!1;break}if(null!==a&&s<a){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,s,a),e=!1;break}a=s}if(void 0!==r&&ku.isTypedArray(r)){o=0;for(var l=r.length;o!==l;++o){var u=r[o];if(isNaN(u)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,u),e=!1;break}}}return e},optimize:function(){for(var e=this.times,t=this.values,n=this.getValueSize(),r=2302===this.getInterpolation(),i=1,a=e.length-1,o=1;o<a;++o){var s=!1,l=e[o];if(l!==e[o+1]&&(1!==o||l!==l[0]))if(r)s=!0;else for(var u=o*n,c=u-n,d=u+n,h=0;h!==n;++h){var f=t[u+h];if(f!==t[c+h]||f!==t[d+h]){s=!0;break}}if(s){if(o!==i){e[i]=e[o];var p=o*n,m=i*n;for(h=0;h!==n;++h)t[m+h]=t[p+h]}++i}}if(0<a){e[i]=e[a];for(p=a*n,m=i*n,h=0;h!==n;++h)t[m+h]=t[p+h];++i}return i!==e.length&&(this.times=ku.arraySlice(e,0,i),this.values=ku.arraySlice(t,0,i*n)),this}}),Fu.prototype=Object.assign(Object.create(Bu.prototype),{constructor:Fu,ValueTypeName:"vector"}),Object.assign(ju,{parse:function(e){for(var t=[],n=e.tracks,r=1/(e.fps||1),i=0,a=n.length;i!==a;++i)t.push(Bu.parse(n[i]).scale(r));return new ju(e.name,e.duration,t)},toJSON:function(e){for(var t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid},i=0,a=n.length;i!==a;++i)t.push(Bu.toJSON(n[i]));return r},CreateFromMorphTargetSequence:function(e,t,n,r){for(var i=t.length,a=[],o=0;o<i;o++){var s=[],l=[];s.push((o+i-1)%i,o,(o+1)%i),l.push(0,1,0);var u=ku.getKeyframeOrder(s);s=ku.sortedArray(s,1,u),l=ku.sortedArray(l,1,u),r||0!==s[0]||(s.push(i),l.push(l[0])),a.push(new Du(".morphTargetInfluences["+t[o].name+"]",s,l).scale(1/n))}return new ju(e,-1,a)},findByName:function(e,t){var n=e;if(!Array.isArray(e)){var r=e;n=r.geometry&&r.geometry.animations||r.animations}for(var i=0;i<n.length;i++)if(n[i].name===t)return n[i];return null},CreateClipsFromMorphTargetSequences:function(e,t,n){for(var r={},i=/^([\w-]*?)([\d]+)$/,a=0,o=e.length;a<o;a++){var s=e[a],l=s.name.match(i);if(l&&1<l.length){var u=r[d=l[1]];u||(r[d]=u=[]),u.push(s)}}var c=[];for(var d in r)c.push(ju.CreateFromMorphTargetSequence(d,r[d],t,n));return c},parseAnimation:function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(e,t,n,r,i){if(0!==n.length){var a=[],o=[];ku.flattenJSON(n,a,o,r),0!==a.length&&i.push(new e(t,a,o))}},r=[],i=e.name||"default",a=e.length||-1,o=e.fps||30,s=e.hierarchy||[],l=0;l<s.length;l++){var u=s[l].keys;if(u&&0!==u.length)if(u[0].morphTargets){for(var c={},d=0;d<u.length;d++)if(u[d].morphTargets)for(var h=0;h<u[d].morphTargets.length;h++)c[u[d].morphTargets[h]]=-1;for(var f in c){var p=[],m=[];for(h=0;h!==u[d].morphTargets.length;++h){var g=u[d];p.push(g.time),m.push(g.morphTarget===f?1:0)}r.push(new Du(".morphTargetInfluence["+f+"]",p,m))}a=c.length*(o||1)}else{var v=".bones["+t[l].name+"]";n(Fu,v+".position",u,"pos",r),n(Iu,v+".quaternion",u,"rot",r),n(Fu,v+".scale",u,"scl",r)}}return 0===r.length?null:new ju(i,a,r)}}),Object.assign(ju.prototype,{resetDuration:function(){for(var e=0,t=0,n=this.tracks.length;t!==n;++t){var r=this.tracks[t];e=Math.max(e,r.times[r.times.length-1])}this.duration=e},trim:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},optimize:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}}),Object.assign(Uu.prototype,{load:function(e,t,n,r){var i=this;new zl(i.manager).load(e,function(e){t(i.parse(JSON.parse(e)))},n,r)},setTextures:function(e){this.textures=e},parse:function(e){var t=this.textures;function n(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}var r=new jl[e.type];if(void 0!==e.uuid&&(r.uuid=e.uuid),void 0!==e.name&&(r.name=e.name),void 0!==e.color&&r.color.setHex(e.color),void 0!==e.roughness&&(r.roughness=e.roughness),void 0!==e.metalness&&(r.metalness=e.metalness),void 0!==e.emissive&&r.emissive.setHex(e.emissive),void 0!==e.specular&&r.specular.setHex(e.specular),void 0!==e.shininess&&(r.shininess=e.shininess),void 0!==e.clearCoat&&(r.clearCoat=e.clearCoat),void 0!==e.clearCoatRoughness&&(r.clearCoatRoughness=e.clearCoatRoughness),void 0!==e.uniforms&&(r.uniforms=e.uniforms),void 0!==e.vertexShader&&(r.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(r.fragmentShader=e.fragmentShader),void 0!==e.vertexColors&&(r.vertexColors=e.vertexColors),void 0!==e.fog&&(r.fog=e.fog),void 0!==e.flatShading&&(r.flatShading=e.flatShading),void 0!==e.blending&&(r.blending=e.blending),void 0!==e.side&&(r.side=e.side),void 0!==e.opacity&&(r.opacity=e.opacity),void 0!==e.transparent&&(r.transparent=e.transparent),void 0!==e.alphaTest&&(r.alphaTest=e.alphaTest),void 0!==e.depthTest&&(r.depthTest=e.depthTest),void 0!==e.depthWrite&&(r.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(r.colorWrite=e.colorWrite),void 0!==e.wireframe&&(r.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(r.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(r.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(r.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(r.rotation=e.rotation),1!==e.linewidth&&(r.linewidth=e.linewidth),void 0!==e.dashSize&&(r.dashSize=e.dashSize),void 0!==e.gapSize&&(r.gapSize=e.gapSize),void 0!==e.scale&&(r.scale=e.scale),void 0!==e.polygonOffset&&(r.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(r.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(r.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.skinning&&(r.skinning=e.skinning),void 0!==e.morphTargets&&(r.morphTargets=e.morphTargets),void 0!==e.dithering&&(r.dithering=e.dithering),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.shading&&(r.flatShading=1===e.shading),void 0!==e.size&&(r.size=e.size),void 0!==e.sizeAttenuation&&(r.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(r.map=n(e.map)),void 0!==e.alphaMap&&(r.alphaMap=n(e.alphaMap),r.transparent=!0),void 0!==e.bumpMap&&(r.bumpMap=n(e.bumpMap)),void 0!==e.bumpScale&&(r.bumpScale=e.bumpScale),void 0!==e.normalMap&&(r.normalMap=n(e.normalMap)),void 0!==e.normalScale){var i=e.normalScale;!1===Array.isArray(i)&&(i=[i,i]),r.normalScale=(new zt).fromArray(i)}return void 0!==e.displacementMap&&(r.displacementMap=n(e.displacementMap)),void 0!==e.displacementScale&&(r.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(r.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(r.roughnessMap=n(e.roughnessMap)),void 0!==e.metalnessMap&&(r.metalnessMap=n(e.metalnessMap)),void 0!==e.emissiveMap&&(r.emissiveMap=n(e.emissiveMap)),void 0!==e.emissiveIntensity&&(r.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(r.specularMap=n(e.specularMap)),void 0!==e.envMap&&(r.envMap=n(e.envMap)),void 0!==e.reflectivity&&(r.reflectivity=e.reflectivity),void 0!==e.lightMap&&(r.lightMap=n(e.lightMap)),void 0!==e.lightMapIntensity&&(r.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(r.aoMap=n(e.aoMap)),void 0!==e.aoMapIntensity&&(r.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(r.gradientMap=n(e.gradientMap)),r}}),Object.assign(Hu.prototype,{load:function(e,t,n,r){var i=this;new zl(i.manager).load(e,function(e){t(i.parse(JSON.parse(e)))},n,r)},parse:function(e){var t=new $r,n=e.data.index;if(void 0!==n){var r=new qu[n.type](n.array);t.setIndex(new Ir(r,1))}var i=e.data.attributes;for(var a in i){var o=i[a];r=new qu[o.type](o.array);t.addAttribute(a,new Ir(r,o.itemSize,o.normalized))}var s=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==s)for(var l=0,u=s.length;l!==u;++l){var c=s[l];t.addGroup(c.start,c.count,c.materialIndex)}var d=e.data.boundingSphere;if(void 0!==d){var h=new Yt;void 0!==d.center&&h.fromArray(d.center),t.boundingSphere=new Nn(h,d.radius)}return t}});var Gu,Vu,zu,Wu,qu={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function Yu(){}Yu.Handlers={handlers:[],add:function(e,t){this.handlers.push(e,t)},get:function(e){for(var t=this.handlers,n=0,r=t.length;n<r;n+=2){var i=t[n],a=t[n+1];if(i.test(e))return a}return null}},Object.assign(Yu.prototype,{crossOrigin:void 0,onLoadStart:function(){},onLoadProgress:function(){},onLoadComplete:function(){},initMaterials:function(e,t,n){for(var r=[],i=0;i<e.length;++i)r[i]=this.createMaterial(e[i],t,n);return r},createMaterial:(Gu={NoBlending:Z,NormalBlending:J,AdditiveBlending:$,SubtractiveBlending:ee,MultiplyBlending:te,CustomBlending:ne},Vu=new Gn,zu=new ql,Wu=new Uu,function(e,u,c){var d={};function t(e,t,n,r,i){var a,o=u+e,s=Yu.Handlers.get(o);a=null!==s?s.load(o):(zu.setCrossOrigin(c),zu.load(o)),void 0!==t&&(a.repeat.fromArray(t),1!==t[0]&&(a.wrapS=ke),1!==t[1]&&(a.wrapT=ke)),void 0!==n&&a.offset.fromArray(n),void 0!==r&&("repeat"===r[0]&&(a.wrapS=ke),"mirror"===r[0]&&(a.wrapS=Fe),"repeat"===r[1]&&(a.wrapT=ke),"mirror"===r[1]&&(a.wrapT=Fe)),void 0!==i&&(a.anisotropy=i);var l=Vt.generateUUID();return d[l]=a,l}var n={uuid:Vt.generateUUID(),type:"MeshLambertMaterial"};for(var r in e){var i=e[r];switch(r){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":n.name=i;break;case"blending":n.blending=Gu[i];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",r,"is no longer supported.");break;case"colorDiffuse":n.color=Vu.fromArray(i).getHex();break;case"colorSpecular":n.specular=Vu.fromArray(i).getHex();break;case"colorEmissive":n.emissive=Vu.fromArray(i).getHex();break;case"specularCoef":n.shininess=i;break;case"shading":"basic"===i.toLowerCase()&&(n.type="MeshBasicMaterial"),"phong"===i.toLowerCase()&&(n.type="MeshPhongMaterial"),"standard"===i.toLowerCase()&&(n.type="MeshStandardMaterial");break;case"mapDiffuse":n.map=t(i,e.mapDiffuseRepeat,e.mapDiffuseOffset,e.mapDiffuseWrap,e.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":n.emissiveMap=t(i,e.mapEmissiveRepeat,e.mapEmissiveOffset,e.mapEmissiveWrap,e.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":n.lightMap=t(i,e.mapLightRepeat,e.mapLightOffset,e.mapLightWrap,e.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":n.aoMap=t(i,e.mapAORepeat,e.mapAOOffset,e.mapAOWrap,e.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":n.bumpMap=t(i,e.mapBumpRepeat,e.mapBumpOffset,e.mapBumpWrap,e.mapBumpAnisotropy);break;case"mapBumpScale":n.bumpScale=i;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":n.normalMap=t(i,e.mapNormalRepeat,e.mapNormalOffset,e.mapNormalWrap,e.mapNormalAnisotropy);break;case"mapNormalFactor":n.normalScale=i;break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":n.specularMap=t(i,e.mapSpecularRepeat,e.mapSpecularOffset,e.mapSpecularWrap,e.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":n.metalnessMap=t(i,e.mapMetalnessRepeat,e.mapMetalnessOffset,e.mapMetalnessWrap,e.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":n.roughnessMap=t(i,e.mapRoughnessRepeat,e.mapRoughnessOffset,e.mapRoughnessWrap,e.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":n.alphaMap=t(i,e.mapAlphaRepeat,e.mapAlphaOffset,e.mapAlphaWrap,e.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":n.side=Ae;break;case"doubleSided":n.side=Q;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),n.opacity=i;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":n[r]=i;break;case"vertexColors":!0===i&&(n.vertexColors=2),"face"===i&&(n.vertexColors=1);break;default:console.error("THREE.Loader.createMaterial: Unsupported",r,i)}}return"MeshBasicMaterial"===n.type&&delete n.emissive,"MeshPhongMaterial"!==n.type&&delete n.specular,n.opacity<1&&(n.transparent=!0),Wu.setTextures(d),Wu.parse(n)})});var Ku=function(e){var t=e.lastIndexOf("/");return-1===t?"./":e.substr(0,t+1)};function Xu(e){"boolean"==typeof e&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),e=void 0),this.manager=void 0!==e?e:Gl,this.withCredentials=!1}Object.assign(Xu.prototype,{load:function(a,o,e,t){var s=this,l=this.texturePath&&"string"==typeof this.texturePath?this.texturePath:Ku(a),n=new zl(this.manager);n.setWithCredentials(this.withCredentials),n.load(a,function(e){var t=JSON.parse(e),n=t.metadata;if(void 0!==n){var r=n.type;if(void 0!==r&&"object"===r.toLowerCase())return void console.error("THREE.JSONLoader: "+a+" should be loaded with THREE.ObjectLoader instead.")}var i=s.parse(t,l);o(i.geometry,i.materials)},e,t)},setTexturePath:function(e){this.texturePath=e},parse:function(e,t){void 0!==e.data&&(e=e.data),void 0!==e.scale?e.scale=1/e.scale:e.scale=1;var n=new Rr;return function(e,t){function n(e,t){return e&1<<t}var r,i,a,o,s,l,u,c,d,h,f,p,m,g,v,y,_,b,E,T,A,w,S,C,x,M=e.faces,R=e.vertices,I=e.normals,P=e.colors,D=e.scale,L=0;if(void 0!==e.uvs){for(r=0;r<e.uvs.length;r++)e.uvs[r].length&&L++;for(r=0;r<L;r++)t.faceVertexUvs[r]=[]}for(o=0,s=R.length;o<s;)(b=new Yt).x=R[o++]*D,b.y=R[o++]*D,b.z=R[o++]*D,t.vertices.push(b);for(o=0,s=M.length;o<s;)if(f=n(h=M[o++],0),p=n(h,1),m=n(h,3),g=n(h,4),v=n(h,5),y=n(h,6),_=n(h,7),f){if((T=new br).a=M[o],T.b=M[o+1],T.c=M[o+3],(A=new br).a=M[o+1],A.b=M[o+2],A.c=M[o+3],o+=4,p&&(d=M[o++],T.materialIndex=d,A.materialIndex=d),a=t.faces.length,m)for(r=0;r<L;r++)for(C=e.uvs[r],t.faceVertexUvs[r][a]=[],t.faceVertexUvs[r][a+1]=[],i=0;i<4;i++)x=new zt(C[2*(c=M[o++])],C[2*c+1]),2!==i&&t.faceVertexUvs[r][a].push(x),0!==i&&t.faceVertexUvs[r][a+1].push(x);if(g&&(u=3*M[o++],T.normal.set(I[u++],I[u++],I[u]),A.normal.copy(T.normal)),v)for(r=0;r<4;r++)u=3*M[o++],S=new Yt(I[u++],I[u++],I[u]),2!==r&&T.vertexNormals.push(S),0!==r&&A.vertexNormals.push(S);if(y&&(w=P[l=M[o++]],T.color.setHex(w),A.color.setHex(w)),_)for(r=0;r<4;r++)w=P[l=M[o++]],2!==r&&T.vertexColors.push(new Gn(w)),0!==r&&A.vertexColors.push(new Gn(w));t.faces.push(T),t.faces.push(A)}else{if((E=new br).a=M[o++],E.b=M[o++],E.c=M[o++],p&&(d=M[o++],E.materialIndex=d),a=t.faces.length,m)for(r=0;r<L;r++)for(C=e.uvs[r],t.faceVertexUvs[r][a]=[],i=0;i<3;i++)x=new zt(C[2*(c=M[o++])],C[2*c+1]),t.faceVertexUvs[r][a].push(x);if(g&&(u=3*M[o++],E.normal.set(I[u++],I[u++],I[u])),v)for(r=0;r<3;r++)u=3*M[o++],S=new Yt(I[u++],I[u++],I[u]),E.vertexNormals.push(S);if(y&&(l=M[o++],E.color.setHex(P[l])),_)for(r=0;r<3;r++)l=M[o++],E.vertexColors.push(new Gn(P[l]));t.faces.push(E)}}(e,n),function(e,t){var n=void 0!==e.influencesPerVertex?e.influencesPerVertex:2;if(e.skinWeights)for(var r=0,i=e.skinWeights.length;r<i;r+=n){var a=e.skinWeights[r],o=1<n?e.skinWeights[r+1]:0,s=2<n?e.skinWeights[r+2]:0,l=3<n?e.skinWeights[r+3]:0;t.skinWeights.push(new Mn(a,o,s,l))}if(e.skinIndices)for(r=0,i=e.skinIndices.length;r<i;r+=n){var u=e.skinIndices[r],c=1<n?e.skinIndices[r+1]:0,d=2<n?e.skinIndices[r+2]:0,h=3<n?e.skinIndices[r+3]:0;t.skinIndices.push(new Mn(u,c,d,h))}t.bones=e.bones,t.bones&&0<t.bones.length&&(t.skinWeights.length!==t.skinIndices.length||t.skinIndices.length!==t.vertices.length)&&console.warn("When skinning, number of vertices ("+t.vertices.length+"), skinIndices ("+t.skinIndices.length+"), and skinWeights ("+t.skinWeights.length+") should match.")}(e,n),function(e,t){var n=e.scale;if(void 0!==e.morphTargets)for(var r=0,i=e.morphTargets.length;r<i;r++){t.morphTargets[r]={},t.morphTargets[r].name=e.morphTargets[r].name,t.morphTargets[r].vertices=[];for(var a=t.morphTargets[r].vertices,o=e.morphTargets[r].vertices,s=0,l=o.length;s<l;s+=3){var u=new Yt;u.x=o[s]*n,u.y=o[s+1]*n,u.z=o[s+2]*n,a.push(u)}}if(void 0!==e.morphColors&&0<e.morphColors.length){console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.');var c=t.faces,d=e.morphColors[0].colors;for(r=0,i=c.length;r<i;r++)c[r].color.fromArray(d,3*r)}}(e,n),function(e,t){var n=[],r=[];void 0!==e.animation&&r.push(e.animation),void 0!==e.animations&&(e.animations.length?r=r.concat(e.animations):r.push(e.animations));for(var i=0;i<r.length;i++){var a=ju.parseAnimation(r[i],t.bones);a&&n.push(a)}if(t.morphTargets){var o=ju.CreateClipsFromMorphTargetSequences(t.morphTargets,10);n=n.concat(o)}0<n.length&&(t.animations=n)}(e,n),n.computeFaceNormals(),n.computeBoundingSphere(),void 0===e.materials||0===e.materials.length?{geometry:n}:{geometry:n,materials:Yu.prototype.initMaterials(e.materials,t,this.crossOrigin)}}}),Object.assign(function(e){this.manager=void 0!==e?e:Gl,this.texturePath=""}.prototype,{load:function(r,i,e,a){""===this.texturePath&&(this.texturePath=r.substring(0,r.lastIndexOf("/")+1));var o=this;new zl(o.manager).load(r,function(e){var t=null;try{t=JSON.parse(e)}catch(e){return void 0!==a&&a(e),void console.error("THREE:ObjectLoader: Can't parse "+r+".",e.message)}var n=t.metadata;void 0!==n&&void 0!==n.type&&"geometry"!==n.type.toLowerCase()?o.parse(t,i):console.error("THREE.ObjectLoader: Can't load "+r+". Use THREE.JSONLoader instead.")},e,a)},setTexturePath:function(e){return this.texturePath=e,this},setCrossOrigin:function(e){return this.crossOrigin=e,this},parse:function(e,t){var n=this.parseShape(e.shapes),r=this.parseGeometries(e.geometries,n),i=this.parseImages(e.images,function(){void 0!==t&&t(s)}),a=this.parseTextures(e.textures,i),o=this.parseMaterials(e.materials,a),s=this.parseObject(e.object,r,o);return e.animations&&(s.animations=this.parseAnimations(e.animations)),void 0!==e.images&&0!==e.images.length||void 0!==t&&t(s),s},parseShape:function(e){var t={};if(void 0!==e)for(var n=0,r=e.length;n<r;n++){var i=(new mu).fromJSON(e[n]);t[i.uuid]=i}return t},parseGeometries:function(e,t){var n={};if(void 0!==e)for(var r=new Xu,i=new Hu,a=0,o=e.length;a<o;a++){var s,l=e[a];switch(l.type){case"PlaneGeometry":case"PlaneBufferGeometry":s=new Rl[l.type](l.width,l.height,l.widthSegments,l.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":s=new Rl[l.type](l.width,l.height,l.depth,l.widthSegments,l.heightSegments,l.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":s=new Rl[l.type](l.radius,l.segments,l.thetaStart,l.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":s=new Rl[l.type](l.radiusTop,l.radiusBottom,l.height,l.radialSegments,l.heightSegments,l.openEnded,l.thetaStart,l.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":s=new Rl[l.type](l.radius,l.height,l.radialSegments,l.heightSegments,l.openEnded,l.thetaStart,l.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":s=new Rl[l.type](l.radius,l.widthSegments,l.heightSegments,l.phiStart,l.phiLength,l.thetaStart,l.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":s=new Rl[l.type](l.radius,l.detail);break;case"RingGeometry":case"RingBufferGeometry":s=new Rl[l.type](l.innerRadius,l.outerRadius,l.thetaSegments,l.phiSegments,l.thetaStart,l.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":s=new Rl[l.type](l.radius,l.tube,l.radialSegments,l.tubularSegments,l.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":s=new Rl[l.type](l.radius,l.tube,l.tubularSegments,l.radialSegments,l.p,l.q);break;case"LatheGeometry":case"LatheBufferGeometry":s=new Rl[l.type](l.points,l.segments,l.phiStart,l.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":s=new Rl[l.type](l.vertices,l.indices,l.radius,l.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":for(var u=[],c=0,d=l.shapes.length;c<d;c++){var h=t[l.shapes[c]];u.push(h)}s=new Rl[l.type](u,l.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":for(u=[],c=0,d=l.shapes.length;c<d;c++){h=t[l.shapes[c]];u.push(h)}var f=l.options.extrudePath;void 0!==f&&(l.options.extrudePath=(new hu[f.type]).fromJSON(f)),s=new Rl[l.type](u,l.options);break;case"BufferGeometry":s=i.parse(l);break;case"Geometry":s=r.parse(l,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+l.type+'"');continue}s.uuid=l.uuid,void 0!==l.name&&(s.name=l.name),!0===s.isBufferGeometry&&void 0!==l.userData&&(s.userData=l.userData),n[l.uuid]=s}return n},parseMaterials:function(e,t){var n={};if(void 0!==e){var r=new Uu;r.setTextures(t);for(var i=0,a=e.length;i<a;i++){var o=e[i];if("MultiMaterial"===o.type){for(var s=[],l=0;l<o.materials.length;l++)s.push(r.parse(o.materials[l]));n[o.uuid]=s}else n[o.uuid]=r.parse(o)}}return n},parseAnimations:function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n],i=ju.parse(r);void 0!==r.uuid&&(i.uuid=r.uuid),t.push(i)}return t},parseImages:function(e,t){var n=this,r={};function i(e){return n.manager.itemStart(e),a.load(e,function(){n.manager.itemEnd(e)},void 0,function(){n.manager.itemEnd(e),n.manager.itemError(e)})}if(void 0!==e&&0<e.length){var a=new Wl(new Hl(t));a.setCrossOrigin(this.crossOrigin);for(var o=0,s=e.length;o<s;o++){var l=e[o],u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(l.url)?l.url:n.texturePath+l.url;r[l.uuid]=i(u)}}return r},parseTextures:function(e,t){function n(e,t){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}var r={};if(void 0!==e)for(var i=0,a=e.length;i<a;i++){var o=e[i];void 0===o.image&&console.warn('THREE.ObjectLoader: No "image" specified for',o.uuid),void 0===t[o.image]&&console.warn("THREE.ObjectLoader: Undefined image",o.image);var s=new xn(t[o.image]);s.needsUpdate=!0,s.uuid=o.uuid,void 0!==o.name&&(s.name=o.name),void 0!==o.mapping&&(s.mapping=n(o.mapping,Zu)),void 0!==o.offset&&s.offset.fromArray(o.offset),void 0!==o.repeat&&s.repeat.fromArray(o.repeat),void 0!==o.center&&s.center.fromArray(o.center),void 0!==o.rotation&&(s.rotation=o.rotation),void 0!==o.wrap&&(s.wrapS=n(o.wrap[0],Ju),s.wrapT=n(o.wrap[1],Ju)),void 0!==o.format&&(s.format=o.format),void 0!==o.minFilter&&(s.minFilter=n(o.minFilter,$u)),void 0!==o.magFilter&&(s.magFilter=n(o.magFilter,$u)),void 0!==o.anisotropy&&(s.anisotropy=o.anisotropy),void 0!==o.flipY&&(s.flipY=o.flipY),r[o.uuid]=s}return r},parseObject:function(e,t,a){var n;function r(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function i(e){if(void 0!==e){if(Array.isArray(e)){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n];void 0===a[i]&&console.warn("THREE.ObjectLoader: Undefined material",i),t.push(a[i])}return t}return void 0===a[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),a[e]}}switch(e.type){case"Scene":n=new ts,void 0!==e.background&&Number.isInteger(e.background)&&(n.background=new Gn(e.background)),void 0!==e.fog&&("Fog"===e.fog.type?n.fog=new es(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(n.fog=new $o(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":n=new Ko(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(n.focus=e.focus),void 0!==e.zoom&&(n.zoom=e.zoom),void 0!==e.filmGauge&&(n.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(n.filmOffset=e.filmOffset),void 0!==e.view&&(n.view=Object.assign({},e.view));break;case"OrthographicCamera":n=new _r(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(n.zoom=e.zoom),void 0!==e.view&&(n.view=Object.assign({},e.view));break;case"AmbientLight":n=new wu(e.color,e.intensity);break;case"DirectionalLight":n=new Au(e.color,e.intensity);break;case"PointLight":n=new Eu(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":n=new Su(e.color,e.intensity,e.width,e.height);break;case"SpotLight":n=new bu(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":n=new vu(e.color,e.groundColor,e.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var o=r(e.geometry),s=i(e.material);n=o.bones&&0<o.bones.length?new ss(o,s):new Qi(o,s);break;case"LOD":n=new is;break;case"Line":n=new us(r(e.geometry),i(e.material),e.mode);break;case"LineLoop":n=new ds(r(e.geometry),i(e.material));break;case"LineSegments":n=new cs(r(e.geometry),i(e.material));break;case"PointCloud":case"Points":n=new fs(r(e.geometry),i(e.material));break;case"Sprite":n=new rs(i(e.material));break;case"Group":n=new ps;break;default:n=new vr}if(n.uuid=e.uuid,void 0!==e.name&&(n.name=e.name),void 0!==e.matrix?(n.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(n.matrixAutoUpdate=e.matrixAutoUpdate),n.matrixAutoUpdate&&n.matrix.decompose(n.position,n.quaternion,n.scale)):(void 0!==e.position&&n.position.fromArray(e.position),void 0!==e.rotation&&n.rotation.fromArray(e.rotation),void 0!==e.quaternion&&n.quaternion.fromArray(e.quaternion),void 0!==e.scale&&n.scale.fromArray(e.scale)),void 0!==e.castShadow&&(n.castShadow=e.castShadow),void 0!==e.receiveShadow&&(n.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(n.shadow.bias=e.shadow.bias),void 0!==e.shadow.radius&&(n.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&n.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(n.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(n.visible=e.visible),void 0!==e.frustumCulled&&(n.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(n.renderOrder=e.renderOrder),void 0!==e.userData&&(n.userData=e.userData),void 0!==e.children)for(var l=e.children,u=0;u<l.length;u++)n.add(this.parseObject(l[u],t,a));if("LOD"===e.type)for(var c=e.levels,d=0;d<c.length;d++){var h=c[d],f=n.getObjectByProperty("uuid",h.object);void 0!==f&&n.addLevel(f,h.distance)}return n}});var Qu,Zu={UVMapping:300,CubeReflectionMapping:Re,CubeRefractionMapping:Ie,EquirectangularReflectionMapping:Pe,EquirectangularRefractionMapping:De,SphericalReflectionMapping:Le,CubeUVReflectionMapping:Oe,CubeUVRefractionMapping:Ne},Ju={RepeatWrapping:ke,ClampToEdgeWrapping:Be,MirroredRepeatWrapping:Fe},$u={NearestFilter:je,NearestMipMapNearestFilter:Ue,NearestMipMapLinearFilter:He,LinearFilter:Ge,LinearMipMapNearestFilter:Ve,LinearMipMapLinearFilter:ze};function ec(){this.type="ShapePath",this.color=new Gn,this.subPaths=[],this.currentPath=null}function tc(e){this.type="Font",this.data=e}function nc(e,t,n,r,i,a){var o=a.glyphs[e]||a.glyphs["?"];if(o){var s,l,u,c,d,h,f,p,m=new ec;if(o.o)for(var g=o._cachedOutline||(o._cachedOutline=o.o.split(" ")),v=0,y=g.length;v<y;){switch(g[v++]){case"m":s=g[v++]*n+r,l=g[v++]*n+i,m.moveTo(s,l);break;case"l":s=g[v++]*n+r,l=g[v++]*n+i,m.lineTo(s,l);break;case"q":u=g[v++]*n+r,c=g[v++]*n+i,d=g[v++]*n+r,h=g[v++]*n+i,m.quadraticCurveTo(d,h,u,c);break;case"b":u=g[v++]*n+r,c=g[v++]*n+i,d=g[v++]*n+r,h=g[v++]*n+i,f=g[v++]*n+r,p=g[v++]*n+i,m.bezierCurveTo(d,h,f,p,u,c)}}return{offsetX:o.ha*n,path:m}}}Object.assign(ec.prototype,{moveTo:function(e,t){this.currentPath=new pu,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t)},lineTo:function(e,t){this.currentPath.lineTo(e,t)},quadraticCurveTo:function(e,t,n,r){this.currentPath.quadraticCurveTo(e,t,n,r)},bezierCurveTo:function(e,t,n,r,i,a){this.currentPath.bezierCurveTo(e,t,n,r,i,a)},splineThru:function(e){this.currentPath.splineThru(e)},toShapes:function(e,t){function n(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n],a=new mu;a.curves=i.curves,t.push(a)}return t}function r(e,t){for(var n=t.length,r=!1,i=n-1,a=0;a<n;i=a++){var o=t[i],s=t[a],l=s.x-o.x,u=s.y-o.y;if(Math.abs(u)>Number.EPSILON){if(u<0&&(o=t[a],l=-l,s=t[i],u=-u),e.y<o.y||e.y>s.y)continue;if(e.y===o.y){if(e.x===o.x)return!0}else{var c=u*(e.x-o.x)-l*(e.y-o.y);if(0==c)return!0;if(c<0)continue;r=!r}}else{if(e.y!==o.y)continue;if(s.x<=e.x&&e.x<=o.x||o.x<=e.x&&e.x<=s.x)return!0}}return r}var i=il.isClockWise,a=this.subPaths;if(0===a.length)return[];if(!0===t)return n(a);var o,s,l,u=[];if(1===a.length)return s=a[0],(l=new mu).curves=s.curves,u.push(l),u;var c=!i(a[0].getPoints());c=e?!c:c;var d,h,f=[],p=[],m=[],g=0;p[g]=void 0,m[g]=[];for(var v=0,y=a.length;v<y;v++)o=i(d=(s=a[v]).getPoints()),(o=e?!o:o)?(!c&&p[g]&&g++,p[g]={s:new mu,p:d},p[g].s.curves=s.curves,c&&g++,m[g]=[]):m[g].push({h:s,p:d[0]});if(!p[0])return n(a);if(1<p.length){for(var _=!1,b=[],E=0,T=p.length;E<T;E++)f[E]=[];for(E=0,T=p.length;E<T;E++)for(var A=m[E],w=0;w<A.length;w++){for(var S=A[w],C=!0,x=0;x<p.length;x++)r(S.p,p[x].p)&&(E!==x&&b.push({froms:E,tos:x,hole:w}),C?(C=!1,f[x].push(S)):_=!0);C&&f[E].push(S)}0<b.length&&(_||(m=f))}v=0;for(var M=p.length;v<M;v++){l=p[v].s,u.push(l);for(var R=0,I=(h=m[v]).length;R<I;R++)l.holes.push(h[R].h)}return u}}),Object.assign(tc.prototype,{isFont:!0,generateShapes:function(e,t,n){void 0===t&&(t=100),void 0===n&&(n=4);for(var r=[],i=function(e,t,n,r){for(var i=Array.from?Array.from(e):String(e).split(""),a=t/r.resolution,o=(r.boundingBox.yMax-r.boundingBox.yMin+r.underlineThickness)*a,s=[],l=0,u=0,c=0;c<i.length;c++){var d=i[c];if("\n"===d)l=0,u-=o;else{var h=nc(d,n,a,l,u,r);l+=h.offsetX,s.push(h.path)}}return s}(e,t,n,this.data),a=0,o=i.length;a<o;a++)Array.prototype.push.apply(r,i[a].toShapes());return r}}),Object.assign(function(e){this.manager=void 0!==e?e:Gl}.prototype,{load:function(e,r,t,n){var i=this,a=new zl(this.manager);a.setPath(this.path),a.load(e,function(t){var n;try{n=JSON.parse(t)}catch(e){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),n=JSON.parse(t.substring(65,t.length-2))}var e=i.parse(n);r&&r(e)},t,n)},parse:function(e){return new tc(e)},setPath:function(e){return this.path=e,this}});var rc,ic,ac,oc,sc,lc,uc,cc,dc,hc,fc,pc,mc,gc,vc,yc=function(){return void 0===Qu&&(Qu=new(window.AudioContext||window.webkitAudioContext)),Qu};function _c(e){this.manager=void 0!==e?e:Gl}function bc(e,t,n){vr.call(this),this.type="CubeCamera";var i=new Ko(90,1,e,t);i.up.set(0,-1,0),i.lookAt(new Yt(1,0,0)),this.add(i);var a=new Ko(90,1,e,t);a.up.set(0,-1,0),a.lookAt(new Yt(-1,0,0)),this.add(a);var o=new Ko(90,1,e,t);o.up.set(0,0,1),o.lookAt(new Yt(0,1,0)),this.add(o);var s=new Ko(90,1,e,t);s.up.set(0,0,-1),s.lookAt(new Yt(0,-1,0)),this.add(s);var l=new Ko(90,1,e,t);l.up.set(0,-1,0),l.lookAt(new Yt(0,0,1)),this.add(l);var u=new Ko(90,1,e,t);u.up.set(0,-1,0),u.lookAt(new Yt(0,0,-1)),this.add(u);var r={format:it,magFilter:Ge,minFilter:Ge};this.renderTarget=new In(n,n,r),this.renderTarget.texture.name="CubeCamera",this.update=function(e,t){null===this.parent&&this.updateMatrixWorld();var n=this.renderTarget,r=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,n.activeCubeFace=0,e.render(t,i,n),n.activeCubeFace=1,e.render(t,a,n),n.activeCubeFace=2,e.render(t,o,n),n.activeCubeFace=3,e.render(t,s,n),n.activeCubeFace=4,e.render(t,l,n),n.texture.generateMipmaps=r,n.activeCubeFace=5,e.render(t,u,n),e.setRenderTarget(null)},this.clear=function(e,t,n,r){for(var i=this.renderTarget,a=0;a<6;a++)i.activeCubeFace=a,e.setRenderTarget(i),e.clear(t,n,r);e.setRenderTarget(null)}}function Ec(){vr.call(this),this.type="AudioListener",this.context=yc(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null}function Tc(e){vr.call(this),this.type="Audio",this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.loop=!1,this.startTime=0,this.offset=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function Ac(e){Tc.call(this,e),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}function wc(e,t){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=void 0!==t?t:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}function Sc(e,t,n){this.binding=e,this.valueSize=n;var r,i=Float64Array;switch(t){case"quaternion":r=this._slerp;break;case"string":case"bool":i=Array,r=this._select;break;default:r=this._lerp}this.buffer=new i(4*n),this._mixBufferRegion=r,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}Object.assign(_c.prototype,{load:function(e,t,n,r){var i=new zl(this.manager);i.setResponseType("arraybuffer"),i.load(e,function(e){yc().decodeAudioData(e,function(e){t(e)})},n,r)}}),Object.assign(function(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Ko,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Ko,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}.prototype,{update:(dc=new Wt,hc=new Wt,function(e){if(rc!==this||ic!==e.focus||ac!==e.fov||oc!==e.aspect*this.aspect||sc!==e.near||lc!==e.far||uc!==e.zoom||cc!==this.eyeSep){rc=this,ic=e.focus,ac=e.fov,oc=e.aspect*this.aspect,sc=e.near,lc=e.far,uc=e.zoom;var t,n,r=e.projectionMatrix.clone(),i=(cc=this.eyeSep/2)*sc/ic,a=sc*Math.tan(Vt.DEG2RAD*ac*.5)/uc;hc.elements[12]=-cc,dc.elements[12]=cc,t=-a*oc+i,n=a*oc+i,r.elements[0]=2*sc/(n-t),r.elements[8]=(n+t)/(n-t),this.cameraL.projectionMatrix.copy(r),t=-a*oc-i,n=a*oc-i,r.elements[0]=2*sc/(n-t),r.elements[8]=(n+t)/(n-t),this.cameraR.projectionMatrix.copy(r)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(hc),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(dc)})}),(bc.prototype=Object.create(vr.prototype)).constructor=bc,Ec.prototype=Object.assign(Object.create(vr.prototype),{constructor:Ec,getInput:function(){return this.gain},removeFilter:function(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null)},getFilter:function(){return this.filter},setFilter:function(e){null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination)},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(e){this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01)},updateMatrixWorld:(fc=new Yt,pc=new qt,mc=new Yt,gc=new Yt,function(e){vr.prototype.updateMatrixWorld.call(this,e);var t=this.context.listener,n=this.up;this.matrixWorld.decompose(fc,pc,mc),gc.set(0,0,-1).applyQuaternion(pc),t.positionX?(t.positionX.setValueAtTime(fc.x,this.context.currentTime),t.positionY.setValueAtTime(fc.y,this.context.currentTime),t.positionZ.setValueAtTime(fc.z,this.context.currentTime),t.forwardX.setValueAtTime(gc.x,this.context.currentTime),t.forwardY.setValueAtTime(gc.y,this.context.currentTime),t.forwardZ.setValueAtTime(gc.z,this.context.currentTime),t.upX.setValueAtTime(n.x,this.context.currentTime),t.upY.setValueAtTime(n.y,this.context.currentTime),t.upZ.setValueAtTime(n.z,this.context.currentTime)):(t.setPosition(fc.x,fc.y,fc.z),t.setOrientation(gc.x,gc.y,gc.z,n.x,n.y,n.z))})}),Tc.prototype=Object.assign(Object.create(vr.prototype),{constructor:Tc,getOutput:function(){return this.gain},setNodeSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this},setMediaElementSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this},setBuffer:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){var e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.onended=this.onEnded.bind(this),e.playbackRate.setValueAtTime(this.playbackRate,this.startTime),this.startTime=this.context.currentTime,e.start(this.startTime,this.offset),this.isPlaying=!0,this.source=e,this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this.source.stop(),this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this.source.stop(),this.offset=0,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(e){return e=e||[],!0===this.isPlaying?(this.disconnect(),this.filters=e,this.connect()):this.filters=e,this},getFilter:function(){return this.getFilters()[0]},setFilter:function(e){return this.setFilters(e?[e]:[])},setPlaybackRate:function(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},getVolume:function(){return this.gain.gain.value},setVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}),Ac.prototype=Object.assign(Object.create(Tc.prototype),{constructor:Ac,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(e){this.panner.refDistance=e},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(e){this.panner.rolloffFactor=e},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(e){this.panner.distanceModel=e},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(e){this.panner.maxDistance=e},updateMatrixWorld:(vc=new Yt,function(e){vr.prototype.updateMatrixWorld.call(this,e),vc.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(vc.x,vc.y,vc.z)})}),Object.assign(wc.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var e=0,t=this.getFrequencyData(),n=0;n<t.length;n++)e+=t[n];return e/t.length}}),Object.assign(Sc.prototype,{accumulate:function(e,t){var n=this.buffer,r=this.valueSize,i=e*r+r,a=this.cumulativeWeight;if(0===a){for(var o=0;o!==r;++o)n[i+o]=n[o];a=t}else{var s=t/(a+=t);this._mixBufferRegion(n,i,0,s,r)}this.cumulativeWeight=a},apply:function(e){var t=this.valueSize,n=this.buffer,r=e*t+t,i=this.cumulativeWeight,a=this.binding;if(this.cumulativeWeight=0,i<1){var o=3*t;this._mixBufferRegion(n,r,o,1-i,t)}for(var s=t,l=t+t;s!==l;++s)if(n[s]!==n[s+t]){a.setValue(n,r);break}},saveOriginalState:function(){var e=this.binding,t=this.buffer,n=this.valueSize,r=3*n;e.getValue(t,r);for(var i=n,a=r;i!==a;++i)t[i]=t[r+i%n];this.cumulativeWeight=0},restoreOriginalState:function(){var e=3*this.valueSize;this.binding.setValue(this.buffer,e)},_select:function(e,t,n,r,i){if(.5<=r)for(var a=0;a!==i;++a)e[t+a]=e[n+a]},_slerp:function(e,t,n,r){qt.slerpFlat(e,t,e,t,e,n,r)},_lerp:function(e,t,n,r,i){for(var a=1-r,o=0;o!==i;++o){var s=t+o;e[s]=e[s]*a+e[n+o]*r}}});var Cc,xc,Mc,Rc,Ic,Pc,Dc,Lc,Oc,Nc,kc,Bc,Fc,jc,Uc,Hc,Gc,Vc,zc,Wc,qc,Yc,Kc,Xc,Qc,Zc,Jc,$c,ed,td,nd,rd,id,ad,od,sd,ld,ud,cd="\\[\\]\\.:\\/";function dd(e,t,n){var r=n||hd.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}function hd(e,t,n){this.path=t,this.parsedPath=n||hd.parseTrackName(t),this.node=hd.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}function fd(e,t,n){this._mixer=e,this._clip=t,this._localRoot=n||null;for(var r=t.tracks,i=r.length,a=new Array(i),o={endingStart:2400,endingEnd:2400},s=0;s!==i;++s){var l=r[s].createInterpolant(null);(a[s]=l).settings=o}this._interpolantSettings=o,this._interpolants=a,this._propertyBindings=new Array(i),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function pd(e){this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function md(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}function gd(){$r.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function vd(e,t,n,r){this.data=e,this.itemSize=t,this.offset=n,this.normalized=!0===r}function yd(e,t){this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function _d(e,t,n){yd.call(this,e,t),this.meshPerAttribute=n||1}function bd(e,t,n){Ir.call(this,e,t),this.meshPerAttribute=n||1}function Ed(e,t){return e.distance-t.distance}function Td(e,t,n,r){if(!1!==e.visible&&(e.raycast(t,n),!0===r))for(var i=e.children,a=0,o=i.length;a<o;a++)Td(i[a],t,n,!0)}function Ad(e,t,n){return this.radius=void 0!==e?e:1,this.phi=void 0!==t?t:0,this.theta=void 0!==n?n:0,this}function wd(e,t){this.min=void 0!==e?e:new zt(1/0,1/0),this.max=void 0!==t?t:new zt(-1/0,-1/0)}function Sd(e){vr.call(this),this.material=e,this.render=function(){}}function Cd(e,t,n,r){this.object=e,this.size=void 0!==t?t:1;var i=void 0!==n?n:16711680,a=void 0!==r?r:1,o=0,s=this.object.geometry;s&&s.isGeometry?o=3*s.faces.length:s&&s.isBufferGeometry&&(o=s.attributes.normal.count);var l=new $r,u=new Fr(2*o*3,3);l.addAttribute("position",u),cs.call(this,l,new ls({color:i,linewidth:a})),this.matrixAutoUpdate=!1,this.update()}function xd(e,t){vr.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;for(var n=new $r,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],i=0,a=1;i<32;i++,a++){var o=i/32*Math.PI*2,s=a/32*Math.PI*2;r.push(Math.cos(o),Math.sin(o),1,Math.cos(s),Math.sin(s),1)}n.addAttribute("position",new Fr(r,3));var l=new ls({fog:!1});this.cone=new cs(n,l),this.add(this.cone),this.update()}function Md(e){for(var t=function e(t){var n=[];t&&t.isBone&&n.push(t);for(var r=0;r<t.children.length;r++)n.push.apply(n,e(t.children[r]));return n}(e),n=new $r,r=[],i=[],a=new Gn(0,0,1),o=new Gn(0,1,0),s=0;s<t.length;s++){var l=t[s];l.parent&&l.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),i.push(a.r,a.g,a.b),i.push(o.r,o.g,o.b))}n.addAttribute("position",new Fr(r,3)),n.addAttribute("color",new Fr(i,3));var u=new ls({vertexColors:2,depthTest:!1,depthWrite:!1,transparent:!0});cs.call(this,n,u),this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}function Rd(e,t,n){this.light=e,this.light.updateMatrixWorld(),this.color=n;var r=new pl(t,4,2),i=new Wi({wireframe:!0,fog:!1});Qi.call(this,r,i),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function Id(e,t){vr.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;var n=new ls({fog:!1}),r=new $r;r.addAttribute("position",new Ir(new Float32Array(15),3)),this.line=new us(r,n),this.add(this.line),this.update()}function Pd(e,t,n){vr.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;var r=new Cs(t);r.rotateY(.5*Math.PI),this.material=new Wi({wireframe:!0,fog:!1}),void 0===this.color&&(this.material.vertexColors=2);var i=r.getAttribute("position"),a=new Float32Array(3*i.count);r.addAttribute("color",new Ir(a,3)),this.add(new Qi(r,this.material)),this.update()}function Dd(e,t,n,r){e=e||10,t=t||10,n=new Gn(void 0!==n?n:4473924),r=new Gn(void 0!==r?r:8947848);for(var i=t/2,a=e/t,o=e/2,s=[],l=[],u=0,c=0,d=-o;u<=t;u++,d+=a){s.push(-o,0,d,o,0,d),s.push(d,0,-o,d,0,o);var h=u===i?n:r;h.toArray(l,c),c+=3,h.toArray(l,c),c+=3,h.toArray(l,c),c+=3,h.toArray(l,c),c+=3}var f=new $r;f.addAttribute("position",new Fr(s,3)),f.addAttribute("color",new Fr(l,3));var p=new ls({vertexColors:2});cs.call(this,f,p)}function Ld(e,t,n,r,i,a){e=e||10,t=t||16,n=n||8,r=r||64,i=new Gn(void 0!==i?i:4473924),a=new Gn(void 0!==a?a:8947848);var o,s,l,u,c,d,h,f=[],p=[];for(u=0;u<=t;u++)l=u/t*(2*Math.PI),o=Math.sin(l)*e,s=Math.cos(l)*e,f.push(0,0,0),f.push(o,0,s),h=1&u?i:a,p.push(h.r,h.g,h.b),p.push(h.r,h.g,h.b);for(u=0;u<=n;u++)for(h=1&u?i:a,d=e-e/n*u,c=0;c<r;c++)l=c/r*(2*Math.PI),o=Math.sin(l)*d,s=Math.cos(l)*d,f.push(o,0,s),p.push(h.r,h.g,h.b),l=(c+1)/r*(2*Math.PI),o=Math.sin(l)*d,s=Math.cos(l)*d,f.push(o,0,s),p.push(h.r,h.g,h.b);var m=new $r;m.addAttribute("position",new Fr(f,3)),m.addAttribute("color",new Fr(p,3));var g=new ls({vertexColors:2});cs.call(this,m,g)}function Od(e,t,n,r){this.object=e,this.size=void 0!==t?t:1;var i=void 0!==n?n:16776960,a=void 0!==r?r:1,o=0,s=this.object.geometry;s&&s.isGeometry?o=s.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");var l=new $r,u=new Fr(2*o*3,3);l.addAttribute("position",u),cs.call(this,l,new ls({color:i,linewidth:a})),this.matrixAutoUpdate=!1,this.update()}function Nd(e,t,n){vr.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,void 0===t&&(t=1);var r=new $r;r.addAttribute("position",new Fr([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));var i=new ls({fog:!1});this.lightPlane=new us(r,i),this.add(this.lightPlane),(r=new $r).addAttribute("position",new Fr([0,0,0,0,0,1],3)),this.targetLine=new us(r,i),this.add(this.targetLine),this.update()}function kd(e){var t=new $r,n=new ls({color:16777215,vertexColors:1}),r=[],i=[],a={},o=new Gn(16755200),s=new Gn(16711680),l=new Gn(43775),u=new Gn(16777215),c=new Gn(3355443);function d(e,t,n){h(e,n),h(t,n)}function h(e,t){r.push(0,0,0),i.push(t.r,t.g,t.b),void 0===a[e]&&(a[e]=[]),a[e].push(r.length/3-1)}d("n1","n2",o),d("n2","n4",o),d("n4","n3",o),d("n3","n1",o),d("f1","f2",o),d("f2","f4",o),d("f4","f3",o),d("f3","f1",o),d("n1","f1",o),d("n2","f2",o),d("n3","f3",o),d("n4","f4",o),d("p","n1",s),d("p","n2",s),d("p","n3",s),d("p","n4",s),d("u1","u2",l),d("u2","u3",l),d("u3","u1",l),d("c","t",u),d("p","c",c),d("cn1","cn2",c),d("cn3","cn4",c),d("cf1","cf2",c),d("cf3","cf4",c),t.addAttribute("position",new Fr(r,3)),t.addAttribute("color",new Fr(i,3)),cs.call(this,t,n),this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update()}function Bd(e,t,n,r){nd.set(t,n,r).unproject(rd);var i=td[e];if(void 0!==i)for(var a=ed.getAttribute("position"),o=0,s=i.length;o<s;o++)a.setXYZ(i[o],nd.x,nd.y,nd.z)}function Fd(e,t){this.object=e,void 0===t&&(t=16776960);var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),i=new $r;i.setIndex(new Ir(n,1)),i.addAttribute("position",new Ir(r,3)),cs.call(this,i,new ls({color:t})),this.matrixAutoUpdate=!1,this.update()}function jd(e,t){this.type="Box3Helper",this.box=e;var n=void 0!==t?t:16776960,r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new $r;i.setIndex(new Ir(r,1)),i.addAttribute("position",new Fr([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),cs.call(this,i,new ls({color:n})),this.geometry.computeBoundingSphere()}function Ud(e,t,n){this.type="PlaneHelper",this.plane=e,this.size=void 0===t?1:t;var r=void 0!==n?n:16776960,i=new $r;i.addAttribute("position",new Fr([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),i.computeBoundingSphere(),us.call(this,i,new ls({color:r}));var a=new $r;a.addAttribute("position",new Fr([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),a.computeBoundingSphere(),this.add(new Qi(a,new Wi({color:r,opacity:.2,transparent:!0,depthWrite:!1})))}function Hd(e,t,n,r,i,a){vr.call(this),void 0===r&&(r=16776960),void 0===n&&(n=1),void 0===i&&(i=.2*n),void 0===a&&(a=.2*i),void 0===ad&&((ad=new $r).addAttribute("position",new Fr([0,0,0,0,1,0],3)),(od=new wl(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(t),this.line=new us(ad,new ls({color:r})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Qi(od,new Wi({color:r})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,i,a)}function Gd(e){var t=[0,0,0,e=e||1,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=new $r;n.addAttribute("position",new Fr(t,3)),n.addAttribute("color",new Fr([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var r=new ls({vertexColors:2});cs.call(this,n,r)}function Vd(e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),tu.call(this,e),this.type="catmullrom"}Object.assign(dd.prototype,{getValue:function(e,t){this.bind();var n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(e,t)},setValue:function(e,t){for(var n=this._bindings,r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(e,t)},bind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()},unbind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}),Object.assign(hd,{Composite:dd,create:function(e,t,n){return e&&e.isAnimationObjectGroup?new hd.Composite(e,t,n):new hd(e,t,n)},sanitizeNodeName:(Oc=new RegExp("["+cd+"]","g"),function(e){return e.replace(/\s/g,"_").replace(Oc,"")}),parseTrackName:(Cc="[^"+cd+"]",xc="[^"+cd.replace("\\.","")+"]",Mc=/((?:WC+[\/:])*)/.source.replace("WC",Cc),Rc=/(WCOD+)?/.source.replace("WCOD",xc),Ic=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Cc),Pc=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Cc),Dc=new RegExp("^"+Mc+Rc+Ic+Pc+"$"),Lc=["material","materials","bones"],function(e){var t=Dc.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){var i=n.nodeName.substring(r+1);-1!==Lc.indexOf(i)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=i)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}),findNode:function(e,i){if(!i||""===i||"root"===i||"."===i||-1===i||i===e.name||i===e.uuid)return e;if(e.skeleton){var t=e.skeleton.getBoneByName(i);if(void 0!==t)return t}if(e.children){var a=function(e){for(var t=0;t<e.length;t++){var n=e[t];if(n.name===i||n.uuid===i)return n;var r=a(n.children);if(r)return r}return null},n=a(e.children);if(n)return n}return null}}),Object.assign(hd.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,t){e[t]=this.node[this.propertyName]},function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)e[t++]=n[r]},function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]},function(e,t){this.resolvedProperty.toArray(e,t)}],SetterByBindingTypeAndVersioning:[[function(e,t){this.targetObject[this.propertyName]=e[t]},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++]},function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0},function(e,t){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty.fromArray(e,t)},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,t){this.bind(),this.getValue(e,t)},setValue:function(e,t){this.bind(),this.setValue(e,t)},bind:function(){var e=this.node,t=this.parsedPath,n=t.objectName,r=t.propertyName,i=t.propertyIndex;if(e||(e=hd.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,e){if(n){var a=t.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(var o=0;o<e.length;o++)if(e[o].name===a){a=o;break}break;default:if(void 0===e[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(void 0!==a){if(void 0===e[a])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[a]}}var s=e[r];if(void 0!==s){var l=this.Versioning.None;void 0!==e.needsUpdate?(l=this.Versioning.NeedsUpdate,this.targetObject=e):void 0!==e.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=e);var u=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(o=0;o<this.node.geometry.morphAttributes.position.length;o++)if(e.geometry.morphAttributes.position[o].name===i){i=o;break}}else{if(!e.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(o=0;o<this.node.geometry.morphTargets.length;o++)if(e.geometry.morphTargets[o].name===i){i=o;break}}}u=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=i}else void 0!==s.fromArray&&void 0!==s.toArray?(u=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(u=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=r;this.getValue=this.GetterByBindingType[u],this.setValue=this.SetterByBindingTypeAndVersioning[u][l]}else{var c=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+c+"."+r+" but it wasn't found.",e)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(hd.prototype,{_getValue_unbound:hd.prototype.getValue,_setValue_unbound:hd.prototype.setValue}),Object.assign(function(){this.uuid=Vt.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var t=0,n=arguments.length;t!==n;++t)e[arguments[t].uuid]=t;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var r=this;this.stats={objects:{get total(){return r._objects.length},get inUse(){return this.total-r.nCachedObjects_}},get bindingsPerObject(){return r._bindings.length}}}.prototype,{isAnimationObjectGroup:!0,add:function(){for(var e=this._objects,t=e.length,n=this.nCachedObjects_,r=this._indicesByUUID,i=this._paths,a=this._parsedPaths,o=this._bindings,s=o.length,l=void 0,u=0,c=arguments.length;u!==c;++u){var d=arguments[u],h=d.uuid,f=r[h];if(void 0===f){f=t++,r[h]=f,e.push(d);for(var p=0,m=s;p!==m;++p)o[p].push(new hd(d,i[p],a[p]))}else if(f<n){l=e[f];var g=--n,v=e[g];e[r[v.uuid]=f]=v,e[r[h]=g]=d;for(p=0,m=s;p!==m;++p){var y=o[p],_=y[g],b=y[f];y[f]=_,void 0===b&&(b=new hd(d,i[p],a[p])),y[g]=b}}else e[f]!==l&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=n},remove:function(){for(var e=this._objects,t=this.nCachedObjects_,n=this._indicesByUUID,r=this._bindings,i=r.length,a=0,o=arguments.length;a!==o;++a){var s=arguments[a],l=s.uuid,u=n[l];if(void 0!==u&&t<=u){var c=t++,d=e[c];e[n[d.uuid]=u]=d,e[n[l]=c]=s;for(var h=0,f=i;h!==f;++h){var p=r[h],m=p[c],g=p[u];p[u]=m,p[c]=g}}}this.nCachedObjects_=t},uncache:function(){for(var e=this._objects,t=e.length,n=this.nCachedObjects_,r=this._indicesByUUID,i=this._bindings,a=i.length,o=0,s=arguments.length;o!==s;++o){var l=arguments[o].uuid,u=r[l];if(void 0!==u)if(delete r[l],u<n){var c=--n,d=e[c],h=e[v=--t];e[r[d.uuid]=u]=d,e[r[h.uuid]=c]=h,e.pop();for(var f=0,p=a;f!==p;++f){var m=(y=i[f])[c],g=y[v];y[u]=m,y[c]=g,y.pop()}}else{var v;e[r[(h=e[v=--t]).uuid]=u]=h,e.pop();for(f=0,p=a;f!==p;++f){var y;(y=i[f])[u]=y[v],y.pop()}}}this.nCachedObjects_=n},subscribe_:function(e,t){var n=this._bindingsIndicesByPath,r=n[e],i=this._bindings;if(void 0!==r)return i[r];var a=this._paths,o=this._parsedPaths,s=this._objects,l=s.length,u=this.nCachedObjects_,c=new Array(l);r=i.length,n[e]=r,a.push(e),o.push(t),i.push(c);for(var d=u,h=s.length;d!==h;++d){var f=s[d];c[d]=new hd(f,e,t)}return c},unsubscribe_:function(e){var t=this._bindingsIndicesByPath,n=t[e];if(void 0!==n){var r=this._paths,i=this._parsedPaths,a=this._bindings,o=a.length-1,s=a[o];a[t[e[o]]=n]=s,a.pop(),i[n]=i[o],i.pop(),r[n]=r[o],r.pop()}}}),Object.assign(fd.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(e){return this._startTime=e,this},setLoop:function(e,t){return this.loop=e,this.repetitions=t,this},setEffectiveWeight:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(e){return this._scheduleFading(e,0,1)},fadeOut:function(e){return this._scheduleFading(e,1,0)},crossFadeFrom:function(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){var r=this._clip.duration,i=e._clip.duration,a=i/r,o=r/i;e.warp(1,a,t),this.warp(o,1,t)}return this},crossFadeTo:function(e,t,n){return e.crossFadeFrom(this,t,n)},stopFading:function(){var e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},setEffectiveTimeScale:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()},syncWith:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()},halt:function(e){return this.warp(this._effectiveTimeScale,0,e)},warp:function(e,t,n){var r=this._mixer,i=r.time,a=this._timeScaleInterpolant,o=this.timeScale;null===a&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);var s=a.parameterPositions,l=a.sampleValues;return s[0]=i,s[1]=i+n,l[0]=e/o,l[1]=t/o,this},stopWarping:function(){var e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(e,t,n,r){if(this.enabled){var i=this._startTime;if(null!==i){var a=(e-i)*n;if(a<0||0===n)return;this._startTime=null,t=n*a}t*=this._updateTimeScale(e);var o=this._updateTime(t),s=this._updateWeight(e);if(0<s)for(var l=this._interpolants,u=this._propertyBindings,c=0,d=l.length;c!==d;++c)l[c].evaluate(o),u[c].accumulate(r,s)}else this._updateWeight(e)},_updateWeight:function(e){var t=0;if(this.enabled){t=this.weight;var n=this._weightInterpolant;if(null!==n){var r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=t},_updateTimeScale:function(e){var t=0;if(!this.paused){t=this.timeScale;var n=this._timeScaleInterpolant;if(null!==n)t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}return this._effectiveTimeScale=t},_updateTime:function(e){var t=this.time+e;if(0===e)return t;var n=this._clip.duration,r=this.loop,i=this._loopCount;if(2200===r){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(n<=t)t=n;else{if(!(t<0))break e;t=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{var a=2202===r;if(-1===i&&(0<=e?(i=0,this._setEndings(!0,0===this.repetitions,a)):this._setEndings(0===this.repetitions,!0,a)),n<=t||t<0){var o=Math.floor(t/n);t-=n*o,i+=Math.abs(o);var s=this.repetitions-i;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,t=0<e?n:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<e?1:-1});else{if(1==s){var l=e<0;this._setEndings(l,!l,a)}else this._setEndings(!1,!1,a);this._loopCount=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}if(a&&1==(1&i))return n-(this.time=t)}return this.time=t},_setEndings:function(e,t,n){var r=this._interpolantSettings;n?(r.endingStart=2401,r.endingEnd=2401):(r.endingStart=e?this.zeroSlopeAtStart?2401:2400:2402,r.endingEnd=t?this.zeroSlopeAtEnd?2401:2400:2402)},_scheduleFading:function(e,t,n){var r=this._mixer,i=r.time,a=this._weightInterpolant;null===a&&(a=r._lendControlInterpolant(),this._weightInterpolant=a);var o=a.parameterPositions,s=a.sampleValues;return o[0]=i,s[0]=t,o[1]=i+e,s[1]=n,this}}),pd.prototype=Object.assign(Object.create(i.prototype),{constructor:pd,_bindAction:function(e,t){var n=e._localRoot||this._root,r=e._clip.tracks,i=r.length,a=e._propertyBindings,o=e._interpolants,s=n.uuid,l=this._bindingsByRootAndName,u=l[s];void 0===u&&(u={},l[s]=u);for(var c=0;c!==i;++c){var d=r[c],h=d.name,f=u[h];if(void 0!==f)a[c]=f;else{if(void 0!==(f=a[c])){null===f._cacheIndex&&(++f.referenceCount,this._addInactiveBinding(f,s,h));continue}var p=t&&t._propertyBindings[c].binding.parsedPath;++(f=new Sc(hd.create(n,h,p),d.ValueTypeName,d.getValueSize())).referenceCount,this._addInactiveBinding(f,s,h),a[c]=f}o[c].resultBuffer=f.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){var t=(e._localRoot||this._root).uuid,n=e._clip.uuid,r=this._actionsByClip[n];this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,n,t)}for(var i=e._propertyBindings,a=0,o=i.length;a!==o;++a){var s=i[a];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){for(var t=e._propertyBindings,n=0,r=t.length;n!==r;++n){var i=t[n];0==--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){var t=e._cacheIndex;return null!==t&&t<this._nActiveActions},_addInactiveAction:function(e,t,n){var r=this._actions,i=this._actionsByClip,a=i[t];if(void 0===a)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=a;else{var o=a.knownActions;e._byClipCacheIndex=o.length,o.push(e)}e._cacheIndex=r.length,r.push(e),a.actionByRoot[n]=e},_removeInactiveAction:function(e){var t=this._actions,n=t[t.length-1],r=e._cacheIndex;t[n._cacheIndex=r]=n,t.pop(),e._cacheIndex=null;var i=e._clip.uuid,a=this._actionsByClip,o=a[i],s=o.knownActions,l=s[s.length-1],u=e._byClipCacheIndex;s[l._byClipCacheIndex=u]=l,s.pop(),e._byClipCacheIndex=null,delete o.actionByRoot[(e._localRoot||this._root).uuid],0===s.length&&delete a[i],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){for(var t=e._propertyBindings,n=0,r=t.length;n!==r;++n){var i=t[n];0==--i.referenceCount&&this._removeInactiveBinding(i)}},_lendAction:function(e){var t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,i=t[r];t[e._cacheIndex=r]=e,t[i._cacheIndex=n]=i},_takeBackAction:function(e){var t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,i=t[r];t[e._cacheIndex=r]=e,t[i._cacheIndex=n]=i},_addInactiveBinding:function(e,t,n){var r=this._bindingsByRootAndName,i=r[t],a=this._bindings;void 0===i&&(i={},r[t]=i),(i[n]=e)._cacheIndex=a.length,a.push(e)},_removeInactiveBinding:function(e){var t=this._bindings,n=e.binding,r=n.rootNode.uuid,i=n.path,a=this._bindingsByRootAndName,o=a[r],s=t[t.length-1],l=e._cacheIndex;t[s._cacheIndex=l]=s,t.pop(),delete o[i];e:{for(var u in o)break e;delete a[r]}},_lendBinding:function(e){var t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,i=t[r];t[e._cacheIndex=r]=e,t[i._cacheIndex=n]=i},_takeBackBinding:function(e){var t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,i=t[r];t[e._cacheIndex=r]=e,t[i._cacheIndex=n]=i},_lendControlInterpolant:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,n=e[t];return void 0===n&&(e[(n=new Ou(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=t]=n),n},_takeBackControlInterpolant:function(e){var t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,i=t[r];t[e.__cacheIndex=r]=e,t[i.__cacheIndex=n]=i},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,t){var n=t||this._root,r=n.uuid,i="string"==typeof e?ju.findByName(n,e):e,a=null!==i?i.uuid:e,o=this._actionsByClip[a],s=null;if(void 0!==o){var l=o.actionByRoot[r];if(void 0!==l)return l;s=o.knownActions[0],null===i&&(i=s._clip)}if(null===i)return null;var u=new fd(this,i,t);return this._bindAction(u,s),this._addInactiveAction(u,a,r),u},existingAction:function(e,t){var n=t||this._root,r=n.uuid,i="string"==typeof e?ju.findByName(n,e):e,a=i?i.uuid:e,o=this._actionsByClip[a];return void 0!==o&&o.actionByRoot[r]||null},stopAllAction:function(){var e=this._actions,t=this._nActiveActions,n=this._bindings,r=this._nActiveBindings;this._nActiveActions=0;for(var i=this._nActiveBindings=0;i!==t;++i)e[i].reset();for(i=0;i!==r;++i)n[i].useCount=0;return this},update:function(e){e*=this.timeScale;for(var t=this._actions,n=this._nActiveActions,r=this.time+=e,i=Math.sign(e),a=this._accuIndex^=1,o=0;o!==n;++o){t[o]._update(r,e,i,a)}var s=this._bindings,l=this._nActiveBindings;for(o=0;o!==l;++o)s[o].apply(a);return this},getRoot:function(){return this._root},uncacheClip:function(e){var t=this._actions,n=e.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){for(var a=i.knownActions,o=0,s=a.length;o!==s;++o){var l=a[o];this._deactivateAction(l);var u=l._cacheIndex,c=t[t.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,t[c._cacheIndex=u]=c,t.pop(),this._removeInactiveBindingsForAction(l)}delete r[n]}},uncacheRoot:function(e){var t=e.uuid,n=this._actionsByClip;for(var r in n){var i=n[r].actionByRoot[t];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}var a=this._bindingsByRootAndName[t];if(void 0!==a)for(var o in a){var s=a[o];s.restoreOriginalState(),this._removeInactiveBinding(s)}},uncacheAction:function(e,t){var n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}),md.prototype.clone=function(){return new md(void 0===this.value.clone?this.value:this.value.clone())},gd.prototype=Object.assign(Object.create($r.prototype),{constructor:gd,isInstancedBufferGeometry:!0,copy:function(e){return $r.prototype.copy.call(this,e),this.maxInstancedCount=e.maxInstancedCount,this},clone:function(){return(new this.constructor).copy(this)}}),Object.defineProperties(vd.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(vd.prototype,{isInterleavedBufferAttribute:!0,setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this},setXYZ:function(e,t,n,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this},setXYZW:function(e,t,n,r,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=i,this}}),Object.defineProperty(yd.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(yd.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setArray:function(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");return this.count=void 0!==e?e.length/this.stride:0,this.array=e,this},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.dynamic=e.dynamic,this},copyAt:function(e,t,n){e*=this.stride,n*=t.stride;for(var r=0,i=this.stride;r<i;r++)this.array[e+r]=t.array[n+r];return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(e){return this.onUploadCallback=e,this}}),_d.prototype=Object.assign(Object.create(yd.prototype),{constructor:_d,isInstancedInterleavedBuffer:!0,copy:function(e){return yd.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),bd.prototype=Object.assign(Object.create(Ir.prototype),{constructor:bd,isInstancedBufferAttribute:!0,copy:function(e){return Ir.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),Object.assign(function(e,t,n,r){this.ray=new Yi(e,t),this.near=n||0,this.far=r||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}.prototype,{linePrecision:1,set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize()):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,t,n){var r=n||[];return Td(e,this,r,t),r.sort(Ed),r},intersectObjects:function(e,t,n){var r=n||[];if(!1===Array.isArray(e))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),r;for(var i=0,a=e.length;i<a;i++)Td(e[i],this,r,t);return r.sort(Ed),r}}),Object.assign(function(e){this.autoStart=void 0===e||e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var t=("undefined"==typeof performance?Date:performance).now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}),Object.assign(Ad.prototype,{set:function(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(e){return this.radius=e.length(),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e.x,e.z),this.phi=Math.acos(Vt.clamp(e.y/this.radius,-1,1))),this}}),Object.assign(function(e,t,n){return this.radius=void 0!==e?e:1,this.theta=void 0!==t?t:0,this.y=void 0!==n?n:0,this}.prototype,{set:function(e,t,n){return this.radius=e,this.theta=t,this.y=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this},setFromVector3:function(e){return this.radius=Math.sqrt(e.x*e.x+e.z*e.z),this.theta=Math.atan2(e.x,e.z),this.y=e.y,this}}),Object.assign(wd.prototype,{set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:(kc=new zt,function(e,t){var n=kc.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(e){return void 0===e&&(console.warn("THREE.Box2: .getCenter() target is now required"),e=new zt),this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("THREE.Box2: .getSize() target is now required"),e=new zt),this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .getParameter() target is now required"),t=new zt),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},clampPoint:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .clampPoint() target is now required"),t=new zt),t.copy(e).clamp(this.min,this.max)},distanceToPoint:(Nc=new zt,function(e){return Nc.copy(e).clamp(this.min,this.max).sub(e).length()}),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}),((Sd.prototype=Object.create(vr.prototype)).constructor=Sd).prototype.isImmediateRenderObject=!0,((Cd.prototype=Object.create(cs.prototype)).constructor=Cd).prototype.update=(Bc=new Yt,Fc=new Yt,jc=new Kt,function(){var e=["a","b","c"];this.object.updateMatrixWorld(!0),jc.getNormalMatrix(this.object.matrixWorld);var t=this.object.matrixWorld,n=this.geometry.attributes.position,r=this.object.geometry;if(r&&r.isGeometry)for(var i=r.vertices,a=r.faces,o=0,s=0,l=a.length;s<l;s++)for(var u=a[s],c=0,d=u.vertexNormals.length;c<d;c++){var h=i[u[e[c]]],f=u.vertexNormals[c];Bc.copy(h).applyMatrix4(t),Fc.copy(f).applyMatrix3(jc).normalize().multiplyScalar(this.size).add(Bc),n.setXYZ(o,Bc.x,Bc.y,Bc.z),o+=1,n.setXYZ(o,Fc.x,Fc.y,Fc.z),o+=1}else if(r&&r.isBufferGeometry){var p=r.attributes.position,m=r.attributes.normal;for(c=o=0,d=p.count;c<d;c++)Bc.set(p.getX(c),p.getY(c),p.getZ(c)).applyMatrix4(t),Fc.set(m.getX(c),m.getY(c),m.getZ(c)),Fc.applyMatrix3(jc).normalize().multiplyScalar(this.size).add(Bc),n.setXYZ(o,Bc.x,Bc.y,Bc.z),o+=1,n.setXYZ(o,Fc.x,Fc.y,Fc.z),o+=1}n.needsUpdate=!0}),((xd.prototype=Object.create(vr.prototype)).constructor=xd).prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},xd.prototype.update=(Uc=new Yt,Hc=new Yt,function(){this.light.updateMatrixWorld();var e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),Uc.setFromMatrixPosition(this.light.matrixWorld),Hc.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Hc.sub(Uc)),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}),((Md.prototype=Object.create(cs.prototype)).constructor=Md).prototype.updateMatrixWorld=(Gc=new Yt,Vc=new Wt,zc=new Wt,function(e){var t=this.bones,n=this.geometry,r=n.getAttribute("position");zc.getInverse(this.root.matrixWorld);for(var i=0,a=0;i<t.length;i++){var o=t[i];o.parent&&o.parent.isBone&&(Vc.multiplyMatrices(zc,o.matrixWorld),Gc.setFromMatrixPosition(Vc),r.setXYZ(a,Gc.x,Gc.y,Gc.z),Vc.multiplyMatrices(zc,o.parent.matrixWorld),Gc.setFromMatrixPosition(Vc),r.setXYZ(a+1,Gc.x,Gc.y,Gc.z),a+=2)}n.getAttribute("position").needsUpdate=!0,vr.prototype.updateMatrixWorld.call(this,e)}),((Rd.prototype=Object.create(Qi.prototype)).constructor=Rd).prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},Rd.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)},((Id.prototype=Object.create(vr.prototype)).constructor=Id).prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Id.prototype.update=function(){var e=.5*this.light.width,t=.5*this.light.height,n=this.line.geometry.attributes.position,r=n.array;r[0]=e,r[1]=-t,r[2]=0,r[3]=e,r[4]=t,r[5]=0,r[6]=-e,r[7]=t,r[8]=0,r[9]=-e,r[10]=-t,r[11]=0,r[12]=e,r[13]=-t,r[14]=0,n.needsUpdate=!0,void 0!==this.color?this.line.material.color.set(this.color):this.line.material.color.copy(this.light.color)},((Pd.prototype=Object.create(vr.prototype)).constructor=Pd).prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Pd.prototype.update=(Wc=new Yt,qc=new Gn,Yc=new Gn,function(){var e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var t=e.geometry.getAttribute("color");qc.copy(this.light.color),Yc.copy(this.light.groundColor);for(var n=0,r=t.count;n<r;n++){var i=n<r/2?qc:Yc;t.setXYZ(n,i.r,i.g,i.b)}t.needsUpdate=!0}e.lookAt(Wc.setFromMatrixPosition(this.light.matrixWorld).negate())}),(Dd.prototype=Object.create(cs.prototype)).constructor=Dd,(Ld.prototype=Object.create(cs.prototype)).constructor=Ld,((Od.prototype=Object.create(cs.prototype)).constructor=Od).prototype.update=(Kc=new Yt,Xc=new Yt,Qc=new Kt,function(){this.object.updateMatrixWorld(!0),Qc.getNormalMatrix(this.object.matrixWorld);for(var e=this.object.matrixWorld,t=this.geometry.attributes.position,n=this.object.geometry,r=n.vertices,i=n.faces,a=0,o=0,s=i.length;o<s;o++){var l=i[o],u=l.normal;Kc.copy(r[l.a]).add(r[l.b]).add(r[l.c]).divideScalar(3).applyMatrix4(e),Xc.copy(u).applyMatrix3(Qc).normalize().multiplyScalar(this.size).add(Kc),t.setXYZ(a,Kc.x,Kc.y,Kc.z),a+=1,t.setXYZ(a,Xc.x,Xc.y,Xc.z),a+=1}t.needsUpdate=!0}),((Nd.prototype=Object.create(vr.prototype)).constructor=Nd).prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},Nd.prototype.update=(Zc=new Yt,Jc=new Yt,$c=new Yt,function(){Zc.setFromMatrixPosition(this.light.matrixWorld),Jc.setFromMatrixPosition(this.light.target.matrixWorld),$c.subVectors(Jc,Zc),this.lightPlane.lookAt($c),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt($c),this.targetLine.scale.z=$c.length()}),((kd.prototype=Object.create(cs.prototype)).constructor=kd).prototype.update=(nd=new Yt,rd=new yr,function(){ed=this.geometry,td=this.pointMap,rd.projectionMatrix.copy(this.camera.projectionMatrix),Bd("c",0,0,-1),Bd("t",0,0,1),Bd("n1",-1,-1,-1),Bd("n2",1,-1,-1),Bd("n3",-1,1,-1),Bd("n4",1,1,-1),Bd("f1",-1,-1,1),Bd("f2",1,-1,1),Bd("f3",-1,1,1),Bd("f4",1,1,1),Bd("u1",.7,1.1,-1),Bd("u2",-.7,1.1,-1),Bd("u3",0,2,-1),Bd("cf1",-1,0,1),Bd("cf2",1,0,1),Bd("cf3",0,-1,1),Bd("cf4",0,1,1),Bd("cn1",-1,0,-1),Bd("cn2",1,0,-1),Bd("cn3",0,-1,-1),Bd("cn4",0,1,-1),ed.getAttribute("position").needsUpdate=!0}),((Fd.prototype=Object.create(cs.prototype)).constructor=Fd).prototype.update=(id=new Dn,function(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&id.setFromObject(this.object),!id.isEmpty()){var t=id.min,n=id.max,r=this.geometry.attributes.position,i=r.array;i[0]=n.x,i[1]=n.y,i[2]=n.z,i[3]=t.x,i[4]=n.y,i[5]=n.z,i[6]=t.x,i[7]=t.y,i[8]=n.z,i[9]=n.x,i[10]=t.y,i[11]=n.z,i[12]=n.x,i[13]=n.y,i[14]=t.z,i[15]=t.x,i[16]=n.y,i[17]=t.z,i[18]=t.x,i[19]=t.y,i[20]=t.z,i[21]=n.x,i[22]=t.y,i[23]=t.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}}),Fd.prototype.setFromObject=function(e){return this.object=e,this.update(),this},((jd.prototype=Object.create(cs.prototype)).constructor=jd).prototype.updateMatrixWorld=function(e){var t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),vr.prototype.updateMatrixWorld.call(this,e))},((Ud.prototype=Object.create(us.prototype)).constructor=Ud).prototype.updateMatrixWorld=function(e){var t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.children[0].material.side=t<0?Ae:k,this.lookAt(this.plane.normal),vr.prototype.updateMatrixWorld.call(this,e)},((Hd.prototype=Object.create(vr.prototype)).constructor=Hd).prototype.setDirection=(ld=new Yt,function(e){.99999<e.y?this.quaternion.set(0,0,0,1):e.y<-.99999?this.quaternion.set(1,0,0,0):(ld.set(e.z,0,-e.x).normalize(),sd=Math.acos(e.y),this.quaternion.setFromAxisAngle(ld,sd))}),Hd.prototype.setLength=function(e,t,n){void 0===t&&(t=.2*e),void 0===n&&(n=.2*t),this.line.scale.set(1,Math.max(0,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()},Hd.prototype.setColor=function(e){this.line.material.color.copy(e),this.cone.material.color.copy(e)},(Gd.prototype=Object.create(cs.prototype)).constructor=Gd,Yl.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(Yl.prototype),(e.prototype.constructor=e).prototype.getPoint=t,e},Object.assign(fu.prototype,{createPointsGeometry:function(e){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getPoints(e);return this.createGeometry(t)},createSpacedPointsGeometry:function(e){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getSpacedPoints(e);return this.createGeometry(t)},createGeometry:function(e){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var t=new Rr,n=0,r=e.length;n<r;n++){var i=e[n];t.vertices.push(new Yt(i.x,i.y,i.z||0))}return t}}),Object.assign(pu.prototype,{fromPoints:function(e){console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)}}),Vd.prototype=Object.create(tu.prototype),Object.assign(Vd.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),Dd.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Md.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(Yu.prototype,{extractUrlBase:function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Ku(e)}}),Object.assign(wd.prototype,{center:function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},size:function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(Dn.prototype,{center:function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionSphere:function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},size:function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)}}),Ki.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Object.assign(Vt,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),Vt.floorPowerOfTwo(e)},nextPowerOfTwo:function(e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),Vt.ceilPowerOfTwo(e)}}),Object.assign(Kt.prototype,{flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(e){return console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(Wt.prototype,{extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},getPosition:function(){return void 0===ud&&(ud=new Yt),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),ud.setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(e){return console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(e,t,n,r,i,a){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,r,n,i,a)}}),kn.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},qt.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},Object.assign(Yi.prototype,{isIntersectionBox:function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionPlane:function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},isIntersectionSphere:function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}}),Object.assign(Xi.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(e,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,t)},midpoint:function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},normal:function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},plane:function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)}}),Object.assign(Xi,{barycoordFromPoint:function(e,t,n,r,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Xi.getBarycoord(e,t,n,r,i)},normal:function(e,t,n,r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Xi.getNormal(e,t,n,r)}}),Object.assign(mu.prototype,{extractAllPoints:function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},extrude:function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new sl(this,e)},makeGeometry:function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new _l(this,e)}}),Object.assign(zt.prototype,{fromAttribute:function(e,t,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},distanceToManhattan:function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Yt.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},applyProjection:function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},fromAttribute:function(e,t,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},distanceToManhattan:function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Mn.prototype,{fromAttribute:function(e,t,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Rr.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}}),Object.assign(vr.prototype,{getChildByName:function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")}}),Object.defineProperties(vr.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(is.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(as.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Object.defineProperty(Yl.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),Ko.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(gu.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(Ir.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")}}),Object.assign($r.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},addDrawCall:function(e,t,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties($r.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.assign(ll.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.defineProperties(md.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(zi.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Gn}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===e}}}),Object.defineProperties(Ol.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(qi.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),Object.assign(Jo.prototype,{animate:function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")}}),Object.defineProperties(Jo.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Go.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Rn.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Object.defineProperties(Qo.prototype,{standing:{set:function(){console.warn("THREE.WebVRManager: .standing has been removed.")}}}),Tc.prototype.load=function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var t=this;return(new _c).load(e,function(e){t.setBuffer(e)}),this},wc.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},bc.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)};function zd(t,n){var r,i,a=this,o=new Wt,s=null;"VRFrameData"in window&&(s=new VRFrameData),navigator.getVRDisplays&&navigator.getVRDisplays().then(function(e){0<(i=e).length?r=e[0]:n&&n("VR input not available.")}).catch(function(){console.warn("VRControls: Unable to get VR Displays")}),this.scale=1,this.standing=!1,this.userHeight=1.6,this.getVRDisplay=function(){return r},this.setVRDisplay=function(e){r=e},this.getVRDisplays=function(){return console.warn("VRControls: getVRDisplays() is being deprecated."),i},this.getStandingMatrix=function(){return o},this.update=function(){var e;r&&(r.getFrameData?(r.getFrameData(s),e=s.pose):r.getPose&&(e=r.getPose()),null!==e.orientation&&t.quaternion.fromArray(e.orientation),null!==e.position?t.position.fromArray(e.position):t.position.set(0,0,0),this.standing&&(r.stageParameters?(t.updateMatrix(),o.fromArray(r.stageParameters.sittingToStandingTransform),t.applyMatrix(o)):t.position.setY(t.position.y+this.userHeight)),t.position.multiplyScalar(a.scale))},this.dispose=function(){r=null}}function Wd(h,t){var f,n,p,m,g=new Yt,v=new Yt,y=new Wt,_=new Wt,b=new Wt,E=null;"VRFrameData"in window&&(E=new window.VRFrameData),navigator.getVRDisplays&&navigator.getVRDisplays().then(function(e){0<(n=e).length?f=e[0]:t&&t("HMD not available")}).catch(function(){console.warn("VREffect: Unable to get VR Displays")}),this.isPresenting=!1;var T=this,i=h.getSize(),a=!1,o=h.getPixelRatio();this.getVRDisplay=function(){return f},this.setVRDisplay=function(e){f=e},this.getVRDisplays=function(){return console.warn("VREffect: getVRDisplays() is being deprecated."),n},this.setSize=function(e,t,n){if(i={width:e,height:t},a=n,T.isPresenting){var r=f.getEyeParameters("left");h.setPixelRatio(1),h.setSize(2*r.renderWidth,r.renderHeight,!1)}else h.setPixelRatio(o),h.setSize(e,t,n)};var r=h.domElement,A=[0,0,.5,1],w=[.5,0,.5,1];function e(){var e=T.isPresenting;if(T.isPresenting=void 0!==f&&f.isPresenting,T.isPresenting){var t=f.getEyeParameters("left"),n=t.renderWidth,r=t.renderHeight;e||(o=h.getPixelRatio(),i=h.getSize(),h.setPixelRatio(1),h.setSize(2*n,r,!1))}else e&&(h.setPixelRatio(o),h.setSize(i.width,i.height,a))}window.addEventListener("vrdisplaypresentchange",e,!1),this.setFullScreen=function(n){return new Promise(function(e,t){void 0!==f?T.isPresenting!==n?e(n?f.requestPresent([{source:r}]):f.exitPresent()):e():t(new Error("No VR hardware found."))})},this.requestPresent=function(){return this.setFullScreen(!0)},this.exitPresent=function(){return this.setFullScreen(!1)},this.requestAnimationFrame=function(e){return void 0!==f?f.requestAnimationFrame(e):window.requestAnimationFrame(e)},this.cancelAnimationFrame=function(e){void 0!==f?f.cancelAnimationFrame(e):window.cancelAnimationFrame(e)},this.submitFrame=function(){void 0!==f&&T.isPresenting&&f.submitFrame()},this.autoSubmitFrame=!0;var S=new Ko;S.layers.enable(1);var C=new Ko;C.layers.enable(2),this.render=function(e,t,n,r){if(f&&T.isPresenting){var i=e.autoUpdate;i&&(e.updateMatrixWorld(),e.autoUpdate=!1),Array.isArray(e)&&(console.warn("VREffect.render() no longer supports arrays. Use object.layers instead."),e=e[0]);var a,o,s=h.getSize(),l=f.getLayers();if(l.length){var u=l[0];a=null!==u.leftBounds&&4===u.leftBounds.length?u.leftBounds:A,o=null!==u.rightBounds&&4===u.rightBounds.length?u.rightBounds:w}else a=A,o=w;if(p={x:Math.round(s.width*a[0]),y:Math.round(s.height*a[1]),width:Math.round(s.width*a[2]),height:Math.round(s.height*a[3])},m={x:Math.round(s.width*o[0]),y:Math.round(s.height*o[1]),width:Math.round(s.width*o[2]),height:Math.round(s.height*o[3])},n?(h.setRenderTarget(n),n.scissorTest=!0):(h.setRenderTarget(null),h.setScissorTest(!0)),(h.autoClear||r)&&h.clear(),null===t.parent&&t.updateMatrixWorld(),t.matrixWorld.decompose(S.position,S.quaternion,S.scale),C.position.copy(S.position),C.quaternion.copy(S.quaternion),C.scale.copy(S.scale),f.getFrameData)f.depthNear=t.near,f.depthFar=t.far,f.getFrameData(E),S.projectionMatrix.elements=E.leftProjectionMatrix,C.projectionMatrix.elements=E.rightProjectionMatrix,function(e){e.pose.orientation?(x.fromArray(e.pose.orientation),y.makeRotationFromQuaternion(x)):y.identity();e.pose.position&&(M.fromArray(e.pose.position),y.setPosition(M));_.fromArray(e.leftViewMatrix),_.multiply(y),b.fromArray(e.rightViewMatrix),b.multiply(y),_.getInverse(_),b.getInverse(b)}(E),S.updateMatrix(),S.matrix.multiply(_),S.matrix.decompose(S.position,S.quaternion,S.scale),C.updateMatrix(),C.matrix.multiply(b),C.matrix.decompose(C.position,C.quaternion,C.scale);else{var c=f.getEyeParameters("left"),d=f.getEyeParameters("right");S.projectionMatrix=R(c.fieldOfView,!0,t.near,t.far),C.projectionMatrix=R(d.fieldOfView,!0,t.near,t.far),g.fromArray(c.offset),v.fromArray(d.offset),S.translateOnAxis(g,S.scale.x),C.translateOnAxis(v,C.scale.x)}return n?(n.viewport.set(p.x,p.y,p.width,p.height),n.scissor.set(p.x,p.y,p.width,p.height)):(h.setViewport(p.x,p.y,p.width,p.height),h.setScissor(p.x,p.y,p.width,p.height)),h.render(e,S,n,r),n?(n.viewport.set(m.x,m.y,m.width,m.height),n.scissor.set(m.x,m.y,m.width,m.height)):(h.setViewport(m.x,m.y,m.width,m.height),h.setScissor(m.x,m.y,m.width,m.height)),h.render(e,C,n,r),n?(n.viewport.set(0,0,s.width,s.height),n.scissor.set(0,0,s.width,s.height),n.scissorTest=!1,h.setRenderTarget(null)):(h.setViewport(0,0,s.width,s.height),h.setScissorTest(!1)),i&&(e.autoUpdate=!0),void(T.autoSubmitFrame&&T.submitFrame())}h.render(e,t,n,r)},this.dispose=function(){window.removeEventListener("vrdisplaypresentchange",e,!1)};var x=new qt,M=new Yt;function s(e,t,n,r){n=void 0===n?.01:n,r=void 0===r?1e4:r;var i=(t=void 0===t||t)?-1:1,a=new Wt,o=a.elements,s=function(e){var t=2/(e.leftTan+e.rightTan),n=(e.leftTan-e.rightTan)*t*.5,r=2/(e.upTan+e.downTan);return{scale:[t,r],offset:[n,(e.upTan-e.downTan)*r*.5]}}(e);return o[0]=s.scale[0],o[1]=0,o[2]=s.offset[0]*i,o[3]=0,o[4]=0,o[5]=s.scale[1],o[6]=-s.offset[1]*i,o[7]=0,o[8]=0,o[9]=0,o[10]=r/(n-r)*-i,o[11]=r*n/(n-r),o[12]=0,o[13]=0,o[14]=i,o[15]=0,a.transpose(),a}function R(e,t,n,r){var i=Math.PI/180;return s({upTan:Math.tan(e.upDegrees*i),downTan:Math.tan(e.downDegrees*i),leftTan:Math.tan(e.leftDegrees*i),rightTan:Math.tan(e.rightDegrees*i)},t,n,r)}}function qd(e,t){var n,r,i,a,o;this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.target=new Yt,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:q,ZOOM:Y,PAN:K},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return p.phi},this.getAzimuthalAngle=function(){return p.theta},this.saveState=function(){s.target0.copy(s.target),s.position0.copy(s.object.position),s.zoom0=s.object.zoom},this.reset=function(){s.target.copy(s.target0),s.object.position.copy(s.position0),s.object.zoom=s.zoom0,s.object.updateProjectionMatrix(),s.dispatchEvent(l),s.update(),h=d.NONE},this.update=(n=new Yt,r=(new qt).setFromUnitVectors(e.up,new Yt(0,1,0)),i=r.clone().inverse(),a=new Yt,o=new qt,function(){var e=s.object.position;return n.copy(e).sub(s.target),n.applyQuaternion(r),p.setFromVector3(n),s.autoRotate&&h===d.NONE&&s.rotateLeft(2*Math.PI/60/60*s.autoRotateSpeed),p.theta+=m.theta,p.phi+=m.phi,p.theta=Math.max(s.minAzimuthAngle,Math.min(s.maxAzimuthAngle,p.theta)),p.phi=Math.max(s.minPolarAngle,Math.min(s.maxPolarAngle,p.phi)),p.makeSafe(),p.radius*=g,p.radius=Math.max(s.minDistance,Math.min(s.maxDistance,p.radius)),s.target.add(v),n.setFromSpherical(p),n.applyQuaternion(i),e.copy(s.target).add(n),s.object.lookAt(s.target),!0===s.enableDamping?(m.theta*=1-s.dampingFactor,m.phi*=1-s.dampingFactor,v.multiplyScalar(1-s.dampingFactor)):(m.set(0,0,0),v.set(0,0,0)),g=1,!(!(y||a.distanceToSquared(s.object.position)>f||8*(1-o.dot(s.object.quaternion))>f)||(s.dispatchEvent(l),a.copy(s.object.position),o.copy(s.object.quaternion),y=!1))}),this.dispose=function(){s.domElement.removeEventListener("contextmenu",W,!1),s.domElement.removeEventListener("mousedown",B,!1),s.domElement.removeEventListener("wheel",U,!1),s.domElement.removeEventListener("touchstart",G,!1),s.domElement.removeEventListener("touchend",z,!1),s.domElement.removeEventListener("touchmove",V,!1),document.removeEventListener("mousemove",F,!1),document.removeEventListener("mouseup",j,!1),window.removeEventListener("keydown",H,!1)};var s=this,l={type:"change"},u={type:"start"},c={type:"end"},d={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY_PAN:4},h=d.NONE,f=1e-6,p=new Ad,m=new Ad,g=1,v=new Yt,y=!1,_=new zt,b=new zt,E=new zt,T=new zt,A=new zt,w=new zt,S=new zt,C=new zt,x=new zt;function M(){return Math.pow(.95,s.zoomSpeed)}s.rotateLeft=function(e){m.theta-=e},s.rotateUp=function(e){m.phi-=e};var R,I,P,D=(R=new Yt,function(e,t){R.setFromMatrixColumn(t,0),R.multiplyScalar(-e),v.add(R)}),L=(I=new Yt,function(e,t){!0===s.screenSpacePanning?I.setFromMatrixColumn(t,1):(I.setFromMatrixColumn(t,0),I.crossVectors(s.object.up,I)),I.multiplyScalar(e),v.add(I)}),O=(P=new Yt,function(e,t){var n=s.domElement===document?s.domElement.body:s.domElement;if(s.object.isPerspectiveCamera){var r=s.object.position;P.copy(r).sub(s.target);var i=P.length();i*=Math.tan(s.object.fov/2*Math.PI/180),D(2*e*i/n.clientHeight,s.object.matrix),L(2*t*i/n.clientHeight,s.object.matrix)}else s.object.isOrthographicCamera?(D(e*(s.object.right-s.object.left)/s.object.zoom/n.clientWidth,s.object.matrix),L(t*(s.object.top-s.object.bottom)/s.object.zoom/n.clientHeight,s.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),s.enablePan=!1)});function N(e){s.object.isPerspectiveCamera?g/=e:s.object.isOrthographicCamera?(s.object.zoom=Math.max(s.minZoom,Math.min(s.maxZoom,s.object.zoom*e)),s.object.updateProjectionMatrix(),y=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),s.enableZoom=!1)}function k(e){s.object.isPerspectiveCamera?g*=e:s.object.isOrthographicCamera?(s.object.zoom=Math.max(s.minZoom,Math.min(s.maxZoom,s.object.zoom/e)),s.object.updateProjectionMatrix(),y=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),s.enableZoom=!1)}function B(e){if(!1!==s.enabled){switch(e.preventDefault(),e.button){case s.mouseButtons.ORBIT:if(!1===s.enableRotate)return;!function(e){_.set(e.clientX,e.clientY)}(e),h=d.ROTATE;break;case s.mouseButtons.ZOOM:if(!1===s.enableZoom)return;!function(e){S.set(e.clientX,e.clientY)}(e),h=d.DOLLY;break;case s.mouseButtons.PAN:if(!1===s.enablePan)return;!function(e){T.set(e.clientX,e.clientY)}(e),h=d.PAN}h!==d.NONE&&(document.addEventListener("mousemove",F,!1),document.addEventListener("mouseup",j,!1),s.dispatchEvent(u))}}function F(e){if(!1!==s.enabled)switch(e.preventDefault(),h){case d.ROTATE:if(!1===s.enableRotate)return;!function(e){b.set(e.clientX,e.clientY),E.subVectors(b,_).multiplyScalar(s.rotateSpeed);var t=s.domElement===document?s.domElement.body:s.domElement;s.rotateLeft(2*Math.PI*E.x/t.clientHeight),s.rotateUp(2*Math.PI*E.y/t.clientHeight),_.copy(b),s.update()}(e);break;case d.DOLLY:if(!1===s.enableZoom)return;!function(e){C.set(e.clientX,e.clientY),x.subVectors(C,S),0<x.y?N(M()):x.y<0&&k(M()),S.copy(C),s.update()}(e);break;case d.PAN:if(!1===s.enablePan)return;!function(e){A.set(e.clientX,e.clientY),w.subVectors(A,T).multiplyScalar(s.panSpeed),O(w.x,w.y),T.copy(A),s.update()}(e)}}function j(e){!1!==s.enabled&&(document.removeEventListener("mousemove",F,!1),document.removeEventListener("mouseup",j,!1),s.dispatchEvent(c),h=d.NONE)}function U(e){!1===s.enabled||!1===s.enableZoom||h!==d.NONE&&h!==d.ROTATE||(e.preventDefault(),e.stopPropagation(),s.dispatchEvent(u),function(e){e.deltaY<0?k(M()):0<e.deltaY&&N(M()),s.update()}(e),s.dispatchEvent(c))}function H(e){!1!==s.enabled&&!1!==s.enableKeys&&!1!==s.enablePan&&function(e){switch(e.keyCode){case s.keys.UP:O(0,s.keyPanSpeed),s.update();break;case s.keys.BOTTOM:O(0,-s.keyPanSpeed),s.update();break;case s.keys.LEFT:O(s.keyPanSpeed,0),s.update();break;case s.keys.RIGHT:O(-s.keyPanSpeed,0),s.update()}}(e)}function G(e){if(!1!==s.enabled){switch(e.preventDefault(),e.touches.length){case 1:if(!1===s.enableRotate)return;!function(e){_.set(e.touches[0].pageX,e.touches[0].pageY)}(e),h=d.TOUCH_ROTATE;break;case 2:if(!1===s.enableZoom&&!1===s.enablePan)return;!function(e){if(s.enableZoom){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,r=Math.sqrt(t*t+n*n);S.set(0,r)}if(s.enablePan){var i=.5*(e.touches[0].pageX+e.touches[1].pageX),a=.5*(e.touches[0].pageY+e.touches[1].pageY);T.set(i,a)}}(e),h=d.TOUCH_DOLLY_PAN;break;default:h=d.NONE}h!==d.NONE&&s.dispatchEvent(u)}}function V(e){if(!1!==s.enabled)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:if(!1===s.enableRotate)return;if(h!==d.TOUCH_ROTATE)return;!function(e){b.set(e.touches[0].pageX,e.touches[0].pageY),E.subVectors(b,_).multiplyScalar(s.rotateSpeed);var t=s.domElement===document?s.domElement.body:s.domElement;s.rotateLeft(2*Math.PI*E.x/t.clientHeight),s.rotateUp(2*Math.PI*E.y/t.clientHeight),_.copy(b),s.update()}(e);break;case 2:if(!1===s.enableZoom&&!1===s.enablePan)return;if(h!==d.TOUCH_DOLLY_PAN)return;!function(e){if(s.enableZoom){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,r=Math.sqrt(t*t+n*n);C.set(0,r),x.set(0,Math.pow(C.y/S.y,s.zoomSpeed)),N(x.y),S.copy(C)}if(s.enablePan){var i=.5*(e.touches[0].pageX+e.touches[1].pageX),a=.5*(e.touches[0].pageY+e.touches[1].pageY);A.set(i,a),w.subVectors(A,T).multiplyScalar(s.panSpeed),O(w.x,w.y),T.copy(A)}s.update()}(e);break;default:h=d.NONE}}function z(e){!1!==s.enabled&&(s.dispatchEvent(c),h=d.NONE)}function W(e){!1!==s.enabled&&e.preventDefault()}s.domElement.addEventListener("mousedown",B,!1),s.domElement.addEventListener("wheel",U,!1),s.domElement.addEventListener("touchstart",G,!1),s.domElement.addEventListener("touchend",z,!1),s.domElement.addEventListener("touchmove",V,!1),window.addEventListener("keydown",H,!1),this.update()}(qd.prototype=Object.create(i.prototype)).constructor=qd,Object.defineProperties(qd.prototype,{center:{get:function(){return console.warn("OrbitControls: .center has been renamed to .target"),this.target}},noZoom:{get:function(){return console.warn("OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(e){console.warn("OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!e}},noRotate:{get:function(){return console.warn("OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(e){console.warn("OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!e}},noPan:{get:function(){return console.warn("OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(e){console.warn("OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!e}},noKeys:{get:function(){return console.warn("OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(e){console.warn("OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!e}},staticMoving:{get:function(){return console.warn("OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.enableDamping},set:function(e){console.warn("OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.enableDamping=!e}},dynamicDampingFactor:{get:function(){return console.warn("OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor},set:function(e){console.warn("OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor=e}}});function Yd(e){var a=this;function t(e){a.deviceOrientation=e}function n(){a.screenOrientation=window.orientation||0}this.object=e,this.object.rotation.reorder("YXZ"),this.enabled=!0,this.deviceOrientation={},this.screenOrientation=0,this.alphaOffset=0;var o,s,l,u,c=(o=new Yt(0,0,1),s=new Qn,l=new qt,u=new qt(-Math.sqrt(.5),0,0,Math.sqrt(.5)),function(e,t,n,r,i){s.set(n,t,-r,"YXZ"),e.setFromEuler(s),e.multiply(u),e.multiply(l.setFromAxisAngle(o,-i))});this.connect=function(){n(),window.addEventListener("orientationchange",n,!1),window.addEventListener("deviceorientation",t,!1),a.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",n,!1),window.removeEventListener("deviceorientation",t,!1),a.enabled=!1},this.update=function(){if(!1!==a.enabled){var e=a.deviceOrientation;if(e){var t=e.alpha?Vt.degToRad(e.alpha)+a.alphaOffset:0,n=e.beta?Vt.degToRad(e.beta):0,r=e.gamma?Vt.degToRad(e.gamma):0,i=a.screenOrientation?Vt.degToRad(a.screenOrientation):0;c(a.object.quaternion,t,n,r,i)}}},this.dispose=function(){a.disconnect()},this.connect()}function Kd(e){if(e){if(e=e.toString().trim(),/sphere/i.test(e))return"360";if(/cube/i.test(e))return"360_CUBE";if(/equirectangular/i.test(e))return"360";for(var t=0;t<Jd.length;t++)if(new RegExp("^"+Jd[t]+"$","i").test(e))return Jd[t]}}var Xd,Qd=function(){function e(e){this.object=e.camera,this.domElement=e.canvas,this.orbit=new qd(this.object,this.domElement),this.speed=.5,this.orbit.target.set(0,0,-1),this.orbit.enableZoom=!1,this.orbit.enablePan=!1,this.orbit.rotateSpeed=-this.speed,e.orientation&&(this.orientation=new Yd(this.object)),e.halfView&&(this.orbit.minAzimuthAngle=-Math.PI/4,this.orbit.maxAzimuthAngle=Math.PI/4)}var t=e.prototype;return t.update=function(){if(this.orientation){this.orientation.update();var e=this.orientation.object.quaternion,t=function(e,t,n,r){var i=e*t+n*r;if(.499<i){var a=2*Math.atan2(e,r);return new Yt(Math.PI/2,0,a)}if(i<-.499){var o=-2*Math.atan2(e,r);return new Yt(-Math.PI/2,0,o)}var s=e*e,l=t*t,u=n*n,c=Math.atan2(2*t*r-2*e*n,1-2*l-2*u);return new Yt(Math.asin(2*i),Math.atan2(2*e*r-2*t*n,1-2*s-2*u),c)}(e.x,e.y,e.z,e.w);void 0===this.lastAngle_&&(this.lastAngle_=t),this.orbit.rotateLeft((this.lastAngle_.z-t.z)*(1+this.speed)),this.orbit.rotateUp((this.lastAngle_.y-t.y)*(1+this.speed)),this.lastAngle_=t}this.orbit.update()},t.dispose=function(){this.orbit.dispose(),this.orientation&&this.orientation.dispose()},e}(),Zd=((Xd=r.createElement("video")).crossOrigin="anonymous",Xd.hasAttribute("crossorigin")),Jd=["360","360_LR","360_TB","360_CUBE","EAC","EAC_LR","NONE","AUTO","Sphere","Cube","equirectangular","180","180_LR","180_MONO"],$d=function(i){function e(e,t,n){var r;return(r=i.call(this)||this).player=e,r.canvas=t,r.options=n,r.onMoveEnd=s.bind(a(r),r.onMoveEnd),r.onMoveStart=s.bind(a(r),r.onMoveStart),r.onMove=s.bind(a(r),r.onMove),r.onControlBarMove=s.bind(a(r),r.onControlBarMove),r.player.controlBar.on(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend"],r.onControlBarMove),r.oldReportUserActivity=r.player.reportUserActivity,r.player.reportUserActivity=function(){},r.canvas.addEventListener("mousedown",r.onMoveStart),r.canvas.addEventListener("touchstart",r.onMoveStart),r.canvas.addEventListener("mousemove",r.onMove),r.canvas.addEventListener("touchmove",r.onMove),r.canvas.addEventListener("mouseup",r.onMoveEnd),r.canvas.addEventListener("touchend",r.onMoveEnd),r.shouldTogglePlay=!1,r}l(e,i);var t=e.prototype;return t.togglePlay=function(){this.player.paused()?this.player.play():this.player.pause()},t.onMoveStart=function(e){this.options.disableTogglePlay||!this.player.controls()||"mousedown"===e.type&&!s.dom.isSingleLeftClick(e)?this.shouldTogglePlay=!1:(this.shouldTogglePlay=!0,this.touchMoveCount_=0)},t.onMoveEnd=function(e){if("touchend"===e.type&&this.touchMoveCount_<10)return!1===this.player.userActive()?void this.player.userActive(!0):void this.player.userActive(!1);this.shouldTogglePlay&&"mouseup"==e.type&&this.togglePlay()},t.onMove=function(){this.touchMoveCount_++,this.shouldTogglePlay=!1},t.onControlBarMove=function(){this.player.userActive(!0)},t.dispose=function(){this.canvas.removeEventListener("mousedown",this.onMoveStart),this.canvas.removeEventListener("touchstart",this.onMoveStart),this.canvas.removeEventListener("mousemove",this.onMove),this.canvas.removeEventListener("touchmove",this.onMove),this.canvas.removeEventListener("mouseup",this.onMoveEnd),this.canvas.removeEventListener("touchend",this.onMoveEnd),this.player.controlBar.off(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend"],this.onControlBarMove),this.player.reportUserActivity=this.oldReportUserActivity},e}(s.EventTarget),eh=function(o){function e(e,t,n,r){var i;i=o.call(this)||this;var a=s.mergeOptions({channelMap:s.browser.IS_SAFARI?[2,0,1,3]:[0,1,2,3],ambisonicOrder:1},r);return i.videoElementSource=e.createMediaElementSource(n),i.foaRenderer=t.createFOARenderer(e,a),i.foaRenderer.initialize().then(function(){"suspended"===e.state&&i.trigger({type:"audiocontext-suspended"}),i.videoElementSource.connect(i.foaRenderer.input),i.foaRenderer.output.connect(e.destination),i.initialized=!0,i.trigger({type:"omnitone-ready"})},function(e){s.log.warn("videojs-vr: Omnitone initializes failed with the following error: "+e+")")}),i}l(e,o);var t=e.prototype;return t.update=function(e){this.initialized&&this.foaRenderer.setRotationMatrixFromCamera(e.matrix)},t.dispose=function(){this.initialized=!1,this.foaRenderer.setRenderingMode("bypass"),this.foaRenderer=null},e}(s.EventTarget),th=function(r){function e(e,t){var n;return(n=r.call(this,e,t)||this).handleVrDisplayActivate_=s.bind(a(n),n.handleVrDisplayActivate_),n.handleVrDisplayDeactivate_=s.bind(a(n),n.handleVrDisplayDeactivate_),n.handleVrDisplayPresentChange_=s.bind(a(n),n.handleVrDisplayPresentChange_),n.handleOrientationChange_=s.bind(a(n),n.handleOrientationChange_),o.addEventListener("orientationchange",n.handleOrientationChange_),o.addEventListener("vrdisplayactivate",n.handleVrDisplayActivate_),o.addEventListener("vrdisplaydeactivate",n.handleVrDisplayDeactivate_),o.addEventListener("vrdisplaypresentchange",n.handleVrDisplayPresentChange_),s.browser.IS_ANDROID&&n.on(e,"fullscreenchange",function(){e.isFullscreen()?n.hide():n.show()}),n}l(e,r);var t=e.prototype;return t.buildCSSClass=function(){return"vjs-button-vr "+r.prototype.buildCSSClass.call(this)},t.handleVrDisplayPresentChange_=function(){!this.player_.vr().vrDisplay.isPresenting&&this.active_&&this.handleVrDisplayDeactivate_(),this.player_.vr().vrDisplay.isPresenting&&!this.active_&&this.handleVrDisplayActivate_()},t.handleOrientationChange_=function(){this.active_&&s.browser.IS_IOS&&this.changeSize_()},t.changeSize_=function(){this.player_.width(o.innerWidth),this.player_.height(o.innerHeight),o.dispatchEvent(new o.Event("resize"))},t.handleVrDisplayActivate_=function(){s.browser.IS_IOS&&(this.oldWidth_=this.player_.currentWidth(),this.oldHeight_=this.player_.currentHeight(),this.player_.enterFullWindow(),this.changeSize_()),this.active_=!0},t.handleVrDisplayDeactivate_=function(){s.browser.IS_IOS&&(this.oldWidth_&&this.player_.width(this.oldWidth_),this.oldHeight_&&this.player_.height(this.oldHeight_),this.player_.exitFullWindow()),this.active_=!1},t.handleClick=function(){this.active_?o.dispatchEvent(new o.Event("vrdisplaydeactivate")):(!this.player_.hasStarted()&&s.browser.IS_ANDROID&&this.player_.play(),o.dispatchEvent(new o.Event("vrdisplayactivate")))},t.dispose=function(){r.prototype.dispose.call(this),o.removeEventListener("vrdisplayactivate",this.handleVrDisplayActivate_),o.removeEventListener("vrdisplaydeactivate",this.handleVrDisplayDeactivate_),o.removeEventListener("vrdisplaypresentchange",this.handleVrDisplayPresentChange_)},e}(s.getComponent("Button"));s.registerComponent("CardboardButton",th);var nh=function(e){function t(){return e.apply(this,arguments)||this}return l(t,e),t.prototype.buildCSSClass=function(){return"vjs-big-vr-play-button "+e.prototype.buildCSSClass.call(this)},t}(s.getComponent("BigPlayButton"));function rh(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return ih(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ih(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ih(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}s.registerComponent("BigVrPlayButton",nh);var ah={debug:!1,omnitone:!1,forceCardboard:!1,omnitoneOptions:{},projection:"AUTO",sphereDetail:32,disableTogglePlay:!1},oh={"web-vr-out-of-date":{headline:"360 is out of date",type:"360_OUT_OF_DATE",message:"Your browser supports 360 but not the latest version. See <a href='http://webvr.info'>http://webvr.info</a> for more info."},"web-vr-not-supported":{headline:"360 not supported on this device",type:"360_NOT_SUPPORTED",message:"Your browser does not support 360. See <a href='http://webvr.info'>http://webvr.info</a> for assistance."},"web-vr-hls-cors-not-supported":{headline:"360 HLS video not supported on this device",type:"360_NOT_SUPPORTED",message:"Your browser/device does not support HLS 360 video. See <a href='http://webvr.info'>http://webvr.info</a> for assistance."}},sh=s.getPlugin("plugin"),lh=s.getComponent("Component"),uh=function(i){function e(e,t){var n,r=s.mergeOptions(ah,t);return(n=i.call(this,e,r)||this).options_=r,n.player_=e,n.bigPlayButtonIndex_=e.children().indexOf(e.getChild("BigPlayButton"))||0,n.videojsErrorsSupport_=!!s.errors,n.videojsErrorsSupport_&&e.errors({errors:oh}),s.browser.IE_VERSION||!Zd?(n.player_.on("loadstart",function(){n.triggerError_({code:"web-vr-not-supported",dismiss:!1})}),a(n)):(n.polyfill_=new u({ROTATE_INSTRUCTIONS_DISABLED:!0}),n.polyfill_=new u,n.handleVrDisplayActivate_=s.bind(a(n),n.handleVrDisplayActivate_),n.handleVrDisplayDeactivate_=s.bind(a(n),n.handleVrDisplayDeactivate_),n.handleResize_=s.bind(a(n),n.handleResize_),n.animate_=s.bind(a(n),n.animate_),n.setProjection(n.options_.projection),n.on(e,"adstart",function(){return e.setTimeout(function(){e.ads&&e.ads.videoElementRecycled()?(n.log("video element recycled for this ad, reseting"),n.reset(),n.one(e,"playing",n.init)):n.log("video element not recycled for this ad, no need to reset")})},1),n.on(e,"loadedmetadata",n.init),n)}l(e,i);var t=e.prototype;return t.changeProjection_=function(e){var b=this;e=(e=Kd(e))||"NONE";var E=0,T=0,A=0;if(this.scene&&this.scene.remove(this.movieScreen),"AUTO"===e){if(this.player_.mediainfo&&this.player_.mediainfo.projection&&"AUTO"!==this.player_.mediainfo.projection){var t=Kd(this.player_.mediainfo.projection);return this.changeProjection_(t)}return this.changeProjection_("NONE")}if("360"===e)this.movieGeometry=new pl(256,this.options_.sphereDetail,this.options_.sphereDetail),this.movieMaterial=new Wi({map:this.videoTexture,overdraw:!0,side:Ae}),this.movieScreen=new Qi(this.movieGeometry,this.movieMaterial),this.movieScreen.position.set(E,T,A),this.movieScreen.scale.x=-1,this.movieScreen.quaternion.setFromAxisAngle({x:0,y:1,z:0},-Math.PI/2),this.scene.add(this.movieScreen);else if("360_LR"===e||"360_TB"===e){for(var n=new fl(256,this.options_.sphereDetail,this.options_.sphereDetail),r=n.faceVertexUvs[0],i=0;i<r.length;i++)for(var a=0;a<3;a++)"360_LR"===e?r[i][a].x*=.5:(r[i][a].y*=.5,r[i][a].y+=.5);this.movieGeometry=(new $r).fromGeometry(n),this.movieMaterial=new Wi({map:this.videoTexture,overdraw:!0,side:Ae}),this.movieScreen=new Qi(this.movieGeometry,this.movieMaterial),this.movieScreen.scale.x=-1,this.movieScreen.quaternion.setFromAxisAngle({x:0,y:1,z:0},-Math.PI/2),this.movieScreen.layers.set(1),this.scene.add(this.movieScreen),r=(n=new fl(256,this.options_.sphereDetail,this.options_.sphereDetail)).faceVertexUvs[0];for(var o=0;o<r.length;o++)for(var s=0;s<3;s++)"360_LR"===e?(r[o][s].x*=.5,r[o][s].x+=.5):r[o][s].y*=.5;this.movieGeometry=(new $r).fromGeometry(n),this.movieMaterial=new Wi({map:this.videoTexture,overdraw:!0,side:Ae}),this.movieScreen=new Qi(this.movieGeometry,this.movieMaterial),this.movieScreen.scale.x=-1,this.movieScreen.quaternion.setFromAxisAngle({x:0,y:1,z:0},-Math.PI/2),this.movieScreen.layers.set(2),this.scene.add(this.movieScreen)}else if("360_CUBE"===e){this.movieGeometry=new ei(256,256,256),this.movieMaterial=new Wi({map:this.videoTexture,overdraw:!0,side:Ae});var l=[new zt(0,.5),new zt(.333,.5),new zt(.333,1),new zt(0,1)],u=[new zt(.333,.5),new zt(.666,.5),new zt(.666,1),new zt(.333,1)],c=[new zt(.666,.5),new zt(1,.5),new zt(1,1),new zt(.666,1)],d=[new zt(0,0),new zt(.333,0),new zt(.333,.5),new zt(0,.5)],h=[new zt(.333,0),new zt(.666,0),new zt(.666,.5),new zt(.333,.5)],f=[new zt(.666,0),new zt(1,0),new zt(1,.5),new zt(.666,.5)];this.movieGeometry.faceVertexUvs[0]=[],this.movieGeometry.faceVertexUvs[0][0]=[u[2],u[1],u[3]],this.movieGeometry.faceVertexUvs[0][1]=[u[1],u[0],u[3]],this.movieGeometry.faceVertexUvs[0][2]=[l[2],l[1],l[3]],this.movieGeometry.faceVertexUvs[0][3]=[l[1],l[0],l[3]],this.movieGeometry.faceVertexUvs[0][4]=[c[2],c[1],c[3]],this.movieGeometry.faceVertexUvs[0][5]=[c[1],c[0],c[3]],this.movieGeometry.faceVertexUvs[0][6]=[d[2],d[1],d[3]],this.movieGeometry.faceVertexUvs[0][7]=[d[1],d[0],d[3]],this.movieGeometry.faceVertexUvs[0][8]=[h[2],h[1],h[3]],this.movieGeometry.faceVertexUvs[0][9]=[h[1],h[0],h[3]],this.movieGeometry.faceVertexUvs[0][10]=[f[2],f[1],f[3]],this.movieGeometry.faceVertexUvs[0][11]=[f[1],f[0],f[3]],this.movieScreen=new Qi(this.movieGeometry,this.movieMaterial),this.movieScreen.position.set(E,T,A),this.movieScreen.rotation.y=-Math.PI,this.scene.add(this.movieScreen)}else if("180"===e||"180_LR"===e||"180_MONO"===e){var p=new fl(256,this.options_.sphereDetail,this.options_.sphereDetail,Math.PI,Math.PI);p.scale(-1,1,1);var m=p.faceVertexUvs[0];if("180_MONO"!==e)for(var g=0;g<m.length;g++)for(var v=0;v<3;v++)m[g][v].x*=.5;this.movieGeometry=(new $r).fromGeometry(p),this.movieMaterial=new Wi({map:this.videoTexture,overdraw:!0}),this.movieScreen=new Qi(this.movieGeometry,this.movieMaterial),this.movieScreen.layers.set(1),this.scene.add(this.movieScreen),(p=new fl(256,this.options_.sphereDetail,this.options_.sphereDetail,Math.PI,Math.PI)).scale(-1,1,1),m=p.faceVertexUvs[0];for(var y=0;y<m.length;y++)for(var _=0;_<3;_++)m[y][_].x*=.5,m[y][_].x+=.5;this.movieGeometry=(new $r).fromGeometry(p),this.movieMaterial=new Wi({map:this.videoTexture,overdraw:!0}),this.movieScreen=new Qi(this.movieGeometry,this.movieMaterial),this.movieScreen.layers.set(2),this.scene.add(this.movieScreen)}else if("EAC"===e||"EAC_LR"===e){var w=function(e,t){b.movieGeometry=new ei(256,256,256),b.movieMaterial=new qi({overdraw:!0,side:Ae,uniforms:{mapped:{value:b.videoTexture},mapMatrix:{value:e},contCorrect:{value:2},faceWH:{value:new zt(1/3,.5).applyMatrix3(t)},vidWH:{value:new zt(b.videoTexture.image.videoWidth,b.videoTexture.image.videoHeight).applyMatrix3(t)}},vertexShader:"\nvarying vec2 vUv;\nuniform mat3 mapMatrix;\n\nvoid main() {\n  vUv = (mapMatrix * vec3(uv, 1.)).xy;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.);\n}",fragmentShader:"\nvarying vec2 vUv;\nuniform sampler2D mapped;\nuniform vec2 faceWH;\nuniform vec2 vidWH;\nuniform float contCorrect;\n\nconst float PI = 3.1415926535897932384626433832795;\n\nvoid main() {\n  vec2 corner = vUv - mod(vUv, faceWH) + vec2(0, contCorrect / vidWH.y);\n\n  vec2 faceWHadj = faceWH - vec2(0, contCorrect * 2. / vidWH.y);\n\n  vec2 p = (vUv - corner) / faceWHadj - .5;\n  vec2 q = 2. / PI * atan(2. * p) + .5;\n\n  vec2 eUv = corner + q * faceWHadj;\n\n  gl_FragColor = texture2D(mapped, eUv);\n}"});for(var n=[new zt(0,.5),new zt(1/3,.5),new zt(1/3,1),new zt(0,1)],r=[new zt(1/3,.5),new zt(2/3,.5),new zt(2/3,1),new zt(1/3,1)],i=[new zt(2/3,.5),new zt(1,.5),new zt(1,1),new zt(2/3,1)],a=[new zt(1/3,0),new zt(1/3,.5),new zt(0,.5),new zt(0,0)],o=[new zt(1/3,.5),new zt(1/3,0),new zt(2/3,0),new zt(2/3,.5)],s=[new zt(1,0),new zt(1,.5),new zt(2/3,.5),new zt(2/3,0)],l=0,u=[n,r,i,a,o,s];l<u.length;l++){for(var c,d=u[l],h=b.videoTexture.image.videoHeight,f=1,p=0,m=rh(d);!(c=m()).done;){var g=c.value;g.y<f&&(f=g.y),g.y>p&&(p=g.y)}for(var v,y=rh(d);!(v=y()).done;){var _=v.value;Math.abs(_.y-f)<Number.EPSILON&&(_.y+=2/h),Math.abs(_.y-p)<Number.EPSILON&&(_.y-=2/h),_.x=_.x/h*(h-4)+2/h}}return b.movieGeometry.faceVertexUvs[0]=[],b.movieGeometry.faceVertexUvs[0][0]=[n[2],n[1],n[3]],b.movieGeometry.faceVertexUvs[0][1]=[n[1],n[0],n[3]],b.movieGeometry.faceVertexUvs[0][2]=[i[2],i[1],i[3]],b.movieGeometry.faceVertexUvs[0][3]=[i[1],i[0],i[3]],b.movieGeometry.faceVertexUvs[0][4]=[s[2],s[1],s[3]],b.movieGeometry.faceVertexUvs[0][5]=[s[1],s[0],s[3]],b.movieGeometry.faceVertexUvs[0][6]=[a[2],a[1],a[3]],b.movieGeometry.faceVertexUvs[0][7]=[a[1],a[0],a[3]],b.movieGeometry.faceVertexUvs[0][8]=[r[2],r[1],r[3]],b.movieGeometry.faceVertexUvs[0][9]=[r[1],r[0],r[3]],b.movieGeometry.faceVertexUvs[0][10]=[o[2],o[1],o[3]],b.movieGeometry.faceVertexUvs[0][11]=[o[1],o[0],o[3]],b.movieScreen=new Qi(b.movieGeometry,b.movieMaterial),b.movieScreen.position.set(E,T,A),b.movieScreen.rotation.y=-Math.PI,b.movieScreen};if("EAC"===e)this.scene.add(w(new Kt,new Kt));else{var S=(new Kt).set(0,.5,0,1,0,0,0,0,1);w((new Kt).set(0,-.5,.5,1,0,0,0,0,1),S),this.movieScreen.layers.set(1),this.scene.add(this.movieScreen),w((new Kt).set(0,-.5,1,1,0,0,0,0,1),S),this.movieScreen.layers.set(2),this.scene.add(this.movieScreen)}}this.currentProjection_=e},t.triggerError_=function(e){if(this.videojsErrorsSupport_)this.player_.error(e);else{var t=r.createElement("div");t.innerHTML=oh[e.code].message;var n=t.textContent||t.innerText||"";this.player_.error({code:e.code,message:n})}},t.log=function(){if(this.options_.debug){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach(function(e){s.log("VR: ",e)})}},t.handleVrDisplayActivate_=function(){var r=this;this.vrDisplay&&this.vrDisplay.requestPresent([{source:this.renderedCanvas}]).then(function(){if(r.vrDisplay.cardboardUI_&&s.browser.IS_IOS){var n=[],e=function(e){for(var t=0;t<e.touches.length;t++)n.push(e.touches[t])},t=function(){n.length&&(n.forEach(function(e){var t=new o.MouseEvent("click",{screenX:e.screenX,screenY:e.screenY,clientX:e.clientX,clientY:e.clientY});r.renderedCanvas.dispatchEvent(t)}),n=[])};r.renderedCanvas.addEventListener("touchstart",e),r.renderedCanvas.addEventListener("touchend",t),r.iosRevertTouchToClick_=function(){r.renderedCanvas.removeEventListener("touchstart",e),r.renderedCanvas.removeEventListener("touchend",t),r.iosRevertTouchToClick_=null}}})},t.handleVrDisplayDeactivate_=function(){this.vrDisplay&&this.vrDisplay.isPresenting&&(this.iosRevertTouchToClick_&&this.iosRevertTouchToClick_(),this.vrDisplay.exitPresent())},t.requestAnimationFrame=function(e){return this.vrDisplay?this.vrDisplay.requestAnimationFrame(e):this.player_.requestAnimationFrame(e)},t.cancelAnimationFrame=function(e){return this.vrDisplay?this.vrDisplay.cancelAnimationFrame(e):this.player_.cancelAnimationFrame(e)},t.togglePlay_=function(){this.player_.paused()?this.player_.play():this.player_.pause()},t.animate_=function(){if(this.initialized_){if(this.getVideoEl_().readyState===this.getVideoEl_().HAVE_ENOUGH_DATA&&this.videoTexture&&(this.videoTexture.needsUpdate=!0),this.controls3d.update(),this.omniController&&this.omniController.update(this.camera),this.effect.render(this.scene,this.camera),o.navigator.getGamepads)for(var e=o.navigator.getGamepads(),t=0;t<e.length;++t){var n=e[t];if(n&&n.timestamp&&n.timestamp!==this.prevTimestamps_[t])for(var r=0;r<n.buttons.length;++r)if(n.buttons[r].pressed){this.togglePlay_(),this.prevTimestamps_[t]=n.timestamp;break}}this.camera.getWorldDirection(this.cameraVector),this.animationFrameId_=this.requestAnimationFrame(this.animate_)}},t.handleResize_=function(){var e=this.player_.currentWidth(),t=this.player_.currentHeight();this.effect.setSize(e,t,!1),this.camera.aspect=e/t,this.camera.updateProjectionMatrix()},t.setProjection=function(e){Kd(e)?(this.currentProjection_=e,this.defaultProjection_=e):s.log.error("videojs-vr: please pass a valid projection "+Jd.join(", "))},t.init=function(){var r=this;if(this.reset(),this.camera=new Ko(75,this.player_.currentWidth()/this.player_.currentHeight(),1,1e3),this.cameraVector=new Yt,"360_LR"!==this.currentProjection_&&"360_TB"!==this.currentProjection_&&"180"!==this.currentProjection_&&"180_LR"!==this.currentProjection_&&"180_MONO"!==this.currentProjection_&&"EAC_LR"!==this.currentProjection_||this.camera.layers.enable(1),this.scene=new ts,this.videoTexture=new ms(this.getVideoEl_()),this.videoTexture.generateMipmaps=!1,this.videoTexture.minFilter=Ge,this.videoTexture.magFilter=Ge,this.videoTexture.format=it,this.changeProjection_(this.currentProjection_),"NONE"===this.currentProjection_)return this.log("Projection is NONE, dont init"),void this.reset();this.player_.removeChild("BigPlayButton"),this.player_.addChild("BigVrPlayButton",{},this.bigPlayButtonIndex_),this.player_.bigPlayButton=this.player_.getChild("BigVrPlayButton"),(this.options_.forceCardboard||s.browser.IS_ANDROID||s.browser.IS_IOS)&&this.addCardboardButton_(),s.browser.IS_IOS&&this.player_.controlBar&&this.player_.controlBar.fullscreenToggle&&this.player_.controlBar.fullscreenToggle.hide(),this.camera.position.set(0,0,0),this.renderer=new Jo({devicePixelRatio:o.devicePixelRatio,alpha:!1,clearColor:16777215,antialias:!0});var i=this.renderer.getContext("webgl"),a=i.texImage2D;i.texImage2D=function(){try{for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return a.apply(i,t)}catch(e){throw r.reset(),r.player_.pause(),r.triggerError_({code:"web-vr-hls-cors-not-supported",dismiss:!1}),new Error(e)}},this.renderer.setSize(this.player_.currentWidth(),this.player_.currentHeight(),!1),this.effect=new Wd(this.renderer),this.effect.setSize(this.player_.currentWidth(),this.player_.currentHeight(),!1),this.vrDisplay=null,this.prevTimestamps_=[],this.renderedCanvas=this.renderer.domElement,this.renderedCanvas.setAttribute("style","width: 100%; height: 100%; position: absolute; top:0;");var e=this.getVideoEl_().style;if(this.player_.el().insertBefore(this.renderedCanvas,this.player_.el().firstChild),e.zIndex="-1",e.opacity="0",o.navigator.getVRDisplays?(this.log("is supported, getting vr displays"),o.navigator.getVRDisplays().then(function(e){if(0<e.length&&(r.log("Displays found",e),r.vrDisplay=e[0],r.vrDisplay.isPolyfilled||(r.log("Real HMD found using VRControls",r.vrDisplay),r.addCardboardButton_(),r.controls3d=new zd(r.camera))),!r.controls3d){r.log("no HMD found Using Orbit & Orientation Controls");var t={camera:r.camera,canvas:r.renderedCanvas,halfView:0===r.currentProjection_.indexOf("180"),orientation:s.browser.IS_IOS||s.browser.IS_ANDROID||!1};!1===r.options_.motionControls&&(t.orientation=!1),r.controls3d=new Qd(t),r.canvasPlayerControls=new $d(r.player_,r.renderedCanvas,r.options_)}r.animationFrameId_=r.requestAnimationFrame(r.animate_)})):o.navigator.getVRDevices?this.triggerError_({code:"web-vr-out-of-date",dismiss:!1}):this.triggerError_({code:"web-vr-not-supported",dismiss:!1}),this.options_.omnitone){var t=yc();this.omniController=new eh(t,this.options_.omnitone,this.getVideoEl_(),this.options_.omnitoneOptions),this.omniController.one("audiocontext-suspended",function(){r.player.pause(),r.player.one("playing",function(){t.resume()})})}this.on(this.player_,"fullscreenchange",this.handleResize_),o.addEventListener("vrdisplaypresentchange",this.handleResize_,!0),o.addEventListener("resize",this.handleResize_,!0),o.addEventListener("vrdisplayactivate",this.handleVrDisplayActivate_,!0),o.addEventListener("vrdisplaydeactivate",this.handleVrDisplayDeactivate_,!0),this.initialized_=!0,this.trigger("initialized")},t.addCardboardButton_=function(){this.player_.controlBar.getChild("CardboardButton")||this.player_.controlBar.addChild("CardboardButton",{})},t.getVideoEl_=function(){return this.player_.el().getElementsByTagName("video")[0]},t.reset=function(){if(this.initialized_){this.omniController&&(this.omniController.off("audiocontext-suspended"),this.omniController.dispose(),this.omniController=void 0),this.controls3d&&(this.controls3d.dispose(),this.controls3d=null),this.canvasPlayerControls&&(this.canvasPlayerControls.dispose(),this.canvasPlayerControls=null),this.effect&&(this.effect.dispose(),this.effect=null),o.removeEventListener("resize",this.handleResize_,!0),o.removeEventListener("vrdisplaypresentchange",this.handleResize_,!0),o.removeEventListener("vrdisplayactivate",this.handleVrDisplayActivate_,!0),o.removeEventListener("vrdisplaydeactivate",this.handleVrDisplayDeactivate_,!0),this.player_.getChild("BigPlayButton")||this.player_.addChild("BigPlayButton",{},this.bigPlayButtonIndex_),this.player_.getChild("BigVrPlayButton")&&this.player_.removeChild("BigVrPlayButton"),this.player_.getChild("CardboardButton")&&this.player_.controlBar.removeChild("CardboardButton"),s.browser.IS_IOS&&this.player_.controlBar&&this.player_.controlBar.fullscreenToggle&&this.player_.controlBar.fullscreenToggle.show();var e=this.getVideoEl_().style;e.zIndex="",e.opacity="",this.currentProjection_=this.defaultProjection_,this.iosRevertTouchToClick_&&this.iosRevertTouchToClick_(),this.renderedCanvas&&this.renderedCanvas.parentNode.removeChild(this.renderedCanvas),this.animationFrameId_&&this.cancelAnimationFrame(this.animationFrameId_),this.initialized_=!1}},t.dispose=function(){i.prototype.dispose.call(this),this.reset()},t.polyfillVersion=function(){return u.version},e}(sh);return uh.prototype.setTimeout=lh.prototype.setTimeout,uh.prototype.clearTimeout=lh.prototype.clearTimeout,uh.VERSION="1.8.0",s.registerPlugin("vr",uh),uh}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("video.js"),require("global/window"),require("global/document")):"function"==typeof define&&define.amd?define(["video.js","global/window","global/document"],t):(e=e||self).videojsContribAds=t(e.videojs,e.window,e.document)}(this,function(f,u,o){"use strict";f=f&&f.hasOwnProperty("default")?f.default:f,u=u&&u.hasOwnProperty("default")?u.default:u,o=o&&o.hasOwnProperty("default")?o.default:o;function r(e,t){t.isImmediatePropagationStopped=function(){return!0},t.cancelBubble=!0,t.isPropagationStopped=function(){return!0}}function n(e,t,n){r(0,n),e.trigger({type:t+n.type,originalEvent:n})}function a(e){"playing"===e.type?function(e,t){e.ads.isInAdMode()&&(e.ads.isContentResuming()?e.ads._contentEnding&&n(e,"content",t):n(e,"ad",t))}(this,e):"ended"===e.type?function(e,t){e.ads.isInAdMode()?e.ads.isContentResuming()?(r(0,t),e.trigger("resumeended")):n(e,"ad",t):e.ads._contentHasEnded||e.ads.stitchedAds()||(n(e,"content",t),e.trigger("readyforpostroll"))}(this,e):"loadstart"===e.type||"loadeddata"===e.type||"loadedmetadata"===e.type?function(e,t){if(!("loadstart"===t.type&&!e.ads._hasThereBeenALoadStartDuringPlayerLife||"loadeddata"===t.type&&!e.ads._hasThereBeenALoadedData||"loadedmetadata"===t.type&&!e.ads._hasThereBeenALoadedMetaData))if(e.ads.inAdBreak())n(e,"ad",t);else{if(e.currentSrc()!==e.ads.contentSrc)return;n(e,"content",t)}}(this,e):"play"===e.type?function(e,t){e.ads.inAdBreak()?n(e,"ad",t):e.ads.isContentResuming()&&n(e,"content",t)}(this,e):this.ads.isInAdMode()&&(this.ads.isContentResuming()?n(this,"content",e):n(this,"ad",e))}function s(){!function(){if(f.dom.isInFrame()&&"function"!=typeof u.__tcfapi){for(var o,e=u,s={};e;){try{if(e.frames.__tcfapiLocator){o=e;break}}catch(e){}if(e===u.top)break;e=e.parent}if(!o)return;u.__tcfapi=function(e,t,n,r){var i=Math.random()+"",a={__tcfapiCall:{command:e,parameter:r,version:t,callId:i}};s[i]=n,o.postMessage(a,"*")},u.addEventListener("message",function(e){var t={};try{t="string"==typeof e.data?JSON.parse(e.data):e.data}catch(e){}var n=t.__tcfapiReturn;n&&"function"==typeof s[n.callId]&&(s[n.callId](n.returnValue,n.success),s[n.callId]=null)},!1)}}(),"function"==typeof u.__tcfapi&&u.__tcfapi("addEventListener",2,function(e,t){t&&(h=e)})}function c(e,t){return t?encodeURIComponent(e):e}function d(e,t,n){if(e&&e[n])for(var r=e[n],i=Object.keys(r),a=0;a<i.length;a++){t["{mediainfo."+n+"."+i[a]+"}"]=r[i[a]]}}var h={};var l={processMetadataTracks:function(t,n){for(var e=t.textTracks(),r=function(e){"metadata"===e.kind&&(t.ads.cueTextTracks.setMetadataTrackMode(e),n(t,e))},i=0;i<e.length;i++)r(e[i]);e.addEventListener("addtrack",function(e){r(e.track)})},setMetadataTrackMode:function(e){},getSupportedAdCue:function(e,t){return t},isSupportedAdCue:function(e,t){return!0},getCueId:function(e,t){return t.id}};function p(){!1!==this.ads._shouldBlockPlay&&(this.paused()||(this.ads.debug("Playback was canceled by cancelContentPlay"),this.pause()),this.ads._cancelledPlay=!0)}l.processAdTrack=function(e,t,n,r){e.ads.includedCues={};for(var i=0;i<t.length;i++){var a=t[i],o=this.getSupportedAdCue(e,a);if(!this.isSupportedAdCue(e,a))return void f.log.warn("Skipping as this is not a supported ad cue.",a);var s=this.getCueId(e,a),l=a.startTime;if(d=e,void 0!==(h=s)&&d.ads.includedCues[h])return void f.log("Skipping ad already seen with ID "+s);r&&r(e,o,s,l),n(e,o,s,l),u=e,void 0!==(c=s)&&""!==c&&(u.ads.includedCues[c]=!0)}var u,c,d,h};var e={},t=f;e.isMiddlewareMediatorSupported=function(){return!t.browser.IS_IOS&&!t.browser.IS_ANDROID&&!!(t.use&&t.middleware&&t.middleware.TERMINATOR)},e.playMiddleware=function(n){return{setSource:function(e,t){t(null,e)},callPlay:function(){if(n.ads&&!0===n.ads._shouldBlockPlay)return n.ads.debug("Using playMiddleware to block content playback"),n.ads._playBlocked=!0,t.middleware.TERMINATOR},play:function(e,t){n.ads&&n.ads._playBlocked&&e?(n.ads.debug("Play call to Tech was terminated."),n.trigger("play"),n.addClass("vjs-has-started"),n.ads._playBlocked=!1):t&&t.catch&&t.catch(function(e){"NotAllowedError"!==e.name||f.browser.IS_SAFARI||n.trigger("pause")})}}},e.testHook=function(e){t=e};var i=e.playMiddleware,m=e.isMiddlewareMediatorSupported;var g=function(){function n(){}return n.getState=function(e){if(e)return n.states_&&n.states_[e]?n.states_[e]:void 0},n.registerState=function(e,t){if("string"!=typeof e||!e)throw new Error('Illegal state name, "'+e+'"; must be a non-empty string.');return n.states_||(n.states_={}),n.states_[e]=t},n}(),v=function(){function e(e){this.player=e}e._getName=function(){return"Anonymous State"};var t=e.prototype;return t.transitionTo=function(e){var t=this.player;this.cleanup(t);var n=new e(t);t.ads._state=n,t.ads.debug(this.constructor._getName()+" -> "+n.constructor._getName());for(var r=arguments.length,i=new Array(1<r?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];n.init.apply(n,[t].concat(i))},t.init=function(){},t.cleanup=function(){},t.onPlay=function(){},t.onPlaying=function(){},t.onEnded=function(){},t.onAdEnded=function(){},t.onAdsReady=function(){f.log.warn("Unexpected adsready event")},t.onAdsError=function(){},t.onAdsCanceled=function(){},t.onAdTimeout=function(){},t.onAdStarted=function(){},t.onContentChanged=function(){},t.onContentResumed=function(){},t.onReadyForPostroll=function(){f.log.warn("Unexpected readyforpostroll event")},t.onNoPreroll=function(){},t.onNoPostroll=function(){},t.startLinearAdMode=function(){f.log.warn("Unexpected startLinearAdMode invocation (State via "+this.constructor._getName()+")")},t.endLinearAdMode=function(){f.log.warn("Unexpected endLinearAdMode invocation (State via "+this.constructor._getName()+")")},t.skipLinearAdMode=function(){f.log.warn("Unexpected skipLinearAdMode invocation (State via "+this.constructor._getName()+")")},t.isAdState=function(){throw new Error("isAdState unimplemented for "+this.constructor._getName())},t.isWaitingForAdBreak=function(){return!1},t.isContentResuming=function(){return!1},t.inAdBreak=function(){return!1},t.handleEvent=function(e){var t=this.player;"play"===e?this.onPlay(t):"adsready"===e?this.onAdsReady(t):"adserror"===e?this.onAdsError(t):"adscanceled"===e?this.onAdsCanceled(t):"adtimeout"===e?this.onAdTimeout(t):"ads-ad-started"===e?this.onAdStarted(t):"contentchanged"===e?this.onContentChanged(t):"contentresumed"===e?this.onContentResumed(t):"readyforpostroll"===e?this.onReadyForPostroll(t):"playing"===e?this.onPlaying(t):"ended"===e?this.onEnded(t):"nopreroll"===e?this.onNoPreroll(t):"nopostroll"===e?this.onNoPostroll(t):"adended"===e&&this.onAdEnded(t)},e}();function y(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}g.registerState("State",v);var _=function(n){function e(e){var t;return(t=n.call(this,e)||this).contentResuming=!1,t.waitingForAdBreak=!1,t}y(e,n);var t=e.prototype;return t.isAdState=function(){return!0},t.onPlaying=function(){var e=g.getState("ContentPlayback");this.contentResuming&&this.transitionTo(e)},t.onContentResumed=function(){var e=g.getState("ContentPlayback");this.contentResuming&&this.transitionTo(e)},t.isWaitingForAdBreak=function(){return this.waitingForAdBreak},t.isContentResuming=function(){return this.contentResuming},t.inAdBreak=function(){return!0===this.player.ads._inLinearAdMode},e}(v);g.registerState("AdState",_);var b=function(e){function t(){return e.apply(this,arguments)||this}y(t,e);var n=t.prototype;return n.isAdState=function(){return!1},n.onContentChanged=function(e){var t=g.getState("BeforePreroll"),n=g.getState("Preroll");e.ads.debug("Received contentchanged event (ContentState)"),e.paused()?this.transitionTo(t):(this.transitionTo(n,!1),e.pause(),e.ads._pausedOnContentupdate=!0)},t}(v);g.registerState("ContentState",b);var E,T=function(e){function t(){return e.apply(this,arguments)||this}y(t,e),t._getName=function(){return"AdsDone"};var n=t.prototype;return n.init=function(e){e.ads._contentHasEnded=!0,e.trigger("ended")},n.startLinearAdMode=function(){f.log.warn("Unexpected startLinearAdMode invocation (AdsDone)")},t}(g.getState("ContentState"));function A(r,e){var i=r.ads.snapshot;if(void 0===e&&(e=function(){}),!0===r.ads.disableNextSnapshotRestore)return r.ads.disableNextSnapshotRestore=!1,delete r.ads.snapshot,void e();function t(){for(var e=0;e<u.length;e++)(o=u[e]).track.mode=o.mode}function n(){var e;if(f.browser.IS_IOS&&r.ads.isLive(r)){if(i.currentTime<0&&(e=0<r.seekable().length?r.seekable().end(0)+i.currentTime:r.currentTime(),r.currentTime(e)),r.paused()){var t=r.play();t&&t.catch&&t.catch(function(e){f.log.warn("Play promise rejected in IOS snapshot resume",e)})}}else if(i.ended)r.currentTime(r.duration());else{r.currentTime(i.currentTime);var n=r.play();n&&n.catch&&n.catch(function(e){f.log.warn("Play promise rejected in snapshot resume",e)})}r.ads.shouldRemoveAutoplay_&&(r.autoplay(!1),r.ads.shouldRemoveAutoplay_=!1)}function a(){if(r.off("contentcanplay",a),E&&r.clearTimeout(E),1<(s=r.el().querySelector(".vjs-tech")).readyState)return n();if(void 0===s.seekable)return n();if(0<s.seekable.length)return n();if(l--)r.setTimeout(a,50);else try{n()}catch(e){f.log.warn("Failed to resume the content after an advertisement",e)}}var o,s=r.$(".vjs-tech"),l=20,u=i.suppressedTracks;if("style"in i&&s.setAttribute("style",i.style||""),r.ads.videoElementRecycled())r.one("resumeended",function(){delete r.ads.snapshot,e()}),r.one("contentloadedmetadata",t),f.browser.IS_IOS&&!r.autoplay()&&(r.autoplay(!0),r.ads.shouldRemoveAutoplay_=!0),r.src(i.sources),r.one("contentcanplay",a),E=r.setTimeout(a,2e3);else{if(t(),!r.ended()){var c=r.play();c&&c.catch&&c.catch(function(e){f.log.warn("Play promise rejected in snapshot restore",e)})}delete r.ads.snapshot,e()}}g.registerState("AdsDone",T);var w={start:function(e){e.ads.debug("Starting ad break"),e.ads._inLinearAdMode=!0,e.trigger("adstart"),e.ads.shouldTakeSnapshots()&&(e.ads.snapshot=function(e){var t;t=f.browser.IS_IOS&&e.ads.isLive(e)&&0<e.seekable().length?e.currentTime()-e.seekable().end(0):e.currentTime();var n=e.$(".vjs-tech"),r=e.textTracks?e.textTracks():[],i=[],a={ended:e.ended(),currentSrc:e.currentSrc(),sources:e.currentSources(),src:e.tech_.src(),currentTime:t,type:e.currentType()};n&&(a.style=n.getAttribute("style"));for(var o=0;o<r.length;o++){var s=r[o];i.push({track:s,mode:s.mode}),s.mode="disabled"}return a.suppressedTracks=i,a}(e)),e.ads.shouldPlayContentBehindAd(e)&&(e.ads.preAdVolume_=e.volume(),e.volume(0)),e.addClass("vjs-ad-playing"),e.hasClass("vjs-live")&&e.removeClass("vjs-live"),e.ads.removeNativePoster()},end:function(e,t){e.ads.debug("Ending ad break"),void 0===t&&(t=function(){}),e.ads.adType=null,e.ads._inLinearAdMode=!1,e.trigger("adend"),e.removeClass("vjs-ad-playing"),e.ads.isLive(e)&&e.addClass("vjs-live"),e.ads.shouldTakeSnapshots()?A(e,t):(e.volume(e.ads.preAdVolume_),t())}},S=function(e){function t(){return e.apply(this,arguments)||this}y(t,e),t._getName=function(){return"Preroll"};var n=t.prototype;return n.init=function(e,t,n){if(this.waitingForAdBreak=!0,e.addClass("vjs-ad-loading"),n||e.ads.nopreroll_)return this.resumeAfterNoPreroll(e);var r=e.ads.settings.timeout;"number"==typeof e.ads.settings.prerollTimeout&&(r=e.ads.settings.prerollTimeout),this._timeout=e.setTimeout(function(){e.trigger("adtimeout")},r),t?this.handleAdsReady():this.adsReady=!1},n.onAdsReady=function(e){e.ads.inAdBreak()?f.log.warn("Unexpected adsready event (Preroll)"):(e.ads.debug("Received adsready event (Preroll)"),this.handleAdsReady())},n.handleAdsReady=function(){this.adsReady=!0,this.readyForPreroll()},n.afterLoadStart=function(e){var t=this.player;t.ads._hasThereBeenALoadStartDuringPlayerLife?e():(t.ads.debug("Waiting for loadstart..."),t.one("loadstart",function(){t.ads.debug("Received loadstart event"),e()}))},n.noPreroll=function(){var e=this;this.afterLoadStart(function(){e.player.ads.debug("Skipping prerolls due to nopreroll event (Preroll)"),e.resumeAfterNoPreroll(e.player)})},n.readyForPreroll=function(){var e=this.player;this.afterLoadStart(function(){e.ads.debug("Triggered readyforpreroll event (Preroll)"),e.trigger("readyforpreroll")})},n.onAdsCanceled=function(e){var t=this;e.ads.debug("adscanceled (Preroll)"),this.afterLoadStart(function(){t.resumeAfterNoPreroll(e)})},n.onAdsError=function(e){var t=this;f.log("adserror (Preroll)"),this.inAdBreak()?e.ads.endLinearAdMode():this.afterLoadStart(function(){t.resumeAfterNoPreroll(e)})},n.startLinearAdMode=function(){var e=this.player;!this.adsReady||e.ads.inAdBreak()||this.isContentResuming()?f.log.warn("Unexpected startLinearAdMode invocation (Preroll)"):(this.clearTimeout(e),e.ads.adType="preroll",this.waitingForAdBreak=!1,w.start(e),e.ads._shouldBlockPlay=!1)},n.onAdStarted=function(e){e.removeClass("vjs-ad-loading")},n.endLinearAdMode=function(){var e=this.player;this.inAdBreak()&&(e.removeClass("vjs-ad-loading"),e.addClass("vjs-ad-content-resuming"),this.contentResuming=!0,w.end(e))},n.skipLinearAdMode=function(){var e=this,t=this.player;t.ads.inAdBreak()||this.isContentResuming()?f.log.warn("Unexpected skipLinearAdMode invocation"):this.afterLoadStart(function(){t.trigger("adskip"),t.ads.debug("skipLinearAdMode (Preroll)"),e.resumeAfterNoPreroll(t)})},n.onAdTimeout=function(e){var t=this;this.afterLoadStart(function(){e.ads.debug("adtimeout (Preroll)"),t.resumeAfterNoPreroll(e)})},n.onNoPreroll=function(e){e.ads.inAdBreak()||this.isContentResuming()?f.log.warn("Unexpected nopreroll event (Preroll)"):this.noPreroll()},n.resumeAfterNoPreroll=function(e){if(this.contentResuming=!0,e.ads._shouldBlockPlay=!1,this.cleanupPartial(e),e.ads._playRequested||e.ads._pausedOnContentupdate)if(e.paused()){e.ads.debug("resumeAfterNoPreroll: attempting to resume playback (Preroll)");var t=e.play();t&&t.then&&t.then(null,function(e){})}else e.ads.debug("resumeAfterNoPreroll: already playing (Preroll)"),e.trigger("play"),e.trigger("playing")},n.cleanup=function(e){e.ads._hasThereBeenALoadStartDuringPlayerLife||f.log.warn("Leaving Preroll state before loadstart event can cause issues."),this.cleanupPartial(e)},n.cleanupPartial=function(e){e.removeClass("vjs-ad-loading"),e.removeClass("vjs-ad-content-resuming"),this.clearTimeout(e)},n.clearTimeout=function(e){e.clearTimeout(this._timeout),this._timeout=null},t}(g.getState("AdState"));g.registerState("Preroll",S);var C=function(e){function t(){return e.apply(this,arguments)||this}y(t,e),t._getName=function(){return"BeforePreroll"};var n=t.prototype;return n.init=function(e){this.adsReady=!1,this.shouldResumeToContent=!1,e.ads._shouldBlockPlay=!e.ads.settings.allowVjsAutoplay||!e.autoplay()},n.onAdsReady=function(e){e.ads.debug("Received adsready event (BeforePreroll)"),this.adsReady=!0},n.onPlay=function(e){var t=g.getState("Preroll");e.ads.debug("Received play event (BeforePreroll)"),this.transitionTo(t,this.adsReady,this.shouldResumeToContent)},n.onAdsCanceled=function(e){e.ads.debug("adscanceled (BeforePreroll)"),this.shouldResumeToContent=!0},n.onAdsError=function(){this.player.ads.debug("adserror (BeforePreroll)"),this.shouldResumeToContent=!0},n.onNoPreroll=function(){this.player.ads.debug("Skipping prerolls due to nopreroll event (BeforePreroll)"),this.shouldResumeToContent=!0},n.skipLinearAdMode=function(){var e=this.player;e.trigger("adskip"),e.ads.debug("skipLinearAdMode (BeforePreroll)"),this.shouldResumeToContent=!0},n.onContentChanged=function(){this.init(this.player)},t}(g.getState("ContentState"));g.registerState("BeforePreroll",C);var x=function(e){function t(){return e.apply(this,arguments)||this}y(t,e),t._getName=function(){return"Midroll"};var n=t.prototype;return n.init=function(e){e.ads.adType="midroll",w.start(e),e.addClass("vjs-ad-loading")},n.onAdStarted=function(e){e.removeClass("vjs-ad-loading")},n.endLinearAdMode=function(){var e=this.player;this.inAdBreak()&&(this.contentResuming=!0,e.addClass("vjs-ad-content-resuming"),e.removeClass("vjs-ad-loading"),w.end(e))},n.onAdsError=function(e){this.inAdBreak()&&e.ads.endLinearAdMode()},n.cleanup=function(e){e.removeClass("vjs-ad-loading"),e.removeClass("vjs-ad-content-resuming")},t}(g.getState("AdState"));g.registerState("Midroll",x);var M=function(e){function t(){return e.apply(this,arguments)||this}y(t,e),t._getName=function(){return"Postroll"};var n=t.prototype;return n.init=function(e){if(this.waitingForAdBreak=!0,e.ads._contentEnding=!0,e.ads.nopostroll_){this.resumeContent(e);var t=g.getState("AdsDone");this.transitionTo(t)}else{e.addClass("vjs-ad-loading");var n=e.ads.settings.timeout;"number"==typeof e.ads.settings.postrollTimeout&&(n=e.ads.settings.postrollTimeout),this._postrollTimeout=e.setTimeout(function(){e.trigger("adtimeout")},n)}},n.startLinearAdMode=function(){var e=this.player;e.ads.inAdBreak()||this.isContentResuming()?f.log.warn("Unexpected startLinearAdMode invocation (Postroll)"):(e.ads.adType="postroll",e.clearTimeout(this._postrollTimeout),this.waitingForAdBreak=!1,w.start(e))},n.onAdStarted=function(e){e.removeClass("vjs-ad-loading")},n.endLinearAdMode=function(){var e=this,t=this.player,n=g.getState("AdsDone");this.inAdBreak()&&(t.removeClass("vjs-ad-loading"),this.resumeContent(t),w.end(t,function(){e.transitionTo(n)}))},n.skipLinearAdMode=function(){var e=this.player;e.ads.inAdBreak()||this.isContentResuming()?f.log.warn("Unexpected skipLinearAdMode invocation"):(e.ads.debug("Postroll abort (skipLinearAdMode)"),e.trigger("adskip"),this.abort(e))},n.onAdTimeout=function(e){e.ads.debug("Postroll abort (adtimeout)"),this.abort(e)},n.onAdsError=function(e){e.ads.debug("Postroll abort (adserror)"),e.ads.inAdBreak()?e.ads.endLinearAdMode():this.abort(e)},n.onContentChanged=function(){if(this.isContentResuming()){var e=g.getState("BeforePreroll");this.transitionTo(e)}else if(!this.inAdBreak()){var t=g.getState("Preroll");this.transitionTo(t)}},n.onNoPostroll=function(e){this.isContentResuming()||this.inAdBreak()?f.log.warn("Unexpected nopostroll event (Postroll)"):this.abort(e)},n.resumeContent=function(e){this.contentResuming=!0,e.addClass("vjs-ad-content-resuming")},n.abort=function(e){var t=g.getState("AdsDone");this.resumeContent(e),e.removeClass("vjs-ad-loading"),this.transitionTo(t)},n.cleanup=function(e){e.removeClass("vjs-ad-content-resuming"),e.clearTimeout(this._postrollTimeout),e.ads._contentEnding=!1},t}(g.getState("AdState"));g.registerState("Postroll",M);var R=function(e){function t(){return e.apply(this,arguments)||this}y(t,e),t._getName=function(){return"ContentPlayback"};var n=t.prototype;return n.init=function(e){e.ads._shouldBlockPlay=!1},n.onAdsReady=function(e){e.ads.debug("Received adsready event (ContentPlayback)"),e.ads.nopreroll_||(e.ads.debug("Triggered readyforpreroll event (ContentPlayback)"),e.trigger("readyforpreroll"))},n.onReadyForPostroll=function(e){var t=g.getState("Postroll");e.ads.debug("Received readyforpostroll event"),this.transitionTo(t)},n.startLinearAdMode=function(){var e=g.getState("Midroll");this.transitionTo(e)},t}(g.getState("ContentState"));g.registerState("ContentPlayback",R);var I=function(e){function t(){return e.apply(this,arguments)||this}y(t,e),t._getName=function(){return"StitchedContentPlayback"};var n=t.prototype;return n.init=function(){this.player.ads._shouldBlockPlay=!1},n.onContentChanged=function(){this.player.ads.debug("Received contentchanged event ("+this.constructor._getName()+")")},n.startLinearAdMode=function(){var e=g.getState("StitchedAdRoll");this.transitionTo(e)},t}(g.getState("ContentState"));g.registerState("StitchedContentPlayback",I);var P=function(e){function t(){return e.apply(this,arguments)||this}y(t,e),t._getName=function(){return"StitchedAdRoll"};var n=t.prototype;return n.init=function(){this.waitingForAdBreak=!1,this.contentResuming=!1,this.player.ads.adType="stitched",w.start(this.player)},n.onPlaying=function(){},n.onContentResumed=function(){},n.onAdEnded=function(){this.endLinearAdMode(),this.player.trigger("ended")},n.endLinearAdMode=function(){var e=g.getState("StitchedContentPlayback");w.end(this.player),this.transitionTo(e)},t}(g.getState("AdState"));g.registerState("StitchedAdRoll",P);function D(e){var r=this,t=f.mergeOptions(k,e),n=[];function i(){var e=r.textTracks();if(!r.ads.shouldPlayContentBehindAd(r)&&r.ads.inAdBreak()&&r.tech_.featuresNativeTextTracks&&f.browser.IS_IOS&&!Array.isArray(r.textTracks()))for(var t=0;t<e.length;t++){var n=e[t];"showing"===n.mode&&(n.mode="disabled")}}N.concat(["firstplay","loadedalldata"]).forEach(function(e){-1===n.indexOf(e)&&n.push(e)}),r.on(n,a),O()||function(e,t){t&&f.log("Using cancelContentPlay to block content playback"),e.on("play",p)}(r,t.debug),r.setTimeout(function(){r.ads._hasThereBeenALoadStartDuringPlayerLife||""===r.src()||f.log.error("videojs-contrib-ads has not seen a loadstart event 5 seconds after being initialized, but a source is present. This indicates that videojs-contrib-ads was initialized too late. It must be initialized immediately after video.js in the same tick. As a result, some ads will not play and some media events will be incorrect. For more information, see http://videojs.github.io/videojs-contrib-ads/integrator/getting-started.html")},5e3),r.on("ended",function(){r.hasClass("vjs-has-started")||r.addClass("vjs-has-started")}),r.on("contenttimeupdate",function(){r.removeClass("vjs-waiting")}),r.on(["addurationchange","adcanplay"],function(){if(!r.ads.settings.stitchedAds&&!r.hasStarted()&&(!r.ads.snapshot||r.currentSrc()!==r.ads.snapshot.currentSrc)&&r.ads.inAdBreak()){var e=r.play();e&&e.catch&&e.catch(function(e){f.log.warn("Play promise rejected when playing ad",e)})}}),r.on("nopreroll",function(){r.ads.debug("Received nopreroll event"),r.ads.nopreroll_=!0}),r.on("nopostroll",function(){r.ads.debug("Received nopostroll event"),r.ads.nopostroll_=!0}),r.on("playing",function(){r.ads._cancelledPlay=!1,r.ads._pausedOnContentupdate=!1}),r.on("play",function(){r.ads._playRequested=!0}),r.one("loadstart",function(){r.ads._hasThereBeenALoadStartDuringPlayerLife=!0}),r.on("loadeddata",function(){r.ads._hasThereBeenALoadedData=!0}),r.on("loadedmetadata",function(){r.ads._hasThereBeenALoadedMetaData=!0}),r.ads=function(n){return{disableNextSnapshotRestore:!1,_contentEnding:!1,_contentHasEnded:!1,_hasThereBeenALoadStartDuringPlayerLife:!1,_hasThereBeenALoadedData:!1,_hasThereBeenALoadedMetaData:!1,_inLinearAdMode:!1,_shouldBlockPlay:!1,_playBlocked:!1,_playRequested:!1,adType:null,VERSION:"6.9.0",reset:function(){n.ads.disableNextSnapshotRestore=!1,n.ads._contentEnding=!1,n.ads._contentHasEnded=!1,n.ads.snapshot=null,n.ads.adType=null,n.ads._hasThereBeenALoadedData=!1,n.ads._hasThereBeenALoadedMetaData=!1,n.ads._cancelledPlay=!1,n.ads._shouldBlockPlay=!1,n.ads._playBlocked=!1,n.ads.nopreroll_=!1,n.ads.nopostroll_=!1,n.ads._playRequested=!1},startLinearAdMode:function(){n.ads._state.startLinearAdMode()},endLinearAdMode:function(){n.ads._state.endLinearAdMode()},skipLinearAdMode:function(){n.ads._state.skipLinearAdMode()},stitchedAds:function(e){return void 0!==e&&(f.log.warn("Using player.ads.stitchedAds() as a setter is deprecated, it should be set as an option upon initialization of contrib-ads."),this.settings.stitchedAds=!!e),this.settings.stitchedAds},videoElementRecycled:function(){if(n.ads.shouldPlayContentBehindAd(n))return!1;if(!this.snapshot)throw new Error("You cannot use videoElementRecycled while there is no snapshot.");var e=n.tech_.src()!==this.snapshot.src,t=n.currentSrc()!==this.snapshot.currentSrc;return e||t},isLive:function(e){return void 0===e&&(e=n),"boolean"==typeof e.ads.settings.contentIsLive?e.ads.settings.contentIsLive:e.duration()===1/0||"8"===f.browser.IOS_VERSION&&0===e.duration()},shouldPlayContentBehindAd:function(e){if(void 0===e&&(e=n),e)return!!e.ads.settings.liveCuePoints&&(!f.browser.IS_IOS&&!f.browser.IS_ANDROID&&e.duration()===1/0);throw new Error("shouldPlayContentBehindAd requires a player as a param")},shouldTakeSnapshots:function(e){return void 0===e&&(e=n),!this.shouldPlayContentBehindAd(e)&&!this.stitchedAds()},isInAdMode:function(){return this._state.isAdState()},isWaitingForAdBreak:function(){return this._state.isWaitingForAdBreak()},isContentResuming:function(){return this._state.isContentResuming()},isAdPlaying:function(){return this._state.inAdBreak()},inAdBreak:function(){return this._state.inAdBreak()},removeNativePoster:function(){var e=n.$(".vjs-tech");e&&e.removeAttribute("poster")},debug:function(){if(this.settings.debug){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];1===t.length&&"string"==typeof t[0]?f.log("ADS: "+t[0]):f.log.apply(f,["ADS:"].concat(t))}}}}(r),(r.ads.settings=t).stitchedAds=!!t.stitchedAds,t.stitchedAds?r.ads._state=new(g.getState("StitchedContentPlayback"))(r):r.ads._state=new(g.getState("BeforePreroll"))(r),r.ads._state.init(r),r.ads.cueTextTracks=l,r.ads.adMacroReplacement=function(e,s,t){var n=this,l={};e=e.replace(/{([^}=]+)=([^}]+)}/g,function(e,t,n){return l["{"+t+"}"]=n,"{"+t+"}"}),void 0===s&&(s=!1);var r={};for(var i in void 0!==t&&(r=t),r["{player.id}"]=this.options_["data-player"]||this.id_,r["{player.height}"]=this.currentHeight(),r["{player.width}"]=this.currentWidth(),r["{mediainfo.id}"]=this.mediainfo?this.mediainfo.id:"",r["{mediainfo.name}"]=this.mediainfo?this.mediainfo.name:"",r["{mediainfo.duration}"]=this.mediainfo?this.mediainfo.duration:"",r["{player.duration}"]=this.duration(),r["{player.pageUrl}"]=f.dom.isInFrame()?o.referrer:u.location.href,r["{playlistinfo.id}"]=this.playlistinfo?this.playlistinfo.id:"",r["{playlistinfo.name}"]=this.playlistinfo?this.playlistinfo.name:"",r["{timestamp}"]=(new Date).getTime(),r["{document.referrer}"]=o.referrer,r["{window.location.href}"]=u.location.href,r["{random}"]=Math.floor(1e12*Math.random()),["description","tags","reference_id","ad_keys"].forEach(function(e){n.mediainfo&&n.mediainfo[e]?r["{mediainfo."+e+"}"]=n.mediainfo[e]:l["{mediainfo."+e+"}"]?r["{mediainfo."+e+"}"]=l["{mediainfo."+e+"}"]:r["{mediainfo."+e+"}"]=""}),d(this.mediainfo,r,"custom_fields"),d(this.mediainfo,r,"customFields"),Object.keys(h).forEach(function(e){r["{tcf."+e+"}"]=h[e]}),r["{tcf.gdprAppliesInt}"]=h.gdprApplies?1:0,r)e=e.split(i).join(c(r[i],s));for(var a in e=e.replace(/{pageVariable\.([^}]+)}/g,function(e,t){for(var n,r=u,i=t.split("."),a=0;a<i.length;a++)a===i.length-1?n=r[i[a]]:r=r[i[a]];var o=typeof n;return null===n?"null":void 0===n?l["{pageVariable."+t+"}"]?l["{pageVariable."+t+"}"]:(f.log.warn('Page variable "'+t+'" not found'),""):"string"!=o&&"number"!=o&&"boolean"!=o?(f.log.warn('Page variable "'+t+'" is not a supported type'),""):c(String(n),s)}),l)e=e.replace(a,l[a]);return e}.bind(r),function(t){t.ads.contentSrc=t.currentSrc(),t.ads._seenInitialLoadstart=!1,t.on("loadstart",function(){if(!t.ads.inAdBreak()){var e=t.currentSrc();e!==t.ads.contentSrc&&(t.ads._seenInitialLoadstart&&t.trigger({type:"contentchanged"}),t.trigger({type:"contentupdate",oldValue:t.ads.contentSrc,newValue:e}),t.ads.contentSrc=e),t.ads._seenInitialLoadstart=!0}})}(r),r.on("contentchanged",r.ads.reset),r.ready(function(){r.textTracks().addEventListener("change",i)}),r.on(["play","playing","ended","adsready","adscanceled","adskip","adserror","adtimeout","adended","ads-ad-started","contentchanged","dispose","contentresumed","readyforpostroll","nopreroll","nopostroll"],function(e){r.ads._state.handleEvent(e.type)}),r.on("dispose",function(){r.ads.reset(),r.textTracks().removeEventListener("change",i)}),s(),r.ads.listenToTcf=s}var L,O=e.isMiddlewareMediatorSupported,N=f.getTech("Html5").Events,k={timeout:5e3,prerollTimeout:void 0,postrollTimeout:void 0,debug:!1,stitchedAds:!1,contentIsLive:void 0,liveCuePoints:!0,allowVjsAutoplay:f.options.normalizeAutoplay||!1};return D.VERSION="6.9.0",L=D,function(){if(f.getPlugin)return Boolean(f.getPlugin("ads"));var e=f.getComponent("Player");return Boolean(e&&e.prototype.ads)}()||((f.registerPlugin||f.plugin)("ads",L),m()&&!f.usingContribAdsMiddleware_&&(f.use("*",i),f.usingContribAdsMiddleware_=!0,f.log.debug("Play middleware has been registered with videojs"))),D}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],t):e.videojsIma=t(e.videojs)}(this,function(e){"use strict";e=e&&e.hasOwnProperty("default")?e.default:e;function i(e,t,n){this.vjsPlayer=e,this.controller=n,this.contentTrackingTimer=null,this.contentComplete=!1,this.updateTimeIntervalHandle=null,this.updateTimeInterval=1e3,this.seekCheckIntervalHandle=null,this.seekCheckInterval=1e3,this.resizeCheckIntervalHandle=null,this.resizeCheckInterval=250,this.seekThreshold=100,this.contentEndedListeners=[],this.contentSource="",this.contentSourceType="",this.contentPlayheadTracker={currentTime:0,previousTime:0,seeking:!1,duration:0},this.vjsPlayerDimensions={width:this.getPlayerWidth(),height:this.getPlayerHeight()},this.vjsControls=this.vjsPlayer.getChild("controlBar"),this.h5Player=null,this.vjsPlayer.one("play",this.setUpPlayerIntervals.bind(this)),this.boundContentEndedListener=this.localContentEndedListener.bind(this),this.vjsPlayer.on("contentended",this.boundContentEndedListener),this.vjsPlayer.on("dispose",this.playerDisposedListener.bind(this)),this.vjsPlayer.on("readyforpreroll",this.onReadyForPreroll.bind(this)),this.vjsPlayer.on("adtimeout",this.onAdTimeout.bind(this)),this.vjsPlayer.ready(this.onPlayerReady.bind(this)),"onPlay"===this.controller.getSettings().requestMode&&this.vjsPlayer.one("play",this.controller.requestAds.bind(this.controller)),this.vjsPlayer.ads(t)}i.prototype.setUpPlayerIntervals=function(){this.updateTimeIntervalHandle=setInterval(this.updateCurrentTime.bind(this),this.updateTimeInterval),this.seekCheckIntervalHandle=setInterval(this.checkForSeeking.bind(this),this.seekCheckInterval),this.resizeCheckIntervalHandle=setInterval(this.checkForResize.bind(this),this.resizeCheckInterval)},i.prototype.updateCurrentTime=function(){this.contentPlayheadTracker.seeking||(this.contentPlayheadTracker.currentTime=this.vjsPlayer.currentTime())},i.prototype.checkForSeeking=function(){var e=1e3*(this.vjsPlayer.currentTime()-this.contentPlayheadTracker.previousTime);Math.abs(e)>this.seekCheckInterval+this.seekThreshold?this.contentPlayheadTracker.seeking=!0:this.contentPlayheadTracker.seeking=!1,this.contentPlayheadTracker.previousTime=this.vjsPlayer.currentTime()},i.prototype.checkForResize=function(){var e=this.getPlayerWidth(),t=this.getPlayerHeight();e==this.vjsPlayerDimensions.width&&t==this.vjsPlayerDimensions.height||(this.vjsPlayerDimensions.width=e,this.vjsPlayerDimensions.height=t,this.controller.onPlayerResize(e,t))},i.prototype.localContentEndedListener=function(){for(var e in this.contentComplete||(this.contentComplete=!0,this.controller.onContentComplete()),this.contentEndedListeners)"function"==typeof this.contentEndedListeners[e]&&this.contentEndedListeners[e]();clearInterval(this.updateTimeIntervalHandle),clearInterval(this.seekCheckIntervalHandle),clearInterval(this.resizeCheckIntervalHandle),this.vjsPlayer.el()&&this.vjsPlayer.one("play",this.setUpPlayerIntervals.bind(this))},i.prototype.onNoPostroll=function(){this.vjsPlayer.trigger("nopostroll")},i.prototype.playerDisposedListener=function(){this.contentEndedListeners=[],this.controller.onPlayerDisposed(),this.contentComplete=!0,this.vjsPlayer.off("contentended",this.boundContentEndedListener),this.vjsPlayer.ads.adTimeoutTimeout&&clearTimeout(this.vjsPlayer.ads.adTimeoutTimeout);var e=[this.updateTimeIntervalHandle,this.seekCheckIntervalHandle,this.resizeCheckIntervalHandle];for(var t in e)e[t]&&clearInterval(e[t])},i.prototype.onReadyForPreroll=function(){this.controller.onPlayerReadyForPreroll()},i.prototype.onAdTimeout=function(){this.controller.onAdTimeout()},i.prototype.onPlayerReady=function(){this.h5Player=document.getElementById(this.getPlayerId()).getElementsByClassName("vjs-tech")[0],this.h5Player.hasAttribute("autoplay")&&this.controller.setSetting("adWillAutoPlay",!0),this.onVolumeChange(),this.vjsPlayer.on("fullscreenchange",this.onFullscreenChange.bind(this)),this.vjsPlayer.on("volumechange",this.onVolumeChange.bind(this)),this.controller.onPlayerReady()},i.prototype.onFullscreenChange=function(){this.vjsPlayer.isFullscreen()?this.controller.onPlayerEnterFullscreen():this.controller.onPlayerExitFullscreen()},i.prototype.onVolumeChange=function(){var e=this.vjsPlayer.muted()?0:this.vjsPlayer.volume();this.controller.onPlayerVolumeChanged(e)},i.prototype.injectAdContainerDiv=function(e){this.vjsControls.el().parentNode.appendChild(e)},i.prototype.getContentPlayer=function(){return this.h5Player},i.prototype.getVolume=function(){return this.vjsPlayer.muted()?0:this.vjsPlayer.volume()},i.prototype.setVolume=function(e){this.vjsPlayer.volume(e),0==e?this.vjsPlayer.muted(!0):this.vjsPlayer.muted(!1)},i.prototype.unmute=function(){this.vjsPlayer.muted(!1)},i.prototype.mute=function(){this.vjsPlayer.muted(!0)},i.prototype.play=function(){this.vjsPlayer.play()},i.prototype.togglePlayback=function(){this.vjsPlayer.paused()?this.vjsPlayer.play():this.vjsPlayer.pause()},i.prototype.getPlayerWidth=function(){var e=(getComputedStyle(this.vjsPlayer.el())||{}).width;return e&&0!==parseFloat(e)||(e=(this.vjsPlayer.el().getBoundingClientRect()||{}).width),parseFloat(e)||this.vjsPlayer.width()},i.prototype.getPlayerHeight=function(){var e=(getComputedStyle(this.vjsPlayer.el())||{}).height;return e&&0!==parseFloat(e)||(e=(this.vjsPlayer.el().getBoundingClientRect()||{}).height),parseFloat(e)||this.vjsPlayer.height()},i.prototype.getPlayerOptions=function(){return this.vjsPlayer.options_},i.prototype.getPlayerId=function(){return this.vjsPlayer.id()},i.prototype.toggleFullscreen=function(){this.vjsPlayer.isFullscreen()?this.vjsPlayer.exitFullscreen():this.vjsPlayer.requestFullscreen()},i.prototype.getContentPlayheadTracker=function(){return this.contentPlayheadTracker},i.prototype.onAdError=function(e){this.vjsControls.show();var t=void 0!==e.getError?e.getError():e.stack;this.vjsPlayer.trigger({type:"adserror",data:{AdError:t,AdErrorEvent:e}})},i.prototype.onAdLog=function(e){var t=e.getAdData(),n=void 0!==t.adError?t.adError.getMessage():void 0;this.vjsPlayer.trigger({type:"adslog",data:{AdError:n,AdEvent:e}})},i.prototype.onAdBreakStart=function(){this.contentSource=this.vjsPlayer.currentSrc(),this.contentSourceType=this.vjsPlayer.currentType(),this.vjsPlayer.off("contentended",this.boundContentEndedListener),this.vjsPlayer.ads.startLinearAdMode(),this.vjsControls.hide(),this.vjsPlayer.pause()},i.prototype.onAdBreakEnd=function(){this.vjsPlayer.on("contentended",this.boundContentEndedListener),this.vjsPlayer.ads.inAdBreak()&&this.vjsPlayer.ads.endLinearAdMode(),this.vjsControls.show()},i.prototype.onAdStart=function(){this.vjsPlayer.trigger("ads-ad-started")},i.prototype.onAllAdsCompleted=function(){1==this.contentComplete&&(this.contentSource&&this.vjsPlayer.currentSrc()!=this.contentSource&&this.vjsPlayer.src({src:this.contentSource,type:this.contentSourceType}),this.controller.onContentAndAdsCompleted())},i.prototype.onAdsReady=function(){this.vjsPlayer.trigger("adsready")},i.prototype.changeSource=function(e){this.vjsPlayer.currentSrc()&&(this.vjsPlayer.currentTime(0),this.vjsPlayer.pause()),e&&this.vjsPlayer.src(e),this.vjsPlayer.one("loadedmetadata",this.seekContentToZero.bind(this))},i.prototype.seekContentToZero=function(){this.vjsPlayer.currentTime(0)},i.prototype.triggerPlayerEvent=function(e,t){this.vjsPlayer.trigger(e,t)},i.prototype.addContentEndedListener=function(e){this.contentEndedListeners.push(e)},i.prototype.reset=function(){this.vjsPlayer.off("contentended",this.boundContentEndedListener),this.vjsPlayer.on("contentended",this.boundContentEndedListener),this.vjsControls.show(),this.vjsPlayer.ads.inAdBreak()&&this.vjsPlayer.ads.endLinearAdMode(),this.contentPlayheadTracker.currentTime=0,this.contentComplete=!1};function a(e){this.controller=e,this.adContainerDiv=document.createElement("div"),this.controlsDiv=document.createElement("div"),this.countdownDiv=document.createElement("div"),this.seekBarDiv=document.createElement("div"),this.progressDiv=document.createElement("div"),this.playPauseDiv=document.createElement("div"),this.muteDiv=document.createElement("div"),this.sliderDiv=document.createElement("div"),this.sliderLevelDiv=document.createElement("div"),this.fullscreenDiv=document.createElement("div"),this.boundOnMouseUp=this.onMouseUp.bind(this),this.boundOnMouseMove=this.onMouseMove.bind(this),this.adPlayheadTracker={currentTime:0,duration:0,isPod:!1,adPosition:0,totalAds:0},this.controlPrefix=this.controller.getPlayerId()+"_",!(this.showCountdown=!0)===this.controller.getSettings().showCountdown&&(this.showCountdown=!1),this.isAdNonlinear=!1,this.createAdContainer()}a.prototype.createAdContainer=function(){this.assignControlAttributes(this.adContainerDiv,"ima-ad-container"),this.adContainerDiv.style.position="absolute",this.adContainerDiv.style.zIndex=1111,this.adContainerDiv.addEventListener("mouseenter",this.showAdControls.bind(this),!1),this.adContainerDiv.addEventListener("mouseleave",this.hideAdControls.bind(this),!1),this.adContainerDiv.addEventListener("click",this.onAdContainerClick.bind(this),!1),this.createControls(),this.controller.injectAdContainerDiv(this.adContainerDiv)},a.prototype.createControls=function(){this.assignControlAttributes(this.controlsDiv,"ima-controls-div"),this.controlsDiv.style.width="100%",this.controller.getIsMobile()?this.countdownDiv.style.display="none":(this.assignControlAttributes(this.countdownDiv,"ima-countdown-div"),this.countdownDiv.innerHTML=this.controller.getSettings().adLabel,this.countdownDiv.style.display=this.showCountdown?"block":"none"),this.assignControlAttributes(this.seekBarDiv,"ima-seek-bar-div"),this.seekBarDiv.style.width="100%",this.assignControlAttributes(this.progressDiv,"ima-progress-div"),this.assignControlAttributes(this.playPauseDiv,"ima-play-pause-div"),this.addClass(this.playPauseDiv,"ima-playing"),this.playPauseDiv.addEventListener("click",this.onAdPlayPauseClick.bind(this),!1),this.assignControlAttributes(this.muteDiv,"ima-mute-div"),this.addClass(this.muteDiv,"ima-non-muted"),this.muteDiv.addEventListener("click",this.onAdMuteClick.bind(this),!1),this.assignControlAttributes(this.sliderDiv,"ima-slider-div"),this.sliderDiv.addEventListener("mousedown",this.onAdVolumeSliderMouseDown.bind(this),!1),this.controller.getIsIos()&&(this.sliderDiv.style.display="none"),this.assignControlAttributes(this.sliderLevelDiv,"ima-slider-level-div"),this.assignControlAttributes(this.fullscreenDiv,"ima-fullscreen-div"),this.addClass(this.fullscreenDiv,"ima-non-fullscreen"),this.fullscreenDiv.addEventListener("click",this.onAdFullscreenClick.bind(this),!1),this.adContainerDiv.appendChild(this.controlsDiv),this.controlsDiv.appendChild(this.countdownDiv),this.controlsDiv.appendChild(this.seekBarDiv),this.controlsDiv.appendChild(this.playPauseDiv),this.controlsDiv.appendChild(this.muteDiv),this.controlsDiv.appendChild(this.sliderDiv),this.controlsDiv.appendChild(this.fullscreenDiv),this.seekBarDiv.appendChild(this.progressDiv),this.sliderDiv.appendChild(this.sliderLevelDiv)},a.prototype.onAdPlayPauseClick=function(){this.controller.onAdPlayPauseClick()},a.prototype.onAdMuteClick=function(){this.controller.onAdMuteClick()},a.prototype.onAdFullscreenClick=function(){this.controller.toggleFullscreen()},a.prototype.onAdsPaused=function(){this.controller.sdkImpl.adPlaying=!1,this.addClass(this.playPauseDiv,"ima-paused"),this.removeClass(this.playPauseDiv,"ima-playing"),this.showAdControls()},a.prototype.onAdsResumed=function(){this.onAdsPlaying(),this.showAdControls()},a.prototype.onAdsPlaying=function(){this.controller.sdkImpl.adPlaying=!0,this.addClass(this.playPauseDiv,"ima-playing"),this.removeClass(this.playPauseDiv,"ima-paused")},a.prototype.updateAdUi=function(e,t,n,r,i){var a=Math.floor(t/60),o=Math.floor(t%60);o.toString().length<2&&(o="0"+o);var s=": ";1<i&&(s=" ("+r+" "+this.controller.getSettings().adLabelNofN+" "+i+"): "),this.countdownDiv.innerHTML=this.controller.getSettings().adLabel+s+a+":"+o;var l=100*(e/n);this.progressDiv.style.width=l+"%"},a.prototype.unmute=function(){this.addClass(this.muteDiv,"ima-non-muted"),this.removeClass(this.muteDiv,"ima-muted"),this.sliderLevelDiv.style.width=100*this.controller.getPlayerVolume()+"%"},a.prototype.mute=function(){this.addClass(this.muteDiv,"ima-muted"),this.removeClass(this.muteDiv,"ima-non-muted"),this.sliderLevelDiv.style.width="0%"},a.prototype.onAdVolumeSliderMouseDown=function(){document.addEventListener("mouseup",this.boundOnMouseUp,!1),document.addEventListener("mousemove",this.boundOnMouseMove,!1)},a.prototype.onMouseMove=function(e){this.changeVolume(e)},a.prototype.onMouseUp=function(e){this.changeVolume(e),document.removeEventListener("mouseup",this.boundOnMouseUp),document.removeEventListener("mousemove",this.boundOnMouseMove)},a.prototype.changeVolume=function(e){var t=(e.clientX-this.sliderDiv.getBoundingClientRect().left)/this.sliderDiv.offsetWidth;t*=100,t=Math.min(Math.max(t,0),100),this.sliderLevelDiv.style.width=t+"%",0==this.percent?(this.addClass(this.muteDiv,"ima-muted"),this.removeClass(this.muteDiv,"ima-non-muted")):(this.addClass(this.muteDiv,"ima-non-muted"),this.removeClass(this.muteDiv,"ima-muted")),this.controller.setVolume(t/100)},a.prototype.showAdContainer=function(){this.adContainerDiv.style.display="block"},a.prototype.hideAdContainer=function(){this.adContainerDiv.style.display="none"},a.prototype.onAdContainerClick=function(){this.isAdNonlinear&&this.controller.togglePlayback()},a.prototype.reset=function(){this.hideAdContainer()},a.prototype.onAdError=function(){this.hideAdContainer()},a.prototype.onAdBreakStart=function(e){this.showAdContainer(),"application/javascript"!==e.getAd().getContentType()||this.controller.getSettings().showControlsForJSAds?this.controlsDiv.style.display="block":this.controlsDiv.style.display="none",this.onAdsPlaying(),this.hideAdControls()},a.prototype.onAdBreakEnd=function(){var e=this.controller.getCurrentAd();null!=e&&!e.isLinear()||this.hideAdContainer(),this.controlsDiv.style.display="none",this.countdownDiv.innerHTML=""},a.prototype.onAllAdsCompleted=function(){this.hideAdContainer()},a.prototype.onLinearAdStart=function(){this.removeClass(this.adContainerDiv,"bumpable-ima-ad-container"),this.isAdNonlinear=!1},a.prototype.onNonLinearAdLoad=function(){this.adContainerDiv.style.display="block",this.addClass(this.adContainerDiv,"bumpable-ima-ad-container"),this.isAdNonlinear=!0},a.prototype.onPlayerEnterFullscreen=function(){this.addClass(this.fullscreenDiv,"ima-fullscreen"),this.removeClass(this.fullscreenDiv,"ima-non-fullscreen")},a.prototype.onPlayerExitFullscreen=function(){this.addClass(this.fullscreenDiv,"ima-non-fullscreen"),this.removeClass(this.fullscreenDiv,"ima-fullscreen")},a.prototype.onPlayerVolumeChanged=function(e){0==e?(this.addClass(this.muteDiv,"ima-muted"),this.removeClass(this.muteDiv,"ima-non-muted"),this.sliderLevelDiv.style.width="0%"):(this.addClass(this.muteDiv,"ima-non-muted"),this.removeClass(this.muteDiv,"ima-muted"),this.sliderLevelDiv.style.width=100*e+"%")},a.prototype.showAdControls=function(){this.controller.getSettings().disableAdControls||this.addClass(this.controlsDiv,"ima-controls-div-showing")},a.prototype.hideAdControls=function(){this.removeClass(this.controlsDiv,"ima-controls-div-showing")},a.prototype.assignControlAttributes=function(e,t){e.id=this.controlPrefix+t,e.className=this.controlPrefix+t+" "+t},a.prototype.getClassRegexp=function(e){return new RegExp("(^|[^A-Za-z-])"+e+"((?![A-Za-z-])|$)","gi")},a.prototype.elementHasClass=function(e,t){return this.getClassRegexp(t).test(e.className)},a.prototype.addClass=function(e,t){e.className=e.className.trim()+" "+t},a.prototype.removeClass=function(e,t){var n=this.getClassRegexp(t);e.className=e.className.trim().replace(n,"")},a.prototype.getAdContainerDiv=function(){return this.adContainerDiv},a.prototype.setShowCountdown=function(e){this.showCountdown=e,this.countdownDiv.style.display=this.showCountdown?"block":"none"};function o(e){this.controller=e,this.adDisplayContainer=null,this.adDisplayContainerInitialized=!1,this.adsLoader=null,this.adsManager=null,this.adsRenderingSettings=null,this.adsResponse=null,this.currentAd=null,this.adTrackingTimer=null,this.allAdsCompleted=!1,this.adsActive=!1,this.adPlaying=!1,this.adMuted=!1,this.adBreakReadyListener=void 0,this.contentCompleteCalled=!1,this.isAdTimedOut=!1,this.adsManagerDimensions={width:0,height:0},!(this.autoPlayAdBreaks=!0)===this.controller.getSettings().autoPlayAdBreaks&&(this.autoPlayAdBreaks=!1),this.controller.getSettings().locale&&google.ima.settings.setLocale(this.controller.getSettings().locale),this.controller.getSettings().disableFlashAds&&google.ima.settings.setDisableFlashAds(this.controller.getSettings().disableFlashAds),this.controller.getSettings().disableCustomPlaybackForIOS10Plus&&google.ima.settings.setDisableCustomPlaybackForIOS10Plus(this.controller.getSettings().disableCustomPlaybackForIOS10Plus),this.controller.getSettings().ppid&&google.ima.settings.setPpid(this.controller.getSettings().ppid),this.controller.getSettings().featureFlags&&google.ima.settings.setFeatureFlags(this.controller.getSettings().featureFlags)}var t="1.11.0",r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};o.prototype.initAdObjects=function(){this.adDisplayContainer=new google.ima.AdDisplayContainer(this.controller.getAdContainerDiv(),this.controller.getContentPlayer()),this.adsLoader=new google.ima.AdsLoader(this.adDisplayContainer),this.adsLoader.getSettings().setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED),0==this.controller.getSettings().vpaidAllowed&&this.adsLoader.getSettings().setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.DISABLED),void 0!==this.controller.getSettings().vpaidMode&&this.adsLoader.getSettings().setVpaidMode(this.controller.getSettings().vpaidMode),this.controller.getSettings().locale&&this.adsLoader.getSettings().setLocale(this.controller.getSettings().locale),this.controller.getSettings().numRedirects&&this.adsLoader.getSettings().setNumRedirects(this.controller.getSettings().numRedirects),this.controller.getSettings().sessionId&&this.adsLoader.getSettings().setSessionId(this.controller.getSettings().sessionId),this.adsLoader.getSettings().setPlayerType("videojs-ima"),this.adsLoader.getSettings().setPlayerVersion(t),this.adsLoader.getSettings().setAutoPlayAdBreaks(this.autoPlayAdBreaks),this.adsLoader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,this.onAdsManagerLoaded.bind(this),!1),this.adsLoader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this.onAdsLoaderError.bind(this),!1),this.controller.playerWrapper.vjsPlayer.trigger({type:"ads-loader",adsLoader:this.adsLoader})},o.prototype.requestAds=function(){var t=new google.ima.AdsRequest;if(this.controller.getSettings().adTagUrl?t.adTagUrl=this.controller.getSettings().adTagUrl:t.adsResponse=this.controller.getSettings().adsResponse,this.controller.getSettings().forceNonLinearFullSlot&&(t.forceNonLinearFullSlot=!0),this.controller.getSettings().vastLoadTimeout&&(t.vastLoadTimeout=this.controller.getSettings().vastLoadTimeout),this.controller.getSettings().omidMode){t.omidAccessModeRules={};var e=this.controller.getSettings().omidMode;e.FULL&&(t.omidAccessModeRules[google.ima.OmidAccessMode.FULL]=e.FULL),e.DOMAIN&&(t.omidAccessModeRules[google.ima.OmidAccessMode.DOMAIN]=e.DOMAIN),e.LIMITED&&(t.omidAccessModeRules[google.ima.OmidAccessMode.LIMITED]=e.LIMITED)}t.linearAdSlotWidth=this.controller.getPlayerWidth(),t.linearAdSlotHeight=this.controller.getPlayerHeight(),t.nonLinearAdSlotWidth=this.controller.getSettings().nonLinearWidth||this.controller.getPlayerWidth(),t.nonLinearAdSlotHeight=this.controller.getSettings().nonLinearHeight||this.controller.getPlayerHeight(),t.setAdWillAutoPlay(this.controller.adsWillAutoplay()),t.setAdWillPlayMuted(this.controller.adsWillPlayMuted());var n=this.controller.getSettings().adsRequest;n&&"object"===(void 0===n?"undefined":r(n))&&Object.keys(n).forEach(function(e){t[e]=n[e]}),this.adsLoader.requestAds(t),this.controller.playerWrapper.vjsPlayer.trigger({type:"ads-request",AdsRequest:t})},o.prototype.onAdsManagerLoaded=function(e){this.createAdsRenderingSettings(),this.adsManager=e.getAdsManager(this.controller.getContentPlayheadTracker(),this.adsRenderingSettings),this.adsManager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this.onAdError.bind(this)),this.adsManager.addEventListener(google.ima.AdEvent.Type.AD_BREAK_READY,this.onAdBreakReady.bind(this)),this.adsManager.addEventListener(google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,this.onContentPauseRequested.bind(this)),this.adsManager.addEventListener(google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,this.onContentResumeRequested.bind(this)),this.adsManager.addEventListener(google.ima.AdEvent.Type.ALL_ADS_COMPLETED,this.onAllAdsCompleted.bind(this)),this.adsManager.addEventListener(google.ima.AdEvent.Type.LOADED,this.onAdLoaded.bind(this)),this.adsManager.addEventListener(google.ima.AdEvent.Type.STARTED,this.onAdStarted.bind(this)),this.adsManager.addEventListener(google.ima.AdEvent.Type.COMPLETE,this.onAdComplete.bind(this)),this.adsManager.addEventListener(google.ima.AdEvent.Type.SKIPPED,this.onAdComplete.bind(this)),this.adsManager.addEventListener(google.ima.AdEvent.Type.LOG,this.onAdLog.bind(this)),this.adsManager.addEventListener(google.ima.AdEvent.Type.PAUSED,this.onAdPaused.bind(this)),this.adsManager.addEventListener(google.ima.AdEvent.Type.RESUMED,this.onAdResumed.bind(this)),this.controller.playerWrapper.vjsPlayer.trigger({type:"ads-manager",adsManager:this.adsManager}),this.autoPlayAdBreaks||this.initAdsManager();var t=this.controller.getSettings().preventLateAdStart;t?t&&!this.isAdTimedOut&&this.controller.onAdsReady():this.controller.onAdsReady(),this.controller.getSettings().adsManagerLoadedCallback&&this.controller.getSettings().adsManagerLoadedCallback()},o.prototype.onAdsLoaderError=function(e){window.console.warn("AdsLoader error: "+e.getError()),this.controller.onErrorLoadingAds(e),this.adsManager&&this.adsManager.destroy()},o.prototype.initAdsManager=function(){try{var e=this.controller.getPlayerWidth(),t=this.controller.getPlayerHeight();this.adsManagerDimensions.width=e,this.adsManagerDimensions.height=t,this.adsManager.init(e,t,google.ima.ViewMode.NORMAL),this.adsManager.setVolume(this.controller.getPlayerVolume()),this.initializeAdDisplayContainer()}catch(e){this.onAdError(e)}},o.prototype.createAdsRenderingSettings=function(){if(this.adsRenderingSettings=new google.ima.AdsRenderingSettings,this.adsRenderingSettings.restoreCustomPlaybackStateOnAdBreakComplete=!0,this.controller.getSettings().adsRenderingSettings)for(var e in this.controller.getSettings().adsRenderingSettings)""!==e&&(this.adsRenderingSettings[e]=this.controller.getSettings().adsRenderingSettings[e])},o.prototype.onAdError=function(e){var t=void 0!==e.getError?e.getError():e.stack;window.console.warn("Ad error: "+t),this.adsManager.destroy(),this.controller.onAdError(e),this.adsActive=!1,this.adPlaying=!1},o.prototype.onAdBreakReady=function(e){this.adBreakReadyListener(e)},o.prototype.onContentPauseRequested=function(e){this.adsActive=!0,this.adPlaying=!0,this.controller.onAdBreakStart(e)},o.prototype.onContentResumeRequested=function(e){this.adsActive=!1,this.adPlaying=!1,this.controller.onAdBreakEnd()},o.prototype.onAllAdsCompleted=function(e){this.allAdsCompleted=!0,this.controller.onAllAdsCompleted()},o.prototype.onAdLoaded=function(e){e.getAd().isLinear()||(this.controller.onNonLinearAdLoad(),this.controller.playContent())},o.prototype.onAdStarted=function(e){this.currentAd=e.getAd(),this.currentAd.isLinear()?(this.adTrackingTimer=setInterval(this.onAdPlayheadTrackerInterval.bind(this),250),this.controller.onLinearAdStart()):this.controller.onNonLinearAdStart()},o.prototype.onAdPaused=function(){this.controller.onAdsPaused()},o.prototype.onAdResumed=function(e){this.controller.onAdsResumed()},o.prototype.onAdComplete=function(){this.currentAd.isLinear()&&clearInterval(this.adTrackingTimer)},o.prototype.onAdLog=function(e){this.controller.onAdLog(e)},o.prototype.onAdPlayheadTrackerInterval=function(){if(null!==this.adsManager){var e=this.adsManager.getRemainingTime(),t=this.currentAd.getDuration(),n=t-e;n=0<n?n:0;var r=0,i=void 0;this.currentAd.getAdPodInfo()&&(i=this.currentAd.getAdPodInfo().getAdPosition(),r=this.currentAd.getAdPodInfo().getTotalAds()),this.controller.onAdPlayheadUpdated(n,e,t,i,r)}},o.prototype.onContentComplete=function(){this.adsLoader&&(this.adsLoader.contentComplete(),this.contentCompleteCalled=!0),(this.adsManager&&this.adsManager.getCuePoints()&&!this.adsManager.getCuePoints().includes(-1)||!this.adsManager)&&this.controller.onNoPostroll(),this.allAdsCompleted&&this.controller.onContentAndAdsCompleted()},o.prototype.onPlayerDisposed=function(){this.adTrackingTimer&&clearInterval(this.adTrackingTimer),this.adsManager&&(this.adsManager.destroy(),this.adsManager=null)},o.prototype.onPlayerReadyForPreroll=function(){if(this.autoPlayAdBreaks){this.initAdsManager();try{this.controller.showAdContainer(),this.adsManager.setVolume(this.controller.getPlayerVolume()),this.adsManager.start()}catch(e){this.onAdError(e)}}},o.prototype.onAdTimeout=function(){this.isAdTimedOut=!0},o.prototype.onPlayerReady=function(){this.initAdObjects(),(this.controller.getSettings().adTagUrl||this.controller.getSettings().adsResponse)&&"onLoad"===this.controller.getSettings().requestMode&&this.requestAds()},o.prototype.onPlayerEnterFullscreen=function(){this.adsManager&&this.adsManager.resize(window.screen.width,window.screen.height,google.ima.ViewMode.FULLSCREEN)},o.prototype.onPlayerExitFullscreen=function(){this.adsManager&&this.adsManager.resize(this.controller.getPlayerWidth(),this.controller.getPlayerHeight(),google.ima.ViewMode.NORMAL)},o.prototype.onPlayerVolumeChanged=function(e){this.adsManager&&this.adsManager.setVolume(e),this.adMuted=0==e},o.prototype.onPlayerResize=function(e,t){this.adsManager&&(this.adsManagerDimensions.width=e,this.adsManagerDimensions.height=t,this.adsManager.resize(e,t,google.ima.ViewMode.NORMAL))},o.prototype.getCurrentAd=function(){return this.currentAd},o.prototype.setAdBreakReadyListener=function(e){this.adBreakReadyListener=e},o.prototype.isAdPlaying=function(){return this.adPlaying},o.prototype.isAdMuted=function(){return this.adMuted},o.prototype.pauseAds=function(){this.adsManager.pause(),this.adPlaying=!1},o.prototype.resumeAds=function(){this.adsManager.resume(),this.adPlaying=!0},o.prototype.unmute=function(){this.adsManager.setVolume(1),this.adMuted=!1},o.prototype.mute=function(){this.adsManager.setVolume(0),this.adMuted=!0},o.prototype.setVolume=function(e){this.adsManager.setVolume(e),this.adMuted=0==e},o.prototype.initializeAdDisplayContainer=function(){this.adDisplayContainer&&(this.adDisplayContainerInitialized||(this.adDisplayContainer.initialize(),this.adDisplayContainerInitialized=!0))},o.prototype.playAdBreak=function(){this.autoPlayAdBreaks||(this.controller.showAdContainer(),this.adsManager.setVolume(this.controller.getPlayerVolume()),this.adsManager.start())},o.prototype.addEventListener=function(e,t){this.adsManager&&this.adsManager.addEventListener(e,t)},o.prototype.getAdsManager=function(){return this.adsManager};function n(e,t){this.settings={},this.contentAndAdsEndedListeners=[],this.isMobile=navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/Android/i),this.isIos=navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i),this.initWithSettings(t);var n={debug:this.settings.debug,timeout:this.settings.timeout,prerollTimeout:this.settings.prerollTimeout},r=this.extend({},n,t.contribAdsSettings||{});this.playerWrapper=new i(e,r,this),this.adUi=new a(this),this.sdkImpl=new o(this)}n.IMA_DEFAULTS={adLabel:"Advertisement",adLabelNofN:"of",debug:!(o.prototype.reset=function(){this.adsActive=!1,this.adPlaying=!1,this.adTrackingTimer&&clearInterval(this.adTrackingTimer),this.adsManager&&(this.adsManager.destroy(),this.adsManager=null),this.adsLoader&&!this.contentCompleteCalled&&this.adsLoader.contentComplete(),this.contentCompleteCalled=!1,this.allAdsCompleted=!1}),disableAdControls:!1,prerollTimeout:1e3,preventLateAdStart:!1,requestMode:"onLoad",showControlsForJSAds:!0,timeout:5e3},n.prototype.initWithSettings=function(e){this.settings=this.extend({},n.IMA_DEFAULTS,e||{}),this.warnAboutDeprecatedSettings(),!(this.showCountdown=!0)===this.settings.showCountdown&&(this.showCountdown=!1)},n.prototype.warnAboutDeprecatedSettings=function(){var t=this;["adWillAutoplay","adsWillAutoplay","adWillPlayMuted","adsWillPlayMuted"].forEach(function(e){void 0!==t.settings[e]&&console.warn("WARNING: videojs.ima setting "+e+" is deprecated")})},n.prototype.getSettings=function(){return this.settings},n.prototype.getIsMobile=function(){return this.isMobile},n.prototype.getIsIos=function(){return this.isIos},n.prototype.injectAdContainerDiv=function(e){this.playerWrapper.injectAdContainerDiv(e)},n.prototype.getAdContainerDiv=function(){return this.adUi.getAdContainerDiv()},n.prototype.getContentPlayer=function(){return this.playerWrapper.getContentPlayer()},n.prototype.getContentPlayheadTracker=function(){return this.playerWrapper.getContentPlayheadTracker()},n.prototype.requestAds=function(){this.sdkImpl.requestAds()},n.prototype.setSetting=function(e,t){this.settings[e]=t},n.prototype.onErrorLoadingAds=function(e){this.adUi.onAdError(),this.playerWrapper.onAdError(e)},n.prototype.onAdPlayPauseClick=function(){this.sdkImpl.isAdPlaying()?(this.adUi.onAdsPaused(),this.sdkImpl.pauseAds()):(this.adUi.onAdsPlaying(),this.sdkImpl.resumeAds())},n.prototype.onAdMuteClick=function(){this.sdkImpl.isAdMuted()?(this.playerWrapper.unmute(),this.adUi.unmute(),this.sdkImpl.unmute()):(this.playerWrapper.mute(),this.adUi.mute(),this.sdkImpl.mute())},n.prototype.setVolume=function(e){this.playerWrapper.setVolume(e),this.sdkImpl.setVolume(e)},n.prototype.getPlayerVolume=function(){return this.playerWrapper.getVolume()},n.prototype.toggleFullscreen=function(){this.playerWrapper.toggleFullscreen()},n.prototype.onAdError=function(e){this.adUi.onAdError(),this.playerWrapper.onAdError(e)},n.prototype.onAdBreakStart=function(e){this.playerWrapper.onAdBreakStart(),this.adUi.onAdBreakStart(e)},n.prototype.showAdContainer=function(){this.adUi.showAdContainer()},n.prototype.onAdBreakEnd=function(){this.playerWrapper.onAdBreakEnd(),this.adUi.onAdBreakEnd()},n.prototype.onAllAdsCompleted=function(){this.adUi.onAllAdsCompleted(),this.playerWrapper.onAllAdsCompleted()},n.prototype.onAdsPaused=function(){this.adUi.onAdsPaused()},n.prototype.onAdsResumed=function(){this.adUi.onAdsResumed()},n.prototype.onAdPlayheadUpdated=function(e,t,n,r,i){this.adUi.updateAdUi(e,t,n,r,i)},n.prototype.onAdLog=function(e){this.playerWrapper.onAdLog(e)},n.prototype.getCurrentAd=function(){return this.sdkImpl.getCurrentAd()},n.prototype.playContent=function(){this.playerWrapper.play()},n.prototype.onLinearAdStart=function(){this.adUi.onLinearAdStart(),this.playerWrapper.onAdStart()},n.prototype.onNonLinearAdLoad=function(){this.adUi.onNonLinearAdLoad()},n.prototype.onNonLinearAdStart=function(){this.adUi.onNonLinearAdLoad(),this.playerWrapper.onAdStart()},n.prototype.getPlayerWidth=function(){return this.playerWrapper.getPlayerWidth()},n.prototype.getPlayerHeight=function(){return this.playerWrapper.getPlayerHeight()},n.prototype.onAdsReady=function(){this.playerWrapper.onAdsReady()},n.prototype.onPlayerResize=function(e,t){this.sdkImpl.onPlayerResize(e,t)},n.prototype.onContentComplete=function(){this.sdkImpl.onContentComplete()},n.prototype.onNoPostroll=function(){this.playerWrapper.onNoPostroll()},n.prototype.onContentAndAdsCompleted=function(){for(var e in this.contentAndAdsEndedListeners)"function"==typeof this.contentAndAdsEndedListeners[e]&&this.contentAndAdsEndedListeners[e]()},n.prototype.onPlayerDisposed=function(){this.contentAndAdsEndedListeners=[],this.sdkImpl.onPlayerDisposed()},n.prototype.onPlayerReadyForPreroll=function(){this.sdkImpl.onPlayerReadyForPreroll()},n.prototype.onAdTimeout=function(){this.sdkImpl.onAdTimeout()},n.prototype.onPlayerReady=function(){this.sdkImpl.onPlayerReady()},n.prototype.onPlayerEnterFullscreen=function(){this.adUi.onPlayerEnterFullscreen(),this.sdkImpl.onPlayerEnterFullscreen()},n.prototype.onPlayerExitFullscreen=function(){this.adUi.onPlayerExitFullscreen(),this.sdkImpl.onPlayerExitFullscreen()},n.prototype.onPlayerVolumeChanged=function(e){this.adUi.onPlayerVolumeChanged(e),this.sdkImpl.onPlayerVolumeChanged(e)},n.prototype.setContentWithAdTag=function(e,t){this.reset(),this.settings.adTagUrl=t||this.settings.adTagUrl,this.playerWrapper.changeSource(e)},n.prototype.setContentWithAdsResponse=function(e,t){this.reset(),this.settings.adsResponse=t||this.settings.adsResponse,this.playerWrapper.changeSource(e)},n.prototype.setContentWithAdsRequest=function(e,t){this.reset(),this.settings.adsRequest=t||this.settings.adsRequest,this.playerWrapper.changeSource(e)},n.prototype.reset=function(){this.sdkImpl.reset(),this.playerWrapper.reset(),this.adUi.reset()},n.prototype.addContentEndedListener=function(e){this.playerWrapper.addContentEndedListener(e)},n.prototype.addContentAndAdsEndedListener=function(e){this.contentAndAdsEndedListeners.push(e)},n.prototype.setAdBreakReadyListener=function(e){this.sdkImpl.setAdBreakReadyListener(e)},n.prototype.setShowCountdown=function(e){this.adUi.setShowCountdown(e),this.showCountdown=e,this.adUi.countdownDiv.style.display=this.showCountdown?"block":"none"},n.prototype.initializeAdDisplayContainer=function(){this.sdkImpl.initializeAdDisplayContainer()},n.prototype.playAdBreak=function(){this.sdkImpl.playAdBreak()},n.prototype.addEventListener=function(e,t){this.sdkImpl.addEventListener(e,t)},n.prototype.getAdsManager=function(){return this.sdkImpl.getAdsManager()},n.prototype.getPlayerId=function(){return this.playerWrapper.getPlayerId()},n.prototype.changeAdTag=function(e){this.reset(),this.settings.adTagUrl=e},n.prototype.pauseAd=function(){this.adUi.onAdsPaused(),this.sdkImpl.pauseAds()},n.prototype.resumeAd=function(){this.adUi.onAdsPlaying(),this.sdkImpl.resumeAds()},n.prototype.togglePlayback=function(){this.playerWrapper.togglePlayback()},n.prototype.adsWillAutoplay=function(){return void 0!==this.settings.adsWillAutoplay?this.settings.adsWillAutoplay:void 0!==this.settings.adWillAutoplay?this.settings.adWillAutoplay:!!this.playerWrapper.getPlayerOptions().autoplay},n.prototype.adsWillPlayMuted=function(){return void 0!==this.settings.adsWillPlayMuted?this.settings.adsWillPlayMuted:void 0!==this.settings.adWillPlayMuted?this.settings.adWillPlayMuted:void 0!==this.playerWrapper.getPlayerOptions().muted?this.playerWrapper.getPlayerOptions().muted:0==this.playerWrapper.getVolume()},n.prototype.triggerPlayerEvent=function(e,t){this.playerWrapper.triggerPlayerEvent(e,t)},n.prototype.extend=function(e){for(var t=void 0,n=void 0,r=void 0,i=arguments.length,a=Array(1<i?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];for(n=0;n<a.length;n++)for(r in t=a[n])t.hasOwnProperty(r)&&(e[r]=t[r]);return e};function s(e,t){this.controller=new n(e,t),this.addContentAndAdsEndedListener=function(e){this.controller.addContentAndAdsEndedListener(e)}.bind(this),this.addContentEndedListener=function(e){this.controller.addContentEndedListener(e)}.bind(this),this.addEventListener=function(e,t){this.controller.addEventListener(e,t)}.bind(this),this.changeAdTag=function(e){this.controller.changeAdTag(e)}.bind(this),this.getAdsManager=function(){return this.controller.getAdsManager()}.bind(this),this.initializeAdDisplayContainer=function(){this.controller.initializeAdDisplayContainer()}.bind(this),this.pauseAd=function(){this.controller.pauseAd()}.bind(this),this.playAdBreak=function(){this.controller.playAdBreak()}.bind(this),this.requestAds=function(){this.controller.requestAds()}.bind(this),this.resumeAd=function(){this.controller.resumeAd()}.bind(this),this.setAdBreakReadyListener=function(e){this.controller.setAdBreakReadyListener(e)}.bind(this),this.setContentWithAdTag=function(e,t){this.controller.setContentWithAdTag(e,t)}.bind(this),this.setContentWithAdsResponse=function(e,t){this.controller.setContentWithAdsResponse(e,t)}.bind(this),this.setContentWithAdsRequest=function(e,t){this.controller.setContentWithAdsRequest(e,t)}.bind(this),this.setShowCountdown=function(e){this.controller.setShowCountdown(e)}.bind(this)}return(e.registerPlugin||e.plugin)("ima",function(e){this.ima=new s(this,e)}),s}),function(e,t){"undefined"!=typeof window&&window.videojs?t(window.videojs):"function"==typeof define&&define.amd?define("videojs-hotkeys",["video.js"],function(e){return t(e.default||e)}):"undefined"!=typeof module&&module.exports&&(module.exports=t(require("video.js")))}(0,function(M){"use strict";"undefined"!=typeof window&&(window.videojs_hotkeys={version:"0.2.27"});(M.registerPlugin||M.plugin)("hotkeys",function(d){var h=this,f=h.el(),p=document,e={volumeStep:.1,seekStep:5,enableMute:!0,enableVolumeScroll:!0,enableHoverScroll:!1,enableFullscreen:!0,enableNumbers:!0,enableJogStyle:!1,alwaysCaptureHotkeys:!1,captureDocumentHotkeys:!1,documentHotkeysFocusElementFilter:function(){return!1},enableModifiersForNumbers:!0,enableInactiveFocus:!0,skipInitialFocus:!1,playPauseKey:function(e){return 32===e.which||179===e.which},rewindKey:function(e){return 37===e.which||177===e.which},forwardKey:function(e){return 39===e.which||176===e.which},volumeUpKey:function(e){return 38===e.which},volumeDownKey:function(e){return 40===e.which},muteKey:function(e){return 77===e.which},fullscreenKey:function(e){return 70===e.which},customKeys:{}},t=M.mergeOptions||M.util.mergeOptions,m=(d=t(e,d||{})).volumeStep,n=d.seekStep,g=d.enableMute,r=d.enableVolumeScroll,i=d.enableHoverScroll,v=d.enableFullscreen,y=d.enableNumbers,_=d.enableJogStyle,b=d.alwaysCaptureHotkeys,E=d.captureDocumentHotkeys,T=d.documentHotkeysFocusElementFilter,A=d.enableModifiersForNumbers,a=d.enableInactiveFocus,o=d.skipInitialFocus,s=M.VERSION;f.hasAttribute("tabIndex")||f.setAttribute("tabIndex","-1"),f.style.outline="none",!b&&h.autoplay()||o||h.one("play",function(){f.focus()}),a&&h.on("userinactive",function(){function n(){clearTimeout(e)}var e=setTimeout(function(){h.off("useractive",n);var e=p.activeElement,t=f.querySelector(".vjs-control-bar");e&&e.parentElement==t&&f.focus()},10);h.one("useractive",n)}),h.on("play",function(){var e=f.querySelector(".iframeblocker");e&&""===e.style.display&&(e.style.display="block",e.style.bottom="39px")});function l(e){var t,n,r=e.which,i=e.preventDefault.bind(e),a=h.duration();if(h.controls()){var o=p.activeElement;if(b||E&&T(o)||o==f||o==f.querySelector(".vjs-tech")||o==f.querySelector(".vjs-control-bar")||o==f.querySelector(".iframeblocker"))switch(S(e,h)){case 1:i(),(b||E)&&e.stopPropagation(),h.paused()?x(h.play()):h.pause();break;case 2:t=!h.paused(),i(),t&&h.pause(),(n=h.currentTime()-C(e))<=0&&(n=0),h.currentTime(n),t&&x(h.play());break;case 3:t=!h.paused(),i(),t&&h.pause(),a<=(n=h.currentTime()+C(e))&&(n=t?a-.001:a),h.currentTime(n),t&&x(h.play());break;case 5:i(),_?(n=h.currentTime()-1,h.currentTime()<=1&&(n=0),h.currentTime(n)):h.volume(h.volume()-m);break;case 4:i(),_?(a<=(n=h.currentTime()+1)&&(n=a),h.currentTime(n)):h.volume(h.volume()+m);break;case 6:g&&h.muted(!h.muted());break;case 7:v&&(h.isFullscreen()?h.exitFullscreen():h.requestFullscreen());break;default:if((47<r&&r<59||95<r&&r<106)&&(A||!(e.metaKey||e.ctrlKey||e.altKey))&&y){var s=48;95<r&&(s=96);var l=r-s;i(),h.currentTime(h.duration()*l*.1)}for(var u in d.customKeys){var c=d.customKeys[u];c&&c.key&&c.handler&&c.key(e)&&(i(),c.handler(h,d,e))}}}}var u=!1,c=f.querySelector(".vjs-volume-menu-button")||f.querySelector(".vjs-volume-panel");null!=c&&(c.onmouseover=function(){u=!0},c.onmouseout=function(){u=!1});function w(e){if(i)var t=0;else t=p.activeElement;if(h.controls()&&(b||t==f||t==f.querySelector(".vjs-tech")||t==f.querySelector(".iframeblocker")||t==f.querySelector(".vjs-control-bar")||u)&&r){e=window.event||e;var n=Math.max(-1,Math.min(1,e.wheelDelta||-e.detail));e.preventDefault(),1==n?h.volume(h.volume()+m):-1==n&&h.volume(h.volume()-m)}}var S=function(e,t){return d.playPauseKey(e,t)?1:d.rewindKey(e,t)?2:d.forwardKey(e,t)?3:d.volumeUpKey(e,t)?4:d.volumeDownKey(e,t)?5:d.muteKey(e,t)?6:d.fullscreenKey(e,t)?7:void 0};function C(e){return"function"==typeof n?n(e):n}function x(e){null!=e&&"function"==typeof e.then&&e.then(null,function(e){})}return h.on("keydown",l),h.on("dblclick",function(e){if(null!=s&&s<="7.1.0"&&h.controls()){var t=e.relatedTarget||e.toElement||p.activeElement;t!=f&&t!=f.querySelector(".vjs-tech")&&t!=f.querySelector(".iframeblocker")||v&&(h.isFullscreen()?h.exitFullscreen():h.requestFullscreen())}}),h.on("mousewheel",w),h.on("DOMMouseScroll",w),E&&document.addEventListener("keydown",function(e){l(e)}),this})}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("video.js"),require("global/document"),require("global/window")):"function"==typeof define&&define.amd?define(["video.js","global/document","global/window"],t):e.videojsContextmenuUi=t(e.videojs,e.document,e.window)}(this,function(s,c,d){"use strict";function n(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}s=s&&s.hasOwnProperty("default")?s.default:s,c=c&&c.hasOwnProperty("default")?c.default:c,d=d&&d.hasOwnProperty("default")?d.default:d;var i=function(t){function e(){return t.apply(this,arguments)||this}return n(e,t),e.prototype.handleClick=function(){var e=this;t.prototype.handleClick.call(this),this.options_.listener(),d.setTimeout(function(){e.player().contextmenuUI.menu.dispose()},1)},e}(s.getComponent("MenuItem")),e=s.getComponent("Menu"),r=s.dom||s,l=function(t){function e(n,e){var r;return(r=t.call(this,n,e)||this).dispose=s.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(r),r.dispose),e.content.forEach(function(e){var t=function(){};"function"==typeof e.listener?t=e.listener:"string"==typeof e.href&&(t=function(){return d.open(e.href)}),r.addItem(new i(n,{label:e.label,listener:s.bind(n,t)}))}),r}return n(e,t),e.prototype.createEl=function(){var e=t.prototype.createEl.call(this);return r.addClass(e,"vjs-contextmenu-ui-menu"),e.style.left=this.options_.position.left+"px",e.style.top=this.options_.position.top+"px",e},e}(e);function u(e,t){var n={},r=function(e){var t;if(e.getBoundingClientRect&&e.parentNode&&(t=e.getBoundingClientRect()),!t)return{left:0,top:0};var n=c.documentElement,r=c.body,i=n.clientLeft||r.clientLeft||0,a=d.pageXOffset||r.scrollLeft,o=t.left+a-i,s=n.clientTop||r.clientTop||0,l=d.pageYOffset||r.scrollTop,u=t.top+l-s;return{left:Math.round(o),top:Math.round(u)}}(e),i=e.offsetWidth,a=e.offsetHeight,o=r.top,s=r.left,l=t.pageY,u=t.pageX;return t.changedTouches&&(u=t.changedTouches[0].pageX,l=t.changedTouches[0].pageY),n.y=Math.max(0,Math.min(1,(o-l+a)/a)),n.x=Math.max(0,Math.min(1,(u-s)/i)),n}var a="5.2.0";function h(e){return e.hasOwnProperty("contextmenuUI")&&e.contextmenuUI.hasOwnProperty("menu")&&e.contextmenuUI.menu.el()}function o(e){var t=e.tagName.toLowerCase();return"input"===t||"textarea"===t}function f(e){var t=this;if(h(this))this.contextmenuUI.menu.dispose();else if(!this.contextmenuUI.options_.excludeElements(e.target)){var n=function(e,t){return{left:Math.round(t.width*e.x),top:Math.round(t.height-t.height*e.y)}}(u(this.el(),e),this.el().getBoundingClientRect()),r=s.browser.IS_FIREFOX?c.documentElement:c;e.preventDefault();var i=this.contextmenuUI.menu=new l(this,{content:this.contextmenuUI.content,position:n});this.contextmenuUI.closeMenu=function(){s.log.warn("player.contextmenuUI.closeMenu() is deprecated, please use player.contextmenuUI.menu.dispose() instead!"),i.dispose()},i.on("dispose",function(){s.off(r,["click","tap"],i.dispose),t.removeChild(i),delete t.contextmenuUI.menu}),this.addChild(i);var a=i.el_.getBoundingClientRect(),o=c.body.getBoundingClientRect();(this.contextmenuUI.keepInside||a.right>o.width||a.bottom>o.height)&&(i.el_.style.left=Math.floor(Math.min(n.left,this.player_.currentWidth()-i.currentWidth()))+"px",i.el_.style.top=Math.floor(Math.min(n.top,this.player_.currentHeight()-i.currentHeight()))+"px"),s.on(r,["click","tap"],i.dispose)}}function p(e){var t=this,n={keepInside:!0,excludeElements:o};if(e=s.mergeOptions(n,e),!Array.isArray(e.content))throw new Error('"content" required');h(this)&&(this.contextmenuUI.menu.dispose(),this.off("contextmenu",this.contextmenuUI.onContextMenu),delete this.contextmenuUI);var r=this.contextmenuUI=function(){p.apply(this,arguments)};r.onContextMenu=s.bind(this,f),r.content=e.content,r.keepInside=e.keepInside,r.options_=e,r.VERSION=a,this.on("contextmenu",r.onContextMenu),this.ready(function(){return t.addClass("vjs-contextmenu-ui")})}return s.registerPlugin("contextmenuUI",p),p.VERSION=a,p}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("video.js"),require("global/window")):"function"==typeof define&&define.amd?define(["video.js","global/window"],t):e.videojsMobileUi=t(e.videojs,e.window)}(this,function(a,o){"use strict";a=a&&a.hasOwnProperty("default")?a.default:a,o=o&&o.hasOwnProperty("default")?o.default:o;var r,e=a.getComponent("Component"),t=a.dom||a,n=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(i,r=e),i.prototype.createEl=function(){return t.createEl("div",{className:"vjs-touch-overlay",tabIndex:-1})},i.prototype.handleTap=function(e){var t=this;e.target===this.el_&&(e.preventDefault(),this.firstTapCaptured?(this.firstTapCaptured=!1,this.timeout&&o.clearTimeout(this.timeout),this.handleDoubleTap(e)):(this.firstTapCaptured=!0,this.timeout=o.setTimeout(function(){t.firstTapCaptured=!1,t.handleSingleTap(e)},this.tapTimeout)))},i.prototype.handleSingleTap=function(){this.removeClass("skip"),this.toggleClass("show-play-toggle")},i.prototype.handleDoubleTap=function(e){var t=this,n=this.el_.getBoundingClientRect(),r=e.changedTouches[0].clientX-n.left;if(r<.4*n.width)this.player_.currentTime(Math.max(0,this.player_.currentTime()-this.seekSeconds)),this.addClass("reverse");else{if(!(r>n.width-.4*n.width))return;this.player_.currentTime(Math.min(this.player_.duration(),this.player_.currentTime()+this.seekSeconds)),this.removeClass("reverse")}this.removeClass("show-play-toggle"),this.removeClass("skip"),o.requestAnimationFrame(function(){t.addClass("skip")})},i.prototype.enable=function(){this.firstTapCaptured=!1,this.on("touchend",this.handleTap)},i.prototype.disable=function(){this.off("touchend",this.handleTap)},i);function i(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,r.call(this,e,t));return n.seekSeconds=t.seekSeconds,n.tapTimeout=t.tapTimeout,n.addChild("playToggle",{}),e.on(["playing","userinactive"],function(e){n.removeClass("show-play-toggle")}),0===n.player_.options_.inactivityTimeout&&(n.player_.options_.inactivityTimeout=5e3),n.enable(),n}e.registerComponent("TouchOverlay",n);function s(t,n){t.addClass("vjs-mobile-ui"),!n.touchControls.disableOnEnd&&"function"!=typeof t.endscreen||t.addClass("vjs-mobile-ui-disable-end"),n.fullscreen.iOS&&a.browser.IS_IOS&&9<a.browser.IOS_VERSION&&!t.el_.ownerDocument.querySelector(".bc-iframe")&&(t.tech_.el_.setAttribute("playsinline","playsinline"),t.tech_.supportsFullScreen=function(){return!1});var e=t.children_.indexOf(t.getChild("ControlBar"))-1;function r(){var e="number"==typeof o.orientation?o.orientation:c&&c.orientation&&c.orientation.angle?o.orientation:(a.log("angle unknown"),0);90!==e&&270!==e&&-90!==e||!1===t.paused()&&(t.requestFullscreen(),n.fullscreen.lockOnRotate&&c.orientation&&c.orientation.lock&&c.orientation.lock("landscape").then(function(){i=!0}).catch(function(){a.log("orientation lock not allowed")})),0!==e&&180!==e||t.isFullscreen()&&t.exitFullscreen()}t.addChild("touchOverlay",n.touchControls,e);var i=!1;a.browser.IS_IOS?o.addEventListener("orientationchange",r):c.orientation.onchange=r,t.on("ended",function(e){!0===i&&(c.orientation.unlock(),i=!1)})}function l(e){var t=this;(a.browser.IS_ANDROID||a.browser.IS_IOS)&&this.ready(function(){s(t,a.mergeOptions(u,e))})}var u={fullscreen:{enterOnRotate:!0,lockOnRotate:!0,iOS:!1},touchControls:{seekSeconds:10,tapTimeout:300,disableOnEnd:!1}},c=o.screen,d=a.registerPlugin||a.plugin;return d("mobileUi",l),l.VERSION="0.4.1",l}),function a(o,s,l){function u(t,e){if(!s[t]){if(!o[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(c)return c(t,!0);var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}var i=s[t]={exports:{}};o[t][0].call(i.exports,function(e){return u(o[t][1][e]||e)},i,i.exports,a,o,s,l)}return s[t].exports}for(var c="function"==typeof require&&require,e=0;e<l.length;e++)u(l[e]);return u}({1:[function(e,t,n){!function(){var a=!1,o=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){},Class.extend=function(e){var i=this.prototype;a=!0;var t=new this;for(var n in a=!1,e)t[n]="function"==typeof e[n]&&"function"==typeof i[n]&&o.test(e[n])?function(n,r){return function(){var e=this._super;this._super=i[n];var t=r.apply(this,arguments);return this._super=e,t}}(n,e[n]):e[n];function r(){!a&&this.init&&this.init.apply(this,arguments)}return((r.prototype=t).constructor=r).extend=arguments.callee,r},t.exports=Class}()},{}],2:[function(e,t,n){function r(){this.name="__st"+(1e9*Math.random()>>>0)+a+++"__"}var i,a,o,s,l,u,c;!function(){window.WebComponents=window.WebComponents||{flags:{}};var e=document.querySelector('script[src*="webcomponents-lite.js"]'),r={};if(!r.noOpts){if(location.search.slice(1).split("&").forEach(function(e){var t,n=e.split("=");n[0]&&(t=n[0].match(/wc-(.+)/))&&(r[t[1]]=n[1]||!0)}),e)for(var t,n=0;t=e.attributes[n];n++)"src"!==t.name&&(r[t.name]=t.value||!0);if(r.log&&r.log.split){var i=r.log.split(",");r.log={},i.forEach(function(e){r.log[e]=!0})}else r.log={}}r.register&&(window.CustomElements=window.CustomElements||{flags:{}},window.CustomElements.flags.register=r.register),WebComponents.flags=r}(),function(e){"use strict";var t=!1;if(!e.forceJURL)try{var n=new URL("b","http://a");n.pathname="c%20d",t="http://a/c%20d"===n.href}catch(e){}if(!t){var b=Object.create(null);b.ftp=21,b.file=0,b.gopher=70,b.http=80,b.https=443,b.ws=80,b.wss=443;var E=Object.create(null);E["%2e"]=".",E[".%2e"]="..",E["%2e."]="..",E["%2e%2e"]="..";var T=void 0,A=/[a-zA-Z]/,w=/[a-zA-Z0-9\+\-\.]/;o.prototype={toString:function(){return this.href},get href(){if(this._isInvalid)return this._url;var e="";return""==this._username&&null==this._password||(e=this._username+(null!=this._password?":"+this._password:"")+"@"),this.protocol+(this._isRelative?"//"+e+this.host:"")+this.pathname+this._query+this._fragment},set href(e){a.call(this),i.call(this,e)},get protocol(){return this._scheme+":"},set protocol(e){this._isInvalid||i.call(this,e+":","scheme start")},get host(){return this._isInvalid?"":this._port?this._host+":"+this._port:this._host},set host(e){!this._isInvalid&&this._isRelative&&i.call(this,e,"host")},get hostname(){return this._host},set hostname(e){!this._isInvalid&&this._isRelative&&i.call(this,e,"hostname")},get port(){return this._port},set port(e){!this._isInvalid&&this._isRelative&&i.call(this,e,"port")},get pathname(){return this._isInvalid?"":this._isRelative?"/"+this._path.join("/"):this._schemeData},set pathname(e){!this._isInvalid&&this._isRelative&&(this._path=[],i.call(this,e,"relative path start"))},get search(){return this._isInvalid||!this._query||"?"==this._query?"":this._query},set search(e){!this._isInvalid&&this._isRelative&&((this._query="?")==e[0]&&(e=e.slice(1)),i.call(this,e,"query"))},get hash(){return this._isInvalid||!this._fragment||"#"==this._fragment?"":this._fragment},set hash(e){this._isInvalid||((this._fragment="#")==e[0]&&(e=e.slice(1)),i.call(this,e,"fragment"))},get origin(){var e;if(this._isInvalid||!this._scheme)return"";switch(this._scheme){case"data":case"file":case"javascript":case"mailto":return"null"}return(e=this.host)?this._scheme+"://"+e:""}};var r=e.URL;r&&(o.createObjectURL=function(e){return r.createObjectURL.apply(r,arguments)},o.revokeObjectURL=function(e){r.revokeObjectURL(e)}),e.URL=o}function S(e){return void 0!==b[e]}function C(){a.call(this),this._isInvalid=!0}function x(e){return""==e&&C.call(this),e.toLowerCase()}function M(e){var t=e.charCodeAt(0);return 32<t&&t<127&&-1==[34,35,60,62,63,96].indexOf(t)?e:encodeURIComponent(e)}function i(e,t,n){function r(e){d.push(e)}var i,a,o=t||"scheme start",s=0,l="",u=!1,c=!1,d=[];e:for(;(e[s-1]!=T||0==s)&&!this._isInvalid;){var h=e[s];switch(o){case"scheme start":if(!h||!A.test(h)){if(t){r("Invalid scheme.");break e}l="",o="no scheme";continue}l+=h.toLowerCase(),o="scheme";break;case"scheme":if(h&&w.test(h))l+=h.toLowerCase();else{if(":"!=h){if(t){if(T==h)break e;r("Code point not allowed in scheme: "+h);break e}l="",s=0,o="no scheme";continue}if(this._scheme=l,l="",t)break e;S(this._scheme)&&(this._isRelative=!0),o="file"==this._scheme?"relative":this._isRelative&&n&&n._scheme==this._scheme?"relative or authority":this._isRelative?"authority first slash":"scheme data"}break;case"scheme data":"?"==h?(this._query="?",o="query"):"#"==h?(this._fragment="#",o="fragment"):T!=h&&"\t"!=h&&"\n"!=h&&"\r"!=h&&(this._schemeData+=M(h));break;case"no scheme":if(n&&S(n._scheme)){o="relative";continue}r("Missing scheme."),C.call(this);break;case"relative or authority":if("/"!=h||"/"!=e[s+1]){r("Expected /, got: "+h),o="relative";continue}o="authority ignore slashes";break;case"relative":if(this._isRelative=!0,"file"!=this._scheme&&(this._scheme=n._scheme),T==h){this._host=n._host,this._port=n._port,this._path=n._path.slice(),this._query=n._query,this._username=n._username,this._password=n._password;break e}if("/"==h||"\\"==h)"\\"==h&&r("\\ is an invalid code point."),o="relative slash";else if("?"==h)this._host=n._host,this._port=n._port,this._path=n._path.slice(),this._query="?",this._username=n._username,this._password=n._password,o="query";else{if("#"!=h){var f=e[s+1],p=e[s+2];("file"!=this._scheme||!A.test(h)||":"!=f&&"|"!=f||T!=p&&"/"!=p&&"\\"!=p&&"?"!=p&&"#"!=p)&&(this._host=n._host,this._port=n._port,this._username=n._username,this._password=n._password,this._path=n._path.slice(),this._path.pop()),o="relative path";continue}this._host=n._host,this._port=n._port,this._path=n._path.slice(),this._query=n._query,this._fragment="#",this._username=n._username,this._password=n._password,o="fragment"}break;case"relative slash":if("/"!=h&&"\\"!=h){"file"!=this._scheme&&(this._host=n._host,this._port=n._port,this._username=n._username,this._password=n._password),o="relative path";continue}"\\"==h&&r("\\ is an invalid code point."),o="file"==this._scheme?"file host":"authority ignore slashes";break;case"authority first slash":if("/"!=h){r("Expected '/', got: "+h),o="authority ignore slashes";continue}o="authority second slash";break;case"authority second slash":if(o="authority ignore slashes","/"==h)break;r("Expected '/', got: "+h);continue;case"authority ignore slashes":if("/"!=h&&"\\"!=h){o="authority";continue}r("Expected authority, got: "+h);break;case"authority":if("@"==h){u&&(r("@ already seen."),l+="%40"),u=!0;for(var m=0;m<l.length;m++){var g=l[m];if("\t"!=g&&"\n"!=g&&"\r"!=g)if(":"!=g||null!==this._password){var v=M(g);null!==this._password?this._password+=v:this._username+=v}else this._password="";else r("Invalid whitespace in authority.")}l=""}else{if(T==h||"/"==h||"\\"==h||"?"==h||"#"==h){s-=l.length,l="",o="host";continue}l+=h}break;case"file host":if(T==h||"/"==h||"\\"==h||"?"==h||"#"==h){o=2!=l.length||!A.test(l[0])||":"!=l[1]&&"|"!=l[1]?(0==l.length||(this._host=x.call(this,l),l=""),"relative path start"):"relative path";continue}"\t"==h||"\n"==h||"\r"==h?r("Invalid whitespace in file host."):l+=h;break;case"host":case"hostname":if(":"!=h||c){if(T==h||"/"==h||"\\"==h||"?"==h||"#"==h){if(this._host=x.call(this,l),l="",o="relative path start",t)break e;continue}"\t"!=h&&"\n"!=h&&"\r"!=h?("["==h?c=!0:"]"==h&&(c=!1),l+=h):r("Invalid code point in host/hostname: "+h)}else if(this._host=x.call(this,l),l="",o="port","hostname"==t)break e;break;case"port":if(/[0-9]/.test(h))l+=h;else{if(T==h||"/"==h||"\\"==h||"?"==h||"#"==h||t){if(""!=l){var y=parseInt(l,10);y!=b[this._scheme]&&(this._port=y+""),l=""}if(t)break e;o="relative path start";continue}"\t"==h||"\n"==h||"\r"==h?r("Invalid code point in port: "+h):C.call(this)}break;case"relative path start":if("\\"==h&&r("'\\' not allowed in path."),o="relative path","/"!=h&&"\\"!=h)continue;break;case"relative path":var _;if(T!=h&&"/"!=h&&"\\"!=h&&(t||"?"!=h&&"#"!=h))"\t"!=h&&"\n"!=h&&"\r"!=h&&(l+=M(h));else"\\"==h&&r("\\ not allowed in relative path."),(_=E[l.toLowerCase()])&&(l=_),".."==l?(this._path.pop(),"/"!=h&&"\\"!=h&&this._path.push("")):"."==l&&"/"!=h&&"\\"!=h?this._path.push(""):"."!=l&&("file"==this._scheme&&0==this._path.length&&2==l.length&&A.test(l[0])&&"|"==l[1]&&(l=l[0]+":"),this._path.push(l)),l="","?"==h?(this._query="?",o="query"):"#"==h&&(this._fragment="#",o="fragment");break;case"query":t||"#"!=h?T!=h&&"\t"!=h&&"\n"!=h&&"\r"!=h&&(this._query+=(void 0,32<(a=(i=h).charCodeAt(0))&&a<127&&-1==[34,35,60,62,96].indexOf(a)?i:encodeURIComponent(i))):(this._fragment="#",o="fragment");break;case"fragment":T!=h&&"\t"!=h&&"\n"!=h&&"\r"!=h&&(this._fragment+=h)}s++}}function a(){this._scheme="",this._schemeData="",this._username="",this._password=null,this._host="",this._port="",this._path=[],this._query="",this._fragment="",this._isInvalid=!1,this._isRelative=!1}function o(e,t){void 0===t||t instanceof o||(t=new o(String(t))),this._url=e,a.call(this);var n=e.replace(/^[ \t\r\n\f]+|[ \t\r\n\f]+$/g,"");i.call(this,n,null,t)}}(self),"undefined"==typeof WeakMap&&(i=Object.defineProperty,a=Date.now()%1e9,r.prototype={set:function(e,t){var n=e[this.name];return n&&n[0]===e?n[1]=t:i(e,this.name,{value:[e,t],writable:!0}),this},get:function(e){var t;return(t=e[this.name])&&t[0]===e?t[1]:void 0},delete:function(e){var t=e[this.name];return!(!t||t[0]!==e)&&(t[0]=t[1]=void 0,!0)},has:function(e){var t=e[this.name];return!!t&&t[0]===e}},window.WeakMap=r),function(e){if(!e.JsMutationObserver){var i,l=new WeakMap;if(/Trident|Edge/.test(navigator.userAgent))i=setTimeout;else if(window.setImmediate)i=window.setImmediate;else{var n=[],r=String(Math.random());window.addEventListener("message",function(e){if(e.data===r){var t=n;n=[],t.forEach(function(e){e()})}}),i=function(e){n.push(e),window.postMessage(r,"*")}}var d,h,a=!1,o=[],t=0;u.prototype={observe:function(e,t){if(e=function(e){return window.ShadowDOMPolyfill&&window.ShadowDOMPolyfill.wrapIfNeeded(e)||e}(e),!t.childList&&!t.attributes&&!t.characterData||t.attributeOldValue&&!t.attributes||t.attributeFilter&&t.attributeFilter.length&&!t.attributes||t.characterDataOldValue&&!t.characterData)throw new SyntaxError;var n,r=l.get(e);r||l.set(e,r=[]);for(var i=0;i<r.length;i++)if(r[i].observer===this){(n=r[i]).removeListeners(),n.options=t;break}n||(n=new v(this,e,t),r.push(n),this.nodes_.push(e)),n.addListeners()},disconnect:function(){this.nodes_.forEach(function(e){for(var t=l.get(e),n=0;n<t.length;n++){var r=t[n];if(r.observer===this){r.removeListeners(),t.splice(n,1);break}}},this),this.records_=[]},takeRecords:function(){var e=this.records_;return this.records_=[],e}},v.prototype={enqueue:function(e){var t=this.observer.records_,n=t.length;if(0<t.length){var r=g(t[n-1],e);if(r)return void(t[n-1]=r)}else!function(e){o.push(e),a||(a=!0,i(s))}(this.observer);t[n]=e},addListeners:function(){this.addListeners_(this.target)},addListeners_:function(e){var t=this.options;t.attributes&&e.addEventListener("DOMAttrModified",this,!0),t.characterData&&e.addEventListener("DOMCharacterDataModified",this,!0),t.childList&&e.addEventListener("DOMNodeInserted",this,!0),(t.childList||t.subtree)&&e.addEventListener("DOMNodeRemoved",this,!0)},removeListeners:function(){this.removeListeners_(this.target)},removeListeners_:function(e){var t=this.options;t.attributes&&e.removeEventListener("DOMAttrModified",this,!0),t.characterData&&e.removeEventListener("DOMCharacterDataModified",this,!0),t.childList&&e.removeEventListener("DOMNodeInserted",this,!0),(t.childList||t.subtree)&&e.removeEventListener("DOMNodeRemoved",this,!0)},addTransientObserver:function(e){if(e!==this.target){this.addListeners_(e),this.transientObservedNodes.push(e);var t=l.get(e);t||l.set(e,t=[]),t.push(this)}},removeTransientObservers:function(){var e=this.transientObservedNodes;this.transientObservedNodes=[],e.forEach(function(e){this.removeListeners_(e);for(var t=l.get(e),n=0;n<t.length;n++)if(t[n]===this){t.splice(n,1);break}},this)},handleEvent:function(e){switch(e.stopImmediatePropagation(),e.type){case"DOMAttrModified":var t=e.attrName,n=e.relatedNode.namespaceURI,r=e.target;(a=new p("attributes",r)).attributeName=t,a.attributeNamespace=n;var i=e.attrChange===MutationEvent.ADDITION?null:e.prevValue;f(r,function(e){if(e.attributes&&(!e.attributeFilter||!e.attributeFilter.length||-1!==e.attributeFilter.indexOf(t)||-1!==e.attributeFilter.indexOf(n)))return e.attributeOldValue?m(i):a});break;case"DOMCharacterDataModified":var a=p("characterData",r=e.target);i=e.prevValue;f(r,function(e){if(e.characterData)return e.characterDataOldValue?m(i):a});break;case"DOMNodeRemoved":this.addTransientObserver(e.target);case"DOMNodeInserted":var o,s,l=e.target;s="DOMNodeInserted"===e.type?(o=[l],[]):(o=[],[l]);var u=l.previousSibling,c=l.nextSibling;(a=p("childList",e.target.parentNode)).addedNodes=o,a.removedNodes=s,a.previousSibling=u,a.nextSibling=c,f(e.relatedNode,function(e){if(e.childList)return a})}d=h=void 0}},e.JsMutationObserver=u,e.MutationObserver||((e.MutationObserver=u)._isPolyfilled=!0)}function s(){a=!1;var e=o;o=[],e.sort(function(e,t){return e.uid_-t.uid_});var n=!1;e.forEach(function(e){var t=e.takeRecords();!function(n){n.nodes_.forEach(function(e){var t=l.get(e);t&&t.forEach(function(e){e.observer===n&&e.removeTransientObservers()})})}(e),t.length&&(e.callback_(t,e),n=!0)}),n&&s()}function f(e,t){for(var n=e;n;n=n.parentNode){var r=l.get(n);if(r)for(var i=0;i<r.length;i++){var a=r[i],o=a.options;if(n===e||o.subtree){var s=t(o);s&&a.enqueue(s)}}}}function u(e){this.callback_=e,this.nodes_=[],this.records_=[],this.uid_=++t}function c(e,t){this.type=e,this.target=t,this.addedNodes=[],this.removedNodes=[],this.previousSibling=null,this.nextSibling=null,this.attributeName=null,this.attributeNamespace=null,this.oldValue=null}function p(e,t){return d=new c(e,t)}function m(e){return h||((h=function(e){var t=new c(e.type,e.target);return t.addedNodes=e.addedNodes.slice(),t.removedNodes=e.removedNodes.slice(),t.previousSibling=e.previousSibling,t.nextSibling=e.nextSibling,t.attributeName=e.attributeName,t.attributeNamespace=e.attributeNamespace,t.oldValue=e.oldValue,t}(d)).oldValue=e,h)}function g(e,t){return e===t?e:h&&function(e){return e===h||e===d}(e)?h:null}function v(e,t,n){this.observer=e,this.target=t,this.options=n,this.transientObservedNodes=[]}}(self),function(){var n,r="undefined"==typeof HTMLTemplateElement;/Trident/.test(navigator.userAgent)&&(n=document.importNode,document.importNode=function(){var e=n.apply(document,arguments);if(e.nodeType!==Node.DOCUMENT_FRAGMENT_NODE)return e;var t=document.createDocumentFragment();return t.appendChild(e),t});function a(){}var e=function(){if(!r){var e=document.createElement("template"),t=document.createElement("template");t.content.appendChild(document.createElement("div")),e.content.appendChild(t);var n=e.cloneNode(!0);return 0===n.content.childNodes.length||0===n.content.firstChild.content.childNodes.length}}(),l="template";if(r){var i=document.implementation.createHTMLDocument("template"),o=!0,t=document.createElement("style");t.textContent=l+"{display:none;}";var s=document.head;s.insertBefore(t,s.firstElementChild),a.prototype=Object.create(HTMLElement.prototype),a.decorate=function(e){if(!e.content){var t;for(e.content=i.createDocumentFragment();t=e.firstChild;)e.content.appendChild(t);if(e.cloneNode=function(e){return a.cloneNode(this,e)},o)try{Object.defineProperty(e,"innerHTML",{get:function(){for(var e="",t=this.content.firstChild;t;t=t.nextSibling)e+=t.outerHTML||t.data.replace(c,d);return e},set:function(e){for(i.body.innerHTML=e,a.bootstrap(i);this.content.firstChild;)this.content.removeChild(this.content.firstChild);for(;i.body.firstChild;)this.content.appendChild(i.body.firstChild)},configurable:!0})}catch(e){o=!1}a.bootstrap(e.content)}},a.bootstrap=function(e){for(var t,n=e.querySelectorAll(l),r=0,i=n.length;r<i&&(t=n[r]);r++)a.decorate(t)},document.addEventListener("DOMContentLoaded",function(){a.bootstrap(document)});var u=document.createElement;document.createElement=function(){"use strict";var e=u.apply(document,arguments);return"template"===e.localName&&a.decorate(e),e};var c=/[&\u00A0<>]/g;function d(e){switch(e){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case" ":return"&nbsp;"}}}if(r||e){var h=Node.prototype.cloneNode;a.cloneNode=function(e,t){var n=h.call(e,!1);return this.decorate&&this.decorate(n),t&&(n.content.appendChild(h.call(e.content,!0)),this.fixClonedDom(n.content,e.content)),n},a.fixClonedDom=function(e,t){if(t.querySelectorAll)for(var n,r,i=t.querySelectorAll(l),a=e.querySelectorAll(l),o=0,s=a.length;o<s;o++)r=i[o],n=a[o],this.decorate&&this.decorate(r),n.parentNode.replaceChild(r.cloneNode(!0),n)};var f=document.importNode;Node.prototype.cloneNode=function(e){var t=h.call(this,e);return e&&a.fixClonedDom(t,this),t},document.importNode=function(e,t){if(e.localName===l)return a.cloneNode(e,t);var n=f.call(document,e,t);return t&&a.fixClonedDom(n,e),n},e&&(HTMLTemplateElement.prototype.cloneNode=function(e){return a.cloneNode(this,e)})}r&&(window.HTMLTemplateElement=a)}(),function(){"use strict";if(!window.performance||!window.performance.now){var e=Date.now();window.performance={now:function(){return Date.now()-e}}}var t,n;if(window.requestAnimationFrame||(window.requestAnimationFrame=(t=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame)?function(e){return t(function(){e(performance.now())})}:function(e){return window.setTimeout(e,1e3/60)}),window.cancelAnimationFrame||(window.cancelAnimationFrame=window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(e){clearTimeout(e)}),!((n=document.createEvent("Event")).initEvent("foo",!0,!0),n.preventDefault(),n.defaultPrevented)){var r=Event.prototype.preventDefault;Event.prototype.preventDefault=function(){this.cancelable&&(r.call(this),Object.defineProperty(this,"defaultPrevented",{get:function(){return!0},configurable:!0}))}}var i=/Trident/.test(navigator.userAgent);if((!window.CustomEvent||i&&"function"!=typeof window.CustomEvent)&&(window.CustomEvent=function(e,t){t=t||{};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,Boolean(t.bubbles),Boolean(t.cancelable),t.detail),n},window.CustomEvent.prototype=window.Event.prototype),!window.Event||i&&"function"!=typeof window.Event){var a=window.Event;window.Event=function(e,t){t=t||{};var n=document.createEvent("Event");return n.initEvent(e,Boolean(t.bubbles),Boolean(t.cancelable)),n},window.Event.prototype=a.prototype}}(window.WebComponents),window.HTMLImports=window.HTMLImports||{flags:{}},function(e){function t(e){return n?window.ShadowDOMPolyfill.wrapIfNeeded(e):e}var f=Boolean("import"in document.createElement("link")),n=Boolean(window.ShadowDOMPolyfill),r=t(document),i={get:function(){var e=window.HTMLImports.currentScript||document.currentScript||("complete"!==document.readyState?document.scripts[document.scripts.length-1]:null);return t(e)},configurable:!0};Object.defineProperty(document,"_currentScript",i),Object.defineProperty(r,"_currentScript",i);var a=/Trident/.test(navigator.userAgent);function o(e,t){(function e(t,n){if(i=n,"complete"!==i.readyState&&i.readyState!==s){var r=function(){"complete"!==n.readyState&&n.readyState!==s||(n.removeEventListener(l,r),e(t,n))};n.addEventListener(l,r)}else t&&t();var i})(function(){!function(e,t){var n=t.querySelectorAll("link[rel=import]"),r=0,i=n.length,a=[],o=[];function s(){r==i&&e&&e({allImports:n,loadedImports:a,errorImports:o})}function l(e){p(e),a.push(this),r++,s()}function u(e){o.push(this),r++,s()}if(i)for(var c,d=0;d<i&&(c=n[d]);d++)h=c,(f?h.__loaded||h.import&&"loading"!==h.import.readyState:h.__importParsed)?(a.push(this),r++,s()):(c.addEventListener("load",l),c.addEventListener("error",u));else s();var h}(e,t)},t=t||r)}var s=a?"complete":"interactive",l="readystatechange";function p(e){e.target.__loaded=!0}if(f){function u(e){for(var t,n=0,r=e.length;n<r&&(t=e[n]);n++)"link"===(i=t).localName&&"import"===i.rel&&c(t);var i}function c(e){e.import?p({target:e}):(e.addEventListener("load",p),e.addEventListener("error",p))}new MutationObserver(function(e){for(var t,n=0,r=e.length;n<r&&(t=e[n]);n++)t.addedNodes&&u(t.addedNodes)}).observe(document.head,{childList:!0}),function(){if("loading"===document.readyState)for(var e,t=document.querySelectorAll("link[rel=import]"),n=0,r=t.length;n<r&&(e=t[n]);n++)c(e)}()}o(function(e){window.HTMLImports.ready=!0,window.HTMLImports.readyTime=(new Date).getTime();var t=r.createEvent("CustomEvent");t.initCustomEvent("HTMLImportsLoaded",!0,!0,e),r.dispatchEvent(t)}),e.IMPORT_LINK_TYPE="import",e.useNative=f,e.rootDocument=r,e.whenReady=o,e.isIE=a}(window.HTMLImports),o=window.HTMLImports,s=[],o.addModule=function(e){s.push(e)},o.initializeModules=function(){s.forEach(function(e){e(o)})},window.HTMLImports.addModule(function(e){var i=/(url\()([^)]*)(\))/g,a=/(@import[\s]+(?!url\())([^;]*)(;)/g,t={resolveUrlsInStyle:function(e,t){var n=e.ownerDocument.createElement("a");return e.textContent=this.resolveUrlsInCssText(e.textContent,t,n),e},resolveUrlsInCssText:function(e,t,n){var r=this.replaceUrls(e,n,t,i);return r=this.replaceUrls(r,n,t,a)},replaceUrls:function(e,a,o,t){return e.replace(t,function(e,t,n,r){var i=n.replace(/["']/g,"");return o&&(i=new URL(i,o).href),a.href=i,t+"'"+(i=a.href)+"'"+r})}};e.path=t}),window.HTMLImports.addModule(function(t){var o={async:!0,ok:function(e){return 200<=e.status&&e.status<300||304===e.status||0===e.status},load:function(e,r,i){var a=new XMLHttpRequest;return(t.flags.debug||t.flags.bust)&&(e+="?"+Math.random()),a.open("GET",e,o.async),a.addEventListener("readystatechange",function(e){if(4===a.readyState){var t=null;try{var n=a.getResponseHeader("Location");n&&(t="/"===n.substr(0,1)?location.origin+n:n)}catch(e){console.error(e.message)}r.call(i,!o.ok(a)&&a,a.response||a.responseText,t)}}),a.send(),a},loadDocument:function(e,t,n){this.load(e,t,n).responseType="document"}};t.xhr=o}),window.HTMLImports.addModule(function(e){function t(e,t){this.cache={},this.onload=e,this.oncomplete=t,this.inflight=0,this.pending={}}var o=e.xhr,s=e.flags;t.prototype={addNodes:function(e){this.inflight+=e.length;for(var t,n=0,r=e.length;n<r&&(t=e[n]);n++)this.require(t);this.checkDone()},addNode:function(e){this.inflight++,this.require(e),this.checkDone()},require:function(e){var t=e.src||e.href;e.__nodeUrl=t,this.dedupe(t,e)||this.fetch(t,e)},dedupe:function(e,t){return this.pending[e]?(this.pending[e].push(t),!0):this.cache[e]?(this.onload(e,t,this.cache[e]),this.tail(),!0):!(this.pending[e]=[t])},fetch:function(r,i){if(s.load&&console.log("fetch",r,i),r)if(r.match(/^data:/)){var e=r.split(","),t=e[0],n=e[1];n=-1<t.indexOf(";base64")?atob(n):decodeURIComponent(n),setTimeout(function(){this.receive(r,i,null,n)}.bind(this),0)}else{var a=function(e,t,n){this.receive(r,i,e,t,n)}.bind(this);o.load(r,a)}else setTimeout(function(){this.receive(r,i,{error:"href must be specified"},null)}.bind(this),0)},receive:function(e,t,n,r,i){this.cache[e]=r;for(var a,o=this.pending[e],s=0,l=o.length;s<l&&(a=o[s]);s++)this.onload(e,a,r,n,i),this.tail();this.pending[e]=null},tail:function(){--this.inflight,this.checkDone()},checkDone:function(){this.inflight||this.oncomplete()}},e.Loader=t}),window.HTMLImports.addModule(function(e){function t(e){this.addCallback=e,this.mo=new MutationObserver(this.handler.bind(this))}t.prototype={handler:function(e){for(var t,n=0,r=e.length;n<r&&(t=e[n]);n++)"childList"===t.type&&t.addedNodes.length&&this.addedNodes(t.addedNodes)},addedNodes:function(e){this.addCallback&&this.addCallback(e);for(var t,n=0,r=e.length;n<r&&(t=e[n]);n++)t.children&&t.children.length&&this.addedNodes(t.children)},observe:function(e){this.mo.observe(e,{childList:!0,subtree:!0})}},e.Observer=t}),window.HTMLImports.addModule(function(n){var r=n.path,t=n.rootDocument,i=n.flags,u=n.isIE,a=n.IMPORT_LINK_TYPE,e="link[rel="+a+"]",o={documentSelectors:e,importsSelectors:[e,"link[rel=stylesheet]:not([type])","style:not([type])","script:not([type])",'script[type="application/javascript"]','script[type="text/javascript"]'].join(","),map:{link:"parseLink",script:"parseScript",style:"parseStyle"},dynamicElements:[],parseNext:function(){var e=this.nextToParse();e&&this.parse(e)},parse:function(e){if(this.isParsed(e))i.parse&&console.log("[%s] is already parsed",e.localName);else{var t=this[this.map[e.localName]];t&&(this.markParsing(e),t.call(this,e))}},parseDynamic:function(e,t){this.dynamicElements.push(e),t||this.parseNext()},markParsing:function(e){i.parse&&console.log("parsing",e),this.parsingElement=e},markParsingComplete:function(e){e.__importParsed=!0,this.markDynamicParsingComplete(e),e.__importElement&&(e.__importElement.__importParsed=!0,this.markDynamicParsingComplete(e.__importElement)),this.parsingElement=null,i.parse&&console.log("completed",e)},markDynamicParsingComplete:function(e){var t=this.dynamicElements.indexOf(e);0<=t&&this.dynamicElements.splice(t,1)},parseImport:function(e){if(e.import=e.__doc,window.HTMLImports.__importsParsingHook&&window.HTMLImports.__importsParsingHook(e),e.import&&(e.import.__importParsed=!0),this.markParsingComplete(e),e.__resource&&!e.__error?e.dispatchEvent(new CustomEvent("load",{bubbles:!1})):e.dispatchEvent(new CustomEvent("error",{bubbles:!1})),e.__pending)for(var t;e.__pending.length;)(t=e.__pending.shift())&&t({target:e});this.parseNext()},parseLink:function(e){s(e)?this.parseImport(e):(e.href=e.href,this.parseGeneric(e))},parseStyle:function(e){var t=e;e=function(e){var t=e.ownerDocument.createElement("style");return t.textContent=e.textContent,r.resolveUrlsInStyle(t),t}(e),(t.__appliedElement=e).__importElement=t,this.parseGeneric(e)},parseGeneric:function(e){this.trackElement(e),this.addElementToDocument(e)},rootImportForElement:function(e){for(var t=e;t.ownerDocument.__importLink;)t=t.ownerDocument.__importLink;return t},addElementToDocument:function(e){var t=this.rootImportForElement(e.__importElement||e);t.parentNode.insertBefore(e,t)},trackElement:function(t,n){var r=this,i=function(e){t.removeEventListener("load",i),t.removeEventListener("error",i),n&&n(e),r.markParsingComplete(t),r.parseNext()};if(t.addEventListener("load",i),t.addEventListener("error",i),u&&"style"===t.localName){var e=!1;if(-1==t.textContent.indexOf("@import"))e=!0;else if(t.sheet){e=!0;for(var a,o=t.sheet.cssRules,s=o?o.length:0,l=0;l<s&&(a=o[l]);l++)a.type===CSSRule.IMPORT_RULE&&(e=e&&Boolean(a.styleSheet))}e&&setTimeout(function(){t.dispatchEvent(new CustomEvent("load",{bubbles:!1}))})}},parseScript:function(e){var t=document.createElement("script");t.__importElement=e,t.src=e.src?e.src:function(e){var t=function(e){return e.textContent+function(e){var t=e.ownerDocument;t.__importedScripts=t.__importedScripts||0;var n=e.ownerDocument.baseURI,r=t.__importedScripts?"-"+t.__importedScripts:"";return t.__importedScripts++,"\n//# sourceURL="+n+r+".js\n"}(e)}(e);return"data:text/javascript;charset=utf-8,"+encodeURIComponent(t)}(e),n.currentScript=e,this.trackElement(t,function(e){t.parentNode&&t.parentNode.removeChild(t),n.currentScript=null}),this.addElementToDocument(t)},nextToParse:function(){return this._mayParse=[],!this.parsingElement&&(this.nextToParseInDoc(t)||this.nextToParseDynamic())},nextToParseInDoc:function(e,t){if(e&&this._mayParse.indexOf(e)<0){this._mayParse.push(e);for(var n,r=e.querySelectorAll(this.parseSelectorsForNode(e)),i=0,a=r.length;i<a&&(n=r[i]);i++)if(!this.isParsed(n))return this.hasResource(n)?s(n)?this.nextToParseInDoc(n.__doc,n):n:void 0}return t},nextToParseDynamic:function(){return this.dynamicElements[0]},parseSelectorsForNode:function(e){return(e.ownerDocument||e)===t?this.documentSelectors:this.importsSelectors},isParsed:function(e){return e.__importParsed},needsDynamicParsing:function(e){return 0<=this.dynamicElements.indexOf(e)},hasResource:function(e){return!s(e)||void 0!==e.__doc}};function s(e){return"link"===e.localName&&e.rel===a}n.parser=o,n.IMPORT_SELECTOR=e}),window.HTMLImports.addModule(function(e){var o=e.flags,s=e.IMPORT_LINK_TYPE,t=e.IMPORT_SELECTOR,n=e.rootDocument,r=e.Loader,i=e.Observer,l=e.parser,a={documents:{},documentPreloadSelectors:t,importsPreloadSelectors:[t].join(","),loadNode:function(e){u.addNode(e)},loadSubtree:function(e){var t=this.marshalNodes(e);u.addNodes(t)},marshalNodes:function(e){return e.querySelectorAll(this.loadSelectorsForNode(e))},loadSelectorsForNode:function(e){return(e.ownerDocument||e)===n?this.documentPreloadSelectors:this.importsPreloadSelectors},loaded:function(e,t,n,r,i){if(o.load&&console.log("loaded",e,t),t.__resource=n,t.__error=r,function(e){return function(e,t){return"link"===e.localName&&e.getAttribute("rel")===t}(e,s)}(t)){var a=this.documents[e];void 0===a&&((a=r?null:function(e,t){var n=document.implementation.createHTMLDocument(s);n._URL=t;var r=n.createElement("base");r.setAttribute("href",t),n.baseURI||function(e){return!!Object.getOwnPropertyDescriptor(e,"baseURI")}(n)||Object.defineProperty(n,"baseURI",{value:t});var i=n.createElement("meta");i.setAttribute("charset","utf-8"),n.head.appendChild(i),n.head.appendChild(r),n.body.innerHTML=e,window.HTMLTemplateElement&&HTMLTemplateElement.bootstrap&&HTMLTemplateElement.bootstrap(n);return n}(n,i||e))&&(a.__importLink=t,this.bootDocument(a)),this.documents[e]=a),t.__doc=a}l.parseNext()},bootDocument:function(e){this.loadSubtree(e),this.observer.observe(e),l.parseNext()},loadedAll:function(){l.parseNext()}},u=new r(a.loaded.bind(a),a.loadedAll.bind(a));if(a.observer=new i,!document.baseURI){var c={get:function(){var e=document.querySelector("base");return e?e.href:window.location.href},configurable:!0};Object.defineProperty(document,"baseURI",c),Object.defineProperty(n,"baseURI",c)}e.importer=a,e.importLoader=u}),window.HTMLImports.addModule(function(e){var s=e.parser,l=e.importer,t={added:function(e){for(var t,n,r,i,a=0,o=e.length;a<o&&(i=e[a]);a++)t||(t=i.ownerDocument,n=s.isParsed(t)),(r=this.shouldLoadNode(i))&&l.loadNode(i),this.shouldParseNode(i)&&n&&s.parseDynamic(i,r)},shouldLoadNode:function(e){return 1===e.nodeType&&n.call(e,l.loadSelectorsForNode(e))},shouldParseNode:function(e){return 1===e.nodeType&&n.call(e,s.parseSelectorsForNode(e))}};l.observer.addCallback=t.added.bind(t);var n=HTMLElement.prototype.matches||HTMLElement.prototype.matchesSelector||HTMLElement.prototype.webkitMatchesSelector||HTMLElement.prototype.mozMatchesSelector||HTMLElement.prototype.msMatchesSelector}),function(e){var t=e.initializeModules;e.isIE;if(!e.useNative){t();var n=e.rootDocument;"complete"===document.readyState||"interactive"===document.readyState&&!window.attachEvent?r():document.addEventListener("DOMContentLoaded",r)}function r(){window.HTMLImports.importer.bootDocument(n)}}(window.HTMLImports),window.CustomElements=window.CustomElements||{flags:{}},l=window.CustomElements,u=l.flags,c=[],l.addModule=function(e){c.push(e)},l.initializeModules=function(){c.forEach(function(e){e(l)})},l.hasNative=Boolean(document.registerElement),l.isIE=/Trident/.test(navigator.userAgent),l.useNative=!u.register&&l.hasNative&&!window.ShadowDOMPolyfill&&(!window.HTMLImports||window.HTMLImports.useNative),window.CustomElements.addModule(function(e){var l=window.HTMLImports?window.HTMLImports.IMPORT_LINK_TYPE:"none";function r(e,t){!function e(t,n,r){var i=t.firstElementChild;if(!i)for(i=t.firstChild;i&&i.nodeType!==Node.ELEMENT_NODE;)i=i.nextSibling;for(;i;)!0!==n(i,r)&&e(i,n,r),i=i.nextElementSibling;return null}(e,function(e){if(t(e))return!0;n(e,t)}),n(e,t)}function n(e,t){for(var n=e.shadowRoot;n;)r(n,t),n=n.olderShadowRoot}e.forDocumentTree=function(e,t){!function e(t,n,r){t=window.wrap(t);if(0<=r.indexOf(t))return;r.push(t);var i=t.querySelectorAll("link[rel="+l+"]");for(var a,o=0,s=i.length;o<s&&(a=i[o]);o++)a.import&&e(a.import,n,r);n(t)}(e,t,[])},e.forSubtree=r}),window.CustomElements.addModule(function(n){var o=n.flags,s=n.forSubtree,t=n.forDocumentTree;function l(e,t){return r(e,t)||i(e,t)}function r(e,t){if(n.upgrade(e,t))return!0;t&&f(e)}function i(e,t){s(e,function(e){if(r(e,t))return!0})}var a=window.MutationObserver._isPolyfilled&&o["throttle-attached"];n.hasPolyfillMutations=a,n.hasThrottledAttached=a;var u=!1,c=[];function d(e){c.push(e),u||(u=!0,setTimeout(h))}function h(){u=!1;for(var e,t=c,n=0,r=t.length;n<r&&(e=t[n]);n++)e();c=[]}function f(e){a?d(function(){p(e)}):p(e)}function p(e){e.__upgraded__&&!e.__attached&&(e.__attached=!0,e.attachedCallback&&e.attachedCallback())}function m(e){a?d(function(){g(e)}):g(e)}function g(e){e.__upgraded__&&e.__attached&&(e.__attached=!1,e.detachedCallback&&e.detachedCallback())}function v(e,t){if(o.dom){var n=t[0];if(n&&"childList"===n.type&&n.addedNodes&&n.addedNodes){for(var r=n.addedNodes[0];r&&r!==document&&!r.host;)r=r.parentNode;var i=r&&(r.URL||r._URL||r.host&&r.host.localName)||"";i=i.split("/?").shift().split("/").pop()}console.group("mutations (%d) [%s]",t.length,i||"")}var a=function(e){for(var t=e,n=window.wrap(document);t;){if(t==n)return!0;t=t.parentNode||t.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&t.host}}(e);t.forEach(function(e){"childList"===e.type&&(y(e.addedNodes,function(e){e.localName&&l(e,a)}),y(e.removedNodes,function(e){e.localName&&function(e){m(e),s(e,function(e){m(e)})}(e)}))}),o.dom&&console.groupEnd()}var y=Array.prototype.forEach.call.bind(Array.prototype.forEach);function _(e){if(!e.__observer){var t=new MutationObserver(v.bind(this,e));t.observe(e,{childList:!0,subtree:!0}),e.__observer=t}}function b(e){e=window.wrap(e),o.dom&&console.group("upgradeDocument: ",e.baseURI.split("/").pop()),l(e,e===window.wrap(document)),_(e),o.dom&&console.groupEnd()}var E=Element.prototype.createShadowRoot;E&&(Element.prototype.createShadowRoot=function(){var e=E.call(this);return window.CustomElements.watchShadow(this),e}),n.watchShadow=function(e){if(e.shadowRoot&&!e.shadowRoot.__watched){o.dom&&console.log("watching shadow-root for: ",e.localName);for(var t=e.shadowRoot;t;)_(t),t=t.olderShadowRoot}},n.upgradeDocumentTree=function(e){t(e,b)},n.upgradeDocument=b,n.upgradeSubtree=i,n.upgradeAll=l,n.attached=f,n.takeRecords=function(e){for(e=(e=window.wrap(e))||window.wrap(document);e.parentNode;)e=e.parentNode;var t=e.__observer;t&&(v(e,t.takeRecords()),h())}}),window.CustomElements.addModule(function(i){var r=i.flags;function a(e,t,n){return r.upgrade&&console.group("upgrade:",e.localName),t.is&&e.setAttribute("is",t.is),o(e,t),e.__upgraded__=!0,function(e){e.createdCallback&&e.createdCallback()}(e),n&&i.attached(e),i.upgradeSubtree(e,n),r.upgrade&&console.groupEnd(),e}function o(e,t){Object.__proto__||function(e,t,n){var r={},i=t;for(;i!==n&&i!==HTMLElement.prototype;){for(var a,o=Object.getOwnPropertyNames(i),s=0;a=o[s];s++)r[a]||(Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(i,a)),r[a]=1);i=Object.getPrototypeOf(i)}}(e,t.prototype,t.native),e.__proto__=t.prototype}i.upgrade=function(e,t){if("template"===e.localName&&window.HTMLTemplateElement&&HTMLTemplateElement.decorate&&HTMLTemplateElement.decorate(e),!e.__upgraded__&&e.nodeType===Node.ELEMENT_NODE){var n=e.getAttribute("is"),r=i.getRegisteredDefinition(e.localName)||i.getRegisteredDefinition(n);if(r&&(n&&r.tag==e.localName||!n&&!r.extends))return a(e,r,t)}},i.upgradeWithDefinition=a,i.implementPrototype=o}),window.CustomElements.addModule(function(r){r.isIE;var i=r.upgradeDocumentTree,a=r.upgradeAll,o=r.upgradeWithDefinition,s=r.implementPrototype,e=r.useNative;function l(e,t,n){e=e.toLowerCase();var r=this.getAttribute(e);n.apply(this,arguments);var i=this.getAttribute(e);this.attributeChangedCallback&&i!==r&&this.attributeChangedCallback(e,r,i)}var u=["annotation-xml","color-profile","font-face","font-face-src","font-face-uri","font-face-format","font-face-name","missing-glyph"];var c={};function d(e){if(e)return c[e.toLowerCase()]}function h(e,t){e=e&&e.toLowerCase();var n,r=d((t=t&&t.toLowerCase())||e);if(r){if(e==r.tag&&t==r.is)return new r.ctor;if(!t&&!r.is)return new r.ctor}return t?(n=h(e)).setAttribute("is",t):(n=f(e),0<=e.indexOf("-")&&s(n,HTMLElement)),n}var t,f=document.createElement.bind(document),p=document.createElementNS.bind(document);function n(e,t){var n=e[t];e[t]=function(){var e=n.apply(this,arguments);return a(e),e}}t=Object.__proto__||e?function(e,t){return e instanceof t}:function(e,t){if(e instanceof t)return!0;for(var n=e;n;){if(n===t.prototype)return!0;n=n.__proto__}return!1},n(Node.prototype,"cloneNode"),n(document,"importNode"),document.registerElement=function(e,t){var n=t||{};if(!e)throw new Error("document.registerElement: first argument `name` must not be empty");if(e.indexOf("-")<0)throw new Error("document.registerElement: first argument ('name') must contain a dash ('-'). Argument provided was '"+String(e)+"'.");if(function(e){for(var t=0;t<u.length;t++)if(e===u[t])return!0}(e))throw new Error("Failed to execute 'registerElement' on 'Document': Registration failed for type '"+String(e)+"'. The type name is invalid.");if(d(e))throw new Error("DuplicateDefinitionError: a type with name '"+String(e)+"' is already registered");return n.prototype||(n.prototype=Object.create(HTMLElement.prototype)),n.__name=e.toLowerCase(),n.extends&&(n.extends=n.extends.toLowerCase()),n.lifecycle=n.lifecycle||{},n.ancestry=function e(t){var n=d(t);if(n)return e(n.extends).concat([n]);return[]}(n.extends),function(e){for(var t,n=e.extends,r=0;t=e.ancestry[r];r++)n=t.is&&t.tag;e.tag=n||e.__name,n&&(e.is=e.__name)}(n),function(e){if(!Object.__proto__){var t=HTMLElement.prototype;if(e.is){var n=document.createElement(e.tag);t=Object.getPrototypeOf(n)}for(var r,i=e.prototype,a=!1;i;)i==t&&(a=!0),(r=Object.getPrototypeOf(i))&&(i.__proto__=r),i=r;a||console.warn(e.tag+" prototype not found in prototype chain for "+e.is),e.native=t}}(n),function(e){if(e.setAttribute._polyfilled)return;var n=e.setAttribute;e.setAttribute=function(e,t){l.call(this,e,t,n)};var t=e.removeAttribute;e.removeAttribute=function(e){l.call(this,e,null,t)},e.setAttribute._polyfilled=!0}(n.prototype),function(e,t){c[e]=t}(n.__name,n),n.ctor=function(e){return function(){return function(e){return o(f(e.tag),e)}(e)}}(n),n.ctor.prototype=n.prototype,n.prototype.constructor=n.ctor,r.ready&&i(document),n.ctor},document.createElement=h,document.createElementNS=function(e,t,n){return"http://www.w3.org/1999/xhtml"===e?h(t,n):p(e,t)},r.registry=c,r.instanceof=t,r.reservedTagList=u,r.getRegisteredDefinition=d,document.register=document.registerElement}),function(e){var t=e.useNative,n=e.initializeModules;e.isIE;if(t){function r(){}e.watchShadow=r,e.upgrade=r,e.upgradeAll=r,e.upgradeDocumentTree=r,e.upgradeSubtree=r,e.takeRecords=r,e.instanceof=function(e,t){return e instanceof t}}else n();var i=e.upgradeDocumentTree,a=e.upgradeDocument;function o(){i(window.wrap(document)),window.CustomElements.ready=!0,(window.requestAnimationFrame||function(e){setTimeout(e,16)})(function(){setTimeout(function(){window.CustomElements.readyTime=Date.now(),window.HTMLImports&&(window.CustomElements.elapsed=window.CustomElements.readyTime-window.HTMLImports.readyTime),document.dispatchEvent(new CustomEvent("WebComponentsReady",{bubbles:!0}))})})}if(window.wrap||(window.ShadowDOMPolyfill?(window.wrap=window.ShadowDOMPolyfill.wrapIfNeeded,window.unwrap=window.ShadowDOMPolyfill.unwrapIfNeeded):window.wrap=window.unwrap=function(e){return e}),window.HTMLImports&&(window.HTMLImports.__importsParsingHook=function(e){e.import&&a(wrap(e.import))}),"complete"===document.readyState||e.flags.eager)o();else if("interactive"!==document.readyState||window.attachEvent||window.HTMLImports&&!window.HTMLImports.ready){var s=window.HTMLImports&&!window.HTMLImports.ready?"HTMLImportsLoaded":"DOMContentLoaded";window.addEventListener(s,o)}else o()}(window.CustomElements),function(){var e=document.createElement("style");e.textContent="body {transition: opacity ease-in 0.2s; } \nbody[unresolved] {opacity: 0; display: block; overflow: hidden; position: relative; } \n";var t=document.querySelector("head");t.insertBefore(e,t.firstChild)}(window.WebComponents)},{}],3:[function(e,t,n){"use strict";var r,i=e("class.extend"),a=!1;function o(){return cast.framework.CastContext.getInstance()}(r=i.extend({init:function(e){this.player=e,this._sessionListener=this._onSessionStateChange.bind(this),this._castListener=this._onCastStateChange.bind(this),this._addCastContextEventListeners(),this.player.on("dispose",this._removeCastContextEventListeners.bind(this)),this._notifyPlayerOfDevicesAvailabilityChange(this.getCastContext().getCastState()),this.remotePlayer=new cast.framework.RemotePlayer,this.remotePlayerController=new cast.framework.RemotePlayerController(this.remotePlayer)},_addCastContextEventListeners:function(){var e=cast.framework.CastContextEventType.SESSION_STATE_CHANGED,t=cast.framework.CastContextEventType.CAST_STATE_CHANGED;this.getCastContext().addEventListener(e,this._sessionListener),this.getCastContext().addEventListener(t,this._castListener)},_removeCastContextEventListeners:function(){var e=cast.framework.CastContextEventType.SESSION_STATE_CHANGED,t=cast.framework.CastContextEventType.CAST_STATE_CHANGED;this.getCastContext().removeEventListener(e,this._sessionListener),this.getCastContext().removeEventListener(t,this._castListener)},_onSessionStateChange:function(e){e.sessionState===cast.framework.SessionState.SESSION_ENDED&&(this.player.trigger("chromecastDisconnected"),this._reloadTech())},_onCastStateChange:function(e){this._notifyPlayerOfDevicesAvailabilityChange(e.castState)},_notifyPlayerOfDevicesAvailabilityChange:function(e){this.hasAvailableDevices(e)?this.player.trigger("chromecastDevicesAvailable"):this.player.trigger("chromecastDevicesUnavailable")},hasAvailableDevices:function(e){return(e=e||this.getCastContext().getCastState())===cast.framework.CastState.NOT_CONNECTED||e===cast.framework.CastState.CONNECTING||e===cast.framework.CastState.CONNECTED},openCastMenu:function(){var e;this.player.currentSource()&&(e=function(){a=!0,this.player.trigger("chromecastConnected"),this._reloadTech()}.bind(this),this.getCastContext().requestSession().then(e,function(){}))},_reloadTech:function(){var e=this.player,t=e.currentTime(),n=e.paused(),r=e.currentSources();e.src(r),e.ready(function(){n?e.pause():e.play(),e.currentTime(t||0)})},getCastContext:o,getRemotePlayer:function(){return this.remotePlayer},getRemotePlayerController:function(){return this.remotePlayerController}})).isChromecastAPIAvailable=function(){return window.chrome&&window.chrome.cast&&window.cast},r.isChromecastConnected=function(){return r.isChromecastAPIAvailable()&&o().getCastState()===cast.framework.CastState.CONNECTED&&a},t.exports=r},{"class.extend":1}],4:[function(e,t,n){"use strict";var r;r={constructor:function(e){this.constructor.super_.apply(this,arguments),e.on("chromecastConnected",this._onChromecastConnected.bind(this)),e.on("chromecastDisconnected",this._onChromecastDisconnected.bind(this)),e.on("chromecastDevicesAvailable",this._onChromecastDevicesAvailable.bind(this)),e.on("chromecastDevicesUnavailable",this._onChromecastDevicesUnavailable.bind(this)),this.controlText("Open Chromecast menu"),e.chromecastSessionManager&&e.chromecastSessionManager.hasAvailableDevices()?this._onChromecastDevicesAvailable():this._onChromecastDevicesUnavailable()},buildCSSClass:function(){return"vjs-chromecast-button "+(this._isChromecastConnected?"vjs-chromecast-casting-state ":"")+this.constructor.super_.prototype.buildCSSClass()},handleClick:function(){this.player().trigger("chromecastRequested")},_onChromecastConnected:function(){this._isChromecastConnected=!0,this._reloadCSSClasses()},_onChromecastDisconnected:function(){this._isChromecastConnected=!1,this._reloadCSSClasses()},_onChromecastDevicesAvailable:function(){this.show()},_onChromecastDevicesUnavailable:function(){this.hide()},_reloadCSSClasses:function(){this.el_&&(this.el_.className=this.buildCSSClass())}},t.exports=function(e){var t;t=e.extend(e.getComponent("Button"),r),e.registerComponent("chromecastButton",t)}},{}],5:[function(e,t,n){"use strict";var i=e("./chromecast/ChromecastSessionManager");function r(e,t){var n;t.addButtonToControlBar&&!e.controlBar.getChild("chromecastButton")&&(n=e.controlBar.children().length,void 0!==t.buttonPositionIndex&&(n=0<=t.buttonPositionIndex?t.buttonPositionIndex:e.controlBar.children().length+t.buttonPositionIndex),e.controlBar.addChild("chromecastButton",t,n)),e.on("chromecastRequested",function(e){e.chromecastSessionManager.openCastMenu()}.bind(null,e))}function a(e,t){!function(e){cast.framework.CastContext.getInstance().setOptions({receiverApplicationId:e.receiverAppID||chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID,autoJoinPolicy:chrome.cast.AutoJoinPolicy.ORIGIN_SCOPED})}(t),function(e){e.chromecastSessionManager||(e.chromecastSessionManager=new i(e))}(e),r(e,t)}t.exports=function(e){e.registerPlugin("chromecast",function(e){var t=Object.assign({addButtonToControlBar:!0},e||{});this.ready(function(){this.controlBar&&(i.isChromecastAPIAvailable()?a(this,t):function(e,t){var n,r=1;n=setInterval(function(){30<r?clearInterval(n):(i.isChromecastAPIAvailable()&&(clearInterval(n),a(e,t)),r+=1)},1e3)}(this,t))}.bind(this))})}},{"./chromecast/ChromecastSessionManager":3}],6:[function(e,t,n){"use strict";var r=e("./preloadWebComponents"),i=e("./components/ChromecastButton"),a=e("./tech/ChromecastTech"),o=e("./enableChromecast");t.exports=function(e,t){Object.assign({preloadWebComponents:!1},t).preloadWebComponents&&r(),e=e||window.videojs,i(e),a(e),o(e)}},{"./components/ChromecastButton":4,"./enableChromecast":5,"./preloadWebComponents":7,"./tech/ChromecastTech":9}],7:[function(n,e,t){"use strict";function r(e){return"string"==typeof window.navigator.userAgent&&0<=window.navigator.userAgent.indexOf(e)}e.exports=function(){var e=!document.registerElement,t=r("CriOS");(r("Android")&&r("Chrome/")&&window.navigator.presentation||t)&&e&&n("webcomponents.js/webcomponents-lite.js")}},{"webcomponents.js/webcomponents-lite.js":2}],8:[function(e,t,n){"use strict";e("./index")(void 0,window.SILVERMINE_VIDEOJS_CHROMECAST_CONFIG)},{"./index":6}],9:[function(e,t,n){"use strict";var r,i=e("../chromecast/ChromecastSessionManager"),a=e("./ChromecastTechUI");r={constructor:function(e){var t;return this._eventListeners=[],this.videojsPlayer=this.videojs(e.playerId),this._chromecastSessionManager=this.videojsPlayer.chromecastSessionManager,this._ui=new a,this._ui.updatePoster(this.videojsPlayer.poster()),t=this.constructor.super_.apply(this,arguments),this._remotePlayer=this._chromecastSessionManager.getRemotePlayer(),this._remotePlayerController=this._chromecastSessionManager.getRemotePlayerController(),this._listenToPlayerControllerEvents(),this.on("dispose",this._removeAllEventListeners.bind(this)),this._hasPlayedAnyItem=!1,this._requestTitle=e.requestTitleFn||function(){},this._requestSubtitle=e.requestSubtitleFn||function(){},this._requestCustomData=e.requestCustomDataFn||function(){},this._initialStartTime=e.startTime||0,this._playSource(e.source,this._initialStartTime),this.ready(function(){this.setMuted(e.muted)}.bind(this)),t},createEl:function(){return this._ui.getDOMElement()},play:function(){this.paused()&&(this.ended()&&!this._isMediaLoading?this._playSource({src:this.videojsPlayer.src()},0):this._remotePlayerController.playOrPause())},pause:function(){!this.paused()&&this._remotePlayer.canPause&&this._remotePlayerController.playOrPause()},paused:function(){return this._remotePlayer.isPaused||this.ended()||null===this._remotePlayer.playerState},setSource:function(e){this._currentSource&&this._currentSource.src===e.src&&this._currentSource.type===e.type||(this._currentSource=e,this._playSource(e,0))},_playSource:function(e,t){var n,r=this._getCastSession(),i=new chrome.cast.media.MediaInfo(e.src,e.type),a=this._requestTitle(e),o=this._requestSubtitle(e),s=this._requestCustomData(e);this.trigger("waiting"),this._clearSessionTimeout(),i.metadata=new chrome.cast.media.GenericMediaMetadata,i.metadata.metadataType=chrome.cast.media.MetadataType.GENERIC,i.metadata.title=a,i.metadata.subtitle=o,i.streamType=this.videojsPlayer.liveTracker&&this.videojsPlayer.liveTracker.isLive()?chrome.cast.media.StreamType.LIVE:chrome.cast.media.StreamType.BUFFERED,s&&(i.customData=s),this._ui.updateTitle(a),this._ui.updateSubtitle(o),(n=new chrome.cast.media.LoadRequest(i)).autoplay=!0,n.currentTime=t,this._isMediaLoading=!0,this._hasPlayedCurrentItem=!1,r.loadMedia(n).then(function(){this._hasPlayedAnyItem||this.triggerReady(),this.trigger("loadstart"),this.trigger("loadeddata"),this.trigger("play"),this.trigger("playing"),this._hasPlayedAnyItem=!0,this._isMediaLoading=!1,this._getMediaSession().addUpdateListener(this._onMediaSessionStatusChanged.bind(this))}.bind(this),this._triggerErrorEvent.bind(this))},setCurrentTime:function(e){var t=this.duration();t<e||!this._remotePlayer.canSeek||(this._remotePlayer.currentTime=Math.min(t-1,e),this._remotePlayerController.seek(),this._triggerTimeUpdateEvent())},currentTime:function(){return this._hasPlayedAnyItem?this._remotePlayer.currentTime:this._initialStartTime},duration:function(){return this._hasPlayedAnyItem?this._remotePlayer.duration:this.videojsPlayer.duration()},ended:function(){var e=this._getMediaSession();return!(e||!this._hasMediaSessionEnded)||!!e&&e.idleReason===chrome.cast.media.IdleReason.FINISHED},volume:function(){return this._remotePlayer.volumeLevel},setVolume:function(e){this._remotePlayer.volumeLevel=e,this._remotePlayerController.setVolumeLevel(),this._triggerVolumeChangeEvent()},muted:function(){return this._remotePlayer.isMuted},setMuted:function(e){(this._remotePlayer.isMuted&&!e||!this._remotePlayer.isMuted&&e)&&this._remotePlayerController.muteOrUnmute()},poster:function(){return this._ui.getPoster()},setPoster:function(e){this._ui.updatePoster(e)},buffered:function(){},seekable:function(){return this.videojs.createTimeRange(0,this.duration())},controls:function(){return!1},playsinline:function(){return!0},supportsFullScreen:function(){return!0},setAutoplay:function(){},playbackRate:function(){var e=this._getMediaSession();return e?e.playbackRate:1},setPlaybackRate:function(){},preload:function(){},load:function(){},readyState:function(){return"IDLE"===this._remotePlayer.playerState||"BUFFERING"===this._remotePlayer.playerState?0:4},_listenToPlayerControllerEvents:function(){var e=cast.framework.RemotePlayerEventType;this._addEventListener(this._remotePlayerController,e.PLAYER_STATE_CHANGED,this._onPlayerStateChanged,this),this._addEventListener(this._remotePlayerController,e.VOLUME_LEVEL_CHANGED,this._triggerVolumeChangeEvent,this),this._addEventListener(this._remotePlayerController,e.IS_MUTED_CHANGED,this._triggerVolumeChangeEvent,this),this._addEventListener(this._remotePlayerController,e.CURRENT_TIME_CHANGED,this._triggerTimeUpdateEvent,this),this._addEventListener(this._remotePlayerController,e.DURATION_CHANGED,this._triggerDurationChangeEvent,this)},_addEventListener:function(e,t,n,r){var i;i={target:e,type:t,callback:n,context:r,listener:n.bind(r)},e.addEventListener(t,i.listener),this._eventListeners.push(i)},_removeAllEventListeners:function(){for(;0<this._eventListeners.length;)this._removeEventListener(this._eventListeners[0]);this._eventListeners=[]},_removeEventListener:function(e){var t,n=-1;for(e.target.removeEventListener(e.type,e.listener),t=0;t<this._eventListeners.length;t++)if(this._eventListeners[t].target===e.target&&this._eventListeners[t].type===e.type&&this._eventListeners[t].callback===e.callback&&this._eventListeners[t].context===e.context){n=t;break}-1!==n&&this._eventListeners.splice(n,1)},_onPlayerStateChanged:function(){var e=chrome.cast.media.PlayerState,t=this._remotePlayer.playerState;t===e.PLAYING?(this._hasPlayedCurrentItem=!0,this.trigger("play"),this.trigger("playing")):t===e.PAUSED?this.trigger("pause"):t===e.IDLE&&this.ended()||null===t&&this._hasPlayedCurrentItem?(this._hasPlayedCurrentItem=!1,this._closeSessionOnTimeout(),this.trigger("ended"),this._triggerTimeUpdateEvent()):t===e.BUFFERING&&this.trigger("waiting")},_onMediaSessionStatusChanged:function(e){this._hasMediaSessionEnded=!!e},_closeSessionOnTimeout:function(){this._clearSessionTimeout(),this._sessionTimeoutID=setTimeout(function(){var e=this._getCastSession();e&&e.endSession(!0),this._clearSessionTimeout()}.bind(this),1e4)},_clearSessionTimeout:function(){this._sessionTimeoutID&&(clearTimeout(this._sessionTimeoutID),this._sessionTimeoutID=!1)},_getCastContext:function(){return this._chromecastSessionManager.getCastContext()},_getCastSession:function(){return this._getCastContext().getCurrentSession()},_getMediaSession:function(){var e=this._getCastSession();return e?e.getMediaSession():null},_triggerVolumeChangeEvent:function(){this.trigger("volumechange")},_triggerTimeUpdateEvent:function(){this.trigger("timeupdate")},_triggerDurationChangeEvent:function(){this.trigger("durationchange")},_triggerErrorEvent:function(){this.trigger("error")}},t.exports=function(e){var t,n=e.getComponent("Tech");(t=e.extend(n,r)).canPlaySource=i.isChromecastConnected.bind(i),t.isSupported=i.isChromecastConnected.bind(i),t.prototype.featuresVolumeControl=!0,t.prototype.featuresPlaybackRate=!1,t.prototype.movingMediaElementInDOM=!1,t.prototype.featuresFullscreenResize=!0,t.prototype.featuresTimeupdateEvents=!0,t.prototype.featuresProgressEvents=!1,t.prototype.featuresNativeTextTracks=!1,t.prototype.featuresNativeAudioTracks=!1,t.prototype.featuresNativeVideoTracks=!1,(t.prototype.videojs=e).registerTech("chromecast",t)}},{"../chromecast/ChromecastSessionManager":3,"./ChromecastTechUI":10}],10:[function(e,t,n){"use strict";var r;r=e("class.extend").extend({init:function(){this._el=this._createDOMElement()},_createDOMElement:function(){var e=this._createElement("div","vjs-tech vjs-tech-chromecast"),t=this._createElement("div","vjs-tech-chromecast-poster"),n=this._createElement("img","vjs-tech-chromecast-poster-img"),r=this._createElement("div","vjs-tech-chromecast-title"),i=this._createElement("div","vjs-tech-chromecast-subtitle"),a=this._createElement("div","vjs-tech-chromecast-title-container");return t.appendChild(n),a.appendChild(r),a.appendChild(i),e.appendChild(a),e.appendChild(t),e},_createElement:function(e,t){var n=document.createElement(e);return n.className=t,n},getDOMElement:function(){return this._el},_findPosterEl:function(){return this._el.querySelector(".vjs-tech-chromecast-poster")},_findPosterImageEl:function(){return this._el.querySelector(".vjs-tech-chromecast-poster-img")},_findTitleEl:function(){return this._el.querySelector(".vjs-tech-chromecast-title")},_findSubtitleEl:function(){return this._el.querySelector(".vjs-tech-chromecast-subtitle")},updatePoster:function(e){var t=this._findPosterImageEl();this._poster=e||null,e?(t.setAttribute("src",e),t.classList.remove("vjs-tech-chromecast-poster-img-empty")):(t.removeAttribute("src"),t.classList.add("vjs-tech-chromecast-poster-img-empty"))},getPoster:function(){return this._poster},updateTitle:function(e){var t=this._findTitleEl();(this._title=e)?(t.innerHTML=e,t.classList.remove("vjs-tech-chromecast-title-empty")):t.classList.add("vjs-tech-chromecast-title-empty")},updateSubtitle:function(e){var t=this._findSubtitleEl();(this._subtitle=e)?(t.innerHTML=e,t.classList.remove("vjs-tech-chromecast-subtitle-empty")):t.classList.add("vjs-tech-chromecast-subtitle-empty")}}),t.exports=r},{"class.extend":1}]},{},[8]),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).videojsAudiowaveformPlayer=t(e.videojs)}(this,function(e){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var a=t(e);function n(e,t,n){return e(n={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&n.path)}},n.exports),n.exports}var r=n(function(e){function t(){return e.exports=t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},e.exports.default=e.exports,e.exports.__esModule=!0,t.apply(this,arguments)}e.exports=t,e.exports.default=e.exports,e.exports.__esModule=!0}),o=n(function(e){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.default=e.exports,e.exports.__esModule=!0}),i=n(function(n){function r(e,t){return n.exports=r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n.exports.default=n.exports,n.exports.__esModule=!0,r(e,t)}n.exports=r,n.exports.default=n.exports,n.exports.__esModule=!0}),s=n(function(e){e.exports=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,i(e,t)},e.exports.default=e.exports,e.exports.__esModule=!0}),d=function(){function e(e){this.init(e)}var t=e.prototype;return t.init=function(e){this.redraw=this.redraw,this.container=e.container,this.canvas=e.canvas,this.data=e.data||[],this.outerColor=e.outerColor||"transparent",this.innerColor=e.innerColor||"#000000",this.normalize=e.normalize||!1,this.pixelRatio=window.devicePixelRatio||screen.deviceXDPI/screen.logicalXDPI,this.barWidth=e.barWidth||1,this.barHeight=e.barHeight||0,this.canvas=this.createCanvas(this.container,e.width,e.height),this.context=this.canvas.getContext("2d"),this.width=parseInt(this.context.canvas.width,10),this.height=parseInt(this.context.canvas.height,10),e.data&&this.update(e)},t.setData=function(e){return this.data=e},t.max=function(e){var t=-1/0;for(var n in e)e[n]>t&&(t=e[n]);return t},t.min=function(e){var t=1/0;for(var n in e)e[n]<t&&(t=e[n]);return t},t.update=function(e){return this.setData(e.data),this.redraw()},t.redraw=function(){this.clear();var e=this.data,t=1;[].some.call(e,function(e){return e<0})&&(t=2);var n=this.width,r=this.height,i=0*r,a=r/2,o=e.length/t,s=this.barWidth,l=s+Math.max(this.pixelRatio,~~(s/2)),u=1/this.barHeight;if(this.normalize){var c=this.max(e),d=this.min(e);u=c<-d?-d:c}for(var h=o/n,f=n,p=0;p<f;p+=l){"function"==typeof this.innerColor&&(this.context.fillStyle=this.innerColor(p/this.width));var m=e[Math.floor(p*h*t)]||0,g=Math.round(m/u*a);this.context.fillRect(p+.5,a-g+i,s+.5,2*g)}},t.clear=function(){return this.context.fillStyle=this.outerColor,this.context.clearRect(0,0,this.width,this.height),this.context.fillRect(0,0,this.width,this.height)},t.patchCanvasForIE=function(n){var r;if(void 0!==window.G_vmlCanvasManager)return n=window.G_vmlCanvasManager.initElement(n),r=n.getContext,n.getContext=function(e){var t;return t=r.apply(n,arguments),n.getContext=r,t}},t.createCanvas=function(e,t,n){var r;return r=document.createElement("canvas"),e.appendChild(r),r.width=t,r.height=n,r},e}(),l=a.default.getPlugin("plugin"),u=a.default.getComponent("Component"),c={theme:"audio",barWidth:1,barHeight:1,brand:"rgba(75, 150, 242, 1)",posterWidth:180,fallbackSupport:["video/mp4","video/m4v","video/mov","video/quicktime","video/x-flv","application/mxf","video/x-msvideo","video/x-ms-wmv","video/x-matroska","audio/mp3","audio/wav","audio/x-aiff","audio/aiff","audio/x-flac","audio/flac","audio/aac","audio/mpeg"],styles:{position:"absolute",height:"120px",bottom:"30px"}},h=function(i){function e(e,t){var n;n=i.call(this,e)||this;var r=o(n);return r.options=a.default.mergeOptions(c,t),n.player.ready(function(){"audio"===r.options.theme&&n.player.addClass("vjs-audiowaveform-audio-theme")}),n.player.on("loadstart",function(e){r.player.getChild("waveform")&&r.player.removeChild("waveform"),r.player.getChild("waveformArtwork")&&r.player.removeChild("waveformArtwork"),r.buildWaveformComponent();var t=r.player.currentSource();480<window.innerWidth&&(r.player.getChild("controlBar").el().style.left=r.options.posterWidth+"px"),t.waveform?t.waveform:t.src,t.waveform?r.getWaveformData(t.waveform,"json").then(function(e){r.buildWaveform(e)}):r.options.fallbackSupport.includes(this.currentType())&&r.getWaveformData(t.src,"arraybuffer").then(function(e){e instanceof ArrayBuffer&&r.convertWaveformData(e).then(function(e){r.buildWaveform(e)})})}),n}s(e,i);var t=e.prototype;return t.convertWaveformData=function(e){return new Promise(function(l,t){window.AudioContext=window.AudioContext||window.webkitAudioContext,(new AudioContext).decodeAudioData(e).then(function(e){for(var t=e.getChannelData(0),n=Math.floor(t.length/800),r=[],i=0;i<800;i++){for(var a=n*i,o=0,s=0;s<n;s++)o+=Math.abs(t[a+s]);r.push(o/n)}l({metadata:{duration:e.duration,channels:e.numberOfChannels,sample_rate:e.sampleRate},data:r})}).catch(function(e){return t("error "+e)})})},t.getWaveformData=function(t,n){return new Promise(function(r,e){a.default.xhr({method:"GET",uri:t,responseType:n,headers:{"Content-Type":"application/x-www-form-urlencoded"}},function(e,t,n){200===t.statusCode&&r(t.body)})}).catch(function(e){return reject("error "+e)})},t.buildWaveformComponent=function(){var e=a.default.extend(u,{constructor:function(){u.apply(this,arguments),this.addClass("vjs-waveform")}});a.default.registerComponent("waveform",e),this.player.addChild("waveform",{}),r(this.player.getChild("waveform").el().style,this.options.styles)},t.buildPosterComponent=function(){var e=this,t=a.default.extend(u,{constructor:function(){u.apply(this,arguments),this.addClass("vjs-waveform-artwork")},createEl:function(){return a.default.createEl("div",{className:"",innerHTML:'<img width="180" src="'+e.options.poster+'"/>'})}});a.default.registerComponent("waveformArtwork",t),e.player.addChild("waveformArtwork",{})},t.buildWaveform=function(e){var i=this,t=document.createElement("canvas").getContext("2d"),n=t.createLinearGradient(0,0,0,parseInt(i.options.styles.height));n.addColorStop(.5,"rgba(51, 51, 51, 1)"),n.addColorStop(.5,"rgba(51, 51, 51, 1)");var r=t.createLinearGradient(0,0,0,parseInt(i.options.styles.height));r.addColorStop(.5,i.options.brand);var a=i.options.brand;r.addColorStop(.5,a);var o=e.data,s=Math.floor(e.metadata.duration),l=parseInt(getComputedStyle(i.player.el()).width),u=new d({container:i.player.getChild("waveform").el(),height:parseInt(i.options.styles.height),width:window.innerWidth<480?l:l-i.options.posterWidth,barWidth:i.options.barWidth,barHeight:i.options.barHeight,normalize:!0,innerColor:function(e){return i.player.currentTime()/s<e?n:r}});u.update({data:o});var c="click";(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/Android/i))&&(c="touchstart"),i.player.getChild("waveform").el().addEventListener(c,function(e){var t,n;if(e.touches){var r=e.touches[0];t=Math.floor(r.clientX-this.getBoundingClientRect().x),n=Math.round(e.target.clientWidth)}else t=Math.round(e.offsetX),n=Math.round(e.target.clientWidth);i.player.currentTime(i.player.duration()/n*t),i.player.play()},!1),i.player.on("timeupdate",function(){this.currentTime()&&u&&u.redraw()})},e}(l);return h.defaultState={},h.VERSION="0.0.5",a.default.registerPlugin("audiowaveformPlayer",h),h}),function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(this,function(){return i={},n.m=r=[function(e,t,n){"use strict";var r,i=n(1),a=(r=i)&&r.__esModule?r:{default:r};videojs.registerComponent("BIFMouseTimeDisplay",a.default);var o=videojs.getComponent("SeekBar").prototype.options_.children,s=o.indexOf("mouseTimeDisplay");o.splice(s,0,"BIFMouseTimeDisplay"),videojs.plugin("bif",function(e){var t=0<arguments.length&&void 0!==e?e:{};if(t.src){var n=this;n.player_.addClass("video-has-bif");var r=n.player_.controlBar.progressControl.seekBar.BIFMouseTimeDisplay,i=new XMLHttpRequest;i.open("GET",t.src,!0),i.responseType="arraybuffer",i.onload=function(e){200===e.target.status&&(r.render({data:e.target.response}),n.player_.controlBar.progressControl.on("mousemove",function(e){r.handleMouseMove(e,this.el().offsetLeft)}),n.player_.controlBar.progressControl.on("mouseout",function(e){r.handleMouseOut()}))},i.send(null)}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=c(n(2)),i=c(n(29)),a=c(n(30)),o=c(n(75)),s=c(n(79)),l=n(87),u=n(88);function c(e){return e&&e.__esModule?e:{default:e}}var d,h={createBIFImage:Function.prototype,createBIFTime:Function.prototype,template:Function.prototype},f=videojs.getComponent("MouseTimeDisplay"),p=(d=f,(0,s.default)(m,d),(0,o.default)(m,null,[{key:"createBIFElement",value:function(e){var t=document.createElement("div");return t.className="bif-thumbnail",e.appendChild(t),t}},{key:"createBIFImage",value:function(){var e=document.createElement("img");return e.className="bif-image",e}},{key:"createBIFTime",value:function(){var e=document.createElement("span");return e.className="bif-time",e}}]),(0,o.default)(m,[{key:"configure",value:function(e){this.options_=videojs.mergeOptions(h,this.options_,e);var t=e.data;if(t instanceof ArrayBuffer)this.BIFParser=new l.BIFParser(t);else if(null!=t)return void console.log("Invalid BIF data.")}},{key:"getCurrentImageAtTime",value:function(e){var t=void 0;return this.hasImages()&&(t=this.BIFParser.getImageDataAtSecond(e)),t}},{key:"getCurrentTimeAtEvent",value:function(e){var t=this.player_.controlBar.progressControl.seekBar;return(0,u.getPointerPosition)(e,t.el()).x*this.player_.duration()}},{key:"handleMouseMove",value:function(e,t){if(e){var n=this.getCurrentTimeAtEvent(e),r=this.getCurrentImageAtTime(n);this.BIFElement.style.display="block",this.BIFElement.style.left=e.offsetX+t+"px",r&&23<r.length&&(this.BIFImage.src=r),this.BIFTime.innerHTML=videojs.formatTime(Math.floor(n))}}},{key:"handleMouseOut",value:function(){this.BIFElement.style.display="none"}},{key:"hasImages",value:function(){return!!this.BIFParser}},{key:"render",value:function(e){this.configure(e);var t=this.options_.createBIFImage.apply(this);t instanceof HTMLElement?this.BIFImage=t:this.BIFImage=m.createBIFImage();var n=this.options_.createBIFTime.apply(this);n instanceof HTMLElement?this.BIFTime=n:this.BIFTime=m.createBIFTime();var r=this.options_.template.apply(this);r instanceof HTMLElement||(r=this.template()),this.BIFElement.innerHTML="",this.BIFElement.appendChild(r)}},{key:"template",value:function(){var e=document.createElement("div");return e.className="bif",e.id="bif",this.hasImages()&&e.appendChild(this.BIFImage),e.appendChild(this.BIFTime),e}}]),m);function m(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};(0,i.default)(this,m);var n=(0,a.default)(this,(m.__proto__||(0,r.default)(m)).call(this,e,t));return n.addClass("vjs-mouse-display-is-bif"),n.BIFElement=m.createBIFElement(e.el()),n.render(t),n}t.default=p},function(e,t,n){e.exports={default:n(3),__esModule:!0}},function(e,t,n){n(4),e.exports=n(11).Object.getPrototypeOf},function(e,t,n){var r=n(5),i=n(7);n(15)("getPrototypeOf",function(){return function(e){return i(r(e))}})},function(e,t,n){var r=n(6);e.exports=function(e){return Object(r(e))}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){var r=n(8),i=n(5),a=n(9)("IE_PROTO"),o=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=i(e),r(e,a)?e[a]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?o:null}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){var r=n(10)("keys"),i=n(14);e.exports=function(e){return r[e]||(r[e]=i(e))}},function(e,t,n){var r=n(11),i=n(12),a="__core-js_shared__",o=i[a]||(i[a]={});(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:n(13)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},function(e,t){var n=e.exports={version:"2.6.9"};"number"==typeof __e&&(__e=n)},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t){e.exports=!0},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},function(e,t,n){var i=n(16),a=n(11),o=n(25);e.exports=function(e,t){var n=(a.Object||{})[e]||Object[e],r={};r[e]=t(n),i(i.S+i.F*o(function(){n(1)}),"Object",r)}},function(e,t,n){var m=n(12),g=n(11),v=n(17),y=n(19),_=n(8),b="prototype",E=function(e,t,n){var r,i,a,o=e&E.F,s=e&E.G,l=e&E.S,u=e&E.P,c=e&E.B,d=e&E.W,h=s?g:g[t]||(g[t]={}),f=h[b],p=s?m:l?m[t]:(m[t]||{})[b];for(r in s&&(n=t),n)(i=!o&&p&&void 0!==p[r])&&_(h,r)||(a=i?p[r]:n[r],h[r]=s&&"function"!=typeof p[r]?n[r]:c&&i?v(a,m):d&&p[r]==a?function(r){function e(e,t,n){if(this instanceof r){switch(arguments.length){case 0:return new r;case 1:return new r(e);case 2:return new r(e,t)}return new r(e,t,n)}return r.apply(this,arguments)}return e[b]=r[b],e}(a):u&&"function"==typeof a?v(Function.call,a):a,u&&((h.virtual||(h.virtual={}))[r]=a,e&E.R&&f&&!f[r]&&y(f,r,a)))};E.F=1,E.G=2,E.S=4,E.P=8,E.B=16,E.W=32,E.U=64,E.R=128,e.exports=E},function(e,t,n){var a=n(18);e.exports=function(r,i,e){if(a(r),void 0===i)return r;switch(e){case 1:return function(e){return r.call(i,e)};case 2:return function(e,t){return r.call(i,e,t)};case 3:return function(e,t,n){return r.call(i,e,t,n)}}return function(){return r.apply(i,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){var r=n(20),i=n(28);e.exports=n(24)?function(e,t,n){return r.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var r=n(21),i=n(23),a=n(27),o=Object.defineProperty;t.f=n(24)?Object.defineProperty:function(e,t,n){if(r(e),t=a(t,!0),r(n),i)try{return o(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){var r=n(22);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){e.exports=!n(24)&&!n(25)(function(){return 7!=Object.defineProperty(n(26)("div"),"a",{get:function(){return 7}}).a})},function(e,t,n){e.exports=!n(25)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){var r=n(22),i=n(12).document,a=r(i)&&r(i.createElement);e.exports=function(e){return a?i.createElement(e):{}}},function(e,t,n){var i=n(22);e.exports=function(e,t){if(!i(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!i(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!i(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!i(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){"use strict";t.__esModule=!0,t.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t,n){"use strict";t.__esModule=!0;var r,i=n(31),a=(r=i)&&r.__esModule?r:{default:r};t.default=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":(0,a.default)(t))&&"function"!=typeof t?e:t}},function(e,t,n){"use strict";t.__esModule=!0;var r=o(n(32)),i=o(n(60)),a="function"==typeof i.default&&"symbol"==typeof r.default?function(e){return typeof e}:function(e){return e&&"function"==typeof i.default&&e.constructor===i.default&&e!==i.default.prototype?"symbol":typeof e};function o(e){return e&&e.__esModule?e:{default:e}}t.default="function"==typeof i.default&&"symbol"===a(r.default)?function(e){return void 0===e?"undefined":a(e)}:function(e){return e&&"function"==typeof i.default&&e.constructor===i.default&&e!==i.default.prototype?"symbol":void 0===e?"undefined":a(e)}},function(e,t,n){e.exports={default:n(33),__esModule:!0}},function(e,t,n){n(34),n(55),e.exports=n(59).f("iterator")},function(e,t,n){"use strict";var r=n(35)(!0);n(37)(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=r(t,n),this._i+=e.length,{value:e,done:!1})})},function(e,t,n){var l=n(36),u=n(6);e.exports=function(s){return function(e,t){var n,r,i=String(u(e)),a=l(t),o=i.length;return a<0||o<=a?s?"":void 0:(n=i.charCodeAt(a))<55296||56319<n||a+1===o||(r=i.charCodeAt(a+1))<56320||57343<r?s?i.charAt(a):n:s?i.slice(a,a+2):r-56320+(n-55296<<10)+65536}}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(0<e?r:n)(e)}},function(e,t,n){"use strict";function _(){return this}var b=n(13),E=n(16),T=n(38),A=n(19),w=n(39),S=n(40),C=n(53),x=n(7),M=n(54)("iterator"),R=!([].keys&&"next"in[].keys()),I="values";e.exports=function(e,t,n,r,i,a,o){S(n,t,r);function s(e){if(!R&&e in p)return p[e];switch(e){case"keys":case I:return function(){return new n(this,e)}}return function(){return new n(this,e)}}var l,u,c,d=t+" Iterator",h=i==I,f=!1,p=e.prototype,m=p[M]||p["@@iterator"]||i&&p[i],g=m||s(i),v=i?h?s("entries"):g:void 0,y="Array"==t&&p.entries||m;if(y&&(c=x(y.call(new e)))!==Object.prototype&&c.next&&(C(c,d,!0),b||"function"==typeof c[M]||A(c,M,_)),h&&m&&m.name!==I&&(f=!0,g=function(){return m.call(this)}),b&&!o||!R&&!f&&p[M]||A(p,M,g),w[t]=g,w[d]=_,i)if(l={values:h?g:s(I),keys:a?g:s("keys"),entries:v},o)for(u in l)u in p||T(p,u,l[u]);else E(E.P+E.F*(R||f),t,l);return l}},function(e,t,n){e.exports=n(19)},function(e,t){e.exports={}},function(e,t,n){"use strict";var r=n(41),i=n(28),a=n(53),o={};n(19)(o,n(54)("iterator"),function(){return this}),e.exports=function(e,t,n){e.prototype=r(o,{next:i(1,n)}),a(e,t+" Iterator")}},function(e,t,r){function i(){}var a=r(21),o=r(42),s=r(51),l=r(9)("IE_PROTO"),u="prototype",c=function(){var e,t=r(26)("iframe"),n=s.length;for(t.style.display="none",r(52).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),c=e.F;n--;)delete c[u][s[n]];return c()};e.exports=Object.create||function(e,t){var n;return null!==e?(i[u]=a(e),n=new i,i[u]=null,n[l]=e):n=c(),void 0===t?n:o(n,t)}},function(e,t,n){var o=n(20),s=n(21),l=n(43);e.exports=n(24)?Object.defineProperties:function(e,t){s(e);for(var n,r=l(t),i=r.length,a=0;a<i;)o.f(e,n=r[a++],t[n]);return e}},function(e,t,n){var r=n(44),i=n(51);e.exports=Object.keys||function(e){return r(e,i)}},function(e,t,n){var o=n(8),s=n(45),l=n(48)(!1),u=n(9)("IE_PROTO");e.exports=function(e,t){var n,r=s(e),i=0,a=[];for(n in r)n!=u&&o(r,n)&&a.push(n);for(;t.length>i;)o(r,n=t[i++])&&(~l(a,n)||a.push(n));return a}},function(e,t,n){var r=n(46),i=n(6);e.exports=function(e){return r(i(e))}},function(e,t,n){var r=n(47);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,n){var l=n(45),u=n(49),c=n(50);e.exports=function(s){return function(e,t,n){var r,i=l(e),a=u(i.length),o=c(n,a);if(s&&t!=t){for(;o<a;)if((r=i[o++])!=r)return!0}else for(;o<a;o++)if((s||o in i)&&i[o]===t)return s||o||0;return!s&&-1}}},function(e,t,n){var r=n(36),i=Math.min;e.exports=function(e){return 0<e?i(r(e),9007199254740991):0}},function(e,t,n){var r=n(36),i=Math.max,a=Math.min;e.exports=function(e,t){return(e=r(e))<0?i(e+t,0):a(e,t)}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){var r=n(12).document;e.exports=r&&r.documentElement},function(e,t,n){var r=n(20).f,i=n(8),a=n(54)("toStringTag");e.exports=function(e,t,n){e&&!i(e=n?e:e.prototype,a)&&r(e,a,{configurable:!0,value:t})}},function(e,t,n){var r=n(10)("wks"),i=n(14),a=n(12).Symbol,o="function"==typeof a;(e.exports=function(e){return r[e]||(r[e]=o&&a[e]||(o?a:i)("Symbol."+e))}).store=r},function(e,t,n){n(56);for(var r=n(12),i=n(19),a=n(39),o=n(54)("toStringTag"),s="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),l=0;l<s.length;l++){var u=s[l],c=r[u],d=c&&c.prototype;d&&!d[o]&&i(d,o,u),a[u]=a.Array}},function(e,t,n){"use strict";var r=n(57),i=n(58),a=n(39),o=n(45);e.exports=n(37)(Array,"Array",function(e,t){this._t=o(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,i(1)):i(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])},"values"),a.Arguments=a.Array,r("keys"),r("values"),r("entries")},function(e,t){e.exports=function(){}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){t.f=n(54)},function(e,t,n){e.exports={default:n(61),__esModule:!0}},function(e,t,n){n(62),n(72),n(73),n(74),e.exports=n(11).Symbol},function(e,t,n){"use strict";function r(e){var t=Y[e]=I(j[G]);return t._k=e,t}function i(e,t){w(e);for(var n,r=T(t=x(t)),i=0,a=r.length;i<a;)te(e,n=r[i++],t[n]);return e}function a(e){var t=W.call(this,e=M(e,!0));return!(this===X&&c(Y,e)&&!c(K,e))&&(!(t||!c(this,e)||!c(Y,e)||c(this,V)&&this[V][e])||t)}function o(e,t){if(e=x(e),t=M(t,!0),e!==X||!c(Y,t)||c(K,t)){var n=k(e,t);return!n||!c(Y,t)||c(e,V)&&e[V][t]||(n.enumerable=!0),n}}function s(e){for(var t,n=F(x(e)),r=[],i=0;n.length>i;)c(Y,t=n[i++])||t==V||t==p||r.push(t);return r}function l(e){for(var t,n=e===X,r=F(n?K:x(e)),i=[],a=0;r.length>a;)!c(Y,t=r[a++])||n&&!c(X,t)||i.push(Y[t]);return i}var u=n(12),c=n(8),d=n(24),h=n(16),f=n(38),p=n(63).KEY,m=n(25),g=n(10),v=n(53),y=n(14),_=n(54),b=n(59),E=n(64),T=n(65),A=n(68),w=n(21),S=n(22),C=n(5),x=n(45),M=n(27),R=n(28),I=n(41),P=n(69),D=n(71),L=n(66),O=n(20),N=n(43),k=D.f,B=O.f,F=P.f,j=u.Symbol,U=u.JSON,H=U&&U.stringify,G="prototype",V=_("_hidden"),z=_("toPrimitive"),W={}.propertyIsEnumerable,q=g("symbol-registry"),Y=g("symbols"),K=g("op-symbols"),X=Object[G],Q="function"==typeof j&&!!L.f,Z=u.QObject,J=!Z||!Z[G]||!Z[G].findChild,$=d&&m(function(){return 7!=I(B({},"a",{get:function(){return B(this,"a",{value:7}).a}})).a})?function(e,t,n){var r=k(X,t);r&&delete X[t],B(e,t,n),r&&e!==X&&B(X,t,r)}:B,ee=Q&&"symbol"==typeof j.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof j},te=function(e,t,n){return e===X&&te(K,t,n),w(e),t=M(t,!0),w(n),c(Y,t)?(n.enumerable?(c(e,V)&&e[V][t]&&(e[V][t]=!1),n=I(n,{enumerable:R(0,!1)})):(c(e,V)||B(e,V,R(1,{})),e[V][t]=!0),$(e,t,n)):B(e,t,n)};Q||(f((j=function(e){if(this instanceof j)throw TypeError("Symbol is not a constructor!");var t=y(0<arguments.length?e:void 0),n=function(e){this===X&&n.call(K,e),c(this,V)&&c(this[V],t)&&(this[V][t]=!1),$(this,t,R(1,e))};return d&&J&&$(X,t,{configurable:!0,set:n}),r(t)})[G],"toString",function(){return this._k}),D.f=o,O.f=te,n(70).f=P.f=s,n(67).f=a,L.f=l,d&&!n(13)&&f(X,"propertyIsEnumerable",a,!0),b.f=function(e){return r(_(e))}),h(h.G+h.W+h.F*!Q,{Symbol:j});for(var ne="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),re=0;ne.length>re;)_(ne[re++]);for(var ie=N(_.store),ae=0;ie.length>ae;)E(ie[ae++]);h(h.S+h.F*!Q,"Symbol",{for:function(e){return c(q,e+="")?q[e]:q[e]=j(e)},keyFor:function(e){if(!ee(e))throw TypeError(e+" is not a symbol!");for(var t in q)if(q[t]===e)return t},useSetter:function(){J=!0},useSimple:function(){J=!1}}),h(h.S+h.F*!Q,"Object",{create:function(e,t){return void 0===t?I(e):i(I(e),t)},defineProperty:te,defineProperties:i,getOwnPropertyDescriptor:o,getOwnPropertyNames:s,getOwnPropertySymbols:l});var oe=m(function(){L.f(1)});h(h.S+h.F*oe,"Object",{getOwnPropertySymbols:function(e){return L.f(C(e))}}),U&&h(h.S+h.F*(!Q||m(function(){var e=j();return"[null]"!=H([e])||"{}"!=H({a:e})||"{}"!=H(Object(e))})),"JSON",{stringify:function(e){for(var t,n,r=[e],i=1;i<arguments.length;)r.push(arguments[i++]);if(n=t=r[1],(S(t)||void 0!==e)&&!ee(e))return A(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!ee(t))return t}),r[1]=t,H.apply(U,r)}}),j[G][z]||n(19)(j[G],z,j[G].valueOf),v(j,"Symbol"),v(Math,"Math",!0),v(u.JSON,"JSON",!0)},function(e,t,n){function r(e){s(e,i,{value:{i:"O"+ ++l,w:{}}})}var i=n(14)("meta"),a=n(22),o=n(8),s=n(20).f,l=0,u=Object.isExtensible||function(){return!0},c=!n(25)(function(){return u(Object.preventExtensions({}))}),d=e.exports={KEY:i,NEED:!1,fastKey:function(e,t){if(!a(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!o(e,i)){if(!u(e))return"F";if(!t)return"E";r(e)}return e[i].i},getWeak:function(e,t){if(!o(e,i)){if(!u(e))return!0;if(!t)return!1;r(e)}return e[i].w},onFreeze:function(e){return c&&d.NEED&&u(e)&&!o(e,i)&&r(e),e}}},function(e,t,n){var r=n(12),i=n(11),a=n(13),o=n(59),s=n(20).f;e.exports=function(e){var t=i.Symbol||(i.Symbol=a?{}:r.Symbol||{});"_"==e.charAt(0)||e in t||s(t,e,{value:o.f(e)})}},function(e,t,n){var s=n(43),l=n(66),u=n(67);e.exports=function(e){var t=s(e),n=l.f;if(n)for(var r,i=n(e),a=u.f,o=0;i.length>o;)a.call(e,r=i[o++])&&t.push(r);return t}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,n){var r=n(47);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t,n){var r=n(45),i=n(70).f,a={}.toString,o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return o&&"[object Window]"==a.call(e)?function(e){try{return i(e)}catch(e){return o.slice()}}(e):i(r(e))}},function(e,t,n){var r=n(44),i=n(51).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},function(e,t,n){var r=n(67),i=n(28),a=n(45),o=n(27),s=n(8),l=n(23),u=Object.getOwnPropertyDescriptor;t.f=n(24)?u:function(e,t){if(e=a(e),t=o(t,!0),l)try{return u(e,t)}catch(e){}if(s(e,t))return i(!r.f.call(e,t),e[t])}},function(e,t){},function(e,t,n){n(64)("asyncIterator")},function(e,t,n){n(64)("observable")},function(e,t,n){"use strict";t.__esModule=!0;var r,i=n(76),a=(r=i)&&r.__esModule?r:{default:r};function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),(0,a.default)(e,r.key,r)}}t.default=function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}},function(e,t,n){e.exports={default:n(77),__esModule:!0}},function(e,t,n){n(78);var r=n(11).Object;e.exports=function(e,t,n){return r.defineProperty(e,t,n)}},function(e,t,n){var r=n(16);r(r.S+r.F*!n(24),"Object",{defineProperty:n(20).f})},function(e,t,n){"use strict";t.__esModule=!0;var r=o(n(80)),i=o(n(84)),a=o(n(31));function o(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":(0,a.default)(t)));e.prototype=(0,i.default)(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(r.default?(0,r.default)(e,t):e.__proto__=t)}},function(e,t,n){e.exports={default:n(81),__esModule:!0}},function(e,t,n){n(82),e.exports=n(11).Object.setPrototypeOf},function(e,t,n){var r=n(16);r(r.S,"Object",{setPrototypeOf:n(83).set})},function(e,t,i){function a(e,t){if(r(e),!n(t)&&null!==t)throw TypeError(t+": can't set as prototype!")}var n=i(22),r=i(21);e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,n,r){try{(r=i(17)(Function.call,i(71).f(Object.prototype,"__proto__").set,2))(e,[]),n=!(e instanceof Array)}catch(e){n=!0}return function(e,t){return a(e,t),n?e.__proto__=t:r(e,t),e}}({},!1):void 0),check:a}},function(e,t,n){e.exports={default:n(85),__esModule:!0}},function(e,t,n){n(86);var r=n(11).Object;e.exports=function(e,t){return r.create(e,t)}},function(e,t,n){var r=n(16);r(r.S,"Object",{create:n(41)})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BIFParser=t.MAGIC_NUMBER=t.BIF_INDEX_ENTRY_LENGTH=t.VERSION_OFFSET=t.NUMBER_OF_BIF_IMAGES_OFFSET=t.FRAMEWISE_SEPARATION_OFFSET=t.BIF_INDEX_OFFSET=void 0;var r=a(n(29)),i=a(n(75));function a(e){return e&&e.__esModule?e:{default:e}}var u=t.BIF_INDEX_OFFSET=64,o=t.FRAMEWISE_SEPARATION_OFFSET=16,s=t.NUMBER_OF_BIF_IMAGES_OFFSET=12,l=t.VERSION_OFFSET=8,c=t.BIF_INDEX_ENTRY_LENGTH=8,d=t.MAGIC_NUMBER=new Uint8Array(["0x89","0x42","0x49","0x46","0x0d","0x0a","0x1a","0x0a"]);t.BIFParser=((0,i.default)(h,[{key:"generateBIFIndex",value:function(){for(var e=[],t=0,n=u;t<this.numberOfBIFImages;t+=1,n+=c){var r=n,i=n+4,a=i+c,o=this.data.getUint32(i,!0),s=this.data.getUint32(a,!0),l=this.data.getUint32(r,!0);e.push({offset:o,timestamp:l,length:s-o})}return e}},{key:"getImageDataAtSecond",value:function(e){var t="data:image/jpeg;base64,",n=Math.floor(e/(this.framewiseSeparation/1e3)),r=this.bifIndex[n];return r?t+btoa(new Uint8Array(this.arrayBuffer.slice(r.offset,r.offset+r.length)).reduce(function(e,t){return e+String.fromCharCode(t)},"")):t}}]),h);function h(e){(0,r.default)(this,h),function(n){var r=!0;return d.forEach(function(e,t){e===n[t]||(r=!1)}),r}(new Uint8Array(e).slice(0,8))?(this.arrayBuffer=e,this.data=new DataView(e),this.framewiseSeparation=this.data.getUint32(o,!0)||1e3,this.numberOfBIFImages=this.data.getUint32(s,!0),this.version=this.data.getUint32(l,!0),this.bifIndex=this.generateBIFIndex(!0)):console.log("Invalid BIF data try and regenerate with different image settings.")}},function(e,t){"use strict";function o(e){var t={left:0,top:0};e.getBoundingClientRect&&e.parentNode&&(t=e.getBoundingClientRect());var n=document,r=n.body,i=n.documentElement,a=i.clientLeft||r.clientLeft||0,o=window.pageXOffset||r.scrollLeft,s=i.clientTop||r.clientTop||0,l=window.pageYOffset||r.scrollTop;return{left:Math.round(t.left+(o-a)),top:Math.round(t.top+(l-s))}}Object.defineProperty(t,"__esModule",{value:!0}),t.getElementPosition=o,t.getPointerPosition=function(e,t){var n=o(t),r=t.offsetWidth,i=t.offsetHeight;e.pageX,e.pageY;if(e.changedTouches){var a=e.changedTouches[0];a.pageX,a.pageY}return{x:Math.max(0,Math.min(1,(e.pageX-n.left)/r)),y:Math.max(0,Math.min(1,(n.top-e.pageY+i)/i))}}}],n.c=i,n.p="",n(0);function n(e){if(i[e])return i[e].exports;var t=i[e]={exports:{},id:e,loaded:!1};return r[e].call(t.exports,t,t.exports,n),t.loaded=!0,t.exports}var r,i}),function(){function e(e){if(this.redraw=function(e,t){return function(){return e.apply(t,arguments)}}(this.redraw,this),this.container=e.container,this.canvas=e.canvas,this.data=e.data||[],this.outerColor=e.outerColor||"transparent",this.innerColor=e.innerColor||"#000000",this.normalize=e.normalize||!1,this.pixelRatio=window.devicePixelRatio||screen.deviceXDPI/screen.logicalXDPI,this.barWidth=e.barWidth||1,this.barHeight=e.barHeight||0,null==this.canvas){if(!this.container)throw"Either canvas or container option must be passed";this.canvas=this.createCanvas(this.container,e.width||this.container.clientWidth,e.height||this.container.clientHeight)}this.patchCanvasForIE(this.canvas),this.context=this.canvas.getContext("2d"),this.width=parseInt(this.context.canvas.width,10),this.height=parseInt(this.context.canvas.height,10),e.data&&this.update(e)}window.S3bWaveform=(e.name="S3bWaveform",e.prototype.setData=function(e){return this.data=e},e.prototype.max=function(e){var t=-1/0;for(var n in e)e[n]>t&&(t=e[n]);return t},e.prototype.min=function(e){var t=1/0;for(var n in e)e[n]<t&&(t=e[n]);return t},e.prototype.update=function(e){return this.canvas.width=parseInt(this.container.clientWidth,10),this.width=parseInt(this.context.canvas.width,10),this.setData(e.data),this.redraw()},e.prototype.redraw=function(){this.clear();var e=this.data,t=1;[].some.call(e,function(e){return e<0})&&(t=2);var n=this.width,r=this.height,i=0*r,a=r/2,o=e.length/t,s=this.barWidth,l=s+Math.max(this.pixelRatio,~~(s/2)),u=1/this.barHeight;if(this.normalize){var c=this.max(e),d=this.min(e);u=c<-d?-d:c}for(var h=o/n,f=n,p=0;p<f;p+=l){"function"==typeof this.innerColor&&(this.context.fillStyle=this.innerColor(p/this.width));var m=e[Math.floor(p*h*t)]||0,g=Math.round(m/u*a);this.context.fillRect(p+.5,a-g+i,s+.5,2*g-g/2)}},e.prototype.clear=function(){return this.context.fillStyle=this.outerColor,this.context.clearRect(0,0,this.width,this.height),this.context.fillRect(0,0,this.width,this.height)},e.prototype.patchCanvasForIE=function(n){var r;if(void 0!==window.G_vmlCanvasManager)return n=window.G_vmlCanvasManager.initElement(n),r=n.getContext,n.getContext=function(e){var t;return t=r.apply(n,arguments),n.getContext=r,t}},e.prototype.createCanvas=function(e,t,n){var r;return r=document.createElement("canvas"),e.appendChild(r),r.width=t,r.height=n,r},e)}.call(this);var s3bubbleHelpers=s3bubbleGlobals();function s3bubble(g){var v={logger:function(e,t){s3bubbleHelpers.hasProp(s3bubble_drm_frontend_scripts,"s3bubble_show_debug_information")&&console.info(e,t)}};return videojs.log.level("off"),g instanceof Element||(g=document.getElementById(g)),v.video=function(t){if(window.addEventListener("scroll",function(){document.documentElement.style.setProperty("--scroll-y",window.scrollY+"px")}),v.logger("Script data ----- ",s3bubble_drm_frontend_scripts),v.logger("Options ----- ",t),t.isDrm){if(!t.hasOwnProperty("widevine")||!t.hasOwnProperty("playready")||!t.hasOwnProperty("fairplay"))return void console.log("You must have at least one drm provider set widevine, playready or fairplay")}else if(!t.hasOwnProperty("code"))return void console.log(s3bubble_drm_frontend_scripts.language.no_code);if(null!==g)if(0<g.children.length&&(videojs.log("Clean up..."),videojs(g.children[0]).dispose()),t.hasOwnProperty("woo")||(t.woo=""),t.hasOwnProperty("teaser")||(t.teaser=""),t.hasOwnProperty("options")&&"video"===t.type&&(t.options.hasOwnProperty("height")||t.options.hasOwnProperty("width")||g.classList.add("s3bubble-16-9")),videojs.addLanguage(s3bubble_drm_frontend_scripts.player_lang.locale,s3bubble_drm_frontend_scripts.player_lang),s3bubbleHelpers.hasProp(s3bubble_drm_frontend_scripts,"s3bubble_drm_old_plugin_exists"))v.failed(t,{code:9,title:s3bubble_drm_frontend_scripts.language.old_plugin_title,message:s3bubble_drm_frontend_scripts.language.old_plugin_description,link:!1});else if(s3bubbleHelpers.hasProp(s3bubble_drm_frontend_scripts,"s3bubble_force_login")&&s3bubbleHelpers.hasProp(s3bubble_drm_frontend_scripts,"s3bubble_drm_logged"))v.failed(t,{code:9,title:s3bubble_drm_frontend_scripts.language.force_login_title,message:s3bubble_drm_frontend_scripts.language.force_login_description,link:!!s3bubble_drm_frontend_scripts.logging_url&&s3bubble_drm_frontend_scripts.logging_url});else if(s3bubbleHelpers.hasProp(s3bubble_drm_frontend_scripts,"s3bubble_drm_user_block"))v.failed(t,{code:9,title:s3bubble_drm_frontend_scripts.language.blocked_title,message:s3bubble_drm_frontend_scripts.language.blocked_description,link:!1});else{var e=0;if(t.hasOwnProperty("teaser")&&""!=t.teaser&&(e=parseInt(t.teaser),isNaN(e)))v.failed(t,{code:9,title:"Error",message:"The teaser value is not a Number please check the code you entered.",link:!1});else if(t.hasOwnProperty("woo_memberships")&&""!=t.woo_memberships)s3bubbleHelpers.getAjaxData({action:"s3bubble_drm_woo_memberships",woo:t.woo_memberships,teaser:e,nonce:s3bubble_drm_frontend_scripts.nonce},s3bubble_drm_frontend_scripts.ajax,function(e){e.status?e.purchased?(t.purchase=e.data,t.isDrm?v.drm(t):v.player(t)):e.teaser?t.isDrm?v.drm(t):v.player(t):v.failed(t,e):v.failed(t,e)});else if(t.hasOwnProperty("woo")&&""!=t.woo){var n=parseInt(t.woo);if(isNaN(n))return void v.failed(t,{code:9,title:"Error",message:"The woo product id value is not a Number please check the code you entered.",link:!1});s3bubbleHelpers.getAjaxData({action:"s3bubble_drm_woo_products",woo:n,teaser:e,nonce:s3bubble_drm_frontend_scripts.nonce},s3bubble_drm_frontend_scripts.ajax,function(e){e.status?e.purchased?(t.purchase=e.data,t.isDrm?v.drm(t):v.player(t)):e.teaser?t.isDrm?v.drm(t):v.player(t):v.failed(t,e):v.failed(t,e)})}else t.isDrm?v.drm(t):v.player(t)}else console.log(s3bubble_drm_frontend_scripts.language.no_div)},v.failed=function(e,t){var n=document.createElement("video");n.className="video-js vjs-default-skin",n.setAttribute("crossorigin","anonymous"),n.setAttribute("playsinline",!0),n.setAttribute("webkit-playsinline",!0),n.addEventListener("contextmenu",function(e){e.preventDefault()},!1),g.appendChild(n);var r={autoplay:!1,nativeControlsForTouch:!1};e.hasOwnProperty("options")&&(e.options.hasOwnProperty("width")&&(r.width=parseInt(e.options.width)),e.options.hasOwnProperty("height")&&(r.height=parseInt(e.options.height)),e.options.hasOwnProperty("height")||e.options.hasOwnProperty("width")||n.classList.add("vjs-16-9"));var i=videojs(n,r,function(){(videojs.browser.IS_IOS||videojs.browser.IS_ANDROID)&&this.addClass("vjs-s3bubble-ismobile"),this.errorPlugin(),this.error(t)});s3bubbleHelpers.hasProp(s3bubble_drm_frontend_scripts,"s3bubble_wordpress_poster")&&i.poster(s3bubble_drm_frontend_scripts.options.s3bubble_wordpress_poster)},v.player=function(c){var d=c.hasOwnProperty("type")?c.type:"video";s3bubbleHelpers.getData({uri:"media",code:c.code},function(e){if(e.error)v.failed(c,{code:9,title:s3bubble_drm_frontend_scripts.language.error,message:e.message,link:!1});else{var u=s3bubbleHelpers.extend(e,c);if(u.index=0,u.length=0,u.div=g,window.ga&&""!==u.options.googleUaCode){var t="No Title Set";""!==u.meta.title&&(t=u.meta.title),ga("create",u.options.googleUaCode,"auto","s3bubble"),ga("s3bubble.send","event","s3bubble.Video","Video Page Load",u.options.code+" "+t)}v.logger("Token ----- ",u.token),s3bubbleHelpers.getAjaxData({action:"s3bubble_drm_set_cookie",type:videojs.browser.IS_IOS||videojs.browser.IS_ANDROID?"m":"d",token:u.token,nonce:s3bubble_drm_frontend_scripts.nonce},s3bubble_drm_frontend_scripts.ajax,function(e){v.logger("Response ----- ",e);var t=document.createElement("video");t.className="audio"===d?"video-js vjs-default-skin vjs-s3bubble-drm vjs-audiowaveform-audio-theme loading":"video-js vjs-default-skin vjs-s3bubble-drm",t.setAttribute("crossorigin","anonymous"),t.setAttribute("playsinline",!0),t.setAttribute("webkit-playsinline",!0),t.setAttribute("data-matomo-title",u.options.code+" "+u.meta.title),u.source.src&&t.setAttribute("data-matomo-resource",u.source.src),g.appendChild(t);var n={techOrder:["chromecast","html5"],html5:{hls:{overrideNative:!0,cacheEncryptionKeys:!0,useDevicePixelRatio:!0}},plugins:{chromecast:{buttonPositionIndex:-1},s3BubbleBitrateSwitcher:{showInfo:!!s3bubbleHelpers.hasProp(s3bubble_drm_frontend_scripts,"s3bubble_show_debug_information")},s3BubbleSettingsMenu:{items:["AudioTrackButton","ChaptersButton","SubsCapsButton","PlaybackRateMenuButton","RatesButton"],languages:{settings:s3bubble_drm_frontend_scripts.language.settings,loading:s3bubble_drm_frontend_scripts.language.loading,back:s3bubble_drm_frontend_scripts.language.back,captions_off:s3bubble_drm_frontend_scripts.language.captions_off,default_audio:s3bubble_drm_frontend_scripts.language.default_audio,audio:s3bubble_drm_frontend_scripts.language.audio,subtitles:s3bubble_drm_frontend_scripts.language.subtitles,speed:s3bubble_drm_frontend_scripts.language.speed,quality:s3bubble_drm_frontend_scripts.language.quality,chapters:"Chapters"}}},controlBar:{volumePanel:{inline:!1}},crossOrigin:"anonymous",liveui:!0,nativeControlsForTouch:!1,textTrackSettings:!0,controls:!0,language:s3bubble_drm_frontend_scripts.player_lang.locale,muted:u.options.muted,playbackRates:[.25,.5,.75,1,1.25,1.5,1.75,2],loop:u.options.loop};"audio"===d&&(window.innerWidth<480&&t.setAttribute("style","height:"+window.innerWidth+"px"),n.inactivityTimeout=0,n.plugins.audiowaveformPlayer={theme:"audio",barWidth:1,barHeight:1,brand:u.brand.sliders,posterWidth:180,styles:window.innerWidth<480?{position:"absolute",height:"100px",top:"50%",marginTop:"-50px",right:"0px"}:{position:"absolute",height:"100px",top:"20px",right:"0px",bottom:"50px"}},n.controlBar={volumePanel:{inline:!0}}),videojs.browser.IS_IOS||videojs.browser.IS_ANDROID||(n.html5.nativeTextTracks=!1,n.html5.nativeAudioTracks=!1,n.html5.nativeVideoTracks=!1),u.options.hasOwnProperty("width")&&(n.width=parseInt(u.options.width)),u.options.hasOwnProperty("height")&&(n.height=parseInt(u.options.height)),u.options.hasOwnProperty("height")||u.options.hasOwnProperty("width")||"video"===d&&t.classList.add("vjs-16-9"),v.logger("Video Options ----- ",n);var r=videojs(t,n,function(){try{Matomo.MediaAnalytics.scanForMedia(),v.logger("Matomo exists analytics media tracking enabled","")}catch(e){v.logger("Matomo analytics does not exists not being used","")}this.buttonsS3Plugin(),this.airplayS3Plugin(),this.ga(),this.purchasedPlugin(),this.errorPlugin(),u.hasOwnProperty("is360")&&(this.controlBar.removeChild("pictureInPictureToggle"),this.vr({projection:"360",debug:!1,motionControls:!0})),s3bubbleHelpers.hasProp(s3bubble_drm_frontend_scripts,"adverts_purchased_check")&&"yes"===s3bubble_drm_frontend_scripts.options.adverts_purchased?v.logger("Ads removed user has purchased a plan...",""):this.vmapAds(),videojs.browser.IS_IOS||videojs.browser.IS_ANDROID||u.source.bif&&this.bif({src:u.source.bif}),s3bubbleHelpers.hasProp(s3bubble_drm_frontend_scripts,"show_dynamic_watermark")&&this.watermarkPlugin(),this.hotkeys({volumeStep:.1,seekStep:5,enableModifiersForNumbers:!1,enableVolumeScroll:!1}),this.textTrackSettings.setDefaults(),this.textTrackSettings.setValues({backgroundOpacity:1,edgeStyle:"raised",color:"#FFF",fontPercent:.75,windowOpacity:1}),this.textTrackSettings.saveSettings(),"audio"===d&&this.removeClass("loading"),v.logger("Version: 4.2.1","")});"audio"===d&&r.controlBar.removeChild("pictureInPictureToggle"),s3bubbleHelpers.hasProp(s3bubble_drm_frontend_scripts,"s3bubble_wordpress_poster")&&(u.source.poster=s3bubble_drm_frontend_scripts.options.s3bubble_wordpress_poster),u.source.poster?r.poster(u.source.poster):r.poster(u.source.global_poster);var i=!1;if(s3bubble_drm_frontend_scripts.hasOwnProperty("options")&&s3bubble_drm_frontend_scripts.options.hasOwnProperty("autoplay")&&(i=!0),!0!==u.options.autoplay&&"true"!==u.options.autoplay||(i=!0),u.options.hasOwnProperty("preventAutoplay")&&(i=!1),i){v.logger("Trying Autoplay","");var a=document.querySelector("video").play();void 0!==a&&a.then(function(){v.logger("Can Autoplay",""),r.pause(),r.play()}).catch(function(e){v.logger("Autoplay Failed",""),r.muted(!0),r.play()})}r.s3s=u,r.s3s.type="video",r.brandS3Plugin(),r.metaS3Plugin(),r.s3BubbleMediatailor(),s3bubble_drm_frontend_scripts.hasOwnProperty("options")&&s3bubble_drm_frontend_scripts.options.hasOwnProperty("skip")&&r.skipButtonsPlugin(),videojs.browser.IS_IOS||videojs.browser.IS_ANDROID?(r.addClass("vjs-s3bubble-ismobile"),u.hasOwnProperty("is360")||r.mobileUi()):(r.addClass("vjs-s3bubble-isnotmobile"),r.logoS3Plugin());var o=document.getElementById(r.id_);o.addEventListener?o.addEventListener("contextmenu",function(e){e.preventDefault()},!1):o.attachEvent("oncontextmenu",function(){window.event.returnValue=!1}),s3bubbleHelpers.hasProp(s3bubble_drm_frontend_scripts,"s3bubble_remove_powered_by")||r.contextmenuUI({preventNativeMenu:!0,keepInside:!1,content:[{href:"https://s3bubble.com",label:'<img src="'+s3bubble_drm_frontend_scripts.logo+'" alt="S3Bubble Instant OTT Setups" /> | Powered by S3Bubble.com'}]});var s=!1,l=!0;r.on("timeupdate",function(e){if(u.hasOwnProperty("teaser")){var t=Math.floor(this.currentTime());t%1==0&&null!==t&&t>parseInt(u.teaser)&&(u.hasOwnProperty("woo_memberships")&&""!=u.woo_memberships&&!s&&l&&(l=!1,s3bubbleHelpers.getAjaxData({action:"s3bubble_drm_woo_memberships",woo:c.woo_memberships,teaser:"",nonce:s3bubble_drm_frontend_scripts.nonce},s3bubble_drm_frontend_scripts.ajax,function(e){e.status?e.purchased?s=!0:(r.isFullscreen()&&r.exitFullscreen(),r.pause(),r.error({code:8,message:e.message,data:e.data})):(r.pause(),r.error({code:8,message:e.message,data:e.data}))})),u.hasOwnProperty("woo")&&""!=u.woo&&!s&&l&&(l=!1,s3bubbleHelpers.getAjaxData({action:"s3bubble_drm_woo_products",woo:c.woo,teaser:"",nonce:s3bubble_drm_frontend_scripts.nonce},s3bubble_drm_frontend_scripts.ajax,function(e){e.status?e.purchased?s=!0:(r.isFullscreen()&&r.exitFullscreen(),r.pause(),r.error({code:8,message:e.message,data:e.data})):(r.pause(),r.error({code:8,message:e.message,data:e.data}))})))}}),v.logger("Source",u.source),r.src(u.source)})}})},v.drm=function(p){var m=p.hasOwnProperty("type")?p.type:"video";videojs.browser.IS_SAFARI&&(p.code=p.fairplay,p.system="fairplay"),(videojs.browser.IE_VERSION||videojs.browser.IS_EDGE)&&(p.code=p.playready,p.system="playready"),(videojs.browser.IS_CHROME||videojs.browser.IS_FIREFOX)&&(p.code=p.widevine,p.system="widevine"),s3bubbleHelpers.getData({uri:"media",code:p.code},function(e){if(e.error)v.failed(p,{code:9,title:s3bubble_drm_frontend_scripts.language.error,message:e.message,link:!1});else{var n=s3bubbleHelpers.extend(e,p);if(v.logger("Settings",n),n.index=0,n.length=0,n.div=g,window.ga&&""!==n.options.googleUaCode){var t="No Title Set";""!==n.meta.title&&(t=n.meta.title),ga("create",n.options.googleUaCode,"auto","s3bubble"),ga("s3bubble.send","event","s3bubble.Video","Video Page Load",n.options.code+" "+t)}var r=document.createElement("video");r.className="audio"===m?"video-js vjs-default-skin vjs-s3bubble-drm vjs-audiowaveform-audio-theme loading":"video-js vjs-default-skin vjs-s3bubble-drm",r.setAttribute("crossorigin","anonymous"),r.setAttribute("playsinline",!0),r.setAttribute("webkit-playsinline",!0),r.setAttribute("data-matomo-title",n.options.code+" "+n.meta.title),n.source.src&&r.setAttribute("data-matomo-resource",n.source.src),g.appendChild(r);var i={techOrder:["chromecast","html5"],html5:{hls:{overrideNative:!0,cacheEncryptionKeys:!0,useDevicePixelRatio:!0}},plugins:{chromecast:{buttonPositionIndex:-1},s3BubbleBitrateSwitcher:{showInfo:!!s3bubbleHelpers.hasProp(s3bubble_drm_frontend_scripts,"s3bubble_show_debug_information")},s3BubbleSettingsMenu:{items:["AudioTrackButton","ChaptersButton","SubsCapsButton","PlaybackRateMenuButton","RatesButton"],languages:{settings:s3bubble_drm_frontend_scripts.language.settings,loading:s3bubble_drm_frontend_scripts.language.loading,back:s3bubble_drm_frontend_scripts.language.back,captions_off:s3bubble_drm_frontend_scripts.language.captions_off,default_audio:s3bubble_drm_frontend_scripts.language.default_audio,audio:s3bubble_drm_frontend_scripts.language.audio,subtitles:s3bubble_drm_frontend_scripts.language.subtitles,speed:s3bubble_drm_frontend_scripts.language.speed,quality:s3bubble_drm_frontend_scripts.language.quality,chapters:"Chapters"}}},controlBar:{volumePanel:{inline:!1}},crossOrigin:"anonymous",liveui:!0,nativeControlsForTouch:!1,textTrackSettings:!0,controls:!0,language:s3bubble_drm_frontend_scripts.player_lang.locale,muted:n.options.muted,playbackRates:[.25,.5,.75,1,1.25,1.5,1.75,2],loop:n.options.loop};if("audio"===m&&(window.innerWidth<480&&r.setAttribute("style","height:"+window.innerWidth+"px"),i.inactivityTimeout=0,i.plugins.audiowaveformPlayer={theme:"audio",barWidth:1,barHeight:1,brand:n.brand.sliders,posterWidth:180,styles:window.innerWidth<480?{position:"absolute",height:"100px",top:"50%",marginTop:"-50px",right:"0px"}:{position:"absolute",height:"100px",top:"20px",right:"0px",bottom:"50px"}},i.controlBar={volumePanel:{inline:!0}}),videojs.browser.IS_IOS||videojs.browser.IS_ANDROID||(i.html5.nativeTextTracks=!1,i.html5.nativeAudioTracks=!1,i.html5.nativeVideoTracks=!1),"fairplay"===n.system){if(delete i.html5,!n.hasOwnProperty("assetid"))return void console.log("You have not set your Asset ID you need to get this from the ezdrm dashboard!");i.sources={src:n.source.src,type:n.source.type,license_url:"https://fps.ezdrm.com/api/licenses/"+n.assetid,keySystems:{"com.apple.fps.1_0":{certificateUri:s3bubble_drm_frontend_scripts.options.fairplay_uri,licenseUri:"https://fps.ezdrm.com/api/licenses/"+n.assetid}}}}if("widevine"===n.system||"playready"===n.system){var a=[];a[n.source.src]={licenseUrl:s3bubble_drm_frontend_scripts.options.widevine_uri};var o=[];o[n.source.src]=n.meta.subTitle;var s=[];s[n.source.src]=n.meta.title,i.chromecast={requestTitleFn:function(e){return s[e.src]},requestSubtitleFn:function(e){return o[e.src]},requestCustomDataFn:function(e){return a[e.src]}},i.sources={src:n.source.src,type:n.source.type,keySystemOptions:[{name:"com.widevine.alpha",options:{serverURL:s3bubble_drm_frontend_scripts.options.widevine_uri}},{name:"com.microsoft.playready",options:{serverURL:s3bubble_drm_frontend_scripts.options.playready_uri}}]}}n.options.hasOwnProperty("width")&&(i.width=parseInt(n.options.width)),n.options.hasOwnProperty("height")&&(i.height=parseInt(n.options.height)),n.options.hasOwnProperty("height")||n.options.hasOwnProperty("width")||r.classList.add("vjs-16-9"),v.logger("Video Options ----- ",i);var l=videojs(r,i,function(){try{Matomo.MediaAnalytics.scanForMedia(),v.logger("Matomo exists analytics media tracking enabled","")}catch(e){v.logger("Matomo analytics does not exists not being used","")}this.eme(),this.buttonsS3Plugin(),this.airplayS3Plugin(),this.ga(),this.purchasedPlugin(),this.errorPlugin(),n.hasOwnProperty("is360")&&(this.controlBar.removeChild("pictureInPictureToggle"),this.vr({projection:"360",debug:!1,motionControls:!0})),s3bubbleHelpers.hasProp(s3bubble_drm_frontend_scripts,"adverts_purchased_check")&&"yes"===s3bubble_drm_frontend_scripts.options.adverts_purchased?v.logger("Ads removed user has purchased a plan...",""):this.vmapAds(),videojs.browser.IS_IOS||videojs.browser.IS_ANDROID||n.source.bif&&this.bif({src:n.source.bif}),s3bubbleHelpers.hasProp(s3bubble_drm_frontend_scripts,"show_dynamic_watermark")&&this.watermarkPlugin(),this.hotkeys({volumeStep:.1,seekStep:5,enableModifiersForNumbers:!1,enableVolumeScroll:!1}),this.textTrackSettings.setDefaults(),this.textTrackSettings.setValues({backgroundOpacity:1,edgeStyle:"raised",color:"#FFF",fontPercent:.75,windowOpacity:1}),this.textTrackSettings.saveSettings(),"audio"===m&&this.removeClass("loading"),v.logger("Version: 4.2.1","")});"audio"===m&&l.controlBar.removeChild("pictureInPictureToggle"),s3bubbleHelpers.hasProp(s3bubble_drm_frontend_scripts,"s3bubble_wordpress_poster")&&(n.source.poster=s3bubble_drm_frontend_scripts.options.s3bubble_wordpress_poster),n.source.poster?l.poster(n.source.poster):l.poster(n.source.global_poster);var u=!1;if(s3bubble_drm_frontend_scripts.hasOwnProperty("options")&&s3bubble_drm_frontend_scripts.options.hasOwnProperty("autoplay")&&(u=!0),!0!==n.options.autoplay&&"true"!==n.options.autoplay||(u=!0),n.options.hasOwnProperty("preventAutoplay")&&(u=!1),u){v.logger("Trying Autoplay","");var c=document.querySelector("video").play();void 0!==c&&c.then(function(){v.logger("Can Autoplay",""),l.pause(),l.play()}).catch(function(e){v.logger("Autoplay Failed",""),l.muted(!0),l.play()})}l.s3s=n,l.s3s.type="video",l.brandS3Plugin(),l.metaS3Plugin(),l.s3BubbleMediatailor(),s3bubble_drm_frontend_scripts.hasOwnProperty("options")&&s3bubble_drm_frontend_scripts.options.hasOwnProperty("skip")&&l.skipButtonsPlugin(),videojs.browser.IS_IOS||videojs.browser.IS_ANDROID?(l.addClass("vjs-s3bubble-ismobile"),n.hasOwnProperty("is360")||l.mobileUi()):(l.addClass("vjs-s3bubble-isnotmobile"),l.logoS3Plugin());var d=document.getElementById(l.id_);d.addEventListener?d.addEventListener("contextmenu",function(e){e.preventDefault()},!1):d.attachEvent("oncontextmenu",function(){window.event.returnValue=!1}),s3bubbleHelpers.hasProp(s3bubble_drm_frontend_scripts,"s3bubble_remove_powered_by")||l.contextmenuUI({preventNativeMenu:!0,keepInside:!1,content:[{href:"https://s3bubble.com",label:'<img src="'+s3bubble_drm_frontend_scripts.logo+'" alt="S3Bubble Instant OTT Setups" /> | Powered by S3Bubble.com'}]});var h=!1,f=!0;l.on("timeupdate",function(e){if(n.hasOwnProperty("teaser")){var t=Math.floor(this.currentTime());t%1==0&&null!==t&&t>parseInt(n.teaser)&&(n.hasOwnProperty("woo_memberships")&&""!=n.woo_memberships&&!h&&f&&(f=!1,s3bubbleHelpers.getAjaxData({action:"s3bubble_drm_woo_memberships",woo:p.woo_memberships,teaser:"",nonce:s3bubble_drm_frontend_scripts.nonce},s3bubble_drm_frontend_scripts.ajax,function(e){e.status?e.purchased?h=!0:(l.isFullscreen()&&l.exitFullscreen(),l.pause(),l.error({code:8,message:e.message,data:e.data})):(l.pause(),l.error({code:8,message:e.message,data:e.data}))})),n.hasOwnProperty("woo")&&""!=n.woo&&!h&&f&&(f=!1,s3bubbleHelpers.getAjaxData({action:"s3bubble_drm_woo_products",woo:p.woo,teaser:"",nonce:s3bubble_drm_frontend_scripts.nonce},s3bubble_drm_frontend_scripts.ajax,function(e){e.status?e.purchased?h=!0:(l.isFullscreen()&&l.exitFullscreen(),l.pause(),l.error({code:8,message:e.message,data:e.data})):(l.pause(),l.error({code:8,message:e.message,data:e.data}))})))}})}})},v}s3bubbleHelpers.addScripts(),function(){var E=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};videojs.registerPlugin("ga",function(a){var e,t,r,i,o,s,l,n,u,c,d,h,f,p,m,g,v;null==a&&(a={}),l=["playing","end","seek","play","pause","volumeChange","error","fullscreen"];var y="No Title Set";""!=this.s3s.meta.title&&(y=this.s3s.meta.title);var _="No Code";""!=this.s3s.code&&(_=this.s3s.code),s=_+" | "+y,a.debug=a.debug||!1,f=h=0,p=!1;var b=navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPhone/i)?"pagehide":"beforeunload";return window.addEventListener(b,function(e){r&&m("Bytes Transferred",s,r,!1),i&&m("Minutes Watched",s,i,!1),o&&m("Percent Played",s,o,!0)}),g=function(){var e,t;if(e=Math.round(this.currentTime()),t=Math.round(this.duration()),i=Math.round(e/60),o=Math.round(e/t*100),"application/x-mpegURL"===this.currentType()){var n=this.tech().hls;r=n.stats.mediaBytesTransferred}0<=E.call(l,"seek")&&(f=h,h=e,1<Math.abs(f-h)&&(m("Seek Start",s,f,!(p=!0)),m("Seek End",s,h,!1)))},e=function(){m("End",s,null,!0)},d=function(){m("Video Impression",s,null,!0)},c=function(){var e;e=Math.round(this.currentTime()),m("Play",s,e,!0),p=!1},u=function(){var e;(e=Math.round(this.currentTime()))===Math.round(this.duration())||p||m("Pause",s,e,!0)},v=function(){var e;e=!0===this.muted()?0:this.volume(),m("Volume Change",s,e,!1)},t=function(){var e;e=Math.round(this.currentTime());var t=this.player().error();m("Error",s+" ("+t.message+")",e,!0)},n=function(){var e;e=Math.round(this.currentTime()),("function"==typeof this.isFullscreen?this.isFullscreen():void 0)||("function"==typeof this.isFullScreen?this.isFullScreen():void 0)?m("Enter Fullscreen",s,e,!1):m("Exit Fullscreen",s,e,!1)},capitalizeFirstLetter=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},m=function(e,t,n,r){if(window.ga){var i={eventCategory:"s3bubble.Video",eventAction:capitalizeFirstLetter(e),eventLabel:t,nonInteraction:r};n&&(i.eventValue=parseInt(n)),ga("s3bubble.send","event",i)}else window._gaq?_gaq.push(["_trackEvent","Video",e,t,value,r]):a.debug&&console.log("Google Analytics not detected")},this.ready(function(){if(this.on("timeupdate",g),0<=E.call(l,"end")&&this.on("ended",e),0<=E.call(l,"play")&&this.on("play",c),0<=E.call(l,"playing")&&this.on("playing",d),0<=E.call(l,"pause")&&this.on("pause",u),0<=E.call(l,"volumeChange")&&this.on("volumechange",v),0<=E.call(l,"error")&&this.on("error",t),0<=E.call(l,"fullscreen"))return this.on("fullscreenchange",n)}),{sendbeacon:m}})}.call(this),window.videojs.registerPlugin("purchasedPlugin",function(e){var t=this;if(t.el()&&!videojs.browser.IS_IOS&&!videojs.browser.IS_ANDROID&&t.s3s.hasOwnProperty("purchase")){var n=videojs.getComponent("Button"),r=videojs.extend(n,{constructor:function(){n.apply(this,arguments),this.addClass("vjs-purchase-button")},createEl:function(){return videojs.createEl("div",{className:"vjs-purchase-button",innerHTML:s3bubble_drm_frontend_scripts.language.purchased})},handleClick:function(){}});videojs.registerComponent("purchasedButton",r),t.addChild("purchasedButton",{}),t.on("playing",function(e){t.getChild("purchasedButton").hide()})}}),window.videojs.registerPlugin("airplayS3Plugin",function(e){var t=this;if(t.el()&&window.WebKitPlaybackTargetAvailabilityEvent){var n=t.el().getElementsByTagName("video");if(0<n.length){n=n[0];var r=videojs.getComponent("Button"),i=videojs.extend(r,{constructor:function(e,t){r.call(this,e,t),this.controlText("Airplay")},handleClick:function(){n.webkitShowPlaybackTargetPicker()},buildCSSClass:function(){return"vjs-icon-airplay vjs-control vjs-button"}});videojs.registerComponent("AirplayToggle",i),n.addEventListener("webkitplaybacktargetavailabilitychanged",function(e){switch(e.availability){case"available":t.on("loadeddata",function(){t.controlBar.childNameIndex_.hasOwnProperty("AirplayToggle")||(t.controlBar.addChild("AirplayToggle",{}),t.getChild("controlBar").el().insertBefore(t.getChild("controlBar").getChild("AirplayToggle").el(),t.getChild("controlBar").getChild("fullscreenToggle").el()))});break;case"not-available":console.log("airplay not available")}})}}}),window.videojs.registerPlugin("brandS3Plugin",function(){var e=this;if(e.el()&&s3bubbleHelpers.hasProp(e.s3s,"brand")){var t=Math.round(parseInt(getComputedStyle(e.el()).height)),n="";s3bubbleHelpers.hasProp(s3bubble_drm_frontend_scripts,"s3bubble_player_themes")&&"clean"===s3bubble_drm_frontend_scripts.options.s3bubble_player_themes?e.addClass("vjs-s3bubble-clean"):e.addClass("vjs-s3bubble-html5"),e.s3s.options.hasOwnProperty("controls")&&e.s3s.options.controls&&e.addClass("vjs-controls-visible"),n+=".video-js .s3bubble-meta-overlay .s3bubble-meta-overlay-social-share .s3bubble-overlay-menu li a:hover {background-color:"+e.s3s.brand.sliders+" !important;}",n+=".video-js .vjs-menu li:hover {background-color:"+e.s3s.brand.sliders+" !important;}",n+=".video-js .vjs-big-play-button:hover {background-color:"+e.s3s.brand.sliders+" !important;}",n+=".vjs-mobile-settings-menu .vjs-menu-content li.vjs-selected, .vjs-mobile-settings-menu .vjs-mobile-settings-menu-list li.vjs-selected {background-color:"+e.s3s.brand.sliders+" !important;}",n+=".vjs-menu li.vjs-selected, .vjs-menu li.vjs-selected:focus, .vjs-menu li.vjs-selected:hover {background-color:"+e.s3s.brand.sliders+" !important; color:white! important;}",n+=".video-js .vjs-play-progress {background-color:"+e.s3s.brand.sliders+" !important;}",n+=".video-js .vjs-volume-level {background-color:"+e.s3s.brand.sliders+" !important;}",n+=".video-js .vjs-ad-playing {background-color:"+e.s3s.brand.sliders+" !important;}",n+=".video-js .s3bubble-meta-overlay ul.s3bubble-social-share, .video-js .s3bubble-overlay-menu a:hover {background-color:"+e.s3s.brand.sliders+" !important;}",n+=".video-js .vjs-progress-control .vjs-mouse-display:after, .vjs-mouse-display .vjs-time-tooltip {background:"+e.s3s.brand.sliders+";}";var r=n+=".video-js .vjs-settings-menu .vjs-menu .vjs-menu-content {max-height: "+(t-60)+"px !important;}",i=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",a.styleSheet?a.styleSheet.cssText=r:a.appendChild(document.createTextNode(r)),i.appendChild(a)}}),window.videojs.registerPlugin("buttonsS3Plugin",function(e){var t=this;if(t.el()&&s3bubbleHelpers.hasProp(t.s3s,"buttons")&&0<t.s3s.buttons.length){t.s3s.buttons.sort(function(e,t){return e.position-t.position});var n=videojs.getComponent("Button"),r=videojs.extend(n,{constructor:function(){n.apply(this,arguments),this.addClass("vjs-s3bubble-button-cleanup"),this.controlText(this.options_.title)},createEl:function(){return n.prototype.createEl("button",{className:"vjs-s3bubble-button vjs-control vjs-button",innerHTML:'<a href="'+this.options_.link+'" target="_blank"><i class="fa '+this.options_.icon+'" aria-hidden="true"></i></a>'})},handleClick:function(){}});videojs.registerComponent("s3Button",r);for(var i=0;i<t.s3s.buttons.length;i++)t.getChild("controlBar").addChild("s3Button",t.s3s.buttons[i]),t.getChild("controlBar").el().insertBefore(t.getChild("controlBar").getChild("s3Button").el(),t.getChild("controlBar").getChild("fullscreenToggle").el())}}),window.videojs.registerPlugin("captionsS3Plugin",function(){var u=this;if(u.el()){var e=s3bubbleHelpers.hasProp(s3bubble_drm_frontend_scripts,"s3bubble_api_url");e&&"https://s3bubbleapi.com/v2"===e.s3bubble_api_url||u.s3s.hasOwnProperty("captions")&&!1===u.s3s.captions||s3bubbleHelpers.getData({uri:"captions",code:u.s3s.code},function(e){if(e.error)console.log("ERROR: ",e.message);else{var t=e.captions;if(0<t.length){for(var n=0;n<t.length;n++)u.addRemoteTextTrack({kind:"captions",src:t[n].src,language:t[n].lang,label:t[n].label},!0);if(u.s3s.hasOwnProperty("captions")&&u.s3s.captions.hasOwnProperty("selected"))for(var r=u.textTracks(),i=0;i<r.length;i++){var a=r[i];"captions"===a.kind&&a.language===u.s3s.captions.selected&&(a.mode="showing")}}var o=u.getChild("controlBar").getChild("SubsCapsButton").menu.children_;if(0<o.length){var s=document.getElementById(u.id()+"-setting-menu-child-menu-1");if(null!==s)for(var l=0;l<o.length;l++)s.appendChild(o[l].el_)}}})}}),window.videojs.registerPlugin("costsPlugin",function(e){if(this.el()&&!videojs.browser.IS_IOS&&!videojs.browser.IS_ANDROID){var t=videojs.getComponent("Component"),n=videojs.extend(t,{constructor:function(r,e){t.apply(this,arguments);var i=this;e&&i.updateTextContent("$0"),r.on("timeupdate",function(e){var t=r.tech().hls,n=85e-6*(t.stats.mediaBytesTransferred/1e6);i.updateTextContent("Data Transferred: "+function(e){if(0==e)return"0 Byte";var t=parseInt(Math.floor(Math.log(e)/Math.log(1024)));return Math.round(e/Math.pow(1024,t),2)+" "+["Bytes","KB","MB","GB","TB"][t]}(t.stats.mediaBytesTransferred)+" $"+n)})},createEl:function(){return videojs.createEl("div",{id:"vjs-costs"})},updateTextContent:function(e){videojs.emptyEl(this.el()),videojs.appendContent(this.el(),e)}});videojs.registerComponent("costs",n),this.addChild("costs",{})}}),window.videojs.registerPlugin("errorPlugin",function(){var l=this;if(l.el()){l.on("error",function(e){var t=this.player().error(),n=this.el().getElementsByClassName("vjs-modal-dialog-content")[0];if(void 0!==n)switch(parseInt(t.code)){case 1:case 2:case 3:n.innerHTML="<div class='vjs-modal-dialog-content-inner'><h2>"+s3bubble_drm_frontend_scripts.language.error+"</h2><p>"+t.message+"</p><small>"+s3bubble_drm_frontend_scripts.language.error_code+": "+t.code+"</small></div>",console.log(t.message);break;case 4:var r=function(e){var t={},n=document.createElement("a");n.href=e;for(var r=n.search.substring(1).split("&"),i=0;i<r.length;i++){var a=r[i].split("=");t[a[0]]=decodeURIComponent(a[1])}return t}(l.currentSrc());if(r.hasOwnProperty("start")){n.innerHTML="<div class='vjs-modal-dialog-content-inner'><h2>"+s3bubble_drm_frontend_scripts.language.error+"</h2><p>"+s3bubble_drm_frontend_scripts.language.error_message_live+"</p><div class='vjs-countdown-timer'></div></div>";var o=new Date(r.start).getTime(),s=setInterval(function(){var e=(new Date).getTime(),t=o-e,n=Math.floor(t/864e5),r=Math.floor(t%864e5/36e5),i=Math.floor(t%36e5/6e4),a=Math.floor(t%6e4/1e3);l.el().querySelector(".vjs-countdown-timer").innerHTML=n+"d "+r+"h "+i+"m "+a+"s ",t<0&&(clearInterval(s),l.el().querySelector(".vjs-countdown-timer").innerHTML="<a href='javascript:location.reload();'>"+s3bubble_drm_frontend_scripts.language.error_message_start+"</a>")},1e3)}else n.innerHTML="<div class='vjs-modal-dialog-content-inner'><h2>"+s3bubble_drm_frontend_scripts.language.error+"</h2><p>"+t.message+"</p><a href='https://www.youtube.com/watch?v=3nh2IYliKa8' target='_blank'>Watch Helper Video</a><small>"+s3bubble_drm_frontend_scripts.language.error_code+": "+t.code+"</small></div>";console.log(t.message+". 1) Check you Cloudfront distribution has deployed and your job is complete. 2) Check your delivery bucket has hls CORS added. 3) Make sure your delivery bucket policy allows your Cloudfront distribution access.");break;case 5:case 6:case 7:n.innerHTML="<div class='vjs-modal-dialog-content-inner'><h2>"+s3bubble_drm_frontend_scripts.language.error+"</h2><p>"+t.message+"</p><small>"+s3bubble_drm_frontend_scripts.language.error_code+": "+t.code+"</small></div>",console.log(t.message);break;case 8:var i="";t.data.logged||(i="<small>"+s3bubble_drm_frontend_scripts.language.login_para+"</small>"),t.data.poster&&(n.style.backgroundImage="url("+t.data.poster+")"),n.style.backgroundSize="cover",n.innerHTML="<div class='vjs-modal-dialog-content-trans'></div><div class='vjs-modal-dialog-content-inner'><h2>"+t.data.title+"</h2><p>"+t.message+"</p><p class='s3bubble-hide-mobile'>"+t.data.content+"</p><a target='_top' href='"+t.data.link+"'>"+t.data.price+"</a>"+i+"</div>";break;case 9:var a="";t.link&&(a='<a href="'+t.link+'">'+s3bubble_drm_frontend_scripts.language.login+"</a>"),n.innerHTML="<div class='vjs-modal-dialog-content-inner'><h2>"+t.title+"</h2><p>"+t.message+"</p>"+a+"</div>";break;default:n.innerHTML="<div class='vjs-modal-dialog-content-inner'><h2>Error</h2><p>"+t.message+"</p><small>"+s3bubble_drm_frontend_scripts.language.error_code+": "+t.code+"</small></div>"}})}}),window.videojs.registerPlugin("logoS3Plugin",function(){var e=this;if(e.el()&&e.s3s.hasOwnProperty("brand")&&e.s3s.brand.hasOwnProperty("controlbarLogo")&&""!==e.s3s.brand.controlbarLogo){var n=videojs.getComponent("Button"),t=videojs.extend(n,{constructor:function(e,t){n.call(this,e,t),this.addClass("vjs-s3bubble-button-cleanup"),this.controlText("")},createEl:function(){return n.prototype.createEl("button",{className:"vjs-s3bubble-brand vjs-control vjs-button",innerHTML:'<img src="'+e.s3s.brand.controlbarLogo+'" alt="" />'})}});videojs.registerComponent("S3BubbleBrandToggle",t),e.controlBar.addChild("S3BubbleBrandToggle",{})}}),window.videojs.registerPlugin("metaS3Plugin",function(e){var b=this;if(b.el()){b.removeChild("menuOverlay");var t=!0;for(var n in b.s3s.meta)if(b.s3s.meta[n]){t=!1;break}if(!t){var E=b.s3s.meta.showSocial,T=b.s3s.meta.backButton,A=(b.s3s.meta.skipButtons,b.s3s.meta.showDownload),w=s3bubbleHelpers.s3bubbleCleanFilename(b.s3s.meta.subTitle),S=s3bubbleHelpers.s3bubbleCleanFilename(b.s3s.meta.title);(videojs.browser.IS_IOS||videojs.browser.IS_ANDROID)&&(S=s3bubbleHelpers.s3bubbleCleanFilename(s3bubbleHelpers.truncate(b.s3s.meta.title,40)));var C=s3bubbleHelpers.s3bubbleCleanFilename(b.s3s.meta.para),x=videojs.getComponent("Component"),r=videojs.extend(x,{constructor:function(){x.apply(this,arguments);var e=this;e.addClass("s3bubble-meta-overlay");var t=document.createElement("div");t.id="s3bubble-meta-overlay-container",t.className="s3bubble-meta-overlay-container player-hidden";var n=[{class:"ev",base64:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABmJLR0QA/wD/AP+gvaeTAAABT0lEQVRIie3VvUoDQRSG4SXGRoiIWgnqLQgBS+tEEQLB1tJb8BYsbW0trQSvQhDsFBJB3CT2CnbKY7GzuNlsfk1h4QfLDmdmv5dzzsxsFP3rzwj76Pq9OqgXAR7nYJ7qoQiwgcs5mN9gqwhQCe+GJM1p1UEj65UH9HAcxks4w+cExl+4wHL49hAvRYBsitshtoPbEeb32M2U+CqdGAWAD5xiASWc4G3M/HvWYBwg1R2qYX4T1+HZDLFqWDOgSQEkfTiXaRwqIZbvURtHWJsGkCqW7LBGGOf1hPUB4ykAo/SMveBzILkR+k/0lIYxmpJSrWAxeJT1XzfxLIAYq7nsyzhGK792FkAzV4qepLmp2iEWo5YFTHo9VIasb4UsytnsSpnxSRRF3aG74EeLY+YHz8AsQj1k0S0o0ath/4UZYQvGNXlOoOHbdI6Q/VCeGLVvYVCsWRENXr8AAAAASUVORK5CYII=",display:E?"block":"none",link:"mailto:?subject="+S+"&body="+window.location.href},{class:"fb",base64:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABmJLR0QA/wD/AP+gvaeTAAAA/ElEQVRIie2SsU4CQRRFz1MKXQnR3mBlCB18BTHED7Cw9T8srGgt/RlbCQUVLckQGhMLtDLBazObTMiy7AzbwW128ua+e2ZfHhwVI0lDSQuly0m6CzNtA+CA6z3f6cysvQ2giKBfYAZ8ApdAF7gAMDMr7IgYxbuk9kbvR34Z1hsRL871AzyY2bKKOQUwycMl9YFn4Bzo1AWYB+dH4L7MfJIA+AvOp7vMMVv0AkyBuZmNvb8H3Pr7N6AF6Vs02EaWdCZpXbRFKSMq0k2lrB1/8C3pS9Jr4B/52io0hpkxW9T03yyoZcBVWVNdIzogwKKGTFcGeNoT4nzGUdX1D8/rE3/ZoZOhAAAAAElFTkSuQmCC",display:E?"block":"none",link:"https://www.facebook.com/sharer/sharer.php?u="+window.location.href+"&amp;title="+S},{class:"tw",base64:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABmJLR0QA/wD/AP+gvaeTAAAA60lEQVRIieWUMUqDQRCFv9GIhZaWYiVp7VLpAfQWNjmB5/BGlsFrCGuRA6QJUT8L/WXR37Cbf5FgHizsMm/emxmWgX8D9UZNDkdSrzvdyAwScNqo3hQRZ98NbCQOQEQEwF5FzgI4+DzFGFVwHyLiBaCm2dIRzYFJRKQC7odwxYhmwGUnXouSDvYj4q0voI6AVa9wRQc1H+GnUVbN2rl2FZVwc/6g6kqwQwbqYfZ8yu7LJgbARXafAFfAOXBclF2whu9/yYs+8iYGr+qdeqIeqWP1Vn1cZ/Cn6/q5of7X3soNpnlgoPi0gc6W4B3i9Q3Nx2Zx7gAAAABJRU5ErkJggg==",display:E?"block":"none",link:"https://twitter.com/intent/tweet?url="+window.location.href+"&amp;text="+S},{class:"gp",base64:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABmJLR0QA/wD/AP+gvaeTAAABbUlEQVRIidWVuy5FQRSGv3Hr3DvRiBcQ3oPjmohaPIKS0u0xRI1e4gWoCUfhiAdQIvkUe06yjW2f4Wj8yU4ma9b6/5l/z8yC/45QN6kOAIvAAjALTMapJ+AaOAVOQwivP1ZWl9WmnXGvLv2EuFc9yiBOcaj25Aj8hryN/RxbukXjO/IBCz+7xYPF4QCg7NkiMJ3otoAVYAiYADZirA5TFKfui8BCktgCZoALYB2YBy6B2wrS1PuUC9TbZKvL6kjcchvvVZ7E+jJuqgRekqRBdatMUsodi+HdJL4b4y/tWF/Fdj/VlIq34/AceI7jHXUnhBDSReRY1IgWlW9zUx1V15Lc7RyLTtKkSDasbka7htVxtWU9jqsE0lWpPqqr6lD81jLIVVeqBPrVu4ziTmhaumipyNIfCHy9A4nIYRfke7XkUaBHPfgF+b45z3VJqGHeP7mzxpZOLbMfaFC8LXN8bplXFC3zLITwlr3yf4cPWBUAbo7Q8vUAAAAASUVORK5CYII=",display:E?"block":"none",link:"https://plus.google.com/share?url="+window.location.href}],r=document.createElement("div");r.className="s3bubble-meta-overlay-share-container",r.style.opacity=0,r.style.marginLeft="-"+40*n.length/2+"px",r.innerHTML="<h2>Share</h2>";var i=document.createElement("ul");i.className="s3bubble-social-share";for(var a=0;a<n.length;a++){var o=document.createElement("li"),s=document.createElement("a");s.style.display=n[a].display,s.className=n[a].class,s.style.backgroundImage="url('"+n[a].base64+"')",s.setAttribute("href",n[a].link),M(s),o.appendChild(s),i.appendChild(o)}r.appendChild(i),e.el().appendChild(r);var l=[{class:"dl",base64:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABmJLR0QA/wD/AP+gvaeTAAAA/0lEQVRIie3UO0oDURSA4TNNdA2mcgeCuAYRU7gQH6WlkYBaZEMWsVXTqCC4CkGMFmn8LKKQxJm5dyKIRf5mmnP+87pMxJJ/D9ZwhiGe8Y5H9LH+W/k+xqoZ4xjFIvLzGvE8/abybXw0KAB7KWkLh7hNrKWKJ1WrQhsPddklOWVslslXcZ9qL7PACy6xMx14lJI3KDBNLyKiwDAitmoPFBFFUczst6xoCZ3AW00X3ZQB3Zr8q8AoMerFgnIYhcmzTPFjkgw5vAYOMgJnimTKYVBgJSJuImIj42inX9+TjNiIiM53R23cZXaVS29+py2Tv+e19OGrGGGA3cwJl/wBnwRLlKWpL7Z0AAAAAElFTkSuQmCC",display:A?"block":"none",link:A},{class:"sh",base64:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABmJLR0QA/wD/AP+gvaeTAAAA/0lEQVRIieXTMU7DQBCF4RihSEgUUBAJOqrcAXIG7hCJBm6QA0TchYqWigPQhSKhRYQaCfqPImNkzNpyYixF4jW25q3fP97Z7fX+vXCFQVfh11Z66gSCI8wCMsfx9kNwiDHusMCnn9psu7CHCd7VKw3I3YrwEzwWQu5xiSFOI7S++ypAhL+EvcCo4A0ahVcBYlvyzh9wUPKbH9MKwCTK83J4YU2zi1YGWJ2WfKCjum8bKQEY5wNtk7tT413E87YN4FuJP3iO0rArwEeU9rsCJO/Fujm7VQuzLMvWb/O3ikN+iw7ONg3DebwuU+aNv9M0BegHZNki+BVT9Dfdhe3TF1n+OP7pwDEUAAAAAElFTkSuQmCC",display:E?"block":"none",link:"#"}],u=document.createElement("ul");u.className="s3bubble-overlay-menu";for(var c=l.length-1;0<=c;c--){var d=document.createElement("li"),h=document.createElement("a");h.title="Back",h.style.display=l[c].display,h.style.backgroundImage="url('"+l[c].base64+"')",h.className=l[c].class,h.setAttribute("href",l[c].link),R({el:h,container:r}),d.appendChild(h),u.appendChild(d)}var f=document.createElement("div");f.className=" s3bubble-meta-overlay-social-share player-hidden",f.appendChild(u);var p=document.createElement("a");function m(e){b.s3s.meta.hasOwnProperty("backButtonUrl")&&""!==b.s3s.meta.backButtonUrl?window.location.href=b.s3s.meta.backButtonUrl:window.history.back()}p.className="s3bubble-meta-overlay-back-to-browse",p.style.backgroundImage="url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABmJLR0QA/wD/AP+gvaeTAAABDElEQVRIie2UzW3CQBBG1xRBAYifSyghINlACaSHNMCVMgL0AoISABlaAERycM48Dl5Li+Wd3RUc+SRL/pv3xmN7lXrn2QAjYAEcgX+9HYA5MHwG3AE2uLMG2qHwPvDnAS/yC/RCOg+Bm5KWj2BlAZyBGNgKkrULPhTgH/qeOnASJInJrJUcXxXei1IqiaJor4+/lVJ1oc+x9ARHW+f6+lTovMhBEmQleFfotFxbJDPPl0f0itykLl4xolQSLCoKHkYFTByCH0kwsBSFfKaxOEDytcUmiYGdAF+KcC1oABdxCNW5Ak2nQEt65GtLCPzTC25IWtjXJTNL784togSYASn5j5jp/RmuF/qOT+5eC1fjK+EU/AAAAABJRU5ErkJggg==')",p.style.display=T?"block":"none",p.addEventListener("click",m,!1),p.addEventListener("touchend",m,!1),t.appendChild(p);var g=document.createElement("h5");g.innerHTML=w,g.style.display=w?"block":"none",t.appendChild(g);var v=document.createElement("h1");v.innerHTML=S,v.style.display=S?"block":"none",t.appendChild(v);var y=document.createElement("p");y.innerHTML=C,y.style.display=C?"block":"none",t.appendChild(y),(videojs.browser.IS_IOS||videojs.browser.IS_ANDROID)&&(g.style.display="none",y.style.display="none");function _(){var e=30;(videojs.browser.IS_IOS||videojs.browser.IS_ANDROID)&&(e=20),s3bubbleHelpers.setFontSize({id:b.id(),elements:[{fontRatio:70,el:g},{fontRatio:e,el:v},{fontRatio:60,el:y}]})}window.addEventListener("resize",_,!1),_(),new MutationObserver(function(e){_()}).observe(b.el(),{attributes:!0,attributeFilter:["style"]}),videojs.dom.removeClass(t,"player-hidden"),videojs.dom.removeClass(f,"player-hidden"),b.s3s.hasOwnProperty("type")?"video"===b.s3s.type?(b.on("play",function(){videojs.dom.addClass(t,"player-hidden"),videojs.dom.addClass(e.el(),"s3bubble-meta-overlay-hidden")}),b.on("playing",function(){videojs.dom.addClass(t,"player-hidden"),videojs.dom.addClass(e.el(),"s3bubble-meta-overlay-hidden")}),b.on("pause",function(){}),b.on("ended",function(){videojs.dom.addClass(t,"s3bubble-meta-overlay-expanded"),videojs.dom.removeClass(t,"player-hidden"),videojs.dom.removeClass(e.el(),"s3bubble-meta-overlay-hidden"),videojs.dom.addClass(e.el(),"s3bubble-meta-overlay-visible")})):"audio"===b.s3s.type||(b.on("play",function(){videojs.dom.addClass(t,"player-hidden"),videojs.dom.addClass(e.el(),"s3bubble-meta-overlay-hidden")}),b.on("playing",function(){videojs.dom.addClass(t,"player-hidden"),videojs.dom.addClass(e.el(),"s3bubble-meta-overlay-hidden")}),b.on("pause",function(){}),b.on("ended",function(){videojs.dom.removeClass(t,"player-hidden"),videojs.dom.removeClass(e.el(),"s3bubble-meta-overlay-hidden"),videojs.dom.addClass(e.el(),"s3bubble-meta-overlay-visible")})):(b.on("play",function(){videojs.dom.addClass(t,"player-hidden"),videojs.dom.addClass(e.el(),"s3bubble-meta-overlay-hidden")}),b.on("playing",function(){videojs.dom.addClass(t,"player-hidden"),videojs.dom.addClass(e.el(),"s3bubble-meta-overlay-hidden")}),b.on("pause",function(){})),e.el().appendChild(f),e.el().appendChild(t)},handleClick:function(){}});videojs.registerComponent("menuOverlay",r),b.addChild("menuOverlay",{})}}function M(e){function t(e){var t=this.getAttribute("href");"ev"!==this.getAttribute("class")&&(e.preventDefault(),window.open(t,"S3BubbleShareWindow","height=400, width=600, top=100, left=100, toolbar=0, centerscreen=yes, resizable=yes, modal=yes, scrollbars=0"))}e.addEventListener("click",t,!1),e.addEventListener("touchend",t,!1)}function R(n){var r=!0;function e(e){e.preventDefault();var t=this.getAttribute("href");"dl"===this.getAttribute("class")?window.open(t,"_blank").focus():r?(b.getChild("bigPlayButton").el().style.zIndex=0,b.getChild("bigPlayButton").el().style.opacity=0,this.style.backgroundImage="url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABmJLR0QA/wD/AP+gvaeTAAAAkUlEQVRIie2VwQ2AIBAE1R40WiKWKw/LGR+SaIzi7SE/90XC7Y7CAU3zSxUQgMHhG4DwVjSzKyqQFB6Td84V9sCSCldgMoRfPaNqeITI4QrEHW6BFIfnIJ+FnyDnDomXsdzOlj+Rvrwr4LYF3kNVl+huQz2H0RyemdMgllZ0Q5Q+lyGeQyRBqH1dp+J6D86vO23cMwceYU71pwAAAABJRU5ErkJggg==')",setTimeout(function(){n.container.style.zIndex=2,n.container.style.opacity=1,r=!1},200)):(n.container.style.opacity=0,n.container.style.zIndex=-1,this.style.backgroundImage="url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABmJLR0QA/wD/AP+gvaeTAAAA/0lEQVRIieXTMU7DQBCF4RihSEgUUBAJOqrcAXIG7hCJBm6QA0TchYqWigPQhSKhRYQaCfqPImNkzNpyYixF4jW25q3fP97Z7fX+vXCFQVfh11Z66gSCI8wCMsfx9kNwiDHusMCnn9psu7CHCd7VKw3I3YrwEzwWQu5xiSFOI7S++ypAhL+EvcCo4A0ahVcBYlvyzh9wUPKbH9MKwCTK83J4YU2zi1YGWJ2WfKCjum8bKQEY5wNtk7tT413E87YN4FuJP3iO0rArwEeU9rsCJO/Fujm7VQuzLMvWb/O3ikN+iw7ONg3DebwuU+aNv9M0BegHZNki+BVT9Dfdhe3TF1n+OP7pwDEUAAAAAElFTkSuQmCC')",setTimeout(function(){b.getChild("bigPlayButton").el().style.zIndex=2,b.getChild("bigPlayButton").el().style.opacity=1,r=!0},200))}n.el.addEventListener("click",e,!1),n.el.addEventListener("touchend",e,!1)}}),window.videojs.registerPlugin("ratesSwitcherS3Plugin",function(e){var c=this;if(c.el()){for(var t=c.getChild("controlBar").el().querySelectorAll(".vjs-s3bubble-button-rates-cleanup"),n=t.length;n--;)c.getChild("controlBar").el().removeChild(t[n]);if("application/x-mpegURL"===c.currentType()){var r=videojs.getComponent("MenuButton"),i=videojs.extend(r,{constructor:function(){r.apply(this,arguments),this.addClass("vjs-icon-rates"),this.addClass("vjs-playback-rate"),this.addClass("vjs-menu-button"),this.addClass("vjs-menu-button-popup"),this.addClass("vjs-button"),this.addClass("vjs-s3bubble-button-rates-cleanup"),this.controlText("Rates")},handleClick:function(){s3bubbleHelpers.isMobile()&&this.el().querySelector(".vjs-menu").classList.toggle("vjs-lock-showing")}});videojs.registerComponent("ratesButton",i),c.getChild("controlBar").addChild("ratesButton",{}),c.getChild("controlBar").el().insertBefore(c.getChild("controlBar").getChild("ratesButton").el(),c.getChild("controlBar").getChild("fullscreenToggle").el()),c.one(videojs.browser.IS_IOS?"canplaythrough":"loadedmetadata",function(e){if(c.tech_.hls){var t,n=c.getChild("controlBar").getChild("ratesButton"),r=n.el().children[1].children[0],i=c.tech_.hls.representations(),a=Math.max.apply(Math,i.map(function(e){return e.height})),o=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(e[n]);return t.sort(function(e,t){return t.hasOwnProperty("height")?e.height-t.height:t.hasOwnProperty("bandwidth")?e.bandwidth-t.bandwidth:void 0}),t.reverse()}(i);for(t=0;t<o.length;t++){o[t].height===a&&t;var s=h(o[t]),l=document.createElement("li");l.className="vjs-menu-item",l.id=o[t].bandwidth,l.innerHTML='<span class="vjs-menu-item-text">'+s+", "+f(o[t].bandwidth)+'</span><span class="vjs-control-text" aria-live="polite">Bandwidth: '+f(o[t].bandwidth)+"</span>",d({li:l,parent:r,reps:o}),r.appendChild(l)}var u=document.createElement("li");u.className="vjs-menu-item vjs-selected",u.id="auto",u.innerHTML='Auto<span class="vjs-control-text"></span>',function(i){function e(e){var t,n,r=i.parent.childNodes;for(t=0;t<r.length;t++)videojs.dom.removeClass(r[t],"vjs-selected");for(videojs.dom.addClass(this,"vjs-selected"),n=0;n<i.reps.length;n++)i.reps[n].enabled(!0)}i.li.addEventListener("click",e,!1),i.li.addEventListener("touchend",e,!1)}({li:u,parent:r,reps:o}),r.appendChild(u),n.el().children[1].appendChild(r)}})}}function d(a){function e(e){var t,n=a.parent.childNodes;for(t=0;t<n.length;t++)videojs.dom.removeClass(n[t],"vjs-selected");videojs.dom.addClass(this,"vjs-selected");var r,i=parseInt(this.getAttribute("id"));for(r=0;r<a.reps.length;r++)a.reps[r].bandwidth===i?a.reps[r].enabled(!0):a.reps[r].enabled(!1)}a.li.addEventListener("click",e,!1),a.li.addEventListener("touchend",e,!1)}function h(e){return e.hasOwnProperty("height")?e.height+"p":Math.round(e.bandwidth/1e3)+"k"}function f(e){for(var t=-1;t++,1024<(e/=1024););return Math.max(e,.1).toFixed(1)+[" kbps"," Mbps"," Gbps"," Tbps","Pbps","Ebps","Zbps","Ybps"][t]}}),window.videojs.registerPlugin("skipButtonsPlugin",function(e){var t=this;if(t.el()){for(var n=t.getChild("controlBar").el().querySelectorAll(".vjs-s3bubble-button-rates-cleanup"),r=n.length;r--;)t.getChild("controlBar").el().removeChild(n[r]);if(videojs.browser.IS_IOS||videojs.browser.IS_ANDROID)return!0;var i=videojs.getComponent("Button"),a=videojs.extend(i,{constructor:function(){i.apply(this,arguments),this.addClass("vjs-s3bubble-button-cleanup"),this.controlText("Back 30s")},createEl:function(){return i.prototype.createEl("button",{className:"vjs-control vjs-button",innerHTML:'<span aria-hidden="true" class="vjs-icon-placeholder vjs-icon-replay"></span><span class="vjs-control-text" aria-live="polite">Back 30s</span>'})},handleClick:function(){var e=t.currentTime();t.currentTime(e-30)}}),o=videojs.extend(i,{constructor:function(){i.apply(this,arguments),this.addClass("vjs-s3bubble-skip-next"),this.addClass("vjs-s3bubble-button-cleanup"),this.controlText("Forward 30s")},createEl:function(){return i.prototype.createEl("button",{className:"vjs-control vjs-button",innerHTML:'<span aria-hidden="true" class="vjs-icon-placeholder vjs-icon-replay"></span><span class="vjs-control-text" aria-live="polite">Forward 30s</span>'})},handleClick:function(){var e=t.currentTime();t.currentTime(e+30)}});videojs.registerComponent("nextButton",o),videojs.registerComponent("prevButton",a),t.getChild("controlBar").addChild("prevButton",{},1),t.getChild("controlBar").addChild("nextButton",{},2)}}),window.videojs.registerPlugin("vmapAds",function(){var t=this;if(t.el()&&s3bubbleHelpers.hasProp(t.s3s,"vpaid"))if("video/vimeo"!==t.currentType())try{t.ima({id:t.id_,adTagUrl:t.s3s.options.vpaid});var e=document.getElementById(t.id_+"_html5_api");(navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/Android/i))&&e.hasAttribute("controls")&&e.removeAttribute("controls");var n=function(){if(t.ima.initializeAdDisplayContainer(),i.removeEventListener(r,n),s3bubbleHelpers.hasProp(s3bubble_drm_frontend_scripts,"adverts_purchased_check")){var e=document.getElementById(t.id_+"_ima-ad-container");removeAds=document.createElement("a"),removeAds.href=s3bubble_drm_frontend_scripts.options.adverts_product.link,removeAds.innerHTML="Remove ads",removeAds.style.position="absolute",removeAds.style.color="#fff",removeAds.style.fontSize="15px",removeAds.style.padding="10px",removeAds.style.background="rgba(0, 0, 0, 0.8)",e.appendChild(removeAds)}},r="click";(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/Android/i))&&(r="touchend");var i=document.getElementById(t.id_);return void i.addEventListener(r,n)}catch(e){return void console.log("VPAID ERROR: ",e)}else console.info("Google IMA does not work for Vimeo videos.")}),window.videojs.registerPlugin("watermarkPlugin",function(e){var n=this;if(n.el()&&!videojs.browser.IS_IOS&&!videojs.browser.IS_ANDROID){var r=videojs.getComponent("Component"),t=videojs.extend(r,{constructor:function(e,t){r.apply(this,arguments),t&&this.updateTextContent(t)},createEl:function(){return videojs.createEl("div",{id:"vjs-watermarking-"+n.id_,style:"color: rgba(255,255,255,.4) !important;display: block !important;visibility: visible !important;position: absolute !important;opacity: 100% !important;filter: opacity(100%) !important;background: transparent !important;transform: scale(1) !important;clip-path: circle(1) !important;width: auto !important;height: auto !important;text-align: center !important;text-indent: unset !important;font-size: 12px !important;-webkit-touch-callout: none !important;-webkit-user-select: none !important;-khtml-user-select: none !important;-moz-user-select: none !important;-ms-user-select: none !important;user-select: none !important;margin: 0px !important;padding: 0px; !important;text-indent: none !important;text-shadow: -1px 1px 0 rgba(0,0,0,0.3) !important;"})},updateTextContent:function(e){videojs.emptyEl(this.el());var t=e.ip;e.hasOwnProperty("email")&&(t+=" "+e.email),videojs.appendContent(this.el(),t)}});if(videojs.registerComponent("watermark",t),window.MutationObserver){var i,a,o=new MutationObserver(function(e){console.log("mutations",e),s3bubbleHelpers.hasProp(s3bubble_drm_frontend_scripts,"s3bubble_block_attempt")?s3bubbleHelpers.getAjaxData({action:"s3bubble_drm_dynamic_watermarking_log_user",nonce:s3bubble_drm_frontend_scripts.nonce},s3bubble_drm_frontend_scripts.ajax,function(e){e.status?(console.log("Logged user"),location.reload()):console.log("Failed to log user")}):(n.pause(),n.error({code:9,message:"You have tried to remove the watermark! User and ip have been logged."}))});n.one("loadedmetadata",function(){var e=this.videoWidth(),t=this.videoHeight();i=setInterval(function(){(a=document.getElementById("vjs-watermarking-"+n.id_))&&(o.disconnect(),a.style.left=Math.floor(Math.random()*e)+"px",a.style.top=Math.floor(Math.random()*t)+"px",o.observe(a,{attributes:!0,childList:!0,characterData:!0}))},15e3)}),n.one("ended",function(e){clearInterval(i),o.disconnect()})}n.one("playing",function(e){s3bubbleHelpers.getAjaxData({action:"s3bubble_drm_dynamic_watermarking",nonce:s3bubble_drm_frontend_scripts.nonce},s3bubble_drm_frontend_scripts.ajax,function(e){e.status&&n.addChild("watermark",e.data)})})}}),window.videojs.registerPlugin("waveform",function(e){var u=this;if(u.el()){u.bigPlayButton.dispose(),u.controlBar.pictureInPictureToggle.dispose(),u.controlBar.fullscreenToggle.dispose(),u.getChild("controlBar").removeChild("progressControl"),u.addClass("vjs-s3b-waveform");var n=videojs.getComponent("Component"),t=videojs.extend(n,{constructor:function(){n.apply(this,arguments);this.addClass("s3bubble-waveform");var e="click";(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/Android/i))&&(e="touchstart");var t=document.createElement("div");t.id="vjs-waveform-"+u.id(),t.addEventListener(e,function(e){var t,n;if(e.touches){var r=e.touches[0];t=Math.round(r.clientX),n=Math.round(e.target.clientWidth)}else t=Math.round(e.offsetX),n=Math.round(e.target.clientWidth);u.currentTime(u.duration()/n*t),u.play()},!1),this.el().appendChild(t)}});videojs.registerComponent("waveform",t),u.getChild("controlBar").addChild("waveform",{});var r=videojs.extend(n,{constructor:function(){n.apply(this,arguments);this.addClass("vjs-s3b-waveform-title")},createEl:function(){return videojs.createEl("div",{className:"",innerHTML:"loading..."})}});videojs.registerComponent("waveformTitle",r),u.getChild("controlBar").addChild("waveformTitle",{});var i=videojs.extend(n,{constructor:function(){n.apply(this,arguments);this.addClass("vjs-s3b-waveform-artwork")},createEl:function(){return videojs.createEl("div",{className:"",innerHTML:""})}});videojs.registerComponent("waveformArtwork",i),u.addChild("waveformArtwork",{}),u.one("loadedmetadata",function(){var e=this.currentSources();videojs.xhr({method:"GET",uri:e[0].waveform,headers:{"Content-Type":"application/x-www-form-urlencoded"}},function(e,t,n){if(200===t.statusCode){var r=JSON.parse(t.body);u.getChild("waveformArtwork").el().innerHTML='<img width="100" width="100" src="data:image/png;base64,'+r.artwork+'"/>',u.getChild("controlBar").getChild("waveformTitle").el().innerHTML=r.metadata.tags.title;var i=Math.floor(r.metadata.duration),a=r.data,o=document.createElement("canvas").getContext("2d"),s=o.createLinearGradient(0,0,0,70);s.addColorStop(.5,"rgba(51, 51, 51, 1.000)"),s.addColorStop(.5,"rgba(153, 153, 153, 1.000)");var l=o.createLinearGradient(0,0,0,70);l.addColorStop(.5,"rgba(255,98,50, 1.000)"),l.addColorStop(.5,"rgba(255,192,160, 1.000)"),waveform_build=new S3bWaveform({container:document.getElementById("vjs-waveform-"+u.id()),height:70,barWidth:1,barHeight:1,normalize:!0,innerColor:function(e){return u.currentTime()/i<e?s:l}}),waveform_build.update({data:a}),window.onresize=function(e){waveform_build.update({data:a})},u.on("timeupdate",function(){this.currentTime()&&waveform_build&&waveform_build.redraw()})}})})}});